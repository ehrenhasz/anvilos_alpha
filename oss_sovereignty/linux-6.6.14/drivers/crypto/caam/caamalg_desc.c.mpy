{
  "module_name": "caamalg_desc.c",
  "hash_id": "9d2d81a95f9e3d8dbbdf6113891d91c4fc9cf312fe75eefd269a355233a8fa72",
  "original_prompt": "Ingested from linux-6.6.14/drivers/crypto/caam/caamalg_desc.c",
  "human_readable_source": "\n \n\n#include \"compat.h\"\n#include \"desc_constr.h\"\n#include \"caamalg_desc.h\"\n\n \nstatic inline void aead_append_src_dst(u32 *desc, u32 msg_type)\n{\n\tappend_seq_fifo_store(desc, 0, FIFOST_TYPE_MESSAGE_DATA | KEY_VLF);\n\tappend_seq_fifo_load(desc, 0, FIFOLD_CLASS_BOTH |\n\t\t\t     KEY_VLF | msg_type | FIFOLD_TYPE_LASTBOTH);\n}\n\n \nstatic inline void append_dec_op1(u32 *desc, u32 type)\n{\n\tu32 *jump_cmd, *uncond_jump_cmd;\n\n\t \n\tif ((type & OP_ALG_ALGSEL_MASK) != OP_ALG_ALGSEL_AES) {\n\t\tappend_operation(desc, type | OP_ALG_AS_INITFINAL |\n\t\t\t\t OP_ALG_DECRYPT);\n\t\treturn;\n\t}\n\n\tjump_cmd = append_jump(desc, JUMP_TEST_ALL | JUMP_COND_SHRD);\n\tappend_operation(desc, type | OP_ALG_AS_INIT | OP_ALG_DECRYPT);\n\tuncond_jump_cmd = append_jump(desc, JUMP_TEST_ALL);\n\tset_jump_tgt_here(desc, jump_cmd);\n\tappend_operation(desc, type | OP_ALG_AS_INIT | OP_ALG_DECRYPT |\n\t\t\t OP_ALG_AAI_DK);\n\tset_jump_tgt_here(desc, uncond_jump_cmd);\n}\n\n \nvoid cnstr_shdsc_aead_null_encap(u32 * const desc, struct alginfo *adata,\n\t\t\t\t unsigned int icvsize, int era)\n{\n\tu32 *key_jump_cmd, *read_move_cmd, *write_move_cmd;\n\n\tinit_sh_desc(desc, HDR_SHARE_SERIAL);\n\n\t \n\tkey_jump_cmd = append_jump(desc, JUMP_JSL | JUMP_TEST_ALL |\n\t\t\t\t   JUMP_COND_SHRD);\n\tif (era < 6) {\n\t\tif (adata->key_inline)\n\t\t\tappend_key_as_imm(desc, adata->key_virt,\n\t\t\t\t\t  adata->keylen_pad, adata->keylen,\n\t\t\t\t\t  CLASS_2 | KEY_DEST_MDHA_SPLIT |\n\t\t\t\t\t  KEY_ENC);\n\t\telse\n\t\t\tappend_key(desc, adata->key_dma, adata->keylen,\n\t\t\t\t   CLASS_2 | KEY_DEST_MDHA_SPLIT | KEY_ENC);\n\t} else {\n\t\tappend_proto_dkp(desc, adata);\n\t}\n\tset_jump_tgt_here(desc, key_jump_cmd);\n\n\t \n\tappend_math_sub(desc, REG3, SEQINLEN, REG0, CAAM_CMD_SZ);\n\n\t \n\tappend_math_add(desc, VARSEQINLEN, ZERO, REG3, CAAM_CMD_SZ);\n\tappend_math_add(desc, VARSEQOUTLEN, ZERO, REG3, CAAM_CMD_SZ);\n\n\t \n\tread_move_cmd = append_move(desc, MOVE_SRC_DESCBUF |\n\t\t\t\t    MOVE_DEST_MATH3 |\n\t\t\t\t    (0x6 << MOVE_LEN_SHIFT));\n\twrite_move_cmd = append_move(desc, MOVE_SRC_MATH3 |\n\t\t\t\t     MOVE_DEST_DESCBUF |\n\t\t\t\t     MOVE_WAITCOMP |\n\t\t\t\t     (0x8 << MOVE_LEN_SHIFT));\n\n\t \n\tappend_operation(desc, adata->algtype | OP_ALG_AS_INITFINAL |\n\t\t\t OP_ALG_ENCRYPT);\n\n\t \n\taead_append_src_dst(desc, FIFOLD_TYPE_MSG | FIFOLD_TYPE_FLUSH1);\n\n\tset_move_tgt_here(desc, read_move_cmd);\n\tset_move_tgt_here(desc, write_move_cmd);\n\tappend_cmd(desc, CMD_LOAD | DISABLE_AUTO_INFO_FIFO);\n\tappend_move(desc, MOVE_SRC_INFIFO_CL | MOVE_DEST_OUTFIFO |\n\t\t    MOVE_AUX_LS);\n\n\t \n\tappend_seq_store(desc, icvsize, LDST_CLASS_2_CCB |\n\t\t\t LDST_SRCDST_BYTE_CONTEXT);\n\n\tprint_hex_dump_debug(\"aead null enc shdesc@\" __stringify(__LINE__)\": \",\n\t\t\t     DUMP_PREFIX_ADDRESS, 16, 4, desc, desc_bytes(desc),\n\t\t\t     1);\n}\nEXPORT_SYMBOL(cnstr_shdsc_aead_null_encap);\n\n \nvoid cnstr_shdsc_aead_null_decap(u32 * const desc, struct alginfo *adata,\n\t\t\t\t unsigned int icvsize, int era)\n{\n\tu32 *key_jump_cmd, *read_move_cmd, *write_move_cmd, *jump_cmd;\n\n\tinit_sh_desc(desc, HDR_SHARE_SERIAL);\n\n\t \n\tkey_jump_cmd = append_jump(desc, JUMP_JSL | JUMP_TEST_ALL |\n\t\t\t\t   JUMP_COND_SHRD);\n\tif (era < 6) {\n\t\tif (adata->key_inline)\n\t\t\tappend_key_as_imm(desc, adata->key_virt,\n\t\t\t\t\t  adata->keylen_pad, adata->keylen,\n\t\t\t\t\t  CLASS_2 | KEY_DEST_MDHA_SPLIT |\n\t\t\t\t\t  KEY_ENC);\n\t\telse\n\t\t\tappend_key(desc, adata->key_dma, adata->keylen,\n\t\t\t\t   CLASS_2 | KEY_DEST_MDHA_SPLIT | KEY_ENC);\n\t} else {\n\t\tappend_proto_dkp(desc, adata);\n\t}\n\tset_jump_tgt_here(desc, key_jump_cmd);\n\n\t \n\tappend_operation(desc, adata->algtype | OP_ALG_AS_INITFINAL |\n\t\t\t OP_ALG_DECRYPT | OP_ALG_ICV_ON);\n\n\t \n\tappend_math_sub(desc, REG2, SEQOUTLEN, REG0, CAAM_CMD_SZ);\n\n\t \n\tappend_math_add(desc, VARSEQINLEN, ZERO, REG2, CAAM_CMD_SZ);\n\tappend_math_add(desc, VARSEQOUTLEN, ZERO, REG2, CAAM_CMD_SZ);\n\n\t \n\tread_move_cmd = append_move(desc, MOVE_SRC_DESCBUF |\n\t\t\t\t    MOVE_DEST_MATH2 |\n\t\t\t\t    (0x6 << MOVE_LEN_SHIFT));\n\twrite_move_cmd = append_move(desc, MOVE_SRC_MATH2 |\n\t\t\t\t     MOVE_DEST_DESCBUF |\n\t\t\t\t     MOVE_WAITCOMP |\n\t\t\t\t     (0x8 << MOVE_LEN_SHIFT));\n\n\t \n\taead_append_src_dst(desc, FIFOLD_TYPE_MSG | FIFOLD_TYPE_FLUSH1);\n\n\t \n\tjump_cmd = append_jump(desc, JUMP_TEST_ALL);\n\tset_jump_tgt_here(desc, jump_cmd);\n\n\tset_move_tgt_here(desc, read_move_cmd);\n\tset_move_tgt_here(desc, write_move_cmd);\n\tappend_cmd(desc, CMD_LOAD | DISABLE_AUTO_INFO_FIFO);\n\tappend_move(desc, MOVE_SRC_INFIFO_CL | MOVE_DEST_OUTFIFO |\n\t\t    MOVE_AUX_LS);\n\tappend_cmd(desc, CMD_LOAD | ENABLE_AUTO_INFO_FIFO);\n\n\t \n\tappend_seq_fifo_load(desc, icvsize, FIFOLD_CLASS_CLASS2 |\n\t\t\t     FIFOLD_TYPE_LAST2 | FIFOLD_TYPE_ICV);\n\n\tprint_hex_dump_debug(\"aead null dec shdesc@\" __stringify(__LINE__)\": \",\n\t\t\t     DUMP_PREFIX_ADDRESS, 16, 4, desc, desc_bytes(desc),\n\t\t\t     1);\n}\nEXPORT_SYMBOL(cnstr_shdsc_aead_null_decap);\n\nstatic void init_sh_desc_key_aead(u32 * const desc,\n\t\t\t\t  struct alginfo * const cdata,\n\t\t\t\t  struct alginfo * const adata,\n\t\t\t\t  const bool is_rfc3686, u32 *nonce, int era)\n{\n\tu32 *key_jump_cmd;\n\tunsigned int enckeylen = cdata->keylen;\n\n\t \n\tinit_sh_desc(desc, HDR_SHARE_SERIAL | HDR_SAVECTX);\n\n\t \n\tkey_jump_cmd = append_jump(desc, JUMP_JSL | JUMP_TEST_ALL |\n\t\t\t\t   JUMP_COND_SHRD);\n\n\t \n\tif (is_rfc3686)\n\t\tenckeylen -= CTR_RFC3686_NONCE_SIZE;\n\n\tif (era < 6) {\n\t\tif (adata->key_inline)\n\t\t\tappend_key_as_imm(desc, adata->key_virt,\n\t\t\t\t\t  adata->keylen_pad, adata->keylen,\n\t\t\t\t\t  CLASS_2 | KEY_DEST_MDHA_SPLIT |\n\t\t\t\t\t  KEY_ENC);\n\t\telse\n\t\t\tappend_key(desc, adata->key_dma, adata->keylen,\n\t\t\t\t   CLASS_2 | KEY_DEST_MDHA_SPLIT | KEY_ENC);\n\t} else {\n\t\tappend_proto_dkp(desc, adata);\n\t}\n\n\tif (cdata->key_inline)\n\t\tappend_key_as_imm(desc, cdata->key_virt, enckeylen,\n\t\t\t\t  enckeylen, CLASS_1 | KEY_DEST_CLASS_REG);\n\telse\n\t\tappend_key(desc, cdata->key_dma, enckeylen, CLASS_1 |\n\t\t\t   KEY_DEST_CLASS_REG);\n\n\t \n\tif (is_rfc3686) {\n\t\tappend_load_as_imm(desc, nonce, CTR_RFC3686_NONCE_SIZE,\n\t\t\t\t   LDST_CLASS_IND_CCB |\n\t\t\t\t   LDST_SRCDST_BYTE_OUTFIFO | LDST_IMM);\n\t\tappend_move(desc,\n\t\t\t    MOVE_SRC_OUTFIFO |\n\t\t\t    MOVE_DEST_CLASS1CTX |\n\t\t\t    (16 << MOVE_OFFSET_SHIFT) |\n\t\t\t    (CTR_RFC3686_NONCE_SIZE << MOVE_LEN_SHIFT));\n\t}\n\n\tset_jump_tgt_here(desc, key_jump_cmd);\n}\n\n \nvoid cnstr_shdsc_aead_encap(u32 * const desc, struct alginfo *cdata,\n\t\t\t    struct alginfo *adata, unsigned int ivsize,\n\t\t\t    unsigned int icvsize, const bool is_rfc3686,\n\t\t\t    u32 *nonce, const u32 ctx1_iv_off, const bool is_qi,\n\t\t\t    int era)\n{\n\t \n\tinit_sh_desc_key_aead(desc, cdata, adata, is_rfc3686, nonce, era);\n\n\t \n\tappend_operation(desc, adata->algtype | OP_ALG_AS_INITFINAL |\n\t\t\t OP_ALG_ENCRYPT);\n\n\tif (is_qi) {\n\t\tu32 *wait_load_cmd;\n\n\t\t \n\t\tappend_seq_load(desc, 4, LDST_CLASS_DECO |\n\t\t\t\tLDST_SRCDST_WORD_DECO_MATH3 |\n\t\t\t\t(4 << LDST_OFFSET_SHIFT));\n\n\t\twait_load_cmd = append_jump(desc, JUMP_JSL | JUMP_TEST_ALL |\n\t\t\t\t\t    JUMP_COND_CALM | JUMP_COND_NCP |\n\t\t\t\t\t    JUMP_COND_NOP | JUMP_COND_NIP |\n\t\t\t\t\t    JUMP_COND_NIFP);\n\t\tset_jump_tgt_here(desc, wait_load_cmd);\n\n\t\tappend_seq_load(desc, ivsize, LDST_CLASS_1_CCB |\n\t\t\t\tLDST_SRCDST_BYTE_CONTEXT |\n\t\t\t\t(ctx1_iv_off << LDST_OFFSET_SHIFT));\n\t}\n\n\t \n\tif (is_qi || era < 3) {\n\t\tappend_math_add(desc, VARSEQINLEN, ZERO, REG3, CAAM_CMD_SZ);\n\t\tappend_math_add(desc, VARSEQOUTLEN, ZERO, REG3, CAAM_CMD_SZ);\n\t} else {\n\t\tappend_math_add(desc, VARSEQINLEN, ZERO, DPOVRD, CAAM_CMD_SZ);\n\t\tappend_math_add(desc, VARSEQOUTLEN, ZERO, DPOVRD, CAAM_CMD_SZ);\n\t}\n\n\t \n\tappend_seq_fifo_store(desc, 0, FIFOST_TYPE_SKIP | FIFOLDST_VLF);\n\n\t \n\tappend_seq_fifo_load(desc, 0, FIFOLD_CLASS_CLASS2 | FIFOLD_TYPE_MSG |\n\t\t\t\t      FIFOLDST_VLF);\n\n\t \n\tif (is_rfc3686)\n\t\tappend_load_imm_be32(desc, 1, LDST_IMM | LDST_CLASS_1_CCB |\n\t\t\t\t     LDST_SRCDST_BYTE_CONTEXT |\n\t\t\t\t     ((ctx1_iv_off + CTR_RFC3686_IV_SIZE) <<\n\t\t\t\t      LDST_OFFSET_SHIFT));\n\n\t \n\tappend_operation(desc, cdata->algtype | OP_ALG_AS_INITFINAL |\n\t\t\t OP_ALG_ENCRYPT);\n\n\t \n\tappend_math_add(desc, VARSEQINLEN, SEQINLEN, REG0, CAAM_CMD_SZ);\n\tappend_math_add(desc, VARSEQOUTLEN, SEQINLEN, REG0, CAAM_CMD_SZ);\n\taead_append_src_dst(desc, FIFOLD_TYPE_MSG1OUT2);\n\n\t \n\tappend_seq_store(desc, icvsize, LDST_CLASS_2_CCB |\n\t\t\t LDST_SRCDST_BYTE_CONTEXT);\n\n\tprint_hex_dump_debug(\"aead enc shdesc@\" __stringify(__LINE__)\": \",\n\t\t\t     DUMP_PREFIX_ADDRESS, 16, 4, desc, desc_bytes(desc),\n\t\t\t     1);\n}\nEXPORT_SYMBOL(cnstr_shdsc_aead_encap);\n\n \nvoid cnstr_shdsc_aead_decap(u32 * const desc, struct alginfo *cdata,\n\t\t\t    struct alginfo *adata, unsigned int ivsize,\n\t\t\t    unsigned int icvsize, const bool geniv,\n\t\t\t    const bool is_rfc3686, u32 *nonce,\n\t\t\t    const u32 ctx1_iv_off, const bool is_qi, int era)\n{\n\t \n\tinit_sh_desc_key_aead(desc, cdata, adata, is_rfc3686, nonce, era);\n\n\t \n\tappend_operation(desc, adata->algtype | OP_ALG_AS_INITFINAL |\n\t\t\t OP_ALG_DECRYPT | OP_ALG_ICV_ON);\n\n\tif (is_qi) {\n\t\tu32 *wait_load_cmd;\n\n\t\t \n\t\tappend_seq_load(desc, 4, LDST_CLASS_DECO |\n\t\t\t\tLDST_SRCDST_WORD_DECO_MATH3 |\n\t\t\t\t(4 << LDST_OFFSET_SHIFT));\n\n\t\twait_load_cmd = append_jump(desc, JUMP_JSL | JUMP_TEST_ALL |\n\t\t\t\t\t    JUMP_COND_CALM | JUMP_COND_NCP |\n\t\t\t\t\t    JUMP_COND_NOP | JUMP_COND_NIP |\n\t\t\t\t\t    JUMP_COND_NIFP);\n\t\tset_jump_tgt_here(desc, wait_load_cmd);\n\n\t\tif (!geniv)\n\t\t\tappend_seq_load(desc, ivsize, LDST_CLASS_1_CCB |\n\t\t\t\t\tLDST_SRCDST_BYTE_CONTEXT |\n\t\t\t\t\t(ctx1_iv_off << LDST_OFFSET_SHIFT));\n\t}\n\n\t \n\tif (is_qi || era < 3) {\n\t\tappend_math_add(desc, VARSEQINLEN, ZERO, REG3, CAAM_CMD_SZ);\n\t\tif (geniv)\n\t\t\tappend_math_add_imm_u32(desc, VARSEQOUTLEN, REG3, IMM,\n\t\t\t\t\t\tivsize);\n\t\telse\n\t\t\tappend_math_add(desc, VARSEQOUTLEN, ZERO, REG3,\n\t\t\t\t\tCAAM_CMD_SZ);\n\t} else {\n\t\tappend_math_add(desc, VARSEQINLEN, ZERO, DPOVRD, CAAM_CMD_SZ);\n\t\tif (geniv)\n\t\t\tappend_math_add_imm_u32(desc, VARSEQOUTLEN, DPOVRD, IMM,\n\t\t\t\t\t\tivsize);\n\t\telse\n\t\t\tappend_math_add(desc, VARSEQOUTLEN, ZERO, DPOVRD,\n\t\t\t\t\tCAAM_CMD_SZ);\n\t}\n\n\t \n\tappend_seq_fifo_store(desc, 0, FIFOST_TYPE_SKIP | FIFOLDST_VLF);\n\n\t \n\tappend_seq_fifo_load(desc, 0, FIFOLD_CLASS_CLASS2 | FIFOLD_TYPE_MSG |\n\t\t\t     KEY_VLF);\n\n\tif (geniv) {\n\t\tappend_seq_load(desc, ivsize, LDST_CLASS_1_CCB |\n\t\t\t\tLDST_SRCDST_BYTE_CONTEXT |\n\t\t\t\t(ctx1_iv_off << LDST_OFFSET_SHIFT));\n\t\tappend_move(desc, MOVE_SRC_CLASS1CTX | MOVE_DEST_CLASS2INFIFO |\n\t\t\t    (ctx1_iv_off << MOVE_OFFSET_SHIFT) | ivsize);\n\t}\n\n\t \n\tif (is_rfc3686)\n\t\tappend_load_imm_be32(desc, 1, LDST_IMM | LDST_CLASS_1_CCB |\n\t\t\t\t     LDST_SRCDST_BYTE_CONTEXT |\n\t\t\t\t     ((ctx1_iv_off + CTR_RFC3686_IV_SIZE) <<\n\t\t\t\t      LDST_OFFSET_SHIFT));\n\n\t \n\tif (ctx1_iv_off)\n\t\tappend_operation(desc, cdata->algtype | OP_ALG_AS_INITFINAL |\n\t\t\t\t OP_ALG_DECRYPT);\n\telse\n\t\tappend_dec_op1(desc, cdata->algtype);\n\n\t \n\tappend_math_add(desc, VARSEQINLEN, SEQOUTLEN, REG0, CAAM_CMD_SZ);\n\tappend_math_add(desc, VARSEQOUTLEN, SEQOUTLEN, REG0, CAAM_CMD_SZ);\n\taead_append_src_dst(desc, FIFOLD_TYPE_MSG);\n\n\t \n\tappend_seq_fifo_load(desc, icvsize, FIFOLD_CLASS_CLASS2 |\n\t\t\t     FIFOLD_TYPE_LAST2 | FIFOLD_TYPE_ICV);\n\n\tprint_hex_dump_debug(\"aead dec shdesc@\" __stringify(__LINE__)\": \",\n\t\t\t     DUMP_PREFIX_ADDRESS, 16, 4, desc, desc_bytes(desc),\n\t\t\t     1);\n}\nEXPORT_SYMBOL(cnstr_shdsc_aead_decap);\n\n \nvoid cnstr_shdsc_aead_givencap(u32 * const desc, struct alginfo *cdata,\n\t\t\t       struct alginfo *adata, unsigned int ivsize,\n\t\t\t       unsigned int icvsize, const bool is_rfc3686,\n\t\t\t       u32 *nonce, const u32 ctx1_iv_off,\n\t\t\t       const bool is_qi, int era)\n{\n\tu32 geniv, moveiv;\n\tu32 *wait_cmd;\n\n\t \n\tinit_sh_desc_key_aead(desc, cdata, adata, is_rfc3686, nonce, era);\n\n\tif (is_qi) {\n\t\tu32 *wait_load_cmd;\n\n\t\t \n\t\tappend_seq_load(desc, 4, LDST_CLASS_DECO |\n\t\t\t\tLDST_SRCDST_WORD_DECO_MATH3 |\n\t\t\t\t(4 << LDST_OFFSET_SHIFT));\n\n\t\twait_load_cmd = append_jump(desc, JUMP_JSL | JUMP_TEST_ALL |\n\t\t\t\t\t    JUMP_COND_CALM | JUMP_COND_NCP |\n\t\t\t\t\t    JUMP_COND_NOP | JUMP_COND_NIP |\n\t\t\t\t\t    JUMP_COND_NIFP);\n\t\tset_jump_tgt_here(desc, wait_load_cmd);\n\t}\n\n\tif (is_rfc3686) {\n\t\tif (is_qi)\n\t\t\tappend_seq_load(desc, ivsize, LDST_CLASS_1_CCB |\n\t\t\t\t\tLDST_SRCDST_BYTE_CONTEXT |\n\t\t\t\t\t(ctx1_iv_off << LDST_OFFSET_SHIFT));\n\n\t\tgoto copy_iv;\n\t}\n\n\t \n\tgeniv = NFIFOENTRY_STYPE_PAD | NFIFOENTRY_DEST_DECO |\n\t\tNFIFOENTRY_DTYPE_MSG | NFIFOENTRY_LC1 |\n\t\tNFIFOENTRY_PTYPE_RND | (ivsize << NFIFOENTRY_DLEN_SHIFT);\n\tappend_load_imm_u32(desc, geniv, LDST_CLASS_IND_CCB |\n\t\t\t    LDST_SRCDST_WORD_INFO_FIFO | LDST_IMM);\n\tappend_cmd(desc, CMD_LOAD | DISABLE_AUTO_INFO_FIFO);\n\tappend_move(desc, MOVE_WAITCOMP |\n\t\t    MOVE_SRC_INFIFO | MOVE_DEST_CLASS1CTX |\n\t\t    (ctx1_iv_off << MOVE_OFFSET_SHIFT) |\n\t\t    (ivsize << MOVE_LEN_SHIFT));\n\tappend_cmd(desc, CMD_LOAD | ENABLE_AUTO_INFO_FIFO);\n\ncopy_iv:\n\t \n\tappend_move(desc, MOVE_SRC_CLASS1CTX | MOVE_DEST_OUTFIFO |\n\t\t    (ctx1_iv_off << MOVE_OFFSET_SHIFT) |\n\t\t    (ivsize << MOVE_LEN_SHIFT));\n\n\t \n\tappend_operation(desc, adata->algtype | OP_ALG_AS_INITFINAL |\n\t\t\t OP_ALG_ENCRYPT);\n\n\t \n\tif (is_qi || era < 3) {\n\t\tappend_math_add(desc, VARSEQINLEN, ZERO, REG3, CAAM_CMD_SZ);\n\t\tappend_math_add(desc, VARSEQOUTLEN, ZERO, REG3, CAAM_CMD_SZ);\n\t} else {\n\t\tappend_math_add(desc, VARSEQINLEN, ZERO, DPOVRD, CAAM_CMD_SZ);\n\t\tappend_math_add(desc, VARSEQOUTLEN, ZERO, DPOVRD, CAAM_CMD_SZ);\n\t}\n\n\t \n\tappend_seq_fifo_store(desc, 0, FIFOST_TYPE_SKIP | FIFOLDST_VLF);\n\n\t \n\tappend_seq_fifo_load(desc, 0, FIFOLD_CLASS_CLASS2 | FIFOLD_TYPE_MSG |\n\t\t\t     KEY_VLF);\n\n\t \n\tmoveiv = NFIFOENTRY_STYPE_OFIFO | NFIFOENTRY_DEST_CLASS2 |\n\t\t NFIFOENTRY_DTYPE_MSG | (ivsize << NFIFOENTRY_DLEN_SHIFT);\n\tappend_load_imm_u32(desc, moveiv, LDST_CLASS_IND_CCB |\n\t\t\t    LDST_SRCDST_WORD_INFO_FIFO | LDST_IMM);\n\tappend_load_imm_u32(desc, ivsize, LDST_CLASS_2_CCB |\n\t\t\t    LDST_SRCDST_WORD_DATASZ_REG | LDST_IMM);\n\n\t \n\tif (is_rfc3686)\n\t\tappend_load_imm_be32(desc, 1, LDST_IMM | LDST_CLASS_1_CCB |\n\t\t\t\t     LDST_SRCDST_BYTE_CONTEXT |\n\t\t\t\t     ((ctx1_iv_off + CTR_RFC3686_IV_SIZE) <<\n\t\t\t\t      LDST_OFFSET_SHIFT));\n\n\t \n\tappend_operation(desc, cdata->algtype | OP_ALG_AS_INITFINAL |\n\t\t\t OP_ALG_ENCRYPT);\n\n\t \n\tappend_math_add(desc, VARSEQOUTLEN, SEQINLEN, REG0, CAAM_CMD_SZ);\n\n\t \n\tappend_seq_fifo_load(desc, ivsize,\n\t\t\t     FIFOLD_CLASS_SKIP);\n\n\t \n\tappend_math_add(desc, VARSEQINLEN, SEQINLEN, REG0, CAAM_CMD_SZ);\n\n\t \n\twait_cmd = append_jump(desc, JUMP_JSL | JUMP_TEST_ALL | JUMP_COND_NIFP);\n\tset_jump_tgt_here(desc, wait_cmd);\n\n\tappend_seq_fifo_load(desc, 0, FIFOLD_CLASS_BOTH | KEY_VLF |\n\t\t\t     FIFOLD_TYPE_MSG1OUT2 | FIFOLD_TYPE_LASTBOTH);\n\tappend_seq_fifo_store(desc, 0, FIFOST_TYPE_MESSAGE_DATA | KEY_VLF);\n\n\t \n\tappend_seq_store(desc, icvsize, LDST_CLASS_2_CCB |\n\t\t\t LDST_SRCDST_BYTE_CONTEXT);\n\n\tprint_hex_dump_debug(\"aead givenc shdesc@\" __stringify(__LINE__)\": \",\n\t\t\t     DUMP_PREFIX_ADDRESS, 16, 4, desc, desc_bytes(desc),\n\t\t\t     1);\n}\nEXPORT_SYMBOL(cnstr_shdsc_aead_givencap);\n\n \nvoid cnstr_shdsc_gcm_encap(u32 * const desc, struct alginfo *cdata,\n\t\t\t   unsigned int ivsize, unsigned int icvsize,\n\t\t\t   const bool is_qi)\n{\n\tu32 *key_jump_cmd, *zero_payload_jump_cmd, *zero_assoc_jump_cmd1,\n\t    *zero_assoc_jump_cmd2;\n\n\tinit_sh_desc(desc, HDR_SHARE_SERIAL);\n\n\t \n\tkey_jump_cmd = append_jump(desc, JUMP_JSL | JUMP_TEST_ALL |\n\t\t\t\t   JUMP_COND_SHRD);\n\tif (cdata->key_inline)\n\t\tappend_key_as_imm(desc, cdata->key_virt, cdata->keylen,\n\t\t\t\t  cdata->keylen, CLASS_1 | KEY_DEST_CLASS_REG);\n\telse\n\t\tappend_key(desc, cdata->key_dma, cdata->keylen, CLASS_1 |\n\t\t\t   KEY_DEST_CLASS_REG);\n\tset_jump_tgt_here(desc, key_jump_cmd);\n\n\t \n\tappend_operation(desc, cdata->algtype | OP_ALG_AS_INITFINAL |\n\t\t\t OP_ALG_ENCRYPT);\n\n\tif (is_qi) {\n\t\tu32 *wait_load_cmd;\n\n\t\t \n\t\tappend_seq_load(desc, 4, LDST_CLASS_DECO |\n\t\t\t\tLDST_SRCDST_WORD_DECO_MATH3 |\n\t\t\t\t(4 << LDST_OFFSET_SHIFT));\n\n\t\twait_load_cmd = append_jump(desc, JUMP_JSL | JUMP_TEST_ALL |\n\t\t\t\t\t    JUMP_COND_CALM | JUMP_COND_NCP |\n\t\t\t\t\t    JUMP_COND_NOP | JUMP_COND_NIP |\n\t\t\t\t\t    JUMP_COND_NIFP);\n\t\tset_jump_tgt_here(desc, wait_load_cmd);\n\n\t\tappend_math_sub_imm_u32(desc, VARSEQOUTLEN, SEQINLEN, IMM,\n\t\t\t\t\tivsize);\n\t} else {\n\t\tappend_math_sub(desc, VARSEQOUTLEN, SEQINLEN, REG0,\n\t\t\t\tCAAM_CMD_SZ);\n\t}\n\n\t \n\tzero_assoc_jump_cmd2 = append_jump(desc, JUMP_TEST_ALL |\n\t\t\t\t\t\t JUMP_COND_MATH_Z);\n\n\tif (is_qi)\n\t\tappend_seq_fifo_load(desc, ivsize, FIFOLD_CLASS_CLASS1 |\n\t\t\t\t     FIFOLD_TYPE_IV | FIFOLD_TYPE_FLUSH1);\n\n\t \n\tappend_math_add(desc, VARSEQINLEN, ZERO, REG3, CAAM_CMD_SZ);\n\tzero_assoc_jump_cmd1 = append_jump(desc, JUMP_TEST_ALL |\n\t\t\t\t\t   JUMP_COND_MATH_Z);\n\n\tappend_math_add(desc, VARSEQOUTLEN, ZERO, REG3, CAAM_CMD_SZ);\n\n\t \n\tappend_seq_fifo_store(desc, 0, FIFOST_TYPE_SKIP | FIFOLDST_VLF);\n\n\t \n\tappend_math_sub(desc, VARSEQOUTLEN, SEQINLEN, REG3, CAAM_CMD_SZ);\n\n\t \n\tzero_payload_jump_cmd = append_jump(desc, JUMP_TEST_ALL |\n\t\t\t\t\t    JUMP_COND_MATH_Z);\n\n\t \n\tappend_seq_fifo_load(desc, 0, FIFOLD_CLASS_CLASS1 | FIFOLDST_VLF |\n\t\t\t     FIFOLD_TYPE_AAD | FIFOLD_TYPE_FLUSH1);\n\tset_jump_tgt_here(desc, zero_assoc_jump_cmd1);\n\n\tappend_math_sub(desc, VARSEQINLEN, SEQINLEN, REG0, CAAM_CMD_SZ);\n\n\t \n\tappend_seq_fifo_store(desc, 0, FIFOST_TYPE_MESSAGE_DATA | FIFOLDST_VLF);\n\n\t \n\tappend_seq_fifo_load(desc, 0, FIFOLD_CLASS_CLASS1 | FIFOLDST_VLF |\n\t\t\t     FIFOLD_TYPE_MSG | FIFOLD_TYPE_LAST1);\n\n\t \n\tif (is_qi)\n\t\tappend_jump(desc, JUMP_TEST_ALL | 4);\n\telse\n\t\tappend_jump(desc, JUMP_TEST_ALL | 2);\n\n\t \n\tset_jump_tgt_here(desc, zero_payload_jump_cmd);\n\n\t \n\tappend_seq_fifo_load(desc, 0, FIFOLD_CLASS_CLASS1 | FIFOLDST_VLF |\n\t\t\t     FIFOLD_TYPE_AAD | FIFOLD_TYPE_LAST1);\n\tif (is_qi)\n\t\t \n\t\tappend_jump(desc, JUMP_TEST_ALL | 2);\n\n\t \n\tset_jump_tgt_here(desc, zero_assoc_jump_cmd2);\n\n\tif (is_qi)\n\t\tappend_seq_fifo_load(desc, ivsize, FIFOLD_CLASS_CLASS1 |\n\t\t\t\t     FIFOLD_TYPE_IV | FIFOLD_TYPE_FLUSH1 |\n\t\t\t\t     FIFOLD_TYPE_LAST1);\n\n\t \n\tappend_seq_store(desc, icvsize, LDST_CLASS_1_CCB |\n\t\t\t LDST_SRCDST_BYTE_CONTEXT);\n\n\tprint_hex_dump_debug(\"gcm enc shdesc@\" __stringify(__LINE__)\": \",\n\t\t\t     DUMP_PREFIX_ADDRESS, 16, 4, desc, desc_bytes(desc),\n\t\t\t     1);\n}\nEXPORT_SYMBOL(cnstr_shdsc_gcm_encap);\n\n \nvoid cnstr_shdsc_gcm_decap(u32 * const desc, struct alginfo *cdata,\n\t\t\t   unsigned int ivsize, unsigned int icvsize,\n\t\t\t   const bool is_qi)\n{\n\tu32 *key_jump_cmd, *zero_payload_jump_cmd, *zero_assoc_jump_cmd1;\n\n\tinit_sh_desc(desc, HDR_SHARE_SERIAL);\n\n\t \n\tkey_jump_cmd = append_jump(desc, JUMP_JSL |\n\t\t\t\t   JUMP_TEST_ALL | JUMP_COND_SHRD);\n\tif (cdata->key_inline)\n\t\tappend_key_as_imm(desc, cdata->key_virt, cdata->keylen,\n\t\t\t\t  cdata->keylen, CLASS_1 | KEY_DEST_CLASS_REG);\n\telse\n\t\tappend_key(desc, cdata->key_dma, cdata->keylen, CLASS_1 |\n\t\t\t   KEY_DEST_CLASS_REG);\n\tset_jump_tgt_here(desc, key_jump_cmd);\n\n\t \n\tappend_operation(desc, cdata->algtype | OP_ALG_AS_INITFINAL |\n\t\t\t OP_ALG_DECRYPT | OP_ALG_ICV_ON);\n\n\tif (is_qi) {\n\t\tu32 *wait_load_cmd;\n\n\t\t \n\t\tappend_seq_load(desc, 4, LDST_CLASS_DECO |\n\t\t\t\tLDST_SRCDST_WORD_DECO_MATH3 |\n\t\t\t\t(4 << LDST_OFFSET_SHIFT));\n\n\t\twait_load_cmd = append_jump(desc, JUMP_JSL | JUMP_TEST_ALL |\n\t\t\t\t\t    JUMP_COND_CALM | JUMP_COND_NCP |\n\t\t\t\t\t    JUMP_COND_NOP | JUMP_COND_NIP |\n\t\t\t\t\t    JUMP_COND_NIFP);\n\t\tset_jump_tgt_here(desc, wait_load_cmd);\n\n\t\tappend_seq_fifo_load(desc, ivsize, FIFOLD_CLASS_CLASS1 |\n\t\t\t\t     FIFOLD_TYPE_IV | FIFOLD_TYPE_FLUSH1);\n\t}\n\n\t \n\tappend_math_add(desc, VARSEQINLEN, ZERO, REG3, CAAM_CMD_SZ);\n\tzero_assoc_jump_cmd1 = append_jump(desc, JUMP_TEST_ALL |\n\t\t\t\t\t\t JUMP_COND_MATH_Z);\n\n\tappend_math_add(desc, VARSEQOUTLEN, ZERO, REG3, CAAM_CMD_SZ);\n\n\t \n\tappend_seq_fifo_store(desc, 0, FIFOST_TYPE_SKIP | FIFOLDST_VLF);\n\n\t \n\tappend_seq_fifo_load(desc, 0, FIFOLD_CLASS_CLASS1 | FIFOLDST_VLF |\n\t\t\t     FIFOLD_TYPE_AAD | FIFOLD_TYPE_FLUSH1);\n\n\tset_jump_tgt_here(desc, zero_assoc_jump_cmd1);\n\n\t \n\tappend_math_sub(desc, VARSEQINLEN, SEQOUTLEN, REG0, CAAM_CMD_SZ);\n\n\t \n\tzero_payload_jump_cmd = append_jump(desc, JUMP_TEST_ALL |\n\t\t\t\t\t    JUMP_COND_MATH_Z);\n\n\tappend_math_sub(desc, VARSEQOUTLEN, SEQOUTLEN, REG0, CAAM_CMD_SZ);\n\n\t \n\tappend_seq_fifo_store(desc, 0, FIFOST_TYPE_MESSAGE_DATA | FIFOLDST_VLF);\n\n\t \n\tappend_seq_fifo_load(desc, 0, FIFOLD_CLASS_CLASS1 | FIFOLDST_VLF |\n\t\t\t     FIFOLD_TYPE_MSG | FIFOLD_TYPE_FLUSH1);\n\n\t \n\tset_jump_tgt_here(desc, zero_payload_jump_cmd);\n\n\t \n\tappend_seq_fifo_load(desc, icvsize, FIFOLD_CLASS_CLASS1 |\n\t\t\t     FIFOLD_TYPE_ICV | FIFOLD_TYPE_LAST1);\n\n\tprint_hex_dump_debug(\"gcm dec shdesc@\" __stringify(__LINE__)\": \",\n\t\t\t     DUMP_PREFIX_ADDRESS, 16, 4, desc, desc_bytes(desc),\n\t\t\t     1);\n}\nEXPORT_SYMBOL(cnstr_shdsc_gcm_decap);\n\n \nvoid cnstr_shdsc_rfc4106_encap(u32 * const desc, struct alginfo *cdata,\n\t\t\t       unsigned int ivsize, unsigned int icvsize,\n\t\t\t       const bool is_qi)\n{\n\tu32 *key_jump_cmd, *zero_cryptlen_jump_cmd, *skip_instructions;\n\tinit_sh_desc(desc, HDR_SHARE_SERIAL);\n\n\t \n\tkey_jump_cmd = append_jump(desc, JUMP_JSL | JUMP_TEST_ALL |\n\t\t\t\t   JUMP_COND_SHRD);\n\tif (cdata->key_inline)\n\t\tappend_key_as_imm(desc, cdata->key_virt, cdata->keylen,\n\t\t\t\t  cdata->keylen, CLASS_1 | KEY_DEST_CLASS_REG);\n\telse\n\t\tappend_key(desc, cdata->key_dma, cdata->keylen, CLASS_1 |\n\t\t\t   KEY_DEST_CLASS_REG);\n\tset_jump_tgt_here(desc, key_jump_cmd);\n\n\t \n\tappend_operation(desc, cdata->algtype | OP_ALG_AS_INITFINAL |\n\t\t\t OP_ALG_ENCRYPT);\n\n\tif (is_qi) {\n\t\tu32 *wait_load_cmd;\n\n\t\t \n\t\tappend_seq_load(desc, 4, LDST_CLASS_DECO |\n\t\t\t\tLDST_SRCDST_WORD_DECO_MATH3 |\n\t\t\t\t(4 << LDST_OFFSET_SHIFT));\n\n\t\twait_load_cmd = append_jump(desc, JUMP_JSL | JUMP_TEST_ALL |\n\t\t\t\t\t    JUMP_COND_CALM | JUMP_COND_NCP |\n\t\t\t\t\t    JUMP_COND_NOP | JUMP_COND_NIP |\n\t\t\t\t\t    JUMP_COND_NIFP);\n\t\tset_jump_tgt_here(desc, wait_load_cmd);\n\n\t\t \n\t\tappend_fifo_load_as_imm(desc, (void *)(cdata->key_virt +\n\t\t\t\t\tcdata->keylen), 4, FIFOLD_CLASS_CLASS1 |\n\t\t\t\t\tFIFOLD_TYPE_IV);\n\t\tappend_seq_fifo_load(desc, ivsize, FIFOLD_CLASS_CLASS1 |\n\t\t\t\t     FIFOLD_TYPE_IV | FIFOLD_TYPE_FLUSH1);\n\t}\n\n\tappend_math_sub_imm_u32(desc, VARSEQINLEN, REG3, IMM, ivsize);\n\tappend_math_add(desc, VARSEQOUTLEN, ZERO, REG3, CAAM_CMD_SZ);\n\n\t \n\tappend_seq_fifo_store(desc, 0, FIFOST_TYPE_SKIP | FIFOLDST_VLF);\n\n\t \n\tappend_math_sub(desc, VARSEQOUTLEN, SEQINLEN, REG3, CAAM_CMD_SZ);\n\n\t \n\tzero_cryptlen_jump_cmd = append_jump(desc, JUMP_TEST_ALL |\n\t\t\t\t\t    JUMP_COND_MATH_Z);\n\n\t \n\tappend_seq_fifo_load(desc, 0, FIFOLD_CLASS_CLASS1 | FIFOLDST_VLF |\n\t\t\t     FIFOLD_TYPE_AAD | FIFOLD_TYPE_FLUSH1);\n\n\t \n\tappend_seq_fifo_store(desc, 0, FIFOST_TYPE_MESSAGE_DATA);\n\n\t \n\tappend_seq_fifo_load(desc, ivsize, FIFOLD_CLASS_SKIP);\n\tappend_math_add(desc, VARSEQINLEN, VARSEQOUTLEN, REG0, CAAM_CMD_SZ);\n\n\t \n\tappend_seq_fifo_store(desc, 0, FIFOST_TYPE_MESSAGE_DATA | FIFOLDST_VLF);\n\n\t \n\tappend_seq_fifo_load(desc, 0, FIFOLD_CLASS_CLASS1 | FIFOLDST_VLF |\n\t\t\t     FIFOLD_TYPE_MSG | FIFOLD_TYPE_LAST1);\n\n\t \n\tskip_instructions = append_jump(desc, JUMP_TEST_ALL);\n\n\t \n\tset_jump_tgt_here(desc, zero_cryptlen_jump_cmd);\n\n\t \n\tappend_seq_fifo_load(desc, 0, FIFOLD_CLASS_CLASS1 | FIFOLDST_VLF |\n\t\t\t     FIFOLD_TYPE_AAD | FIFOLD_TYPE_LAST1);\n\n\tset_jump_tgt_here(desc, skip_instructions);\n\n\t \n\tappend_seq_store(desc, icvsize, LDST_CLASS_1_CCB |\n\t\t\t LDST_SRCDST_BYTE_CONTEXT);\n\n\tprint_hex_dump_debug(\"rfc4106 enc shdesc@\" __stringify(__LINE__)\": \",\n\t\t\t     DUMP_PREFIX_ADDRESS, 16, 4, desc, desc_bytes(desc),\n\t\t\t     1);\n}\nEXPORT_SYMBOL(cnstr_shdsc_rfc4106_encap);\n\n \nvoid cnstr_shdsc_rfc4106_decap(u32 * const desc, struct alginfo *cdata,\n\t\t\t       unsigned int ivsize, unsigned int icvsize,\n\t\t\t       const bool is_qi)\n{\n\tu32 *key_jump_cmd;\n\n\tinit_sh_desc(desc, HDR_SHARE_SERIAL);\n\n\t \n\tkey_jump_cmd = append_jump(desc, JUMP_JSL | JUMP_TEST_ALL |\n\t\t\t\t   JUMP_COND_SHRD);\n\tif (cdata->key_inline)\n\t\tappend_key_as_imm(desc, cdata->key_virt, cdata->keylen,\n\t\t\t\t  cdata->keylen, CLASS_1 |\n\t\t\t\t  KEY_DEST_CLASS_REG);\n\telse\n\t\tappend_key(desc, cdata->key_dma, cdata->keylen, CLASS_1 |\n\t\t\t   KEY_DEST_CLASS_REG);\n\tset_jump_tgt_here(desc, key_jump_cmd);\n\n\t \n\tappend_operation(desc, cdata->algtype | OP_ALG_AS_INITFINAL |\n\t\t\t OP_ALG_DECRYPT | OP_ALG_ICV_ON);\n\n\tif (is_qi) {\n\t\tu32 *wait_load_cmd;\n\n\t\t \n\t\tappend_seq_load(desc, 4, LDST_CLASS_DECO |\n\t\t\t\tLDST_SRCDST_WORD_DECO_MATH3 |\n\t\t\t\t(4 << LDST_OFFSET_SHIFT));\n\n\t\twait_load_cmd = append_jump(desc, JUMP_JSL | JUMP_TEST_ALL |\n\t\t\t\t\t    JUMP_COND_CALM | JUMP_COND_NCP |\n\t\t\t\t\t    JUMP_COND_NOP | JUMP_COND_NIP |\n\t\t\t\t\t    JUMP_COND_NIFP);\n\t\tset_jump_tgt_here(desc, wait_load_cmd);\n\n\t\t \n\t\tappend_fifo_load_as_imm(desc, (void *)(cdata->key_virt +\n\t\t\t\t\tcdata->keylen), 4, FIFOLD_CLASS_CLASS1 |\n\t\t\t\t\tFIFOLD_TYPE_IV);\n\t\tappend_seq_fifo_load(desc, ivsize, FIFOLD_CLASS_CLASS1 |\n\t\t\t\t     FIFOLD_TYPE_IV | FIFOLD_TYPE_FLUSH1);\n\t}\n\n\tappend_math_sub_imm_u32(desc, VARSEQINLEN, REG3, IMM, ivsize);\n\tappend_math_add(desc, VARSEQOUTLEN, ZERO, REG3, CAAM_CMD_SZ);\n\n\t \n\tappend_seq_fifo_load(desc, 0, FIFOLD_CLASS_CLASS1 | FIFOLDST_VLF |\n\t\t\t     FIFOLD_TYPE_AAD | FIFOLD_TYPE_FLUSH1);\n\n\t \n\tappend_seq_fifo_load(desc, ivsize, FIFOLD_CLASS_SKIP);\n\n\t \n\tappend_math_sub(desc, VARSEQINLEN, SEQOUTLEN, REG3, CAAM_CMD_SZ);\n\n\t \n\tappend_seq_fifo_load(desc, 0, FIFOLD_CLASS_CLASS1 | FIFOLD_TYPE_MSG);\n\n\t \n\tappend_seq_fifo_store(desc, 0, FIFOST_TYPE_SKIP | FIFOLDST_VLF);\n\n\t \n\tappend_math_sub(desc, VARSEQOUTLEN, SEQOUTLEN, REG0, CAAM_CMD_SZ);\n\n\t \n\tappend_seq_fifo_store(desc, 0, FIFOST_TYPE_MESSAGE_DATA | FIFOLDST_VLF);\n\n\t \n\tappend_seq_fifo_load(desc, 0, FIFOLD_CLASS_CLASS1 | FIFOLDST_VLF |\n\t\t\t     FIFOLD_TYPE_MSG | FIFOLD_TYPE_FLUSH1);\n\n\t \n\tappend_seq_fifo_load(desc, icvsize, FIFOLD_CLASS_CLASS1 |\n\t\t\t     FIFOLD_TYPE_ICV | FIFOLD_TYPE_LAST1);\n\n\tprint_hex_dump_debug(\"rfc4106 dec shdesc@\" __stringify(__LINE__)\": \",\n\t\t\t     DUMP_PREFIX_ADDRESS, 16, 4, desc, desc_bytes(desc),\n\t\t\t     1);\n}\nEXPORT_SYMBOL(cnstr_shdsc_rfc4106_decap);\n\n \nvoid cnstr_shdsc_rfc4543_encap(u32 * const desc, struct alginfo *cdata,\n\t\t\t       unsigned int ivsize, unsigned int icvsize,\n\t\t\t       const bool is_qi)\n{\n\tu32 *key_jump_cmd, *read_move_cmd, *write_move_cmd;\n\n\tinit_sh_desc(desc, HDR_SHARE_SERIAL);\n\n\t \n\tkey_jump_cmd = append_jump(desc, JUMP_JSL | JUMP_TEST_ALL |\n\t\t\t\t   JUMP_COND_SHRD);\n\tif (cdata->key_inline)\n\t\tappend_key_as_imm(desc, cdata->key_virt, cdata->keylen,\n\t\t\t\t  cdata->keylen, CLASS_1 | KEY_DEST_CLASS_REG);\n\telse\n\t\tappend_key(desc, cdata->key_dma, cdata->keylen, CLASS_1 |\n\t\t\t   KEY_DEST_CLASS_REG);\n\tset_jump_tgt_here(desc, key_jump_cmd);\n\n\t \n\tappend_operation(desc, cdata->algtype | OP_ALG_AS_INITFINAL |\n\t\t\t OP_ALG_ENCRYPT);\n\n\tif (is_qi) {\n\t\t \n\t\tappend_seq_fifo_load(desc, 4, FIFOLD_CLASS_SKIP);\n\n\t\t \n\t\tappend_fifo_load_as_imm(desc, (void *)(cdata->key_virt +\n\t\t\t\t\tcdata->keylen), 4, FIFOLD_CLASS_CLASS1 |\n\t\t\t\t\tFIFOLD_TYPE_IV);\n\t\tappend_seq_fifo_load(desc, ivsize, FIFOLD_CLASS_CLASS1 |\n\t\t\t\t     FIFOLD_TYPE_IV | FIFOLD_TYPE_FLUSH1);\n\t}\n\n\t \n\tappend_math_sub(desc, REG3, SEQINLEN, REG0, CAAM_CMD_SZ);\n\n\t \n\tread_move_cmd = append_move(desc, MOVE_SRC_DESCBUF | MOVE_DEST_MATH3 |\n\t\t\t\t    (0x6 << MOVE_LEN_SHIFT));\n\twrite_move_cmd = append_move(desc, MOVE_SRC_MATH3 | MOVE_DEST_DESCBUF |\n\t\t\t\t     (0x8 << MOVE_LEN_SHIFT) | MOVE_WAITCOMP);\n\n\t \n\tappend_math_sub(desc, VARSEQINLEN, SEQINLEN, REG0, CAAM_CMD_SZ);\n\n\t \n\tappend_math_sub(desc, VARSEQOUTLEN, SEQINLEN, REG0, CAAM_CMD_SZ);\n\n\t \n\taead_append_src_dst(desc, FIFOLD_TYPE_AAD);\n\n\tset_move_tgt_here(desc, read_move_cmd);\n\tset_move_tgt_here(desc, write_move_cmd);\n\tappend_cmd(desc, CMD_LOAD | DISABLE_AUTO_INFO_FIFO);\n\t \n\tappend_move(desc, MOVE_SRC_INFIFO_CL | MOVE_DEST_OUTFIFO);\n\n\t \n\tappend_seq_store(desc, icvsize, LDST_CLASS_1_CCB |\n\t\t\t LDST_SRCDST_BYTE_CONTEXT);\n\n\tprint_hex_dump_debug(\"rfc4543 enc shdesc@\" __stringify(__LINE__)\": \",\n\t\t\t     DUMP_PREFIX_ADDRESS, 16, 4, desc, desc_bytes(desc),\n\t\t\t     1);\n}\nEXPORT_SYMBOL(cnstr_shdsc_rfc4543_encap);\n\n \nvoid cnstr_shdsc_rfc4543_decap(u32 * const desc, struct alginfo *cdata,\n\t\t\t       unsigned int ivsize, unsigned int icvsize,\n\t\t\t       const bool is_qi)\n{\n\tu32 *key_jump_cmd, *read_move_cmd, *write_move_cmd;\n\n\tinit_sh_desc(desc, HDR_SHARE_SERIAL);\n\n\t \n\tkey_jump_cmd = append_jump(desc, JUMP_JSL | JUMP_TEST_ALL |\n\t\t\t\t   JUMP_COND_SHRD);\n\tif (cdata->key_inline)\n\t\tappend_key_as_imm(desc, cdata->key_virt, cdata->keylen,\n\t\t\t\t  cdata->keylen, CLASS_1 | KEY_DEST_CLASS_REG);\n\telse\n\t\tappend_key(desc, cdata->key_dma, cdata->keylen, CLASS_1 |\n\t\t\t   KEY_DEST_CLASS_REG);\n\tset_jump_tgt_here(desc, key_jump_cmd);\n\n\t \n\tappend_operation(desc, cdata->algtype | OP_ALG_AS_INITFINAL |\n\t\t\t OP_ALG_DECRYPT | OP_ALG_ICV_ON);\n\n\tif (is_qi) {\n\t\t \n\t\tappend_seq_fifo_load(desc, 4, FIFOLD_CLASS_SKIP);\n\n\t\t \n\t\tappend_fifo_load_as_imm(desc, (void *)(cdata->key_virt +\n\t\t\t\t\tcdata->keylen), 4, FIFOLD_CLASS_CLASS1 |\n\t\t\t\t\tFIFOLD_TYPE_IV);\n\t\tappend_seq_fifo_load(desc, ivsize, FIFOLD_CLASS_CLASS1 |\n\t\t\t\t     FIFOLD_TYPE_IV | FIFOLD_TYPE_FLUSH1);\n\t}\n\n\t \n\tappend_math_sub(desc, REG3, SEQOUTLEN, REG0, CAAM_CMD_SZ);\n\n\t \n\tread_move_cmd = append_move(desc, MOVE_SRC_DESCBUF | MOVE_DEST_MATH3 |\n\t\t\t\t    (0x6 << MOVE_LEN_SHIFT));\n\twrite_move_cmd = append_move(desc, MOVE_SRC_MATH3 | MOVE_DEST_DESCBUF |\n\t\t\t\t     (0x8 << MOVE_LEN_SHIFT) | MOVE_WAITCOMP);\n\n\t \n\tappend_math_sub(desc, VARSEQINLEN, SEQOUTLEN, REG0, CAAM_CMD_SZ);\n\n\t \n\tappend_math_sub(desc, VARSEQOUTLEN, SEQOUTLEN, REG0, CAAM_CMD_SZ);\n\n\t \n\tappend_seq_fifo_store(desc, 0, FIFOST_TYPE_MESSAGE_DATA | FIFOLDST_VLF);\n\n\t \n\tappend_seq_fifo_load(desc, 0, FIFOLD_CLASS_BOTH | FIFOLDST_VLF |\n\t\t\t     FIFOLD_TYPE_AAD | FIFOLD_TYPE_LAST2FLUSH1);\n\n\tset_move_tgt_here(desc, read_move_cmd);\n\tset_move_tgt_here(desc, write_move_cmd);\n\tappend_cmd(desc, CMD_LOAD | DISABLE_AUTO_INFO_FIFO);\n\t \n\tappend_move(desc, MOVE_SRC_INFIFO_CL | MOVE_DEST_OUTFIFO);\n\tappend_cmd(desc, CMD_LOAD | ENABLE_AUTO_INFO_FIFO);\n\n\t \n\tappend_seq_fifo_load(desc, icvsize, FIFOLD_CLASS_CLASS1 |\n\t\t\t     FIFOLD_TYPE_ICV | FIFOLD_TYPE_LAST1);\n\n\tprint_hex_dump_debug(\"rfc4543 dec shdesc@\" __stringify(__LINE__)\": \",\n\t\t\t     DUMP_PREFIX_ADDRESS, 16, 4, desc, desc_bytes(desc),\n\t\t\t     1);\n}\nEXPORT_SYMBOL(cnstr_shdsc_rfc4543_decap);\n\n \nvoid cnstr_shdsc_chachapoly(u32 * const desc, struct alginfo *cdata,\n\t\t\t    struct alginfo *adata, unsigned int ivsize,\n\t\t\t    unsigned int icvsize, const bool encap,\n\t\t\t    const bool is_qi)\n{\n\tu32 *key_jump_cmd, *wait_cmd;\n\tu32 nfifo;\n\tconst bool is_ipsec = (ivsize != CHACHAPOLY_IV_SIZE);\n\n\t \n\tinit_sh_desc(desc, HDR_SHARE_SERIAL | HDR_SAVECTX);\n\n\t \n\tkey_jump_cmd = append_jump(desc, JUMP_JSL | JUMP_TEST_ALL |\n\t\t\t\t   JUMP_COND_SHRD);\n\n\tappend_key_as_imm(desc, cdata->key_virt, cdata->keylen, cdata->keylen,\n\t\t\t  CLASS_1 | KEY_DEST_CLASS_REG);\n\n\t \n\tif (is_ipsec)\n\t\tappend_load_as_imm(desc, cdata->key_virt + cdata->keylen, 4,\n\t\t\t\t   LDST_CLASS_1_CCB | LDST_SRCDST_BYTE_CONTEXT |\n\t\t\t\t   4 << LDST_OFFSET_SHIFT);\n\n\tset_jump_tgt_here(desc, key_jump_cmd);\n\n\t \n\tif (encap) {\n\t\tappend_operation(desc, adata->algtype | OP_ALG_AS_INITFINAL |\n\t\t\t\t OP_ALG_ENCRYPT);\n\t\tappend_operation(desc, cdata->algtype | OP_ALG_AS_INITFINAL |\n\t\t\t\t OP_ALG_ENCRYPT);\n\t} else {\n\t\tappend_operation(desc, adata->algtype | OP_ALG_AS_INITFINAL |\n\t\t\t\t OP_ALG_DECRYPT | OP_ALG_ICV_ON);\n\t\tappend_operation(desc, cdata->algtype | OP_ALG_AS_INITFINAL |\n\t\t\t\t OP_ALG_DECRYPT);\n\t}\n\n\tif (is_qi) {\n\t\tu32 *wait_load_cmd;\n\t\tu32 ctx1_iv_off = is_ipsec ? 8 : 4;\n\n\t\t \n\t\tappend_seq_load(desc, 4, LDST_CLASS_DECO |\n\t\t\t\tLDST_SRCDST_WORD_DECO_MATH3 |\n\t\t\t\t4 << LDST_OFFSET_SHIFT);\n\n\t\twait_load_cmd = append_jump(desc, JUMP_JSL | JUMP_TEST_ALL |\n\t\t\t\t\t    JUMP_COND_CALM | JUMP_COND_NCP |\n\t\t\t\t\t    JUMP_COND_NOP | JUMP_COND_NIP |\n\t\t\t\t\t    JUMP_COND_NIFP);\n\t\tset_jump_tgt_here(desc, wait_load_cmd);\n\n\t\tappend_seq_load(desc, ivsize, LDST_CLASS_1_CCB |\n\t\t\t\tLDST_SRCDST_BYTE_CONTEXT |\n\t\t\t\tctx1_iv_off << LDST_OFFSET_SHIFT);\n\t}\n\n\t \n\tnfifo = NFIFOENTRY_DEST_BOTH | NFIFOENTRY_FC1 | NFIFOENTRY_FC2 |\n\t\tNFIFOENTRY_DTYPE_POLY | NFIFOENTRY_BND;\n\tappend_load_imm_u32(desc, nfifo, LDST_CLASS_IND_CCB |\n\t\t\t    LDST_SRCDST_WORD_INFO_FIFO_SM | LDLEN_MATH3);\n\n\tappend_math_add(desc, VARSEQINLEN, ZERO, REG3, CAAM_CMD_SZ);\n\tappend_math_add(desc, VARSEQOUTLEN, ZERO, REG3, CAAM_CMD_SZ);\n\tappend_seq_fifo_load(desc, 0, FIFOLD_TYPE_NOINFOFIFO |\n\t\t\t     FIFOLD_CLASS_CLASS1 | LDST_VLF);\n\tappend_move_len(desc, MOVE_AUX_LS | MOVE_SRC_AUX_ABLK |\n\t\t\tMOVE_DEST_OUTFIFO | MOVELEN_MRSEL_MATH3);\n\tappend_seq_fifo_store(desc, 0, FIFOST_TYPE_MESSAGE_DATA | LDST_VLF);\n\n\t \n\tif (is_ipsec)\n\t\tappend_seq_fifo_store(desc, ivsize, FIFOST_TYPE_METADATA |\n\t\t\t\t      0x2 << 25);\n\n\twait_cmd = append_jump(desc, JUMP_JSL | JUMP_TYPE_LOCAL |\n\t\t\t       JUMP_COND_NOP | JUMP_TEST_ALL);\n\tset_jump_tgt_here(desc, wait_cmd);\n\n\tif (encap) {\n\t\t \n\t\tappend_math_add(desc, VARSEQINLEN, SEQINLEN, REG0, CAAM_CMD_SZ);\n\t\tappend_math_add(desc, VARSEQOUTLEN, SEQINLEN, REG0,\n\t\t\t\tCAAM_CMD_SZ);\n\t\taead_append_src_dst(desc, FIFOLD_TYPE_MSG1OUT2);\n\n\t\t \n\t\tappend_seq_store(desc, icvsize, LDST_CLASS_2_CCB |\n\t\t\t\t LDST_SRCDST_BYTE_CONTEXT);\n\t} else {\n\t\t \n\t\tappend_math_add(desc, VARSEQINLEN, SEQOUTLEN, REG0,\n\t\t\t\tCAAM_CMD_SZ);\n\t\tappend_math_add(desc, VARSEQOUTLEN, SEQOUTLEN, REG0,\n\t\t\t\tCAAM_CMD_SZ);\n\t\taead_append_src_dst(desc, FIFOLD_TYPE_MSG);\n\n\t\t \n\t\tappend_seq_fifo_load(desc, icvsize, FIFOLD_CLASS_CLASS2 |\n\t\t\t\t     FIFOLD_TYPE_LAST2 | FIFOLD_TYPE_ICV);\n\t}\n\n\tprint_hex_dump_debug(\"chachapoly shdesc@\" __stringify(__LINE__)\": \",\n\t\t\t     DUMP_PREFIX_ADDRESS, 16, 4, desc, desc_bytes(desc),\n\t\t\t     1);\n}\nEXPORT_SYMBOL(cnstr_shdsc_chachapoly);\n\n \nstatic inline void skcipher_append_src_dst(u32 *desc)\n{\n\tappend_math_add(desc, VARSEQOUTLEN, SEQINLEN, REG0, CAAM_CMD_SZ);\n\tappend_math_add(desc, VARSEQINLEN, SEQINLEN, REG0, CAAM_CMD_SZ);\n\tappend_seq_fifo_load(desc, 0, FIFOLD_CLASS_CLASS1 |\n\t\t\t     KEY_VLF | FIFOLD_TYPE_MSG | FIFOLD_TYPE_LAST1);\n\tappend_seq_fifo_store(desc, 0, FIFOST_TYPE_MESSAGE_DATA | KEY_VLF);\n}\n\n \nvoid cnstr_shdsc_skcipher_encap(u32 * const desc, struct alginfo *cdata,\n\t\t\t\tunsigned int ivsize, const bool is_rfc3686,\n\t\t\t\tconst u32 ctx1_iv_off)\n{\n\tu32 *key_jump_cmd;\n\tu32 options = cdata->algtype | OP_ALG_AS_INIT | OP_ALG_ENCRYPT;\n\tbool is_chacha20 = ((cdata->algtype & OP_ALG_ALGSEL_MASK) ==\n\t\t\t    OP_ALG_ALGSEL_CHACHA20);\n\n\tinit_sh_desc(desc, HDR_SHARE_SERIAL | HDR_SAVECTX);\n\t \n\tkey_jump_cmd = append_jump(desc, JUMP_JSL | JUMP_TEST_ALL |\n\t\t\t\t   JUMP_COND_SHRD);\n\n\t \n\tappend_key_as_imm(desc, cdata->key_virt, cdata->keylen,\n\t\t\t  cdata->keylen, CLASS_1 | KEY_DEST_CLASS_REG);\n\n\t \n\tif (is_rfc3686) {\n\t\tconst u8 *nonce = cdata->key_virt + cdata->keylen;\n\n\t\tappend_load_as_imm(desc, nonce, CTR_RFC3686_NONCE_SIZE,\n\t\t\t\t   LDST_CLASS_IND_CCB |\n\t\t\t\t   LDST_SRCDST_BYTE_OUTFIFO | LDST_IMM);\n\t\tappend_move(desc, MOVE_WAITCOMP | MOVE_SRC_OUTFIFO |\n\t\t\t    MOVE_DEST_CLASS1CTX | (16 << MOVE_OFFSET_SHIFT) |\n\t\t\t    (CTR_RFC3686_NONCE_SIZE << MOVE_LEN_SHIFT));\n\t}\n\n\tset_jump_tgt_here(desc, key_jump_cmd);\n\n\t \n\tif (ivsize)\n\t\tappend_seq_load(desc, ivsize, LDST_SRCDST_BYTE_CONTEXT |\n\t\t\t\tLDST_CLASS_1_CCB | (ctx1_iv_off <<\n\t\t\t\tLDST_OFFSET_SHIFT));\n\n\t \n\tif (is_rfc3686)\n\t\tappend_load_imm_be32(desc, 1, LDST_IMM | LDST_CLASS_1_CCB |\n\t\t\t\t     LDST_SRCDST_BYTE_CONTEXT |\n\t\t\t\t     ((ctx1_iv_off + CTR_RFC3686_IV_SIZE) <<\n\t\t\t\t      LDST_OFFSET_SHIFT));\n\n\t \n\tif (is_chacha20)\n\t\toptions |= OP_ALG_AS_FINALIZE;\n\tappend_operation(desc, options);\n\n\t \n\tskcipher_append_src_dst(desc);\n\n\t \n\tif (!is_chacha20 && ivsize)\n\t\tappend_seq_store(desc, ivsize, LDST_SRCDST_BYTE_CONTEXT |\n\t\t\t\t LDST_CLASS_1_CCB | (ctx1_iv_off <<\n\t\t\t\t LDST_OFFSET_SHIFT));\n\n\tprint_hex_dump_debug(\"skcipher enc shdesc@\" __stringify(__LINE__)\": \",\n\t\t\t     DUMP_PREFIX_ADDRESS, 16, 4, desc, desc_bytes(desc),\n\t\t\t     1);\n}\nEXPORT_SYMBOL(cnstr_shdsc_skcipher_encap);\n\n \nvoid cnstr_shdsc_skcipher_decap(u32 * const desc, struct alginfo *cdata,\n\t\t\t\tunsigned int ivsize, const bool is_rfc3686,\n\t\t\t\tconst u32 ctx1_iv_off)\n{\n\tu32 *key_jump_cmd;\n\tbool is_chacha20 = ((cdata->algtype & OP_ALG_ALGSEL_MASK) ==\n\t\t\t    OP_ALG_ALGSEL_CHACHA20);\n\n\tinit_sh_desc(desc, HDR_SHARE_SERIAL | HDR_SAVECTX);\n\t \n\tkey_jump_cmd = append_jump(desc, JUMP_JSL | JUMP_TEST_ALL |\n\t\t\t\t   JUMP_COND_SHRD);\n\n\t \n\tappend_key_as_imm(desc, cdata->key_virt, cdata->keylen,\n\t\t\t  cdata->keylen, CLASS_1 | KEY_DEST_CLASS_REG);\n\n\t \n\tif (is_rfc3686) {\n\t\tconst u8 *nonce = cdata->key_virt + cdata->keylen;\n\n\t\tappend_load_as_imm(desc, nonce, CTR_RFC3686_NONCE_SIZE,\n\t\t\t\t   LDST_CLASS_IND_CCB |\n\t\t\t\t   LDST_SRCDST_BYTE_OUTFIFO | LDST_IMM);\n\t\tappend_move(desc, MOVE_WAITCOMP | MOVE_SRC_OUTFIFO |\n\t\t\t    MOVE_DEST_CLASS1CTX | (16 << MOVE_OFFSET_SHIFT) |\n\t\t\t    (CTR_RFC3686_NONCE_SIZE << MOVE_LEN_SHIFT));\n\t}\n\n\tset_jump_tgt_here(desc, key_jump_cmd);\n\n\t \n\tif (ivsize)\n\t\tappend_seq_load(desc, ivsize, LDST_SRCDST_BYTE_CONTEXT |\n\t\t\t\tLDST_CLASS_1_CCB | (ctx1_iv_off <<\n\t\t\t\tLDST_OFFSET_SHIFT));\n\n\t \n\tif (is_rfc3686)\n\t\tappend_load_imm_be32(desc, 1, LDST_IMM | LDST_CLASS_1_CCB |\n\t\t\t\t     LDST_SRCDST_BYTE_CONTEXT |\n\t\t\t\t     ((ctx1_iv_off + CTR_RFC3686_IV_SIZE) <<\n\t\t\t\t      LDST_OFFSET_SHIFT));\n\n\t \n\tif (ctx1_iv_off)\n\t\tappend_operation(desc, cdata->algtype | OP_ALG_AS_INIT |\n\t\t\t\t OP_ALG_DECRYPT);\n\telse\n\t\tappend_dec_op1(desc, cdata->algtype);\n\n\t \n\tskcipher_append_src_dst(desc);\n\n\t \n\tif (!is_chacha20 && ivsize)\n\t\tappend_seq_store(desc, ivsize, LDST_SRCDST_BYTE_CONTEXT |\n\t\t\t\t LDST_CLASS_1_CCB | (ctx1_iv_off <<\n\t\t\t\t LDST_OFFSET_SHIFT));\n\n\tprint_hex_dump_debug(\"skcipher dec shdesc@\" __stringify(__LINE__)\": \",\n\t\t\t     DUMP_PREFIX_ADDRESS, 16, 4, desc, desc_bytes(desc),\n\t\t\t     1);\n}\nEXPORT_SYMBOL(cnstr_shdsc_skcipher_decap);\n\n \nvoid cnstr_shdsc_xts_skcipher_encap(u32 * const desc, struct alginfo *cdata)\n{\n\t \n\t__be64 sector_size = cpu_to_be64(BIT(15));\n\tu32 *key_jump_cmd;\n\n\tinit_sh_desc(desc, HDR_SHARE_SERIAL | HDR_SAVECTX);\n\t \n\tkey_jump_cmd = append_jump(desc, JUMP_JSL | JUMP_TEST_ALL |\n\t\t\t\t   JUMP_COND_SHRD);\n\n\t \n\tappend_key_as_imm(desc, cdata->key_virt, cdata->keylen,\n\t\t\t  cdata->keylen, CLASS_1 | KEY_DEST_CLASS_REG);\n\n\t \n\tappend_load_as_imm(desc, (void *)&sector_size, 8, LDST_CLASS_1_CCB |\n\t\t\t   LDST_SRCDST_BYTE_CONTEXT |\n\t\t\t   (0x28 << LDST_OFFSET_SHIFT));\n\n\tset_jump_tgt_here(desc, key_jump_cmd);\n\n\t \n\tappend_seq_load(desc, 8, LDST_SRCDST_BYTE_CONTEXT | LDST_CLASS_1_CCB |\n\t\t\t(0x20 << LDST_OFFSET_SHIFT));\n\tappend_seq_load(desc, 8, LDST_SRCDST_BYTE_CONTEXT | LDST_CLASS_1_CCB |\n\t\t\t(0x30 << LDST_OFFSET_SHIFT));\n\n\t \n\tappend_operation(desc, cdata->algtype | OP_ALG_AS_INITFINAL |\n\t\t\t OP_ALG_ENCRYPT);\n\n\t \n\tskcipher_append_src_dst(desc);\n\n\t \n\tappend_seq_store(desc, 8, LDST_SRCDST_BYTE_CONTEXT | LDST_CLASS_1_CCB |\n\t\t\t (0x20 << LDST_OFFSET_SHIFT));\n\tappend_seq_store(desc, 8, LDST_SRCDST_BYTE_CONTEXT | LDST_CLASS_1_CCB |\n\t\t\t (0x30 << LDST_OFFSET_SHIFT));\n\n\tprint_hex_dump_debug(\"xts skcipher enc shdesc@\" __stringify(__LINE__)\n\t\t\t     \": \", DUMP_PREFIX_ADDRESS, 16, 4,\n\t\t\t     desc, desc_bytes(desc), 1);\n}\nEXPORT_SYMBOL(cnstr_shdsc_xts_skcipher_encap);\n\n \nvoid cnstr_shdsc_xts_skcipher_decap(u32 * const desc, struct alginfo *cdata)\n{\n\t \n\t__be64 sector_size = cpu_to_be64(BIT(15));\n\tu32 *key_jump_cmd;\n\n\tinit_sh_desc(desc, HDR_SHARE_SERIAL | HDR_SAVECTX);\n\t \n\tkey_jump_cmd = append_jump(desc, JUMP_JSL | JUMP_TEST_ALL |\n\t\t\t\t   JUMP_COND_SHRD);\n\n\t \n\tappend_key_as_imm(desc, cdata->key_virt, cdata->keylen,\n\t\t\t  cdata->keylen, CLASS_1 | KEY_DEST_CLASS_REG);\n\n\t \n\tappend_load_as_imm(desc, (void *)&sector_size, 8, LDST_CLASS_1_CCB |\n\t\t\t   LDST_SRCDST_BYTE_CONTEXT |\n\t\t\t   (0x28 << LDST_OFFSET_SHIFT));\n\n\tset_jump_tgt_here(desc, key_jump_cmd);\n\n\t \n\tappend_seq_load(desc, 8, LDST_SRCDST_BYTE_CONTEXT | LDST_CLASS_1_CCB |\n\t\t\t(0x20 << LDST_OFFSET_SHIFT));\n\tappend_seq_load(desc, 8, LDST_SRCDST_BYTE_CONTEXT | LDST_CLASS_1_CCB |\n\t\t\t(0x30 << LDST_OFFSET_SHIFT));\n\t \n\tappend_dec_op1(desc, cdata->algtype);\n\n\t \n\tskcipher_append_src_dst(desc);\n\n\t \n\tappend_seq_store(desc, 8, LDST_SRCDST_BYTE_CONTEXT | LDST_CLASS_1_CCB |\n\t\t\t (0x20 << LDST_OFFSET_SHIFT));\n\tappend_seq_store(desc, 8, LDST_SRCDST_BYTE_CONTEXT | LDST_CLASS_1_CCB |\n\t\t\t (0x30 << LDST_OFFSET_SHIFT));\n\n\tprint_hex_dump_debug(\"xts skcipher dec shdesc@\" __stringify(__LINE__)\n\t\t\t     \": \", DUMP_PREFIX_ADDRESS, 16, 4, desc,\n\t\t\t     desc_bytes(desc), 1);\n}\nEXPORT_SYMBOL(cnstr_shdsc_xts_skcipher_decap);\n\nMODULE_LICENSE(\"GPL\");\nMODULE_DESCRIPTION(\"FSL CAAM descriptor support\");\nMODULE_AUTHOR(\"Freescale Semiconductor - NMG/STC\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}