{
  "module_name": "pdb.h",
  "hash_id": "1bf23ba0b1bc496851ed13b8e4435d1aa70990ba07208835d27fbbb59b52ce1b",
  "original_prompt": "Ingested from linux-6.6.14/drivers/crypto/caam/pdb.h",
  "human_readable_source": " \n \n\n#ifndef CAAM_PDB_H\n#define CAAM_PDB_H\n#include \"compat.h\"\n\n \n#define PDBHMO_ESP_DECAP_SHIFT\t28\n#define PDBHMO_ESP_ENCAP_SHIFT\t28\n \n#define PDBHMO_ESP_DECAP_DEC_TTL\t(0x02 << PDBHMO_ESP_DECAP_SHIFT)\n#define PDBHMO_ESP_ENCAP_DEC_TTL\t(0x02 << PDBHMO_ESP_ENCAP_SHIFT)\n \n#define PDBHMO_ESP_DIFFSERV\t\t(0x01 << PDBHMO_ESP_DECAP_SHIFT)\n \n#define PDBHMO_ESP_DFBIT\t\t(0x04 << PDBHMO_ESP_ENCAP_SHIFT)\n\n#define PDBNH_ESP_ENCAP_SHIFT\t\t16\n#define PDBNH_ESP_ENCAP_MASK\t\t(0xff << PDBNH_ESP_ENCAP_SHIFT)\n\n#define PDBHDRLEN_ESP_DECAP_SHIFT\t16\n#define PDBHDRLEN_MASK\t\t\t(0x0fff << PDBHDRLEN_ESP_DECAP_SHIFT)\n\n#define PDB_NH_OFFSET_SHIFT\t\t8\n#define PDB_NH_OFFSET_MASK\t\t(0xff << PDB_NH_OFFSET_SHIFT)\n\n \n#define PDBOPTS_ESP_ARSNONE\t0x00  \n#define PDBOPTS_ESP_ARS32\t0x40  \n#define PDBOPTS_ESP_ARS128\t0x80  \n#define PDBOPTS_ESP_ARS64\t0xc0  \n#define PDBOPTS_ESP_ARS_MASK\t0xc0  \n#define PDBOPTS_ESP_IVSRC\t0x20  \n#define PDBOPTS_ESP_ESN\t\t0x10  \n#define PDBOPTS_ESP_OUTFMT\t0x08  \n#define PDBOPTS_ESP_IPHDRSRC\t0x08  \n#define PDBOPTS_ESP_INCIPHDR\t0x04  \n#define PDBOPTS_ESP_IPVSN\t0x02  \n#define PDBOPTS_ESP_AOFL\t0x04  \n#define PDBOPTS_ESP_TUNNEL\t0x01  \n#define PDBOPTS_ESP_IPV6\t0x02  \n#define PDBOPTS_ESP_DIFFSERV\t0x40  \n#define PDBOPTS_ESP_UPDATE_CSUM 0x80  \n#define PDBOPTS_ESP_VERIFY_CSUM 0x20  \n\n \n\n \nstruct ipsec_encap_cbc {\n\tu8 iv[16];\n};\n\n \nstruct ipsec_encap_ctr {\n\tu8 ctr_nonce[4];\n\tu32 ctr_initial;\n\tu64 iv;\n};\n\n \nstruct ipsec_encap_ccm {\n\tu8 salt[4];\n\tu32 ccm_opt;\n\tu64 iv;\n};\n\n \nstruct ipsec_encap_gcm {\n\tu8 salt[4];\n\tu32 rsvd1;\n\tu64 iv;\n};\n\n \nstruct ipsec_encap_pdb {\n\tu32 options;\n\tu32 seq_num_ext_hi;\n\tu32 seq_num;\n\tunion {\n\t\tstruct ipsec_encap_cbc cbc;\n\t\tstruct ipsec_encap_ctr ctr;\n\t\tstruct ipsec_encap_ccm ccm;\n\t\tstruct ipsec_encap_gcm gcm;\n\t};\n\tu32 spi;\n\tu32 ip_hdr_len;\n\tu32 ip_hdr[];\n};\n\n \nstruct ipsec_decap_cbc {\n\tu32 rsvd[2];\n};\n\n \nstruct ipsec_decap_ctr {\n\tu8 ctr_nonce[4];\n\tu32 ctr_initial;\n};\n\n \nstruct ipsec_decap_ccm {\n\tu8 salt[4];\n\tu32 ccm_opt;\n};\n\n \nstruct ipsec_decap_gcm {\n\tu8 salt[4];\n\tu32 resvd;\n};\n\n \nstruct ipsec_decap_pdb {\n\tu32 options;\n\tunion {\n\t\tstruct ipsec_decap_cbc cbc;\n\t\tstruct ipsec_decap_ctr ctr;\n\t\tstruct ipsec_decap_ccm ccm;\n\t\tstruct ipsec_decap_gcm gcm;\n\t};\n\tu32 seq_num_ext_hi;\n\tu32 seq_num;\n\t__be32 anti_replay[4];\n};\n\n \nstruct ipsec_deco_dpovrd {\n#define IPSEC_ENCAP_DECO_DPOVRD_USE 0x80\n\tu8 ovrd_ecn;\n\tu8 ip_hdr_len;\n\tu8 nh_offset;\n\tu8 next_header;  \n};\n\n \n#define WIFI_PDBOPTS_FCS\t0x01\n#define WIFI_PDBOPTS_AR\t\t0x40\n\nstruct wifi_encap_pdb {\n\tu16 mac_hdr_len;\n\tu8 rsvd;\n\tu8 options;\n\tu8 iv_flags;\n\tu8 pri;\n\tu16 pn1;\n\tu32 pn2;\n\tu16 frm_ctrl_mask;\n\tu16 seq_ctrl_mask;\n\tu8 rsvd1[2];\n\tu8 cnst;\n\tu8 key_id;\n\tu8 ctr_flags;\n\tu8 rsvd2;\n\tu16 ctr_init;\n};\n\nstruct wifi_decap_pdb {\n\tu16 mac_hdr_len;\n\tu8 rsvd;\n\tu8 options;\n\tu8 iv_flags;\n\tu8 pri;\n\tu16 pn1;\n\tu32 pn2;\n\tu16 frm_ctrl_mask;\n\tu16 seq_ctrl_mask;\n\tu8 rsvd1[4];\n\tu8 ctr_flags;\n\tu8 rsvd2;\n\tu16 ctr_init;\n};\n\n \n#define WIMAX_PDBOPTS_FCS\t0x01\n#define WIMAX_PDBOPTS_AR\t0x40  \n\nstruct wimax_encap_pdb {\n\tu8 rsvd[3];\n\tu8 options;\n\tu32 nonce;\n\tu8 b0_flags;\n\tu8 ctr_flags;\n\tu16 ctr_init;\n\t \n\tu32 pn;\n\t \n};\n\nstruct wimax_decap_pdb {\n\tu8 rsvd[3];\n\tu8 options;\n\tu32 nonce;\n\tu8 iv_flags;\n\tu8 ctr_flags;\n\tu16 ctr_init;\n\t \n\tu32 pn;\n\tu8 rsvd1[2];\n\tu16 antireplay_len;\n\tu64 antireplay_scorecard;\n\t \n};\n\n \n#define MACSEC_PDBOPTS_FCS\t0x01\n#define MACSEC_PDBOPTS_AR\t0x40  \n\nstruct macsec_encap_pdb {\n\tu16 aad_len;\n\tu8 rsvd;\n\tu8 options;\n\tu64 sci;\n\tu16 ethertype;\n\tu8 tci_an;\n\tu8 rsvd1;\n\t \n\tu32 pn;\n\t \n};\n\nstruct macsec_decap_pdb {\n\tu16 aad_len;\n\tu8 rsvd;\n\tu8 options;\n\tu64 sci;\n\tu8 rsvd1[3];\n\t \n\tu8 antireplay_len;\n\tu32 pn;\n\tu64 antireplay_scorecard;\n\t \n};\n\n \n\n#define TLS_PDBOPTS_ARS32\t0x40\n#define TLS_PDBOPTS_ARS64\t0xc0\n#define TLS_PDBOPTS_OUTFMT\t0x08\n#define TLS_PDBOPTS_IV_WRTBK\t0x02  \n#define TLS_PDBOPTS_EXP_RND_IV\t0x01  \n\nstruct tls_block_encap_pdb {\n\tu8 type;\n\tu8 version[2];\n\tu8 options;\n\tu64 seq_num;\n\tu32 iv[4];\n};\n\nstruct tls_stream_encap_pdb {\n\tu8 type;\n\tu8 version[2];\n\tu8 options;\n\tu64 seq_num;\n\tu8 i;\n\tu8 j;\n\tu8 rsvd1[2];\n};\n\nstruct dtls_block_encap_pdb {\n\tu8 type;\n\tu8 version[2];\n\tu8 options;\n\tu16 epoch;\n\tu16 seq_num[3];\n\tu32 iv[4];\n};\n\nstruct tls_block_decap_pdb {\n\tu8 rsvd[3];\n\tu8 options;\n\tu64 seq_num;\n\tu32 iv[4];\n};\n\nstruct tls_stream_decap_pdb {\n\tu8 rsvd[3];\n\tu8 options;\n\tu64 seq_num;\n\tu8 i;\n\tu8 j;\n\tu8 rsvd1[2];\n};\n\nstruct dtls_block_decap_pdb {\n\tu8 rsvd[3];\n\tu8 options;\n\tu16 epoch;\n\tu16 seq_num[3];\n\tu32 iv[4];\n\tu64 antireplay_scorecard;\n};\n\n \n#define SRTP_PDBOPTS_MKI\t0x08\n#define SRTP_PDBOPTS_AR\t\t0x40\n\nstruct srtp_encap_pdb {\n\tu8 x_len;\n\tu8 mki_len;\n\tu8 n_tag;\n\tu8 options;\n\tu32 cnst0;\n\tu8 rsvd[2];\n\tu16 cnst1;\n\tu16 salt[7];\n\tu16 cnst2;\n\tu32 rsvd1;\n\tu32 roc;\n\tu32 opt_mki;\n};\n\nstruct srtp_decap_pdb {\n\tu8 x_len;\n\tu8 mki_len;\n\tu8 n_tag;\n\tu8 options;\n\tu32 cnst0;\n\tu8 rsvd[2];\n\tu16 cnst1;\n\tu16 salt[7];\n\tu16 cnst2;\n\tu16 rsvd1;\n\tu16 seq_num;\n\tu32 roc;\n\tu64 antireplay_scorecard;\n};\n\n \n#define DSA_PDB_SGF_SHIFT\t24\n#define DSA_PDB_SGF_MASK\t(0xff << DSA_PDB_SGF_SHIFT)\n#define DSA_PDB_SGF_Q\t\t(0x80 << DSA_PDB_SGF_SHIFT)\n#define DSA_PDB_SGF_R\t\t(0x40 << DSA_PDB_SGF_SHIFT)\n#define DSA_PDB_SGF_G\t\t(0x20 << DSA_PDB_SGF_SHIFT)\n#define DSA_PDB_SGF_W\t\t(0x10 << DSA_PDB_SGF_SHIFT)\n#define DSA_PDB_SGF_S\t\t(0x10 << DSA_PDB_SGF_SHIFT)\n#define DSA_PDB_SGF_F\t\t(0x08 << DSA_PDB_SGF_SHIFT)\n#define DSA_PDB_SGF_C\t\t(0x04 << DSA_PDB_SGF_SHIFT)\n#define DSA_PDB_SGF_D\t\t(0x02 << DSA_PDB_SGF_SHIFT)\n#define DSA_PDB_SGF_AB_SIGN\t(0x02 << DSA_PDB_SGF_SHIFT)\n#define DSA_PDB_SGF_AB_VERIFY\t(0x01 << DSA_PDB_SGF_SHIFT)\n\n#define DSA_PDB_L_SHIFT\t\t7\n#define DSA_PDB_L_MASK\t\t(0x3ff << DSA_PDB_L_SHIFT)\n\n#define DSA_PDB_N_MASK\t\t0x7f\n\nstruct dsa_sign_pdb {\n\tu32 sgf_ln;  \n\tu8 *q;\n\tu8 *r;\n\tu8 *g;\t \n\tu8 *s;\n\tu8 *f;\n\tu8 *c;\n\tu8 *d;\n\tu8 *ab;  \n\tu8 *u;\n};\n\nstruct dsa_verify_pdb {\n\tu32 sgf_ln;\n\tu8 *q;\n\tu8 *r;\n\tu8 *g;\t \n\tu8 *w;  \n\tu8 *f;\n\tu8 *c;\n\tu8 *d;\n\tu8 *tmp;  \n\tu8 *ab;  \n};\n\n \n#define RSA_PDB_SGF_SHIFT       28\n#define RSA_PDB_E_SHIFT         12\n#define RSA_PDB_E_MASK          (0xFFF << RSA_PDB_E_SHIFT)\n#define RSA_PDB_D_SHIFT         12\n#define RSA_PDB_D_MASK          (0xFFF << RSA_PDB_D_SHIFT)\n#define RSA_PDB_Q_SHIFT         12\n#define RSA_PDB_Q_MASK          (0xFFF << RSA_PDB_Q_SHIFT)\n\n#define RSA_PDB_SGF_F           (0x8 << RSA_PDB_SGF_SHIFT)\n#define RSA_PDB_SGF_G           (0x4 << RSA_PDB_SGF_SHIFT)\n#define RSA_PRIV_PDB_SGF_F      (0x4 << RSA_PDB_SGF_SHIFT)\n#define RSA_PRIV_PDB_SGF_G      (0x8 << RSA_PDB_SGF_SHIFT)\n\n#define RSA_PRIV_KEY_FRM_1      0\n#define RSA_PRIV_KEY_FRM_2      1\n#define RSA_PRIV_KEY_FRM_3      2\n\n \nstruct rsa_pub_pdb {\n\tu32\t\tsgf;\n\tdma_addr_t\tf_dma;\n\tdma_addr_t\tg_dma;\n\tdma_addr_t\tn_dma;\n\tdma_addr_t\te_dma;\n\tu32\t\tf_len;\n};\n\n#define SIZEOF_RSA_PUB_PDB\t(2 * sizeof(u32) + 4 * caam_ptr_sz)\n\n \nstruct rsa_priv_f1_pdb {\n\tu32\t\tsgf;\n\tdma_addr_t\tg_dma;\n\tdma_addr_t\tf_dma;\n\tdma_addr_t\tn_dma;\n\tdma_addr_t\td_dma;\n};\n\n#define SIZEOF_RSA_PRIV_F1_PDB\t(sizeof(u32) + 4 * caam_ptr_sz)\n\n \nstruct rsa_priv_f2_pdb {\n\tu32\t\tsgf;\n\tdma_addr_t\tg_dma;\n\tdma_addr_t\tf_dma;\n\tdma_addr_t\td_dma;\n\tdma_addr_t\tp_dma;\n\tdma_addr_t\tq_dma;\n\tdma_addr_t\ttmp1_dma;\n\tdma_addr_t\ttmp2_dma;\n\tu32\t\tp_q_len;\n};\n\n#define SIZEOF_RSA_PRIV_F2_PDB\t(2 * sizeof(u32) + 7 * caam_ptr_sz)\n\n \nstruct rsa_priv_f3_pdb {\n\tu32\t\tsgf;\n\tdma_addr_t\tg_dma;\n\tdma_addr_t\tf_dma;\n\tdma_addr_t\tc_dma;\n\tdma_addr_t\tp_dma;\n\tdma_addr_t\tq_dma;\n\tdma_addr_t\tdp_dma;\n\tdma_addr_t\tdq_dma;\n\tdma_addr_t\ttmp1_dma;\n\tdma_addr_t\ttmp2_dma;\n\tu32\t\tp_q_len;\n};\n\n#define SIZEOF_RSA_PRIV_F3_PDB\t(2 * sizeof(u32) + 9 * caam_ptr_sz)\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}