{
  "module_name": "debugfs.c",
  "hash_id": "f2ee9c7b7662ade2e8febb6eb65b80778bd526f1c3c590b0310c881344e294e6",
  "original_prompt": "Ingested from linux-6.6.14/drivers/crypto/caam/debugfs.c",
  "human_readable_source": "\n \n\n#include <linux/debugfs.h>\n#include \"compat.h\"\n#include \"debugfs.h\"\n#include \"regs.h\"\n#include \"intern.h\"\n\nstatic int caam_debugfs_u64_get(void *data, u64 *val)\n{\n\t*val = caam64_to_cpu(*(u64 *)data);\n\treturn 0;\n}\n\nstatic int caam_debugfs_u32_get(void *data, u64 *val)\n{\n\t*val = caam32_to_cpu(*(u32 *)data);\n\treturn 0;\n}\n\nDEFINE_DEBUGFS_ATTRIBUTE(caam_fops_u32_ro, caam_debugfs_u32_get, NULL, \"%llu\\n\");\nDEFINE_DEBUGFS_ATTRIBUTE(caam_fops_u64_ro, caam_debugfs_u64_get, NULL, \"%llu\\n\");\n\n#ifdef CONFIG_CAAM_QI\n \nstatic u64 times_congested;\n\nvoid caam_debugfs_qi_congested(void)\n{\n\ttimes_congested++;\n}\n\nvoid caam_debugfs_qi_init(struct caam_drv_private *ctrlpriv)\n{\n\tdebugfs_create_file(\"qi_congested\", 0444, ctrlpriv->ctl,\n\t\t\t    &times_congested, &caam_fops_u64_ro);\n}\n#endif\n\nvoid caam_debugfs_init(struct caam_drv_private *ctrlpriv,\n\t\t       struct caam_perfmon __force *perfmon,\n\t\t       struct dentry *root)\n{\n\t \n\n\tctrlpriv->ctl = debugfs_create_dir(\"ctl\", root);\n\n\tdebugfs_create_file(\"rq_dequeued\", 0444, ctrlpriv->ctl,\n\t\t\t    &perfmon->req_dequeued, &caam_fops_u64_ro);\n\tdebugfs_create_file(\"ob_rq_encrypted\", 0444, ctrlpriv->ctl,\n\t\t\t    &perfmon->ob_enc_req, &caam_fops_u64_ro);\n\tdebugfs_create_file(\"ib_rq_decrypted\", 0444, ctrlpriv->ctl,\n\t\t\t    &perfmon->ib_dec_req, &caam_fops_u64_ro);\n\tdebugfs_create_file(\"ob_bytes_encrypted\", 0444, ctrlpriv->ctl,\n\t\t\t    &perfmon->ob_enc_bytes, &caam_fops_u64_ro);\n\tdebugfs_create_file(\"ob_bytes_protected\", 0444, ctrlpriv->ctl,\n\t\t\t    &perfmon->ob_prot_bytes, &caam_fops_u64_ro);\n\tdebugfs_create_file(\"ib_bytes_decrypted\", 0444, ctrlpriv->ctl,\n\t\t\t    &perfmon->ib_dec_bytes, &caam_fops_u64_ro);\n\tdebugfs_create_file(\"ib_bytes_validated\", 0444, ctrlpriv->ctl,\n\t\t\t    &perfmon->ib_valid_bytes, &caam_fops_u64_ro);\n\n\t \n\tdebugfs_create_file(\"fault_addr\", 0444, ctrlpriv->ctl,\n\t\t\t    &perfmon->faultaddr, &caam_fops_u32_ro);\n\tdebugfs_create_file(\"fault_detail\", 0444, ctrlpriv->ctl,\n\t\t\t    &perfmon->faultdetail, &caam_fops_u32_ro);\n\tdebugfs_create_file(\"fault_status\", 0444, ctrlpriv->ctl,\n\t\t\t    &perfmon->status, &caam_fops_u32_ro);\n\n\tif (ctrlpriv->optee_en)\n\t\treturn;\n\n\t \n\tctrlpriv->ctl_kek_wrap.data = (__force void *)&ctrlpriv->ctrl->kek[0];\n\tctrlpriv->ctl_kek_wrap.size = KEK_KEY_SIZE * sizeof(u32);\n\tdebugfs_create_blob(\"kek\", 0444, ctrlpriv->ctl,\n\t\t\t    &ctrlpriv->ctl_kek_wrap);\n\n\tctrlpriv->ctl_tkek_wrap.data = (__force void *)&ctrlpriv->ctrl->tkek[0];\n\tctrlpriv->ctl_tkek_wrap.size = KEK_KEY_SIZE * sizeof(u32);\n\tdebugfs_create_blob(\"tkek\", 0444, ctrlpriv->ctl,\n\t\t\t    &ctrlpriv->ctl_tkek_wrap);\n\n\tctrlpriv->ctl_tdsk_wrap.data = (__force void *)&ctrlpriv->ctrl->tdsk[0];\n\tctrlpriv->ctl_tdsk_wrap.size = KEK_KEY_SIZE * sizeof(u32);\n\tdebugfs_create_blob(\"tdsk\", 0444, ctrlpriv->ctl,\n\t\t\t    &ctrlpriv->ctl_tdsk_wrap);\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}