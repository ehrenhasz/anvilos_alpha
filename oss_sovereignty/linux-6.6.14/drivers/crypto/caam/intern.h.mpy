{
  "module_name": "intern.h",
  "hash_id": "929472b17fde54580e71ba37b5aea23fc80c18c33e637c4b4fe6423222c7d80a",
  "original_prompt": "Ingested from linux-6.6.14/drivers/crypto/caam/intern.h",
  "human_readable_source": " \n \n\n#ifndef INTERN_H\n#define INTERN_H\n\n#include \"ctrl.h\"\n#include <crypto/engine.h>\n\n \n#define JOBR_DEPTH (1 << CONFIG_CRYPTO_DEV_FSL_CAAM_RINGSIZE)\n\n \n#define THRESHOLD 15\n#define CRYPTO_ENGINE_MAX_QLEN (JOBR_DEPTH - THRESHOLD)\n\n \n#ifdef CONFIG_CRYPTO_DEV_FSL_CAAM_INTC\n#define JOBR_INTC JRCFG_ICEN\n#define JOBR_INTC_TIME_THLD CONFIG_CRYPTO_DEV_FSL_CAAM_INTC_TIME_THLD\n#define JOBR_INTC_COUNT_THLD CONFIG_CRYPTO_DEV_FSL_CAAM_INTC_COUNT_THLD\n#else\n#define JOBR_INTC 0\n#define JOBR_INTC_TIME_THLD 0\n#define JOBR_INTC_COUNT_THLD 0\n#endif\n\n \nstruct caam_jrentry_info {\n\tvoid (*callbk)(struct device *dev, u32 *desc, u32 status, void *arg);\n\tvoid *cbkarg;\t \n\tu32 *desc_addr_virt;\t \n\tdma_addr_t desc_addr_dma;\t \n\tu32 desc_size;\t \n};\n\nstruct caam_jr_state {\n\tdma_addr_t inpbusaddr;\n\tdma_addr_t outbusaddr;\n};\n\nstruct caam_jr_dequeue_params {\n\tstruct device *dev;\n\tint enable_itr;\n};\n\n \nstruct caam_drv_private_jr {\n\tstruct list_head\tlist_node;\t \n\tstruct device\t\t*dev;\n\tint ridx;\n\tstruct caam_job_ring __iomem *rregs;\t \n\tstruct tasklet_struct irqtask;\n\tstruct caam_jr_dequeue_params tasklet_params;\n\tint irq;\t\t\t \n\tbool hwrng;\n\n\t \n\tatomic_t tfm_count ____cacheline_aligned;\n\n\t \n\tstruct caam_jrentry_info *entinfo;\t \n\tspinlock_t inplock ____cacheline_aligned;  \n\tu32 inpring_avail;\t \n\tint head;\t\t\t \n\tvoid *inpring;\t\t\t \n\tint out_ring_read_index;\t \n\tint tail;\t\t\t \n\tvoid *outring;\t\t\t \n\tstruct crypto_engine *engine;\n\n\tstruct caam_jr_state state;\t \n};\n\nstruct caam_ctl_state {\n\tstruct masterid deco_mid[16];\n\tstruct masterid jr_mid[4];\n\tu32 mcr;\n\tu32 scfgr;\n};\n\n \nstruct caam_drv_private {\n\t \n\tstruct caam_ctrl __iomem *ctrl;  \n\tstruct caam_deco __iomem *deco;  \n\tstruct caam_assurance __iomem *assure;\n\tstruct caam_queue_if __iomem *qi;  \n\tstruct caam_job_ring __iomem *jr[4];\t \n\n\tstruct iommu_domain *domain;\n\n\t \n\tu8 total_jobrs;\t\t \n\tu8 qi_present;\t\t \n\tu8 blob_present;\t \n\tu8 mc_en;\t\t \n\tu8 optee_en;\t\t \n\tbool pr_support;         \n\tint secvio_irq;\t\t \n\tint virt_en;\t\t \n\tint era;\t\t \n\n#define\tRNG4_MAX_HANDLES 2\n\t \n\tu32 rng4_sh_init;\t \n\n\tstruct clk_bulk_data *clks;\n\tint num_clks;\n\t \n#ifdef CONFIG_DEBUG_FS\n\tstruct dentry *ctl;  \n\tstruct debugfs_blob_wrapper ctl_kek_wrap, ctl_tkek_wrap, ctl_tdsk_wrap;\n#endif\n\n\tint caam_off_during_pm;\t\t \n\tstruct caam_ctl_state state;\t \n};\n\n#ifdef CONFIG_CRYPTO_DEV_FSL_CAAM_CRYPTO_API\n\nint caam_algapi_init(struct device *dev);\nvoid caam_algapi_exit(void);\n\n#else\n\nstatic inline int caam_algapi_init(struct device *dev)\n{\n\treturn 0;\n}\n\nstatic inline void caam_algapi_exit(void)\n{\n}\n\n#endif  \n\n#ifdef CONFIG_CRYPTO_DEV_FSL_CAAM_AHASH_API\n\nint caam_algapi_hash_init(struct device *dev);\nvoid caam_algapi_hash_exit(void);\n\n#else\n\nstatic inline int caam_algapi_hash_init(struct device *dev)\n{\n\treturn 0;\n}\n\nstatic inline void caam_algapi_hash_exit(void)\n{\n}\n\n#endif  \n\n#ifdef CONFIG_CRYPTO_DEV_FSL_CAAM_PKC_API\n\nint caam_pkc_init(struct device *dev);\nvoid caam_pkc_exit(void);\n\n#else\n\nstatic inline int caam_pkc_init(struct device *dev)\n{\n\treturn 0;\n}\n\nstatic inline void caam_pkc_exit(void)\n{\n}\n\n#endif  \n\n#ifdef CONFIG_CRYPTO_DEV_FSL_CAAM_RNG_API\n\nint caam_rng_init(struct device *dev);\nvoid caam_rng_exit(struct device *dev);\n\n#else\n\nstatic inline int caam_rng_init(struct device *dev)\n{\n\treturn 0;\n}\n\nstatic inline void caam_rng_exit(struct device *dev) {}\n\n#endif  \n\n#ifdef CONFIG_CRYPTO_DEV_FSL_CAAM_PRNG_API\n\nint caam_prng_register(struct device *dev);\nvoid caam_prng_unregister(void *data);\n\n#else\n\nstatic inline int caam_prng_register(struct device *dev)\n{\n\treturn 0;\n}\n\nstatic inline void caam_prng_unregister(void *data) {}\n#endif  \n\n#ifdef CONFIG_CAAM_QI\n\nint caam_qi_algapi_init(struct device *dev);\nvoid caam_qi_algapi_exit(void);\n\n#else\n\nstatic inline int caam_qi_algapi_init(struct device *dev)\n{\n\treturn 0;\n}\n\nstatic inline void caam_qi_algapi_exit(void)\n{\n}\n\n#endif  \n\nstatic inline u64 caam_get_dma_mask(struct device *dev)\n{\n\tstruct device_node *nprop = dev->of_node;\n\n\tif (caam_ptr_sz != sizeof(u64))\n\t\treturn DMA_BIT_MASK(32);\n\n\tif (caam_dpaa2)\n\t\treturn DMA_BIT_MASK(49);\n\n\tif (of_device_is_compatible(nprop, \"fsl,sec-v5.0-job-ring\") ||\n\t    of_device_is_compatible(nprop, \"fsl,sec-v5.0\"))\n\t\treturn DMA_BIT_MASK(40);\n\n\treturn DMA_BIT_MASK(36);\n}\n\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}