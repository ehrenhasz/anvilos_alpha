{
  "module_name": "sun4i-ss.h",
  "hash_id": "63bb44543a7739701dc40ba850ffbf6a1b8ab3a6cd8c67701929d09f0e048a71",
  "original_prompt": "Ingested from linux-6.6.14/drivers/crypto/allwinner/sun4i-ss/sun4i-ss.h",
  "human_readable_source": " \n \n\n#include <linux/clk.h>\n#include <linux/crypto.h>\n#include <linux/io.h>\n#include <linux/module.h>\n#include <linux/of.h>\n#include <linux/platform_device.h>\n#include <linux/reset.h>\n#include <crypto/scatterwalk.h>\n#include <linux/scatterlist.h>\n#include <linux/interrupt.h>\n#include <linux/delay.h>\n#include <linux/pm_runtime.h>\n#include <crypto/md5.h>\n#include <crypto/skcipher.h>\n#include <crypto/sha1.h>\n#include <crypto/hash.h>\n#include <crypto/internal/hash.h>\n#include <crypto/internal/skcipher.h>\n#include <crypto/aes.h>\n#include <crypto/internal/des.h>\n#include <crypto/internal/rng.h>\n#include <crypto/rng.h>\n\n#define SS_CTL            0x00\n#define SS_KEY0           0x04\n#define SS_KEY1           0x08\n#define SS_KEY2           0x0C\n#define SS_KEY3           0x10\n#define SS_KEY4           0x14\n#define SS_KEY5           0x18\n#define SS_KEY6           0x1C\n#define SS_KEY7           0x20\n\n#define SS_IV0            0x24\n#define SS_IV1            0x28\n#define SS_IV2            0x2C\n#define SS_IV3            0x30\n\n#define SS_FCSR           0x44\n\n#define SS_MD0            0x4C\n#define SS_MD1            0x50\n#define SS_MD2            0x54\n#define SS_MD3            0x58\n#define SS_MD4            0x5C\n\n#define SS_RXFIFO         0x200\n#define SS_TXFIFO         0x204\n\n \n\n \n#define SS_PRNG_ONESHOT\t\t(0 << 15)\n#define SS_PRNG_CONTINUE\t(1 << 15)\n\n \n#define SS_IV_ARBITRARY\t\t(1 << 14)\n\n \n#define SS_ECB\t\t\t(0 << 12)\n#define SS_CBC\t\t\t(1 << 12)\n#define SS_CTS\t\t\t(3 << 12)\n\n \n#define SS_CNT_16BITS\t\t(0 << 10)\n#define SS_CNT_32BITS\t\t(1 << 10)\n#define SS_CNT_64BITS\t\t(2 << 10)\n\n \n#define SS_AES_128BITS\t\t(0 << 8)\n#define SS_AES_192BITS\t\t(1 << 8)\n#define SS_AES_256BITS\t\t(2 << 8)\n\n \n#define SS_ENCRYPTION\t\t(0 << 7)\n#define SS_DECRYPTION\t\t(1 << 7)\n\n \n#define SS_OP_AES\t\t(0 << 4)\n#define SS_OP_DES\t\t(1 << 4)\n#define SS_OP_3DES\t\t(2 << 4)\n#define SS_OP_SHA1\t\t(3 << 4)\n#define SS_OP_MD5\t\t(4 << 4)\n#define SS_OP_PRNG\t\t(5 << 4)\n\n \n#define SS_DATA_END\t\t(1 << 2)\n\n \n#define SS_PRNG_START\t\t(1 << 1)\n\n \n#define SS_DISABLED\t\t(0 << 0)\n#define SS_ENABLED\t\t(1 << 0)\n\n \n \n#define SS_RXFIFO_FREE\t\t(1 << 30)\n\n \n#define SS_RXFIFO_SPACES(val)\t(((val) >> 24) & 0x3f)\n\n \n#define SS_TXFIFO_AVAILABLE\t(1 << 22)\n\n \n#define SS_TXFIFO_SPACES(val)\t(((val) >> 16) & 0x3f)\n\n#define SS_RX_MAX\t32\n#define SS_RX_DEFAULT\tSS_RX_MAX\n#define SS_TX_MAX\t33\n\n#define SS_RXFIFO_EMP_INT_PENDING\t(1 << 10)\n#define SS_TXFIFO_AVA_INT_PENDING\t(1 << 8)\n#define SS_RXFIFO_EMP_INT_ENABLE\t(1 << 2)\n#define SS_TXFIFO_AVA_INT_ENABLE\t(1 << 0)\n\n#define SS_SEED_LEN 192\n#define SS_DATA_LEN 160\n\n \nstruct ss_variant {\n\tbool sha1_in_be;\n};\n\nstruct sun4i_ss_ctx {\n\tconst struct ss_variant *variant;\n\tvoid __iomem *base;\n\tint irq;\n\tstruct clk *busclk;\n\tstruct clk *ssclk;\n\tstruct reset_control *reset;\n\tstruct device *dev;\n\tstruct resource *res;\n\tchar buf[4 * SS_RX_MAX]; \n\tchar bufo[4 * SS_TX_MAX];  \n\tspinlock_t slock;  \n#ifdef CONFIG_CRYPTO_DEV_SUN4I_SS_PRNG\n\tu32 seed[SS_SEED_LEN / BITS_PER_LONG];\n#endif\n\tstruct dentry *dbgfs_dir;\n\tstruct dentry *dbgfs_stats;\n};\n\nstruct sun4i_ss_alg_template {\n\tu32 type;\n\tu32 mode;\n\tunion {\n\t\tstruct skcipher_alg crypto;\n\t\tstruct ahash_alg hash;\n\t\tstruct rng_alg rng;\n\t} alg;\n\tstruct sun4i_ss_ctx *ss;\n\tunsigned long stat_req;\n\tunsigned long stat_fb;\n\tunsigned long stat_bytes;\n\tunsigned long stat_opti;\n};\n\nstruct sun4i_tfm_ctx {\n\tu32 key[AES_MAX_KEY_SIZE / 4]; \n\tu32 keylen;\n\tu32 keymode;\n\tstruct sun4i_ss_ctx *ss;\n\tstruct crypto_skcipher *fallback_tfm;\n};\n\nstruct sun4i_cipher_req_ctx {\n\tu32 mode;\n\tu8 backup_iv[AES_BLOCK_SIZE];\n\tstruct skcipher_request fallback_req;   \n};\n\nstruct sun4i_req_ctx {\n\tu32 mode;\n\tu64 byte_count;  \n\tu32 hash[5];  \n\tchar buf[64];\n\tunsigned int len;\n\tint flags;\n};\n\nint sun4i_hash_crainit(struct crypto_tfm *tfm);\nvoid sun4i_hash_craexit(struct crypto_tfm *tfm);\nint sun4i_hash_init(struct ahash_request *areq);\nint sun4i_hash_update(struct ahash_request *areq);\nint sun4i_hash_final(struct ahash_request *areq);\nint sun4i_hash_finup(struct ahash_request *areq);\nint sun4i_hash_digest(struct ahash_request *areq);\nint sun4i_hash_export_md5(struct ahash_request *areq, void *out);\nint sun4i_hash_import_md5(struct ahash_request *areq, const void *in);\nint sun4i_hash_export_sha1(struct ahash_request *areq, void *out);\nint sun4i_hash_import_sha1(struct ahash_request *areq, const void *in);\n\nint sun4i_ss_cbc_aes_encrypt(struct skcipher_request *areq);\nint sun4i_ss_cbc_aes_decrypt(struct skcipher_request *areq);\nint sun4i_ss_ecb_aes_encrypt(struct skcipher_request *areq);\nint sun4i_ss_ecb_aes_decrypt(struct skcipher_request *areq);\n\nint sun4i_ss_cbc_des_encrypt(struct skcipher_request *areq);\nint sun4i_ss_cbc_des_decrypt(struct skcipher_request *areq);\nint sun4i_ss_ecb_des_encrypt(struct skcipher_request *areq);\nint sun4i_ss_ecb_des_decrypt(struct skcipher_request *areq);\n\nint sun4i_ss_cbc_des3_encrypt(struct skcipher_request *areq);\nint sun4i_ss_cbc_des3_decrypt(struct skcipher_request *areq);\nint sun4i_ss_ecb_des3_encrypt(struct skcipher_request *areq);\nint sun4i_ss_ecb_des3_decrypt(struct skcipher_request *areq);\n\nint sun4i_ss_cipher_init(struct crypto_tfm *tfm);\nvoid sun4i_ss_cipher_exit(struct crypto_tfm *tfm);\nint sun4i_ss_aes_setkey(struct crypto_skcipher *tfm, const u8 *key,\n\t\t\tunsigned int keylen);\nint sun4i_ss_des_setkey(struct crypto_skcipher *tfm, const u8 *key,\n\t\t\tunsigned int keylen);\nint sun4i_ss_des3_setkey(struct crypto_skcipher *tfm, const u8 *key,\n\t\t\t unsigned int keylen);\nint sun4i_ss_prng_generate(struct crypto_rng *tfm, const u8 *src,\n\t\t\t   unsigned int slen, u8 *dst, unsigned int dlen);\nint sun4i_ss_prng_seed(struct crypto_rng *tfm, const u8 *seed, unsigned int slen);\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}