{
  "module_name": "sun8i-ce.h",
  "hash_id": "4df8c7364d2e9572e4977edf09c2c143418a3d5ae7d3ce4c4031effe825057b7",
  "original_prompt": "Ingested from linux-6.6.14/drivers/crypto/allwinner/sun8i-ce/sun8i-ce.h",
  "human_readable_source": " \n \n#include <crypto/aes.h>\n#include <crypto/des.h>\n#include <crypto/engine.h>\n#include <crypto/skcipher.h>\n#include <linux/atomic.h>\n#include <linux/debugfs.h>\n#include <linux/crypto.h>\n#include <linux/hw_random.h>\n#include <crypto/internal/hash.h>\n#include <crypto/md5.h>\n#include <crypto/rng.h>\n#include <crypto/sha1.h>\n#include <crypto/sha2.h>\n\n \n#define CE_TDQ\t0x00\n#define CE_CTR\t0x04\n#define CE_ICR\t0x08\n#define CE_ISR\t0x0C\n#define CE_TLR\t0x10\n#define CE_TSR\t0x14\n#define CE_ESR\t0x18\n#define CE_CSSGR\t0x1C\n#define CE_CDSGR\t0x20\n#define CE_CSAR\t0x24\n#define CE_CDAR\t0x28\n#define CE_TPR\t0x2C\n\n \n \n#define CE_ENCRYPTION\t\t0\n#define CE_DECRYPTION\t\tBIT(8)\n\n#define CE_COMM_INT\t\tBIT(31)\n\n \n#define CE_AES_128BITS 0\n#define CE_AES_192BITS 1\n#define CE_AES_256BITS 2\n\n#define CE_OP_ECB\t0\n#define CE_OP_CBC\t(1 << 8)\n\n#define CE_ALG_AES\t\t0\n#define CE_ALG_DES\t\t1\n#define CE_ALG_3DES\t\t2\n#define CE_ALG_MD5              16\n#define CE_ALG_SHA1             17\n#define CE_ALG_SHA224           18\n#define CE_ALG_SHA256           19\n#define CE_ALG_SHA384           20\n#define CE_ALG_SHA512           21\n#define CE_ALG_TRNG\t\t48\n#define CE_ALG_PRNG\t\t49\n#define CE_ALG_TRNG_V2\t\t0x1c\n#define CE_ALG_PRNG_V2\t\t0x1d\n\n \n#define CE_ID_NOTSUPP\t\t0xFF\n\n#define CE_ID_CIPHER_AES\t0\n#define CE_ID_CIPHER_DES\t1\n#define CE_ID_CIPHER_DES3\t2\n#define CE_ID_CIPHER_MAX\t3\n\n#define CE_ID_HASH_MD5\t\t0\n#define CE_ID_HASH_SHA1\t\t1\n#define CE_ID_HASH_SHA224\t2\n#define CE_ID_HASH_SHA256\t3\n#define CE_ID_HASH_SHA384\t4\n#define CE_ID_HASH_SHA512\t5\n#define CE_ID_HASH_MAX\t\t6\n\n#define CE_ID_OP_ECB\t0\n#define CE_ID_OP_CBC\t1\n#define CE_ID_OP_MAX\t2\n\n \n#define CE_ERR_ALGO_NOTSUP\tBIT(0)\n#define CE_ERR_DATALEN\t\tBIT(1)\n#define CE_ERR_KEYSRAM\t\tBIT(2)\n#define CE_ERR_ADDR_INVALID\tBIT(5)\n#define CE_ERR_KEYLADDER\tBIT(6)\n\n#define ESR_H3\t0\n#define ESR_A64\t1\n#define ESR_R40\t2\n#define ESR_H5\t3\n#define ESR_H6\t4\n#define ESR_D1\t5\n\n#define PRNG_DATA_SIZE (160 / 8)\n#define PRNG_SEED_SIZE DIV_ROUND_UP(175, 8)\n#define PRNG_LD BIT(17)\n\n#define CE_DIE_ID_SHIFT\t16\n#define CE_DIE_ID_MASK\t0x07\n\n#define MAX_SG 8\n\n#define CE_MAX_CLOCKS 4\n\n#define MAXFLOW 4\n\n \nstruct ce_clock {\n\tconst char *name;\n\tunsigned long freq;\n\tunsigned long max_freq;\n};\n\n \nstruct ce_variant {\n\tchar alg_cipher[CE_ID_CIPHER_MAX];\n\tchar alg_hash[CE_ID_HASH_MAX];\n\tu32 op_mode[CE_ID_OP_MAX];\n\tbool cipher_t_dlen_in_bytes;\n\tbool hash_t_dlen_in_bits;\n\tbool prng_t_dlen_in_bytes;\n\tbool trng_t_dlen_in_bytes;\n\tstruct ce_clock ce_clks[CE_MAX_CLOCKS];\n\tint esr;\n\tunsigned char prng;\n\tunsigned char trng;\n};\n\nstruct sginfo {\n\t__le32 addr;\n\t__le32 len;\n} __packed;\n\n \nstruct ce_task {\n\t__le32 t_id;\n\t__le32 t_common_ctl;\n\t__le32 t_sym_ctl;\n\t__le32 t_asym_ctl;\n\t__le32 t_key;\n\t__le32 t_iv;\n\t__le32 t_ctr;\n\t__le32 t_dlen;\n\tstruct sginfo t_src[MAX_SG];\n\tstruct sginfo t_dst[MAX_SG];\n\t__le32 next;\n\t__le32 reserved[3];\n} __packed __aligned(8);\n\n \nstruct sun8i_ce_flow {\n\tstruct crypto_engine *engine;\n\tstruct completion complete;\n\tint status;\n\tdma_addr_t t_phy;\n\tint timeout;\n\tstruct ce_task *tl;\n\tvoid *backup_iv;\n\tvoid *bounce_iv;\n#ifdef CONFIG_CRYPTO_DEV_SUN8I_CE_DEBUG\n\tunsigned long stat_req;\n#endif\n};\n\n \nstruct sun8i_ce_dev {\n\tvoid __iomem *base;\n\tstruct clk *ceclks[CE_MAX_CLOCKS];\n\tstruct reset_control *reset;\n\tstruct device *dev;\n\tstruct mutex mlock;\n\tstruct mutex rnglock;\n\tstruct sun8i_ce_flow *chanlist;\n\tatomic_t flow;\n\tconst struct ce_variant *variant;\n#ifdef CONFIG_CRYPTO_DEV_SUN8I_CE_DEBUG\n\tstruct dentry *dbgfs_dir;\n\tstruct dentry *dbgfs_stats;\n#endif\n#ifdef CONFIG_CRYPTO_DEV_SUN8I_CE_TRNG\n\tstruct hwrng trng;\n#ifdef CONFIG_CRYPTO_DEV_SUN8I_CE_DEBUG\n\tunsigned long hwrng_stat_req;\n\tunsigned long hwrng_stat_bytes;\n#endif\n#endif\n};\n\n \nstruct sun8i_cipher_req_ctx {\n\tu32 op_dir;\n\tint flow;\n\tunsigned int ivlen;\n\tint nr_sgs;\n\tint nr_sgd;\n\tdma_addr_t addr_iv;\n\tdma_addr_t addr_key;\n\tstruct skcipher_request fallback_req;   \n};\n\n \nstruct sun8i_cipher_tfm_ctx {\n\tu32 *key;\n\tu32 keylen;\n\tstruct sun8i_ce_dev *ce;\n\tstruct crypto_skcipher *fallback_tfm;\n};\n\n \nstruct sun8i_ce_hash_tfm_ctx {\n\tstruct sun8i_ce_dev *ce;\n\tstruct crypto_ahash *fallback_tfm;\n};\n\n \nstruct sun8i_ce_hash_reqctx {\n\tstruct ahash_request fallback_req;\n\tint flow;\n};\n\n \nstruct sun8i_ce_rng_tfm_ctx {\n\tvoid *seed;\n\tunsigned int slen;\n};\n\n \nstruct sun8i_ce_alg_template {\n\tu32 type;\n\tu32 ce_algo_id;\n\tu32 ce_blockmode;\n\tstruct sun8i_ce_dev *ce;\n\tunion {\n\t\tstruct skcipher_engine_alg skcipher;\n\t\tstruct ahash_engine_alg hash;\n\t\tstruct rng_alg rng;\n\t} alg;\n\tunsigned long stat_req;\n\tunsigned long stat_fb;\n\tunsigned long stat_bytes;\n\tunsigned long stat_fb_maxsg;\n\tunsigned long stat_fb_leniv;\n\tunsigned long stat_fb_len0;\n\tunsigned long stat_fb_mod16;\n\tunsigned long stat_fb_srcali;\n\tunsigned long stat_fb_srclen;\n\tunsigned long stat_fb_dstali;\n\tunsigned long stat_fb_dstlen;\n\tchar fbname[CRYPTO_MAX_ALG_NAME];\n};\n\nint sun8i_ce_aes_setkey(struct crypto_skcipher *tfm, const u8 *key,\n\t\t\tunsigned int keylen);\nint sun8i_ce_des3_setkey(struct crypto_skcipher *tfm, const u8 *key,\n\t\t\t unsigned int keylen);\nint sun8i_ce_cipher_init(struct crypto_tfm *tfm);\nvoid sun8i_ce_cipher_exit(struct crypto_tfm *tfm);\nint sun8i_ce_cipher_do_one(struct crypto_engine *engine, void *areq);\nint sun8i_ce_skdecrypt(struct skcipher_request *areq);\nint sun8i_ce_skencrypt(struct skcipher_request *areq);\n\nint sun8i_ce_get_engine_number(struct sun8i_ce_dev *ce);\n\nint sun8i_ce_run_task(struct sun8i_ce_dev *ce, int flow, const char *name);\n\nint sun8i_ce_hash_init_tfm(struct crypto_ahash *tfm);\nvoid sun8i_ce_hash_exit_tfm(struct crypto_ahash *tfm);\nint sun8i_ce_hash_init(struct ahash_request *areq);\nint sun8i_ce_hash_export(struct ahash_request *areq, void *out);\nint sun8i_ce_hash_import(struct ahash_request *areq, const void *in);\nint sun8i_ce_hash_final(struct ahash_request *areq);\nint sun8i_ce_hash_update(struct ahash_request *areq);\nint sun8i_ce_hash_finup(struct ahash_request *areq);\nint sun8i_ce_hash_digest(struct ahash_request *areq);\nint sun8i_ce_hash_run(struct crypto_engine *engine, void *breq);\n\nint sun8i_ce_prng_generate(struct crypto_rng *tfm, const u8 *src,\n\t\t\t   unsigned int slen, u8 *dst, unsigned int dlen);\nint sun8i_ce_prng_seed(struct crypto_rng *tfm, const u8 *seed, unsigned int slen);\nvoid sun8i_ce_prng_exit(struct crypto_tfm *tfm);\nint sun8i_ce_prng_init(struct crypto_tfm *tfm);\n\nint sun8i_ce_hwrng_register(struct sun8i_ce_dev *ce);\nvoid sun8i_ce_hwrng_unregister(struct sun8i_ce_dev *ce);\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}