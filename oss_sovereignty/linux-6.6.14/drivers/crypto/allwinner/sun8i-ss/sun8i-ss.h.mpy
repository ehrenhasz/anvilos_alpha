{
  "module_name": "sun8i-ss.h",
  "hash_id": "e4b12b594b41138adfa593e206436fa69c5f9250845a07c9f71037de8cae4d27",
  "original_prompt": "Ingested from linux-6.6.14/drivers/crypto/allwinner/sun8i-ss/sun8i-ss.h",
  "human_readable_source": " \n \n#include <crypto/aes.h>\n#include <crypto/des.h>\n#include <crypto/engine.h>\n#include <crypto/rng.h>\n#include <crypto/skcipher.h>\n#include <linux/atomic.h>\n#include <linux/debugfs.h>\n#include <linux/crypto.h>\n#include <crypto/internal/hash.h>\n#include <crypto/md5.h>\n#include <crypto/sha1.h>\n#include <crypto/sha2.h>\n\n#define SS_START\t1\n\n#define SS_ENCRYPTION\t\t0\n#define SS_DECRYPTION\t\tBIT(6)\n\n#define SS_ALG_AES\t\t0\n#define SS_ALG_DES\t\t(1 << 2)\n#define SS_ALG_3DES\t\t(2 << 2)\n#define SS_ALG_MD5\t\t(3 << 2)\n#define SS_ALG_PRNG\t\t(4 << 2)\n#define SS_ALG_SHA1\t\t(6 << 2)\n#define SS_ALG_SHA224\t\t(7 << 2)\n#define SS_ALG_SHA256\t\t(8 << 2)\n\n#define SS_CTL_REG\t\t0x00\n#define SS_INT_CTL_REG\t\t0x04\n#define SS_INT_STA_REG\t\t0x08\n#define SS_KEY_ADR_REG\t\t0x10\n#define SS_IV_ADR_REG\t\t0x18\n#define SS_SRC_ADR_REG\t\t0x20\n#define SS_DST_ADR_REG\t\t0x28\n#define SS_LEN_ADR_REG\t\t0x30\n\n#define SS_ID_NOTSUPP\t\t0xFF\n\n#define SS_ID_CIPHER_AES\t0\n#define SS_ID_CIPHER_DES\t1\n#define SS_ID_CIPHER_DES3\t2\n#define SS_ID_CIPHER_MAX\t3\n\n#define SS_ID_OP_ECB\t0\n#define SS_ID_OP_CBC\t1\n#define SS_ID_OP_MAX\t2\n\n#define SS_AES_128BITS 0\n#define SS_AES_192BITS 1\n#define SS_AES_256BITS 2\n\n#define SS_OP_ECB\t0\n#define SS_OP_CBC\t(1 << 13)\n\n#define SS_ID_HASH_MD5\t0\n#define SS_ID_HASH_SHA1\t1\n#define SS_ID_HASH_SHA224\t2\n#define SS_ID_HASH_SHA256\t3\n#define SS_ID_HASH_MAX\t4\n\n#define SS_FLOW0\tBIT(30)\n#define SS_FLOW1\tBIT(31)\n\n#define SS_PRNG_CONTINUE\tBIT(18)\n\n#define MAX_SG 8\n\n#define MAXFLOW 2\n\n#define SS_MAX_CLOCKS 2\n\n#define SS_DIE_ID_SHIFT\t20\n#define SS_DIE_ID_MASK\t0x07\n\n#define PRNG_DATA_SIZE (160 / 8)\n#define PRNG_SEED_SIZE DIV_ROUND_UP(175, 8)\n\n#define MAX_PAD_SIZE 4096\n\n \nstruct ss_clock {\n\tconst char *name;\n\tunsigned long freq;\n\tunsigned long max_freq;\n};\n\n \nstruct ss_variant {\n\tchar alg_cipher[SS_ID_CIPHER_MAX];\n\tchar alg_hash[SS_ID_HASH_MAX];\n\tu32 op_mode[SS_ID_OP_MAX];\n\tstruct ss_clock ss_clks[SS_MAX_CLOCKS];\n};\n\nstruct sginfo {\n\tu32 addr;\n\tu32 len;\n};\n\n \nstruct sun8i_ss_flow {\n\tstruct crypto_engine *engine;\n\tstruct completion complete;\n\tint status;\n\tu8 *iv[MAX_SG];\n\tu8 *biv;\n\tvoid *pad;\n\tvoid *result;\n#ifdef CONFIG_CRYPTO_DEV_SUN8I_SS_DEBUG\n\tunsigned long stat_req;\n#endif\n};\n\n \nstruct sun8i_ss_dev {\n\tvoid __iomem *base;\n\tstruct clk *ssclks[SS_MAX_CLOCKS];\n\tstruct reset_control *reset;\n\tstruct device *dev;\n\tstruct mutex mlock;\n\tstruct sun8i_ss_flow *flows;\n\tatomic_t flow;\n\tconst struct ss_variant *variant;\n#ifdef CONFIG_CRYPTO_DEV_SUN8I_SS_DEBUG\n\tstruct dentry *dbgfs_dir;\n\tstruct dentry *dbgfs_stats;\n#endif\n};\n\n \nstruct sun8i_cipher_req_ctx {\n\tstruct sginfo t_src[MAX_SG];\n\tstruct sginfo t_dst[MAX_SG];\n\tu32 p_key;\n\tu32 p_iv[MAX_SG];\n\tint niv;\n\tu32 method;\n\tu32 op_mode;\n\tu32 op_dir;\n\tint flow;\n\tunsigned int ivlen;\n\tunsigned int keylen;\n\tstruct skcipher_request fallback_req;   \n};\n\n \nstruct sun8i_cipher_tfm_ctx {\n\tu32 *key;\n\tu32 keylen;\n\tstruct sun8i_ss_dev *ss;\n\tstruct crypto_skcipher *fallback_tfm;\n};\n\n \nstruct sun8i_ss_rng_tfm_ctx {\n\tvoid *seed;\n\tunsigned int slen;\n};\n\n \nstruct sun8i_ss_hash_tfm_ctx {\n\tstruct crypto_ahash *fallback_tfm;\n\tstruct sun8i_ss_dev *ss;\n\tu8 *ipad;\n\tu8 *opad;\n\tu8 key[SHA256_BLOCK_SIZE];\n\tint keylen;\n};\n\n \nstruct sun8i_ss_hash_reqctx {\n\tstruct sginfo t_src[MAX_SG];\n\tstruct sginfo t_dst[MAX_SG];\n\tstruct ahash_request fallback_req;\n\tu32 method;\n\tint flow;\n};\n\n \nstruct sun8i_ss_alg_template {\n\tu32 type;\n\tu32 ss_algo_id;\n\tu32 ss_blockmode;\n\tstruct sun8i_ss_dev *ss;\n\tunion {\n\t\tstruct skcipher_engine_alg skcipher;\n\t\tstruct rng_alg rng;\n\t\tstruct ahash_engine_alg hash;\n\t} alg;\n\tunsigned long stat_req;\n\tunsigned long stat_fb;\n\tunsigned long stat_bytes;\n\tunsigned long stat_fb_len;\n\tunsigned long stat_fb_sglen;\n\tunsigned long stat_fb_align;\n\tunsigned long stat_fb_sgnum;\n\tchar fbname[CRYPTO_MAX_ALG_NAME];\n};\n\nint sun8i_ss_aes_setkey(struct crypto_skcipher *tfm, const u8 *key,\n\t\t\tunsigned int keylen);\nint sun8i_ss_des3_setkey(struct crypto_skcipher *tfm, const u8 *key,\n\t\t\t unsigned int keylen);\nint sun8i_ss_cipher_init(struct crypto_tfm *tfm);\nvoid sun8i_ss_cipher_exit(struct crypto_tfm *tfm);\nint sun8i_ss_handle_cipher_request(struct crypto_engine *engine, void *areq);\nint sun8i_ss_skdecrypt(struct skcipher_request *areq);\nint sun8i_ss_skencrypt(struct skcipher_request *areq);\n\nint sun8i_ss_get_engine_number(struct sun8i_ss_dev *ss);\n\nint sun8i_ss_run_task(struct sun8i_ss_dev *ss, struct sun8i_cipher_req_ctx *rctx, const char *name);\nint sun8i_ss_prng_generate(struct crypto_rng *tfm, const u8 *src,\n\t\t\t   unsigned int slen, u8 *dst, unsigned int dlen);\nint sun8i_ss_prng_seed(struct crypto_rng *tfm, const u8 *seed, unsigned int slen);\nint sun8i_ss_prng_init(struct crypto_tfm *tfm);\nvoid sun8i_ss_prng_exit(struct crypto_tfm *tfm);\n\nint sun8i_ss_hash_init_tfm(struct crypto_ahash *tfm);\nvoid sun8i_ss_hash_exit_tfm(struct crypto_ahash *tfm);\nint sun8i_ss_hash_init(struct ahash_request *areq);\nint sun8i_ss_hash_export(struct ahash_request *areq, void *out);\nint sun8i_ss_hash_import(struct ahash_request *areq, const void *in);\nint sun8i_ss_hash_final(struct ahash_request *areq);\nint sun8i_ss_hash_update(struct ahash_request *areq);\nint sun8i_ss_hash_finup(struct ahash_request *areq);\nint sun8i_ss_hash_digest(struct ahash_request *areq);\nint sun8i_ss_hash_run(struct crypto_engine *engine, void *breq);\nint sun8i_ss_hmac_setkey(struct crypto_ahash *ahash, const u8 *key,\n\t\t\t unsigned int keylen);\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}