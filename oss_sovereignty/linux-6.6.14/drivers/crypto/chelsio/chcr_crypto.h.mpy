{
  "module_name": "chcr_crypto.h",
  "hash_id": "20a33d357607e88a4cd2de688ee20278c40633b683f5216184f006825fbf7d85",
  "original_prompt": "Ingested from linux-6.6.14/drivers/crypto/chelsio/chcr_crypto.h",
  "human_readable_source": " \n\n#ifndef __CHCR_CRYPTO_H__\n#define __CHCR_CRYPTO_H__\n\n#define GHASH_BLOCK_SIZE    16\n#define GHASH_DIGEST_SIZE   16\n\n#define CCM_B0_SIZE             16\n#define CCM_AAD_FIELD_SIZE      2\n\n#define T6_MAX_AAD_SIZE 495\n\n\n \n\n#define CHCR_CRA_PRIORITY 500\n#define CHCR_AEAD_PRIORITY 6000\n#define CHCR_AES_MAX_KEY_LEN  (2 * (AES_MAX_KEY_SIZE))  \n#define CHCR_MAX_CRYPTO_IV_LEN 16  \n\n#define CHCR_MAX_AUTHENC_AES_KEY_LEN 32  \n#define CHCR_MAX_AUTHENC_SHA_KEY_LEN 128  \n\n#define CHCR_GIVENCRYPT_OP 2\n \n\n#define CHCR_ENCRYPT_OP 0\n#define CHCR_DECRYPT_OP 1\n\n#define CHCR_SCMD_SEQ_NO_CTRL_32BIT     1\n#define CHCR_SCMD_SEQ_NO_CTRL_48BIT     2\n#define CHCR_SCMD_SEQ_NO_CTRL_64BIT     3\n\n#define CHCR_SCMD_PROTO_VERSION_GENERIC 4\n\n#define CHCR_SCMD_AUTH_CTRL_AUTH_CIPHER 0\n#define CHCR_SCMD_AUTH_CTRL_CIPHER_AUTH 1\n\n#define CHCR_SCMD_CIPHER_MODE_NOP               0\n#define CHCR_SCMD_CIPHER_MODE_AES_CBC           1\n#define CHCR_SCMD_CIPHER_MODE_AES_GCM           2\n#define CHCR_SCMD_CIPHER_MODE_AES_CTR           3\n#define CHCR_SCMD_CIPHER_MODE_GENERIC_AES       4\n#define CHCR_SCMD_CIPHER_MODE_AES_XTS           6\n#define CHCR_SCMD_CIPHER_MODE_AES_CCM           7\n\n#define CHCR_SCMD_AUTH_MODE_NOP             0\n#define CHCR_SCMD_AUTH_MODE_SHA1            1\n#define CHCR_SCMD_AUTH_MODE_SHA224          2\n#define CHCR_SCMD_AUTH_MODE_SHA256          3\n#define CHCR_SCMD_AUTH_MODE_GHASH           4\n#define CHCR_SCMD_AUTH_MODE_SHA512_224      5\n#define CHCR_SCMD_AUTH_MODE_SHA512_256      6\n#define CHCR_SCMD_AUTH_MODE_SHA512_384      7\n#define CHCR_SCMD_AUTH_MODE_SHA512_512      8\n#define CHCR_SCMD_AUTH_MODE_CBCMAC          9\n#define CHCR_SCMD_AUTH_MODE_CMAC            10\n\n#define CHCR_SCMD_HMAC_CTRL_NOP             0\n#define CHCR_SCMD_HMAC_CTRL_NO_TRUNC        1\n#define CHCR_SCMD_HMAC_CTRL_TRUNC_RFC4366   2\n#define CHCR_SCMD_HMAC_CTRL_IPSEC_96BIT     3\n#define CHCR_SCMD_HMAC_CTRL_PL1\t\t    4\n#define CHCR_SCMD_HMAC_CTRL_PL2\t\t    5\n#define CHCR_SCMD_HMAC_CTRL_PL3\t\t    6\n#define CHCR_SCMD_HMAC_CTRL_DIV2\t    7\n#define VERIFY_HW 0\n#define VERIFY_SW 1\n\n#define CHCR_SCMD_IVGEN_CTRL_HW             0\n#define CHCR_SCMD_IVGEN_CTRL_SW             1\n \n#define CHCR_KEYCTX_MAC_KEY_SIZE_128        0\n#define CHCR_KEYCTX_MAC_KEY_SIZE_160        1\n#define CHCR_KEYCTX_MAC_KEY_SIZE_192        2\n#define CHCR_KEYCTX_MAC_KEY_SIZE_256        3\n#define CHCR_KEYCTX_MAC_KEY_SIZE_512        4\n#define CHCR_KEYCTX_CIPHER_KEY_SIZE_128     0\n#define CHCR_KEYCTX_CIPHER_KEY_SIZE_192     1\n#define CHCR_KEYCTX_CIPHER_KEY_SIZE_256     2\n#define CHCR_KEYCTX_NO_KEY                  15\n\n#define CHCR_CPL_FW4_PLD_IV_OFFSET          (5 * 64)  \n#define CHCR_CPL_FW4_PLD_HASH_RESULT_OFFSET (7 * 64)  \n#define CHCR_CPL_FW4_PLD_DATA_SIZE          (4 * 64)  \n\n#define KEY_CONTEXT_HDR_SALT_AND_PAD\t    16\n#define flits_to_bytes(x)  (x * 8)\n\n#define IV_NOP                  0\n#define IV_IMMEDIATE            1\n#define IV_DSGL\t\t\t2\n\n#define AEAD_H_SIZE             16\n\n#define CRYPTO_ALG_SUB_TYPE_MASK            0x0f000000\n#define CRYPTO_ALG_SUB_TYPE_HASH_HMAC       0x01000000\n#define CRYPTO_ALG_SUB_TYPE_AEAD_RFC4106    0x02000000\n#define CRYPTO_ALG_SUB_TYPE_AEAD_GCM\t    0x03000000\n#define CRYPTO_ALG_SUB_TYPE_CBC_SHA\t    0x04000000\n#define CRYPTO_ALG_SUB_TYPE_AEAD_CCM        0x05000000\n#define CRYPTO_ALG_SUB_TYPE_AEAD_RFC4309    0x06000000\n#define CRYPTO_ALG_SUB_TYPE_CBC_NULL\t    0x07000000\n#define CRYPTO_ALG_SUB_TYPE_CTR             0x08000000\n#define CRYPTO_ALG_SUB_TYPE_CTR_RFC3686     0x09000000\n#define CRYPTO_ALG_SUB_TYPE_XTS\t\t    0x0a000000\n#define CRYPTO_ALG_SUB_TYPE_CBC\t\t    0x0b000000\n#define CRYPTO_ALG_SUB_TYPE_CTR_SHA\t    0x0c000000\n#define CRYPTO_ALG_SUB_TYPE_CTR_NULL   0x0d000000\n#define CRYPTO_ALG_TYPE_HMAC (CRYPTO_ALG_TYPE_AHASH |\\\n\t\t\t      CRYPTO_ALG_SUB_TYPE_HASH_HMAC)\n\n#define MAX_SCRATCH_PAD_SIZE    32\n\n#define CHCR_HASH_MAX_BLOCK_SIZE_64  64\n#define CHCR_HASH_MAX_BLOCK_SIZE_128 128\n#define CHCR_SRC_SG_SIZE (0x10000 - sizeof(int))\n#define CHCR_DST_SG_SIZE 2048\n\nstatic inline struct chcr_context *a_ctx(struct crypto_aead *tfm)\n{\n\treturn crypto_aead_ctx(tfm);\n}\n\nstatic inline struct chcr_context *c_ctx(struct crypto_skcipher *tfm)\n{\n\treturn crypto_skcipher_ctx(tfm);\n}\n\nstatic inline struct chcr_context *h_ctx(struct crypto_ahash *tfm)\n{\n\treturn crypto_tfm_ctx(crypto_ahash_tfm(tfm));\n}\n\nstruct ablk_ctx {\n\tstruct crypto_skcipher *sw_cipher;\n\t__be32 key_ctx_hdr;\n\tunsigned int enckey_len;\n\tunsigned char ciph_mode;\n\tu8 key[CHCR_AES_MAX_KEY_LEN];\n\tu8 nonce[4];\n\tu8 rrkey[AES_MAX_KEY_SIZE];\n};\nstruct chcr_aead_reqctx {\n\tstruct\tsk_buff\t*skb;\n\tdma_addr_t iv_dma;\n\tdma_addr_t b0_dma;\n\tunsigned int b0_len;\n\tunsigned int op;\n\tu16 imm;\n\tu16 verify;\n\tu16 txqidx;\n\tu16 rxqidx;\n\tu8 iv[CHCR_MAX_CRYPTO_IV_LEN + MAX_SCRATCH_PAD_SIZE];\n\tu8 *scratch_pad;\n};\n\nstruct ulptx_walk {\n\tstruct ulptx_sgl *sgl;\n\tunsigned int nents;\n\tunsigned int pair_idx;\n\tunsigned int last_sg_len;\n\tstruct scatterlist *last_sg;\n\tstruct ulptx_sge_pair *pair;\n\n};\n\nstruct dsgl_walk {\n\tunsigned int nents;\n\tunsigned int last_sg_len;\n\tstruct scatterlist *last_sg;\n\tstruct cpl_rx_phys_dsgl *dsgl;\n\tstruct phys_sge_pairs *to;\n};\n\nstruct chcr_gcm_ctx {\n\tu8 ghash_h[AEAD_H_SIZE];\n};\n\nstruct chcr_authenc_ctx {\n\tu8 dec_rrkey[AES_MAX_KEY_SIZE];\n\tu8 h_iopad[2 * CHCR_HASH_MAX_DIGEST_SIZE];\n\tunsigned char auth_mode;\n};\n\nstruct __aead_ctx {\n\tunion {\n\t\tDECLARE_FLEX_ARRAY(struct chcr_gcm_ctx, gcm);\n\t\tDECLARE_FLEX_ARRAY(struct chcr_authenc_ctx, authenc);\n\t};\n};\n\nstruct chcr_aead_ctx {\n\t__be32 key_ctx_hdr;\n\tunsigned int enckey_len;\n\tstruct crypto_aead *sw_cipher;\n\tu8 salt[MAX_SALT];\n\tu8 key[CHCR_AES_MAX_KEY_LEN];\n\tu8 nonce[4];\n\tu16 hmac_ctrl;\n\tu16 mayverify;\n\tstruct\t__aead_ctx ctx[];\n};\n\nstruct hmac_ctx {\n\tstruct crypto_shash *base_hash;\n\tu8 ipad[CHCR_HASH_MAX_BLOCK_SIZE_128];\n\tu8 opad[CHCR_HASH_MAX_BLOCK_SIZE_128];\n};\n\nstruct __crypto_ctx {\n\tunion {\n\t\tstruct hmac_ctx hmacctx;\n\t\tstruct ablk_ctx ablkctx;\n\t\tstruct chcr_aead_ctx aeadctx;\n\t};\n};\n\nstruct chcr_context {\n\tstruct chcr_dev *dev;\n\tunsigned char rxq_perchan;\n\tunsigned char txq_perchan;\n\tunsigned int  ntxq;\n\tunsigned int  nrxq;\n\tstruct completion cbc_aes_aio_done;\n\tstruct __crypto_ctx crypto_ctx[];\n};\n\nstruct chcr_hctx_per_wr {\n\tstruct scatterlist *srcsg;\n\tstruct sk_buff *skb;\n\tdma_addr_t dma_addr;\n\tu32 dma_len;\n\tunsigned int src_ofst;\n\tunsigned int processed;\n\tu32 result;\n\tu8 is_sg_map;\n\tu8 imm;\n\t \n\tu8 isfinal;\n};\n\nstruct chcr_ahash_req_ctx {\n\tstruct chcr_hctx_per_wr hctx_wr;\n\tu8 *reqbfr;\n\tu8 *skbfr;\n\t \n\tu64 data_len;   \n\tu16 txqidx;\n\tu16 rxqidx;\n\tu8 reqlen;\n\tu8 partial_hash[CHCR_HASH_MAX_DIGEST_SIZE];\n\tu8 bfr1[CHCR_HASH_MAX_BLOCK_SIZE_128];\n\tu8 bfr2[CHCR_HASH_MAX_BLOCK_SIZE_128];\n};\n\nstruct chcr_skcipher_req_ctx {\n\tstruct sk_buff *skb;\n\tstruct scatterlist *dstsg;\n\tunsigned int processed;\n\tunsigned int last_req_len;\n\tunsigned int partial_req;\n\tstruct scatterlist *srcsg;\n\tunsigned int src_ofst;\n\tunsigned int dst_ofst;\n\tunsigned int op;\n\tu16 imm;\n\tu8 iv[CHCR_MAX_CRYPTO_IV_LEN];\n\tu8 init_iv[CHCR_MAX_CRYPTO_IV_LEN];\n\tu16 txqidx;\n\tu16 rxqidx;\n\tstruct skcipher_request fallback_req;\t\n};\n\nstruct chcr_alg_template {\n\tu32 type;\n\tu32 is_registered;\n\tunion {\n\t\tstruct skcipher_alg skcipher;\n\t\tstruct ahash_alg hash;\n\t\tstruct aead_alg aead;\n\t} alg;\n};\n\ntypedef struct sk_buff *(*create_wr_t)(struct aead_request *req,\n\t\t\t\t       unsigned short qid,\n\t\t\t\t       int size);\n\nvoid chcr_verify_tag(struct aead_request *req, u8 *input, int *err);\nint chcr_aead_dma_map(struct device *dev, struct aead_request *req,\n\t\t      unsigned short op_type);\nvoid chcr_aead_dma_unmap(struct device *dev, struct aead_request *req,\n\t\t\t unsigned short op_type);\nvoid chcr_add_aead_dst_ent(struct aead_request *req,\n\t\t\t   struct cpl_rx_phys_dsgl *phys_cpl,\n\t\t\t   unsigned short qid);\nvoid chcr_add_aead_src_ent(struct aead_request *req, struct ulptx_sgl *ulptx);\nvoid chcr_add_cipher_src_ent(struct skcipher_request *req,\n\t\t\t     void *ulptx,\n\t\t\t     struct  cipher_wr_param *wrparam);\nint chcr_cipher_dma_map(struct device *dev, struct skcipher_request *req);\nvoid chcr_cipher_dma_unmap(struct device *dev, struct skcipher_request *req);\nvoid chcr_add_cipher_dst_ent(struct skcipher_request *req,\n\t\t\t     struct cpl_rx_phys_dsgl *phys_cpl,\n\t\t\t     struct  cipher_wr_param *wrparam,\n\t\t\t     unsigned short qid);\nvoid chcr_add_hash_src_ent(struct ahash_request *req, struct ulptx_sgl *ulptx,\n\t\t\t   struct hash_wr_param *param);\nint chcr_hash_dma_map(struct device *dev, struct ahash_request *req);\nvoid chcr_hash_dma_unmap(struct device *dev, struct ahash_request *req);\nvoid chcr_aead_common_exit(struct aead_request *req);\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}