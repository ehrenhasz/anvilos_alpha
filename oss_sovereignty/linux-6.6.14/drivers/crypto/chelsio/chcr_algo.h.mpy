{
  "module_name": "chcr_algo.h",
  "hash_id": "74308121d9b9d9cf39e11d3aba0472695948398b0119b2374e1fb515fcd249e3",
  "original_prompt": "Ingested from linux-6.6.14/drivers/crypto/chelsio/chcr_algo.h",
  "human_readable_source": " \n\n#ifndef __CHCR_ALGO_H__\n#define __CHCR_ALGO_H__\n\n \n#define KEY_CONTEXT_CTX_LEN_S           24\n#define KEY_CONTEXT_CTX_LEN_M           0xff\n#define KEY_CONTEXT_CTX_LEN_V(x)        ((x) << KEY_CONTEXT_CTX_LEN_S)\n#define KEY_CONTEXT_CTX_LEN_G(x) \\\n\t(((x) >> KEY_CONTEXT_CTX_LEN_S) & KEY_CONTEXT_CTX_LEN_M)\n\n#define KEY_CONTEXT_DUAL_CK_S      12\n#define KEY_CONTEXT_DUAL_CK_M      0x1\n#define KEY_CONTEXT_DUAL_CK_V(x)   ((x) << KEY_CONTEXT_DUAL_CK_S)\n#define KEY_CONTEXT_DUAL_CK_G(x)   \\\n(((x) >> KEY_CONTEXT_DUAL_CK_S) & KEY_CONTEXT_DUAL_CK_M)\n#define KEY_CONTEXT_DUAL_CK_F      KEY_CONTEXT_DUAL_CK_V(1U)\n\n#define KEY_CONTEXT_SALT_PRESENT_S      10\n#define KEY_CONTEXT_SALT_PRESENT_M      0x1\n#define KEY_CONTEXT_SALT_PRESENT_V(x)   ((x) << KEY_CONTEXT_SALT_PRESENT_S)\n#define KEY_CONTEXT_SALT_PRESENT_G(x)   \\\n\t(((x) >> KEY_CONTEXT_SALT_PRESENT_S) & \\\n\t KEY_CONTEXT_SALT_PRESENT_M)\n#define KEY_CONTEXT_SALT_PRESENT_F      KEY_CONTEXT_SALT_PRESENT_V(1U)\n\n#define KEY_CONTEXT_VALID_S     0\n#define KEY_CONTEXT_VALID_M     0x1\n#define KEY_CONTEXT_VALID_V(x)  ((x) << KEY_CONTEXT_VALID_S)\n#define KEY_CONTEXT_VALID_G(x)  \\\n\t(((x) >> KEY_CONTEXT_VALID_S) & \\\n\t KEY_CONTEXT_VALID_M)\n#define KEY_CONTEXT_VALID_F     KEY_CONTEXT_VALID_V(1U)\n\n#define KEY_CONTEXT_CK_SIZE_S           6\n#define KEY_CONTEXT_CK_SIZE_M           0xf\n#define KEY_CONTEXT_CK_SIZE_V(x)        ((x) << KEY_CONTEXT_CK_SIZE_S)\n#define KEY_CONTEXT_CK_SIZE_G(x)        \\\n\t(((x) >> KEY_CONTEXT_CK_SIZE_S) & KEY_CONTEXT_CK_SIZE_M)\n\n#define KEY_CONTEXT_MK_SIZE_S           2\n#define KEY_CONTEXT_MK_SIZE_M           0xf\n#define KEY_CONTEXT_MK_SIZE_V(x)        ((x) << KEY_CONTEXT_MK_SIZE_S)\n#define KEY_CONTEXT_MK_SIZE_G(x)        \\\n\t(((x) >> KEY_CONTEXT_MK_SIZE_S) & KEY_CONTEXT_MK_SIZE_M)\n\n#define KEY_CONTEXT_OPAD_PRESENT_S      11\n#define KEY_CONTEXT_OPAD_PRESENT_M      0x1\n#define KEY_CONTEXT_OPAD_PRESENT_V(x)   ((x) << KEY_CONTEXT_OPAD_PRESENT_S)\n#define KEY_CONTEXT_OPAD_PRESENT_G(x)   \\\n\t(((x) >> KEY_CONTEXT_OPAD_PRESENT_S) & \\\n\t KEY_CONTEXT_OPAD_PRESENT_M)\n#define KEY_CONTEXT_OPAD_PRESENT_F      KEY_CONTEXT_OPAD_PRESENT_V(1U)\n\n#define CHCR_HASH_MAX_DIGEST_SIZE 64\n#define CHCR_MAX_SHA_DIGEST_SIZE 64\n\n#define IPSEC_TRUNCATED_ICV_SIZE 12\n#define TLS_TRUNCATED_HMAC_SIZE 10\n#define CBCMAC_DIGEST_SIZE 16\n#define MAX_HASH_NAME 20\n\n#define SHA1_INIT_STATE_5X4B    5\n#define SHA256_INIT_STATE_8X4B  8\n#define SHA512_INIT_STATE_8X8B  8\n#define SHA1_INIT_STATE         SHA1_INIT_STATE_5X4B\n#define SHA224_INIT_STATE       SHA256_INIT_STATE_8X4B\n#define SHA256_INIT_STATE       SHA256_INIT_STATE_8X4B\n#define SHA384_INIT_STATE       SHA512_INIT_STATE_8X8B\n#define SHA512_INIT_STATE       SHA512_INIT_STATE_8X8B\n\n#define DUMMY_BYTES 16\n\n#define IPAD_DATA 0x36363636\n#define OPAD_DATA 0x5c5c5c5c\n\n#define TRANSHDR_SIZE(kctx_len)\\\n\t(sizeof(struct chcr_wr) +\\\n\t kctx_len)\n#define CIPHER_TRANSHDR_SIZE(kctx_len, sge_pairs) \\\n\t(TRANSHDR_SIZE((kctx_len)) + (sge_pairs) +\\\n\t sizeof(struct cpl_rx_phys_dsgl) + AES_BLOCK_SIZE)\n#define HASH_TRANSHDR_SIZE(kctx_len)\\\n\t(TRANSHDR_SIZE(kctx_len) + DUMMY_BYTES)\n\n\n#define FILL_SEC_CPL_OP_IVINSR(id, len, ofst)      \\\n\thtonl( \\\n\t       CPL_TX_SEC_PDU_OPCODE_V(CPL_TX_SEC_PDU) | \\\n\t       CPL_TX_SEC_PDU_RXCHID_V((id)) | \\\n\t       CPL_TX_SEC_PDU_ACKFOLLOWS_V(0) | \\\n\t       CPL_TX_SEC_PDU_ULPTXLPBK_V(1) | \\\n\t       CPL_TX_SEC_PDU_CPLLEN_V((len)) | \\\n\t       CPL_TX_SEC_PDU_PLACEHOLDER_V(0) | \\\n\t       CPL_TX_SEC_PDU_IVINSRTOFST_V((ofst)))\n\n#define  FILL_SEC_CPL_CIPHERSTOP_HI(a_start, a_stop, c_start, c_stop_hi) \\\n\thtonl( \\\n\t       CPL_TX_SEC_PDU_AADSTART_V((a_start)) | \\\n\t       CPL_TX_SEC_PDU_AADSTOP_V((a_stop)) | \\\n\t       CPL_TX_SEC_PDU_CIPHERSTART_V((c_start)) | \\\n\t       CPL_TX_SEC_PDU_CIPHERSTOP_HI_V((c_stop_hi)))\n\n#define  FILL_SEC_CPL_AUTHINSERT(c_stop_lo, a_start, a_stop, a_inst) \\\n\thtonl( \\\n\t       CPL_TX_SEC_PDU_CIPHERSTOP_LO_V((c_stop_lo)) | \\\n\t\tCPL_TX_SEC_PDU_AUTHSTART_V((a_start)) | \\\n\t\tCPL_TX_SEC_PDU_AUTHSTOP_V((a_stop)) | \\\n\t\tCPL_TX_SEC_PDU_AUTHINSERT_V((a_inst)))\n\n#define  FILL_SEC_CPL_SCMD0_SEQNO(ctrl, seq, cmode, amode, opad, size)  \\\n\t\thtonl( \\\n\t\tSCMD_SEQ_NO_CTRL_V(0) | \\\n\t\tSCMD_STATUS_PRESENT_V(0) | \\\n\t\tSCMD_PROTO_VERSION_V(CHCR_SCMD_PROTO_VERSION_GENERIC) | \\\n\t\tSCMD_ENC_DEC_CTRL_V((ctrl)) | \\\n\t\tSCMD_CIPH_AUTH_SEQ_CTRL_V((seq)) | \\\n\t\tSCMD_CIPH_MODE_V((cmode)) | \\\n\t\tSCMD_AUTH_MODE_V((amode)) | \\\n\t\tSCMD_HMAC_CTRL_V((opad)) | \\\n\t\tSCMD_IV_SIZE_V((size)) | \\\n\t\tSCMD_NUM_IVS_V(0))\n\n#define FILL_SEC_CPL_IVGEN_HDRLEN(last, more, ctx_in, mac, ivdrop, len) htonl( \\\n\t\tSCMD_ENB_DBGID_V(0) | \\\n\t\tSCMD_IV_GEN_CTRL_V(0) | \\\n\t\tSCMD_LAST_FRAG_V((last)) | \\\n\t\tSCMD_MORE_FRAGS_V((more)) | \\\n\t\tSCMD_TLS_COMPPDU_V(0) | \\\n\t\tSCMD_KEY_CTX_INLINE_V((ctx_in)) | \\\n\t\tSCMD_TLS_FRAG_ENABLE_V(0) | \\\n\t\tSCMD_MAC_ONLY_V((mac)) |  \\\n\t\tSCMD_AADIVDROP_V((ivdrop)) | \\\n\t\tSCMD_HDR_LEN_V((len)))\n\n#define  FILL_KEY_CTX_HDR(ck_size, mk_size, d_ck, opad, ctx_len) \\\n\t\thtonl(KEY_CONTEXT_VALID_V(1) | \\\n\t\t      KEY_CONTEXT_CK_SIZE_V((ck_size)) | \\\n\t\t      KEY_CONTEXT_MK_SIZE_V(mk_size) | \\\n\t\t      KEY_CONTEXT_DUAL_CK_V((d_ck)) | \\\n\t\t      KEY_CONTEXT_OPAD_PRESENT_V((opad)) | \\\n\t\t      KEY_CONTEXT_SALT_PRESENT_V(1) | \\\n\t\t      KEY_CONTEXT_CTX_LEN_V((ctx_len)))\n\n#define  FILL_KEY_CRX_HDR(ck_size, mk_size, d_ck, opad, ctx_len) \\\n\t\thtonl(TLS_KEYCTX_RXMK_SIZE_V(mk_size) | \\\n\t\t      TLS_KEYCTX_RXCK_SIZE_V(ck_size) | \\\n\t\t      TLS_KEYCTX_RX_VALID_V(1) | \\\n\t\t      TLS_KEYCTX_RX_SEQCTR_V(3) | \\\n\t\t      TLS_KEYCTX_RXAUTH_MODE_V(4) | \\\n\t\t      TLS_KEYCTX_RXCIPH_MODE_V(2) | \\\n\t\t      TLS_KEYCTX_RXFLIT_CNT_V((ctx_len)))\n\n#define FILL_WR_OP_CCTX_SIZE \\\n\t\thtonl( \\\n\t\t\tFW_CRYPTO_LOOKASIDE_WR_OPCODE_V( \\\n\t\t\tFW_CRYPTO_LOOKASIDE_WR) | \\\n\t\t\tFW_CRYPTO_LOOKASIDE_WR_COMPL_V(0) | \\\n\t\t\tFW_CRYPTO_LOOKASIDE_WR_IMM_LEN_V((0)) | \\\n\t\t\tFW_CRYPTO_LOOKASIDE_WR_CCTX_LOC_V(0) | \\\n\t\t\tFW_CRYPTO_LOOKASIDE_WR_CCTX_SIZE_V(0))\n\n#define FILL_WR_RX_Q_ID(cid, qid, lcb, fid) \\\n\t\thtonl( \\\n\t\t\tFW_CRYPTO_LOOKASIDE_WR_RX_CHID_V((cid)) | \\\n\t\t\tFW_CRYPTO_LOOKASIDE_WR_RX_Q_ID_V((qid)) | \\\n\t\t\tFW_CRYPTO_LOOKASIDE_WR_LCB_V((lcb)) | \\\n\t\t\tFW_CRYPTO_LOOKASIDE_WR_IV_V((IV_NOP)) | \\\n\t\t\tFW_CRYPTO_LOOKASIDE_WR_FQIDX_V(fid))\n\n#define FILL_ULPTX_CMD_DEST(cid, qid) \\\n\thtonl(ULPTX_CMD_V(ULP_TX_PKT) | \\\n\t      ULP_TXPKT_DEST_V(0) | \\\n\t      ULP_TXPKT_DATAMODIFY_V(0) | \\\n\t      ULP_TXPKT_CHANNELID_V((cid)) | \\\n\t      ULP_TXPKT_RO_V(1) | \\\n\t      ULP_TXPKT_FID_V(qid))\n\n#define KEYCTX_ALIGN_PAD(bs) ({unsigned int _bs = (bs);\\\n\t\t\t      _bs == SHA1_DIGEST_SIZE ? 12 : 0; })\n\n#define FILL_PLD_SIZE_HASH_SIZE(payload_sgl_len, sgl_lengths, total_frags) \\\n\thtonl(FW_CRYPTO_LOOKASIDE_WR_PLD_SIZE_V(payload_sgl_len ? \\\n\t\t\t\t\t\tsgl_lengths[total_frags] : 0) |\\\n\t      FW_CRYPTO_LOOKASIDE_WR_HASH_SIZE_V(0))\n\n#define FILL_LEN_PKD(calc_tx_flits_ofld, skb) \\\n\thtonl(FW_CRYPTO_LOOKASIDE_WR_LEN16_V(DIV_ROUND_UP((\\\n\t\t\t\t\t   calc_tx_flits_ofld(skb) * 8), 16)))\n\n#define FILL_CMD_MORE(immdatalen) htonl(ULPTX_CMD_V(ULP_TX_SC_IMM) |\\\n\t\t\t\t\tULP_TX_SC_MORE_V((immdatalen)))\n#define MAX_NK 8\n#define MAX_DSGL_ENT\t\t\t32\n#define MIN_AUTH_SG\t\t\t1  \n#define MIN_GCM_SG\t\t\t1  \n#define MIN_DIGEST_SG\t\t\t1  \n#define MIN_CCM_SG\t\t\t1  \n#define CIP_SPACE_LEFT(len) \\\n\t((SGE_MAX_WR_LEN - CIP_WR_MIN_LEN - (len)))\n#define HASH_SPACE_LEFT(len) \\\n\t((SGE_MAX_WR_LEN - HASH_WR_MIN_LEN - (len)))\n\nstruct algo_param {\n\tunsigned int auth_mode;\n\tunsigned int mk_size;\n\tunsigned int result_size;\n};\n\nstruct hash_wr_param {\n\tstruct algo_param alg_prm;\n\tunsigned int opad_needed;\n\tunsigned int more;\n\tunsigned int last;\n\tunsigned int kctx_len;\n\tunsigned int sg_len;\n\tunsigned int bfr_len;\n\tunsigned int hash_size;\n\tu64 scmd1;\n};\n\nstruct cipher_wr_param {\n\tstruct skcipher_request *req;\n\tchar *iv;\n\tint bytes;\n\tunsigned short qid;\n};\nenum {\n\tAES_KEYLENGTH_128BIT = 128,\n\tAES_KEYLENGTH_192BIT = 192,\n\tAES_KEYLENGTH_256BIT = 256\n};\n\nenum {\n\tKEYLENGTH_3BYTES = 3,\n\tKEYLENGTH_4BYTES = 4,\n\tKEYLENGTH_6BYTES = 6,\n\tKEYLENGTH_8BYTES = 8\n};\n\nenum {\n\tNUMBER_OF_ROUNDS_10 = 10,\n\tNUMBER_OF_ROUNDS_12 = 12,\n\tNUMBER_OF_ROUNDS_14 = 14,\n};\n\n \nenum {\n\tICV_4  = 4,\n\tICV_6  = 6,\n\tICV_8  = 8,\n\tICV_10 = 10,\n\tICV_12 = 12,\n\tICV_13 = 13,\n\tICV_14 = 14,\n\tICV_15 = 15,\n\tICV_16 = 16\n};\n\nstruct phys_sge_pairs {\n\t__be16 len[8];\n\t__be64 addr[8];\n};\n\n\nstatic const u32 chcr_sha1_init[SHA1_DIGEST_SIZE / 4] = {\n\t\tSHA1_H0, SHA1_H1, SHA1_H2, SHA1_H3, SHA1_H4,\n};\n\nstatic const u32 chcr_sha224_init[SHA256_DIGEST_SIZE / 4] = {\n\t\tSHA224_H0, SHA224_H1, SHA224_H2, SHA224_H3,\n\t\tSHA224_H4, SHA224_H5, SHA224_H6, SHA224_H7,\n};\n\nstatic const u32 chcr_sha256_init[SHA256_DIGEST_SIZE / 4] = {\n\t\tSHA256_H0, SHA256_H1, SHA256_H2, SHA256_H3,\n\t\tSHA256_H4, SHA256_H5, SHA256_H6, SHA256_H7,\n};\n\nstatic const u64 chcr_sha384_init[SHA512_DIGEST_SIZE / 8] = {\n\t\tSHA384_H0, SHA384_H1, SHA384_H2, SHA384_H3,\n\t\tSHA384_H4, SHA384_H5, SHA384_H6, SHA384_H7,\n};\n\nstatic const u64 chcr_sha512_init[SHA512_DIGEST_SIZE / 8] = {\n\t\tSHA512_H0, SHA512_H1, SHA512_H2, SHA512_H3,\n\t\tSHA512_H4, SHA512_H5, SHA512_H6, SHA512_H7,\n};\n\nstatic inline void copy_hash_init_values(char *key, int digestsize)\n{\n\tu8 i;\n\t__be32 *dkey = (__be32 *)key;\n\tu64 *ldkey = (u64 *)key;\n\t__be64 *sha384 = (__be64 *)chcr_sha384_init;\n\t__be64 *sha512 = (__be64 *)chcr_sha512_init;\n\n\tswitch (digestsize) {\n\tcase SHA1_DIGEST_SIZE:\n\t\tfor (i = 0; i < SHA1_INIT_STATE; i++)\n\t\t\tdkey[i] = cpu_to_be32(chcr_sha1_init[i]);\n\t\tbreak;\n\tcase SHA224_DIGEST_SIZE:\n\t\tfor (i = 0; i < SHA224_INIT_STATE; i++)\n\t\t\tdkey[i] = cpu_to_be32(chcr_sha224_init[i]);\n\t\tbreak;\n\tcase SHA256_DIGEST_SIZE:\n\t\tfor (i = 0; i < SHA256_INIT_STATE; i++)\n\t\t\tdkey[i] = cpu_to_be32(chcr_sha256_init[i]);\n\t\tbreak;\n\tcase SHA384_DIGEST_SIZE:\n\t\tfor (i = 0; i < SHA384_INIT_STATE; i++)\n\t\t\tldkey[i] = be64_to_cpu(sha384[i]);\n\t\tbreak;\n\tcase SHA512_DIGEST_SIZE:\n\t\tfor (i = 0; i < SHA512_INIT_STATE; i++)\n\t\t\tldkey[i] = be64_to_cpu(sha512[i]);\n\t\tbreak;\n\t}\n}\n\n \n#define PHYSDSGL_MAX_LEN_SIZE 16\n\nstatic inline u16 get_space_for_phys_dsgl(unsigned int sgl_entr)\n{\n\t \n\treturn ((sgl_entr >> 3) + ((sgl_entr % 8) ?\n\t\t\t\t   1 : 0)) * PHYSDSGL_MAX_LEN_SIZE +\n\t\t(sgl_entr << 3) + ((sgl_entr % 2 ? 1 : 0) << 3);\n}\n\n \nstatic const u8 aes_sbox[256] = {\n\t99,  124, 119, 123, 242, 107, 111, 197, 48,  1,   103, 43,  254, 215,\n\t171, 118, 202, 130, 201, 125, 250, 89,  71,  240, 173, 212, 162, 175,\n\t156, 164, 114, 192, 183, 253, 147, 38,  54,  63,  247, 204, 52,  165,\n\t229, 241, 113, 216, 49,  21, 4,   199, 35,  195, 24,  150, 5, 154, 7,\n\t18,  128, 226, 235, 39,  178, 117, 9,   131, 44,  26,  27,  110, 90,\n\t160, 82,  59,  214, 179, 41,  227, 47,  132, 83,  209, 0,   237, 32,\n\t252, 177, 91,  106, 203, 190, 57,  74,  76,  88,  207, 208, 239, 170,\n\t251, 67,  77,  51,  133, 69,  249, 2,   127, 80,  60,  159, 168, 81,\n\t163, 64,  143, 146, 157, 56,  245, 188, 182, 218, 33,  16,  255, 243,\n\t210, 205, 12,  19,  236, 95,  151, 68,  23,  196, 167, 126, 61,  100,\n\t93,  25,  115, 96,  129, 79,  220, 34,  42,  144, 136, 70,  238, 184,\n\t20,  222, 94,  11,  219, 224, 50,  58,  10,  73,  6,   36,  92,  194,\n\t211, 172, 98,  145, 149, 228, 121, 231, 200, 55,  109, 141, 213, 78,\n\t169, 108, 86,  244, 234, 101, 122, 174, 8, 186, 120, 37,  46,  28, 166,\n\t180, 198, 232, 221, 116, 31,  75,  189, 139, 138, 112, 62,  181, 102,\n\t72,  3,   246, 14,  97,  53,  87,  185, 134, 193, 29,  158, 225, 248,\n\t152, 17,  105, 217, 142, 148, 155, 30,  135, 233, 206, 85,  40,  223,\n\t140, 161, 137, 13,  191, 230, 66,  104, 65,  153, 45,  15,  176, 84,\n\t187, 22\n};\n\nstatic inline u32 aes_ks_subword(const u32 w)\n{\n\tu8 bytes[4];\n\n\t*(u32 *)(&bytes[0]) = w;\n\tbytes[0] = aes_sbox[bytes[0]];\n\tbytes[1] = aes_sbox[bytes[1]];\n\tbytes[2] = aes_sbox[bytes[2]];\n\tbytes[3] = aes_sbox[bytes[3]];\n\treturn *(u32 *)(&bytes[0]);\n}\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}