{
  "module_name": "chcr_core.h",
  "hash_id": "506cf4037bb1eb49d626d0f64c4975f836531e3cdae21d33849daed899394dc7",
  "original_prompt": "Ingested from linux-6.6.14/drivers/crypto/chelsio/chcr_core.h",
  "human_readable_source": " \n\n#ifndef __CHCR_CORE_H__\n#define __CHCR_CORE_H__\n\n#include <crypto/algapi.h>\n#include <net/tls.h>\n#include \"t4_hw.h\"\n#include \"cxgb4.h\"\n#include \"t4_msg.h\"\n#include \"cxgb4_uld.h\"\n\n#define DRV_MODULE_NAME \"chcr\"\n#define DRV_DESC \"Chelsio T6 Crypto Co-processor Driver\"\n\n#define MAX_PENDING_REQ_TO_HW 20\n#define CHCR_TEST_RESPONSE_TIMEOUT 1000\n#define WQ_DETACH_TM\t(msecs_to_jiffies(50))\n#define PAD_ERROR_BIT\t\t1\n#define CHK_PAD_ERR_BIT(x)\t(((x) >> PAD_ERROR_BIT) & 1)\n\n#define MAC_ERROR_BIT\t\t0\n#define CHK_MAC_ERR_BIT(x)\t(((x) >> MAC_ERROR_BIT) & 1)\n#define MAX_SALT                4\n#define CIP_WR_MIN_LEN (sizeof(struct chcr_wr) + \\\n\t\t    sizeof(struct cpl_rx_phys_dsgl) + \\\n\t\t    sizeof(struct ulptx_sgl) + 16) \n\n#define HASH_WR_MIN_LEN (sizeof(struct chcr_wr) + \\\n\t\t\tDUMMY_BYTES + \\\n\t\t    sizeof(struct ulptx_sgl))\nstruct uld_ctx;\n\nstruct _key_ctx {\n\t__be32 ctx_hdr;\n\tu8 salt[MAX_SALT];\n\t__be64 iv_to_auth;\n\tunsigned char key[];\n};\n\n#define WQ_RETRY\t5\nstruct chcr_driver_data {\n\tstruct list_head act_dev;\n\tstruct list_head inact_dev;\n\tatomic_t dev_count;\n\tstruct mutex drv_mutex;\n\tstruct uld_ctx *last_dev;\n};\n\nenum chcr_state {\n\tCHCR_INIT = 0,\n\tCHCR_ATTACH,\n\tCHCR_DETACH,\n};\nstruct chcr_wr {\n\tstruct fw_crypto_lookaside_wr wreq;\n\tstruct ulp_txpkt ulptx;\n\tstruct ulptx_idata sc_imm;\n\tstruct cpl_tx_sec_pdu sec_cpl;\n\tstruct _key_ctx key_ctx;\n};\n\nstruct chcr_dev {\n\tspinlock_t lock_chcr_dev;\n\tenum chcr_state state;\n\tatomic_t inflight;\n\tint wqretry;\n\tstruct delayed_work detach_work;\n\tstruct completion detach_comp;\n};\n\nstruct uld_ctx {\n\tstruct list_head entry;\n\tstruct cxgb4_lld_info lldi;\n\tstruct chcr_dev dev;\n};\n\n \nstatic inline unsigned int sgl_len(unsigned int n)\n{\n\tn--;\n\treturn (3 * n) / 2 + (n & 1) + 2;\n}\n\nstatic inline void *padap(struct chcr_dev *dev)\n{\n\tstruct uld_ctx *u_ctx = container_of(dev, struct uld_ctx, dev);\n\n\treturn pci_get_drvdata(u_ctx->lldi.pdev);\n}\n\nstruct uld_ctx *assign_chcr_device(void);\nint chcr_send_wr(struct sk_buff *skb);\nint start_crypto(void);\nint stop_crypto(void);\nint chcr_uld_rx_handler(void *handle, const __be64 *rsp,\n\t\t\tconst struct pkt_gl *pgl);\nint chcr_handle_resp(struct crypto_async_request *req, unsigned char *input,\n\t\t     int err);\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}