{
  "module_name": "sp-dev.h",
  "hash_id": "a35fcbbc354bd02bb941c899ccae95f09d2a55da59eb8b0c461efa6f29328b4c",
  "original_prompt": "Ingested from linux-6.6.14/drivers/crypto/ccp/sp-dev.h",
  "human_readable_source": " \n \n\n#ifndef __SP_DEV_H__\n#define __SP_DEV_H__\n\n#include <linux/device.h>\n#include <linux/spinlock.h>\n#include <linux/mutex.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/dmapool.h>\n#include <linux/hw_random.h>\n#include <linux/bitops.h>\n#include <linux/interrupt.h>\n#include <linux/irqreturn.h>\n\n#define SP_MAX_NAME_LEN\t\t32\n\n#define CACHE_NONE\t\t\t0x00\n#define CACHE_WB_NO_ALLOC\t\t0xb7\n\n#define PLATFORM_FEATURE_DBC\t\t0x1\n\n#define PSP_FEATURE(psp, feat)\t(psp->vdata && psp->vdata->platform_features & PLATFORM_FEATURE_##feat)\n\n \nstruct ccp_device;\nstruct ccp_vdata {\n\tconst unsigned int version;\n\tconst unsigned int dma_chan_attr;\n\tvoid (*setup)(struct ccp_device *);\n\tconst struct ccp_actions *perform;\n\tconst unsigned int offset;\n\tconst unsigned int rsamax;\n};\n\nstruct sev_vdata {\n\tconst unsigned int cmdresp_reg;\n\tconst unsigned int cmdbuff_addr_lo_reg;\n\tconst unsigned int cmdbuff_addr_hi_reg;\n};\n\nstruct tee_vdata {\n\tconst unsigned int cmdresp_reg;\n\tconst unsigned int cmdbuff_addr_lo_reg;\n\tconst unsigned int cmdbuff_addr_hi_reg;\n\tconst unsigned int ring_wptr_reg;\n\tconst unsigned int ring_rptr_reg;\n\tconst unsigned int info_reg;\n};\n\nstruct platform_access_vdata {\n\tconst unsigned int cmdresp_reg;\n\tconst unsigned int cmdbuff_addr_lo_reg;\n\tconst unsigned int cmdbuff_addr_hi_reg;\n\tconst unsigned int doorbell_button_reg;\n\tconst unsigned int doorbell_cmd_reg;\n\n};\n\nstruct psp_vdata {\n\tconst struct sev_vdata *sev;\n\tconst struct tee_vdata *tee;\n\tconst struct platform_access_vdata *platform_access;\n\tconst unsigned int feature_reg;\n\tconst unsigned int inten_reg;\n\tconst unsigned int intsts_reg;\n\tconst unsigned int bootloader_info_reg;\n\tconst unsigned int platform_features;\n};\n\n \nstruct sp_dev_vdata {\n\tconst unsigned int bar;\n\n\tconst struct ccp_vdata *ccp_vdata;\n\tconst struct psp_vdata *psp_vdata;\n};\n\nstruct sp_device {\n\tstruct list_head entry;\n\n\tstruct device *dev;\n\n\tstruct sp_dev_vdata *dev_vdata;\n\tunsigned int ord;\n\tchar name[SP_MAX_NAME_LEN];\n\n\t \n\tvoid *dev_specific;\n\n\t \n\tvoid __iomem *io_map;\n\n\t \n\tunsigned int axcache;\n\n\t \n\tstruct sp_device*(*get_psp_master_device)(void);\n\tvoid (*set_psp_master_device)(struct sp_device *);\n\tvoid (*clear_psp_master_device)(struct sp_device *);\n\n\tbool irq_registered;\n\tbool use_tasklet;\n\n\tunsigned int ccp_irq;\n\tirq_handler_t ccp_irq_handler;\n\tvoid *ccp_irq_data;\n\n\tunsigned int psp_irq;\n\tirq_handler_t psp_irq_handler;\n\tvoid *psp_irq_data;\n\n\tvoid *ccp_data;\n\tvoid *psp_data;\n};\n\nint sp_pci_init(void);\nvoid sp_pci_exit(void);\n\nint sp_platform_init(void);\nvoid sp_platform_exit(void);\n\nstruct sp_device *sp_alloc_struct(struct device *dev);\n\nint sp_init(struct sp_device *sp);\nvoid sp_destroy(struct sp_device *sp);\nstruct sp_device *sp_get_master(void);\n\nint sp_suspend(struct sp_device *sp);\nint sp_resume(struct sp_device *sp);\nint sp_request_ccp_irq(struct sp_device *sp, irq_handler_t handler,\n\t\t       const char *name, void *data);\nvoid sp_free_ccp_irq(struct sp_device *sp, void *data);\nint sp_request_psp_irq(struct sp_device *sp, irq_handler_t handler,\n\t\t       const char *name, void *data);\nvoid sp_free_psp_irq(struct sp_device *sp, void *data);\nstruct sp_device *sp_get_psp_master_device(void);\n\n#ifdef CONFIG_CRYPTO_DEV_SP_CCP\n\nint ccp_dev_init(struct sp_device *sp);\nvoid ccp_dev_destroy(struct sp_device *sp);\n\nvoid ccp_dev_suspend(struct sp_device *sp);\nvoid ccp_dev_resume(struct sp_device *sp);\n\n#else\t \n\nstatic inline int ccp_dev_init(struct sp_device *sp)\n{\n\treturn 0;\n}\nstatic inline void ccp_dev_destroy(struct sp_device *sp) { }\nstatic inline void ccp_dev_suspend(struct sp_device *sp) { }\nstatic inline void ccp_dev_resume(struct sp_device *sp) { }\n#endif\t \n\n#ifdef CONFIG_CRYPTO_DEV_SP_PSP\n\nint psp_dev_init(struct sp_device *sp);\nvoid psp_pci_init(void);\nvoid psp_dev_destroy(struct sp_device *sp);\nvoid psp_pci_exit(void);\n\n#else  \n\nstatic inline int psp_dev_init(struct sp_device *sp) { return 0; }\nstatic inline void psp_pci_init(void) { }\nstatic inline void psp_dev_destroy(struct sp_device *sp) { }\nstatic inline void psp_pci_exit(void) { }\n\n#endif  \n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}