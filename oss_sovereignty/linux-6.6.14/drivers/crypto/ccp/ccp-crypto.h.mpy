{
  "module_name": "ccp-crypto.h",
  "hash_id": "22de9f1472eab6b0af48181a567b33cf84493a99ab7fcbb5eb033acd22e1f8c0",
  "original_prompt": "Ingested from linux-6.6.14/drivers/crypto/ccp/ccp-crypto.h",
  "human_readable_source": " \n \n\n#ifndef __CCP_CRYPTO_H__\n#define __CCP_CRYPTO_H__\n\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/ccp.h>\n#include <crypto/algapi.h>\n#include <crypto/aes.h>\n#include <crypto/internal/aead.h>\n#include <crypto/aead.h>\n#include <crypto/ctr.h>\n#include <crypto/hash.h>\n#include <crypto/sha1.h>\n#include <crypto/sha2.h>\n#include <crypto/akcipher.h>\n#include <crypto/skcipher.h>\n#include <crypto/internal/rsa.h>\n\n \n#undef pr_fmt\n#define\tpr_fmt(fmt)\tKBUILD_MODNAME \": \" fmt\n\n#define\tCCP_LOG_LEVEL\tKERN_INFO\n\n#define CCP_CRA_PRIORITY\t300\n\nstruct ccp_crypto_skcipher_alg {\n\tstruct list_head entry;\n\n\tu32 mode;\n\n\tstruct skcipher_alg alg;\n};\n\nstruct ccp_crypto_aead {\n\tstruct list_head entry;\n\n\tu32 mode;\n\n\tstruct aead_alg alg;\n};\n\nstruct ccp_crypto_ahash_alg {\n\tstruct list_head entry;\n\n\tconst __be32 *init;\n\tu32 type;\n\tu32 mode;\n\n\t \n\tchar child_alg[CRYPTO_MAX_ALG_NAME];\n\n\tstruct ahash_alg alg;\n};\n\nstruct ccp_crypto_akcipher_alg {\n\tstruct list_head entry;\n\n\tstruct akcipher_alg alg;\n};\n\nstatic inline struct ccp_crypto_skcipher_alg *\n\tccp_crypto_skcipher_alg(struct crypto_skcipher *tfm)\n{\n\tstruct skcipher_alg *alg = crypto_skcipher_alg(tfm);\n\n\treturn container_of(alg, struct ccp_crypto_skcipher_alg, alg);\n}\n\nstatic inline struct ccp_crypto_ahash_alg *\n\tccp_crypto_ahash_alg(struct crypto_tfm *tfm)\n{\n\tstruct crypto_alg *alg = tfm->__crt_alg;\n\tstruct ahash_alg *ahash_alg;\n\n\tahash_alg = container_of(alg, struct ahash_alg, halg.base);\n\n\treturn container_of(ahash_alg, struct ccp_crypto_ahash_alg, alg);\n}\n\n \nstruct ccp_aes_ctx {\n\t \n\tstruct crypto_skcipher *tfm_skcipher;\n\n\tenum ccp_engine engine;\n\tenum ccp_aes_type type;\n\tenum ccp_aes_mode mode;\n\n\tstruct scatterlist key_sg;\n\tunsigned int key_len;\n\tu8 key[AES_MAX_KEY_SIZE * 2];\n\n\tu8 nonce[CTR_RFC3686_NONCE_SIZE];\n\n\t \n\tstruct scatterlist k1_sg;\n\tstruct scatterlist k2_sg;\n\tunsigned int kn_len;\n\tu8 k1[AES_BLOCK_SIZE];\n\tu8 k2[AES_BLOCK_SIZE];\n};\n\nstruct ccp_aes_req_ctx {\n\tstruct scatterlist iv_sg;\n\tu8 iv[AES_BLOCK_SIZE];\n\n\tstruct scatterlist tag_sg;\n\tu8 tag[AES_BLOCK_SIZE];\n\n\t \n\tu8 *rfc3686_info;\n\tu8 rfc3686_iv[AES_BLOCK_SIZE];\n\n\tstruct ccp_cmd cmd;\n\n\tstruct skcipher_request fallback_req;\t\n};\n\nstruct ccp_aes_cmac_req_ctx {\n\tunsigned int null_msg;\n\tunsigned int final;\n\n\tstruct scatterlist *src;\n\tunsigned int nbytes;\n\n\tu64 hash_cnt;\n\tunsigned int hash_rem;\n\n\tstruct sg_table data_sg;\n\n\tstruct scatterlist iv_sg;\n\tu8 iv[AES_BLOCK_SIZE];\n\n\tstruct scatterlist buf_sg;\n\tunsigned int buf_count;\n\tu8 buf[AES_BLOCK_SIZE];\n\n\tstruct scatterlist pad_sg;\n\tunsigned int pad_count;\n\tu8 pad[AES_BLOCK_SIZE];\n\n\tstruct ccp_cmd cmd;\n};\n\nstruct ccp_aes_cmac_exp_ctx {\n\tunsigned int null_msg;\n\n\tu8 iv[AES_BLOCK_SIZE];\n\n\tunsigned int buf_count;\n\tu8 buf[AES_BLOCK_SIZE];\n};\n\n \nstruct ccp_des3_ctx {\n\tenum ccp_engine engine;\n\tenum ccp_des3_type type;\n\tenum ccp_des3_mode mode;\n\n\tstruct scatterlist key_sg;\n\tunsigned int key_len;\n\tu8 key[AES_MAX_KEY_SIZE];\n};\n\nstruct ccp_des3_req_ctx {\n\tstruct scatterlist iv_sg;\n\tu8 iv[AES_BLOCK_SIZE];\n\n\tstruct ccp_cmd cmd;\n};\n\n \n#define MAX_SHA_CONTEXT_SIZE\tSHA512_DIGEST_SIZE\n#define MAX_SHA_BLOCK_SIZE\tSHA512_BLOCK_SIZE\n\nstruct ccp_sha_ctx {\n\tstruct scatterlist opad_sg;\n\tunsigned int opad_count;\n\n\tunsigned int key_len;\n\tu8 key[MAX_SHA_BLOCK_SIZE];\n\tu8 ipad[MAX_SHA_BLOCK_SIZE];\n\tu8 opad[MAX_SHA_BLOCK_SIZE];\n\tstruct crypto_shash *hmac_tfm;\n};\n\nstruct ccp_sha_req_ctx {\n\tenum ccp_sha_type type;\n\n\tu64 msg_bits;\n\n\tunsigned int first;\n\tunsigned int final;\n\n\tstruct scatterlist *src;\n\tunsigned int nbytes;\n\n\tu64 hash_cnt;\n\tunsigned int hash_rem;\n\n\tstruct sg_table data_sg;\n\n\tstruct scatterlist ctx_sg;\n\tu8 ctx[MAX_SHA_CONTEXT_SIZE];\n\n\tstruct scatterlist buf_sg;\n\tunsigned int buf_count;\n\tu8 buf[MAX_SHA_BLOCK_SIZE];\n\n\t \n\tstruct ccp_cmd cmd;\n};\n\nstruct ccp_sha_exp_ctx {\n\tenum ccp_sha_type type;\n\n\tu64 msg_bits;\n\n\tunsigned int first;\n\n\tu8 ctx[MAX_SHA_CONTEXT_SIZE];\n\n\tunsigned int buf_count;\n\tu8 buf[MAX_SHA_BLOCK_SIZE];\n};\n\n \n\nstruct ccp_rsa_ctx {\n\tunsigned int key_len;  \n\tstruct scatterlist e_sg;\n\tu8 *e_buf;\n\tunsigned int e_len;\n\tstruct scatterlist n_sg;\n\tu8 *n_buf;\n\tunsigned int n_len;\n\tstruct scatterlist d_sg;\n\tu8 *d_buf;\n\tunsigned int d_len;\n};\n\nstruct ccp_rsa_req_ctx {\n\tstruct ccp_cmd cmd;\n};\n\n#define\tCCP_RSA_MAXMOD\t(4 * 1024 / 8)\n#define\tCCP5_RSA_MAXMOD\t(16 * 1024 / 8)\n\n \nstruct ccp_ctx {\n\tint (*complete)(struct crypto_async_request *req, int ret);\n\n\tunion {\n\t\tstruct ccp_aes_ctx aes;\n\t\tstruct ccp_rsa_ctx rsa;\n\t\tstruct ccp_sha_ctx sha;\n\t\tstruct ccp_des3_ctx des3;\n\t} u;\n};\n\nint ccp_crypto_enqueue_request(struct crypto_async_request *req,\n\t\t\t       struct ccp_cmd *cmd);\nstruct scatterlist *ccp_crypto_sg_table_add(struct sg_table *table,\n\t\t\t\t\t    struct scatterlist *sg_add);\n\nint ccp_register_aes_algs(struct list_head *head);\nint ccp_register_aes_cmac_algs(struct list_head *head);\nint ccp_register_aes_xts_algs(struct list_head *head);\nint ccp_register_aes_aeads(struct list_head *head);\nint ccp_register_sha_algs(struct list_head *head);\nint ccp_register_des3_algs(struct list_head *head);\nint ccp_register_rsa_algs(struct list_head *head);\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}