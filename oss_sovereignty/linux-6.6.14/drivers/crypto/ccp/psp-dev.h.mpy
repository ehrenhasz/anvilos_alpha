{
  "module_name": "psp-dev.h",
  "hash_id": "672274ad055b84fc38ac00f9bd570ca328c2658aa969b072fad8214b33d1ec8e",
  "original_prompt": "Ingested from linux-6.6.14/drivers/crypto/ccp/psp-dev.h",
  "human_readable_source": " \n \n\n#ifndef __PSP_DEV_H__\n#define __PSP_DEV_H__\n\n#include <linux/device.h>\n#include <linux/list.h>\n#include <linux/bits.h>\n#include <linux/interrupt.h>\n\n#include \"sp-dev.h\"\n\n#define MAX_PSP_NAME_LEN\t\t16\n\nextern struct psp_device *psp_master;\n\ntypedef void (*psp_irq_handler_t)(int, void *, unsigned int);\n\nstruct psp_device {\n\tstruct list_head entry;\n\n\tstruct psp_vdata *vdata;\n\tchar name[MAX_PSP_NAME_LEN];\n\n\tstruct device *dev;\n\tstruct sp_device *sp;\n\n\tvoid __iomem *io_regs;\n\n\tpsp_irq_handler_t sev_irq_handler;\n\tvoid *sev_irq_data;\n\n\tvoid *sev_data;\n\tvoid *tee_data;\n\tvoid *platform_access_data;\n\tvoid *dbc_data;\n\n\tunsigned int capability;\n};\n\nvoid psp_set_sev_irq_handler(struct psp_device *psp, psp_irq_handler_t handler,\n\t\t\t     void *data);\nvoid psp_clear_sev_irq_handler(struct psp_device *psp);\n\nstruct psp_device *psp_get_master_device(void);\n\n#define PSP_CAPABILITY_SEV\t\t\tBIT(0)\n#define PSP_CAPABILITY_TEE\t\t\tBIT(1)\n#define PSP_CAPABILITY_PSP_SECURITY_REPORTING\tBIT(7)\n\n#define PSP_CAPABILITY_PSP_SECURITY_OFFSET\t8\n \n#define PSP_SECURITY_FUSED_PART\t\t\tBIT(0)\n#define PSP_SECURITY_DEBUG_LOCK_ON\t\tBIT(2)\n#define PSP_SECURITY_TSME_STATUS\t\tBIT(5)\n#define PSP_SECURITY_ANTI_ROLLBACK_STATUS\tBIT(7)\n#define PSP_SECURITY_RPMC_PRODUCTION_ENABLED\tBIT(8)\n#define PSP_SECURITY_RPMC_SPIROM_AVAILABLE\tBIT(9)\n#define PSP_SECURITY_HSP_TPM_AVAILABLE\t\tBIT(10)\n#define PSP_SECURITY_ROM_ARMOR_ENFORCED\t\tBIT(11)\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}