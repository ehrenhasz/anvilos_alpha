{
  "module_name": "nitrox_dev.h",
  "hash_id": "6d73536fdc1485bf17c728d15ffb76b82a633c08c91ef31f513ab3d15ecd1ba1",
  "original_prompt": "Ingested from linux-6.6.14/drivers/crypto/cavium/nitrox/nitrox_dev.h",
  "human_readable_source": " \n#ifndef __NITROX_DEV_H\n#define __NITROX_DEV_H\n\n#include <linux/dma-mapping.h>\n#include <linux/interrupt.h>\n#include <linux/pci.h>\n#include <linux/if.h>\n\n#define VERSION_LEN 32\n \n#define MAX_PF_QUEUES\t64\n \n#define MAX_DEV_QUEUES (MAX_PF_QUEUES)\n \n#define CNN55XX_MAX_UCD_BLOCKS\t8\n\n \nstruct nitrox_cmdq {\n\tspinlock_t cmd_qlock;\n\tspinlock_t resp_qlock;\n\tspinlock_t backlog_qlock;\n\n\tstruct nitrox_device *ndev;\n\tstruct list_head response_head;\n\tstruct list_head backlog_head;\n\n\tu8 __iomem *dbell_csr_addr;\n\tu8 __iomem *compl_cnt_csr_addr;\n\tu8 *base;\n\tdma_addr_t dma;\n\n\tstruct work_struct backlog_qflush;\n\n\tatomic_t pending_count;\n\tatomic_t backlog_count;\n\n\tint write_idx;\n\tu8 instr_size;\n\tu8 qno;\n\tu32 qsize;\n\n\tu8 *unalign_base;\n\tdma_addr_t unalign_dma;\n};\n\n \nstruct nitrox_hw {\n\tchar partname[IFNAMSIZ * 2];\n\tchar fw_name[CNN55XX_MAX_UCD_BLOCKS][VERSION_LEN];\n\n\tint freq;\n\tu16 vendor_id;\n\tu16 device_id;\n\tu8 revision_id;\n\n\tu8 se_cores;\n\tu8 ae_cores;\n\tu8 zip_cores;\n};\n\nstruct nitrox_stats {\n\tatomic64_t posted;\n\tatomic64_t completed;\n\tatomic64_t dropped;\n};\n\n#define IRQ_NAMESZ\t32\n\nstruct nitrox_q_vector {\n\tchar name[IRQ_NAMESZ];\n\tbool valid;\n\tint ring;\n\tstruct tasklet_struct resp_tasklet;\n\tunion {\n\t\tstruct nitrox_cmdq *cmdq;\n\t\tstruct nitrox_device *ndev;\n\t};\n};\n\nenum mcode_type {\n\tMCODE_TYPE_INVALID,\n\tMCODE_TYPE_AE,\n\tMCODE_TYPE_SE_SSL,\n\tMCODE_TYPE_SE_IPSEC,\n};\n\n \nunion mbox_msg {\n\tu64 value;\n\tstruct {\n\t\tu64 type: 2;\n\t\tu64 opcode: 6;\n\t\tu64 data: 58;\n\t};\n\tstruct {\n\t\tu64 type: 2;\n\t\tu64 opcode: 6;\n\t\tu64 chipid: 8;\n\t\tu64 vfid: 8;\n\t} id;\n\tstruct {\n\t\tu64 type: 2;\n\t\tu64 opcode: 6;\n\t\tu64 count: 4;\n\t\tu64 info: 40;\n\t\tu64 next_se_grp: 3;\n\t\tu64 next_ae_grp: 3;\n\t} mcode_info;\n};\n\n \nstruct nitrox_vfdev {\n\tatomic_t state;\n\tint vfno;\n\tint nr_queues;\n\tint ring;\n\tunion mbox_msg msg;\n\tatomic64_t mbx_resp;\n};\n\n \nstruct nitrox_iov {\n\tint num_vfs;\n\tint max_vf_queues;\n\tstruct nitrox_vfdev *vfdev;\n\tstruct workqueue_struct *pf2vf_wq;\n\tstruct msix_entry msix;\n};\n\n \nenum ndev_state {\n\t__NDEV_NOT_READY,\n\t__NDEV_READY,\n\t__NDEV_IN_RESET,\n};\n\n \nenum vf_mode {\n\t__NDEV_MODE_PF,\n\t__NDEV_MODE_VF16,\n\t__NDEV_MODE_VF32,\n\t__NDEV_MODE_VF64,\n\t__NDEV_MODE_VF128,\n};\n\n#define __NDEV_SRIOV_BIT 0\n\n \n#define DEFAULT_CMD_QLEN 2048\n \n#define CMD_TIMEOUT 2000\n\n#define DEV(ndev) ((struct device *)(&(ndev)->pdev->dev))\n\n#define NITROX_CSR_ADDR(ndev, offset) \\\n\t((ndev)->bar_addr + (offset))\n\n \nstruct nitrox_device {\n\tstruct list_head list;\n\n\tu8 __iomem *bar_addr;\n\tstruct pci_dev *pdev;\n\n\tatomic_t state;\n\tunsigned long flags;\n\tunsigned long timeout;\n\trefcount_t refcnt;\n\n\tu8 idx;\n\tint node;\n\tu16 qlen;\n\tu16 nr_queues;\n\tenum vf_mode mode;\n\n\tstruct dma_pool *ctx_pool;\n\tstruct nitrox_cmdq *pkt_inq;\n\tstruct nitrox_cmdq *aqmq[MAX_DEV_QUEUES] ____cacheline_aligned_in_smp;\n\n\tstruct nitrox_q_vector *qvec;\n\tstruct nitrox_iov iov;\n\tint num_vecs;\n\n\tstruct nitrox_stats stats;\n\tstruct nitrox_hw hw;\n#if IS_ENABLED(CONFIG_DEBUG_FS)\n\tstruct dentry *debugfs_dir;\n#endif\n};\n\n \nstatic inline u64 nitrox_read_csr(struct nitrox_device *ndev, u64 offset)\n{\n\treturn readq(ndev->bar_addr + offset);\n}\n\n \nstatic inline void nitrox_write_csr(struct nitrox_device *ndev, u64 offset,\n\t\t\t\t    u64 value)\n{\n\twriteq(value, (ndev->bar_addr + offset));\n}\n\nstatic inline bool nitrox_ready(struct nitrox_device *ndev)\n{\n\treturn atomic_read(&ndev->state) == __NDEV_READY;\n}\n\nstatic inline bool nitrox_vfdev_ready(struct nitrox_vfdev *vfdev)\n{\n\treturn atomic_read(&vfdev->state) == __NDEV_READY;\n}\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}