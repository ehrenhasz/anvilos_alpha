{
  "module_name": "zip_mem.c",
  "hash_id": "a9135fc49947ad6a1850c9358451accfaacb2e11093c178f698a3271fd6833cc",
  "original_prompt": "Ingested from linux-6.6.14/drivers/crypto/cavium/zip/zip_mem.c",
  "human_readable_source": " \n\n#include <linux/types.h>\n#include <linux/vmalloc.h>\n\n#include \"common.h\"\n\n \nint zip_cmd_qbuf_alloc(struct zip_device *zip, int q)\n{\n\tzip->iq[q].sw_head = (u64 *)__get_free_pages((GFP_KERNEL | GFP_DMA),\n\t\t\t\t\t\tget_order(ZIP_CMD_QBUF_SIZE));\n\n\tif (!zip->iq[q].sw_head)\n\t\treturn -ENOMEM;\n\n\tmemset(zip->iq[q].sw_head, 0, ZIP_CMD_QBUF_SIZE);\n\n\tzip_dbg(\"cmd_qbuf_alloc[%d] Success : %p\\n\", q, zip->iq[q].sw_head);\n\treturn 0;\n}\n\n \nvoid zip_cmd_qbuf_free(struct zip_device *zip, int q)\n{\n\tzip_dbg(\"Freeing cmd_qbuf 0x%lx\\n\", zip->iq[q].sw_tail);\n\n\tfree_pages((u64)zip->iq[q].sw_tail, get_order(ZIP_CMD_QBUF_SIZE));\n}\n\n \nu8 *zip_data_buf_alloc(u64 size)\n{\n\tu8 *ptr;\n\n\tptr = (u8 *)__get_free_pages((GFP_KERNEL | GFP_DMA),\n\t\t\t\t\tget_order(size));\n\n\tif (!ptr)\n\t\treturn NULL;\n\n\tmemset(ptr, 0, size);\n\n\tzip_dbg(\"Data buffer allocation success\\n\");\n\treturn ptr;\n}\n\n \nvoid zip_data_buf_free(u8 *ptr, u64 size)\n{\n\tzip_dbg(\"Freeing data buffer 0x%lx\\n\", ptr);\n\n\tfree_pages((u64)ptr, get_order(size));\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}