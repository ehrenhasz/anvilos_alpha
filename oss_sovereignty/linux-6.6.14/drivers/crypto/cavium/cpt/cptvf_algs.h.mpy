{
  "module_name": "cptvf_algs.h",
  "hash_id": "dbaad8aaed31505fe1447f80f09b7865a8196900a9435be3874f3086f1b0a814",
  "original_prompt": "Ingested from linux-6.6.14/drivers/crypto/cavium/cpt/cptvf_algs.h",
  "human_readable_source": " \n \n\n#ifndef _CPTVF_ALGS_H_\n#define _CPTVF_ALGS_H_\n\n#include \"request_manager.h\"\n\n#define MAX_DEVICES 16\n#define MAJOR_OP_FC 0x33\n#define MAX_ENC_KEY_SIZE 32\n#define MAX_HASH_KEY_SIZE 64\n#define MAX_KEY_SIZE (MAX_ENC_KEY_SIZE + MAX_HASH_KEY_SIZE)\n#define CONTROL_WORD_LEN 8\n#define KEY2_OFFSET 48\n\n#define DMA_MODE_FLAG(dma_mode) \\\n\t(((dma_mode) == DMA_GATHER_SCATTER) ? (1 << 7) : 0)\n\nenum req_type {\n\tAE_CORE_REQ,\n\tSE_CORE_REQ,\n};\n\nenum cipher_type {\n\tDES3_CBC = 0x1,\n\tDES3_ECB = 0x2,\n\tAES_CBC = 0x3,\n\tAES_ECB = 0x4,\n\tAES_CFB = 0x5,\n\tAES_CTR = 0x6,\n\tAES_GCM = 0x7,\n\tAES_XTS = 0x8\n};\n\nenum aes_type {\n\tAES_128_BIT = 0x1,\n\tAES_192_BIT = 0x2,\n\tAES_256_BIT = 0x3\n};\n\nunion encr_ctrl {\n\tu64 flags;\n\tstruct {\n#if defined(__BIG_ENDIAN_BITFIELD)\n\t\tu64 enc_cipher:4;\n\t\tu64 reserved1:1;\n\t\tu64 aes_key:2;\n\t\tu64 iv_source:1;\n\t\tu64 hash_type:4;\n\t\tu64 reserved2:3;\n\t\tu64 auth_input_type:1;\n\t\tu64 mac_len:8;\n\t\tu64 reserved3:8;\n\t\tu64 encr_offset:16;\n\t\tu64 iv_offset:8;\n\t\tu64 auth_offset:8;\n#else\n\t\tu64 auth_offset:8;\n\t\tu64 iv_offset:8;\n\t\tu64 encr_offset:16;\n\t\tu64 reserved3:8;\n\t\tu64 mac_len:8;\n\t\tu64 auth_input_type:1;\n\t\tu64 reserved2:3;\n\t\tu64 hash_type:4;\n\t\tu64 iv_source:1;\n\t\tu64 aes_key:2;\n\t\tu64 reserved1:1;\n\t\tu64 enc_cipher:4;\n#endif\n\t} e;\n};\n\nstruct cvm_cipher {\n\tconst char *name;\n\tu8 value;\n};\n\nstruct enc_context {\n\tunion encr_ctrl enc_ctrl;\n\tu8 encr_key[32];\n\tu8 encr_iv[16];\n};\n\nstruct fchmac_context {\n\tu8 ipad[64];\n\tu8 opad[64];  \n};\n\nstruct fc_context {\n\tstruct enc_context enc;\n\tstruct fchmac_context hmac;\n};\n\nstruct cvm_enc_ctx {\n\tu32 key_len;\n\tu8 enc_key[MAX_KEY_SIZE];\n\tu8 cipher_type:4;\n\tu8 key_type:2;\n};\n\nstruct cvm_des3_ctx {\n\tu32 key_len;\n\tu8 des3_key[MAX_KEY_SIZE];\n};\n\nstruct cvm_req_ctx {\n\tstruct cpt_request_info cpt_req;\n\tu64 control_word;\n\tstruct fc_context fctx;\n};\n\nint cptvf_do_request(void *cptvf, struct cpt_request_info *req);\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}