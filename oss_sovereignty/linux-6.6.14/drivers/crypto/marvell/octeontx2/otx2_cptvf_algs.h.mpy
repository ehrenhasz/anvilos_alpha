{
  "module_name": "otx2_cptvf_algs.h",
  "hash_id": "fc2f09163e24efdb82cbf299ea4c7edc340071cf3e31e30715ace9bd31f24e6a",
  "original_prompt": "Ingested from linux-6.6.14/drivers/crypto/marvell/octeontx2/otx2_cptvf_algs.h",
  "human_readable_source": " \n\n#ifndef __OTX2_CPT_ALGS_H\n#define __OTX2_CPT_ALGS_H\n\n#include <crypto/hash.h>\n#include <crypto/skcipher.h>\n#include <crypto/aead.h>\n#include \"otx2_cpt_common.h\"\n\n#define OTX2_CPT_MAX_ENC_KEY_SIZE    32\n#define OTX2_CPT_MAX_HASH_KEY_SIZE   64\n#define OTX2_CPT_MAX_KEY_SIZE (OTX2_CPT_MAX_ENC_KEY_SIZE + \\\n\t\t\t       OTX2_CPT_MAX_HASH_KEY_SIZE)\nenum otx2_cpt_request_type {\n\tOTX2_CPT_ENC_DEC_REQ            = 0x1,\n\tOTX2_CPT_AEAD_ENC_DEC_REQ       = 0x2,\n\tOTX2_CPT_AEAD_ENC_DEC_NULL_REQ  = 0x3,\n\tOTX2_CPT_PASSTHROUGH_REQ\t= 0x4\n};\n\nenum otx2_cpt_major_opcodes {\n\tOTX2_CPT_MAJOR_OP_MISC = 0x01,\n\tOTX2_CPT_MAJOR_OP_FC   = 0x33,\n\tOTX2_CPT_MAJOR_OP_HMAC = 0x35,\n};\n\nenum otx2_cpt_cipher_type {\n\tOTX2_CPT_CIPHER_NULL = 0x0,\n\tOTX2_CPT_DES3_CBC = 0x1,\n\tOTX2_CPT_DES3_ECB = 0x2,\n\tOTX2_CPT_AES_CBC  = 0x3,\n\tOTX2_CPT_AES_ECB  = 0x4,\n\tOTX2_CPT_AES_CFB  = 0x5,\n\tOTX2_CPT_AES_CTR  = 0x6,\n\tOTX2_CPT_AES_GCM  = 0x7,\n\tOTX2_CPT_AES_XTS  = 0x8\n};\n\nenum otx2_cpt_mac_type {\n\tOTX2_CPT_MAC_NULL = 0x0,\n\tOTX2_CPT_MD5      = 0x1,\n\tOTX2_CPT_SHA1     = 0x2,\n\tOTX2_CPT_SHA224   = 0x3,\n\tOTX2_CPT_SHA256   = 0x4,\n\tOTX2_CPT_SHA384   = 0x5,\n\tOTX2_CPT_SHA512   = 0x6,\n\tOTX2_CPT_GMAC     = 0x7\n};\n\nenum otx2_cpt_aes_key_len {\n\tOTX2_CPT_AES_128_BIT = 0x1,\n\tOTX2_CPT_AES_192_BIT = 0x2,\n\tOTX2_CPT_AES_256_BIT = 0x3\n};\n\nunion otx2_cpt_encr_ctrl {\n\tu64 u;\n\tstruct {\n#if defined(__BIG_ENDIAN_BITFIELD)\n\t\tu64 enc_cipher:4;\n\t\tu64 reserved_59:1;\n\t\tu64 aes_key:2;\n\t\tu64 iv_source:1;\n\t\tu64 mac_type:4;\n\t\tu64 reserved_49_51:3;\n\t\tu64 auth_input_type:1;\n\t\tu64 mac_len:8;\n\t\tu64 reserved_32_39:8;\n\t\tu64 encr_offset:16;\n\t\tu64 iv_offset:8;\n\t\tu64 auth_offset:8;\n#else\n\t\tu64 auth_offset:8;\n\t\tu64 iv_offset:8;\n\t\tu64 encr_offset:16;\n\t\tu64 reserved_32_39:8;\n\t\tu64 mac_len:8;\n\t\tu64 auth_input_type:1;\n\t\tu64 reserved_49_51:3;\n\t\tu64 mac_type:4;\n\t\tu64 iv_source:1;\n\t\tu64 aes_key:2;\n\t\tu64 reserved_59:1;\n\t\tu64 enc_cipher:4;\n#endif\n\t} e;\n};\n\nstruct otx2_cpt_cipher {\n\tconst char *name;\n\tu8 value;\n};\n\nstruct otx2_cpt_fc_enc_ctx {\n\tunion otx2_cpt_encr_ctrl enc_ctrl;\n\tu8 encr_key[32];\n\tu8 encr_iv[16];\n};\n\nunion otx2_cpt_fc_hmac_ctx {\n\tstruct {\n\t\tu8 ipad[64];\n\t\tu8 opad[64];\n\t} e;\n\tstruct {\n\t\tu8 hmac_calc[64];  \n\t\tu8 hmac_recv[64];  \n\t} s;\n};\n\nstruct otx2_cpt_fc_ctx {\n\tstruct otx2_cpt_fc_enc_ctx enc;\n\tunion otx2_cpt_fc_hmac_ctx hmac;\n};\n\nstruct otx2_cpt_enc_ctx {\n\tu32 key_len;\n\tu8 enc_key[OTX2_CPT_MAX_KEY_SIZE];\n\tu8 cipher_type;\n\tu8 key_type;\n\tu8 enc_align_len;\n\tstruct crypto_skcipher *fbk_cipher;\n};\n\nunion otx2_cpt_offset_ctrl {\n\tu64 flags;\n\tstruct {\n#if defined(__BIG_ENDIAN_BITFIELD)\n\t\tu64 reserved:32;\n\t\tu64 enc_data_offset:16;\n\t\tu64 iv_offset:8;\n\t\tu64 auth_offset:8;\n#else\n\t\tu64 auth_offset:8;\n\t\tu64 iv_offset:8;\n\t\tu64 enc_data_offset:16;\n\t\tu64 reserved:32;\n#endif\n\t} e;\n};\n\nstruct otx2_cpt_req_ctx {\n\tstruct otx2_cpt_req_info cpt_req;\n\tunion otx2_cpt_offset_ctrl ctrl_word;\n\tstruct otx2_cpt_fc_ctx fctx;\n\tunion {\n\t\tstruct skcipher_request sk_fbk_req;\n\t\tstruct aead_request fbk_req;\n\t};\n};\n\nstruct otx2_cpt_sdesc {\n\tstruct shash_desc shash;\n};\n\nstruct otx2_cpt_aead_ctx {\n\tu8 key[OTX2_CPT_MAX_KEY_SIZE];\n\tstruct crypto_shash *hashalg;\n\tstruct otx2_cpt_sdesc *sdesc;\n\tstruct crypto_aead *fbk_cipher;\n\tu8 *ipad;\n\tu8 *opad;\n\tu32 enc_key_len;\n\tu32 auth_key_len;\n\tu8 cipher_type;\n\tu8 mac_type;\n\tu8 key_type;\n\tu8 is_trunc_hmac;\n\tu8 enc_align_len;\n};\nint otx2_cpt_crypto_init(struct pci_dev *pdev, struct module *mod,\n\t\t\t int num_queues, int num_devices);\nvoid otx2_cpt_crypto_exit(struct pci_dev *pdev, struct module *mod);\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}