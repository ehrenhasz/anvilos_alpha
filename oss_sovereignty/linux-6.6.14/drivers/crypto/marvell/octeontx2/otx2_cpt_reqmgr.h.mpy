{
  "module_name": "otx2_cpt_reqmgr.h",
  "hash_id": "aa507247dd86ff047f04fd2c3c5c7d0830224ac2b95fe046e5da8e608464a621",
  "original_prompt": "Ingested from linux-6.6.14/drivers/crypto/marvell/octeontx2/otx2_cpt_reqmgr.h",
  "human_readable_source": " \n\n#ifndef __OTX2_CPT_REQMGR_H\n#define __OTX2_CPT_REQMGR_H\n\n#include \"otx2_cpt_common.h\"\n\n \n#define OTX2_CPT_COMPLETION_CODE_SIZE 8\n#define OTX2_CPT_COMPLETION_CODE_INIT OTX2_CPT_COMP_E_NOTDONE\n \n#define OTX2_CPT_MAX_SG_IN_CNT  50\n#define OTX2_CPT_MAX_SG_OUT_CNT 50\n\n \n#define OTX2_CPT_DMA_MODE_DIRECT 0\n#define OTX2_CPT_DMA_MODE_SG     1\n\n \n#define OTX2_CPT_FROM_CPTR 0\n#define OTX2_CPT_FROM_DPTR 1\n\n#define OTX2_CPT_MAX_REQ_SIZE 65535\n\nunion otx2_cpt_opcode {\n\tu16 flags;\n\tstruct {\n\t\tu8 major;\n\t\tu8 minor;\n\t} s;\n};\n\nstruct otx2_cptvf_request {\n\tu32 param1;\n\tu32 param2;\n\tu16 dlen;\n\tunion otx2_cpt_opcode opcode;\n};\n\n \nunion otx2_cpt_iq_cmd_word0 {\n\tu64 u;\n\tstruct {\n\t\t__be16 opcode;\n\t\t__be16 param1;\n\t\t__be16 param2;\n\t\t__be16 dlen;\n\t} s;\n};\n\nunion otx2_cpt_iq_cmd_word3 {\n\tu64 u;\n\tstruct {\n\t\tu64 cptr:61;\n\t\tu64 grp:3;\n\t} s;\n};\n\nstruct otx2_cpt_iq_command {\n\tunion otx2_cpt_iq_cmd_word0 cmd;\n\tu64 dptr;\n\tu64 rptr;\n\tunion otx2_cpt_iq_cmd_word3 cptr;\n};\n\nstruct otx2_cpt_pending_entry {\n\tvoid *completion_addr;\t \n\tvoid *info;\n\t \n\tvoid (*callback)(int status, void *arg1, void *arg2);\n\tstruct crypto_async_request *areq;  \n\tu8 resume_sender;\t \n\tu8 busy;\t\t \n};\n\nstruct otx2_cpt_pending_queue {\n\tstruct otx2_cpt_pending_entry *head;  \n\tu32 front;\t\t \n\tu32 rear;\t\t \n\tu32 pending_count;\t \n\tu32 qlen;\t\t \n\tspinlock_t lock;\t \n};\n\nstruct otx2_cpt_buf_ptr {\n\tu8 *vptr;\n\tdma_addr_t dma_addr;\n\tu16 size;\n};\n\nunion otx2_cpt_ctrl_info {\n\tu32 flags;\n\tstruct {\n#if defined(__BIG_ENDIAN_BITFIELD)\n\t\tu32 reserved_6_31:26;\n\t\tu32 grp:3;\t \n\t\tu32 dma_mode:2;\t \n\t\tu32 se_req:1;\t \n#else\n\t\tu32 se_req:1;\t \n\t\tu32 dma_mode:2;\t \n\t\tu32 grp:3;\t \n\t\tu32 reserved_6_31:26;\n#endif\n\t} s;\n};\n\nstruct otx2_cpt_req_info {\n\t \n\tvoid (*callback)(int status, void *arg1, void *arg2);\n\tstruct crypto_async_request *areq;  \n\tstruct otx2_cptvf_request req; \n\tunion otx2_cpt_ctrl_info ctrl; \n\tstruct otx2_cpt_buf_ptr in[OTX2_CPT_MAX_SG_IN_CNT];\n\tstruct otx2_cpt_buf_ptr out[OTX2_CPT_MAX_SG_OUT_CNT];\n\tu8 *iv_out;      \n\tu16 rlen;\t \n\tu8 in_cnt;\t \n\tu8 out_cnt;\t \n\tu8 req_type;\t \n\tu8 is_enc;\t \n\tu8 is_trunc_hmac; \n};\n\nstruct otx2_cpt_inst_info {\n\tstruct otx2_cpt_pending_entry *pentry;\n\tstruct otx2_cpt_req_info *req;\n\tstruct pci_dev *pdev;\n\tvoid *completion_addr;\n\tu8 *out_buffer;\n\tu8 *in_buffer;\n\tdma_addr_t dptr_baddr;\n\tdma_addr_t rptr_baddr;\n\tdma_addr_t comp_baddr;\n\tunsigned long time_in;\n\tu32 dlen;\n\tu32 dma_len;\n\tu8 extra_time;\n};\n\nstruct otx2_cpt_sglist_component {\n\t__be16 len0;\n\t__be16 len1;\n\t__be16 len2;\n\t__be16 len3;\n\t__be64 ptr0;\n\t__be64 ptr1;\n\t__be64 ptr2;\n\t__be64 ptr3;\n};\n\nstatic inline void otx2_cpt_info_destroy(struct pci_dev *pdev,\n\t\t\t\t\t struct otx2_cpt_inst_info *info)\n{\n\tstruct otx2_cpt_req_info *req;\n\tint i;\n\n\tif (info->dptr_baddr)\n\t\tdma_unmap_single(&pdev->dev, info->dptr_baddr,\n\t\t\t\t info->dma_len, DMA_BIDIRECTIONAL);\n\n\tif (info->req) {\n\t\treq = info->req;\n\t\tfor (i = 0; i < req->out_cnt; i++) {\n\t\t\tif (req->out[i].dma_addr)\n\t\t\t\tdma_unmap_single(&pdev->dev,\n\t\t\t\t\t\t req->out[i].dma_addr,\n\t\t\t\t\t\t req->out[i].size,\n\t\t\t\t\t\t DMA_BIDIRECTIONAL);\n\t\t}\n\n\t\tfor (i = 0; i < req->in_cnt; i++) {\n\t\t\tif (req->in[i].dma_addr)\n\t\t\t\tdma_unmap_single(&pdev->dev,\n\t\t\t\t\t\t req->in[i].dma_addr,\n\t\t\t\t\t\t req->in[i].size,\n\t\t\t\t\t\t DMA_BIDIRECTIONAL);\n\t\t}\n\t}\n\tkfree(info);\n}\n\nstruct otx2_cptlf_wqe;\nint otx2_cpt_do_request(struct pci_dev *pdev, struct otx2_cpt_req_info *req,\n\t\t\tint cpu_num);\nvoid otx2_cpt_post_process(struct otx2_cptlf_wqe *wqe);\nint otx2_cpt_get_kcrypto_eng_grp_num(struct pci_dev *pdev);\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}