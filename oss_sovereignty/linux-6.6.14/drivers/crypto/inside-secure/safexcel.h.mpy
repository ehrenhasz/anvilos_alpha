{
  "module_name": "safexcel.h",
  "hash_id": "cef9e943a90a6819c2328906fd8adc1a8a80f693e50e522ed3a26964ad9e5686",
  "original_prompt": "Ingested from linux-6.6.14/drivers/crypto/inside-secure/safexcel.h",
  "human_readable_source": " \n \n\n#ifndef __SAFEXCEL_H__\n#define __SAFEXCEL_H__\n\n#include <crypto/aead.h>\n#include <crypto/algapi.h>\n#include <crypto/internal/hash.h>\n#include <crypto/sha1.h>\n#include <crypto/sha2.h>\n#include <crypto/sha3.h>\n#include <crypto/skcipher.h>\n#include <linux/types.h>\n\n#define EIP197_HIA_VERSION_BE\t\t\t0xca35\n#define EIP197_HIA_VERSION_LE\t\t\t0x35ca\n#define EIP97_VERSION_LE\t\t\t0x9e61\n#define EIP196_VERSION_LE\t\t\t0x3bc4\n#define EIP197_VERSION_LE\t\t\t0x3ac5\n#define EIP96_VERSION_LE\t\t\t0x9f60\n#define EIP201_VERSION_LE\t\t\t0x36c9\n#define EIP206_VERSION_LE\t\t\t0x31ce\n#define EIP207_VERSION_LE\t\t\t0x30cf\n#define EIP197_REG_LO16(reg)\t\t\t(reg & 0xffff)\n#define EIP197_REG_HI16(reg)\t\t\t((reg >> 16) & 0xffff)\n#define EIP197_VERSION_MASK(reg)\t\t((reg >> 16) & 0xfff)\n#define EIP197_VERSION_SWAP(reg)\t\t(((reg & 0xf0) << 4) | \\\n\t\t\t\t\t\t((reg >> 4) & 0xf0) | \\\n\t\t\t\t\t\t((reg >> 12) & 0xf))\n\n \n#define EIP197_HIA_OPT_HAS_PE_ARB\t\tBIT(29)\n\n \n#define EIP206_OPT_ICE_TYPE(n)\t\t\t((n>>8)&3)\n#define EIP206_OPT_OCE_TYPE(n)\t\t\t((n>>10)&3)\n\n \n#define EIP197_OPT_HAS_TRC\t\t\tBIT(31)\n\n \n#define EIP197_DEFAULT_RING_SIZE\t\t400\n#define EIP197_EMB_TOKENS\t\t\t4  \n#define EIP197_MAX_TOKENS\t\t\t16\n#define EIP197_MAX_RINGS\t\t\t4\n#define EIP197_FETCH_DEPTH\t\t\t2\n#define EIP197_MAX_BATCH_SZ\t\t\t64\n#define EIP197_MAX_RING_AIC\t\t\t14\n\n#define EIP197_GFP_FLAGS(base)\t((base).flags & CRYPTO_TFM_REQ_MAY_SLEEP ? \\\n\t\t\t\t GFP_KERNEL : GFP_ATOMIC)\n\n \n#define EIP197_SKCIPHER_REQ_SIZE\tsizeof(struct skcipher_request) + \\\n\t\t\t\t\tsizeof(struct safexcel_cipher_req)\n#define EIP197_AHASH_REQ_SIZE\t\tsizeof(struct ahash_request) + \\\n\t\t\t\t\tsizeof(struct safexcel_ahash_req)\n#define EIP197_AEAD_REQ_SIZE\t\tsizeof(struct aead_request) + \\\n\t\t\t\t\tsizeof(struct safexcel_cipher_req)\n#define EIP197_REQUEST_ON_STACK(name, type, size) \\\n\tchar __##name##_desc[size] CRYPTO_MINALIGN_ATTR; \\\n\tstruct type##_request *name = (void *)__##name##_desc\n\n \n#define EIP197_XLX_GPIO_BASE\t\t0x200000\n#define EIP197_XLX_IRQ_BLOCK_ID_ADDR\t0x2000\n#define EIP197_XLX_IRQ_BLOCK_ID_VALUE\t0x1fc2\n#define EIP197_XLX_USER_INT_ENB_MSK\t0x2004\n#define EIP197_XLX_USER_INT_ENB_SET\t0x2008\n#define EIP197_XLX_USER_INT_ENB_CLEAR\t0x200c\n#define EIP197_XLX_USER_INT_BLOCK\t0x2040\n#define EIP197_XLX_USER_INT_PEND\t0x2048\n#define EIP197_XLX_USER_VECT_LUT0_ADDR\t0x2080\n#define EIP197_XLX_USER_VECT_LUT0_IDENT\t0x03020100\n#define EIP197_XLX_USER_VECT_LUT1_ADDR\t0x2084\n#define EIP197_XLX_USER_VECT_LUT1_IDENT\t0x07060504\n#define EIP197_XLX_USER_VECT_LUT2_ADDR\t0x2088\n#define EIP197_XLX_USER_VECT_LUT2_IDENT\t0x0b0a0908\n#define EIP197_XLX_USER_VECT_LUT3_ADDR\t0x208c\n#define EIP197_XLX_USER_VECT_LUT3_IDENT\t0x0f0e0d0c\n\n \n#define EIP197_IRQ_NUMBER(i, is_pci)\t(i + is_pci)\n\n \n#define EIP197_HIA_AIC(priv)\t\t((priv)->base + (priv)->offsets.hia_aic)\n#define EIP197_HIA_AIC_G(priv)\t\t((priv)->base + (priv)->offsets.hia_aic_g)\n#define EIP197_HIA_AIC_R(priv)\t\t((priv)->base + (priv)->offsets.hia_aic_r)\n#define EIP197_HIA_AIC_xDR(priv)\t((priv)->base + (priv)->offsets.hia_aic_xdr)\n#define EIP197_HIA_DFE(priv)\t\t((priv)->base + (priv)->offsets.hia_dfe)\n#define EIP197_HIA_DFE_THR(priv)\t((priv)->base + (priv)->offsets.hia_dfe_thr)\n#define EIP197_HIA_DSE(priv)\t\t((priv)->base + (priv)->offsets.hia_dse)\n#define EIP197_HIA_DSE_THR(priv)\t((priv)->base + (priv)->offsets.hia_dse_thr)\n#define EIP197_HIA_GEN_CFG(priv)\t((priv)->base + (priv)->offsets.hia_gen_cfg)\n#define EIP197_PE(priv)\t\t\t((priv)->base + (priv)->offsets.pe)\n#define EIP197_GLOBAL(priv)\t\t((priv)->base + (priv)->offsets.global)\n\n \n#define EIP197_HIA_AIC_BASE\t\t0x90000\n#define EIP197_HIA_AIC_G_BASE\t\t0x90000\n#define EIP197_HIA_AIC_R_BASE\t\t0x90800\n#define EIP197_HIA_AIC_xDR_BASE\t\t0x80000\n#define EIP197_HIA_DFE_BASE\t\t0x8c000\n#define EIP197_HIA_DFE_THR_BASE\t\t0x8c040\n#define EIP197_HIA_DSE_BASE\t\t0x8d000\n#define EIP197_HIA_DSE_THR_BASE\t\t0x8d040\n#define EIP197_HIA_GEN_CFG_BASE\t\t0xf0000\n#define EIP197_PE_BASE\t\t\t0xa0000\n#define EIP197_GLOBAL_BASE\t\t0xf0000\n\n \n#define EIP97_HIA_AIC_BASE\t\t0x0\n#define EIP97_HIA_AIC_G_BASE\t\t0x0\n#define EIP97_HIA_AIC_R_BASE\t\t0x0\n#define EIP97_HIA_AIC_xDR_BASE\t\t0x0\n#define EIP97_HIA_DFE_BASE\t\t0xf000\n#define EIP97_HIA_DFE_THR_BASE\t\t0xf200\n#define EIP97_HIA_DSE_BASE\t\t0xf400\n#define EIP97_HIA_DSE_THR_BASE\t\t0xf600\n#define EIP97_HIA_GEN_CFG_BASE\t\t0x10000\n#define EIP97_PE_BASE\t\t\t0x10000\n#define EIP97_GLOBAL_BASE\t\t0x10000\n\n \n#define EIP197_HIA_xDR_OFF(priv, r)\t\t(EIP197_HIA_AIC_xDR(priv) + (r) * 0x1000)\n#define EIP197_HIA_CDR(priv, r)\t\t\t(EIP197_HIA_xDR_OFF(priv, r))\n#define EIP197_HIA_RDR(priv, r)\t\t\t(EIP197_HIA_xDR_OFF(priv, r) + 0x800)\n#define EIP197_HIA_xDR_RING_BASE_ADDR_LO\t0x0000\n#define EIP197_HIA_xDR_RING_BASE_ADDR_HI\t0x0004\n#define EIP197_HIA_xDR_RING_SIZE\t\t0x0018\n#define EIP197_HIA_xDR_DESC_SIZE\t\t0x001c\n#define EIP197_HIA_xDR_CFG\t\t\t0x0020\n#define EIP197_HIA_xDR_DMA_CFG\t\t\t0x0024\n#define EIP197_HIA_xDR_THRESH\t\t\t0x0028\n#define EIP197_HIA_xDR_PREP_COUNT\t\t0x002c\n#define EIP197_HIA_xDR_PROC_COUNT\t\t0x0030\n#define EIP197_HIA_xDR_PREP_PNTR\t\t0x0034\n#define EIP197_HIA_xDR_PROC_PNTR\t\t0x0038\n#define EIP197_HIA_xDR_STAT\t\t\t0x003c\n\n \n#define EIP197_HIA_DFE_CFG(n)\t\t\t(0x0000 + (128 * (n)))\n#define EIP197_HIA_DFE_THR_CTRL(n)\t\t(0x0000 + (128 * (n)))\n#define EIP197_HIA_DFE_THR_STAT(n)\t\t(0x0004 + (128 * (n)))\n#define EIP197_HIA_DSE_CFG(n)\t\t\t(0x0000 + (128 * (n)))\n#define EIP197_HIA_DSE_THR_CTRL(n)\t\t(0x0000 + (128 * (n)))\n#define EIP197_HIA_DSE_THR_STAT(n)\t\t(0x0004 + (128 * (n)))\n#define EIP197_HIA_RA_PE_CTRL(n)\t\t(0x0010 + (8   * (n)))\n#define EIP197_HIA_RA_PE_STAT\t\t\t0x0014\n#define EIP197_HIA_AIC_R_OFF(r)\t\t\t((r) * 0x1000)\n#define EIP197_HIA_AIC_R_ENABLE_CTRL(r)\t\t(0xe008 - EIP197_HIA_AIC_R_OFF(r))\n#define EIP197_HIA_AIC_R_ENABLED_STAT(r)\t(0xe010 - EIP197_HIA_AIC_R_OFF(r))\n#define EIP197_HIA_AIC_R_ACK(r)\t\t\t(0xe010 - EIP197_HIA_AIC_R_OFF(r))\n#define EIP197_HIA_AIC_R_ENABLE_CLR(r)\t\t(0xe014 - EIP197_HIA_AIC_R_OFF(r))\n#define EIP197_HIA_AIC_R_VERSION(r)\t\t(0xe01c - EIP197_HIA_AIC_R_OFF(r))\n#define EIP197_HIA_AIC_G_ENABLE_CTRL\t\t0xf808\n#define EIP197_HIA_AIC_G_ENABLED_STAT\t\t0xf810\n#define EIP197_HIA_AIC_G_ACK\t\t\t0xf810\n#define EIP197_HIA_MST_CTRL\t\t\t0xfff4\n#define EIP197_HIA_OPTIONS\t\t\t0xfff8\n#define EIP197_HIA_VERSION\t\t\t0xfffc\n#define EIP197_PE_IN_DBUF_THRES(n)\t\t(0x0000 + (0x2000 * (n)))\n#define EIP197_PE_IN_TBUF_THRES(n)\t\t(0x0100 + (0x2000 * (n)))\n#define EIP197_PE_ICE_SCRATCH_RAM(n)\t\t(0x0800 + (0x2000 * (n)))\n#define EIP197_PE_ICE_PUE_CTRL(n)\t\t(0x0c80 + (0x2000 * (n)))\n#define EIP197_PE_ICE_PUTF_CTRL(n)\t\t(0x0d00 + (0x2000 * (n)))\n#define EIP197_PE_ICE_SCRATCH_CTRL(n)\t\t(0x0d04 + (0x2000 * (n)))\n#define EIP197_PE_ICE_FPP_CTRL(n)\t\t(0x0d80 + (0x2000 * (n)))\n#define EIP197_PE_ICE_PPTF_CTRL(n)\t\t(0x0e00 + (0x2000 * (n)))\n#define EIP197_PE_ICE_RAM_CTRL(n)\t\t(0x0ff0 + (0x2000 * (n)))\n#define EIP197_PE_ICE_VERSION(n)\t\t(0x0ffc + (0x2000 * (n)))\n#define EIP197_PE_EIP96_TOKEN_CTRL(n)\t\t(0x1000 + (0x2000 * (n)))\n#define EIP197_PE_EIP96_FUNCTION_EN(n)\t\t(0x1004 + (0x2000 * (n)))\n#define EIP197_PE_EIP96_CONTEXT_CTRL(n)\t\t(0x1008 + (0x2000 * (n)))\n#define EIP197_PE_EIP96_CONTEXT_STAT(n)\t\t(0x100c + (0x2000 * (n)))\n#define EIP197_PE_EIP96_TOKEN_CTRL2(n)\t\t(0x102c + (0x2000 * (n)))\n#define EIP197_PE_EIP96_FUNCTION2_EN(n)\t\t(0x1030 + (0x2000 * (n)))\n#define EIP197_PE_EIP96_OPTIONS(n)\t\t(0x13f8 + (0x2000 * (n)))\n#define EIP197_PE_EIP96_VERSION(n)\t\t(0x13fc + (0x2000 * (n)))\n#define EIP197_PE_OCE_VERSION(n)\t\t(0x1bfc + (0x2000 * (n)))\n#define EIP197_PE_OUT_DBUF_THRES(n)\t\t(0x1c00 + (0x2000 * (n)))\n#define EIP197_PE_OUT_TBUF_THRES(n)\t\t(0x1d00 + (0x2000 * (n)))\n#define EIP197_PE_PSE_VERSION(n)\t\t(0x1efc + (0x2000 * (n)))\n#define EIP197_PE_DEBUG(n)\t\t\t(0x1ff4 + (0x2000 * (n)))\n#define EIP197_PE_OPTIONS(n)\t\t\t(0x1ff8 + (0x2000 * (n)))\n#define EIP197_PE_VERSION(n)\t\t\t(0x1ffc + (0x2000 * (n)))\n#define EIP197_MST_CTRL\t\t\t\t0xfff4\n#define EIP197_OPTIONS\t\t\t\t0xfff8\n#define EIP197_VERSION\t\t\t\t0xfffc\n\n \n#define EIP197_CLASSIFICATION_RAMS\t\t0xe0000\n#define EIP197_TRC_CTRL\t\t\t\t0xf0800\n#define EIP197_TRC_LASTRES\t\t\t0xf0804\n#define EIP197_TRC_REGINDEX\t\t\t0xf0808\n#define EIP197_TRC_PARAMS\t\t\t0xf0820\n#define EIP197_TRC_FREECHAIN\t\t\t0xf0824\n#define EIP197_TRC_PARAMS2\t\t\t0xf0828\n#define EIP197_TRC_ECCCTRL\t\t\t0xf0830\n#define EIP197_TRC_ECCSTAT\t\t\t0xf0834\n#define EIP197_TRC_ECCADMINSTAT\t\t\t0xf0838\n#define EIP197_TRC_ECCDATASTAT\t\t\t0xf083c\n#define EIP197_TRC_ECCDATA\t\t\t0xf0840\n#define EIP197_STRC_CONFIG\t\t\t0xf43f0\n#define EIP197_FLUE_CACHEBASE_LO(n)\t\t(0xf6000 + (32 * (n)))\n#define EIP197_FLUE_CACHEBASE_HI(n)\t\t(0xf6004 + (32 * (n)))\n#define EIP197_FLUE_CONFIG(n)\t\t\t(0xf6010 + (32 * (n)))\n#define EIP197_FLUE_OFFSETS\t\t\t0xf6808\n#define EIP197_FLUE_ARC4_OFFSET\t\t\t0xf680c\n#define EIP197_FLUE_IFC_LUT(n)\t\t\t(0xf6820 + (4 * (n)))\n#define EIP197_CS_RAM_CTRL\t\t\t0xf7ff0\n\n \n#define EIP197_xDR_DESC_MODE_64BIT\t\tBIT(31)\n#define EIP197_CDR_DESC_MODE_ADCP\t\tBIT(30)\n\n \n#define EIP197_HIA_xDR_WR_RES_BUF\t\tBIT(22)\n#define EIP197_HIA_xDR_WR_CTRL_BUF\t\tBIT(23)\n#define EIP197_HIA_xDR_WR_OWN_BUF\t\tBIT(24)\n#define EIP197_HIA_xDR_CFG_WR_CACHE(n)\t\t(((n) & 0x7) << 25)\n#define EIP197_HIA_xDR_CFG_RD_CACHE(n)\t\t(((n) & 0x7) << 29)\n\n \n#define EIP197_HIA_CDR_THRESH_PROC_PKT(n)\t(n)\n#define EIP197_HIA_CDR_THRESH_PROC_MODE\t\tBIT(22)\n#define EIP197_HIA_CDR_THRESH_PKT_MODE\t\tBIT(23)\n#define EIP197_HIA_CDR_THRESH_TIMEOUT(n)\t((n) << 24)  \n\n \n#define EIP197_HIA_RDR_THRESH_PROC_PKT(n)\t(n)\n#define EIP197_HIA_RDR_THRESH_PKT_MODE\t\tBIT(23)\n#define EIP197_HIA_RDR_THRESH_TIMEOUT(n)\t((n) << 24)  \n\n \n#define EIP197_xDR_PREP_CLR_COUNT\t\tBIT(31)\n\n \n#define EIP197_xDR_PROC_xD_PKT_OFFSET\t\t24\n#define EIP197_xDR_PROC_xD_PKT_MASK\t\tGENMASK(6, 0)\n#define EIP197_xDR_PROC_xD_PKT(n)\t\t((n) << 24)\n#define EIP197_xDR_PROC_CLR_COUNT\t\tBIT(31)\n\n \n#define EIP197_xDR_DMA_ERR\t\t\tBIT(0)\n#define EIP197_xDR_PREP_CMD_THRES\t\tBIT(1)\n#define EIP197_xDR_ERR\t\t\t\tBIT(2)\n#define EIP197_xDR_THRESH\t\t\tBIT(4)\n#define EIP197_xDR_TIMEOUT\t\t\tBIT(5)\n\n#define EIP197_HIA_RA_PE_CTRL_RESET\t\tBIT(31)\n#define EIP197_HIA_RA_PE_CTRL_EN\t\tBIT(30)\n\n \n#define EIP197_N_RINGS_OFFSET\t\t\t0\n#define EIP197_N_RINGS_MASK\t\t\tGENMASK(3, 0)\n#define EIP197_N_PES_OFFSET\t\t\t4\n#define EIP197_N_PES_MASK\t\t\tGENMASK(4, 0)\n#define EIP97_N_PES_MASK\t\t\tGENMASK(2, 0)\n#define EIP197_HWDATAW_OFFSET\t\t\t25\n#define EIP197_HWDATAW_MASK\t\t\tGENMASK(3, 0)\n#define EIP97_HWDATAW_MASK\t\t\tGENMASK(2, 0)\n#define EIP197_CFSIZE_OFFSET\t\t\t9\n#define EIP197_CFSIZE_ADJUST\t\t\t4\n#define EIP97_CFSIZE_OFFSET\t\t\t8\n#define EIP197_CFSIZE_MASK\t\t\tGENMASK(2, 0)\n#define EIP97_CFSIZE_MASK\t\t\tGENMASK(3, 0)\n#define EIP197_RFSIZE_OFFSET\t\t\t12\n#define EIP197_RFSIZE_ADJUST\t\t\t4\n#define EIP97_RFSIZE_OFFSET\t\t\t12\n#define EIP197_RFSIZE_MASK\t\t\tGENMASK(2, 0)\n#define EIP97_RFSIZE_MASK\t\t\tGENMASK(3, 0)\n\n \n#define EIP197_CDR_IRQ(n)\t\t\tBIT((n) * 2)\n#define EIP197_RDR_IRQ(n)\t\t\tBIT((n) * 2 + 1)\n\n \n#define EIP197_HIA_DxE_CFG_MIN_DATA_SIZE(n)\t((n) << 0)\n#define EIP197_HIA_DxE_CFG_DATA_CACHE_CTRL(n)\t(((n) & 0x7) << 4)\n#define EIP197_HIA_DxE_CFG_MAX_DATA_SIZE(n)\t((n) << 8)\n#define EIP197_HIA_DSE_CFG_ALWAYS_BUFFERABLE\tGENMASK(15, 14)\n#define EIP197_HIA_DxE_CFG_MIN_CTRL_SIZE(n)\t((n) << 16)\n#define EIP197_HIA_DxE_CFG_CTRL_CACHE_CTRL(n)\t(((n) & 0x7) << 20)\n#define EIP197_HIA_DxE_CFG_MAX_CTRL_SIZE(n)\t((n) << 24)\n#define EIP197_HIA_DFE_CFG_DIS_DEBUG\t\tGENMASK(31, 29)\n#define EIP197_HIA_DSE_CFG_EN_SINGLE_WR\t\tBIT(29)\n#define EIP197_HIA_DSE_CFG_DIS_DEBUG\t\tGENMASK(31, 30)\n\n \n#define EIP197_DxE_THR_CTRL_EN\t\t\tBIT(30)\n#define EIP197_DxE_THR_CTRL_RESET_PE\t\tBIT(31)\n\n \n#define EIP197_PE_ICE_UENG_START_OFFSET(n)\t((n) << 16)\n#define EIP197_PE_ICE_UENG_INIT_ALIGN_MASK\t0x7ff0\n#define EIP197_PE_ICE_UENG_DEBUG_RESET\t\tBIT(3)\n\n \n#define EIP197_G_IRQ_DFE(n)\t\t\tBIT((n) << 1)\n#define EIP197_G_IRQ_DSE(n)\t\t\tBIT(((n) << 1) + 1)\n#define EIP197_G_IRQ_RING\t\t\tBIT(16)\n#define EIP197_G_IRQ_PE(n)\t\t\tBIT((n) + 20)\n\n \n#define RD_CACHE_3BITS\t\t\t\t0x5\n#define WR_CACHE_3BITS\t\t\t\t0x3\n#define RD_CACHE_4BITS\t\t\t\t(RD_CACHE_3BITS << 1 | BIT(0))\n#define WR_CACHE_4BITS\t\t\t\t(WR_CACHE_3BITS << 1 | BIT(0))\n#define EIP197_MST_CTRL_RD_CACHE(n)\t\t(((n) & 0xf) << 0)\n#define EIP197_MST_CTRL_WD_CACHE(n)\t\t(((n) & 0xf) << 4)\n#define EIP197_MST_CTRL_TX_MAX_CMD(n)\t\t(((n) & 0xf) << 20)\n#define EIP197_MST_CTRL_BYTE_SWAP\t\tBIT(24)\n#define EIP197_MST_CTRL_NO_BYTE_SWAP\t\tBIT(25)\n#define EIP197_MST_CTRL_BYTE_SWAP_BITS          GENMASK(25, 24)\n\n \n#define EIP197_PE_IN_xBUF_THRES_MIN(n)\t\t((n) << 8)\n#define EIP197_PE_IN_xBUF_THRES_MAX(n)\t\t((n) << 12)\n\n \n#define EIP197_PE_OUT_DBUF_THRES_MIN(n)\t\t((n) << 0)\n#define EIP197_PE_OUT_DBUF_THRES_MAX(n)\t\t((n) << 4)\n\n \n#define EIP197_PE_ICE_SCRATCH_CTRL_CHANGE_TIMER\t\tBIT(2)\n#define EIP197_PE_ICE_SCRATCH_CTRL_TIMER_EN\t\tBIT(3)\n#define EIP197_PE_ICE_SCRATCH_CTRL_CHANGE_ACCESS\tBIT(24)\n#define EIP197_PE_ICE_SCRATCH_CTRL_SCRATCH_ACCESS\tBIT(25)\n\n \n#define EIP197_NUM_OF_SCRATCH_BLOCKS\t\t32\n\n \n#define EIP197_PE_ICE_x_CTRL_SW_RESET\t\t\tBIT(0)\n#define EIP197_PE_ICE_x_CTRL_CLR_ECC_NON_CORR\t\tBIT(14)\n#define EIP197_PE_ICE_x_CTRL_CLR_ECC_CORR\t\tBIT(15)\n\n \n#define EIP197_PE_ICE_RAM_CTRL_PUE_PROG_EN\tBIT(0)\n#define EIP197_PE_ICE_RAM_CTRL_FPP_PROG_EN\tBIT(1)\n\n \n#define EIP197_PE_EIP96_TOKEN_CTRL_CTX_UPDATES\t\tBIT(16)\n#define EIP197_PE_EIP96_TOKEN_CTRL_NO_TOKEN_WAIT\tBIT(17)\n#define EIP197_PE_EIP96_TOKEN_CTRL_ENABLE_TIMEOUT\tBIT(22)\n\n \n#define EIP197_FUNCTION_ALL\t\t\t0xffffffff\n\n \n#define EIP197_CONTEXT_SIZE(n)\t\t\t(n)\n#define EIP197_ADDRESS_MODE\t\t\tBIT(8)\n#define EIP197_CONTROL_MODE\t\t\tBIT(9)\n\n \n#define EIP197_PE_EIP96_TOKEN_CTRL2_CTX_DONE\tBIT(3)\n\n \n#define EIP197_DEBUG_OCE_BYPASS\t\t\tBIT(1)\n\n \n#define EIP197_STRC_CONFIG_INIT\t\t\tBIT(31)\n#define EIP197_STRC_CONFIG_LARGE_REC(s)\t\t(s<<8)\n#define EIP197_STRC_CONFIG_SMALL_REC(s)\t\t(s<<0)\n\n \n#define EIP197_FLUE_CONFIG_MAGIC\t\t0xc7000004\n\n \nstruct safexcel_context_record {\n\t__le32 control0;\n\t__le32 control1;\n\n\t__le32 data[40];\n} __packed;\n\n \n#define CONTEXT_CONTROL_TYPE_NULL_OUT\t\t0x0\n#define CONTEXT_CONTROL_TYPE_NULL_IN\t\t0x1\n#define CONTEXT_CONTROL_TYPE_HASH_OUT\t\t0x2\n#define CONTEXT_CONTROL_TYPE_HASH_IN\t\t0x3\n#define CONTEXT_CONTROL_TYPE_CRYPTO_OUT\t\t0x4\n#define CONTEXT_CONTROL_TYPE_CRYPTO_IN\t\t0x5\n#define CONTEXT_CONTROL_TYPE_ENCRYPT_HASH_OUT\t0x6\n#define CONTEXT_CONTROL_TYPE_DECRYPT_HASH_IN\t0x7\n#define CONTEXT_CONTROL_TYPE_HASH_ENCRYPT_OUT\t0xe\n#define CONTEXT_CONTROL_TYPE_HASH_DECRYPT_IN\t0xf\n#define CONTEXT_CONTROL_RESTART_HASH\t\tBIT(4)\n#define CONTEXT_CONTROL_NO_FINISH_HASH\t\tBIT(5)\n#define CONTEXT_CONTROL_SIZE(n)\t\t\t((n) << 8)\n#define CONTEXT_CONTROL_KEY_EN\t\t\tBIT(16)\n#define CONTEXT_CONTROL_CRYPTO_ALG_DES\t\t(0x0 << 17)\n#define CONTEXT_CONTROL_CRYPTO_ALG_3DES\t\t(0x2 << 17)\n#define CONTEXT_CONTROL_CRYPTO_ALG_AES128\t(0x5 << 17)\n#define CONTEXT_CONTROL_CRYPTO_ALG_AES192\t(0x6 << 17)\n#define CONTEXT_CONTROL_CRYPTO_ALG_AES256\t(0x7 << 17)\n#define CONTEXT_CONTROL_CRYPTO_ALG_CHACHA20\t(0x8 << 17)\n#define CONTEXT_CONTROL_CRYPTO_ALG_SM4\t\t(0xd << 17)\n#define CONTEXT_CONTROL_DIGEST_INITIAL\t\t(0x0 << 21)\n#define CONTEXT_CONTROL_DIGEST_PRECOMPUTED\t(0x1 << 21)\n#define CONTEXT_CONTROL_DIGEST_XCM\t\t(0x2 << 21)\n#define CONTEXT_CONTROL_DIGEST_HMAC\t\t(0x3 << 21)\n#define CONTEXT_CONTROL_CRYPTO_ALG_MD5\t\t(0x0 << 23)\n#define CONTEXT_CONTROL_CRYPTO_ALG_CRC32\t(0x0 << 23)\n#define CONTEXT_CONTROL_CRYPTO_ALG_SHA1\t\t(0x2 << 23)\n#define CONTEXT_CONTROL_CRYPTO_ALG_SHA224\t(0x4 << 23)\n#define CONTEXT_CONTROL_CRYPTO_ALG_SHA256\t(0x3 << 23)\n#define CONTEXT_CONTROL_CRYPTO_ALG_SHA384\t(0x6 << 23)\n#define CONTEXT_CONTROL_CRYPTO_ALG_SHA512\t(0x5 << 23)\n#define CONTEXT_CONTROL_CRYPTO_ALG_GHASH\t(0x4 << 23)\n#define CONTEXT_CONTROL_CRYPTO_ALG_XCBC128\t(0x1 << 23)\n#define CONTEXT_CONTROL_CRYPTO_ALG_XCBC192\t(0x2 << 23)\n#define CONTEXT_CONTROL_CRYPTO_ALG_XCBC256\t(0x3 << 23)\n#define CONTEXT_CONTROL_CRYPTO_ALG_SM3\t\t(0x7 << 23)\n#define CONTEXT_CONTROL_CRYPTO_ALG_SHA3_256\t(0xb << 23)\n#define CONTEXT_CONTROL_CRYPTO_ALG_SHA3_224\t(0xc << 23)\n#define CONTEXT_CONTROL_CRYPTO_ALG_SHA3_512\t(0xd << 23)\n#define CONTEXT_CONTROL_CRYPTO_ALG_SHA3_384\t(0xe << 23)\n#define CONTEXT_CONTROL_CRYPTO_ALG_POLY1305\t(0xf << 23)\n#define CONTEXT_CONTROL_INV_FR\t\t\t(0x5 << 24)\n#define CONTEXT_CONTROL_INV_TR\t\t\t(0x6 << 24)\n\n \n#define CONTEXT_CONTROL_CRYPTO_MODE_ECB\t\t(0 << 0)\n#define CONTEXT_CONTROL_CRYPTO_MODE_CBC\t\t(1 << 0)\n#define CONTEXT_CONTROL_CHACHA20_MODE_256_32\t(2 << 0)\n#define CONTEXT_CONTROL_CRYPTO_MODE_OFB\t\t(4 << 0)\n#define CONTEXT_CONTROL_CRYPTO_MODE_CFB\t\t(5 << 0)\n#define CONTEXT_CONTROL_CRYPTO_MODE_CTR_LOAD\t(6 << 0)\n#define CONTEXT_CONTROL_CRYPTO_MODE_XTS\t\t(7 << 0)\n#define CONTEXT_CONTROL_CRYPTO_MODE_XCM\t\t((6 << 0) | BIT(17))\n#define CONTEXT_CONTROL_CHACHA20_MODE_CALC_OTK\t(12 << 0)\n#define CONTEXT_CONTROL_IV0\t\t\tBIT(5)\n#define CONTEXT_CONTROL_IV1\t\t\tBIT(6)\n#define CONTEXT_CONTROL_IV2\t\t\tBIT(7)\n#define CONTEXT_CONTROL_IV3\t\t\tBIT(8)\n#define CONTEXT_CONTROL_DIGEST_CNT\t\tBIT(9)\n#define CONTEXT_CONTROL_COUNTER_MODE\t\tBIT(10)\n#define CONTEXT_CONTROL_CRYPTO_STORE\t\tBIT(12)\n#define CONTEXT_CONTROL_HASH_STORE\t\tBIT(19)\n\n#define EIP197_XCM_MODE_GCM\t\t\t1\n#define EIP197_XCM_MODE_CCM\t\t\t2\n\n#define EIP197_AEAD_TYPE_IPSEC_ESP\t\t2\n#define EIP197_AEAD_TYPE_IPSEC_ESP_GMAC\t\t3\n#define EIP197_AEAD_IPSEC_IV_SIZE\t\t8\n#define EIP197_AEAD_IPSEC_NONCE_SIZE\t\t4\n#define EIP197_AEAD_IPSEC_COUNTER_SIZE\t\t4\n#define EIP197_AEAD_IPSEC_CCM_NONCE_SIZE\t3\n\n \n#define EIP197_COUNTER_BLOCK_SIZE\t\t64\n\n \n#define EIP197_TRC_ENABLE_0\t\t\tBIT(4)\n#define EIP197_TRC_ENABLE_1\t\t\tBIT(5)\n#define EIP197_TRC_ENABLE_2\t\t\tBIT(6)\n#define EIP197_TRC_ENABLE_MASK\t\t\tGENMASK(6, 4)\n#define EIP197_CS_BANKSEL_MASK\t\t\tGENMASK(14, 12)\n#define EIP197_CS_BANKSEL_OFS\t\t\t12\n\n \n#define EIP197_TRC_PARAMS_SW_RESET\t\tBIT(0)\n#define EIP197_TRC_PARAMS_DATA_ACCESS\t\tBIT(2)\n#define EIP197_TRC_PARAMS_HTABLE_SZ(x)\t\t((x) << 4)\n#define EIP197_TRC_PARAMS_BLK_TIMER_SPEED(x)\t((x) << 10)\n#define EIP197_TRC_PARAMS_RC_SZ_LARGE(n)\t((n) << 18)\n\n \n#define EIP197_TRC_FREECHAIN_HEAD_PTR(p)\t(p)\n#define EIP197_TRC_FREECHAIN_TAIL_PTR(p)\t((p) << 16)\n\n \n#define EIP197_TRC_PARAMS2_HTABLE_PTR(p)\t(p)\n#define EIP197_TRC_PARAMS2_RC_SZ_SMALL(n)\t((n) << 18)\n\n \n#define EIP197_MIN_DSIZE\t\t\t1024\n#define EIP197_MIN_ASIZE\t\t\t8\n#define EIP197_CS_TRC_REC_WC\t\t\t64\n#define EIP197_CS_RC_SIZE\t\t\t(4 * sizeof(u32))\n#define EIP197_CS_RC_NEXT(x)\t\t\t(x)\n#define EIP197_CS_RC_PREV(x)\t\t\t((x) << 10)\n#define EIP197_RC_NULL\t\t\t\t0x3ff\n\n \nstruct result_data_desc {\n\tu32 packet_length:17;\n\tu32 error_code:15;\n\n\tu32 bypass_length:4;\n\tu32 e15:1;\n\tu32 rsvd0:16;\n\tu32 hash_bytes:1;\n\tu32 hash_length:6;\n\tu32 generic_bytes:1;\n\tu32 checksum:1;\n\tu32 next_header:1;\n\tu32 length:1;\n\n\tu16 application_id;\n\tu16 rsvd1;\n\n\tu32 rsvd2[5];\n} __packed;\n\n\n \nstruct safexcel_result_desc {\n\tu32 particle_size:17;\n\tu8 rsvd0:3;\n\tu8 descriptor_overflow:1;\n\tu8 buffer_overflow:1;\n\tu8 last_seg:1;\n\tu8 first_seg:1;\n\tu16 result_size:8;\n\n\tu32 rsvd1;\n\n\tu32 data_lo;\n\tu32 data_hi;\n} __packed;\n\n \n#define EIP197_RD64_FETCH_SIZE\t\t(sizeof(struct safexcel_result_desc) /\\\n\t\t\t\t\t sizeof(u32))\n#define EIP197_RD64_RESULT_SIZE\t\t(sizeof(struct result_data_desc) /\\\n\t\t\t\t\t sizeof(u32))\n\nstruct safexcel_token {\n\tu32 packet_length:17;\n\tu8 stat:2;\n\tu16 instructions:9;\n\tu8 opcode:4;\n} __packed;\n\n#define EIP197_TOKEN_HASH_RESULT_VERIFY\t\tBIT(16)\n\n#define EIP197_TOKEN_CTX_OFFSET(x)\t\t(x)\n#define EIP197_TOKEN_DIRECTION_EXTERNAL\t\tBIT(11)\n#define EIP197_TOKEN_EXEC_IF_SUCCESSFUL\t\t(0x1 << 12)\n\n#define EIP197_TOKEN_STAT_LAST_HASH\t\tBIT(0)\n#define EIP197_TOKEN_STAT_LAST_PACKET\t\tBIT(1)\n#define EIP197_TOKEN_OPCODE_DIRECTION\t\t0x0\n#define EIP197_TOKEN_OPCODE_INSERT\t\t0x2\n#define EIP197_TOKEN_OPCODE_NOOP\t\tEIP197_TOKEN_OPCODE_INSERT\n#define EIP197_TOKEN_OPCODE_RETRIEVE\t\t0x4\n#define EIP197_TOKEN_OPCODE_INSERT_REMRES\t0xa\n#define EIP197_TOKEN_OPCODE_VERIFY\t\t0xd\n#define EIP197_TOKEN_OPCODE_CTX_ACCESS\t\t0xe\n#define EIP197_TOKEN_OPCODE_BYPASS\t\tGENMASK(3, 0)\n\nstatic inline void eip197_noop_token(struct safexcel_token *token)\n{\n\ttoken->opcode = EIP197_TOKEN_OPCODE_NOOP;\n\ttoken->packet_length = BIT(2);\n\ttoken->stat = 0;\n\ttoken->instructions = 0;\n}\n\n \n#define EIP197_TOKEN_INS_INSERT_HASH_DIGEST\t0x1c\n#define EIP197_TOKEN_INS_ORIGIN_IV0\t\t0x14\n#define EIP197_TOKEN_INS_ORIGIN_TOKEN\t\t0x1b\n#define EIP197_TOKEN_INS_ORIGIN_LEN(x)\t\t((x) << 5)\n#define EIP197_TOKEN_INS_TYPE_OUTPUT\t\tBIT(5)\n#define EIP197_TOKEN_INS_TYPE_HASH\t\tBIT(6)\n#define EIP197_TOKEN_INS_TYPE_CRYPTO\t\tBIT(7)\n#define EIP197_TOKEN_INS_LAST\t\t\tBIT(8)\n\n \nstruct safexcel_control_data_desc {\n\tu32 packet_length:17;\n\tu16 options:13;\n\tu8 type:2;\n\n\tu16 application_id;\n\tu16 rsvd;\n\n\tu32 context_lo;\n\tu32 context_hi;\n\n\tu32 control0;\n\tu32 control1;\n\n\tu32 token[EIP197_EMB_TOKENS];\n} __packed;\n\n#define EIP197_OPTION_MAGIC_VALUE\tBIT(0)\n#define EIP197_OPTION_64BIT_CTX\t\tBIT(1)\n#define EIP197_OPTION_RC_AUTO\t\t(0x2 << 3)\n#define EIP197_OPTION_CTX_CTRL_IN_CMD\tBIT(8)\n#define EIP197_OPTION_2_TOKEN_IV_CMD\tGENMASK(11, 10)\n#define EIP197_OPTION_4_TOKEN_IV_CMD\tGENMASK(11, 9)\n\n#define EIP197_TYPE_BCLA\t\t0x0\n#define EIP197_TYPE_EXTENDED\t\t0x3\n#define EIP197_CONTEXT_SMALL\t\t0x2\n#define EIP197_CONTEXT_SIZE_MASK\t0x3\n\n \nstruct safexcel_command_desc {\n\tu32 particle_size:17;\n\tu8 rsvd0:5;\n\tu8 last_seg:1;\n\tu8 first_seg:1;\n\tu8 additional_cdata_size:8;\n\n\tu32 rsvd1;\n\n\tu32 data_lo;\n\tu32 data_hi;\n\n\tu32 atok_lo;\n\tu32 atok_hi;\n\n\tstruct safexcel_control_data_desc control_data;\n} __packed;\n\n#define EIP197_CD64_FETCH_SIZE\t\t(sizeof(struct safexcel_command_desc) /\\\n\t\t\t\t\tsizeof(u32))\n\n \n\n#define EIP197_FW_TERMINAL_NOPS\t\t2\n#define EIP197_FW_START_POLLCNT\t\t16\n#define EIP197_FW_PUE_READY\t\t0x14\n#define EIP197_FW_FPP_READY\t\t0x18\n\nenum eip197_fw {\n\tFW_IFPP = 0,\n\tFW_IPUE,\n\tFW_NB\n};\n\nstruct safexcel_desc_ring {\n\tvoid *base;\n\tvoid *shbase;\n\tvoid *base_end;\n\tvoid *shbase_end;\n\tdma_addr_t base_dma;\n\tdma_addr_t shbase_dma;\n\n\t \n\tvoid *write;\n\tvoid *shwrite;\n\tvoid *read;\n\n\t \n\tunsigned int offset;\n\tunsigned int shoffset;\n};\n\nenum safexcel_alg_type {\n\tSAFEXCEL_ALG_TYPE_SKCIPHER,\n\tSAFEXCEL_ALG_TYPE_AEAD,\n\tSAFEXCEL_ALG_TYPE_AHASH,\n};\n\nstruct safexcel_config {\n\tu32 pes;\n\tu32 rings;\n\n\tu32 cd_size;\n\tu32 cd_offset;\n\tu32 cdsh_offset;\n\n\tu32 rd_size;\n\tu32 rd_offset;\n\tu32 res_offset;\n};\n\nstruct safexcel_work_data {\n\tstruct work_struct work;\n\tstruct safexcel_crypto_priv *priv;\n\tint ring;\n};\n\nstruct safexcel_ring {\n\tspinlock_t lock;\n\n\tstruct workqueue_struct *workqueue;\n\tstruct safexcel_work_data work_data;\n\n\t \n\tstruct safexcel_desc_ring cdr;\n\tstruct safexcel_desc_ring rdr;\n\n\t \n\tstruct crypto_async_request **rdr_req;\n\n\t \n\tstruct crypto_queue queue;\n\tspinlock_t queue_lock;\n\n\t \n\tint requests;\n\n\t \n\tbool busy;\n\n\t \n\tstruct crypto_async_request *req;\n\tstruct crypto_async_request *backlog;\n\n\t \n\tint irq;\n};\n\n \nenum safexcel_eip_version {\n\t \n\tEIP97IES_MRVL,\n\tEIP197B_MRVL,\n\tEIP197D_MRVL,\n\tEIP197_DEVBRD,\n\tEIP197C_MXL,\n};\n\nstruct safexcel_priv_data {\n\tenum safexcel_eip_version version;\n\tbool fw_little_endian;\n};\n\n \n#define SAFEXCEL_CRA_PRIORITY\t\t300\n\n \n#define EIP197_SM3_ZEROM_HASH\t\"\\x1A\\xB2\\x1D\\x83\\x55\\xCF\\xA1\\x7F\" \\\n\t\t\t\t\"\\x8E\\x61\\x19\\x48\\x31\\xE8\\x1A\\x8F\" \\\n\t\t\t\t\"\\x22\\xBE\\xC8\\xC7\\x28\\xFE\\xFB\\x74\" \\\n\t\t\t\t\"\\x7E\\xD0\\x35\\xEB\\x50\\x82\\xAA\\x2B\"\n\n \nenum safexcel_eip_algorithms {\n\tSAFEXCEL_ALG_BC0      = BIT(5),\n\tSAFEXCEL_ALG_SM4      = BIT(6),\n\tSAFEXCEL_ALG_SM3      = BIT(7),\n\tSAFEXCEL_ALG_CHACHA20 = BIT(8),\n\tSAFEXCEL_ALG_POLY1305 = BIT(9),\n\tSAFEXCEL_SEQMASK_256   = BIT(10),\n\tSAFEXCEL_SEQMASK_384   = BIT(11),\n\tSAFEXCEL_ALG_AES      = BIT(12),\n\tSAFEXCEL_ALG_AES_XFB  = BIT(13),\n\tSAFEXCEL_ALG_DES      = BIT(15),\n\tSAFEXCEL_ALG_DES_XFB  = BIT(16),\n\tSAFEXCEL_ALG_ARC4     = BIT(18),\n\tSAFEXCEL_ALG_AES_XTS  = BIT(20),\n\tSAFEXCEL_ALG_WIRELESS = BIT(21),\n\tSAFEXCEL_ALG_MD5      = BIT(22),\n\tSAFEXCEL_ALG_SHA1     = BIT(23),\n\tSAFEXCEL_ALG_SHA2_256 = BIT(25),\n\tSAFEXCEL_ALG_SHA2_512 = BIT(26),\n\tSAFEXCEL_ALG_XCBC_MAC = BIT(27),\n\tSAFEXCEL_ALG_CBC_MAC_ALL = BIT(29),\n\tSAFEXCEL_ALG_GHASH    = BIT(30),\n\tSAFEXCEL_ALG_SHA3     = BIT(31),\n};\n\nstruct safexcel_register_offsets {\n\tu32 hia_aic;\n\tu32 hia_aic_g;\n\tu32 hia_aic_r;\n\tu32 hia_aic_xdr;\n\tu32 hia_dfe;\n\tu32 hia_dfe_thr;\n\tu32 hia_dse;\n\tu32 hia_dse_thr;\n\tu32 hia_gen_cfg;\n\tu32 pe;\n\tu32 global;\n};\n\nenum safexcel_flags {\n\tEIP197_TRC_CACHE\t= BIT(0),\n\tSAFEXCEL_HW_EIP197\t= BIT(1),\n\tEIP197_PE_ARB\t\t= BIT(2),\n\tEIP197_ICE\t\t= BIT(3),\n\tEIP197_SIMPLE_TRC\t= BIT(4),\n\tEIP197_OCE\t\t= BIT(5),\n};\n\nstruct safexcel_hwconfig {\n\tenum safexcel_eip_algorithms algo_flags;\n\tint hwver;\n\tint hiaver;\n\tint ppver;\n\tint icever;\n\tint pever;\n\tint ocever;\n\tint psever;\n\tint hwdataw;\n\tint hwcfsize;\n\tint hwrfsize;\n\tint hwnumpes;\n\tint hwnumrings;\n\tint hwnumraic;\n};\n\nstruct safexcel_crypto_priv {\n\tvoid __iomem *base;\n\tstruct device *dev;\n\tstruct clk *clk;\n\tstruct clk *reg_clk;\n\tstruct safexcel_config config;\n\n\tstruct safexcel_priv_data *data;\n\tstruct safexcel_register_offsets offsets;\n\tstruct safexcel_hwconfig hwconfig;\n\tu32 flags;\n\n\t \n\tstruct dma_pool *context_pool;\n\n\tatomic_t ring_used;\n\n\tstruct safexcel_ring *ring;\n};\n\nstruct safexcel_context {\n\tint (*send)(struct crypto_async_request *req, int ring,\n\t\t    int *commands, int *results);\n\tint (*handle_result)(struct safexcel_crypto_priv *priv, int ring,\n\t\t\t     struct crypto_async_request *req, bool *complete,\n\t\t\t     int *ret);\n\tstruct safexcel_context_record *ctxr;\n\tstruct safexcel_crypto_priv *priv;\n\tdma_addr_t ctxr_dma;\n\n\tunion {\n\t\t__le32 le[SHA3_512_BLOCK_SIZE / 4];\n\t\t__be32 be[SHA3_512_BLOCK_SIZE / 4];\n\t\tu32 word[SHA3_512_BLOCK_SIZE / 4];\n\t\tu8 byte[SHA3_512_BLOCK_SIZE];\n\t} ipad, opad;\n\n\tint ring;\n\tbool needs_inv;\n\tbool exit_inv;\n};\n\n#define HASH_CACHE_SIZE\t\t\tSHA512_BLOCK_SIZE\n\nstruct safexcel_ahash_export_state {\n\tu64 len;\n\tu64 processed;\n\n\tu32 digest;\n\n\tu32 state[SHA512_DIGEST_SIZE / sizeof(u32)];\n\tu8 cache[HASH_CACHE_SIZE];\n};\n\n \nstruct safexcel_alg_template {\n\tstruct safexcel_crypto_priv *priv;\n\tenum safexcel_alg_type type;\n\tenum safexcel_eip_algorithms algo_mask;\n\tunion {\n\t\tstruct skcipher_alg skcipher;\n\t\tstruct aead_alg aead;\n\t\tstruct ahash_alg ahash;\n\t} alg;\n};\n\nvoid safexcel_dequeue(struct safexcel_crypto_priv *priv, int ring);\nint safexcel_rdesc_check_errors(struct safexcel_crypto_priv *priv,\n\t\t\t\tvoid *rdp);\nvoid safexcel_complete(struct safexcel_crypto_priv *priv, int ring);\nint safexcel_invalidate_cache(struct crypto_async_request *async,\n\t\t\t      struct safexcel_crypto_priv *priv,\n\t\t\t      dma_addr_t ctxr_dma, int ring);\nint safexcel_init_ring_descriptors(struct safexcel_crypto_priv *priv,\n\t\t\t\t   struct safexcel_desc_ring *cdr,\n\t\t\t\t   struct safexcel_desc_ring *rdr);\nint safexcel_select_ring(struct safexcel_crypto_priv *priv);\nvoid *safexcel_ring_next_rptr(struct safexcel_crypto_priv *priv,\n\t\t\t      struct safexcel_desc_ring *ring);\nvoid *safexcel_ring_first_rptr(struct safexcel_crypto_priv *priv, int  ring);\nvoid safexcel_ring_rollback_wptr(struct safexcel_crypto_priv *priv,\n\t\t\t\t struct safexcel_desc_ring *ring);\nstruct safexcel_command_desc *safexcel_add_cdesc(struct safexcel_crypto_priv *priv,\n\t\t\t\t\t\t int ring_id,\n\t\t\t\t\t\t bool first, bool last,\n\t\t\t\t\t\t dma_addr_t data, u32 len,\n\t\t\t\t\t\t u32 full_data_len,\n\t\t\t\t\t\t dma_addr_t context,\n\t\t\t\t\t\t struct safexcel_token **atoken);\nstruct safexcel_result_desc *safexcel_add_rdesc(struct safexcel_crypto_priv *priv,\n\t\t\t\t\t\t int ring_id,\n\t\t\t\t\t\tbool first, bool last,\n\t\t\t\t\t\tdma_addr_t data, u32 len);\nint safexcel_ring_first_rdr_index(struct safexcel_crypto_priv *priv,\n\t\t\t\t  int ring);\nint safexcel_ring_rdr_rdesc_index(struct safexcel_crypto_priv *priv,\n\t\t\t\t  int ring,\n\t\t\t\t  struct safexcel_result_desc *rdesc);\nvoid safexcel_rdr_req_set(struct safexcel_crypto_priv *priv,\n\t\t\t  int ring,\n\t\t\t  struct safexcel_result_desc *rdesc,\n\t\t\t  struct crypto_async_request *req);\ninline struct crypto_async_request *\nsafexcel_rdr_req_get(struct safexcel_crypto_priv *priv, int ring);\nint safexcel_hmac_setkey(struct safexcel_context *base, const u8 *key,\n\t\t\t unsigned int keylen, const char *alg,\n\t\t\t unsigned int state_sz);\n\n \nextern struct safexcel_alg_template safexcel_alg_ecb_des;\nextern struct safexcel_alg_template safexcel_alg_cbc_des;\nextern struct safexcel_alg_template safexcel_alg_ecb_des3_ede;\nextern struct safexcel_alg_template safexcel_alg_cbc_des3_ede;\nextern struct safexcel_alg_template safexcel_alg_ecb_aes;\nextern struct safexcel_alg_template safexcel_alg_cbc_aes;\nextern struct safexcel_alg_template safexcel_alg_cfb_aes;\nextern struct safexcel_alg_template safexcel_alg_ofb_aes;\nextern struct safexcel_alg_template safexcel_alg_ctr_aes;\nextern struct safexcel_alg_template safexcel_alg_md5;\nextern struct safexcel_alg_template safexcel_alg_sha1;\nextern struct safexcel_alg_template safexcel_alg_sha224;\nextern struct safexcel_alg_template safexcel_alg_sha256;\nextern struct safexcel_alg_template safexcel_alg_sha384;\nextern struct safexcel_alg_template safexcel_alg_sha512;\nextern struct safexcel_alg_template safexcel_alg_hmac_md5;\nextern struct safexcel_alg_template safexcel_alg_hmac_sha1;\nextern struct safexcel_alg_template safexcel_alg_hmac_sha224;\nextern struct safexcel_alg_template safexcel_alg_hmac_sha256;\nextern struct safexcel_alg_template safexcel_alg_hmac_sha384;\nextern struct safexcel_alg_template safexcel_alg_hmac_sha512;\nextern struct safexcel_alg_template safexcel_alg_authenc_hmac_sha1_cbc_aes;\nextern struct safexcel_alg_template safexcel_alg_authenc_hmac_sha224_cbc_aes;\nextern struct safexcel_alg_template safexcel_alg_authenc_hmac_sha256_cbc_aes;\nextern struct safexcel_alg_template safexcel_alg_authenc_hmac_sha384_cbc_aes;\nextern struct safexcel_alg_template safexcel_alg_authenc_hmac_sha512_cbc_aes;\nextern struct safexcel_alg_template safexcel_alg_authenc_hmac_sha1_cbc_des3_ede;\nextern struct safexcel_alg_template safexcel_alg_authenc_hmac_sha1_ctr_aes;\nextern struct safexcel_alg_template safexcel_alg_authenc_hmac_sha224_ctr_aes;\nextern struct safexcel_alg_template safexcel_alg_authenc_hmac_sha256_ctr_aes;\nextern struct safexcel_alg_template safexcel_alg_authenc_hmac_sha384_ctr_aes;\nextern struct safexcel_alg_template safexcel_alg_authenc_hmac_sha512_ctr_aes;\nextern struct safexcel_alg_template safexcel_alg_xts_aes;\nextern struct safexcel_alg_template safexcel_alg_gcm;\nextern struct safexcel_alg_template safexcel_alg_ccm;\nextern struct safexcel_alg_template safexcel_alg_crc32;\nextern struct safexcel_alg_template safexcel_alg_cbcmac;\nextern struct safexcel_alg_template safexcel_alg_xcbcmac;\nextern struct safexcel_alg_template safexcel_alg_cmac;\nextern struct safexcel_alg_template safexcel_alg_chacha20;\nextern struct safexcel_alg_template safexcel_alg_chachapoly;\nextern struct safexcel_alg_template safexcel_alg_chachapoly_esp;\nextern struct safexcel_alg_template safexcel_alg_sm3;\nextern struct safexcel_alg_template safexcel_alg_hmac_sm3;\nextern struct safexcel_alg_template safexcel_alg_ecb_sm4;\nextern struct safexcel_alg_template safexcel_alg_cbc_sm4;\nextern struct safexcel_alg_template safexcel_alg_ofb_sm4;\nextern struct safexcel_alg_template safexcel_alg_cfb_sm4;\nextern struct safexcel_alg_template safexcel_alg_ctr_sm4;\nextern struct safexcel_alg_template safexcel_alg_authenc_hmac_sha1_cbc_sm4;\nextern struct safexcel_alg_template safexcel_alg_authenc_hmac_sm3_cbc_sm4;\nextern struct safexcel_alg_template safexcel_alg_authenc_hmac_sha1_ctr_sm4;\nextern struct safexcel_alg_template safexcel_alg_authenc_hmac_sm3_ctr_sm4;\nextern struct safexcel_alg_template safexcel_alg_sha3_224;\nextern struct safexcel_alg_template safexcel_alg_sha3_256;\nextern struct safexcel_alg_template safexcel_alg_sha3_384;\nextern struct safexcel_alg_template safexcel_alg_sha3_512;\nextern struct safexcel_alg_template safexcel_alg_hmac_sha3_224;\nextern struct safexcel_alg_template safexcel_alg_hmac_sha3_256;\nextern struct safexcel_alg_template safexcel_alg_hmac_sha3_384;\nextern struct safexcel_alg_template safexcel_alg_hmac_sha3_512;\nextern struct safexcel_alg_template safexcel_alg_authenc_hmac_sha1_cbc_des;\nextern struct safexcel_alg_template safexcel_alg_authenc_hmac_sha256_cbc_des3_ede;\nextern struct safexcel_alg_template safexcel_alg_authenc_hmac_sha224_cbc_des3_ede;\nextern struct safexcel_alg_template safexcel_alg_authenc_hmac_sha512_cbc_des3_ede;\nextern struct safexcel_alg_template safexcel_alg_authenc_hmac_sha384_cbc_des3_ede;\nextern struct safexcel_alg_template safexcel_alg_authenc_hmac_sha256_cbc_des;\nextern struct safexcel_alg_template safexcel_alg_authenc_hmac_sha224_cbc_des;\nextern struct safexcel_alg_template safexcel_alg_authenc_hmac_sha512_cbc_des;\nextern struct safexcel_alg_template safexcel_alg_authenc_hmac_sha384_cbc_des;\nextern struct safexcel_alg_template safexcel_alg_rfc4106_gcm;\nextern struct safexcel_alg_template safexcel_alg_rfc4543_gcm;\nextern struct safexcel_alg_template safexcel_alg_rfc4309_ccm;\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}