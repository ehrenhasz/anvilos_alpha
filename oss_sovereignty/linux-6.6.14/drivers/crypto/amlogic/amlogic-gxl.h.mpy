{
  "module_name": "amlogic-gxl.h",
  "hash_id": "4098a102ffe218b2d89ea817e46dc4103e93fdc9d78a713d12452bc7cc83f11a",
  "original_prompt": "Ingested from linux-6.6.14/drivers/crypto/amlogic/amlogic-gxl.h",
  "human_readable_source": " \n \n#include <crypto/aes.h>\n#include <crypto/engine.h>\n#include <crypto/skcipher.h>\n#include <linux/debugfs.h>\n#include <linux/crypto.h>\n#include <linux/scatterlist.h>\n\n#define MODE_KEY 1\n#define MODE_AES_128 0x8\n#define MODE_AES_192 0x9\n#define MODE_AES_256 0xa\n\n#define MESON_DECRYPT 0\n#define MESON_ENCRYPT 1\n\n#define MESON_OPMODE_ECB 0\n#define MESON_OPMODE_CBC 1\n\n#define MAXFLOW 2\n\n#define MAXDESC 64\n\n#define DESC_LAST BIT(18)\n#define DESC_ENCRYPTION BIT(28)\n#define DESC_OWN BIT(31)\n\n \nstruct meson_desc {\n\t__le32 t_status;\n\t__le32 t_src;\n\t__le32 t_dst;\n};\n\n \nstruct meson_flow {\n\tstruct crypto_engine *engine;\n\tstruct completion complete;\n\tint status;\n\tunsigned int keylen;\n\tdma_addr_t t_phy;\n\tstruct meson_desc *tl;\n#ifdef CONFIG_CRYPTO_DEV_AMLOGIC_GXL_DEBUG\n\tunsigned long stat_req;\n#endif\n};\n\n \nstruct meson_dev {\n\tvoid __iomem *base;\n\tstruct clk *busclk;\n\tstruct device *dev;\n\tstruct meson_flow *chanlist;\n\tatomic_t flow;\n\tint irqs[MAXFLOW];\n#ifdef CONFIG_CRYPTO_DEV_AMLOGIC_GXL_DEBUG\n\tstruct dentry *dbgfs_dir;\n#endif\n};\n\n \nstruct meson_cipher_req_ctx {\n\tu32 op_dir;\n\tint flow;\n\tstruct skcipher_request fallback_req;\t\n};\n\n \nstruct meson_cipher_tfm_ctx {\n\tu32 *key;\n\tu32 keylen;\n\tu32 keymode;\n\tstruct meson_dev *mc;\n\tstruct crypto_skcipher *fallback_tfm;\n};\n\n \nstruct meson_alg_template {\n\tu32 type;\n\tu32 blockmode;\n\tunion {\n\t\tstruct skcipher_engine_alg skcipher;\n\t} alg;\n\tstruct meson_dev *mc;\n#ifdef CONFIG_CRYPTO_DEV_AMLOGIC_GXL_DEBUG\n\tunsigned long stat_req;\n\tunsigned long stat_fb;\n#endif\n};\n\nint meson_enqueue(struct crypto_async_request *areq, u32 type);\n\nint meson_aes_setkey(struct crypto_skcipher *tfm, const u8 *key,\n\t\t     unsigned int keylen);\nint meson_cipher_init(struct crypto_tfm *tfm);\nvoid meson_cipher_exit(struct crypto_tfm *tfm);\nint meson_skdecrypt(struct skcipher_request *areq);\nint meson_skencrypt(struct skcipher_request *areq);\nint meson_handle_cipher_request(struct crypto_engine *engine, void *areq);\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}