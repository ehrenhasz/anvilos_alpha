{
  "module_name": "vmx.c",
  "hash_id": "f706be490559d0f130eac4a5b7050f83344f8151785110b6db779cf10819f714",
  "original_prompt": "Ingested from linux-6.6.14/drivers/crypto/vmx/vmx.c",
  "human_readable_source": "\n \n\n#include <linux/module.h>\n#include <linux/moduleparam.h>\n#include <linux/types.h>\n#include <linux/err.h>\n#include <linux/cpufeature.h>\n#include <linux/crypto.h>\n#include <asm/cputable.h>\n#include <crypto/internal/hash.h>\n#include <crypto/internal/skcipher.h>\n\n#include \"aesp8-ppc.h\"\n\nstatic int __init p8_init(void)\n{\n\tint ret;\n\n\tret = crypto_register_shash(&p8_ghash_alg);\n\tif (ret)\n\t\tgoto err;\n\n\tret = crypto_register_alg(&p8_aes_alg);\n\tif (ret)\n\t\tgoto err_unregister_ghash;\n\n\tret = crypto_register_skcipher(&p8_aes_cbc_alg);\n\tif (ret)\n\t\tgoto err_unregister_aes;\n\n\tret = crypto_register_skcipher(&p8_aes_ctr_alg);\n\tif (ret)\n\t\tgoto err_unregister_aes_cbc;\n\n\tret = crypto_register_skcipher(&p8_aes_xts_alg);\n\tif (ret)\n\t\tgoto err_unregister_aes_ctr;\n\n\treturn 0;\n\nerr_unregister_aes_ctr:\n\tcrypto_unregister_skcipher(&p8_aes_ctr_alg);\nerr_unregister_aes_cbc:\n\tcrypto_unregister_skcipher(&p8_aes_cbc_alg);\nerr_unregister_aes:\n\tcrypto_unregister_alg(&p8_aes_alg);\nerr_unregister_ghash:\n\tcrypto_unregister_shash(&p8_ghash_alg);\nerr:\n\treturn ret;\n}\n\nstatic void __exit p8_exit(void)\n{\n\tcrypto_unregister_skcipher(&p8_aes_xts_alg);\n\tcrypto_unregister_skcipher(&p8_aes_ctr_alg);\n\tcrypto_unregister_skcipher(&p8_aes_cbc_alg);\n\tcrypto_unregister_alg(&p8_aes_alg);\n\tcrypto_unregister_shash(&p8_ghash_alg);\n}\n\nmodule_cpu_feature_match(PPC_MODULE_FEATURE_VEC_CRYPTO, p8_init);\nmodule_exit(p8_exit);\n\nMODULE_AUTHOR(\"Marcelo Cerri<mhcerri@br.ibm.com>\");\nMODULE_DESCRIPTION(\"IBM VMX cryptographic acceleration instructions \"\n\t\t   \"support on Power 8\");\nMODULE_LICENSE(\"GPL\");\nMODULE_VERSION(\"1.0.0\");\nMODULE_IMPORT_NS(CRYPTO_INTERNAL);\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}