{
  "module_name": "adf_gen4_dc.c",
  "hash_id": "0b9047c49e3519302274d5a57fb6cbf9d813bf0adacc51b5cbd70482320b8038",
  "original_prompt": "Ingested from linux-6.6.14/drivers/crypto/intel/qat/qat_common/adf_gen4_dc.c",
  "human_readable_source": "\n \n#include \"adf_accel_devices.h\"\n#include \"icp_qat_fw_comp.h\"\n#include \"icp_qat_hw_20_comp.h\"\n#include \"adf_gen4_dc.h\"\n\nstatic void qat_comp_build_deflate(void *ctx)\n{\n\tstruct icp_qat_fw_comp_req *req_tmpl =\n\t\t\t\t(struct icp_qat_fw_comp_req *)ctx;\n\tstruct icp_qat_fw_comn_req_hdr *header = &req_tmpl->comn_hdr;\n\tstruct icp_qat_fw_comp_req_hdr_cd_pars *cd_pars = &req_tmpl->cd_pars;\n\tstruct icp_qat_fw_comp_req_params *req_pars = &req_tmpl->comp_pars;\n\tstruct icp_qat_hw_comp_20_config_csr_upper hw_comp_upper_csr = {0};\n\tstruct icp_qat_hw_comp_20_config_csr_lower hw_comp_lower_csr = {0};\n\tstruct icp_qat_hw_decomp_20_config_csr_lower hw_decomp_lower_csr = {0};\n\tu32 upper_val;\n\tu32 lower_val;\n\n\tmemset(req_tmpl, 0, sizeof(*req_tmpl));\n\theader->hdr_flags =\n\t\tICP_QAT_FW_COMN_HDR_FLAGS_BUILD(ICP_QAT_FW_COMN_REQ_FLAG_SET);\n\theader->service_type = ICP_QAT_FW_COMN_REQ_CPM_FW_COMP;\n\theader->service_cmd_id = ICP_QAT_FW_COMP_CMD_STATIC;\n\theader->comn_req_flags =\n\t\tICP_QAT_FW_COMN_FLAGS_BUILD(QAT_COMN_CD_FLD_TYPE_16BYTE_DATA,\n\t\t\t\t\t    QAT_COMN_PTR_TYPE_SGL);\n\theader->serv_specif_flags =\n\t\tICP_QAT_FW_COMP_FLAGS_BUILD(ICP_QAT_FW_COMP_STATELESS_SESSION,\n\t\t\t\t\t    ICP_QAT_FW_COMP_AUTO_SELECT_BEST,\n\t\t\t\t\t    ICP_QAT_FW_COMP_NOT_ENH_AUTO_SELECT_BEST,\n\t\t\t\t\t    ICP_QAT_FW_COMP_NOT_DISABLE_TYPE0_ENH_AUTO_SELECT_BEST,\n\t\t\t\t\t    ICP_QAT_FW_COMP_ENABLE_SECURE_RAM_USED_AS_INTMD_BUF);\n\thw_comp_lower_csr.skip_ctrl = ICP_QAT_HW_COMP_20_BYTE_SKIP_3BYTE_LITERAL;\n\thw_comp_lower_csr.algo = ICP_QAT_HW_COMP_20_HW_COMP_FORMAT_ILZ77;\n\thw_comp_lower_csr.lllbd = ICP_QAT_HW_COMP_20_LLLBD_CTRL_LLLBD_ENABLED;\n\thw_comp_lower_csr.sd = ICP_QAT_HW_COMP_20_SEARCH_DEPTH_LEVEL_1;\n\thw_comp_lower_csr.hash_update = ICP_QAT_HW_COMP_20_SKIP_HASH_UPDATE_DONT_ALLOW;\n\thw_comp_lower_csr.edmm = ICP_QAT_HW_COMP_20_EXTENDED_DELAY_MATCH_MODE_EDMM_ENABLED;\n\thw_comp_upper_csr.nice = ICP_QAT_HW_COMP_20_CONFIG_CSR_NICE_PARAM_DEFAULT_VAL;\n\thw_comp_upper_csr.lazy = ICP_QAT_HW_COMP_20_CONFIG_CSR_LAZY_PARAM_DEFAULT_VAL;\n\n\tupper_val = ICP_QAT_FW_COMP_20_BUILD_CONFIG_UPPER(hw_comp_upper_csr);\n\tlower_val = ICP_QAT_FW_COMP_20_BUILD_CONFIG_LOWER(hw_comp_lower_csr);\n\n\tcd_pars->u.sl.comp_slice_cfg_word[0] = lower_val;\n\tcd_pars->u.sl.comp_slice_cfg_word[1] = upper_val;\n\n\treq_pars->crc.legacy.initial_adler = COMP_CPR_INITIAL_ADLER;\n\treq_pars->crc.legacy.initial_crc32 = COMP_CPR_INITIAL_CRC;\n\treq_pars->req_par_flags =\n\t\tICP_QAT_FW_COMP_REQ_PARAM_FLAGS_BUILD(ICP_QAT_FW_COMP_SOP,\n\t\t\t\t\t\t      ICP_QAT_FW_COMP_EOP,\n\t\t\t\t\t\t      ICP_QAT_FW_COMP_BFINAL,\n\t\t\t\t\t\t      ICP_QAT_FW_COMP_CNV,\n\t\t\t\t\t\t      ICP_QAT_FW_COMP_CNV_RECOVERY,\n\t\t\t\t\t\t      ICP_QAT_FW_COMP_NO_CNV_DFX,\n\t\t\t\t\t\t      ICP_QAT_FW_COMP_CRC_MODE_LEGACY,\n\t\t\t\t\t\t      ICP_QAT_FW_COMP_NO_XXHASH_ACC,\n\t\t\t\t\t\t      ICP_QAT_FW_COMP_CNV_ERROR_NONE,\n\t\t\t\t\t\t      ICP_QAT_FW_COMP_NO_APPEND_CRC,\n\t\t\t\t\t\t      ICP_QAT_FW_COMP_NO_DROP_DATA);\n\n\t \n\tmemcpy(req_tmpl + 1, req_tmpl, sizeof(*req_tmpl));\n\treq_tmpl++;\n\theader = &req_tmpl->comn_hdr;\n\theader->service_cmd_id = ICP_QAT_FW_COMP_CMD_DECOMPRESS;\n\tcd_pars = &req_tmpl->cd_pars;\n\n\thw_decomp_lower_csr.algo = ICP_QAT_HW_DECOMP_20_HW_DECOMP_FORMAT_DEFLATE;\n\tlower_val = ICP_QAT_FW_DECOMP_20_BUILD_CONFIG_LOWER(hw_decomp_lower_csr);\n\n\tcd_pars->u.sl.comp_slice_cfg_word[0] = lower_val;\n\tcd_pars->u.sl.comp_slice_cfg_word[1] = 0;\n}\n\nvoid adf_gen4_init_dc_ops(struct adf_dc_ops *dc_ops)\n{\n\tdc_ops->build_deflate_ctx = qat_comp_build_deflate;\n}\nEXPORT_SYMBOL_GPL(adf_gen4_init_dc_ops);\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}