{
  "module_name": "icp_qat_uclo.h",
  "hash_id": "f7a9852c564621c1b7005bbc948dacf0bf58a9ba8c46e36361e84e4bde551f1b",
  "original_prompt": "Ingested from linux-6.6.14/drivers/crypto/intel/qat/qat_common/icp_qat_uclo.h",
  "human_readable_source": " \n \n#ifndef __ICP_QAT_UCLO_H__\n#define __ICP_QAT_UCLO_H__\n\n#define ICP_QAT_AC_895XCC_DEV_TYPE 0x00400000\n#define ICP_QAT_AC_C62X_DEV_TYPE   0x01000000\n#define ICP_QAT_AC_C3XXX_DEV_TYPE  0x02000000\n#define ICP_QAT_AC_4XXX_A_DEV_TYPE 0x08000000\n#define ICP_QAT_UCLO_MAX_AE       12\n#define ICP_QAT_UCLO_MAX_CTX      8\n#define ICP_QAT_UCLO_MAX_UIMAGE   (ICP_QAT_UCLO_MAX_AE * ICP_QAT_UCLO_MAX_CTX)\n#define ICP_QAT_UCLO_MAX_USTORE   0x4000\n#define ICP_QAT_UCLO_MAX_XFER_REG 128\n#define ICP_QAT_UCLO_MAX_GPR_REG  128\n#define ICP_QAT_UCLO_MAX_LMEM_REG 1024\n#define ICP_QAT_UCLO_MAX_LMEM_REG_2X 1280\n#define ICP_QAT_UCLO_AE_ALL_CTX   0xff\n#define ICP_QAT_UOF_OBJID_LEN     8\n#define ICP_QAT_UOF_FID 0xc6c2\n#define ICP_QAT_UOF_MAJVER 0x4\n#define ICP_QAT_UOF_MINVER 0x11\n#define ICP_QAT_UOF_OBJS        \"UOF_OBJS\"\n#define ICP_QAT_UOF_STRT        \"UOF_STRT\"\n#define ICP_QAT_UOF_IMAG        \"UOF_IMAG\"\n#define ICP_QAT_UOF_IMEM        \"UOF_IMEM\"\n#define ICP_QAT_UOF_LOCAL_SCOPE     1\n#define ICP_QAT_UOF_INIT_EXPR               0\n#define ICP_QAT_UOF_INIT_REG                1\n#define ICP_QAT_UOF_INIT_REG_CTX            2\n#define ICP_QAT_UOF_INIT_EXPR_ENDIAN_SWAP   3\n#define ICP_QAT_SUOF_OBJ_ID_LEN             8\n#define ICP_QAT_SUOF_FID  0x53554f46\n#define ICP_QAT_SUOF_MAJVER 0x0\n#define ICP_QAT_SUOF_MINVER 0x1\n#define ICP_QAT_SUOF_OBJ_NAME_LEN 128\n#define ICP_QAT_MOF_OBJ_ID_LEN 8\n#define ICP_QAT_MOF_OBJ_CHUNKID_LEN 8\n#define ICP_QAT_MOF_FID 0x00666f6d\n#define ICP_QAT_MOF_MAJVER 0x0\n#define ICP_QAT_MOF_MINVER 0x1\n#define ICP_QAT_MOF_SYM_OBJS \"SYM_OBJS\"\n#define ICP_QAT_SUOF_OBJS \"SUF_OBJS\"\n#define ICP_QAT_SUOF_IMAG \"SUF_IMAG\"\n#define ICP_QAT_SIMG_AE_INIT_SEQ_LEN    (50 * sizeof(unsigned long long))\n#define ICP_QAT_SIMG_AE_INSTS_LEN       (0x4000 * sizeof(unsigned long long))\n\n#define DSS_FWSK_MODULUS_LEN    384  \n#define DSS_FWSK_EXPONENT_LEN   4\n#define DSS_FWSK_PADDING_LEN    380\n#define DSS_SIGNATURE_LEN       384  \n\n#define CSS_FWSK_MODULUS_LEN    256  \n#define CSS_FWSK_EXPONENT_LEN   4\n#define CSS_FWSK_PADDING_LEN    252\n#define CSS_SIGNATURE_LEN       256  \n\n#define ICP_QAT_CSS_FWSK_MODULUS_LEN(handle)\t((handle)->chip_info->css_3k ? \\\n\t\t\t\t\t\tDSS_FWSK_MODULUS_LEN  : \\\n\t\t\t\t\t\tCSS_FWSK_MODULUS_LEN)\n\n#define ICP_QAT_CSS_FWSK_EXPONENT_LEN(handle)\t((handle)->chip_info->css_3k ? \\\n\t\t\t\t\t\tDSS_FWSK_EXPONENT_LEN : \\\n\t\t\t\t\t\tCSS_FWSK_EXPONENT_LEN)\n\n#define ICP_QAT_CSS_FWSK_PAD_LEN(handle)\t((handle)->chip_info->css_3k ? \\\n\t\t\t\t\t\tDSS_FWSK_PADDING_LEN : \\\n\t\t\t\t\t\tCSS_FWSK_PADDING_LEN)\n\n#define ICP_QAT_CSS_FWSK_PUB_LEN(handle)\t(ICP_QAT_CSS_FWSK_MODULUS_LEN(handle) + \\\n\t\t\t\t\t\tICP_QAT_CSS_FWSK_EXPONENT_LEN(handle) + \\\n\t\t\t\t\t\tICP_QAT_CSS_FWSK_PAD_LEN(handle))\n\n#define ICP_QAT_CSS_SIGNATURE_LEN(handle)\t((handle)->chip_info->css_3k ? \\\n\t\t\t\t\t\tDSS_SIGNATURE_LEN : \\\n\t\t\t\t\t\tCSS_SIGNATURE_LEN)\n\n#define ICP_QAT_CSS_AE_IMG_LEN     (sizeof(struct icp_qat_simg_ae_mode) + \\\n\t\t\t\t    ICP_QAT_SIMG_AE_INIT_SEQ_LEN +         \\\n\t\t\t\t    ICP_QAT_SIMG_AE_INSTS_LEN)\n#define ICP_QAT_CSS_AE_SIMG_LEN(handle) (sizeof(struct icp_qat_css_hdr) + \\\n\t\t\t\t\tICP_QAT_CSS_FWSK_PUB_LEN(handle) + \\\n\t\t\t\t\tICP_QAT_CSS_SIGNATURE_LEN(handle) + \\\n\t\t\t\t\tICP_QAT_CSS_AE_IMG_LEN)\n#define ICP_QAT_AE_IMG_OFFSET(handle) (sizeof(struct icp_qat_css_hdr) + \\\n\t\t\t\t\tICP_QAT_CSS_FWSK_MODULUS_LEN(handle) + \\\n\t\t\t\t\tICP_QAT_CSS_FWSK_EXPONENT_LEN(handle) + \\\n\t\t\t\t\tICP_QAT_CSS_SIGNATURE_LEN(handle))\n#define ICP_QAT_CSS_RSA4K_MAX_IMAGE_LEN    0x40000\n#define ICP_QAT_CSS_RSA3K_MAX_IMAGE_LEN    0x30000\n\n#define ICP_QAT_CTX_MODE(ae_mode) ((ae_mode) & 0xf)\n#define ICP_QAT_NN_MODE(ae_mode) (((ae_mode) >> 0x4) & 0xf)\n#define ICP_QAT_SHARED_USTORE_MODE(ae_mode) (((ae_mode) >> 0xb) & 0x1)\n#define RELOADABLE_CTX_SHARED_MODE(ae_mode) (((ae_mode) >> 0xc) & 0x1)\n\n#define ICP_QAT_LOC_MEM0_MODE(ae_mode) (((ae_mode) >> 0x8) & 0x1)\n#define ICP_QAT_LOC_MEM1_MODE(ae_mode) (((ae_mode) >> 0x9) & 0x1)\n#define ICP_QAT_LOC_MEM2_MODE(ae_mode) (((ae_mode) >> 0x6) & 0x1)\n#define ICP_QAT_LOC_MEM3_MODE(ae_mode) (((ae_mode) >> 0x7) & 0x1)\n#define ICP_QAT_LOC_TINDEX_MODE(ae_mode) (((ae_mode) >> 0xe) & 0x1)\n\nenum icp_qat_uof_mem_region {\n\tICP_QAT_UOF_SRAM_REGION = 0x0,\n\tICP_QAT_UOF_LMEM_REGION = 0x3,\n\tICP_QAT_UOF_UMEM_REGION = 0x5\n};\n\nenum icp_qat_uof_regtype {\n\tICP_NO_DEST\t= 0,\n\tICP_GPA_REL\t= 1,\n\tICP_GPA_ABS\t= 2,\n\tICP_GPB_REL\t= 3,\n\tICP_GPB_ABS\t= 4,\n\tICP_SR_REL\t= 5,\n\tICP_SR_RD_REL\t= 6,\n\tICP_SR_WR_REL\t= 7,\n\tICP_SR_ABS\t= 8,\n\tICP_SR_RD_ABS\t= 9,\n\tICP_SR_WR_ABS\t= 10,\n\tICP_DR_REL\t= 19,\n\tICP_DR_RD_REL\t= 20,\n\tICP_DR_WR_REL\t= 21,\n\tICP_DR_ABS\t= 22,\n\tICP_DR_RD_ABS\t= 23,\n\tICP_DR_WR_ABS\t= 24,\n\tICP_LMEM\t= 26,\n\tICP_LMEM0\t= 27,\n\tICP_LMEM1\t= 28,\n\tICP_NEIGH_REL\t= 31,\n\tICP_LMEM2\t= 61,\n\tICP_LMEM3\t= 62,\n};\n\nenum icp_qat_css_fwtype {\n\tCSS_AE_FIRMWARE = 0,\n\tCSS_MMP_FIRMWARE = 1\n};\n\nstruct icp_qat_uclo_page {\n\tstruct icp_qat_uclo_encap_page *encap_page;\n\tstruct icp_qat_uclo_region *region;\n\tunsigned int flags;\n};\n\nstruct icp_qat_uclo_region {\n\tstruct icp_qat_uclo_page *loaded;\n\tstruct icp_qat_uclo_page *page;\n};\n\nstruct icp_qat_uclo_aeslice {\n\tstruct icp_qat_uclo_region *region;\n\tstruct icp_qat_uclo_page *page;\n\tstruct icp_qat_uclo_page *cur_page[ICP_QAT_UCLO_MAX_CTX];\n\tstruct icp_qat_uclo_encapme *encap_image;\n\tunsigned int ctx_mask_assigned;\n\tunsigned int new_uaddr[ICP_QAT_UCLO_MAX_CTX];\n};\n\nstruct icp_qat_uclo_aedata {\n\tunsigned int slice_num;\n\tunsigned int eff_ustore_size;\n\tstruct icp_qat_uclo_aeslice ae_slices[ICP_QAT_UCLO_MAX_CTX];\n};\n\nstruct icp_qat_uof_encap_obj {\n\tchar *beg_uof;\n\tstruct icp_qat_uof_objhdr *obj_hdr;\n\tstruct icp_qat_uof_chunkhdr *chunk_hdr;\n\tstruct icp_qat_uof_varmem_seg *var_mem_seg;\n};\n\nstruct icp_qat_uclo_encap_uwblock {\n\tunsigned int start_addr;\n\tunsigned int words_num;\n\tu64 micro_words;\n};\n\nstruct icp_qat_uclo_encap_page {\n\tunsigned int def_page;\n\tunsigned int page_region;\n\tunsigned int beg_addr_v;\n\tunsigned int beg_addr_p;\n\tunsigned int micro_words_num;\n\tunsigned int uwblock_num;\n\tstruct icp_qat_uclo_encap_uwblock *uwblock;\n};\n\nstruct icp_qat_uclo_encapme {\n\tstruct icp_qat_uof_image *img_ptr;\n\tstruct icp_qat_uclo_encap_page *page;\n\tunsigned int ae_reg_num;\n\tstruct icp_qat_uof_ae_reg *ae_reg;\n\tunsigned int init_regsym_num;\n\tstruct icp_qat_uof_init_regsym *init_regsym;\n\tunsigned int sbreak_num;\n\tstruct icp_qat_uof_sbreak *sbreak;\n\tunsigned int uwords_num;\n};\n\nstruct icp_qat_uclo_init_mem_table {\n\tunsigned int entry_num;\n\tstruct icp_qat_uof_initmem *init_mem;\n};\n\nstruct icp_qat_uclo_objhdr {\n\tchar *file_buff;\n\tunsigned int checksum;\n\tunsigned int size;\n};\n\nstruct icp_qat_uof_strtable {\n\tunsigned int table_len;\n\tunsigned int reserved;\n\tu64 strings;\n};\n\nstruct icp_qat_uclo_objhandle {\n\tunsigned int prod_type;\n\tunsigned int prod_rev;\n\tstruct icp_qat_uclo_objhdr *obj_hdr;\n\tstruct icp_qat_uof_encap_obj encap_uof_obj;\n\tstruct icp_qat_uof_strtable str_table;\n\tstruct icp_qat_uclo_encapme ae_uimage[ICP_QAT_UCLO_MAX_UIMAGE];\n\tstruct icp_qat_uclo_aedata ae_data[ICP_QAT_UCLO_MAX_AE];\n\tstruct icp_qat_uclo_init_mem_table init_mem_tab;\n\tstruct icp_qat_uof_batch_init *lm_init_tab[ICP_QAT_UCLO_MAX_AE];\n\tstruct icp_qat_uof_batch_init *umem_init_tab[ICP_QAT_UCLO_MAX_AE];\n\tint uimage_num;\n\tint uword_in_bytes;\n\tint global_inited;\n\tunsigned int ae_num;\n\tunsigned int ustore_phy_size;\n\tvoid *obj_buf;\n\tu64 *uword_buf;\n};\n\nstruct icp_qat_uof_uword_block {\n\tunsigned int start_addr;\n\tunsigned int words_num;\n\tunsigned int uword_offset;\n\tunsigned int reserved;\n};\n\nstruct icp_qat_uof_filehdr {\n\tunsigned short file_id;\n\tunsigned short reserved1;\n\tchar min_ver;\n\tchar maj_ver;\n\tunsigned short reserved2;\n\tunsigned short max_chunks;\n\tunsigned short num_chunks;\n};\n\nstruct icp_qat_uof_filechunkhdr {\n\tchar chunk_id[ICP_QAT_UOF_OBJID_LEN];\n\tunsigned int checksum;\n\tunsigned int offset;\n\tunsigned int size;\n};\n\nstruct icp_qat_uof_objhdr {\n\tunsigned int ac_dev_type;\n\tunsigned short min_cpu_ver;\n\tunsigned short max_cpu_ver;\n\tshort max_chunks;\n\tshort num_chunks;\n\tunsigned int reserved1;\n\tunsigned int reserved2;\n};\n\nstruct icp_qat_uof_chunkhdr {\n\tchar chunk_id[ICP_QAT_UOF_OBJID_LEN];\n\tunsigned int offset;\n\tunsigned int size;\n};\n\nstruct icp_qat_uof_memvar_attr {\n\tunsigned int offset_in_byte;\n\tunsigned int value;\n};\n\nstruct icp_qat_uof_initmem {\n\tunsigned int sym_name;\n\tchar region;\n\tchar scope;\n\tunsigned short reserved1;\n\tunsigned int addr;\n\tunsigned int num_in_bytes;\n\tunsigned int val_attr_num;\n};\n\nstruct icp_qat_uof_init_regsym {\n\tunsigned int sym_name;\n\tchar init_type;\n\tchar value_type;\n\tchar reg_type;\n\tunsigned char ctx;\n\tunsigned int reg_addr;\n\tunsigned int value;\n};\n\nstruct icp_qat_uof_varmem_seg {\n\tunsigned int sram_base;\n\tunsigned int sram_size;\n\tunsigned int sram_alignment;\n\tunsigned int sdram_base;\n\tunsigned int sdram_size;\n\tunsigned int sdram_alignment;\n\tunsigned int sdram1_base;\n\tunsigned int sdram1_size;\n\tunsigned int sdram1_alignment;\n\tunsigned int scratch_base;\n\tunsigned int scratch_size;\n\tunsigned int scratch_alignment;\n};\n\nstruct icp_qat_uof_gtid {\n\tchar tool_id[ICP_QAT_UOF_OBJID_LEN];\n\tint tool_ver;\n\tunsigned int reserved1;\n\tunsigned int reserved2;\n};\n\nstruct icp_qat_uof_sbreak {\n\tunsigned int page_num;\n\tunsigned int virt_uaddr;\n\tunsigned char sbreak_type;\n\tunsigned char reg_type;\n\tunsigned short reserved1;\n\tunsigned int addr_offset;\n\tunsigned int reg_addr;\n};\n\nstruct icp_qat_uof_code_page {\n\tunsigned int page_region;\n\tunsigned int page_num;\n\tunsigned char def_page;\n\tunsigned char reserved2;\n\tunsigned short reserved1;\n\tunsigned int beg_addr_v;\n\tunsigned int beg_addr_p;\n\tunsigned int neigh_reg_tab_offset;\n\tunsigned int uc_var_tab_offset;\n\tunsigned int imp_var_tab_offset;\n\tunsigned int imp_expr_tab_offset;\n\tunsigned int code_area_offset;\n};\n\nstruct icp_qat_uof_image {\n\tunsigned int img_name;\n\tunsigned int ae_assigned;\n\tunsigned int ctx_assigned;\n\tunsigned int ac_dev_type;\n\tunsigned int entry_address;\n\tunsigned int fill_pattern[2];\n\tunsigned int reloadable_size;\n\tunsigned char sensitivity;\n\tunsigned char reserved;\n\tunsigned short ae_mode;\n\tunsigned short max_ver;\n\tunsigned short min_ver;\n\tunsigned short image_attrib;\n\tunsigned short reserved2;\n\tunsigned short page_region_num;\n\tunsigned short numpages;\n\tunsigned int reg_tab_offset;\n\tunsigned int init_reg_sym_tab;\n\tunsigned int sbreak_tab;\n\tunsigned int app_metadata;\n};\n\nstruct icp_qat_uof_objtable {\n\tunsigned int entry_num;\n};\n\nstruct icp_qat_uof_ae_reg {\n\tunsigned int name;\n\tunsigned int vis_name;\n\tunsigned short type;\n\tunsigned short addr;\n\tunsigned short access_mode;\n\tunsigned char visible;\n\tunsigned char reserved1;\n\tunsigned short ref_count;\n\tunsigned short reserved2;\n\tunsigned int xo_id;\n};\n\nstruct icp_qat_uof_code_area {\n\tunsigned int micro_words_num;\n\tunsigned int uword_block_tab;\n};\n\nstruct icp_qat_uof_batch_init {\n\tunsigned int ae;\n\tunsigned int addr;\n\tunsigned int *value;\n\tunsigned int size;\n\tstruct icp_qat_uof_batch_init *next;\n};\n\nstruct icp_qat_suof_img_hdr {\n\tchar          *simg_buf;\n\tunsigned long simg_len;\n\tchar          *css_header;\n\tchar          *css_key;\n\tchar          *css_signature;\n\tchar          *css_simg;\n\tunsigned long simg_size;\n\tunsigned int  ae_num;\n\tunsigned int  ae_mask;\n\tunsigned int  fw_type;\n\tunsigned long simg_name;\n\tunsigned long appmeta_data;\n};\n\nstruct icp_qat_suof_img_tbl {\n\tunsigned int num_simgs;\n\tstruct icp_qat_suof_img_hdr *simg_hdr;\n};\n\nstruct icp_qat_suof_handle {\n\tunsigned int  file_id;\n\tunsigned int  check_sum;\n\tchar          min_ver;\n\tchar          maj_ver;\n\tchar          fw_type;\n\tchar          *suof_buf;\n\tunsigned int  suof_size;\n\tchar          *sym_str;\n\tunsigned int  sym_size;\n\tstruct icp_qat_suof_img_tbl img_table;\n};\n\nstruct icp_qat_fw_auth_desc {\n\tunsigned int   img_len;\n\tunsigned int   ae_mask;\n\tunsigned int   css_hdr_high;\n\tunsigned int   css_hdr_low;\n\tunsigned int   img_high;\n\tunsigned int   img_low;\n\tunsigned int   signature_high;\n\tunsigned int   signature_low;\n\tunsigned int   fwsk_pub_high;\n\tunsigned int   fwsk_pub_low;\n\tunsigned int   img_ae_mode_data_high;\n\tunsigned int   img_ae_mode_data_low;\n\tunsigned int   img_ae_init_data_high;\n\tunsigned int   img_ae_init_data_low;\n\tunsigned int   img_ae_insts_high;\n\tunsigned int   img_ae_insts_low;\n};\n\nstruct icp_qat_auth_chunk {\n\tstruct icp_qat_fw_auth_desc fw_auth_desc;\n\tu64 chunk_size;\n\tu64 chunk_bus_addr;\n};\n\nstruct icp_qat_css_hdr {\n\tunsigned int module_type;\n\tunsigned int header_len;\n\tunsigned int header_ver;\n\tunsigned int module_id;\n\tunsigned int module_vendor;\n\tunsigned int date;\n\tunsigned int size;\n\tunsigned int key_size;\n\tunsigned int module_size;\n\tunsigned int exponent_size;\n\tunsigned int fw_type;\n\tunsigned int reserved[21];\n};\n\nstruct icp_qat_simg_ae_mode {\n\tunsigned int     file_id;\n\tunsigned short   maj_ver;\n\tunsigned short   min_ver;\n\tunsigned int     dev_type;\n\tunsigned short   devmax_ver;\n\tunsigned short   devmin_ver;\n\tunsigned int     ae_mask;\n\tunsigned int     ctx_enables;\n\tchar             fw_type;\n\tchar             ctx_mode;\n\tchar             nn_mode;\n\tchar             lm0_mode;\n\tchar             lm1_mode;\n\tchar             scs_mode;\n\tchar             lm2_mode;\n\tchar             lm3_mode;\n\tchar             tindex_mode;\n\tunsigned char    reserved[7];\n\tchar             simg_name[256];\n\tchar             appmeta_data[256];\n};\n\nstruct icp_qat_suof_filehdr {\n\tunsigned int     file_id;\n\tunsigned int     check_sum;\n\tchar             min_ver;\n\tchar             maj_ver;\n\tchar             fw_type;\n\tchar             reserved;\n\tunsigned short   max_chunks;\n\tunsigned short   num_chunks;\n};\n\nstruct icp_qat_suof_chunk_hdr {\n\tchar chunk_id[ICP_QAT_SUOF_OBJ_ID_LEN];\n\tu64 offset;\n\tu64 size;\n};\n\nstruct icp_qat_suof_strtable {\n\tunsigned int tab_length;\n\tunsigned int strings;\n};\n\nstruct icp_qat_suof_objhdr {\n\tunsigned int img_length;\n\tunsigned int reserved;\n};\n\nstruct icp_qat_mof_file_hdr {\n\tunsigned int file_id;\n\tunsigned int checksum;\n\tchar min_ver;\n\tchar maj_ver;\n\tunsigned short reserved;\n\tunsigned short max_chunks;\n\tunsigned short num_chunks;\n};\n\nstruct icp_qat_mof_chunkhdr {\n\tchar chunk_id[ICP_QAT_MOF_OBJ_ID_LEN];\n\tu64 offset;\n\tu64 size;\n};\n\nstruct icp_qat_mof_str_table {\n\tunsigned int tab_len;\n\tunsigned int strings;\n};\n\nstruct icp_qat_mof_obj_hdr {\n\tunsigned short max_chunks;\n\tunsigned short num_chunks;\n\tunsigned int reserved;\n};\n\nstruct icp_qat_mof_obj_chunkhdr {\n\tchar chunk_id[ICP_QAT_MOF_OBJ_CHUNKID_LEN];\n\tu64 offset;\n\tu64 size;\n\tunsigned int name;\n\tunsigned int reserved;\n};\n\nstruct icp_qat_mof_objhdr {\n\tchar *obj_name;\n\tchar *obj_buf;\n\tunsigned int obj_size;\n};\n\nstruct icp_qat_mof_table {\n\tunsigned int num_objs;\n\tstruct icp_qat_mof_objhdr *obj_hdr;\n};\n\nstruct icp_qat_mof_handle {\n\tunsigned int file_id;\n\tunsigned int checksum;\n\tchar min_ver;\n\tchar maj_ver;\n\tchar *mof_buf;\n\tu32 mof_size;\n\tchar *sym_str;\n\tunsigned int sym_size;\n\tchar *uobjs_hdr;\n\tchar *sobjs_hdr;\n\tstruct icp_qat_mof_table obj_table;\n};\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}