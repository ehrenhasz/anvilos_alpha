{
  "module_name": "adf_common_drv.h",
  "hash_id": "103e537e9b2e9a6c4e83970bbc7f55f431c15de9b494b692c97ee15631e672e6",
  "original_prompt": "Ingested from linux-6.6.14/drivers/crypto/intel/qat/qat_common/adf_common_drv.h",
  "human_readable_source": " \n \n#ifndef ADF_DRV_H\n#define ADF_DRV_H\n\n#include <linux/list.h>\n#include <linux/pci.h>\n#include \"adf_accel_devices.h\"\n#include \"icp_qat_fw_loader_handle.h\"\n#include \"icp_qat_hal.h\"\n\n#define ADF_MAJOR_VERSION\t0\n#define ADF_MINOR_VERSION\t6\n#define ADF_BUILD_VERSION\t0\n#define ADF_DRV_VERSION\t\t__stringify(ADF_MAJOR_VERSION) \".\" \\\n\t\t\t\t__stringify(ADF_MINOR_VERSION) \".\" \\\n\t\t\t\t__stringify(ADF_BUILD_VERSION)\n\n#define ADF_STATUS_RESTARTING 0\n#define ADF_STATUS_STARTING 1\n#define ADF_STATUS_CONFIGURED 2\n#define ADF_STATUS_STARTED 3\n#define ADF_STATUS_AE_INITIALISED 4\n#define ADF_STATUS_AE_UCODE_LOADED 5\n#define ADF_STATUS_AE_STARTED 6\n#define ADF_STATUS_PF_RUNNING 7\n#define ADF_STATUS_IRQ_ALLOCATED 8\n#define ADF_STATUS_CRYPTO_ALGS_REGISTERED 9\n#define ADF_STATUS_COMP_ALGS_REGISTERED 10\n\nenum adf_dev_reset_mode {\n\tADF_DEV_RESET_ASYNC = 0,\n\tADF_DEV_RESET_SYNC\n};\n\nenum adf_event {\n\tADF_EVENT_INIT = 0,\n\tADF_EVENT_START,\n\tADF_EVENT_STOP,\n\tADF_EVENT_SHUTDOWN,\n\tADF_EVENT_RESTARTING,\n\tADF_EVENT_RESTARTED,\n};\n\nstruct service_hndl {\n\tint (*event_hld)(struct adf_accel_dev *accel_dev,\n\t\t\t enum adf_event event);\n\tunsigned long init_status[ADF_DEVS_ARRAY_SIZE];\n\tunsigned long start_status[ADF_DEVS_ARRAY_SIZE];\n\tchar *name;\n\tstruct list_head list;\n};\n\nint adf_service_register(struct service_hndl *service);\nint adf_service_unregister(struct service_hndl *service);\n\nint adf_dev_up(struct adf_accel_dev *accel_dev, bool init_config);\nint adf_dev_down(struct adf_accel_dev *accel_dev, bool cache_config);\nint adf_dev_restart(struct adf_accel_dev *accel_dev);\n\nvoid adf_devmgr_update_class_index(struct adf_hw_device_data *hw_data);\nvoid adf_clean_vf_map(bool);\nint adf_devmgr_add_dev(struct adf_accel_dev *accel_dev,\n\t\t       struct adf_accel_dev *pf);\nvoid adf_devmgr_rm_dev(struct adf_accel_dev *accel_dev,\n\t\t       struct adf_accel_dev *pf);\nstruct list_head *adf_devmgr_get_head(void);\nstruct adf_accel_dev *adf_devmgr_get_dev_by_id(u32 id);\nstruct adf_accel_dev *adf_devmgr_get_first(void);\nstruct adf_accel_dev *adf_devmgr_pci_to_accel_dev(struct pci_dev *pci_dev);\nint adf_devmgr_verify_id(u32 id);\nvoid adf_devmgr_get_num_dev(u32 *num);\nint adf_devmgr_in_reset(struct adf_accel_dev *accel_dev);\nint adf_dev_started(struct adf_accel_dev *accel_dev);\nint adf_dev_restarting_notify(struct adf_accel_dev *accel_dev);\nint adf_dev_restarted_notify(struct adf_accel_dev *accel_dev);\nint adf_ae_init(struct adf_accel_dev *accel_dev);\nint adf_ae_shutdown(struct adf_accel_dev *accel_dev);\nint adf_ae_fw_load(struct adf_accel_dev *accel_dev);\nvoid adf_ae_fw_release(struct adf_accel_dev *accel_dev);\nint adf_ae_start(struct adf_accel_dev *accel_dev);\nint adf_ae_stop(struct adf_accel_dev *accel_dev);\n\nextern const struct pci_error_handlers adf_err_handler;\nvoid adf_reset_sbr(struct adf_accel_dev *accel_dev);\nvoid adf_reset_flr(struct adf_accel_dev *accel_dev);\nvoid adf_dev_restore(struct adf_accel_dev *accel_dev);\nint adf_init_aer(void);\nvoid adf_exit_aer(void);\nint adf_init_admin_comms(struct adf_accel_dev *accel_dev);\nvoid adf_exit_admin_comms(struct adf_accel_dev *accel_dev);\nint adf_send_admin_init(struct adf_accel_dev *accel_dev);\nint adf_get_ae_fw_counters(struct adf_accel_dev *accel_dev, u16 ae, u64 *reqs, u64 *resps);\nint adf_init_admin_pm(struct adf_accel_dev *accel_dev, u32 idle_delay);\nint adf_send_admin_tim_sync(struct adf_accel_dev *accel_dev, u32 cnt);\nint adf_send_admin_hb_timer(struct adf_accel_dev *accel_dev, uint32_t ticks);\nint adf_get_fw_timestamp(struct adf_accel_dev *accel_dev, u64 *timestamp);\nint adf_init_arb(struct adf_accel_dev *accel_dev);\nvoid adf_exit_arb(struct adf_accel_dev *accel_dev);\nvoid adf_update_ring_arb(struct adf_etr_ring_data *ring);\n\nint adf_dev_get(struct adf_accel_dev *accel_dev);\nvoid adf_dev_put(struct adf_accel_dev *accel_dev);\nint adf_dev_in_use(struct adf_accel_dev *accel_dev);\nint adf_init_etr_data(struct adf_accel_dev *accel_dev);\nvoid adf_cleanup_etr_data(struct adf_accel_dev *accel_dev);\nint qat_crypto_register(void);\nint qat_crypto_unregister(void);\nint qat_crypto_vf_dev_config(struct adf_accel_dev *accel_dev);\nstruct qat_crypto_instance *qat_crypto_get_instance_node(int node);\nvoid qat_crypto_put_instance(struct qat_crypto_instance *inst);\nvoid qat_alg_callback(void *resp);\nvoid qat_alg_asym_callback(void *resp);\nint qat_algs_register(void);\nvoid qat_algs_unregister(void);\nint qat_asym_algs_register(void);\nvoid qat_asym_algs_unregister(void);\n\nstruct qat_compression_instance *qat_compression_get_instance_node(int node);\nvoid qat_compression_put_instance(struct qat_compression_instance *inst);\nint qat_compression_register(void);\nint qat_compression_unregister(void);\nint qat_comp_algs_register(void);\nvoid qat_comp_algs_unregister(void);\nvoid qat_comp_alg_callback(void *resp);\n\nint adf_isr_resource_alloc(struct adf_accel_dev *accel_dev);\nvoid adf_isr_resource_free(struct adf_accel_dev *accel_dev);\nint adf_vf_isr_resource_alloc(struct adf_accel_dev *accel_dev);\nvoid adf_vf_isr_resource_free(struct adf_accel_dev *accel_dev);\n\nint adf_pfvf_comms_disabled(struct adf_accel_dev *accel_dev);\n\nint adf_sysfs_init(struct adf_accel_dev *accel_dev);\n\nint qat_hal_init(struct adf_accel_dev *accel_dev);\nvoid qat_hal_deinit(struct icp_qat_fw_loader_handle *handle);\nint qat_hal_start(struct icp_qat_fw_loader_handle *handle);\nvoid qat_hal_stop(struct icp_qat_fw_loader_handle *handle, unsigned char ae,\n\t\t  unsigned int ctx_mask);\nvoid qat_hal_reset(struct icp_qat_fw_loader_handle *handle);\nint qat_hal_clr_reset(struct icp_qat_fw_loader_handle *handle);\nvoid qat_hal_set_live_ctx(struct icp_qat_fw_loader_handle *handle,\n\t\t\t  unsigned char ae, unsigned int ctx_mask);\nint qat_hal_check_ae_active(struct icp_qat_fw_loader_handle *handle,\n\t\t\t    unsigned int ae);\nint qat_hal_set_ae_lm_mode(struct icp_qat_fw_loader_handle *handle,\n\t\t\t   unsigned char ae, enum icp_qat_uof_regtype lm_type,\n\t\t\t   unsigned char mode);\nint qat_hal_set_ae_ctx_mode(struct icp_qat_fw_loader_handle *handle,\n\t\t\t    unsigned char ae, unsigned char mode);\nint qat_hal_set_ae_nn_mode(struct icp_qat_fw_loader_handle *handle,\n\t\t\t   unsigned char ae, unsigned char mode);\nvoid qat_hal_set_pc(struct icp_qat_fw_loader_handle *handle,\n\t\t    unsigned char ae, unsigned int ctx_mask, unsigned int upc);\nvoid qat_hal_wr_uwords(struct icp_qat_fw_loader_handle *handle,\n\t\t       unsigned char ae, unsigned int uaddr,\n\t\t       unsigned int words_num, u64 *uword);\nvoid qat_hal_wr_umem(struct icp_qat_fw_loader_handle *handle, unsigned char ae,\n\t\t     unsigned int uword_addr, unsigned int words_num,\n\t\t     unsigned int *data);\nint qat_hal_get_ins_num(void);\nint qat_hal_batch_wr_lm(struct icp_qat_fw_loader_handle *handle,\n\t\t\tunsigned char ae,\n\t\t\tstruct icp_qat_uof_batch_init *lm_init_header);\nint qat_hal_init_gpr(struct icp_qat_fw_loader_handle *handle,\n\t\t     unsigned char ae, unsigned long ctx_mask,\n\t\t     enum icp_qat_uof_regtype reg_type,\n\t\t     unsigned short reg_num, unsigned int regdata);\nint qat_hal_init_wr_xfer(struct icp_qat_fw_loader_handle *handle,\n\t\t\t unsigned char ae, unsigned long ctx_mask,\n\t\t\t enum icp_qat_uof_regtype reg_type,\n\t\t\t unsigned short reg_num, unsigned int regdata);\nint qat_hal_init_rd_xfer(struct icp_qat_fw_loader_handle *handle,\n\t\t\t unsigned char ae, unsigned long ctx_mask,\n\t\t\t enum icp_qat_uof_regtype reg_type,\n\t\t\t unsigned short reg_num, unsigned int regdata);\nint qat_hal_init_nn(struct icp_qat_fw_loader_handle *handle,\n\t\t    unsigned char ae, unsigned long ctx_mask,\n\t\t    unsigned short reg_num, unsigned int regdata);\nvoid qat_hal_set_ae_tindex_mode(struct icp_qat_fw_loader_handle *handle,\n\t\t\t\tunsigned char ae, unsigned char mode);\nint qat_uclo_wr_all_uimage(struct icp_qat_fw_loader_handle *handle);\nvoid qat_uclo_del_obj(struct icp_qat_fw_loader_handle *handle);\nint qat_uclo_wr_mimage(struct icp_qat_fw_loader_handle *handle, void *addr_ptr,\n\t\t       int mem_size);\nint qat_uclo_map_obj(struct icp_qat_fw_loader_handle *handle,\n\t\t     void *addr_ptr, u32 mem_size, const char *obj_name);\nint qat_uclo_set_cfg_ae_mask(struct icp_qat_fw_loader_handle *handle,\n\t\t\t     unsigned int cfg_ae_mask);\nint adf_init_misc_wq(void);\nvoid adf_exit_misc_wq(void);\nbool adf_misc_wq_queue_work(struct work_struct *work);\nbool adf_misc_wq_queue_delayed_work(struct delayed_work *work,\n\t\t\t\t    unsigned long delay);\n#if defined(CONFIG_PCI_IOV)\nint adf_sriov_configure(struct pci_dev *pdev, int numvfs);\nvoid adf_disable_sriov(struct adf_accel_dev *accel_dev);\nvoid adf_enable_vf2pf_interrupts(struct adf_accel_dev *accel_dev, u32 vf_mask);\nvoid adf_disable_all_vf2pf_interrupts(struct adf_accel_dev *accel_dev);\nbool adf_recv_and_handle_pf2vf_msg(struct adf_accel_dev *accel_dev);\nbool adf_recv_and_handle_vf2pf_msg(struct adf_accel_dev *accel_dev, u32 vf_nr);\nint adf_pf2vf_handle_pf_restarting(struct adf_accel_dev *accel_dev);\nvoid adf_enable_pf2vf_interrupts(struct adf_accel_dev *accel_dev);\nvoid adf_disable_pf2vf_interrupts(struct adf_accel_dev *accel_dev);\nvoid adf_schedule_vf2pf_handler(struct adf_accel_vf_info *vf_info);\nint adf_init_pf_wq(void);\nvoid adf_exit_pf_wq(void);\nint adf_init_vf_wq(void);\nvoid adf_exit_vf_wq(void);\nvoid adf_flush_vf_wq(struct adf_accel_dev *accel_dev);\n#else\n#define adf_sriov_configure NULL\n\nstatic inline void adf_disable_sriov(struct adf_accel_dev *accel_dev)\n{\n}\n\nstatic inline int adf_init_pf_wq(void)\n{\n\treturn 0;\n}\n\nstatic inline void adf_exit_pf_wq(void)\n{\n}\n\nstatic inline int adf_init_vf_wq(void)\n{\n\treturn 0;\n}\n\nstatic inline void adf_exit_vf_wq(void)\n{\n}\n\n#endif\n\nstatic inline void __iomem *adf_get_pmisc_base(struct adf_accel_dev *accel_dev)\n{\n\tstruct adf_hw_device_data *hw_data = accel_dev->hw_device;\n\tstruct adf_bar *pmisc;\n\n\tpmisc = &GET_BARS(accel_dev)[hw_data->get_misc_bar_id(hw_data)];\n\n\treturn pmisc->virt_addr;\n}\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}