{
  "module_name": "icp_qat_fw_la.h",
  "hash_id": "de3e3e2e608271ed4f1533404aeca5157e8aef7412defc20aea478944e9d5a6c",
  "original_prompt": "Ingested from linux-6.6.14/drivers/crypto/intel/qat/qat_common/icp_qat_fw_la.h",
  "human_readable_source": " \n \n#ifndef _ICP_QAT_FW_LA_H_\n#define _ICP_QAT_FW_LA_H_\n#include \"icp_qat_fw.h\"\n\nenum icp_qat_fw_la_cmd_id {\n\tICP_QAT_FW_LA_CMD_CIPHER = 0,\n\tICP_QAT_FW_LA_CMD_AUTH = 1,\n\tICP_QAT_FW_LA_CMD_CIPHER_HASH = 2,\n\tICP_QAT_FW_LA_CMD_HASH_CIPHER = 3,\n\tICP_QAT_FW_LA_CMD_TRNG_GET_RANDOM = 4,\n\tICP_QAT_FW_LA_CMD_TRNG_TEST = 5,\n\tICP_QAT_FW_LA_CMD_SSL3_KEY_DERIVE = 6,\n\tICP_QAT_FW_LA_CMD_TLS_V1_1_KEY_DERIVE = 7,\n\tICP_QAT_FW_LA_CMD_TLS_V1_2_KEY_DERIVE = 8,\n\tICP_QAT_FW_LA_CMD_MGF1 = 9,\n\tICP_QAT_FW_LA_CMD_AUTH_PRE_COMP = 10,\n\tICP_QAT_FW_LA_CMD_CIPHER_PRE_COMP = 11,\n\tICP_QAT_FW_LA_CMD_DELIMITER = 12\n};\n\n#define ICP_QAT_FW_LA_ICV_VER_STATUS_PASS ICP_QAT_FW_COMN_STATUS_FLAG_OK\n#define ICP_QAT_FW_LA_ICV_VER_STATUS_FAIL ICP_QAT_FW_COMN_STATUS_FLAG_ERROR\n#define ICP_QAT_FW_LA_TRNG_STATUS_PASS ICP_QAT_FW_COMN_STATUS_FLAG_OK\n#define ICP_QAT_FW_LA_TRNG_STATUS_FAIL ICP_QAT_FW_COMN_STATUS_FLAG_ERROR\n\nstruct icp_qat_fw_la_bulk_req {\n\tstruct icp_qat_fw_comn_req_hdr comn_hdr;\n\tstruct icp_qat_fw_comn_req_hdr_cd_pars cd_pars;\n\tstruct icp_qat_fw_comn_req_mid comn_mid;\n\tstruct icp_qat_fw_comn_req_rqpars serv_specif_rqpars;\n\tstruct icp_qat_fw_comn_req_cd_ctrl cd_ctrl;\n};\n\n#define ICP_QAT_FW_LA_USE_UCS_SLICE_TYPE 1\n#define QAT_LA_SLICE_TYPE_BITPOS 14\n#define QAT_LA_SLICE_TYPE_MASK 0x3\n#define ICP_QAT_FW_LA_GCM_IV_LEN_12_OCTETS 1\n#define ICP_QAT_FW_LA_GCM_IV_LEN_NOT_12_OCTETS 0\n#define QAT_FW_LA_ZUC_3G_PROTO_FLAG_BITPOS 12\n#define ICP_QAT_FW_LA_ZUC_3G_PROTO 1\n#define QAT_FW_LA_ZUC_3G_PROTO_FLAG_MASK 0x1\n#define QAT_LA_GCM_IV_LEN_FLAG_BITPOS 11\n#define QAT_LA_GCM_IV_LEN_FLAG_MASK 0x1\n#define ICP_QAT_FW_LA_DIGEST_IN_BUFFER 1\n#define ICP_QAT_FW_LA_NO_DIGEST_IN_BUFFER 0\n#define QAT_LA_DIGEST_IN_BUFFER_BITPOS\t10\n#define QAT_LA_DIGEST_IN_BUFFER_MASK 0x1\n#define ICP_QAT_FW_LA_SNOW_3G_PROTO 4\n#define ICP_QAT_FW_LA_GCM_PROTO\t2\n#define ICP_QAT_FW_LA_CCM_PROTO\t1\n#define ICP_QAT_FW_LA_NO_PROTO 0\n#define QAT_LA_PROTO_BITPOS 7\n#define QAT_LA_PROTO_MASK 0x7\n#define ICP_QAT_FW_LA_CMP_AUTH_RES 1\n#define ICP_QAT_FW_LA_NO_CMP_AUTH_RES 0\n#define QAT_LA_CMP_AUTH_RES_BITPOS 6\n#define QAT_LA_CMP_AUTH_RES_MASK 0x1\n#define ICP_QAT_FW_LA_RET_AUTH_RES 1\n#define ICP_QAT_FW_LA_NO_RET_AUTH_RES 0\n#define QAT_LA_RET_AUTH_RES_BITPOS 5\n#define QAT_LA_RET_AUTH_RES_MASK 0x1\n#define ICP_QAT_FW_LA_UPDATE_STATE 1\n#define ICP_QAT_FW_LA_NO_UPDATE_STATE 0\n#define QAT_LA_UPDATE_STATE_BITPOS 4\n#define QAT_LA_UPDATE_STATE_MASK 0x1\n#define ICP_QAT_FW_CIPH_AUTH_CFG_OFFSET_IN_CD_SETUP 0\n#define ICP_QAT_FW_CIPH_AUTH_CFG_OFFSET_IN_SHRAM_CP 1\n#define QAT_LA_CIPH_AUTH_CFG_OFFSET_BITPOS 3\n#define QAT_LA_CIPH_AUTH_CFG_OFFSET_MASK 0x1\n#define ICP_QAT_FW_CIPH_IV_64BIT_PTR 0\n#define ICP_QAT_FW_CIPH_IV_16BYTE_DATA 1\n#define QAT_LA_CIPH_IV_FLD_BITPOS 2\n#define QAT_LA_CIPH_IV_FLD_MASK   0x1\n#define ICP_QAT_FW_LA_PARTIAL_NONE 0\n#define ICP_QAT_FW_LA_PARTIAL_START 1\n#define ICP_QAT_FW_LA_PARTIAL_MID 3\n#define ICP_QAT_FW_LA_PARTIAL_END 2\n#define QAT_LA_PARTIAL_BITPOS 0\n#define QAT_LA_PARTIAL_MASK 0x3\n#define ICP_QAT_FW_LA_FLAGS_BUILD(zuc_proto, gcm_iv_len, auth_rslt, proto, \\\n\tcmp_auth, ret_auth, update_state, \\\n\tciph_iv, ciphcfg, partial) \\\n\t(((zuc_proto & QAT_FW_LA_ZUC_3G_PROTO_FLAG_MASK) << \\\n\tQAT_FW_LA_ZUC_3G_PROTO_FLAG_BITPOS) | \\\n\t((gcm_iv_len & QAT_LA_GCM_IV_LEN_FLAG_MASK) << \\\n\tQAT_LA_GCM_IV_LEN_FLAG_BITPOS) | \\\n\t((auth_rslt & QAT_LA_DIGEST_IN_BUFFER_MASK) << \\\n\tQAT_LA_DIGEST_IN_BUFFER_BITPOS) | \\\n\t((proto & QAT_LA_PROTO_MASK) << \\\n\tQAT_LA_PROTO_BITPOS)\t| \\\n\t((cmp_auth & QAT_LA_CMP_AUTH_RES_MASK) << \\\n\tQAT_LA_CMP_AUTH_RES_BITPOS) | \\\n\t((ret_auth & QAT_LA_RET_AUTH_RES_MASK) << \\\n\tQAT_LA_RET_AUTH_RES_BITPOS) | \\\n\t((update_state & QAT_LA_UPDATE_STATE_MASK) << \\\n\tQAT_LA_UPDATE_STATE_BITPOS) | \\\n\t((ciph_iv & QAT_LA_CIPH_IV_FLD_MASK) << \\\n\tQAT_LA_CIPH_IV_FLD_BITPOS) | \\\n\t((ciphcfg & QAT_LA_CIPH_AUTH_CFG_OFFSET_MASK) << \\\n\tQAT_LA_CIPH_AUTH_CFG_OFFSET_BITPOS) | \\\n\t((partial & QAT_LA_PARTIAL_MASK) << \\\n\tQAT_LA_PARTIAL_BITPOS))\n\n#define ICP_QAT_FW_LA_CIPH_IV_FLD_FLAG_GET(flags) \\\n\tQAT_FIELD_GET(flags, QAT_LA_CIPH_IV_FLD_BITPOS, \\\n\tQAT_LA_CIPH_IV_FLD_MASK)\n\n#define ICP_QAT_FW_LA_CIPH_AUTH_CFG_OFFSET_FLAG_GET(flags) \\\n\tQAT_FIELD_GET(flags, QAT_LA_CIPH_AUTH_CFG_OFFSET_BITPOS, \\\n\tQAT_LA_CIPH_AUTH_CFG_OFFSET_MASK)\n\n#define ICP_QAT_FW_LA_ZUC_3G_PROTO_FLAG_GET(flags) \\\n\tQAT_FIELD_GET(flags, QAT_FW_LA_ZUC_3G_PROTO_FLAG_BITPOS, \\\n\tQAT_FW_LA_ZUC_3G_PROTO_FLAG_MASK)\n\n#define ICP_QAT_FW_LA_GCM_IV_LEN_FLAG_GET(flags) \\\n\tQAT_FIELD_GET(flags, QAT_LA_GCM_IV_LEN_FLAG_BITPOS, \\\n\tQAT_LA_GCM_IV_LEN_FLAG_MASK)\n\n#define ICP_QAT_FW_LA_PROTO_GET(flags) \\\n\tQAT_FIELD_GET(flags, QAT_LA_PROTO_BITPOS, QAT_LA_PROTO_MASK)\n\n#define ICP_QAT_FW_LA_CMP_AUTH_GET(flags) \\\n\tQAT_FIELD_GET(flags, QAT_LA_CMP_AUTH_RES_BITPOS, \\\n\tQAT_LA_CMP_AUTH_RES_MASK)\n\n#define ICP_QAT_FW_LA_RET_AUTH_GET(flags) \\\n\tQAT_FIELD_GET(flags, QAT_LA_RET_AUTH_RES_BITPOS, \\\n\tQAT_LA_RET_AUTH_RES_MASK)\n\n#define ICP_QAT_FW_LA_DIGEST_IN_BUFFER_GET(flags) \\\n\tQAT_FIELD_GET(flags, QAT_LA_DIGEST_IN_BUFFER_BITPOS, \\\n\tQAT_LA_DIGEST_IN_BUFFER_MASK)\n\n#define ICP_QAT_FW_LA_UPDATE_STATE_GET(flags) \\\n\tQAT_FIELD_GET(flags, QAT_LA_UPDATE_STATE_BITPOS, \\\n\tQAT_LA_UPDATE_STATE_MASK)\n\n#define ICP_QAT_FW_LA_PARTIAL_GET(flags) \\\n\tQAT_FIELD_GET(flags, QAT_LA_PARTIAL_BITPOS, \\\n\tQAT_LA_PARTIAL_MASK)\n\n#define ICP_QAT_FW_LA_CIPH_IV_FLD_FLAG_SET(flags, val) \\\n\tQAT_FIELD_SET(flags, val, QAT_LA_CIPH_IV_FLD_BITPOS, \\\n\tQAT_LA_CIPH_IV_FLD_MASK)\n\n#define ICP_QAT_FW_LA_CIPH_AUTH_CFG_OFFSET_FLAG_SET(flags, val) \\\n\tQAT_FIELD_SET(flags, val, QAT_LA_CIPH_AUTH_CFG_OFFSET_BITPOS, \\\n\tQAT_LA_CIPH_AUTH_CFG_OFFSET_MASK)\n\n#define ICP_QAT_FW_LA_ZUC_3G_PROTO_FLAG_SET(flags, val) \\\n\tQAT_FIELD_SET(flags, val, QAT_FW_LA_ZUC_3G_PROTO_FLAG_BITPOS, \\\n\tQAT_FW_LA_ZUC_3G_PROTO_FLAG_MASK)\n\n#define ICP_QAT_FW_LA_GCM_IV_LEN_FLAG_SET(flags, val) \\\n\tQAT_FIELD_SET(flags, val, QAT_LA_GCM_IV_LEN_FLAG_BITPOS, \\\n\tQAT_LA_GCM_IV_LEN_FLAG_MASK)\n\n#define ICP_QAT_FW_LA_PROTO_SET(flags, val) \\\n\tQAT_FIELD_SET(flags, val, QAT_LA_PROTO_BITPOS, \\\n\tQAT_LA_PROTO_MASK)\n\n#define ICP_QAT_FW_LA_CMP_AUTH_SET(flags, val) \\\n\tQAT_FIELD_SET(flags, val, QAT_LA_CMP_AUTH_RES_BITPOS, \\\n\tQAT_LA_CMP_AUTH_RES_MASK)\n\n#define ICP_QAT_FW_LA_RET_AUTH_SET(flags, val) \\\n\tQAT_FIELD_SET(flags, val, QAT_LA_RET_AUTH_RES_BITPOS, \\\n\tQAT_LA_RET_AUTH_RES_MASK)\n\n#define ICP_QAT_FW_LA_DIGEST_IN_BUFFER_SET(flags, val) \\\n\tQAT_FIELD_SET(flags, val, QAT_LA_DIGEST_IN_BUFFER_BITPOS, \\\n\tQAT_LA_DIGEST_IN_BUFFER_MASK)\n\n#define ICP_QAT_FW_LA_UPDATE_STATE_SET(flags, val) \\\n\tQAT_FIELD_SET(flags, val, QAT_LA_UPDATE_STATE_BITPOS, \\\n\tQAT_LA_UPDATE_STATE_MASK)\n\n#define ICP_QAT_FW_LA_PARTIAL_SET(flags, val) \\\n\tQAT_FIELD_SET(flags, val, QAT_LA_PARTIAL_BITPOS, \\\n\tQAT_LA_PARTIAL_MASK)\n\n#define ICP_QAT_FW_LA_SLICE_TYPE_SET(flags, val) \\\n\tQAT_FIELD_SET(flags, val, QAT_LA_SLICE_TYPE_BITPOS, \\\n\tQAT_LA_SLICE_TYPE_MASK)\n\nstruct icp_qat_fw_cipher_req_hdr_cd_pars {\n\tunion {\n\t\tstruct {\n\t\t\t__u64 content_desc_addr;\n\t\t\t__u16 content_desc_resrvd1;\n\t\t\t__u8 content_desc_params_sz;\n\t\t\t__u8 content_desc_hdr_resrvd2;\n\t\t\t__u32 content_desc_resrvd3;\n\t\t} s;\n\t\tstruct {\n\t\t\t__u32 cipher_key_array[ICP_QAT_FW_NUM_LONGWORDS_4];\n\t\t} s1;\n\t} u;\n};\n\nstruct icp_qat_fw_cipher_auth_req_hdr_cd_pars {\n\tunion {\n\t\tstruct {\n\t\t\t__u64 content_desc_addr;\n\t\t\t__u16 content_desc_resrvd1;\n\t\t\t__u8 content_desc_params_sz;\n\t\t\t__u8 content_desc_hdr_resrvd2;\n\t\t\t__u32 content_desc_resrvd3;\n\t\t} s;\n\t\tstruct {\n\t\t\t__u32 cipher_key_array[ICP_QAT_FW_NUM_LONGWORDS_4];\n\t\t} sl;\n\t} u;\n};\n\nstruct icp_qat_fw_cipher_cd_ctrl_hdr {\n\t__u8 cipher_state_sz;\n\t__u8 cipher_key_sz;\n\t__u8 cipher_cfg_offset;\n\t__u8 next_curr_id;\n\t__u8 cipher_padding_sz;\n\t__u8 resrvd1;\n\t__u16 resrvd2;\n\t__u32 resrvd3[ICP_QAT_FW_NUM_LONGWORDS_3];\n};\n\nstruct icp_qat_fw_auth_cd_ctrl_hdr {\n\t__u32 resrvd1;\n\t__u8 resrvd2;\n\t__u8 hash_flags;\n\t__u8 hash_cfg_offset;\n\t__u8 next_curr_id;\n\t__u8 resrvd3;\n\t__u8 outer_prefix_sz;\n\t__u8 final_sz;\n\t__u8 inner_res_sz;\n\t__u8 resrvd4;\n\t__u8 inner_state1_sz;\n\t__u8 inner_state2_offset;\n\t__u8 inner_state2_sz;\n\t__u8 outer_config_offset;\n\t__u8 outer_state1_sz;\n\t__u8 outer_res_sz;\n\t__u8 outer_prefix_offset;\n};\n\nstruct icp_qat_fw_cipher_auth_cd_ctrl_hdr {\n\t__u8 cipher_state_sz;\n\t__u8 cipher_key_sz;\n\t__u8 cipher_cfg_offset;\n\t__u8 next_curr_id_cipher;\n\t__u8 cipher_padding_sz;\n\t__u8 hash_flags;\n\t__u8 hash_cfg_offset;\n\t__u8 next_curr_id_auth;\n\t__u8 resrvd1;\n\t__u8 outer_prefix_sz;\n\t__u8 final_sz;\n\t__u8 inner_res_sz;\n\t__u8 resrvd2;\n\t__u8 inner_state1_sz;\n\t__u8 inner_state2_offset;\n\t__u8 inner_state2_sz;\n\t__u8 outer_config_offset;\n\t__u8 outer_state1_sz;\n\t__u8 outer_res_sz;\n\t__u8 outer_prefix_offset;\n};\n\n#define ICP_QAT_FW_AUTH_HDR_FLAG_DO_NESTED 1\n#define ICP_QAT_FW_AUTH_HDR_FLAG_NO_NESTED 0\n#define ICP_QAT_FW_CCM_GCM_AAD_SZ_MAX\t240\n#define ICP_QAT_FW_HASH_REQUEST_PARAMETERS_OFFSET \\\n\t(sizeof(struct icp_qat_fw_la_cipher_req_params_t))\n#define ICP_QAT_FW_CIPHER_REQUEST_PARAMETERS_OFFSET (0)\n\nstruct icp_qat_fw_la_cipher_req_params {\n\t__u32 cipher_offset;\n\t__u32 cipher_length;\n\tunion {\n\t\t__u32 cipher_IV_array[ICP_QAT_FW_NUM_LONGWORDS_4];\n\t\tstruct {\n\t\t\t__u64 cipher_IV_ptr;\n\t\t\t__u64 resrvd1;\n\t\t} s;\n\t} u;\n};\n\nstruct icp_qat_fw_la_auth_req_params {\n\t__u32 auth_off;\n\t__u32 auth_len;\n\tunion {\n\t\t__u64 auth_partial_st_prefix;\n\t\t__u64 aad_adr;\n\t} u1;\n\t__u64 auth_res_addr;\n\tunion {\n\t\t__u8 inner_prefix_sz;\n\t\t__u8 aad_sz;\n\t} u2;\n\t__u8 resrvd1;\n\t__u8 hash_state_sz;\n\t__u8 auth_res_sz;\n} __packed;\n\nstruct icp_qat_fw_la_auth_req_params_resrvd_flds {\n\t__u32 resrvd[ICP_QAT_FW_NUM_LONGWORDS_6];\n\tunion {\n\t\t__u8 inner_prefix_sz;\n\t\t__u8 aad_sz;\n\t} u2;\n\t__u8 resrvd1;\n\t__u16 resrvd2;\n};\n\nstruct icp_qat_fw_la_resp {\n\tstruct icp_qat_fw_comn_resp_hdr comn_resp;\n\t__u64 opaque_data;\n\t__u32 resrvd[ICP_QAT_FW_NUM_LONGWORDS_4];\n};\n\n#define ICP_QAT_FW_CIPHER_NEXT_ID_GET(cd_ctrl_hdr_t) \\\n\t((((cd_ctrl_hdr_t)->next_curr_id_cipher) & \\\n\t  ICP_QAT_FW_COMN_NEXT_ID_MASK) >> (ICP_QAT_FW_COMN_NEXT_ID_BITPOS))\n\n#define ICP_QAT_FW_CIPHER_NEXT_ID_SET(cd_ctrl_hdr_t, val) \\\n{ (cd_ctrl_hdr_t)->next_curr_id_cipher = \\\n\t((((cd_ctrl_hdr_t)->next_curr_id_cipher) \\\n\t& ICP_QAT_FW_COMN_CURR_ID_MASK) | \\\n\t((val << ICP_QAT_FW_COMN_NEXT_ID_BITPOS) \\\n\t& ICP_QAT_FW_COMN_NEXT_ID_MASK)) }\n\n#define ICP_QAT_FW_CIPHER_CURR_ID_GET(cd_ctrl_hdr_t) \\\n\t(((cd_ctrl_hdr_t)->next_curr_id_cipher) \\\n\t& ICP_QAT_FW_COMN_CURR_ID_MASK)\n\n#define ICP_QAT_FW_CIPHER_CURR_ID_SET(cd_ctrl_hdr_t, val) \\\n{ (cd_ctrl_hdr_t)->next_curr_id_cipher = \\\n\t((((cd_ctrl_hdr_t)->next_curr_id_cipher) \\\n\t& ICP_QAT_FW_COMN_NEXT_ID_MASK) | \\\n\t((val) & ICP_QAT_FW_COMN_CURR_ID_MASK)) }\n\n#define ICP_QAT_FW_AUTH_NEXT_ID_GET(cd_ctrl_hdr_t) \\\n\t((((cd_ctrl_hdr_t)->next_curr_id_auth) & ICP_QAT_FW_COMN_NEXT_ID_MASK) \\\n\t>> (ICP_QAT_FW_COMN_NEXT_ID_BITPOS))\n\n#define ICP_QAT_FW_AUTH_NEXT_ID_SET(cd_ctrl_hdr_t, val) \\\n{ (cd_ctrl_hdr_t)->next_curr_id_auth = \\\n\t((((cd_ctrl_hdr_t)->next_curr_id_auth) \\\n\t& ICP_QAT_FW_COMN_CURR_ID_MASK) | \\\n\t((val << ICP_QAT_FW_COMN_NEXT_ID_BITPOS) \\\n\t& ICP_QAT_FW_COMN_NEXT_ID_MASK)) }\n\n#define ICP_QAT_FW_AUTH_CURR_ID_GET(cd_ctrl_hdr_t) \\\n\t(((cd_ctrl_hdr_t)->next_curr_id_auth) \\\n\t& ICP_QAT_FW_COMN_CURR_ID_MASK)\n\n#define ICP_QAT_FW_AUTH_CURR_ID_SET(cd_ctrl_hdr_t, val) \\\n{ (cd_ctrl_hdr_t)->next_curr_id_auth = \\\n\t((((cd_ctrl_hdr_t)->next_curr_id_auth) \\\n\t& ICP_QAT_FW_COMN_NEXT_ID_MASK) | \\\n\t((val) & ICP_QAT_FW_COMN_CURR_ID_MASK)) }\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}