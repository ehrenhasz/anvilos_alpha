{
  "module_name": "ocs-aes.h",
  "hash_id": "cdba814894f3042ee72791cda03a8ea9f8a2395c49b954bf4273f9867750df2c",
  "original_prompt": "Ingested from linux-6.6.14/drivers/crypto/intel/keembay/ocs-aes.h",
  "human_readable_source": " \n \n\n#ifndef _CRYPTO_OCS_AES_H\n#define _CRYPTO_OCS_AES_H\n\n#include <linux/dma-mapping.h>\n\nenum ocs_cipher {\n\tOCS_AES = 0,\n\tOCS_SM4 = 1,\n};\n\nenum ocs_mode {\n\tOCS_MODE_ECB = 0,\n\tOCS_MODE_CBC = 1,\n\tOCS_MODE_CTR = 2,\n\tOCS_MODE_CCM = 6,\n\tOCS_MODE_GCM = 7,\n\tOCS_MODE_CTS = 9,\n};\n\nenum ocs_instruction {\n\tOCS_ENCRYPT = 0,\n\tOCS_DECRYPT = 1,\n\tOCS_EXPAND  = 2,\n\tOCS_BYPASS  = 3,\n};\n\n \nstruct ocs_aes_dev {\n\tstruct list_head list;\n\tstruct device *dev;\n\tint irq;\n\tvoid __iomem *base_reg;\n\tstruct completion irq_completion;\n\tu32 dma_err_mask;\n\tstruct crypto_engine *engine;\n};\n\n \nstruct ocs_dll_desc {\n\tvoid\t\t*vaddr;\n\tdma_addr_t\tdma_addr;\n\tsize_t\t\tsize;\n};\n\nint ocs_aes_set_key(struct ocs_aes_dev *aes_dev, const u32 key_size,\n\t\t    const u8 *key, const enum ocs_cipher cipher);\n\nint ocs_aes_op(struct ocs_aes_dev *aes_dev,\n\t       enum ocs_mode mode,\n\t       enum ocs_cipher cipher,\n\t       enum ocs_instruction instruction,\n\t       dma_addr_t dst_dma_list,\n\t       dma_addr_t src_dma_list,\n\t       u32 src_size,\n\t       u8 *iv,\n\t       u32 iv_size);\n\n \nstatic inline int ocs_aes_bypass_op(struct ocs_aes_dev *aes_dev,\n\t\t\t\t    dma_addr_t dst_dma_list,\n\t\t\t\t    dma_addr_t src_dma_list, u32 src_size)\n{\n\treturn ocs_aes_op(aes_dev, OCS_MODE_ECB, OCS_AES, OCS_BYPASS,\n\t\t\t  dst_dma_list, src_dma_list, src_size, NULL, 0);\n}\n\nint ocs_aes_gcm_op(struct ocs_aes_dev *aes_dev,\n\t\t   enum ocs_cipher cipher,\n\t\t   enum ocs_instruction instruction,\n\t\t   dma_addr_t dst_dma_list,\n\t\t   dma_addr_t src_dma_list,\n\t\t   u32 src_size,\n\t\t   const u8 *iv,\n\t\t   dma_addr_t aad_dma_list,\n\t\t   u32 aad_size,\n\t\t   u8 *out_tag,\n\t\t   u32 tag_size);\n\nint ocs_aes_ccm_op(struct ocs_aes_dev *aes_dev,\n\t\t   enum ocs_cipher cipher,\n\t\t   enum ocs_instruction instruction,\n\t\t   dma_addr_t dst_dma_list,\n\t\t   dma_addr_t src_dma_list,\n\t\t   u32 src_size,\n\t\t   u8 *iv,\n\t\t   dma_addr_t adata_dma_list,\n\t\t   u32 adata_size,\n\t\t   u8 *in_tag,\n\t\t   u32 tag_size);\n\nint ocs_create_linked_list_from_sg(const struct ocs_aes_dev *aes_dev,\n\t\t\t\t   struct scatterlist *sg,\n\t\t\t\t   int sg_dma_count,\n\t\t\t\t   struct ocs_dll_desc *dll_desc,\n\t\t\t\t   size_t data_size,\n\t\t\t\t   size_t data_offset);\n\nirqreturn_t ocs_aes_irq_handler(int irq, void *dev_id);\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}