{
  "module_name": "ocs-hcu.h",
  "hash_id": "6b5ade7086bdf4267a8b47f6e8db2f145023fef7c626d3a66e20bb176f640ad0",
  "original_prompt": "Ingested from linux-6.6.14/drivers/crypto/intel/keembay/ocs-hcu.h",
  "human_readable_source": " \n \n\n#include <linux/dma-mapping.h>\n\n#ifndef _CRYPTO_OCS_HCU_H\n#define _CRYPTO_OCS_HCU_H\n\n#define OCS_HCU_DMA_BIT_MASK\t\tDMA_BIT_MASK(32)\n\n#define OCS_HCU_HW_KEY_LEN\t\t64\n\nstruct ocs_hcu_dma_list;\n\nenum ocs_hcu_algo {\n\tOCS_HCU_ALGO_SHA256 = 2,\n\tOCS_HCU_ALGO_SHA224 = 3,\n\tOCS_HCU_ALGO_SHA384 = 4,\n\tOCS_HCU_ALGO_SHA512 = 5,\n\tOCS_HCU_ALGO_SM3    = 6,\n};\n\n \nstruct ocs_hcu_dev {\n\tstruct list_head list;\n\tstruct device *dev;\n\tvoid __iomem *io_base;\n\tstruct crypto_engine *engine;\n\tint irq;\n\tstruct completion irq_done;\n\tbool irq_err;\n};\n\n \nstruct ocs_hcu_idata {\n\tu32 msg_len_lo;\n\tu32 msg_len_hi;\n\tu8  digest[SHA512_DIGEST_SIZE];\n};\n\n \nstruct ocs_hcu_hash_ctx {\n\tenum ocs_hcu_algo\talgo;\n\tstruct ocs_hcu_idata\tidata;\n};\n\nirqreturn_t ocs_hcu_irq_handler(int irq, void *dev_id);\n\nstruct ocs_hcu_dma_list *ocs_hcu_dma_list_alloc(struct ocs_hcu_dev *hcu_dev,\n\t\t\t\t\t\tint max_nents);\n\nvoid ocs_hcu_dma_list_free(struct ocs_hcu_dev *hcu_dev,\n\t\t\t   struct ocs_hcu_dma_list *dma_list);\n\nint ocs_hcu_dma_list_add_tail(struct ocs_hcu_dev *hcu_dev,\n\t\t\t      struct ocs_hcu_dma_list *dma_list,\n\t\t\t      dma_addr_t addr, u32 len);\n\nint ocs_hcu_hash_init(struct ocs_hcu_hash_ctx *ctx, enum ocs_hcu_algo algo);\n\nint ocs_hcu_hash_update(struct ocs_hcu_dev *hcu_dev,\n\t\t\tstruct ocs_hcu_hash_ctx *ctx,\n\t\t\tconst struct ocs_hcu_dma_list *dma_list);\n\nint ocs_hcu_hash_finup(struct ocs_hcu_dev *hcu_dev,\n\t\t       const struct ocs_hcu_hash_ctx *ctx,\n\t\t       const struct ocs_hcu_dma_list *dma_list,\n\t\t       u8 *dgst, size_t dgst_len);\n\nint ocs_hcu_hash_final(struct ocs_hcu_dev *hcu_dev,\n\t\t       const struct ocs_hcu_hash_ctx *ctx, u8 *dgst,\n\t\t       size_t dgst_len);\n\nint ocs_hcu_digest(struct ocs_hcu_dev *hcu_dev, enum ocs_hcu_algo algo,\n\t\t   void *data, size_t data_len, u8 *dgst, size_t dgst_len);\n\nint ocs_hcu_hmac(struct ocs_hcu_dev *hcu_dev, enum ocs_hcu_algo algo,\n\t\t const u8 *key, size_t key_len,\n\t\t const struct ocs_hcu_dma_list *dma_list,\n\t\t u8 *dgst, size_t dgst_len);\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}