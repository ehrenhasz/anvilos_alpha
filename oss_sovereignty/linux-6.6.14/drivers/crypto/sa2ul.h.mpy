{
  "module_name": "sa2ul.h",
  "hash_id": "c367e37dd3e66ce9d2f6b93f5ced0b9c0d366341e78f993867a11c1f6adc12ad",
  "original_prompt": "Ingested from linux-6.6.14/drivers/crypto/sa2ul.h",
  "human_readable_source": " \n \n\n#ifndef _K3_SA2UL_\n#define _K3_SA2UL_\n\n#include <crypto/aes.h>\n#include <crypto/sha1.h>\n#include <crypto/sha2.h>\n\n#define SA_ENGINE_STATUS\t\t0x0008\n#define SA_ENGINE_ENABLE_CONTROL\t0x1000\n\nstruct sa_tfm_ctx;\n \n#define SA_EEC_ENCSS_EN\t\t\t0x00000001\n#define SA_EEC_AUTHSS_EN\t\t0x00000002\n#define SA_EEC_TRNG_EN\t\t\t0x00000008\n#define SA_EEC_PKA_EN\t\t\t0x00000010\n#define SA_EEC_CTXCACH_EN\t\t0x00000080\n#define SA_EEC_CPPI_PORT_IN_EN\t\t0x00000200\n#define SA_EEC_CPPI_PORT_OUT_EN\t\t0x00000800\n\n \n#define SA_REQ_SUBTYPE_ENC\t0x0001\n#define SA_REQ_SUBTYPE_DEC\t0x0002\n#define SA_REQ_SUBTYPE_SHIFT\t16\n#define SA_REQ_SUBTYPE_MASK\t0xffff\n\n \n#define SA_DMA_NUM_EPIB_WORDS   4\n\n \n#define SA_DMA_NUM_PS_WORDS     16\n#define NKEY_SZ\t\t\t3\n#define MCI_SZ\t\t\t27\n\n \n#define SA_MAX_NUM_CTX\t512\n\n \n#define SA_CTX_SIZE_TO_DMA_SIZE(ctx_sz) \\\n\t\t((ctx_sz) ? ((ctx_sz) / 32 - 1) : 0)\n\n#define SA_CTX_ENC_KEY_OFFSET   32\n#define SA_CTX_ENC_AUX1_OFFSET  64\n#define SA_CTX_ENC_AUX2_OFFSET  96\n#define SA_CTX_ENC_AUX3_OFFSET  112\n#define SA_CTX_ENC_AUX4_OFFSET  128\n\n \n#define SA_ENG_ID_EM1   2        \n#define SA_ENG_ID_EM2   3        \n#define SA_ENG_ID_AM1   4        \n#define SA_ENG_ID_AM2   5        \n#define SA_ENG_ID_OUTPORT2 20    \n\n \n#define SA_CMDL_OFFSET_NESC           0       \n#define SA_CMDL_OFFSET_LABEL_LEN      1       \n \n#define SA_CMDL_OFFSET_DATA_LEN       2\n#define SA_CMDL_OFFSET_DATA_OFFSET    4       \n#define SA_CMDL_OFFSET_OPTION_CTRL1   5       \n#define SA_CMDL_OFFSET_OPTION_CTRL2   6       \n#define SA_CMDL_OFFSET_OPTION_CTRL3   7       \n#define SA_CMDL_OFFSET_OPTION_BYTE    8\n\n#define SA_CMDL_HEADER_SIZE_BYTES\t8\n\n#define SA_CMDL_OPTION_BYTES_MAX_SIZE     72\n#define SA_CMDL_MAX_SIZE_BYTES (SA_CMDL_HEADER_SIZE_BYTES + \\\n\t\t\t\tSA_CMDL_OPTION_BYTES_MAX_SIZE)\n\n \n#define SA_SW_INFO_FLAG_EVICT   0x0001\n#define SA_SW_INFO_FLAG_TEAR    0x0002\n#define SA_SW_INFO_FLAG_NOPD    0x0004\n\n \n#define SA_CTX_PE_PKT_TYPE_3GPP_AIR    0     \n#define SA_CTX_PE_PKT_TYPE_SRTP        1     \n#define SA_CTX_PE_PKT_TYPE_IPSEC_AH    2     \n \n#define SA_CTX_PE_PKT_TYPE_IPSEC_ESP   3\n \n#define SA_CTX_PE_PKT_TYPE_NONE        4\n#define SA_CTX_ENC_TYPE1_SZ     64       \n#define SA_CTX_ENC_TYPE2_SZ     96       \n\n#define SA_CTX_AUTH_TYPE1_SZ    64       \n#define SA_CTX_AUTH_TYPE2_SZ    96       \n \n#define SA_CTX_PHP_PE_CTX_SZ    64\n\n#define SA_CTX_MAX_SZ (64 + SA_CTX_ENC_TYPE2_SZ + SA_CTX_AUTH_TYPE2_SZ)\n\n \n#define SA_CTX_DMA_SIZE_0       0\n#define SA_CTX_DMA_SIZE_64      1\n#define SA_CTX_DMA_SIZE_96      2\n#define SA_CTX_DMA_SIZE_128     3\n\n \n#define SA_CTX_SCCTL_OWNER_OFFSET 0\n\n#define SA_CTX_ENC_KEY_OFFSET   32\n#define SA_CTX_ENC_AUX1_OFFSET  64\n#define SA_CTX_ENC_AUX2_OFFSET  96\n#define SA_CTX_ENC_AUX3_OFFSET  112\n#define SA_CTX_ENC_AUX4_OFFSET  128\n\n#define SA_SCCTL_FE_AUTH_ENC\t0x65\n#define SA_SCCTL_FE_ENC\t\t0x8D\n\n#define SA_ALIGN_MASK\t\t(sizeof(u32) - 1)\n#define SA_ALIGNED\t\t__aligned(32)\n\n#define SA_AUTH_SW_CTRL_MD5\t1\n#define SA_AUTH_SW_CTRL_SHA1\t2\n#define SA_AUTH_SW_CTRL_SHA224\t3\n#define SA_AUTH_SW_CTRL_SHA256\t4\n#define SA_AUTH_SW_CTRL_SHA384\t5\n#define SA_AUTH_SW_CTRL_SHA512\t6\n\n \n#define SA_MAX_DATA_SZ\t\tU16_MAX\n\n \n#define SA_UNSAFE_DATA_SZ_MIN\t240\n#define SA_UNSAFE_DATA_SZ_MAX\t255\n\nstruct sa_match_data;\n\n \nstruct sa_crypto_data {\n\tvoid __iomem *base;\n\tconst struct sa_match_data *match_data;\n\tstruct platform_device\t*pdev;\n\tstruct dma_pool\t\t*sc_pool;\n\tstruct device *dev;\n\tspinlock_t\tscid_lock;  \n\t \n\tu16\t\tsc_id_start;\n\tu16\t\tsc_id_end;\n\tu16\t\tsc_id;\n\tunsigned long\tctx_bm[DIV_ROUND_UP(SA_MAX_NUM_CTX,\n\t\t\t\tBITS_PER_LONG)];\n\tstruct sa_tfm_ctx\t*ctx;\n\tstruct dma_chan\t\t*dma_rx1;\n\tstruct dma_chan\t\t*dma_rx2;\n\tstruct dma_chan\t\t*dma_tx;\n};\n\n \nstruct sa_cmdl_param_info {\n\tu16\tindex;\n\tu16\toffset;\n\tu16\tsize;\n};\n\n \n#define SA_MAX_AUX_DATA_WORDS\t8\n\n \nstruct sa_cmdl_upd_info {\n\tu16\tflags;\n\tu16\tsubmode;\n\tstruct sa_cmdl_param_info\tenc_size;\n\tstruct sa_cmdl_param_info\tenc_size2;\n\tstruct sa_cmdl_param_info\tenc_offset;\n\tstruct sa_cmdl_param_info\tenc_iv;\n\tstruct sa_cmdl_param_info\tenc_iv2;\n\tstruct sa_cmdl_param_info\taad;\n\tstruct sa_cmdl_param_info\tpayload;\n\tstruct sa_cmdl_param_info\tauth_size;\n\tstruct sa_cmdl_param_info\tauth_size2;\n\tstruct sa_cmdl_param_info\tauth_offset;\n\tstruct sa_cmdl_param_info\tauth_iv;\n\tstruct sa_cmdl_param_info\taux_key_info;\n\tu32\t\t\t\taux_key[SA_MAX_AUX_DATA_WORDS];\n};\n\n \n#define SA_PSDATA_CTX_WORDS 4\n\n \n#define SA_MAX_CMDL_WORDS (SA_DMA_NUM_PS_WORDS - SA_PSDATA_CTX_WORDS)\n\n \nstruct sa_ctx_info {\n\tu8\t\t*sc;\n\tdma_addr_t\tsc_phys;\n\tu16\t\tsc_id;\n\tu16\t\tcmdl_size;\n\tu32\t\tcmdl[SA_MAX_CMDL_WORDS];\n\tstruct sa_cmdl_upd_info cmdl_upd_info;\n\t \n\tu32\t\tepib[SA_DMA_NUM_EPIB_WORDS];\n};\n\n \nstruct sa_tfm_ctx {\n\tstruct sa_crypto_data *dev_data;\n\tstruct sa_ctx_info enc;\n\tstruct sa_ctx_info dec;\n\tstruct sa_ctx_info auth;\n\tint keylen;\n\tint iv_idx;\n\tu32 key[AES_KEYSIZE_256 / sizeof(u32)];\n\tu8 authkey[SHA512_BLOCK_SIZE];\n\tstruct crypto_shash\t*shash;\n\t \n\tunion {\n\t\tstruct crypto_skcipher\t\t*skcipher;\n\t\tstruct crypto_ahash\t\t*ahash;\n\t\tstruct crypto_aead\t\t*aead;\n\t} fallback;\n};\n\n \nstruct sa_sha_req_ctx {\n\tstruct sa_crypto_data\t*dev_data;\n\tu32\t\t\tcmdl[SA_MAX_CMDL_WORDS + SA_PSDATA_CTX_WORDS];\n\tstruct ahash_request\tfallback_req;\n};\n\nenum sa_submode {\n\tSA_MODE_GEN = 0,\n\tSA_MODE_CCM,\n\tSA_MODE_GCM,\n\tSA_MODE_GMAC\n};\n\n \nenum sa_ealg_id {\n\tSA_EALG_ID_NONE = 0,         \n\tSA_EALG_ID_NULL,             \n\tSA_EALG_ID_AES_CTR,          \n\tSA_EALG_ID_AES_F8,           \n\tSA_EALG_ID_AES_CBC,          \n\tSA_EALG_ID_DES_CBC,          \n\tSA_EALG_ID_3DES_CBC,         \n\tSA_EALG_ID_CCM,              \n\tSA_EALG_ID_GCM,              \n\tSA_EALG_ID_AES_ECB,\n\tSA_EALG_ID_LAST\n};\n\n \nenum sa_aalg_id {\n\tSA_AALG_ID_NONE = 0,       \n\tSA_AALG_ID_NULL = SA_EALG_ID_LAST,  \n\tSA_AALG_ID_MD5,            \n\tSA_AALG_ID_SHA1,           \n\tSA_AALG_ID_SHA2_224,       \n\tSA_AALG_ID_SHA2_256,       \n\tSA_AALG_ID_SHA2_512,       \n\tSA_AALG_ID_HMAC_MD5,       \n\tSA_AALG_ID_HMAC_SHA1,      \n\tSA_AALG_ID_HMAC_SHA2_224,  \n\tSA_AALG_ID_HMAC_SHA2_256,  \n\tSA_AALG_ID_GMAC,           \n\tSA_AALG_ID_CMAC,           \n\tSA_AALG_ID_CBC_MAC,        \n\tSA_AALG_ID_AES_XCBC        \n};\n\n \nenum sa_eng_algo_id {\n\tSA_ENG_ALGO_ECB = 0,\n\tSA_ENG_ALGO_CBC,\n\tSA_ENG_ALGO_CFB,\n\tSA_ENG_ALGO_OFB,\n\tSA_ENG_ALGO_CTR,\n\tSA_ENG_ALGO_F8,\n\tSA_ENG_ALGO_F8F9,\n\tSA_ENG_ALGO_GCM,\n\tSA_ENG_ALGO_GMAC,\n\tSA_ENG_ALGO_CCM,\n\tSA_ENG_ALGO_CMAC,\n\tSA_ENG_ALGO_CBCMAC,\n\tSA_NUM_ENG_ALGOS\n};\n\n \nstruct sa_eng_info {\n\tu8\teng_id;\n\tu16\tsc_size;\n};\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}