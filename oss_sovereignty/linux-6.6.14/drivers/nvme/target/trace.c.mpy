{
  "module_name": "trace.c",
  "hash_id": "9f47b8dfd282a1a697c0bad8fbac23c339910910d94f9387b9465173d7fe5044",
  "original_prompt": "Ingested from linux-6.6.14/drivers/nvme/target/trace.c",
  "human_readable_source": "\n \n\n#include <asm/unaligned.h>\n#include \"trace.h\"\n\nstatic const char *nvmet_trace_admin_identify(struct trace_seq *p, u8 *cdw10)\n{\n\tconst char *ret = trace_seq_buffer_ptr(p);\n\tu8 cns = cdw10[0];\n\tu16 ctrlid = get_unaligned_le16(cdw10 + 2);\n\n\ttrace_seq_printf(p, \"cns=%u, ctrlid=%u\", cns, ctrlid);\n\ttrace_seq_putc(p, 0);\n\n\treturn ret;\n}\n\nstatic const char *nvmet_trace_admin_get_features(struct trace_seq *p,\n\t\t\t\t\t\t u8 *cdw10)\n{\n\tconst char *ret = trace_seq_buffer_ptr(p);\n\tu8 fid = cdw10[0];\n\tu8 sel = cdw10[1] & 0x7;\n\tu32 cdw11 = get_unaligned_le32(cdw10 + 4);\n\n\ttrace_seq_printf(p, \"fid=0x%x, sel=0x%x, cdw11=0x%x\", fid, sel, cdw11);\n\ttrace_seq_putc(p, 0);\n\n\treturn ret;\n}\n\nstatic const char *nvmet_trace_get_lba_status(struct trace_seq *p,\n\t\t\t\t\t     u8 *cdw10)\n{\n\tconst char *ret = trace_seq_buffer_ptr(p);\n\tu64 slba = get_unaligned_le64(cdw10);\n\tu32 mndw = get_unaligned_le32(cdw10 + 8);\n\tu16 rl = get_unaligned_le16(cdw10 + 12);\n\tu8 atype = cdw10[15];\n\n\ttrace_seq_printf(p, \"slba=0x%llx, mndw=0x%x, rl=0x%x, atype=%u\",\n\t\t\tslba, mndw, rl, atype);\n\ttrace_seq_putc(p, 0);\n\n\treturn ret;\n}\n\nstatic const char *nvmet_trace_admin_set_features(struct trace_seq *p,\n\t\t\t\t\t\t u8 *cdw10)\n{\n\tconst char *ret = trace_seq_buffer_ptr(p);\n\tu8 fid = cdw10[0];\n\tu8 sv = cdw10[3] & 0x8;\n\tu32 cdw11 = get_unaligned_le32(cdw10 + 4);\n\n\ttrace_seq_printf(p, \"fid=0x%x, sv=0x%x, cdw11=0x%x\", fid, sv, cdw11);\n\ttrace_seq_putc(p, 0);\n\n\treturn ret;\n}\n\nstatic const char *nvmet_trace_read_write(struct trace_seq *p, u8 *cdw10)\n{\n\tconst char *ret = trace_seq_buffer_ptr(p);\n\tu64 slba = get_unaligned_le64(cdw10);\n\tu16 length = get_unaligned_le16(cdw10 + 8);\n\tu16 control = get_unaligned_le16(cdw10 + 10);\n\tu32 dsmgmt = get_unaligned_le32(cdw10 + 12);\n\tu32 reftag = get_unaligned_le32(cdw10 +  16);\n\n\ttrace_seq_printf(p,\n\t\t\t \"slba=%llu, len=%u, ctrl=0x%x, dsmgmt=%u, reftag=%u\",\n\t\t\t slba, length, control, dsmgmt, reftag);\n\ttrace_seq_putc(p, 0);\n\n\treturn ret;\n}\n\nstatic const char *nvmet_trace_dsm(struct trace_seq *p, u8 *cdw10)\n{\n\tconst char *ret = trace_seq_buffer_ptr(p);\n\n\ttrace_seq_printf(p, \"nr=%u, attributes=%u\",\n\t\t\t get_unaligned_le32(cdw10),\n\t\t\t get_unaligned_le32(cdw10 + 4));\n\ttrace_seq_putc(p, 0);\n\n\treturn ret;\n}\n\nstatic const char *nvmet_trace_common(struct trace_seq *p, u8 *cdw10)\n{\n\tconst char *ret = trace_seq_buffer_ptr(p);\n\n\ttrace_seq_printf(p, \"cdw10=%*ph\", 24, cdw10);\n\ttrace_seq_putc(p, 0);\n\n\treturn ret;\n}\n\nconst char *nvmet_trace_parse_admin_cmd(struct trace_seq *p,\n\t\tu8 opcode, u8 *cdw10)\n{\n\tswitch (opcode) {\n\tcase nvme_admin_identify:\n\t\treturn nvmet_trace_admin_identify(p, cdw10);\n\tcase nvme_admin_set_features:\n\t\treturn nvmet_trace_admin_set_features(p, cdw10);\n\tcase nvme_admin_get_features:\n\t\treturn nvmet_trace_admin_get_features(p, cdw10);\n\tcase nvme_admin_get_lba_status:\n\t\treturn nvmet_trace_get_lba_status(p, cdw10);\n\tdefault:\n\t\treturn nvmet_trace_common(p, cdw10);\n\t}\n}\n\nconst char *nvmet_trace_parse_nvm_cmd(struct trace_seq *p,\n\t\tu8 opcode, u8 *cdw10)\n{\n\tswitch (opcode) {\n\tcase nvme_cmd_read:\n\tcase nvme_cmd_write:\n\tcase nvme_cmd_write_zeroes:\n\t\treturn nvmet_trace_read_write(p, cdw10);\n\tcase nvme_cmd_dsm:\n\t\treturn nvmet_trace_dsm(p, cdw10);\n\tdefault:\n\t\treturn nvmet_trace_common(p, cdw10);\n\t}\n}\n\nstatic const char *nvmet_trace_fabrics_property_set(struct trace_seq *p,\n\t\tu8 *spc)\n{\n\tconst char *ret = trace_seq_buffer_ptr(p);\n\tu8 attrib = spc[0];\n\tu32 ofst = get_unaligned_le32(spc + 4);\n\tu64 value = get_unaligned_le64(spc + 8);\n\n\ttrace_seq_printf(p, \"attrib=%u, ofst=0x%x, value=0x%llx\",\n\t\t\t attrib, ofst, value);\n\ttrace_seq_putc(p, 0);\n\treturn ret;\n}\n\nstatic const char *nvmet_trace_fabrics_connect(struct trace_seq *p,\n\t\tu8 *spc)\n{\n\tconst char *ret = trace_seq_buffer_ptr(p);\n\tu16 recfmt = get_unaligned_le16(spc);\n\tu16 qid = get_unaligned_le16(spc + 2);\n\tu16 sqsize = get_unaligned_le16(spc + 4);\n\tu8 cattr = spc[6];\n\tu32 kato = get_unaligned_le32(spc + 8);\n\n\ttrace_seq_printf(p, \"recfmt=%u, qid=%u, sqsize=%u, cattr=%u, kato=%u\",\n\t\t\t recfmt, qid, sqsize, cattr, kato);\n\ttrace_seq_putc(p, 0);\n\treturn ret;\n}\n\nstatic const char *nvmet_trace_fabrics_property_get(struct trace_seq *p,\n\t\tu8 *spc)\n{\n\tconst char *ret = trace_seq_buffer_ptr(p);\n\tu8 attrib = spc[0];\n\tu32 ofst = get_unaligned_le32(spc + 4);\n\n\ttrace_seq_printf(p, \"attrib=%u, ofst=0x%x\", attrib, ofst);\n\ttrace_seq_putc(p, 0);\n\treturn ret;\n}\n\nstatic const char *nvmet_trace_fabrics_common(struct trace_seq *p, u8 *spc)\n{\n\tconst char *ret = trace_seq_buffer_ptr(p);\n\n\ttrace_seq_printf(p, \"specific=%*ph\", 24, spc);\n\ttrace_seq_putc(p, 0);\n\treturn ret;\n}\n\nconst char *nvmet_trace_parse_fabrics_cmd(struct trace_seq *p,\n\t\tu8 fctype, u8 *spc)\n{\n\tswitch (fctype) {\n\tcase nvme_fabrics_type_property_set:\n\t\treturn nvmet_trace_fabrics_property_set(p, spc);\n\tcase nvme_fabrics_type_connect:\n\t\treturn nvmet_trace_fabrics_connect(p, spc);\n\tcase nvme_fabrics_type_property_get:\n\t\treturn nvmet_trace_fabrics_property_get(p, spc);\n\tdefault:\n\t\treturn nvmet_trace_fabrics_common(p, spc);\n\t}\n}\n\nconst char *nvmet_trace_disk_name(struct trace_seq *p, char *name)\n{\n\tconst char *ret = trace_seq_buffer_ptr(p);\n\n\tif (*name)\n\t\ttrace_seq_printf(p, \"disk=%s, \", name);\n\ttrace_seq_putc(p, 0);\n\n\treturn ret;\n}\n\nconst char *nvmet_trace_ctrl_name(struct trace_seq *p, struct nvmet_ctrl *ctrl)\n{\n\tconst char *ret = trace_seq_buffer_ptr(p);\n\n\t \n\tif (ctrl)\n\t\ttrace_seq_printf(p, \"%d\", ctrl->cntlid);\n\telse\n\t\ttrace_seq_printf(p, \"_\");\n\ttrace_seq_putc(p, 0);\n\n\treturn ret;\n}\n\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}