{
  "module_name": "fc.h",
  "hash_id": "481266ece5be92a2b6db75813024169d8641fb01f4ddb3c61ab94ac1982c624f",
  "original_prompt": "Ingested from linux-6.6.14/drivers/nvme/host/fc.h",
  "human_readable_source": " \n \n\n#ifndef _NVME_FC_TRANSPORT_H\n#define _NVME_FC_TRANSPORT_H 1\n\n\n \n\n \n\nunion nvmefc_ls_requests {\n\tstruct fcnvme_ls_rqst_w0\t\tw0;\n\tstruct fcnvme_ls_cr_assoc_rqst\t\trq_cr_assoc;\n\tstruct fcnvme_ls_cr_conn_rqst\t\trq_cr_conn;\n\tstruct fcnvme_ls_disconnect_assoc_rqst\trq_dis_assoc;\n\tstruct fcnvme_ls_disconnect_conn_rqst\trq_dis_conn;\n} __aligned(128);\t \n\nunion nvmefc_ls_responses {\n\tstruct fcnvme_ls_rjt\t\t\trsp_rjt;\n\tstruct fcnvme_ls_cr_assoc_acc\t\trsp_cr_assoc;\n\tstruct fcnvme_ls_cr_conn_acc\t\trsp_cr_conn;\n\tstruct fcnvme_ls_disconnect_assoc_acc\trsp_dis_assoc;\n\tstruct fcnvme_ls_disconnect_conn_acc\trsp_dis_conn;\n} __aligned(128);\t \n\nstatic inline void\nnvme_fc_format_rsp_hdr(void *buf, u8 ls_cmd, __be32 desc_len, u8 rqst_ls_cmd)\n{\n\tstruct fcnvme_ls_acc_hdr *acc = buf;\n\n\tacc->w0.ls_cmd = ls_cmd;\n\tacc->desc_list_len = desc_len;\n\tacc->rqst.desc_tag = cpu_to_be32(FCNVME_LSDESC_RQST);\n\tacc->rqst.desc_len =\n\t\t\tfcnvme_lsdesc_len(sizeof(struct fcnvme_lsdesc_rqst));\n\tacc->rqst.w0.ls_cmd = rqst_ls_cmd;\n}\n\nstatic inline int\nnvme_fc_format_rjt(void *buf, u16 buflen, u8 ls_cmd,\n\t\t\tu8 reason, u8 explanation, u8 vendor)\n{\n\tstruct fcnvme_ls_rjt *rjt = buf;\n\n\tnvme_fc_format_rsp_hdr(buf, FCNVME_LSDESC_RQST,\n\t\t\tfcnvme_lsdesc_len(sizeof(struct fcnvme_ls_rjt)),\n\t\t\tls_cmd);\n\trjt->rjt.desc_tag = cpu_to_be32(FCNVME_LSDESC_RJT);\n\trjt->rjt.desc_len = fcnvme_lsdesc_len(sizeof(struct fcnvme_lsdesc_rjt));\n\trjt->rjt.reason_code = reason;\n\trjt->rjt.reason_explanation = explanation;\n\trjt->rjt.vendor = vendor;\n\n\treturn sizeof(struct fcnvme_ls_rjt);\n}\n\n \nenum {\n\tVERR_NO_ERROR\t\t= 0,\n\tVERR_CR_ASSOC_LEN\t= 1,\n\tVERR_CR_ASSOC_RQST_LEN\t= 2,\n\tVERR_CR_ASSOC_CMD\t= 3,\n\tVERR_CR_ASSOC_CMD_LEN\t= 4,\n\tVERR_ERSP_RATIO\t\t= 5,\n\tVERR_ASSOC_ALLOC_FAIL\t= 6,\n\tVERR_QUEUE_ALLOC_FAIL\t= 7,\n\tVERR_CR_CONN_LEN\t= 8,\n\tVERR_CR_CONN_RQST_LEN\t= 9,\n\tVERR_ASSOC_ID\t\t= 10,\n\tVERR_ASSOC_ID_LEN\t= 11,\n\tVERR_NO_ASSOC\t\t= 12,\n\tVERR_CONN_ID\t\t= 13,\n\tVERR_CONN_ID_LEN\t= 14,\n\tVERR_INVAL_CONN\t\t= 15,\n\tVERR_CR_CONN_CMD\t= 16,\n\tVERR_CR_CONN_CMD_LEN\t= 17,\n\tVERR_DISCONN_LEN\t= 18,\n\tVERR_DISCONN_RQST_LEN\t= 19,\n\tVERR_DISCONN_CMD\t= 20,\n\tVERR_DISCONN_CMD_LEN\t= 21,\n\tVERR_DISCONN_SCOPE\t= 22,\n\tVERR_RS_LEN\t\t= 23,\n\tVERR_RS_RQST_LEN\t= 24,\n\tVERR_RS_CMD\t\t= 25,\n\tVERR_RS_CMD_LEN\t\t= 26,\n\tVERR_RS_RCTL\t\t= 27,\n\tVERR_RS_RO\t\t= 28,\n\tVERR_LSACC\t\t= 29,\n\tVERR_LSDESC_RQST\t= 30,\n\tVERR_LSDESC_RQST_LEN\t= 31,\n\tVERR_CR_ASSOC\t\t= 32,\n\tVERR_CR_ASSOC_ACC_LEN\t= 33,\n\tVERR_CR_CONN\t\t= 34,\n\tVERR_CR_CONN_ACC_LEN\t= 35,\n\tVERR_DISCONN\t\t= 36,\n\tVERR_DISCONN_ACC_LEN\t= 37,\n};\n\nstatic char *validation_errors[] = {\n\t\"OK\",\n\t\"Bad CR_ASSOC Length\",\n\t\"Bad CR_ASSOC Rqst Length\",\n\t\"Not CR_ASSOC Cmd\",\n\t\"Bad CR_ASSOC Cmd Length\",\n\t\"Bad Ersp Ratio\",\n\t\"Association Allocation Failed\",\n\t\"Queue Allocation Failed\",\n\t\"Bad CR_CONN Length\",\n\t\"Bad CR_CONN Rqst Length\",\n\t\"Not Association ID\",\n\t\"Bad Association ID Length\",\n\t\"No Association\",\n\t\"Not Connection ID\",\n\t\"Bad Connection ID Length\",\n\t\"Invalid Connection ID\",\n\t\"Not CR_CONN Cmd\",\n\t\"Bad CR_CONN Cmd Length\",\n\t\"Bad DISCONN Length\",\n\t\"Bad DISCONN Rqst Length\",\n\t\"Not DISCONN Cmd\",\n\t\"Bad DISCONN Cmd Length\",\n\t\"Bad Disconnect Scope\",\n\t\"Bad RS Length\",\n\t\"Bad RS Rqst Length\",\n\t\"Not RS Cmd\",\n\t\"Bad RS Cmd Length\",\n\t\"Bad RS R_CTL\",\n\t\"Bad RS Relative Offset\",\n\t\"Not LS_ACC\",\n\t\"Not LSDESC_RQST\",\n\t\"Bad LSDESC_RQST Length\",\n\t\"Not CR_ASSOC Rqst\",\n\t\"Bad CR_ASSOC ACC Length\",\n\t\"Not CR_CONN Rqst\",\n\t\"Bad CR_CONN ACC Length\",\n\t\"Not Disconnect Rqst\",\n\t\"Bad Disconnect ACC Length\",\n};\n\n#define NVME_FC_LAST_LS_CMD_VALUE\tFCNVME_LS_DISCONNECT_CONN\n\nstatic char *nvmefc_ls_names[] = {\n\t\"Reserved (0)\",\n\t\"RJT (1)\",\n\t\"ACC (2)\",\n\t\"Create Association\",\n\t\"Create Connection\",\n\t\"Disconnect Association\",\n\t\"Disconnect Connection\",\n};\n\nstatic inline void\nnvmefc_fmt_lsreq_discon_assoc(struct nvmefc_ls_req *lsreq,\n\tstruct fcnvme_ls_disconnect_assoc_rqst *discon_rqst,\n\tstruct fcnvme_ls_disconnect_assoc_acc *discon_acc,\n\tu64 association_id)\n{\n\tlsreq->rqstaddr = discon_rqst;\n\tlsreq->rqstlen = sizeof(*discon_rqst);\n\tlsreq->rspaddr = discon_acc;\n\tlsreq->rsplen = sizeof(*discon_acc);\n\tlsreq->timeout = NVME_FC_LS_TIMEOUT_SEC;\n\n\tdiscon_rqst->w0.ls_cmd = FCNVME_LS_DISCONNECT_ASSOC;\n\tdiscon_rqst->desc_list_len = cpu_to_be32(\n\t\t\t\tsizeof(struct fcnvme_lsdesc_assoc_id) +\n\t\t\t\tsizeof(struct fcnvme_lsdesc_disconn_cmd));\n\n\tdiscon_rqst->associd.desc_tag = cpu_to_be32(FCNVME_LSDESC_ASSOC_ID);\n\tdiscon_rqst->associd.desc_len =\n\t\t\tfcnvme_lsdesc_len(\n\t\t\t\tsizeof(struct fcnvme_lsdesc_assoc_id));\n\n\tdiscon_rqst->associd.association_id = cpu_to_be64(association_id);\n\n\tdiscon_rqst->discon_cmd.desc_tag = cpu_to_be32(\n\t\t\t\t\t\tFCNVME_LSDESC_DISCONN_CMD);\n\tdiscon_rqst->discon_cmd.desc_len =\n\t\t\tfcnvme_lsdesc_len(\n\t\t\t\tsizeof(struct fcnvme_lsdesc_disconn_cmd));\n}\n\nstatic inline int\nnvmefc_vldt_lsreq_discon_assoc(u32 rqstlen,\n\tstruct fcnvme_ls_disconnect_assoc_rqst *rqst)\n{\n\tint ret = 0;\n\n\tif (rqstlen < sizeof(struct fcnvme_ls_disconnect_assoc_rqst))\n\t\tret = VERR_DISCONN_LEN;\n\telse if (rqst->desc_list_len !=\n\t\t\tfcnvme_lsdesc_len(\n\t\t\t\tsizeof(struct fcnvme_ls_disconnect_assoc_rqst)))\n\t\tret = VERR_DISCONN_RQST_LEN;\n\telse if (rqst->associd.desc_tag != cpu_to_be32(FCNVME_LSDESC_ASSOC_ID))\n\t\tret = VERR_ASSOC_ID;\n\telse if (rqst->associd.desc_len !=\n\t\t\tfcnvme_lsdesc_len(\n\t\t\t\tsizeof(struct fcnvme_lsdesc_assoc_id)))\n\t\tret = VERR_ASSOC_ID_LEN;\n\telse if (rqst->discon_cmd.desc_tag !=\n\t\t\tcpu_to_be32(FCNVME_LSDESC_DISCONN_CMD))\n\t\tret = VERR_DISCONN_CMD;\n\telse if (rqst->discon_cmd.desc_len !=\n\t\t\tfcnvme_lsdesc_len(\n\t\t\t\tsizeof(struct fcnvme_lsdesc_disconn_cmd)))\n\t\tret = VERR_DISCONN_CMD_LEN;\n\t \n\telse if (rqst->discon_cmd.rsvd8[0])\n\t\tret = VERR_DISCONN_SCOPE;\n\n\treturn ret;\n}\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}