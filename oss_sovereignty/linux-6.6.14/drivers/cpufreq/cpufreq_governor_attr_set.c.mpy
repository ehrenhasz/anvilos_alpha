{
  "module_name": "cpufreq_governor_attr_set.c",
  "hash_id": "360b0520c170ccc580771c65e0c9ee65cb5ca9173520894e26b0a72722114766",
  "original_prompt": "Ingested from linux-6.6.14/drivers/cpufreq/cpufreq_governor_attr_set.c",
  "human_readable_source": "\n \n\n#include \"cpufreq_governor.h\"\n\nstatic inline struct governor_attr *to_gov_attr(struct attribute *attr)\n{\n\treturn container_of(attr, struct governor_attr, attr);\n}\n\nstatic ssize_t governor_show(struct kobject *kobj, struct attribute *attr,\n\t\t\t     char *buf)\n{\n\tstruct governor_attr *gattr = to_gov_attr(attr);\n\n\treturn gattr->show(to_gov_attr_set(kobj), buf);\n}\n\nstatic ssize_t governor_store(struct kobject *kobj, struct attribute *attr,\n\t\t\t      const char *buf, size_t count)\n{\n\tstruct gov_attr_set *attr_set = to_gov_attr_set(kobj);\n\tstruct governor_attr *gattr = to_gov_attr(attr);\n\tint ret;\n\n\tmutex_lock(&attr_set->update_lock);\n\tret = attr_set->usage_count ? gattr->store(attr_set, buf, count) : -EBUSY;\n\tmutex_unlock(&attr_set->update_lock);\n\treturn ret;\n}\n\nconst struct sysfs_ops governor_sysfs_ops = {\n\t.show\t= governor_show,\n\t.store\t= governor_store,\n};\nEXPORT_SYMBOL_GPL(governor_sysfs_ops);\n\nvoid gov_attr_set_init(struct gov_attr_set *attr_set, struct list_head *list_node)\n{\n\tINIT_LIST_HEAD(&attr_set->policy_list);\n\tmutex_init(&attr_set->update_lock);\n\tattr_set->usage_count = 1;\n\tlist_add(list_node, &attr_set->policy_list);\n}\nEXPORT_SYMBOL_GPL(gov_attr_set_init);\n\nvoid gov_attr_set_get(struct gov_attr_set *attr_set, struct list_head *list_node)\n{\n\tmutex_lock(&attr_set->update_lock);\n\tattr_set->usage_count++;\n\tlist_add(list_node, &attr_set->policy_list);\n\tmutex_unlock(&attr_set->update_lock);\n}\nEXPORT_SYMBOL_GPL(gov_attr_set_get);\n\nunsigned int gov_attr_set_put(struct gov_attr_set *attr_set, struct list_head *list_node)\n{\n\tunsigned int count;\n\n\tmutex_lock(&attr_set->update_lock);\n\tlist_del(list_node);\n\tcount = --attr_set->usage_count;\n\tmutex_unlock(&attr_set->update_lock);\n\tif (count)\n\t\treturn count;\n\n\tmutex_destroy(&attr_set->update_lock);\n\tkobject_put(&attr_set->kobj);\n\treturn 0;\n}\nEXPORT_SYMBOL_GPL(gov_attr_set_put);\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}