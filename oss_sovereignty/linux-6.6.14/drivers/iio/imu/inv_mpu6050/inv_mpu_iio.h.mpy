{
  "module_name": "inv_mpu_iio.h",
  "hash_id": "84209a99699e985a5f6d82a2602dfce001105dc55afeac145e0136eb6f32f959",
  "original_prompt": "Ingested from linux-6.6.14/drivers/iio/imu/inv_mpu6050/inv_mpu_iio.h",
  "human_readable_source": " \n \n\n#ifndef INV_MPU_IIO_H_\n#define INV_MPU_IIO_H_\n\n#include <linux/i2c.h>\n#include <linux/i2c-mux.h>\n#include <linux/mutex.h>\n#include <linux/platform_data/invensense_mpu6050.h>\n#include <linux/regmap.h>\n\n#include <linux/iio/buffer.h>\n#include <linux/iio/common/inv_sensors_timestamp.h>\n#include <linux/iio/iio.h>\n#include <linux/iio/kfifo_buf.h>\n#include <linux/iio/trigger.h>\n#include <linux/iio/triggered_buffer.h>\n#include <linux/iio/trigger_consumer.h>\n#include <linux/iio/sysfs.h>\n\n \nstruct inv_mpu6050_reg_map {\n\tu8 sample_rate_div;\n\tu8 lpf;\n\tu8 accel_lpf;\n\tu8 user_ctrl;\n\tu8 fifo_en;\n\tu8 gyro_config;\n\tu8 accl_config;\n\tu8 fifo_count_h;\n\tu8 fifo_r_w;\n\tu8 raw_gyro;\n\tu8 raw_accl;\n\tu8 temperature;\n\tu8 int_enable;\n\tu8 int_status;\n\tu8 pwr_mgmt_1;\n\tu8 pwr_mgmt_2;\n\tu8 int_pin_cfg;\n\tu8 accl_offset;\n\tu8 gyro_offset;\n\tu8 i2c_if;\n};\n\n \nenum inv_devices {\n\tINV_MPU6050,\n\tINV_MPU6500,\n\tINV_MPU6515,\n\tINV_MPU6880,\n\tINV_MPU6000,\n\tINV_MPU9150,\n\tINV_MPU9250,\n\tINV_MPU9255,\n\tINV_ICM20608,\n\tINV_ICM20608D,\n\tINV_ICM20609,\n\tINV_ICM20689,\n\tINV_ICM20600,\n\tINV_ICM20602,\n\tINV_ICM20690,\n\tINV_IAM20680,\n\tINV_NUM_PARTS\n};\n\n \n#define INV_MPU6050_SENSOR_ACCL\t\tBIT(0)\n#define INV_MPU6050_SENSOR_GYRO\t\tBIT(1)\n#define INV_MPU6050_SENSOR_TEMP\t\tBIT(2)\n#define INV_MPU6050_SENSOR_MAGN\t\tBIT(3)\n\n \nstruct inv_mpu6050_chip_config {\n\tunsigned int clk:3;\n\tunsigned int fsr:2;\n\tunsigned int lpf:3;\n\tunsigned int accl_fs:2;\n\tunsigned int accl_en:1;\n\tunsigned int gyro_en:1;\n\tunsigned int temp_en:1;\n\tunsigned int magn_en:1;\n\tunsigned int accl_fifo_enable:1;\n\tunsigned int gyro_fifo_enable:1;\n\tunsigned int temp_fifo_enable:1;\n\tunsigned int magn_fifo_enable:1;\n\tu8 divider;\n\tu8 user_ctrl;\n};\n\n \n#define INV_MPU6050_OUTPUT_DATA_SIZE         32\n\n \nstruct inv_mpu6050_hw {\n\tu8 whoami;\n\tu8 *name;\n\tconst struct inv_mpu6050_reg_map *reg;\n\tconst struct inv_mpu6050_chip_config *config;\n\tsize_t fifo_size;\n\tstruct {\n\t\tint offset;\n\t\tint scale;\n\t} temp;\n\tstruct {\n\t\tunsigned int accel;\n\t\tunsigned int gyro;\n\t} startup_time;\n};\n\n \nstruct inv_mpu6050_state {\n\tstruct mutex lock;\n\tstruct iio_trigger  *trig;\n\tstruct inv_mpu6050_chip_config chip_config;\n\tconst struct inv_mpu6050_reg_map *reg;\n\tconst struct inv_mpu6050_hw *hw;\n\tenum   inv_devices chip_type;\n\tstruct i2c_mux_core *muxc;\n\tstruct i2c_client *mux_client;\n\tstruct inv_mpu6050_platform_data plat_data;\n\tstruct iio_mount_matrix orientation;\n\tstruct regmap *map;\n\tint irq;\n\tu8 irq_mask;\n\tunsigned skip_samples;\n\tstruct inv_sensors_timestamp timestamp;\n\tstruct regulator *vdd_supply;\n\tstruct regulator *vddio_supply;\n\tbool magn_disabled;\n\ts32 magn_raw_to_gauss[3];\n\tstruct iio_mount_matrix magn_orient;\n\tunsigned int suspended_sensors;\n\tu8 *data;\n};\n\n \n#define INV_MPU6050_REG_ACCEL_OFFSET        0x06\n#define INV_MPU6050_REG_GYRO_OFFSET         0x13\n\n#define INV_MPU6050_REG_SAMPLE_RATE_DIV     0x19\n#define INV_MPU6050_REG_CONFIG              0x1A\n#define INV_MPU6050_REG_GYRO_CONFIG         0x1B\n#define INV_MPU6050_REG_ACCEL_CONFIG        0x1C\n\n#define INV_MPU6050_REG_FIFO_EN             0x23\n#define INV_MPU6050_BIT_SLAVE_0             0x01\n#define INV_MPU6050_BIT_SLAVE_1             0x02\n#define INV_MPU6050_BIT_SLAVE_2             0x04\n#define INV_MPU6050_BIT_ACCEL_OUT           0x08\n#define INV_MPU6050_BITS_GYRO_OUT           0x70\n#define INV_MPU6050_BIT_TEMP_OUT            0x80\n\n#define INV_MPU6050_REG_I2C_MST_CTRL        0x24\n#define INV_MPU6050_BITS_I2C_MST_CLK_400KHZ 0x0D\n#define INV_MPU6050_BIT_I2C_MST_P_NSR       0x10\n#define INV_MPU6050_BIT_SLV3_FIFO_EN        0x20\n#define INV_MPU6050_BIT_WAIT_FOR_ES         0x40\n#define INV_MPU6050_BIT_MULT_MST_EN         0x80\n\n \n#define INV_MPU6050_REG_I2C_SLV_ADDR(_x)    (0x25 + 3 * (_x))\n#define INV_MPU6050_BIT_I2C_SLV_RNW         0x80\n\n#define INV_MPU6050_REG_I2C_SLV_REG(_x)     (0x26 + 3 * (_x))\n\n#define INV_MPU6050_REG_I2C_SLV_CTRL(_x)    (0x27 + 3 * (_x))\n#define INV_MPU6050_BIT_SLV_GRP             0x10\n#define INV_MPU6050_BIT_SLV_REG_DIS         0x20\n#define INV_MPU6050_BIT_SLV_BYTE_SW         0x40\n#define INV_MPU6050_BIT_SLV_EN              0x80\n\n \n#define INV_MPU6050_REG_I2C_SLV4_CTRL       0x34\n#define INV_MPU6050_BITS_I2C_MST_DLY(_x)    ((_x) & 0x1F)\n\n#define INV_MPU6050_REG_I2C_MST_STATUS      0x36\n#define INV_MPU6050_BIT_I2C_SLV0_NACK       0x01\n#define INV_MPU6050_BIT_I2C_SLV1_NACK       0x02\n#define INV_MPU6050_BIT_I2C_SLV2_NACK       0x04\n#define INV_MPU6050_BIT_I2C_SLV3_NACK       0x08\n\n#define INV_MPU6050_REG_INT_ENABLE          0x38\n#define INV_MPU6050_BIT_DATA_RDY_EN         0x01\n#define INV_MPU6050_BIT_DMP_INT_EN          0x02\n\n#define INV_MPU6050_REG_RAW_ACCEL           0x3B\n#define INV_MPU6050_REG_TEMPERATURE         0x41\n#define INV_MPU6050_REG_RAW_GYRO            0x43\n\n#define INV_MPU6050_REG_INT_STATUS          0x3A\n#define INV_MPU6050_BIT_FIFO_OVERFLOW_INT   0x10\n#define INV_MPU6050_BIT_RAW_DATA_RDY_INT    0x01\n\n#define INV_MPU6050_REG_EXT_SENS_DATA       0x49\n\n \n#define INV_MPU6050_REG_I2C_SLV_DO(_x)      (0x63 + (_x))\n\n#define INV_MPU6050_REG_I2C_MST_DELAY_CTRL  0x67\n#define INV_MPU6050_BIT_I2C_SLV0_DLY_EN     0x01\n#define INV_MPU6050_BIT_I2C_SLV1_DLY_EN     0x02\n#define INV_MPU6050_BIT_I2C_SLV2_DLY_EN     0x04\n#define INV_MPU6050_BIT_I2C_SLV3_DLY_EN     0x08\n#define INV_MPU6050_BIT_DELAY_ES_SHADOW     0x80\n\n#define INV_MPU6050_REG_SIGNAL_PATH_RESET   0x68\n#define INV_MPU6050_BIT_TEMP_RST            BIT(0)\n#define INV_MPU6050_BIT_ACCEL_RST           BIT(1)\n#define INV_MPU6050_BIT_GYRO_RST            BIT(2)\n\n#define INV_MPU6050_REG_USER_CTRL           0x6A\n#define INV_MPU6050_BIT_SIG_COND_RST        0x01\n#define INV_MPU6050_BIT_FIFO_RST            0x04\n#define INV_MPU6050_BIT_DMP_RST             0x08\n#define INV_MPU6050_BIT_I2C_MST_EN          0x20\n#define INV_MPU6050_BIT_FIFO_EN             0x40\n#define INV_MPU6050_BIT_DMP_EN              0x80\n#define INV_MPU6050_BIT_I2C_IF_DIS          0x10\n\n#define INV_MPU6050_REG_PWR_MGMT_1          0x6B\n#define INV_MPU6050_BIT_H_RESET             0x80\n#define INV_MPU6050_BIT_SLEEP               0x40\n#define INV_MPU6050_BIT_TEMP_DIS            0x08\n#define INV_MPU6050_BIT_CLK_MASK            0x7\n\n#define INV_MPU6050_REG_PWR_MGMT_2          0x6C\n#define INV_MPU6050_BIT_PWR_ACCL_STBY       0x38\n#define INV_MPU6050_BIT_PWR_GYRO_STBY       0x07\n\n \n#define INV_ICM20602_REG_I2C_IF             0x70\n#define INV_ICM20602_BIT_I2C_IF_DIS         0x40\n\n#define INV_MPU6050_REG_FIFO_COUNT_H        0x72\n#define INV_MPU6050_REG_FIFO_R_W            0x74\n\n#define INV_MPU6050_BYTES_PER_3AXIS_SENSOR   6\n#define INV_MPU6050_FIFO_COUNT_BYTE          2\n\n \n#define INV_MPU9X50_BYTES_MAGN               7\n\n \n#define INV_MPU6050_BYTES_PER_TEMP_SENSOR   2\n\n \n#define INV_MPU6500_REG_ACCEL_CONFIG_2      0x1D\n#define INV_ICM20689_BITS_FIFO_SIZE_MAX     0xC0\n#define INV_MPU6500_REG_ACCEL_OFFSET        0x77\n\n \n#define INV_MPU6050_POWER_UP_TIME            100\n#define INV_MPU6050_TEMP_UP_TIME             100\n#define INV_MPU6050_ACCEL_STARTUP_TIME       20\n#define INV_MPU6050_GYRO_STARTUP_TIME        60\n#define INV_MPU6050_GYRO_DOWN_TIME           150\n#define INV_MPU6050_SUSPEND_DELAY_MS         2000\n\n#define INV_MPU6500_GYRO_STARTUP_TIME        70\n#define INV_MPU6500_ACCEL_STARTUP_TIME       30\n\n#define INV_ICM20602_GYRO_STARTUP_TIME       100\n#define INV_ICM20602_ACCEL_STARTUP_TIME      20\n\n#define INV_ICM20690_GYRO_STARTUP_TIME       80\n#define INV_ICM20690_ACCEL_STARTUP_TIME      10\n\n\n \n#define INV_MPU6050_REG_UP_TIME_MIN          5000\n#define INV_MPU6050_REG_UP_TIME_MAX          10000\n\n#define INV_MPU6050_TEMP_OFFSET\t             12420\n#define INV_MPU6050_TEMP_SCALE               2941176\n#define INV_MPU6050_MAX_GYRO_FS_PARAM        3\n#define INV_MPU6050_MAX_ACCL_FS_PARAM        3\n#define INV_MPU6050_THREE_AXIS               3\n#define INV_MPU6050_GYRO_CONFIG_FSR_SHIFT    3\n#define INV_ICM20690_GYRO_CONFIG_FSR_SHIFT   2\n#define INV_MPU6050_ACCL_CONFIG_FSR_SHIFT    3\n\n#define INV_MPU6500_TEMP_OFFSET              7011\n#define INV_MPU6500_TEMP_SCALE               2995178\n\n#define INV_ICM20608_TEMP_OFFSET\t     8170\n#define INV_ICM20608_TEMP_SCALE\t\t     3059976\n\n#define INV_MPU6050_REG_INT_PIN_CFG\t0x37\n#define INV_MPU6050_ACTIVE_HIGH\t\t0x00\n#define INV_MPU6050_ACTIVE_LOW\t\t0x80\n \n#define INV_MPU6050_LATCH_INT_EN\t0x20\n#define INV_MPU6050_BIT_BYPASS_EN\t0x2\n\n \n#define INV_MPU6050_TS_PERIOD_JITTER\t4\n\n \n#define INV_MPU6050_MAX_FIFO_RATE            1000\n#define INV_MPU6050_MIN_FIFO_RATE            4\n\n \n#define INV_MPU6050_INTERNAL_FREQ_HZ\t\t1000\n \n#define INV_MPU6050_FREQ_DIVIDER(st)\t\t\t\t\t\\\n\t((st)->chip_config.divider + 1)\n \n#define INV_MPU6050_FIFO_RATE_TO_DIVIDER(fifo_rate)\t\t\t\\\n\t((INV_MPU6050_INTERNAL_FREQ_HZ / (fifo_rate)) - 1)\n#define INV_MPU6050_DIVIDER_TO_FIFO_RATE(divider)\t\t\t\\\n\t(INV_MPU6050_INTERNAL_FREQ_HZ / ((divider) + 1))\n\n#define INV_MPU6050_REG_WHOAMI\t\t\t117\n\n#define INV_MPU6000_WHOAMI_VALUE\t\t0x68\n#define INV_MPU6050_WHOAMI_VALUE\t\t0x68\n#define INV_MPU6500_WHOAMI_VALUE\t\t0x70\n#define INV_MPU6880_WHOAMI_VALUE\t\t0x78\n#define INV_MPU9150_WHOAMI_VALUE\t\t0x68\n#define INV_MPU9250_WHOAMI_VALUE\t\t0x71\n#define INV_MPU9255_WHOAMI_VALUE\t\t0x73\n#define INV_MPU6515_WHOAMI_VALUE\t\t0x74\n#define INV_ICM20608_WHOAMI_VALUE\t\t0xAF\n#define INV_ICM20608D_WHOAMI_VALUE\t\t0xAE\n#define INV_ICM20609_WHOAMI_VALUE\t\t0xA6\n#define INV_ICM20689_WHOAMI_VALUE\t\t0x98\n#define INV_ICM20600_WHOAMI_VALUE\t\t0x11\n#define INV_ICM20602_WHOAMI_VALUE\t\t0x12\n#define INV_ICM20690_WHOAMI_VALUE\t\t0x20\n#define INV_IAM20680_WHOAMI_VALUE\t\t0xA9\n\n \nenum inv_mpu6050_scan {\n\tINV_MPU6050_SCAN_ACCL_X,\n\tINV_MPU6050_SCAN_ACCL_Y,\n\tINV_MPU6050_SCAN_ACCL_Z,\n\tINV_MPU6050_SCAN_TEMP,\n\tINV_MPU6050_SCAN_GYRO_X,\n\tINV_MPU6050_SCAN_GYRO_Y,\n\tINV_MPU6050_SCAN_GYRO_Z,\n\tINV_MPU6050_SCAN_TIMESTAMP,\n\n\tINV_MPU9X50_SCAN_MAGN_X = INV_MPU6050_SCAN_GYRO_Z + 1,\n\tINV_MPU9X50_SCAN_MAGN_Y,\n\tINV_MPU9X50_SCAN_MAGN_Z,\n\tINV_MPU9X50_SCAN_TIMESTAMP,\n};\n\nenum inv_mpu6050_filter_e {\n\tINV_MPU6050_FILTER_NOLPF2 = 0,\n\tINV_MPU6050_FILTER_200HZ,\n\tINV_MPU6050_FILTER_100HZ,\n\tINV_MPU6050_FILTER_45HZ,\n\tINV_MPU6050_FILTER_20HZ,\n\tINV_MPU6050_FILTER_10HZ,\n\tINV_MPU6050_FILTER_5HZ,\n\tINV_MPU6050_FILTER_NOLPF,\n\tNUM_MPU6050_FILTER\n};\n\n \nenum INV_MPU6050_IIO_ATTR_ADDR {\n\tATTR_GYRO_MATRIX,\n\tATTR_ACCL_MATRIX,\n};\n\nenum inv_mpu6050_accl_fs_e {\n\tINV_MPU6050_FS_02G = 0,\n\tINV_MPU6050_FS_04G,\n\tINV_MPU6050_FS_08G,\n\tINV_MPU6050_FS_16G,\n\tNUM_ACCL_FSR\n};\n\nenum inv_mpu6050_fsr_e {\n\tINV_MPU6050_FSR_250DPS = 0,\n\tINV_MPU6050_FSR_500DPS,\n\tINV_MPU6050_FSR_1000DPS,\n\tINV_MPU6050_FSR_2000DPS,\n\tNUM_MPU6050_FSR\n};\n\nenum inv_mpu6050_clock_sel_e {\n\tINV_CLK_INTERNAL = 0,\n\tINV_CLK_PLL,\n\tNUM_CLK\n};\n\nirqreturn_t inv_mpu6050_read_fifo(int irq, void *p);\nint inv_mpu6050_probe_trigger(struct iio_dev *indio_dev, int irq_type);\nint inv_mpu6050_prepare_fifo(struct inv_mpu6050_state *st, bool enable);\nint inv_mpu6050_switch_engine(struct inv_mpu6050_state *st, bool en,\n\t\t\t      unsigned int mask);\nint inv_mpu6050_write_reg(struct inv_mpu6050_state *st, int reg, u8 val);\nint inv_mpu_acpi_create_mux_client(struct i2c_client *client);\nvoid inv_mpu_acpi_delete_mux_client(struct i2c_client *client);\nint inv_mpu_core_probe(struct regmap *regmap, int irq, const char *name,\n\t\tint (*inv_mpu_bus_setup)(struct iio_dev *), int chip_type);\nextern const struct dev_pm_ops inv_mpu_pmops;\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}