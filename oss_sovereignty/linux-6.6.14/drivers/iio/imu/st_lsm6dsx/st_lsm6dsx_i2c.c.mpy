{
  "module_name": "st_lsm6dsx_i2c.c",
  "hash_id": "6fe0b5d4938d11c45d220cadc158d199175c10fca26e46d2be6c652511458437",
  "original_prompt": "Ingested from linux-6.6.14/drivers/iio/imu/st_lsm6dsx/st_lsm6dsx_i2c.c",
  "human_readable_source": "\n \n\n#include <linux/kernel.h>\n#include <linux/module.h>\n#include <linux/i2c.h>\n#include <linux/slab.h>\n#include <linux/regmap.h>\n\n#include \"st_lsm6dsx.h\"\n\nstatic const struct regmap_config st_lsm6dsx_i2c_regmap_config = {\n\t.reg_bits = 8,\n\t.val_bits = 8,\n};\n\nstatic int st_lsm6dsx_i2c_probe(struct i2c_client *client)\n{\n\tint hw_id;\n\tstruct regmap *regmap;\n\n\thw_id = (kernel_ulong_t)device_get_match_data(&client->dev);\n\tif (!hw_id)\n\t\thw_id = i2c_client_get_device_id(client)->driver_data;\n\tif (!hw_id)\n\t\treturn -EINVAL;\n\n\tregmap = devm_regmap_init_i2c(client, &st_lsm6dsx_i2c_regmap_config);\n\tif (IS_ERR(regmap)) {\n\t\tdev_err(&client->dev, \"Failed to register i2c regmap %ld\\n\", PTR_ERR(regmap));\n\t\treturn PTR_ERR(regmap);\n\t}\n\n\treturn st_lsm6dsx_probe(&client->dev, client->irq, hw_id, regmap);\n}\n\nstatic const struct of_device_id st_lsm6dsx_i2c_of_match[] = {\n\t{\n\t\t.compatible = \"st,lsm6ds3\",\n\t\t.data = (void *)ST_LSM6DS3_ID,\n\t},\n\t{\n\t\t.compatible = \"st,lsm6ds3h\",\n\t\t.data = (void *)ST_LSM6DS3H_ID,\n\t},\n\t{\n\t\t.compatible = \"st,lsm6dsl\",\n\t\t.data = (void *)ST_LSM6DSL_ID,\n\t},\n\t{\n\t\t.compatible = \"st,lsm6dsm\",\n\t\t.data = (void *)ST_LSM6DSM_ID,\n\t},\n\t{\n\t\t.compatible = \"st,ism330dlc\",\n\t\t.data = (void *)ST_ISM330DLC_ID,\n\t},\n\t{\n\t\t.compatible = \"st,lsm6dso\",\n\t\t.data = (void *)ST_LSM6DSO_ID,\n\t},\n\t{\n\t\t.compatible = \"st,asm330lhh\",\n\t\t.data = (void *)ST_ASM330LHH_ID,\n\t},\n\t{\n\t\t.compatible = \"st,lsm6dsox\",\n\t\t.data = (void *)ST_LSM6DSOX_ID,\n\t},\n\t{\n\t\t.compatible = \"st,lsm6dsr\",\n\t\t.data = (void *)ST_LSM6DSR_ID,\n\t},\n\t{\n\t\t.compatible = \"st,lsm6ds3tr-c\",\n\t\t.data = (void *)ST_LSM6DS3TRC_ID,\n\t},\n\t{\n\t\t.compatible = \"st,ism330dhcx\",\n\t\t.data = (void *)ST_ISM330DHCX_ID,\n\t},\n\t{\n\t\t.compatible = \"st,lsm9ds1-imu\",\n\t\t.data = (void *)ST_LSM9DS1_ID,\n\t},\n\t{\n\t\t.compatible = \"st,lsm6ds0\",\n\t\t.data = (void *)ST_LSM6DS0_ID,\n\t},\n\t{\n\t\t.compatible = \"st,lsm6dsrx\",\n\t\t.data = (void *)ST_LSM6DSRX_ID,\n\t},\n\t{\n\t\t.compatible = \"st,lsm6dst\",\n\t\t.data = (void *)ST_LSM6DST_ID,\n\t},\n\t{\n\t\t.compatible = \"st,lsm6dsop\",\n\t\t.data = (void *)ST_LSM6DSOP_ID,\n\t},\n\t{\n\t\t.compatible = \"st,asm330lhhx\",\n\t\t.data = (void *)ST_ASM330LHHX_ID,\n\t},\n\t{\n\t\t.compatible = \"st,lsm6dstx\",\n\t\t.data = (void *)ST_LSM6DSTX_ID,\n\t},\n\t{\n\t\t.compatible = \"st,lsm6dsv\",\n\t\t.data = (void *)ST_LSM6DSV_ID,\n\t},\n\t{\n\t\t.compatible = \"st,lsm6dsv16x\",\n\t\t.data = (void *)ST_LSM6DSV16X_ID,\n\t},\n\t{\n\t\t.compatible = \"st,lsm6dso16is\",\n\t\t.data = (void *)ST_LSM6DSO16IS_ID,\n\t},\n\t{\n\t\t.compatible = \"st,ism330is\",\n\t\t.data = (void *)ST_ISM330IS_ID,\n\t},\n\t{\n\t\t.compatible = \"st,asm330lhb\",\n\t\t.data = (void *)ST_ASM330LHB_ID,\n\t},\n\t{},\n};\nMODULE_DEVICE_TABLE(of, st_lsm6dsx_i2c_of_match);\n\nstatic const struct acpi_device_id st_lsm6dsx_i2c_acpi_match[] = {\n\t{ \"SMO8B30\", ST_LSM6DS3TRC_ID, },\n\t{}\n};\nMODULE_DEVICE_TABLE(acpi, st_lsm6dsx_i2c_acpi_match);\n\nstatic const struct i2c_device_id st_lsm6dsx_i2c_id_table[] = {\n\t{ ST_LSM6DS3_DEV_NAME, ST_LSM6DS3_ID },\n\t{ ST_LSM6DS3H_DEV_NAME, ST_LSM6DS3H_ID },\n\t{ ST_LSM6DSL_DEV_NAME, ST_LSM6DSL_ID },\n\t{ ST_LSM6DSM_DEV_NAME, ST_LSM6DSM_ID },\n\t{ ST_ISM330DLC_DEV_NAME, ST_ISM330DLC_ID },\n\t{ ST_LSM6DSO_DEV_NAME, ST_LSM6DSO_ID },\n\t{ ST_ASM330LHH_DEV_NAME, ST_ASM330LHH_ID },\n\t{ ST_LSM6DSOX_DEV_NAME, ST_LSM6DSOX_ID },\n\t{ ST_LSM6DSR_DEV_NAME, ST_LSM6DSR_ID },\n\t{ ST_LSM6DS3TRC_DEV_NAME, ST_LSM6DS3TRC_ID },\n\t{ ST_ISM330DHCX_DEV_NAME, ST_ISM330DHCX_ID },\n\t{ ST_LSM9DS1_DEV_NAME, ST_LSM9DS1_ID },\n\t{ ST_LSM6DS0_DEV_NAME, ST_LSM6DS0_ID },\n\t{ ST_LSM6DSRX_DEV_NAME, ST_LSM6DSRX_ID },\n\t{ ST_LSM6DST_DEV_NAME, ST_LSM6DST_ID },\n\t{ ST_LSM6DSOP_DEV_NAME, ST_LSM6DSOP_ID },\n\t{ ST_ASM330LHHX_DEV_NAME, ST_ASM330LHHX_ID },\n\t{ ST_LSM6DSTX_DEV_NAME, ST_LSM6DSTX_ID },\n\t{ ST_LSM6DSV_DEV_NAME, ST_LSM6DSV_ID },\n\t{ ST_LSM6DSV16X_DEV_NAME, ST_LSM6DSV16X_ID },\n\t{ ST_LSM6DSO16IS_DEV_NAME, ST_LSM6DSO16IS_ID },\n\t{ ST_ISM330IS_DEV_NAME, ST_ISM330IS_ID },\n\t{ ST_ASM330LHB_DEV_NAME, ST_ASM330LHB_ID },\n\t{},\n};\nMODULE_DEVICE_TABLE(i2c, st_lsm6dsx_i2c_id_table);\n\nstatic struct i2c_driver st_lsm6dsx_driver = {\n\t.driver = {\n\t\t.name = \"st_lsm6dsx_i2c\",\n\t\t.pm = pm_sleep_ptr(&st_lsm6dsx_pm_ops),\n\t\t.of_match_table = st_lsm6dsx_i2c_of_match,\n\t\t.acpi_match_table = st_lsm6dsx_i2c_acpi_match,\n\t},\n\t.probe = st_lsm6dsx_i2c_probe,\n\t.id_table = st_lsm6dsx_i2c_id_table,\n};\nmodule_i2c_driver(st_lsm6dsx_driver);\n\nMODULE_AUTHOR(\"Lorenzo Bianconi <lorenzo.bianconi@st.com>\");\nMODULE_AUTHOR(\"Denis Ciocca <denis.ciocca@st.com>\");\nMODULE_DESCRIPTION(\"STMicroelectronics st_lsm6dsx i2c driver\");\nMODULE_LICENSE(\"GPL v2\");\nMODULE_IMPORT_NS(IIO_LSM6DSX);\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}