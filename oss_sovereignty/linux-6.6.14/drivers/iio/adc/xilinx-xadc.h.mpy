{
  "module_name": "xilinx-xadc.h",
  "hash_id": "8c5600462b9fdacdcc41d7bb8a07b04c7075eca47b11c3eb130fadf1a785325c",
  "original_prompt": "Ingested from linux-6.6.14/drivers/iio/adc/xilinx-xadc.h",
  "human_readable_source": " \n \n\n#ifndef __IIO_XILINX_XADC__\n#define __IIO_XILINX_XADC__\n\n#include <linux/interrupt.h>\n#include <linux/mutex.h>\n#include <linux/spinlock.h>\n\nstruct iio_dev;\nstruct clk;\nstruct xadc_ops;\nstruct platform_device;\n\nvoid xadc_handle_events(struct iio_dev *indio_dev, unsigned long events);\n\nint xadc_read_event_config(struct iio_dev *indio_dev,\n\tconst struct iio_chan_spec *chan, enum iio_event_type type,\n\tenum iio_event_direction dir);\nint xadc_write_event_config(struct iio_dev *indio_dev,\n\tconst struct iio_chan_spec *chan, enum iio_event_type type,\n\tenum iio_event_direction dir, int state);\nint xadc_read_event_value(struct iio_dev *indio_dev,\n\tconst struct iio_chan_spec *chan, enum iio_event_type type,\n\tenum iio_event_direction dir, enum iio_event_info info,\n\tint *val, int *val2);\nint xadc_write_event_value(struct iio_dev *indio_dev,\n\tconst struct iio_chan_spec *chan, enum iio_event_type type,\n\tenum iio_event_direction dir, enum iio_event_info info,\n\tint val, int val2);\n\nenum xadc_external_mux_mode {\n\tXADC_EXTERNAL_MUX_NONE,\n\tXADC_EXTERNAL_MUX_SINGLE,\n\tXADC_EXTERNAL_MUX_DUAL,\n};\n\nstruct xadc {\n\tvoid __iomem *base;\n\tstruct clk *clk;\n\n\tconst struct xadc_ops *ops;\n\n\tuint16_t threshold[16];\n\tuint16_t temp_hysteresis;\n\tunsigned int alarm_mask;\n\n\tuint16_t *data;\n\n\tstruct iio_trigger *trigger;\n\tstruct iio_trigger *convst_trigger;\n\tstruct iio_trigger *samplerate_trigger;\n\n\tenum xadc_external_mux_mode external_mux_mode;\n\n\tunsigned int zynq_masked_alarm;\n\tunsigned int zynq_intmask;\n\tstruct delayed_work zynq_unmask_work;\n\n\tstruct mutex mutex;\n\tspinlock_t lock;\n\n\tstruct completion completion;\n};\n\nenum xadc_type {\n\tXADC_TYPE_S7,  \n\tXADC_TYPE_US,  \n};\n\nstruct xadc_ops {\n\tint (*read)(struct xadc *xadc, unsigned int reg, uint16_t *val);\n\tint (*write)(struct xadc *xadc, unsigned int reg, uint16_t val);\n\tint (*setup)(struct platform_device *pdev, struct iio_dev *indio_dev,\n\t\t\tint irq);\n\tvoid (*update_alarm)(struct xadc *xadc, unsigned int alarm);\n\tunsigned long (*get_dclk_rate)(struct xadc *xadc);\n\tirqreturn_t (*interrupt_handler)(int irq, void *devid);\n\n\tunsigned int flags;\n\tenum xadc_type type;\n\tint temp_scale;\n\tint temp_offset;\n};\n\nstatic inline int _xadc_read_adc_reg(struct xadc *xadc, unsigned int reg,\n\tuint16_t *val)\n{\n\tlockdep_assert_held(&xadc->mutex);\n\treturn xadc->ops->read(xadc, reg, val);\n}\n\nstatic inline int _xadc_write_adc_reg(struct xadc *xadc, unsigned int reg,\n\tuint16_t val)\n{\n\tlockdep_assert_held(&xadc->mutex);\n\treturn xadc->ops->write(xadc, reg, val);\n}\n\nstatic inline int xadc_read_adc_reg(struct xadc *xadc, unsigned int reg,\n\tuint16_t *val)\n{\n\tint ret;\n\n\tmutex_lock(&xadc->mutex);\n\tret = _xadc_read_adc_reg(xadc, reg, val);\n\tmutex_unlock(&xadc->mutex);\n\treturn ret;\n}\n\nstatic inline int xadc_write_adc_reg(struct xadc *xadc, unsigned int reg,\n\tuint16_t val)\n{\n\tint ret;\n\n\tmutex_lock(&xadc->mutex);\n\tret = _xadc_write_adc_reg(xadc, reg, val);\n\tmutex_unlock(&xadc->mutex);\n\treturn ret;\n}\n\n \n#define XADC_REG_TEMP\t\t0x00\n#define XADC_REG_VCCINT\t\t0x01\n#define XADC_REG_VCCAUX\t\t0x02\n#define XADC_REG_VPVN\t\t0x03\n#define XADC_REG_VREFP\t\t0x04\n#define XADC_REG_VREFN\t\t0x05\n#define XADC_REG_VCCBRAM\t0x06\n\n#define XADC_REG_VCCPINT\t0x0d\n#define XADC_REG_VCCPAUX\t0x0e\n#define XADC_REG_VCCO_DDR\t0x0f\n#define XADC_REG_VAUX(x)\t(0x10 + (x))\n\n#define XADC_REG_MAX_TEMP\t0x20\n#define XADC_REG_MAX_VCCINT\t0x21\n#define XADC_REG_MAX_VCCAUX\t0x22\n#define XADC_REG_MAX_VCCBRAM\t0x23\n#define XADC_REG_MIN_TEMP\t0x24\n#define XADC_REG_MIN_VCCINT\t0x25\n#define XADC_REG_MIN_VCCAUX\t0x26\n#define XADC_REG_MIN_VCCBRAM\t0x27\n#define XADC_REG_MAX_VCCPINT\t0x28\n#define XADC_REG_MAX_VCCPAUX\t0x29\n#define XADC_REG_MAX_VCCO_DDR\t0x2a\n#define XADC_REG_MIN_VCCPINT\t0x2c\n#define XADC_REG_MIN_VCCPAUX\t0x2d\n#define XADC_REG_MIN_VCCO_DDR\t0x2e\n\n#define XADC_REG_CONF0\t\t0x40\n#define XADC_REG_CONF1\t\t0x41\n#define XADC_REG_CONF2\t\t0x42\n#define XADC_REG_SEQ(x)\t\t(0x48 + (x))\n#define XADC_REG_INPUT_MODE(x)\t(0x4c + (x))\n#define XADC_REG_THRESHOLD(x)\t(0x50 + (x))\n\n#define XADC_REG_FLAG\t\t0x3f\n\n#define XADC_CONF0_EC\t\t\tBIT(9)\n#define XADC_CONF0_ACQ\t\t\tBIT(8)\n#define XADC_CONF0_MUX\t\t\tBIT(11)\n#define XADC_CONF0_CHAN(x)\t\t(x)\n\n#define XADC_CONF1_SEQ_MASK\t\t(0xf << 12)\n#define XADC_CONF1_SEQ_DEFAULT\t\t(0 << 12)\n#define XADC_CONF1_SEQ_SINGLE_PASS\t(1 << 12)\n#define XADC_CONF1_SEQ_CONTINUOUS\t(2 << 12)\n#define XADC_CONF1_SEQ_SINGLE_CHANNEL\t(3 << 12)\n#define XADC_CONF1_SEQ_SIMULTANEOUS\t(4 << 12)\n#define XADC_CONF1_SEQ_INDEPENDENT\t(8 << 12)\n#define XADC_CONF1_ALARM_MASK\t\t0x0f0f\n\n#define XADC_CONF2_DIV_MASK\t0xff00\n#define XADC_CONF2_DIV_OFFSET\t8\n\n#define XADC_CONF2_PD_MASK\t(0x3 << 4)\n#define XADC_CONF2_PD_NONE\t(0x0 << 4)\n#define XADC_CONF2_PD_ADC_B\t(0x2 << 4)\n#define XADC_CONF2_PD_BOTH\t(0x3 << 4)\n\n#define XADC_ALARM_TEMP_MASK\t\tBIT(0)\n#define XADC_ALARM_VCCINT_MASK\t\tBIT(1)\n#define XADC_ALARM_VCCAUX_MASK\t\tBIT(2)\n#define XADC_ALARM_OT_MASK\t\tBIT(3)\n#define XADC_ALARM_VCCBRAM_MASK\t\tBIT(4)\n#define XADC_ALARM_VCCPINT_MASK\t\tBIT(5)\n#define XADC_ALARM_VCCPAUX_MASK\t\tBIT(6)\n#define XADC_ALARM_VCCODDR_MASK\t\tBIT(7)\n\n#define XADC_THRESHOLD_TEMP_MAX\t\t0x0\n#define XADC_THRESHOLD_VCCINT_MAX\t0x1\n#define XADC_THRESHOLD_VCCAUX_MAX\t0x2\n#define XADC_THRESHOLD_OT_MAX\t\t0x3\n#define XADC_THRESHOLD_TEMP_MIN\t\t0x4\n#define XADC_THRESHOLD_VCCINT_MIN\t0x5\n#define XADC_THRESHOLD_VCCAUX_MIN\t0x6\n#define XADC_THRESHOLD_OT_MIN\t\t0x7\n#define XADC_THRESHOLD_VCCBRAM_MAX\t0x8\n#define XADC_THRESHOLD_VCCPINT_MAX\t0x9\n#define XADC_THRESHOLD_VCCPAUX_MAX\t0xa\n#define XADC_THRESHOLD_VCCODDR_MAX\t0xb\n#define XADC_THRESHOLD_VCCBRAM_MIN\t0xc\n#define XADC_THRESHOLD_VCCPINT_MIN\t0xd\n#define XADC_THRESHOLD_VCCPAUX_MIN\t0xe\n#define XADC_THRESHOLD_VCCODDR_MIN\t0xf\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}