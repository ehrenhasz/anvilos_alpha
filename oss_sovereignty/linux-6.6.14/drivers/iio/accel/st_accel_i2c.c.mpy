{
  "module_name": "st_accel_i2c.c",
  "hash_id": "3fba63bfe4b23a6603854d373eae307ef730c9f4807a5252e1ca38402bcd0663",
  "original_prompt": "Ingested from linux-6.6.14/drivers/iio/accel/st_accel_i2c.c",
  "human_readable_source": "\n \n\n#include <linux/kernel.h>\n#include <linux/module.h>\n#include <linux/mod_devicetable.h>\n#include <linux/acpi.h>\n#include <linux/i2c.h>\n#include <linux/iio/iio.h>\n\n#include <linux/iio/common/st_sensors_i2c.h>\n#include \"st_accel.h\"\n\nstatic const struct of_device_id st_accel_of_match[] = {\n\t{\n\t\t \n\t\t.compatible = \"st,lis3lv02d\",\n\t\t.data = LIS3LV02DL_ACCEL_DEV_NAME,\n\t},\n\t{\n\t\t.compatible = \"st,lis3lv02dl-accel\",\n\t\t.data = LIS3LV02DL_ACCEL_DEV_NAME,\n\t},\n\t{\n\t\t.compatible = \"st,lsm303dlh-accel\",\n\t\t.data = LSM303DLH_ACCEL_DEV_NAME,\n\t},\n\t{\n\t\t.compatible = \"st,lsm303dlhc-accel\",\n\t\t.data = LSM303DLHC_ACCEL_DEV_NAME,\n\t},\n\t{\n\t\t.compatible = \"st,lis3dh-accel\",\n\t\t.data = LIS3DH_ACCEL_DEV_NAME,\n\t},\n\t{\n\t\t.compatible = \"st,lsm330d-accel\",\n\t\t.data = LSM330D_ACCEL_DEV_NAME,\n\t},\n\t{\n\t\t.compatible = \"st,lsm330dl-accel\",\n\t\t.data = LSM330DL_ACCEL_DEV_NAME,\n\t},\n\t{\n\t\t.compatible = \"st,lsm330dlc-accel\",\n\t\t.data = LSM330DLC_ACCEL_DEV_NAME,\n\t},\n\t{\n\t\t.compatible = \"st,lis331dl-accel\",\n\t\t.data = LIS331DL_ACCEL_DEV_NAME,\n\t},\n\t{\n\t\t.compatible = \"st,lis331dlh-accel\",\n\t\t.data = LIS331DLH_ACCEL_DEV_NAME,\n\t},\n\t{\n\t\t.compatible = \"st,lsm303dl-accel\",\n\t\t.data = LSM303DL_ACCEL_DEV_NAME,\n\t},\n\t{\n\t\t.compatible = \"st,lsm303dlm-accel\",\n\t\t.data = LSM303DLM_ACCEL_DEV_NAME,\n\t},\n\t{\n\t\t.compatible = \"st,lsm330-accel\",\n\t\t.data = LSM330_ACCEL_DEV_NAME,\n\t},\n\t{\n\t\t.compatible = \"st,lsm303agr-accel\",\n\t\t.data = LSM303AGR_ACCEL_DEV_NAME,\n\t},\n\t{\n\t\t.compatible = \"st,lis2dh12-accel\",\n\t\t.data = LIS2DH12_ACCEL_DEV_NAME,\n\t},\n\t{\n\t\t.compatible = \"st,h3lis331dl-accel\",\n\t\t.data = H3LIS331DL_ACCEL_DEV_NAME,\n\t},\n\t{\n\t\t.compatible = \"st,lis3l02dq\",\n\t\t.data = LIS3L02DQ_ACCEL_DEV_NAME,\n\t},\n\t{\n\t\t.compatible = \"st,lng2dm-accel\",\n\t\t.data = LNG2DM_ACCEL_DEV_NAME,\n\t},\n\t{\n\t\t.compatible = \"st,lis2dw12\",\n\t\t.data = LIS2DW12_ACCEL_DEV_NAME,\n\t},\n\t{\n\t\t.compatible = \"st,lis3de\",\n\t\t.data = LIS3DE_ACCEL_DEV_NAME,\n\t},\n\t{\n\t\t.compatible = \"st,lis2de12\",\n\t\t.data = LIS2DE12_ACCEL_DEV_NAME,\n\t},\n\t{\n\t\t.compatible = \"st,lis2hh12\",\n\t\t.data = LIS2HH12_ACCEL_DEV_NAME,\n\t},\n\t{\n\t\t.compatible = \"st,lis302dl\",\n\t\t.data = LIS302DL_ACCEL_DEV_NAME,\n\t},\n\t{\n\t\t.compatible = \"st,lsm303c-accel\",\n\t\t.data = LSM303C_ACCEL_DEV_NAME,\n\t},\n\t{\n\t\t.compatible = \"silan,sc7a20\",\n\t\t.data = SC7A20_ACCEL_DEV_NAME,\n\t},\n\t{\n\t\t.compatible = \"st,iis328dq\",\n\t\t.data = IIS328DQ_ACCEL_DEV_NAME,\n\t},\n\t{},\n};\nMODULE_DEVICE_TABLE(of, st_accel_of_match);\n\n#ifdef CONFIG_ACPI\nstatic const struct acpi_device_id st_accel_acpi_match[] = {\n\t{\"SMO8840\", (kernel_ulong_t)LIS2DH12_ACCEL_DEV_NAME},\n\t{\"SMO8A90\", (kernel_ulong_t)LNG2DM_ACCEL_DEV_NAME},\n\t{ },\n};\nMODULE_DEVICE_TABLE(acpi, st_accel_acpi_match);\n#endif\n\nstatic const struct i2c_device_id st_accel_id_table[] = {\n\t{ LSM303DLH_ACCEL_DEV_NAME },\n\t{ LSM303DLHC_ACCEL_DEV_NAME },\n\t{ LIS3DH_ACCEL_DEV_NAME },\n\t{ LSM330D_ACCEL_DEV_NAME },\n\t{ LSM330DL_ACCEL_DEV_NAME },\n\t{ LSM330DLC_ACCEL_DEV_NAME },\n\t{ LIS331DLH_ACCEL_DEV_NAME },\n\t{ LSM303DL_ACCEL_DEV_NAME },\n\t{ LSM303DLM_ACCEL_DEV_NAME },\n\t{ LSM330_ACCEL_DEV_NAME },\n\t{ LSM303AGR_ACCEL_DEV_NAME },\n\t{ LIS2DH12_ACCEL_DEV_NAME },\n\t{ LIS3L02DQ_ACCEL_DEV_NAME },\n\t{ LNG2DM_ACCEL_DEV_NAME },\n\t{ H3LIS331DL_ACCEL_DEV_NAME },\n\t{ LIS331DL_ACCEL_DEV_NAME },\n\t{ LIS3LV02DL_ACCEL_DEV_NAME },\n\t{ LIS2DW12_ACCEL_DEV_NAME },\n\t{ LIS3DE_ACCEL_DEV_NAME },\n\t{ LIS2DE12_ACCEL_DEV_NAME },\n\t{ LIS2HH12_ACCEL_DEV_NAME },\n\t{ LIS302DL_ACCEL_DEV_NAME },\n\t{ LSM303C_ACCEL_DEV_NAME },\n\t{ SC7A20_ACCEL_DEV_NAME },\n\t{ IIS328DQ_ACCEL_DEV_NAME },\n\t{},\n};\nMODULE_DEVICE_TABLE(i2c, st_accel_id_table);\n\nstatic int st_accel_i2c_probe(struct i2c_client *client)\n{\n\tconst struct st_sensor_settings *settings;\n\tstruct st_sensor_data *adata;\n\tstruct iio_dev *indio_dev;\n\tint ret;\n\n\tst_sensors_dev_name_probe(&client->dev, client->name, sizeof(client->name));\n\n\tsettings = st_accel_get_settings(client->name);\n\tif (!settings) {\n\t\tdev_err(&client->dev, \"device name %s not recognized.\\n\",\n\t\t\tclient->name);\n\t\treturn -ENODEV;\n\t}\n\n\tindio_dev = devm_iio_device_alloc(&client->dev, sizeof(*adata));\n\tif (!indio_dev)\n\t\treturn -ENOMEM;\n\n\tadata = iio_priv(indio_dev);\n\tadata->sensor_settings = (struct st_sensor_settings *)settings;\n\n\tret = st_sensors_i2c_configure(indio_dev, client);\n\tif (ret < 0)\n\t\treturn ret;\n\n\tret = st_sensors_power_enable(indio_dev);\n\tif (ret)\n\t\treturn ret;\n\n\treturn st_accel_common_probe(indio_dev);\n}\n\nstatic struct i2c_driver st_accel_driver = {\n\t.driver = {\n\t\t.name = \"st-accel-i2c\",\n\t\t.of_match_table = st_accel_of_match,\n\t\t.acpi_match_table = ACPI_PTR(st_accel_acpi_match),\n\t},\n\t.probe = st_accel_i2c_probe,\n\t.id_table = st_accel_id_table,\n};\nmodule_i2c_driver(st_accel_driver);\n\nMODULE_AUTHOR(\"Denis Ciocca <denis.ciocca@st.com>\");\nMODULE_DESCRIPTION(\"STMicroelectronics accelerometers i2c driver\");\nMODULE_LICENSE(\"GPL v2\");\nMODULE_IMPORT_NS(IIO_ST_SENSORS);\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}