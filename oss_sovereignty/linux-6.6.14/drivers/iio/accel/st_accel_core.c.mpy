{
  "module_name": "st_accel_core.c",
  "hash_id": "e668f0fc67c9068d63128a56d4a3e4e5348fd4bc1252d0fb5f1dbd8c4d5cb8df",
  "original_prompt": "Ingested from linux-6.6.14/drivers/iio/accel/st_accel_core.c",
  "human_readable_source": "\n \n\n#include <linux/kernel.h>\n#include <linux/module.h>\n#include <linux/mutex.h>\n#include <linux/sysfs.h>\n#include <linux/slab.h>\n#include <linux/acpi.h>\n#include <linux/iio/iio.h>\n#include <linux/iio/sysfs.h>\n#include <linux/iio/trigger.h>\n\n#include <linux/iio/common/st_sensors.h>\n#include \"st_accel.h\"\n\n#define ST_ACCEL_NUMBER_DATA_CHANNELS\t\t3\n\n \n#define ST_ACCEL_DEFAULT_OUT_X_L_ADDR\t\t0x28\n#define ST_ACCEL_DEFAULT_OUT_Y_L_ADDR\t\t0x2a\n#define ST_ACCEL_DEFAULT_OUT_Z_L_ADDR\t\t0x2c\n\n \n#define ST_ACCEL_FS_AVL_2G\t\t\t2\n#define ST_ACCEL_FS_AVL_4G\t\t\t4\n#define ST_ACCEL_FS_AVL_6G\t\t\t6\n#define ST_ACCEL_FS_AVL_8G\t\t\t8\n#define ST_ACCEL_FS_AVL_16G\t\t\t16\n#define ST_ACCEL_FS_AVL_100G\t\t\t100\n#define ST_ACCEL_FS_AVL_200G\t\t\t200\n#define ST_ACCEL_FS_AVL_400G\t\t\t400\n\nstatic const struct iio_mount_matrix *\nst_accel_get_mount_matrix(const struct iio_dev *indio_dev,\n\t\t\t  const struct iio_chan_spec *chan)\n{\n\tstruct st_sensor_data *adata = iio_priv(indio_dev);\n\n\treturn &adata->mount_matrix;\n}\n\nstatic const struct iio_chan_spec_ext_info st_accel_mount_matrix_ext_info[] = {\n\tIIO_MOUNT_MATRIX(IIO_SHARED_BY_ALL, st_accel_get_mount_matrix),\n\t{ }\n};\n\nstatic const struct iio_chan_spec st_accel_8bit_channels[] = {\n\tST_SENSORS_LSM_CHANNELS_EXT(IIO_ACCEL,\n\t\t\tBIT(IIO_CHAN_INFO_RAW) | BIT(IIO_CHAN_INFO_SCALE),\n\t\t\tST_SENSORS_SCAN_X, 1, IIO_MOD_X, 's', IIO_LE, 8, 8,\n\t\t\tST_ACCEL_DEFAULT_OUT_X_L_ADDR+1,\n\t\t\tst_accel_mount_matrix_ext_info),\n\tST_SENSORS_LSM_CHANNELS_EXT(IIO_ACCEL,\n\t\t\tBIT(IIO_CHAN_INFO_RAW) | BIT(IIO_CHAN_INFO_SCALE),\n\t\t\tST_SENSORS_SCAN_Y, 1, IIO_MOD_Y, 's', IIO_LE, 8, 8,\n\t\t\tST_ACCEL_DEFAULT_OUT_Y_L_ADDR+1,\n\t\t\tst_accel_mount_matrix_ext_info),\n\tST_SENSORS_LSM_CHANNELS_EXT(IIO_ACCEL,\n\t\t\tBIT(IIO_CHAN_INFO_RAW) | BIT(IIO_CHAN_INFO_SCALE),\n\t\t\tST_SENSORS_SCAN_Z, 1, IIO_MOD_Z, 's', IIO_LE, 8, 8,\n\t\t\tST_ACCEL_DEFAULT_OUT_Z_L_ADDR+1,\n\t\t\tst_accel_mount_matrix_ext_info),\n\tIIO_CHAN_SOFT_TIMESTAMP(3)\n};\n\nstatic const struct iio_chan_spec st_accel_12bit_channels[] = {\n\tST_SENSORS_LSM_CHANNELS_EXT(IIO_ACCEL,\n\t\t\tBIT(IIO_CHAN_INFO_RAW) | BIT(IIO_CHAN_INFO_SCALE),\n\t\t\tST_SENSORS_SCAN_X, 1, IIO_MOD_X, 's', IIO_LE, 12, 16,\n\t\t\tST_ACCEL_DEFAULT_OUT_X_L_ADDR,\n\t\t\tst_accel_mount_matrix_ext_info),\n\tST_SENSORS_LSM_CHANNELS_EXT(IIO_ACCEL,\n\t\t\tBIT(IIO_CHAN_INFO_RAW) | BIT(IIO_CHAN_INFO_SCALE),\n\t\t\tST_SENSORS_SCAN_Y, 1, IIO_MOD_Y, 's', IIO_LE, 12, 16,\n\t\t\tST_ACCEL_DEFAULT_OUT_Y_L_ADDR,\n\t\t\tst_accel_mount_matrix_ext_info),\n\tST_SENSORS_LSM_CHANNELS_EXT(IIO_ACCEL,\n\t\t\tBIT(IIO_CHAN_INFO_RAW) | BIT(IIO_CHAN_INFO_SCALE),\n\t\t\tST_SENSORS_SCAN_Z, 1, IIO_MOD_Z, 's', IIO_LE, 12, 16,\n\t\t\tST_ACCEL_DEFAULT_OUT_Z_L_ADDR,\n\t\t\tst_accel_mount_matrix_ext_info),\n\tIIO_CHAN_SOFT_TIMESTAMP(3)\n};\n\nstatic const struct iio_chan_spec st_accel_16bit_channels[] = {\n\tST_SENSORS_LSM_CHANNELS_EXT(IIO_ACCEL,\n\t\t\tBIT(IIO_CHAN_INFO_RAW) | BIT(IIO_CHAN_INFO_SCALE),\n\t\t\tST_SENSORS_SCAN_X, 1, IIO_MOD_X, 's', IIO_LE, 16, 16,\n\t\t\tST_ACCEL_DEFAULT_OUT_X_L_ADDR,\n\t\t\tst_accel_mount_matrix_ext_info),\n\tST_SENSORS_LSM_CHANNELS_EXT(IIO_ACCEL,\n\t\t\tBIT(IIO_CHAN_INFO_RAW) | BIT(IIO_CHAN_INFO_SCALE),\n\t\t\tST_SENSORS_SCAN_Y, 1, IIO_MOD_Y, 's', IIO_LE, 16, 16,\n\t\t\tST_ACCEL_DEFAULT_OUT_Y_L_ADDR,\n\t\t\tst_accel_mount_matrix_ext_info),\n\tST_SENSORS_LSM_CHANNELS_EXT(IIO_ACCEL,\n\t\t\tBIT(IIO_CHAN_INFO_RAW) | BIT(IIO_CHAN_INFO_SCALE),\n\t\t\tST_SENSORS_SCAN_Z, 1, IIO_MOD_Z, 's', IIO_LE, 16, 16,\n\t\t\tST_ACCEL_DEFAULT_OUT_Z_L_ADDR,\n\t\t\tst_accel_mount_matrix_ext_info),\n\tIIO_CHAN_SOFT_TIMESTAMP(3)\n};\n\nstatic const struct st_sensor_settings st_accel_sensors_settings[] = {\n\t{\n\t\t.wai = 0x33,\n\t\t.wai_addr = ST_SENSORS_DEFAULT_WAI_ADDRESS,\n\t\t.sensors_supported = {\n\t\t\t[0] = LIS3DH_ACCEL_DEV_NAME,\n\t\t\t[1] = LSM303DLHC_ACCEL_DEV_NAME,\n\t\t\t[2] = LSM330D_ACCEL_DEV_NAME,\n\t\t\t[3] = LSM330DL_ACCEL_DEV_NAME,\n\t\t\t[4] = LSM330DLC_ACCEL_DEV_NAME,\n\t\t\t[5] = LSM303AGR_ACCEL_DEV_NAME,\n\t\t\t[6] = LIS2DH12_ACCEL_DEV_NAME,\n\t\t\t[7] = LIS3DE_ACCEL_DEV_NAME,\n\t\t},\n\t\t.ch = (struct iio_chan_spec *)st_accel_12bit_channels,\n\t\t.odr = {\n\t\t\t.addr = 0x20,\n\t\t\t.mask = 0xf0,\n\t\t\t.odr_avl = {\n\t\t\t\t{ .hz = 1, .value = 0x01, },\n\t\t\t\t{ .hz = 10, .value = 0x02, },\n\t\t\t\t{ .hz = 25, .value = 0x03, },\n\t\t\t\t{ .hz = 50, .value = 0x04, },\n\t\t\t\t{ .hz = 100, .value = 0x05, },\n\t\t\t\t{ .hz = 200, .value = 0x06, },\n\t\t\t\t{ .hz = 400, .value = 0x07, },\n\t\t\t\t{ .hz = 1600, .value = 0x08, },\n\t\t\t},\n\t\t},\n\t\t.pw = {\n\t\t\t.addr = 0x20,\n\t\t\t.mask = 0xf0,\n\t\t\t.value_off = ST_SENSORS_DEFAULT_POWER_OFF_VALUE,\n\t\t},\n\t\t.enable_axis = {\n\t\t\t.addr = ST_SENSORS_DEFAULT_AXIS_ADDR,\n\t\t\t.mask = ST_SENSORS_DEFAULT_AXIS_MASK,\n\t\t},\n\t\t.fs = {\n\t\t\t.addr = 0x23,\n\t\t\t.mask = 0x30,\n\t\t\t.fs_avl = {\n\t\t\t\t[0] = {\n\t\t\t\t\t.num = ST_ACCEL_FS_AVL_2G,\n\t\t\t\t\t.value = 0x00,\n\t\t\t\t\t.gain = IIO_G_TO_M_S_2(1000),\n\t\t\t\t},\n\t\t\t\t[1] = {\n\t\t\t\t\t.num = ST_ACCEL_FS_AVL_4G,\n\t\t\t\t\t.value = 0x01,\n\t\t\t\t\t.gain = IIO_G_TO_M_S_2(2000),\n\t\t\t\t},\n\t\t\t\t[2] = {\n\t\t\t\t\t.num = ST_ACCEL_FS_AVL_8G,\n\t\t\t\t\t.value = 0x02,\n\t\t\t\t\t.gain = IIO_G_TO_M_S_2(4000),\n\t\t\t\t},\n\t\t\t\t[3] = {\n\t\t\t\t\t.num = ST_ACCEL_FS_AVL_16G,\n\t\t\t\t\t.value = 0x03,\n\t\t\t\t\t.gain = IIO_G_TO_M_S_2(12000),\n\t\t\t\t},\n\t\t\t},\n\t\t},\n\t\t.bdu = {\n\t\t\t.addr = 0x23,\n\t\t\t.mask = 0x80,\n\t\t},\n\t\t.drdy_irq = {\n\t\t\t.int1 = {\n\t\t\t\t.addr = 0x22,\n\t\t\t\t.mask = 0x10,\n\t\t\t},\n\t\t\t.addr_ihl = 0x25,\n\t\t\t.mask_ihl = 0x02,\n\t\t\t.stat_drdy = {\n\t\t\t\t.addr = ST_SENSORS_DEFAULT_STAT_ADDR,\n\t\t\t\t.mask = 0x07,\n\t\t\t},\n\t\t},\n\t\t.sim = {\n\t\t\t.addr = 0x23,\n\t\t\t.value = BIT(0),\n\t\t},\n\t\t.multi_read_bit = true,\n\t\t.bootime = 2,\n\t},\n\t{\n\t\t.wai = 0x32,\n\t\t.wai_addr = ST_SENSORS_DEFAULT_WAI_ADDRESS,\n\t\t.sensors_supported = {\n\t\t\t[0] = LIS331DLH_ACCEL_DEV_NAME,\n\t\t\t[1] = LSM303DL_ACCEL_DEV_NAME,\n\t\t\t[2] = LSM303DLH_ACCEL_DEV_NAME,\n\t\t\t[3] = LSM303DLM_ACCEL_DEV_NAME,\n\t\t},\n\t\t.ch = (struct iio_chan_spec *)st_accel_12bit_channels,\n\t\t.odr = {\n\t\t\t.addr = 0x20,\n\t\t\t.mask = 0x18,\n\t\t\t.odr_avl = {\n\t\t\t\t{ .hz = 50, .value = 0x00, },\n\t\t\t\t{ .hz = 100, .value = 0x01, },\n\t\t\t\t{ .hz = 400, .value = 0x02, },\n\t\t\t\t{ .hz = 1000, .value = 0x03, },\n\t\t\t},\n\t\t},\n\t\t.pw = {\n\t\t\t.addr = 0x20,\n\t\t\t.mask = 0xe0,\n\t\t\t.value_on = ST_SENSORS_DEFAULT_POWER_ON_VALUE,\n\t\t\t.value_off = ST_SENSORS_DEFAULT_POWER_OFF_VALUE,\n\t\t},\n\t\t.enable_axis = {\n\t\t\t.addr = ST_SENSORS_DEFAULT_AXIS_ADDR,\n\t\t\t.mask = ST_SENSORS_DEFAULT_AXIS_MASK,\n\t\t},\n\t\t.fs = {\n\t\t\t.addr = 0x23,\n\t\t\t.mask = 0x30,\n\t\t\t.fs_avl = {\n\t\t\t\t[0] = {\n\t\t\t\t\t.num = ST_ACCEL_FS_AVL_2G,\n\t\t\t\t\t.value = 0x00,\n\t\t\t\t\t.gain = IIO_G_TO_M_S_2(1000),\n\t\t\t\t},\n\t\t\t\t[1] = {\n\t\t\t\t\t.num = ST_ACCEL_FS_AVL_4G,\n\t\t\t\t\t.value = 0x01,\n\t\t\t\t\t.gain = IIO_G_TO_M_S_2(2000),\n\t\t\t\t},\n\t\t\t\t[2] = {\n\t\t\t\t\t.num = ST_ACCEL_FS_AVL_8G,\n\t\t\t\t\t.value = 0x03,\n\t\t\t\t\t.gain = IIO_G_TO_M_S_2(3900),\n\t\t\t\t},\n\t\t\t},\n\t\t},\n\t\t.bdu = {\n\t\t\t.addr = 0x23,\n\t\t\t.mask = 0x80,\n\t\t},\n\t\t.drdy_irq = {\n\t\t\t.int1 = {\n\t\t\t\t.addr = 0x22,\n\t\t\t\t.mask = 0x02,\n\t\t\t\t.addr_od = 0x22,\n\t\t\t\t.mask_od = 0x40,\n\t\t\t},\n\t\t\t.int2 = {\n\t\t\t\t.addr = 0x22,\n\t\t\t\t.mask = 0x10,\n\t\t\t\t.addr_od = 0x22,\n\t\t\t\t.mask_od = 0x40,\n\t\t\t},\n\t\t\t.addr_ihl = 0x22,\n\t\t\t.mask_ihl = 0x80,\n\t\t\t.stat_drdy = {\n\t\t\t\t.addr = ST_SENSORS_DEFAULT_STAT_ADDR,\n\t\t\t\t.mask = 0x07,\n\t\t\t},\n\t\t},\n\t\t.sim = {\n\t\t\t.addr = 0x23,\n\t\t\t.value = BIT(0),\n\t\t},\n\t\t.multi_read_bit = true,\n\t\t.bootime = 2,\n\t},\n\t{\n\t\t.wai = 0x40,\n\t\t.wai_addr = ST_SENSORS_DEFAULT_WAI_ADDRESS,\n\t\t.sensors_supported = {\n\t\t\t[0] = LSM330_ACCEL_DEV_NAME,\n\t\t},\n\t\t.ch = (struct iio_chan_spec *)st_accel_16bit_channels,\n\t\t.odr = {\n\t\t\t.addr = 0x20,\n\t\t\t.mask = 0xf0,\n\t\t\t.odr_avl = {\n\t\t\t\t{ .hz = 3, .value = 0x01, },\n\t\t\t\t{ .hz = 6, .value = 0x02, },\n\t\t\t\t{ .hz = 12, .value = 0x03, },\n\t\t\t\t{ .hz = 25, .value = 0x04, },\n\t\t\t\t{ .hz = 50, .value = 0x05, },\n\t\t\t\t{ .hz = 100, .value = 0x06, },\n\t\t\t\t{ .hz = 200, .value = 0x07, },\n\t\t\t\t{ .hz = 400, .value = 0x08, },\n\t\t\t\t{ .hz = 800, .value = 0x09, },\n\t\t\t\t{ .hz = 1600, .value = 0x0a, },\n\t\t\t},\n\t\t},\n\t\t.pw = {\n\t\t\t.addr = 0x20,\n\t\t\t.mask = 0xf0,\n\t\t\t.value_off = ST_SENSORS_DEFAULT_POWER_OFF_VALUE,\n\t\t},\n\t\t.enable_axis = {\n\t\t\t.addr = ST_SENSORS_DEFAULT_AXIS_ADDR,\n\t\t\t.mask = ST_SENSORS_DEFAULT_AXIS_MASK,\n\t\t},\n\t\t.fs = {\n\t\t\t.addr = 0x24,\n\t\t\t.mask = 0x38,\n\t\t\t.fs_avl = {\n\t\t\t\t[0] = {\n\t\t\t\t\t.num = ST_ACCEL_FS_AVL_2G,\n\t\t\t\t\t.value = 0x00,\n\t\t\t\t\t.gain = IIO_G_TO_M_S_2(61),\n\t\t\t\t},\n\t\t\t\t[1] = {\n\t\t\t\t\t.num = ST_ACCEL_FS_AVL_4G,\n\t\t\t\t\t.value = 0x01,\n\t\t\t\t\t.gain = IIO_G_TO_M_S_2(122),\n\t\t\t\t},\n\t\t\t\t[2] = {\n\t\t\t\t\t.num = ST_ACCEL_FS_AVL_6G,\n\t\t\t\t\t.value = 0x02,\n\t\t\t\t\t.gain = IIO_G_TO_M_S_2(183),\n\t\t\t\t},\n\t\t\t\t[3] = {\n\t\t\t\t\t.num = ST_ACCEL_FS_AVL_8G,\n\t\t\t\t\t.value = 0x03,\n\t\t\t\t\t.gain = IIO_G_TO_M_S_2(244),\n\t\t\t\t},\n\t\t\t\t[4] = {\n\t\t\t\t\t.num = ST_ACCEL_FS_AVL_16G,\n\t\t\t\t\t.value = 0x04,\n\t\t\t\t\t.gain = IIO_G_TO_M_S_2(732),\n\t\t\t\t},\n\t\t\t},\n\t\t},\n\t\t.bdu = {\n\t\t\t.addr = 0x20,\n\t\t\t.mask = 0x08,\n\t\t},\n\t\t.drdy_irq = {\n\t\t\t.int1 = {\n\t\t\t\t.addr = 0x23,\n\t\t\t\t.mask = 0x80,\n\t\t\t},\n\t\t\t.addr_ihl = 0x23,\n\t\t\t.mask_ihl = 0x40,\n\t\t\t.stat_drdy = {\n\t\t\t\t.addr = ST_SENSORS_DEFAULT_STAT_ADDR,\n\t\t\t\t.mask = 0x07,\n\t\t\t},\n\t\t\t.ig1 = {\n\t\t\t\t.en_addr = 0x23,\n\t\t\t\t.en_mask = 0x08,\n\t\t\t},\n\t\t},\n\t\t.sim = {\n\t\t\t.addr = 0x24,\n\t\t\t.value = BIT(0),\n\t\t},\n\t\t.multi_read_bit = false,\n\t\t.bootime = 2,\n\t},\n\t{\n\t\t.wai = 0x3a,\n\t\t.wai_addr = ST_SENSORS_DEFAULT_WAI_ADDRESS,\n\t\t.sensors_supported = {\n\t\t\t[0] = LIS3LV02DL_ACCEL_DEV_NAME,\n\t\t},\n\t\t.ch = (struct iio_chan_spec *)st_accel_12bit_channels,\n\t\t.odr = {\n\t\t\t.addr = 0x20,\n\t\t\t.mask = 0x30,  \n\t\t\t.odr_avl = {\n\t\t\t\t{ .hz = 40, .value = 0x00, },\n\t\t\t\t{ .hz = 160, .value = 0x01, },\n\t\t\t\t{ .hz = 640, .value = 0x02, },\n\t\t\t\t{ .hz = 2560, .value = 0x03, },\n\t\t\t},\n\t\t},\n\t\t.pw = {\n\t\t\t.addr = 0x20,\n\t\t\t.mask = 0xc0,\n\t\t\t.value_on = ST_SENSORS_DEFAULT_POWER_ON_VALUE,\n\t\t\t.value_off = ST_SENSORS_DEFAULT_POWER_OFF_VALUE,\n\t\t},\n\t\t.enable_axis = {\n\t\t\t.addr = ST_SENSORS_DEFAULT_AXIS_ADDR,\n\t\t\t.mask = ST_SENSORS_DEFAULT_AXIS_MASK,\n\t\t},\n\t\t.fs = {\n\t\t\t.addr = 0x21,\n\t\t\t.mask = 0x80,\n\t\t\t.fs_avl = {\n\t\t\t\t[0] = {\n\t\t\t\t\t.num = ST_ACCEL_FS_AVL_2G,\n\t\t\t\t\t.value = 0x00,\n\t\t\t\t\t.gain = IIO_G_TO_M_S_2(1000),\n\t\t\t\t},\n\t\t\t\t[1] = {\n\t\t\t\t\t.num = ST_ACCEL_FS_AVL_6G,\n\t\t\t\t\t.value = 0x01,\n\t\t\t\t\t.gain = IIO_G_TO_M_S_2(3000),\n\t\t\t\t},\n\t\t\t},\n\t\t},\n\t\t.bdu = {\n\t\t\t.addr = 0x21,\n\t\t\t.mask = 0x40,\n\t\t},\n\t\t \n\t\t.das = {\n\t\t\t.addr = 0x21,\n\t\t\t.mask = 0x01,\n\t\t},\n\t\t.drdy_irq = {\n\t\t\t.int1 = {\n\t\t\t\t.addr = 0x21,\n\t\t\t\t.mask = 0x04,\n\t\t\t},\n\t\t\t.stat_drdy = {\n\t\t\t\t.addr = ST_SENSORS_DEFAULT_STAT_ADDR,\n\t\t\t\t.mask = 0x07,\n\t\t\t},\n\t\t},\n\t\t.sim = {\n\t\t\t.addr = 0x21,\n\t\t\t.value = BIT(1),\n\t\t},\n\t\t.multi_read_bit = true,\n\t\t.bootime = 2,  \n\t},\n\t{\n\t\t.wai = 0x3b,\n\t\t.wai_addr = ST_SENSORS_DEFAULT_WAI_ADDRESS,\n\t\t.sensors_supported = {\n\t\t\t[0] = LIS331DL_ACCEL_DEV_NAME,\n\t\t\t[1] = LIS302DL_ACCEL_DEV_NAME,\n\t\t},\n\t\t.ch = (struct iio_chan_spec *)st_accel_8bit_channels,\n\t\t.odr = {\n\t\t\t.addr = 0x20,\n\t\t\t.mask = 0x80,\n\t\t\t.odr_avl = {\n\t\t\t\t{ .hz = 100, .value = 0x00, },\n\t\t\t\t{ .hz = 400, .value = 0x01, },\n\t\t\t},\n\t\t},\n\t\t.pw = {\n\t\t\t.addr = 0x20,\n\t\t\t.mask = 0x40,\n\t\t\t.value_on = ST_SENSORS_DEFAULT_POWER_ON_VALUE,\n\t\t\t.value_off = ST_SENSORS_DEFAULT_POWER_OFF_VALUE,\n\t\t},\n\t\t.enable_axis = {\n\t\t\t.addr = ST_SENSORS_DEFAULT_AXIS_ADDR,\n\t\t\t.mask = ST_SENSORS_DEFAULT_AXIS_MASK,\n\t\t},\n\t\t.fs = {\n\t\t\t.addr = 0x20,\n\t\t\t.mask = 0x20,\n\t\t\t \n\t\t\t.fs_avl = {\n\t\t\t\t[0] = {\n\t\t\t\t\t.num = ST_ACCEL_FS_AVL_2G,\n\t\t\t\t\t.value = 0x00,\n\t\t\t\t\t.gain = IIO_G_TO_M_S_2(18000),\n\t\t\t\t},\n\t\t\t\t[1] = {\n\t\t\t\t\t.num = ST_ACCEL_FS_AVL_8G,\n\t\t\t\t\t.value = 0x01,\n\t\t\t\t\t.gain = IIO_G_TO_M_S_2(72000),\n\t\t\t\t},\n\t\t\t},\n\t\t},\n\t\t.drdy_irq = {\n\t\t\t.int1 = {\n\t\t\t\t.addr = 0x22,\n\t\t\t\t.mask = 0x04,\n\t\t\t\t.addr_od = 0x22,\n\t\t\t\t.mask_od = 0x40,\n\t\t\t},\n\t\t\t.int2 = {\n\t\t\t\t.addr = 0x22,\n\t\t\t\t.mask = 0x20,\n\t\t\t\t.addr_od = 0x22,\n\t\t\t\t.mask_od = 0x40,\n\t\t\t},\n\t\t\t.addr_ihl = 0x22,\n\t\t\t.mask_ihl = 0x80,\n\t\t\t.stat_drdy = {\n\t\t\t\t.addr = ST_SENSORS_DEFAULT_STAT_ADDR,\n\t\t\t\t.mask = 0x07,\n\t\t\t},\n\t\t},\n\t\t.sim = {\n\t\t\t.addr = 0x21,\n\t\t\t.value = BIT(7),\n\t\t},\n\t\t.multi_read_bit = false,\n\t\t.bootime = 2,  \n\t},\n\t{\n\t\t.wai = 0x32,\n\t\t.wai_addr = ST_SENSORS_DEFAULT_WAI_ADDRESS,\n\t\t.sensors_supported = {\n\t\t\t[0] = H3LIS331DL_ACCEL_DEV_NAME,\n\t\t\t[1] = IIS328DQ_ACCEL_DEV_NAME,\n\t\t},\n\t\t.ch = (struct iio_chan_spec *)st_accel_12bit_channels,\n\t\t.odr = {\n\t\t\t.addr = 0x20,\n\t\t\t.mask = 0x18,\n\t\t\t.odr_avl = {\n\t\t\t\t{ .hz = 50, .value = 0x00, },\n\t\t\t\t{ .hz = 100, .value = 0x01, },\n\t\t\t\t{ .hz = 400, .value = 0x02, },\n\t\t\t\t{ .hz = 1000, .value = 0x03, },\n\t\t\t},\n\t\t},\n\t\t.pw = {\n\t\t\t.addr = 0x20,\n\t\t\t.mask = 0x20,\n\t\t\t.value_on = ST_SENSORS_DEFAULT_POWER_ON_VALUE,\n\t\t\t.value_off = ST_SENSORS_DEFAULT_POWER_OFF_VALUE,\n\t\t},\n\t\t.enable_axis = {\n\t\t\t.addr = ST_SENSORS_DEFAULT_AXIS_ADDR,\n\t\t\t.mask = ST_SENSORS_DEFAULT_AXIS_MASK,\n\t\t},\n\t\t.fs = {\n\t\t\t.addr = 0x23,\n\t\t\t.mask = 0x30,\n\t\t\t.fs_avl = {\n\t\t\t\t[0] = {\n\t\t\t\t\t.num = ST_ACCEL_FS_AVL_100G,\n\t\t\t\t\t.value = 0x00,\n\t\t\t\t\t.gain = IIO_G_TO_M_S_2(49000),\n\t\t\t\t},\n\t\t\t\t[1] = {\n\t\t\t\t\t.num = ST_ACCEL_FS_AVL_200G,\n\t\t\t\t\t.value = 0x01,\n\t\t\t\t\t.gain = IIO_G_TO_M_S_2(98000),\n\t\t\t\t},\n\t\t\t\t[2] = {\n\t\t\t\t\t.num = ST_ACCEL_FS_AVL_400G,\n\t\t\t\t\t.value = 0x03,\n\t\t\t\t\t.gain = IIO_G_TO_M_S_2(195000),\n\t\t\t\t},\n\t\t\t},\n\t\t},\n\t\t.bdu = {\n\t\t\t.addr = 0x23,\n\t\t\t.mask = 0x80,\n\t\t},\n\t\t.drdy_irq = {\n\t\t\t.int1 = {\n\t\t\t\t.addr = 0x22,\n\t\t\t\t.mask = 0x02,\n\t\t\t},\n\t\t\t.int2 = {\n\t\t\t\t.addr = 0x22,\n\t\t\t\t.mask = 0x10,\n\t\t\t},\n\t\t\t.addr_ihl = 0x22,\n\t\t\t.mask_ihl = 0x80,\n\t\t},\n\t\t.sim = {\n\t\t\t.addr = 0x23,\n\t\t\t.value = BIT(0),\n\t\t},\n\t\t.multi_read_bit = true,\n\t\t.bootime = 2,\n\t},\n\t{\n\t\t \n\t\t.sensors_supported = {\n\t\t\t[0] = LIS3L02DQ_ACCEL_DEV_NAME,\n\t\t},\n\t\t.ch = (struct iio_chan_spec *)st_accel_12bit_channels,\n\t\t.odr = {\n\t\t\t.addr = 0x20,\n\t\t\t.mask = 0x30,\n\t\t\t.odr_avl = {\n\t\t\t\t{ .hz = 280, .value = 0x00, },\n\t\t\t\t{ .hz = 560, .value = 0x01, },\n\t\t\t\t{ .hz = 1120, .value = 0x02, },\n\t\t\t\t{ .hz = 4480, .value = 0x03, },\n\t\t\t},\n\t\t},\n\t\t.pw = {\n\t\t\t.addr = 0x20,\n\t\t\t.mask = 0xc0,\n\t\t\t.value_on = ST_SENSORS_DEFAULT_POWER_ON_VALUE,\n\t\t\t.value_off = ST_SENSORS_DEFAULT_POWER_OFF_VALUE,\n\t\t},\n\t\t.enable_axis = {\n\t\t\t.addr = ST_SENSORS_DEFAULT_AXIS_ADDR,\n\t\t\t.mask = ST_SENSORS_DEFAULT_AXIS_MASK,\n\t\t},\n\t\t.fs = {\n\t\t\t.fs_avl = {\n\t\t\t\t[0] = {\n\t\t\t\t\t.num = ST_ACCEL_FS_AVL_2G,\n\t\t\t\t\t.gain = IIO_G_TO_M_S_2(488),\n\t\t\t\t},\n\t\t\t},\n\t\t},\n\t\t \n\t\t.bdu = {\n\t\t},\n\t\t.drdy_irq = {\n\t\t\t.int1 = {\n\t\t\t\t.addr = 0x21,\n\t\t\t\t.mask = 0x04,\n\t\t\t},\n\t\t\t.stat_drdy = {\n\t\t\t\t.addr = ST_SENSORS_DEFAULT_STAT_ADDR,\n\t\t\t\t.mask = 0x07,\n\t\t\t},\n\t\t},\n\t\t.sim = {\n\t\t\t.addr = 0x21,\n\t\t\t.value = BIT(1),\n\t\t},\n\t\t.multi_read_bit = false,\n\t\t.bootime = 2,\n\t},\n\t{\n\t\t.wai = 0x33,\n\t\t.wai_addr = ST_SENSORS_DEFAULT_WAI_ADDRESS,\n\t\t.sensors_supported = {\n\t\t\t[0] = LNG2DM_ACCEL_DEV_NAME,\n\t\t},\n\t\t.ch = (struct iio_chan_spec *)st_accel_8bit_channels,\n\t\t.odr = {\n\t\t\t.addr = 0x20,\n\t\t\t.mask = 0xf0,\n\t\t\t.odr_avl = {\n\t\t\t\t{ .hz = 1, .value = 0x01, },\n\t\t\t\t{ .hz = 10, .value = 0x02, },\n\t\t\t\t{ .hz = 25, .value = 0x03, },\n\t\t\t\t{ .hz = 50, .value = 0x04, },\n\t\t\t\t{ .hz = 100, .value = 0x05, },\n\t\t\t\t{ .hz = 200, .value = 0x06, },\n\t\t\t\t{ .hz = 400, .value = 0x07, },\n\t\t\t\t{ .hz = 1600, .value = 0x08, },\n\t\t\t},\n\t\t},\n\t\t.pw = {\n\t\t\t.addr = 0x20,\n\t\t\t.mask = 0xf0,\n\t\t\t.value_off = ST_SENSORS_DEFAULT_POWER_OFF_VALUE,\n\t\t},\n\t\t.enable_axis = {\n\t\t\t.addr = ST_SENSORS_DEFAULT_AXIS_ADDR,\n\t\t\t.mask = ST_SENSORS_DEFAULT_AXIS_MASK,\n\t\t},\n\t\t.fs = {\n\t\t\t.addr = 0x23,\n\t\t\t.mask = 0x30,\n\t\t\t.fs_avl = {\n\t\t\t\t[0] = {\n\t\t\t\t\t.num = ST_ACCEL_FS_AVL_2G,\n\t\t\t\t\t.value = 0x00,\n\t\t\t\t\t.gain = IIO_G_TO_M_S_2(15600),\n\t\t\t\t},\n\t\t\t\t[1] = {\n\t\t\t\t\t.num = ST_ACCEL_FS_AVL_4G,\n\t\t\t\t\t.value = 0x01,\n\t\t\t\t\t.gain = IIO_G_TO_M_S_2(31200),\n\t\t\t\t},\n\t\t\t\t[2] = {\n\t\t\t\t\t.num = ST_ACCEL_FS_AVL_8G,\n\t\t\t\t\t.value = 0x02,\n\t\t\t\t\t.gain = IIO_G_TO_M_S_2(62500),\n\t\t\t\t},\n\t\t\t\t[3] = {\n\t\t\t\t\t.num = ST_ACCEL_FS_AVL_16G,\n\t\t\t\t\t.value = 0x03,\n\t\t\t\t\t.gain = IIO_G_TO_M_S_2(187500),\n\t\t\t\t},\n\t\t\t},\n\t\t},\n\t\t.drdy_irq = {\n\t\t\t.int1 = {\n\t\t\t\t.addr = 0x22,\n\t\t\t\t.mask = 0x10,\n\t\t\t},\n\t\t\t.addr_ihl = 0x25,\n\t\t\t.mask_ihl = 0x02,\n\t\t\t.stat_drdy = {\n\t\t\t\t.addr = ST_SENSORS_DEFAULT_STAT_ADDR,\n\t\t\t\t.mask = 0x07,\n\t\t\t},\n\t\t},\n\t\t.sim = {\n\t\t\t.addr = 0x23,\n\t\t\t.value = BIT(0),\n\t\t},\n\t\t.multi_read_bit = true,\n\t\t.bootime = 2,\n\t},\n\t{\n\t\t.wai = 0x44,\n\t\t.wai_addr = ST_SENSORS_DEFAULT_WAI_ADDRESS,\n\t\t.sensors_supported = {\n\t\t\t[0] = LIS2DW12_ACCEL_DEV_NAME,\n\t\t},\n\t\t.ch = (struct iio_chan_spec *)st_accel_12bit_channels,\n\t\t.odr = {\n\t\t\t.addr = 0x20,\n\t\t\t.mask = 0xf0,\n\t\t\t.odr_avl = {\n\t\t\t\t{ .hz = 1, .value = 0x01, },\n\t\t\t\t{ .hz = 12, .value = 0x02, },\n\t\t\t\t{ .hz = 25, .value = 0x03, },\n\t\t\t\t{ .hz = 50, .value = 0x04, },\n\t\t\t\t{ .hz = 100, .value = 0x05, },\n\t\t\t\t{ .hz = 200, .value = 0x06, },\n\t\t\t},\n\t\t},\n\t\t.pw = {\n\t\t\t.addr = 0x20,\n\t\t\t.mask = 0xf0,\n\t\t\t.value_off = ST_SENSORS_DEFAULT_POWER_OFF_VALUE,\n\t\t},\n\t\t.fs = {\n\t\t\t.addr = 0x25,\n\t\t\t.mask = 0x30,\n\t\t\t.fs_avl = {\n\t\t\t\t[0] = {\n\t\t\t\t\t.num = ST_ACCEL_FS_AVL_2G,\n\t\t\t\t\t.value = 0x00,\n\t\t\t\t\t.gain = IIO_G_TO_M_S_2(976),\n\t\t\t\t},\n\t\t\t\t[1] = {\n\t\t\t\t\t.num = ST_ACCEL_FS_AVL_4G,\n\t\t\t\t\t.value = 0x01,\n\t\t\t\t\t.gain = IIO_G_TO_M_S_2(1952),\n\t\t\t\t},\n\t\t\t\t[2] = {\n\t\t\t\t\t.num = ST_ACCEL_FS_AVL_8G,\n\t\t\t\t\t.value = 0x02,\n\t\t\t\t\t.gain = IIO_G_TO_M_S_2(3904),\n\t\t\t\t},\n\t\t\t\t[3] = {\n\t\t\t\t\t.num = ST_ACCEL_FS_AVL_16G,\n\t\t\t\t\t.value = 0x03,\n\t\t\t\t\t.gain = IIO_G_TO_M_S_2(7808),\n\t\t\t\t},\n\t\t\t},\n\t\t},\n\t\t.bdu = {\n\t\t\t.addr = 0x21,\n\t\t\t.mask = 0x08,\n\t\t},\n\t\t.drdy_irq = {\n\t\t\t.int1 = {\n\t\t\t\t.addr = 0x23,\n\t\t\t\t.mask = 0x01,\n\t\t\t\t.addr_od = 0x22,\n\t\t\t\t.mask_od = 0x20,\n\t\t\t},\n\t\t\t.int2 = {\n\t\t\t\t.addr = 0x24,\n\t\t\t\t.mask = 0x01,\n\t\t\t\t.addr_od = 0x22,\n\t\t\t\t.mask_od = 0x20,\n\t\t\t},\n\t\t\t.addr_ihl = 0x22,\n\t\t\t.mask_ihl = 0x08,\n\t\t\t.stat_drdy = {\n\t\t\t\t.addr = ST_SENSORS_DEFAULT_STAT_ADDR,\n\t\t\t\t.mask = 0x01,\n\t\t\t},\n\t\t},\n\t\t.sim = {\n\t\t\t.addr = 0x21,\n\t\t\t.value = BIT(0),\n\t\t},\n\t\t.multi_read_bit = false,\n\t\t.bootime = 2,\n\t},\n\t{\n\t\t.wai = 0x11,\n\t\t.wai_addr = ST_SENSORS_DEFAULT_WAI_ADDRESS,\n\t\t.sensors_supported = {\n\t\t\t[0] = LIS3DHH_ACCEL_DEV_NAME,\n\t\t},\n\t\t.ch = (struct iio_chan_spec *)st_accel_16bit_channels,\n\t\t.odr = {\n\t\t\t \n\t\t\t.odr_avl = {\n\t\t\t\t{ .hz = 1100, .value = 0x00, },\n\t\t\t},\n\t\t},\n\t\t.pw = {\n\t\t\t.addr = 0x20,\n\t\t\t.mask = 0x80,\n\t\t\t.value_on = ST_SENSORS_DEFAULT_POWER_ON_VALUE,\n\t\t\t.value_off = ST_SENSORS_DEFAULT_POWER_OFF_VALUE,\n\t\t},\n\t\t.fs = {\n\t\t\t.fs_avl = {\n\t\t\t\t[0] = {\n\t\t\t\t\t.num = ST_ACCEL_FS_AVL_2G,\n\t\t\t\t\t.gain = IIO_G_TO_M_S_2(76),\n\t\t\t\t},\n\t\t\t},\n\t\t},\n\t\t.bdu = {\n\t\t\t.addr = 0x20,\n\t\t\t.mask = 0x01,\n\t\t},\n\t\t.drdy_irq = {\n\t\t\t.int1 = {\n\t\t\t\t.addr = 0x21,\n\t\t\t\t.mask = 0x80,\n\t\t\t\t.addr_od = 0x23,\n\t\t\t\t.mask_od = 0x04,\n\t\t\t},\n\t\t\t.int2 = {\n\t\t\t\t.addr = 0x22,\n\t\t\t\t.mask = 0x80,\n\t\t\t\t.addr_od = 0x23,\n\t\t\t\t.mask_od = 0x08,\n\t\t\t},\n\t\t\t.stat_drdy = {\n\t\t\t\t.addr = ST_SENSORS_DEFAULT_STAT_ADDR,\n\t\t\t\t.mask = 0x07,\n\t\t\t},\n\t\t},\n\t\t.multi_read_bit = false,\n\t\t.bootime = 2,\n\t},\n\t{\n\t\t.wai = 0x33,\n\t\t.wai_addr = ST_SENSORS_DEFAULT_WAI_ADDRESS,\n\t\t.sensors_supported = {\n\t\t\t[0] = LIS2DE12_ACCEL_DEV_NAME,\n\t\t},\n\t\t.ch = (struct iio_chan_spec *)st_accel_8bit_channels,\n\t\t.odr = {\n\t\t\t.addr = 0x20,\n\t\t\t.mask = 0xf0,\n\t\t\t.odr_avl = {\n\t\t\t\t{ .hz = 1, .value = 0x01, },\n\t\t\t\t{ .hz = 10, .value = 0x02, },\n\t\t\t\t{ .hz = 25, .value = 0x03, },\n\t\t\t\t{ .hz = 50, .value = 0x04, },\n\t\t\t\t{ .hz = 100, .value = 0x05, },\n\t\t\t\t{ .hz = 200, .value = 0x06, },\n\t\t\t\t{ .hz = 400, .value = 0x07, },\n\t\t\t\t{ .hz = 1620, .value = 0x08, },\n\t\t\t\t{ .hz = 5376, .value = 0x09, },\n\t\t\t},\n\t\t},\n\t\t.pw = {\n\t\t\t.addr = 0x20,\n\t\t\t.mask = 0xf0,\n\t\t\t.value_off = ST_SENSORS_DEFAULT_POWER_OFF_VALUE,\n\t\t},\n\t\t.enable_axis = {\n\t\t\t.addr = ST_SENSORS_DEFAULT_AXIS_ADDR,\n\t\t\t.mask = ST_SENSORS_DEFAULT_AXIS_MASK,\n\t\t},\n\t\t.fs = {\n\t\t\t.addr = 0x23,\n\t\t\t.mask = 0x30,\n\t\t\t.fs_avl = {\n\t\t\t\t[0] = {\n\t\t\t\t\t.num = ST_ACCEL_FS_AVL_2G,\n\t\t\t\t\t.value = 0x00,\n\t\t\t\t\t.gain = IIO_G_TO_M_S_2(15600),\n\t\t\t\t},\n\t\t\t\t[1] = {\n\t\t\t\t\t.num = ST_ACCEL_FS_AVL_4G,\n\t\t\t\t\t.value = 0x01,\n\t\t\t\t\t.gain = IIO_G_TO_M_S_2(31200),\n\t\t\t\t},\n\t\t\t\t[2] = {\n\t\t\t\t\t.num = ST_ACCEL_FS_AVL_8G,\n\t\t\t\t\t.value = 0x02,\n\t\t\t\t\t.gain = IIO_G_TO_M_S_2(62500),\n\t\t\t\t},\n\t\t\t\t[3] = {\n\t\t\t\t\t.num = ST_ACCEL_FS_AVL_16G,\n\t\t\t\t\t.value = 0x03,\n\t\t\t\t\t.gain = IIO_G_TO_M_S_2(187500),\n\t\t\t\t},\n\t\t\t},\n\t\t},\n\t\t.drdy_irq = {\n\t\t\t.int1 = {\n\t\t\t\t.addr = 0x22,\n\t\t\t\t.mask = 0x10,\n\t\t\t},\n\t\t\t.addr_ihl = 0x25,\n\t\t\t.mask_ihl = 0x02,\n\t\t\t.stat_drdy = {\n\t\t\t\t.addr = ST_SENSORS_DEFAULT_STAT_ADDR,\n\t\t\t\t.mask = 0x07,\n\t\t\t},\n\t\t},\n\t\t.sim = {\n\t\t\t.addr = 0x23,\n\t\t\t.value = BIT(0),\n\t\t},\n\t\t.multi_read_bit = true,\n\t\t.bootime = 2,\n\t},\n\t{\n\t\t.wai = 0x41,\n\t\t.wai_addr = ST_SENSORS_DEFAULT_WAI_ADDRESS,\n\t\t.sensors_supported = {\n\t\t\t[0] = LIS2HH12_ACCEL_DEV_NAME,\n\t\t\t[1] = LSM303C_ACCEL_DEV_NAME,\n\t\t},\n\t\t.ch = (struct iio_chan_spec *)st_accel_16bit_channels,\n\t\t.odr = {\n\t\t\t.addr = 0x20,\n\t\t\t.mask = 0x70,\n\t\t\t.odr_avl = {\n\t\t\t\t{ .hz = 10, .value = 0x01, },\n\t\t\t\t{ .hz = 50, .value = 0x02, },\n\t\t\t\t{ .hz = 100, .value = 0x03, },\n\t\t\t\t{ .hz = 200, .value = 0x04, },\n\t\t\t\t{ .hz = 400, .value = 0x05, },\n\t\t\t\t{ .hz = 800, .value = 0x06, },\n\t\t\t},\n\t\t},\n\t\t.pw = {\n\t\t\t.addr = 0x20,\n\t\t\t.mask = 0x70,\n\t\t\t.value_off = ST_SENSORS_DEFAULT_POWER_OFF_VALUE,\n\t\t},\n\t\t.enable_axis = {\n\t\t\t.addr = ST_SENSORS_DEFAULT_AXIS_ADDR,\n\t\t\t.mask = ST_SENSORS_DEFAULT_AXIS_MASK,\n\t\t},\n\t\t.fs = {\n\t\t\t.addr = 0x23,\n\t\t\t.mask = 0x30,\n\t\t\t.fs_avl = {\n\t\t\t\t[0] = {\n\t\t\t\t\t.num = ST_ACCEL_FS_AVL_2G,\n\t\t\t\t\t.value = 0x00,\n\t\t\t\t\t.gain = IIO_G_TO_M_S_2(61),\n\t\t\t\t},\n\t\t\t\t[1] = {\n\t\t\t\t\t.num = ST_ACCEL_FS_AVL_4G,\n\t\t\t\t\t.value = 0x02,\n\t\t\t\t\t.gain = IIO_G_TO_M_S_2(122),\n\t\t\t\t},\n\t\t\t\t[2] = {\n\t\t\t\t\t.num = ST_ACCEL_FS_AVL_8G,\n\t\t\t\t\t.value = 0x03,\n\t\t\t\t\t.gain = IIO_G_TO_M_S_2(244),\n\t\t\t\t},\n\t\t\t},\n\t\t},\n\t\t.bdu = {\n\t\t\t.addr = 0x20,\n\t\t\t.mask = 0x08,\n\t\t},\n\t\t.drdy_irq = {\n\t\t\t.int1 = {\n\t\t\t\t.addr = 0x22,\n\t\t\t\t.mask = 0x01,\n\t\t\t},\n\t\t\t.int2 = {\n\t\t\t\t.addr = 0x25,\n\t\t\t\t.mask = 0x01,\n\t\t\t},\n\t\t\t.addr_ihl = 0x24,\n\t\t\t.mask_ihl = 0x02,\n\t\t\t.stat_drdy = {\n\t\t\t\t.addr = ST_SENSORS_DEFAULT_STAT_ADDR,\n\t\t\t\t.mask = 0x07,\n\t\t\t},\n\t\t},\n\t\t.sim = {\n\t\t\t.addr = 0x23,\n\t\t\t.value = BIT(0),\n\t\t},\n\t\t.multi_read_bit = true,\n\t\t.bootime = 2,\n\t},\n\t{\n\t\t.wai = 0x49,\n\t\t.wai_addr = ST_SENSORS_DEFAULT_WAI_ADDRESS,\n\t\t.sensors_supported = {\n\t\t\t[0] = LSM9DS0_IMU_DEV_NAME,\n\t\t\t[1] = LSM303D_IMU_DEV_NAME,\n\t\t},\n\t\t.ch = (struct iio_chan_spec *)st_accel_16bit_channels,\n\t\t.odr = {\n\t\t\t.addr = 0x20,\n\t\t\t.mask = GENMASK(7, 4),\n\t\t\t.odr_avl = {\n\t\t\t\t{ 3, 0x01, },\n\t\t\t\t{ 6, 0x02, },\n\t\t\t\t{ 12, 0x03, },\n\t\t\t\t{ 25, 0x04, },\n\t\t\t\t{ 50, 0x05, },\n\t\t\t\t{ 100, 0x06, },\n\t\t\t\t{ 200, 0x07, },\n\t\t\t\t{ 400, 0x08, },\n\t\t\t\t{ 800, 0x09, },\n\t\t\t\t{ 1600, 0x0a, },\n\t\t\t},\n\t\t},\n\t\t.pw = {\n\t\t\t.addr = 0x20,\n\t\t\t.mask = GENMASK(7, 4),\n\t\t\t.value_off = ST_SENSORS_DEFAULT_POWER_OFF_VALUE,\n\t\t},\n\t\t.enable_axis = {\n\t\t\t.addr = ST_SENSORS_DEFAULT_AXIS_ADDR,\n\t\t\t.mask = ST_SENSORS_DEFAULT_AXIS_MASK,\n\t\t},\n\t\t.fs = {\n\t\t\t.addr = 0x21,\n\t\t\t.mask = GENMASK(5, 3),\n\t\t\t.fs_avl = {\n\t\t\t\t[0] = {\n\t\t\t\t\t.num = ST_ACCEL_FS_AVL_2G,\n\t\t\t\t\t.value = 0x00,\n\t\t\t\t\t.gain = IIO_G_TO_M_S_2(61),\n\t\t\t\t},\n\t\t\t\t[1] = {\n\t\t\t\t\t.num = ST_ACCEL_FS_AVL_4G,\n\t\t\t\t\t.value = 0x01,\n\t\t\t\t\t.gain = IIO_G_TO_M_S_2(122),\n\t\t\t\t},\n\t\t\t\t[2] = {\n\t\t\t\t\t.num = ST_ACCEL_FS_AVL_6G,\n\t\t\t\t\t.value = 0x02,\n\t\t\t\t\t.gain = IIO_G_TO_M_S_2(183),\n\t\t\t\t},\n\t\t\t\t[3] = {\n\t\t\t\t\t.num = ST_ACCEL_FS_AVL_8G,\n\t\t\t\t\t.value = 0x03,\n\t\t\t\t\t.gain = IIO_G_TO_M_S_2(244),\n\t\t\t\t},\n\t\t\t\t[4] = {\n\t\t\t\t\t.num = ST_ACCEL_FS_AVL_16G,\n\t\t\t\t\t.value = 0x04,\n\t\t\t\t\t.gain = IIO_G_TO_M_S_2(732),\n\t\t\t\t},\n\t\t\t},\n\t\t},\n\t\t.bdu = {\n\t\t\t.addr = 0x20,\n\t\t\t.mask = BIT(3),\n\t\t},\n\t\t.drdy_irq = {\n\t\t\t.int1 = {\n\t\t\t\t.addr = 0x22,\n\t\t\t\t.mask = BIT(2),\n\t\t\t},\n\t\t\t.int2 = {\n\t\t\t\t.addr = 0x23,\n\t\t\t\t.mask = BIT(3),\n\t\t\t},\n\t\t\t.stat_drdy = {\n\t\t\t\t.addr = ST_SENSORS_DEFAULT_STAT_ADDR,\n\t\t\t\t.mask = GENMASK(2, 0),\n\t\t\t},\n\t\t},\n\t\t.sim = {\n\t\t\t.addr = 0x21,\n\t\t\t.value = BIT(0),\n\t\t},\n\t\t.multi_read_bit = true,\n\t\t.bootime = 2,\n\t},\n\t{\n\t\t \n\t\t.wai = 0x11,\n\t\t.wai_addr = ST_SENSORS_DEFAULT_WAI_ADDRESS,\n\t\t.sensors_supported = {\n\t\t\t[0] = SC7A20_ACCEL_DEV_NAME,\n\t\t},\n\t\t.ch = (struct iio_chan_spec *)st_accel_12bit_channels,\n\t\t.odr = {\n\t\t\t.addr = 0x20,\n\t\t\t.mask = 0xf0,\n\t\t\t.odr_avl = {\n\t\t\t\t{ .hz = 1, .value = 0x01, },\n\t\t\t\t{ .hz = 10, .value = 0x02, },\n\t\t\t\t{ .hz = 25, .value = 0x03, },\n\t\t\t\t{ .hz = 50, .value = 0x04, },\n\t\t\t\t{ .hz = 100, .value = 0x05, },\n\t\t\t\t{ .hz = 200, .value = 0x06, },\n\t\t\t\t{ .hz = 400, .value = 0x07, },\n\t\t\t\t{ .hz = 1600, .value = 0x08, },\n\t\t\t},\n\t\t},\n\t\t.pw = {\n\t\t\t.addr = 0x20,\n\t\t\t.mask = 0xf0,\n\t\t\t.value_off = ST_SENSORS_DEFAULT_POWER_OFF_VALUE,\n\t\t},\n\t\t.enable_axis = {\n\t\t\t.addr = ST_SENSORS_DEFAULT_AXIS_ADDR,\n\t\t\t.mask = ST_SENSORS_DEFAULT_AXIS_MASK,\n\t\t},\n\t\t.fs = {\n\t\t\t.addr = 0x23,\n\t\t\t.mask = 0x30,\n\t\t\t.fs_avl = {\n\t\t\t\t[0] = {\n\t\t\t\t\t.num = ST_ACCEL_FS_AVL_2G,\n\t\t\t\t\t.value = 0x00,\n\t\t\t\t\t.gain = IIO_G_TO_M_S_2(1000),\n\t\t\t\t},\n\t\t\t\t[1] = {\n\t\t\t\t\t.num = ST_ACCEL_FS_AVL_4G,\n\t\t\t\t\t.value = 0x01,\n\t\t\t\t\t.gain = IIO_G_TO_M_S_2(2000),\n\t\t\t\t},\n\t\t\t\t[2] = {\n\t\t\t\t\t.num = ST_ACCEL_FS_AVL_8G,\n\t\t\t\t\t.value = 0x02,\n\t\t\t\t\t.gain = IIO_G_TO_M_S_2(4000),\n\t\t\t\t},\n\t\t\t\t[3] = {\n\t\t\t\t\t.num = ST_ACCEL_FS_AVL_16G,\n\t\t\t\t\t.value = 0x03,\n\t\t\t\t\t.gain = IIO_G_TO_M_S_2(12000),\n\t\t\t\t},\n\t\t\t},\n\t\t},\n\t\t.bdu = {\n\t\t\t.addr = 0x23,\n\t\t\t.mask = 0x80,\n\t\t},\n\t\t.drdy_irq = {\n\t\t\t.int1 = {\n\t\t\t\t.addr = 0x22,\n\t\t\t\t.mask = 0x10,\n\t\t\t},\n\t\t\t.addr_ihl = 0x25,\n\t\t\t.mask_ihl = 0x02,\n\t\t\t.stat_drdy = {\n\t\t\t\t.addr = ST_SENSORS_DEFAULT_STAT_ADDR,\n\t\t\t\t.mask = 0x07,\n\t\t\t},\n\t\t},\n\t\t.sim = {\n\t\t\t.addr = 0x23,\n\t\t\t.value = BIT(0),\n\t\t},\n\t\t.multi_read_bit = true,\n\t\t.bootime = 2,\n\t},\n};\n\n \nstatic const struct st_sensors_platform_data default_accel_pdata = {\n\t.drdy_int_pin = 1,\n};\n\nstatic int st_accel_read_raw(struct iio_dev *indio_dev,\n\t\t\tstruct iio_chan_spec const *ch, int *val,\n\t\t\t\t\t\t\tint *val2, long mask)\n{\n\tint err;\n\tstruct st_sensor_data *adata = iio_priv(indio_dev);\n\n\tswitch (mask) {\n\tcase IIO_CHAN_INFO_RAW:\n\t\terr = st_sensors_read_info_raw(indio_dev, ch, val);\n\t\tif (err < 0)\n\t\t\tgoto read_error;\n\n\t\treturn IIO_VAL_INT;\n\tcase IIO_CHAN_INFO_SCALE:\n\t\t*val = adata->current_fullscale->gain / 1000000;\n\t\t*val2 = adata->current_fullscale->gain % 1000000;\n\t\treturn IIO_VAL_INT_PLUS_MICRO;\n\tcase IIO_CHAN_INFO_SAMP_FREQ:\n\t\t*val = adata->odr;\n\t\treturn IIO_VAL_INT;\n\tdefault:\n\t\treturn -EINVAL;\n\t}\n\nread_error:\n\treturn err;\n}\n\nstatic int st_accel_write_raw(struct iio_dev *indio_dev,\n\t\tstruct iio_chan_spec const *chan, int val, int val2, long mask)\n{\n\tswitch (mask) {\n\tcase IIO_CHAN_INFO_SCALE: {\n\t\tint gain;\n\n\t\tgain = val * 1000000 + val2;\n\t\treturn st_sensors_set_fullscale_by_gain(indio_dev, gain);\n\t}\n\tcase IIO_CHAN_INFO_SAMP_FREQ:\n\t\tif (val2)\n\t\t\treturn -EINVAL;\n\n\t\treturn st_sensors_set_odr(indio_dev, val);\n\tdefault:\n\t\treturn -EINVAL;\n\t}\n}\n\nstatic ST_SENSORS_DEV_ATTR_SAMP_FREQ_AVAIL();\nstatic ST_SENSORS_DEV_ATTR_SCALE_AVAIL(in_accel_scale_available);\n\nstatic struct attribute *st_accel_attributes[] = {\n\t&iio_dev_attr_sampling_frequency_available.dev_attr.attr,\n\t&iio_dev_attr_in_accel_scale_available.dev_attr.attr,\n\tNULL,\n};\n\nstatic const struct attribute_group st_accel_attribute_group = {\n\t.attrs = st_accel_attributes,\n};\n\nstatic const struct iio_info accel_info = {\n\t.attrs = &st_accel_attribute_group,\n\t.read_raw = &st_accel_read_raw,\n\t.write_raw = &st_accel_write_raw,\n\t.debugfs_reg_access = &st_sensors_debugfs_reg_access,\n};\n\n#ifdef CONFIG_IIO_TRIGGER\nstatic const struct iio_trigger_ops st_accel_trigger_ops = {\n\t.set_trigger_state = ST_ACCEL_TRIGGER_SET_STATE,\n\t.validate_device = st_sensors_validate_device,\n};\n#define ST_ACCEL_TRIGGER_OPS (&st_accel_trigger_ops)\n#else\n#define ST_ACCEL_TRIGGER_OPS NULL\n#endif\n\n#ifdef CONFIG_ACPI\n \nstatic int apply_acpi_orientation(struct iio_dev *indio_dev)\n{\n\tstruct st_sensor_data *adata = iio_priv(indio_dev);\n\tstruct acpi_buffer buffer = {ACPI_ALLOCATE_BUFFER, NULL};\n\tstruct acpi_device *adev;\n\tunion acpi_object *ont;\n\tunion acpi_object *elements;\n\tacpi_status status;\n\tint ret = -EINVAL;\n\tunsigned int val;\n\tint i, j;\n\tint final_ont[3][3] = { { 0 }, };\n\n\t \n\tconst int default_ont[3][3] = {\n\t\t{  0,  1,  0 },\n\t\t{ -1,  0,  0 },\n\t\t{  0,  0, -1 },\n\t};\n\n\n\tadev = ACPI_COMPANION(indio_dev->dev.parent);\n\tif (!adev)\n\t\treturn -ENXIO;\n\n\t \n\tstatus = acpi_evaluate_object(adev->handle, \"_ONT\", NULL, &buffer);\n\tif (status == AE_NOT_FOUND) {\n\t\treturn -ENXIO;\n\t} else if (ACPI_FAILURE(status)) {\n\t\tdev_warn(&indio_dev->dev, \"failed to execute _ONT: %d\\n\",\n\t\t\t status);\n\t\treturn status;\n\t}\n\n\tont = buffer.pointer;\n\tif (ont->type != ACPI_TYPE_PACKAGE || ont->package.count != 6)\n\t\tgoto out;\n\n\t \n\telements = ont->package.elements;\n\tfor (i = 0; i < 3; i++) {\n\t\tif (elements[i].type != ACPI_TYPE_INTEGER)\n\t\t\tgoto out;\n\n\t\tval = elements[i].integer.value;\n\t\tif (val > 2)\n\t\t\tgoto out;\n\n\t\t \n\t\tfinal_ont[0][i] = default_ont[0][val];\n\t\tfinal_ont[1][i] = default_ont[1][val];\n\t\tfinal_ont[2][i] = default_ont[2][val];\n\t}\n\n\t \n\telements += 3;\n\tfor (i = 0; i < 3; i++) {\n\t\tif (elements[i].type != ACPI_TYPE_INTEGER)\n\t\t\tgoto out;\n\n\t\tval = elements[i].integer.value;\n\t\tif (val != 0 && val != 1)\n\t\t\tgoto out;\n\t\tif (!val)\n\t\t\tcontinue;\n\n\t\t \n\t\tfinal_ont[0][i] *= -1;\n\t\tfinal_ont[1][i] *= -1;\n\t\tfinal_ont[2][i] *= -1;\n\t}\n\n\t \n\tfor (i = 0; i < 3; i++) {\n\t\tfor (j = 0; j < 3; j++) {\n\t\t\tint matrix_val = final_ont[i][j];\n\t\t\tchar *str_value;\n\n\t\t\tswitch (matrix_val) {\n\t\t\tcase -1:\n\t\t\t\tstr_value = \"-1\";\n\t\t\t\tbreak;\n\t\t\tcase 0:\n\t\t\t\tstr_value = \"0\";\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tstr_value = \"1\";\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tgoto out;\n\t\t\t}\n\t\t\tadata->mount_matrix.rotation[i * 3 + j] = str_value;\n\t\t}\n\t}\n\n\tret = 0;\n\tdev_info(&indio_dev->dev, \"computed mount matrix from ACPI\\n\");\n\nout:\n\tkfree(buffer.pointer);\n\tif (ret)\n\t\tdev_dbg(&indio_dev->dev,\n\t\t\t\"failed to apply ACPI orientation data: %d\\n\", ret);\n\n\treturn ret;\n}\n#else  \nstatic int apply_acpi_orientation(struct iio_dev *indio_dev)\n{\n\treturn -EINVAL;\n}\n#endif\n\n \nconst struct st_sensor_settings *st_accel_get_settings(const char *name)\n{\n\tint index = st_sensors_get_settings_index(name,\n\t\t\t\t\tst_accel_sensors_settings,\n\t\t\t\t\tARRAY_SIZE(st_accel_sensors_settings));\n\tif (index < 0)\n\t\treturn NULL;\n\n\treturn &st_accel_sensors_settings[index];\n}\nEXPORT_SYMBOL_NS(st_accel_get_settings, IIO_ST_SENSORS);\n\nint st_accel_common_probe(struct iio_dev *indio_dev)\n{\n\tstruct st_sensor_data *adata = iio_priv(indio_dev);\n\tstruct device *parent = indio_dev->dev.parent;\n\tstruct st_sensors_platform_data *pdata = dev_get_platdata(parent);\n\tint err;\n\n\tindio_dev->modes = INDIO_DIRECT_MODE;\n\tindio_dev->info = &accel_info;\n\n\terr = st_sensors_verify_id(indio_dev);\n\tif (err < 0)\n\t\treturn err;\n\n\tadata->num_data_channels = ST_ACCEL_NUMBER_DATA_CHANNELS;\n\tindio_dev->channels = adata->sensor_settings->ch;\n\tindio_dev->num_channels = ST_SENSORS_NUMBER_ALL_CHANNELS;\n\n\t \n\terr = apply_acpi_orientation(indio_dev);\n\tif (err) {\n\t\terr = iio_read_mount_matrix(parent, &adata->mount_matrix);\n\t\tif (err)\n\t\t\treturn err;\n\t}\n\n\tadata->current_fullscale = &adata->sensor_settings->fs.fs_avl[0];\n\tadata->odr = adata->sensor_settings->odr.odr_avl[0].hz;\n\n\tif (!pdata)\n\t\tpdata = (struct st_sensors_platform_data *)&default_accel_pdata;\n\n\terr = st_sensors_init_sensor(indio_dev, pdata);\n\tif (err < 0)\n\t\treturn err;\n\n\terr = st_accel_allocate_ring(indio_dev);\n\tif (err < 0)\n\t\treturn err;\n\n\tif (adata->irq > 0) {\n\t\terr = st_sensors_allocate_trigger(indio_dev,\n\t\t\t\t\t\t ST_ACCEL_TRIGGER_OPS);\n\t\tif (err < 0)\n\t\t\treturn err;\n\t}\n\n\treturn devm_iio_device_register(parent, indio_dev);\n}\nEXPORT_SYMBOL_NS(st_accel_common_probe, IIO_ST_SENSORS);\n\nMODULE_AUTHOR(\"Denis Ciocca <denis.ciocca@st.com>\");\nMODULE_DESCRIPTION(\"STMicroelectronics accelerometers driver\");\nMODULE_LICENSE(\"GPL v2\");\nMODULE_IMPORT_NS(IIO_ST_SENSORS);\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}