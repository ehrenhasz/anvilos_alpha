{
  "module_name": "zpa2326_spi.c",
  "hash_id": "e5b33676bdcb50d59d6ca165f66c25a974c023f9a1c7bdde1f61bd77c5800238",
  "original_prompt": "Ingested from linux-6.6.14/drivers/iio/pressure/zpa2326_spi.c",
  "human_readable_source": "\n \n\n#include <linux/module.h>\n#include <linux/regmap.h>\n#include <linux/spi/spi.h>\n#include <linux/mod_devicetable.h>\n#include \"zpa2326.h\"\n\n \nstatic const struct regmap_config zpa2326_regmap_spi_config = {\n\t.reg_bits       = 8,\n\t.val_bits       = 8,\n\t.writeable_reg  = zpa2326_isreg_writeable,\n\t.readable_reg   = zpa2326_isreg_readable,\n\t.precious_reg   = zpa2326_isreg_precious,\n\t.max_register   = ZPA2326_TEMP_OUT_H_REG,\n\t.read_flag_mask = BIT(7) | BIT(6),\n\t.cache_type     = REGCACHE_NONE,\n};\n\nstatic int zpa2326_probe_spi(struct spi_device *spi)\n{\n\tstruct regmap *regmap;\n\tint            err;\n\n\tregmap = devm_regmap_init_spi(spi, &zpa2326_regmap_spi_config);\n\tif (IS_ERR(regmap)) {\n\t\tdev_err(&spi->dev, \"failed to init registers map\");\n\t\treturn PTR_ERR(regmap);\n\t}\n\n\t \n\tspi->mode = SPI_MODE_3;\n\tspi->max_speed_hz = min(spi->max_speed_hz, 1000000U);\n\tspi->bits_per_word = 8;\n\terr = spi_setup(spi);\n\tif (err < 0)\n\t\treturn err;\n\n\treturn zpa2326_probe(&spi->dev, spi_get_device_id(spi)->name,\n\t\t\t     spi->irq, ZPA2326_DEVICE_ID, regmap);\n}\n\nstatic void zpa2326_remove_spi(struct spi_device *spi)\n{\n\tzpa2326_remove(&spi->dev);\n}\n\nstatic const struct spi_device_id zpa2326_spi_ids[] = {\n\t{ \"zpa2326\", 0 },\n\t{ },\n};\nMODULE_DEVICE_TABLE(spi, zpa2326_spi_ids);\n\nstatic const struct of_device_id zpa2326_spi_matches[] = {\n\t{ .compatible = \"murata,zpa2326\" },\n\t{ }\n};\nMODULE_DEVICE_TABLE(of, zpa2326_spi_matches);\n\nstatic struct spi_driver zpa2326_spi_driver = {\n\t.driver = {\n\t\t.name           = \"zpa2326-spi\",\n\t\t.of_match_table = zpa2326_spi_matches,\n\t\t.pm             = ZPA2326_PM_OPS,\n\t},\n\t.probe    = zpa2326_probe_spi,\n\t.remove   = zpa2326_remove_spi,\n\t.id_table = zpa2326_spi_ids,\n};\nmodule_spi_driver(zpa2326_spi_driver);\n\nMODULE_AUTHOR(\"Gregor Boirie <gregor.boirie@parrot.com>\");\nMODULE_DESCRIPTION(\"SPI driver for Murata ZPA2326 pressure sensor\");\nMODULE_LICENSE(\"GPL v2\");\nMODULE_IMPORT_NS(IIO_ZPA2326);\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}