{
  "module_name": "st_pressure_spi.c",
  "hash_id": "109e2ce71490c83084daba302ac328f992f244203b8d990d6f6e3647d829db96",
  "original_prompt": "Ingested from linux-6.6.14/drivers/iio/pressure/st_pressure_spi.c",
  "human_readable_source": "\n \n\n#include <linux/kernel.h>\n#include <linux/module.h>\n#include <linux/mod_devicetable.h>\n#include <linux/spi/spi.h>\n#include <linux/iio/iio.h>\n\n#include <linux/iio/common/st_sensors.h>\n#include <linux/iio/common/st_sensors_spi.h>\n#include \"st_pressure.h\"\n\n \nstatic const struct of_device_id st_press_of_match[] = {\n\t{\n\t\t.compatible = \"st,lps001wp-press\",\n\t\t.data = LPS001WP_PRESS_DEV_NAME,\n\t},\n\t{\n\t\t.compatible = \"st,lps25h-press\",\n\t\t.data = LPS25H_PRESS_DEV_NAME,\n\t},\n\t{\n\t\t.compatible = \"st,lps331ap-press\",\n\t\t.data = LPS331AP_PRESS_DEV_NAME,\n\t},\n\t{\n\t\t.compatible = \"st,lps22hb-press\",\n\t\t.data = LPS22HB_PRESS_DEV_NAME,\n\t},\n\t{\n\t\t.compatible = \"st,lps33hw\",\n\t\t.data = LPS33HW_PRESS_DEV_NAME,\n\t},\n\t{\n\t\t.compatible = \"st,lps35hw\",\n\t\t.data = LPS35HW_PRESS_DEV_NAME,\n\t},\n\t{\n\t\t.compatible = \"st,lps22hh\",\n\t\t.data = LPS22HH_PRESS_DEV_NAME,\n\t},\n\t{\n\t\t.compatible = \"st,lps22df\",\n\t\t.data = LPS22DF_PRESS_DEV_NAME,\n\t},\n\t{},\n};\nMODULE_DEVICE_TABLE(of, st_press_of_match);\n\nstatic int st_press_spi_probe(struct spi_device *spi)\n{\n\tconst struct st_sensor_settings *settings;\n\tstruct st_sensor_data *press_data;\n\tstruct iio_dev *indio_dev;\n\tint err;\n\n\tst_sensors_dev_name_probe(&spi->dev, spi->modalias, sizeof(spi->modalias));\n\n\tsettings = st_press_get_settings(spi->modalias);\n\tif (!settings) {\n\t\tdev_err(&spi->dev, \"device name %s not recognized.\\n\",\n\t\t\tspi->modalias);\n\t\treturn -ENODEV;\n\t}\n\n\tindio_dev = devm_iio_device_alloc(&spi->dev, sizeof(*press_data));\n\tif (!indio_dev)\n\t\treturn -ENOMEM;\n\n\tpress_data = iio_priv(indio_dev);\n\tpress_data->sensor_settings = (struct st_sensor_settings *)settings;\n\n\terr = st_sensors_spi_configure(indio_dev, spi);\n\tif (err < 0)\n\t\treturn err;\n\n\terr = st_sensors_power_enable(indio_dev);\n\tif (err)\n\t\treturn err;\n\n\treturn st_press_common_probe(indio_dev);\n}\n\nstatic const struct spi_device_id st_press_id_table[] = {\n\t{ LPS001WP_PRESS_DEV_NAME },\n\t{ LPS25H_PRESS_DEV_NAME },\n\t{ LPS331AP_PRESS_DEV_NAME },\n\t{ LPS22HB_PRESS_DEV_NAME },\n\t{ LPS33HW_PRESS_DEV_NAME },\n\t{ LPS35HW_PRESS_DEV_NAME },\n\t{ LPS22HH_PRESS_DEV_NAME },\n\t{ LPS22DF_PRESS_DEV_NAME },\n\t{ \"lps001wp-press\" },\n\t{ \"lps25h-press\", },\n\t{ \"lps331ap-press\" },\n\t{ \"lps22hb-press\" },\n\t{},\n};\nMODULE_DEVICE_TABLE(spi, st_press_id_table);\n\nstatic struct spi_driver st_press_driver = {\n\t.driver = {\n\t\t.name = \"st-press-spi\",\n\t\t.of_match_table = st_press_of_match,\n\t},\n\t.probe = st_press_spi_probe,\n\t.id_table = st_press_id_table,\n};\nmodule_spi_driver(st_press_driver);\n\nMODULE_AUTHOR(\"Denis Ciocca <denis.ciocca@st.com>\");\nMODULE_DESCRIPTION(\"STMicroelectronics pressures spi driver\");\nMODULE_LICENSE(\"GPL v2\");\nMODULE_IMPORT_NS(IIO_ST_SENSORS);\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}