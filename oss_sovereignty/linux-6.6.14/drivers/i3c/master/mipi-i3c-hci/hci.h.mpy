{
  "module_name": "hci.h",
  "hash_id": "d0c6456ae2999bf6562f3a51e6e904f113a9c024769b8e06b32526f4aca3a7e3",
  "original_prompt": "Ingested from linux-6.6.14/drivers/i3c/master/mipi-i3c-hci/hci.h",
  "human_readable_source": " \n \n\n#ifndef HCI_H\n#define HCI_H\n\n\n \n#define DBG(x, ...) pr_devel(\"%s: \" x \"\\n\", __func__, ##__VA_ARGS__)\n\n \n#define W0_MASK(h, l)  GENMASK((h) - 0,  (l) - 0)\n#define W1_MASK(h, l)  GENMASK((h) - 32, (l) - 32)\n#define W2_MASK(h, l)  GENMASK((h) - 64, (l) - 64)\n#define W3_MASK(h, l)  GENMASK((h) - 96, (l) - 96)\n\n \n#define W0_BIT_(x)  BIT((x) - 0)\n#define W1_BIT_(x)  BIT((x) - 32)\n#define W2_BIT_(x)  BIT((x) - 64)\n#define W3_BIT_(x)  BIT((x) - 96)\n\n\nstruct hci_cmd_ops;\n\n \nstruct i3c_hci {\n\tstruct i3c_master_controller master;\n\tvoid __iomem *base_regs;\n\tvoid __iomem *DAT_regs;\n\tvoid __iomem *DCT_regs;\n\tvoid __iomem *RHS_regs;\n\tvoid __iomem *PIO_regs;\n\tvoid __iomem *EXTCAPS_regs;\n\tvoid __iomem *AUTOCMD_regs;\n\tvoid __iomem *DEBUG_regs;\n\tconst struct hci_io_ops *io;\n\tvoid *io_data;\n\tconst struct hci_cmd_ops *cmd;\n\tatomic_t next_cmd_tid;\n\tu32 caps;\n\tunsigned int quirks;\n\tunsigned int DAT_entries;\n\tunsigned int DAT_entry_size;\n\tvoid *DAT_data;\n\tunsigned int DCT_entries;\n\tunsigned int DCT_entry_size;\n\tu8 version_major;\n\tu8 version_minor;\n\tu8 revision;\n\tu32 vendor_mipi_id;\n\tu32 vendor_version_id;\n\tu32 vendor_product_id;\n\tvoid *vendor_data;\n};\n\n\n \nstruct hci_xfer {\n\tu32 cmd_desc[4];\n\tu32 response;\n\tbool rnw;\n\tvoid *data;\n\tunsigned int data_len;\n\tunsigned int cmd_tid;\n\tstruct completion *completion;\n\tunion {\n\t\tstruct {\n\t\t\t \n\t\t\tstruct hci_xfer *next_xfer;\n\t\t\tstruct hci_xfer *next_data;\n\t\t\tstruct hci_xfer *next_resp;\n\t\t\tunsigned int data_left;\n\t\t\tu32 data_word_before_partial;\n\t\t};\n\t\tstruct {\n\t\t\t \n\t\t\tdma_addr_t data_dma;\n\t\t\tint ring_number;\n\t\t\tint ring_entry;\n\t\t};\n\t};\n};\n\nstatic inline struct hci_xfer *hci_alloc_xfer(unsigned int n)\n{\n\treturn kcalloc(n, sizeof(struct hci_xfer), GFP_KERNEL);\n}\n\nstatic inline void hci_free_xfer(struct hci_xfer *xfer, unsigned int n)\n{\n\tkfree(xfer);\n}\n\n\n \nstruct hci_io_ops {\n\tbool (*irq_handler)(struct i3c_hci *hci, unsigned int mask);\n\tint (*queue_xfer)(struct i3c_hci *hci, struct hci_xfer *xfer, int n);\n\tbool (*dequeue_xfer)(struct i3c_hci *hci, struct hci_xfer *xfer, int n);\n\tint (*request_ibi)(struct i3c_hci *hci, struct i3c_dev_desc *dev,\n\t\t\t   const struct i3c_ibi_setup *req);\n\tvoid (*free_ibi)(struct i3c_hci *hci, struct i3c_dev_desc *dev);\n\tvoid (*recycle_ibi_slot)(struct i3c_hci *hci, struct i3c_dev_desc *dev,\n\t\t\t\tstruct i3c_ibi_slot *slot);\n\tint (*init)(struct i3c_hci *hci);\n\tvoid (*cleanup)(struct i3c_hci *hci);\n};\n\nextern const struct hci_io_ops mipi_i3c_hci_pio;\nextern const struct hci_io_ops mipi_i3c_hci_dma;\n\n\n \nstruct i3c_hci_dev_data {\n\tint dat_idx;\n\tvoid *ibi_data;\n};\n\n\n \n#define HCI_QUIRK_RAW_CCC\tBIT(1)\t \n\n\n \nvoid mipi_i3c_hci_resume(struct i3c_hci *hci);\nvoid mipi_i3c_hci_pio_reset(struct i3c_hci *hci);\nvoid mipi_i3c_hci_dct_index_reset(struct i3c_hci *hci);\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}