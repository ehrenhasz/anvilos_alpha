{
  "module_name": "i2c-pasemi-pci.c",
  "hash_id": "9b0c9f73720fa9975799bce048f6aa28cdf2c3d403f8f3bb9e20d91b9e714e88",
  "original_prompt": "Ingested from linux-6.6.14/drivers/i2c/busses/i2c-pasemi-pci.c",
  "human_readable_source": "\n \n\n#include <linux/module.h>\n#include <linux/pci.h>\n#include <linux/kernel.h>\n#include <linux/stddef.h>\n#include <linux/sched.h>\n#include <linux/i2c.h>\n#include <linux/delay.h>\n#include <linux/slab.h>\n#include <linux/io.h>\n\n#include \"i2c-pasemi-core.h\"\n\n#define CLK_100K_DIV\t84\n#define CLK_400K_DIV\t21\n\nstatic struct pci_driver pasemi_smb_pci_driver;\n\nstatic int pasemi_smb_pci_probe(struct pci_dev *dev,\n\t\t\t\t      const struct pci_device_id *id)\n{\n\tstruct pasemi_smbus *smbus;\n\tunsigned long base;\n\tint size;\n\tint error;\n\n\tif (!(pci_resource_flags(dev, 0) & IORESOURCE_IO))\n\t\treturn -ENODEV;\n\n\tsmbus = devm_kzalloc(&dev->dev, sizeof(*smbus), GFP_KERNEL);\n\tif (!smbus)\n\t\treturn -ENOMEM;\n\n\tsmbus->dev = &dev->dev;\n\tbase = pci_resource_start(dev, 0);\n\tsize = pci_resource_len(dev, 0);\n\tsmbus->clk_div = CLK_100K_DIV;\n\n\t \n\tsmbus->hw_rev = PASEMI_HW_REV_PCI;\n\n\tif (!devm_request_region(&dev->dev, base, size,\n\t\t\t    pasemi_smb_pci_driver.name))\n\t\treturn -EBUSY;\n\n\tsmbus->ioaddr = pcim_iomap(dev, 0, 0);\n\tif (!smbus->ioaddr)\n\t\treturn -EBUSY;\n\n\tsmbus->adapter.class = I2C_CLASS_HWMON | I2C_CLASS_SPD;\n\terror = pasemi_i2c_common_probe(smbus);\n\tif (error)\n\t\treturn error;\n\n\tpci_set_drvdata(dev, smbus);\n\n\treturn 0;\n}\n\nstatic const struct pci_device_id pasemi_smb_pci_ids[] = {\n\t{ PCI_DEVICE(0x1959, 0xa003) },\n\t{ 0, }\n};\n\nMODULE_DEVICE_TABLE(pci, pasemi_smb_pci_ids);\n\nstatic struct pci_driver pasemi_smb_pci_driver = {\n\t.name\t\t= \"i2c-pasemi\",\n\t.id_table\t= pasemi_smb_pci_ids,\n\t.probe\t\t= pasemi_smb_pci_probe,\n};\n\nmodule_pci_driver(pasemi_smb_pci_driver);\n\nMODULE_LICENSE(\"GPL\");\nMODULE_AUTHOR(\"Olof Johansson <olof@lixom.net>\");\nMODULE_DESCRIPTION(\"PA Semi PWRficient SMBus driver\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}