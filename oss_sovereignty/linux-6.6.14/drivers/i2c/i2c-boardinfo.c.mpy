{
  "module_name": "i2c-boardinfo.c",
  "hash_id": "d39b174beff1708e06e315c695099251af87deedbf9904812cc190ea90d2d580",
  "original_prompt": "Ingested from linux-6.6.14/drivers/i2c/i2c-boardinfo.c",
  "human_readable_source": "\n \n\n#include <linux/export.h>\n#include <linux/i2c.h>\n#include <linux/kernel.h>\n#include <linux/property.h>\n#include <linux/rwsem.h>\n#include <linux/slab.h>\n\n#include \"i2c-core.h\"\n\n\n \nDECLARE_RWSEM(__i2c_board_lock);\nEXPORT_SYMBOL_GPL(__i2c_board_lock);\n\nLIST_HEAD(__i2c_board_list);\nEXPORT_SYMBOL_GPL(__i2c_board_list);\n\nint __i2c_first_dynamic_bus_num;\nEXPORT_SYMBOL_GPL(__i2c_first_dynamic_bus_num);\n\n\n \nint i2c_register_board_info(int busnum, struct i2c_board_info const *info, unsigned len)\n{\n\tint status;\n\n\tdown_write(&__i2c_board_lock);\n\n\t \n\tif (busnum >= __i2c_first_dynamic_bus_num)\n\t\t__i2c_first_dynamic_bus_num = busnum + 1;\n\n\tfor (status = 0; len; len--, info++) {\n\t\tstruct i2c_devinfo\t*devinfo;\n\n\t\tdevinfo = kzalloc(sizeof(*devinfo), GFP_KERNEL);\n\t\tif (!devinfo) {\n\t\t\tpr_debug(\"i2c-core: can't register boardinfo!\\n\");\n\t\t\tstatus = -ENOMEM;\n\t\t\tbreak;\n\t\t}\n\n\t\tdevinfo->busnum = busnum;\n\t\tdevinfo->board_info = *info;\n\n\t\tif (info->resources) {\n\t\t\tdevinfo->board_info.resources =\n\t\t\t\tkmemdup(info->resources,\n\t\t\t\t\tinfo->num_resources *\n\t\t\t\t\t\tsizeof(*info->resources),\n\t\t\t\t\tGFP_KERNEL);\n\t\t\tif (!devinfo->board_info.resources) {\n\t\t\t\tstatus = -ENOMEM;\n\t\t\t\tkfree(devinfo);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tlist_add_tail(&devinfo->list, &__i2c_board_list);\n\t}\n\n\tup_write(&__i2c_board_lock);\n\n\treturn status;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}