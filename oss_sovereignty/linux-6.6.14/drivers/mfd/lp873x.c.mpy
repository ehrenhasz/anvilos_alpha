{
  "module_name": "lp873x.c",
  "hash_id": "430aa61053230bcfdce383afe03cd48256b5fabe4f68fb401aa7efaef3f4fafe",
  "original_prompt": "Ingested from linux-6.6.14/drivers/mfd/lp873x.c",
  "human_readable_source": "\n \n\n#include <linux/interrupt.h>\n#include <linux/mfd/core.h>\n#include <linux/mod_devicetable.h>\n#include <linux/module.h>\n#include <linux/regmap.h>\n\n#include <linux/mfd/lp873x.h>\n\nstatic const struct regmap_config lp873x_regmap_config = {\n\t.reg_bits = 8,\n\t.val_bits = 8,\n\t.max_register = LP873X_REG_MAX,\n};\n\nstatic const struct mfd_cell lp873x_cells[] = {\n\t{ .name = \"lp873x-regulator\", },\n\t{ .name = \"lp873x-gpio\", },\n};\n\nstatic int lp873x_probe(struct i2c_client *client)\n{\n\tstruct lp873x *lp873;\n\tint ret;\n\tunsigned int otpid;\n\n\tlp873 = devm_kzalloc(&client->dev, sizeof(*lp873), GFP_KERNEL);\n\tif (!lp873)\n\t\treturn -ENOMEM;\n\n\tlp873->dev = &client->dev;\n\n\tlp873->regmap = devm_regmap_init_i2c(client, &lp873x_regmap_config);\n\tif (IS_ERR(lp873->regmap)) {\n\t\tret = PTR_ERR(lp873->regmap);\n\t\tdev_err(lp873->dev,\n\t\t\t\"Failed to initialize register map: %d\\n\", ret);\n\t\treturn ret;\n\t}\n\n\tret = regmap_read(lp873->regmap, LP873X_REG_OTP_REV, &otpid);\n\tif (ret) {\n\t\tdev_err(lp873->dev, \"Failed to read OTP ID\\n\");\n\t\treturn ret;\n\t}\n\n\tlp873->rev = otpid & LP873X_OTP_REV_OTP_ID;\n\n\ti2c_set_clientdata(client, lp873);\n\n\tret = mfd_add_devices(lp873->dev, PLATFORM_DEVID_AUTO, lp873x_cells,\n\t\t\t      ARRAY_SIZE(lp873x_cells), NULL, 0, NULL);\n\n\treturn ret;\n}\n\nstatic const struct of_device_id of_lp873x_match_table[] = {\n\t{ .compatible = \"ti,lp8733\", },\n\t{ .compatible = \"ti,lp8732\", },\n\t{}\n};\nMODULE_DEVICE_TABLE(of, of_lp873x_match_table);\n\nstatic const struct i2c_device_id lp873x_id_table[] = {\n\t{ \"lp873x\", 0 },\n\t{ },\n};\nMODULE_DEVICE_TABLE(i2c, lp873x_id_table);\n\nstatic struct i2c_driver lp873x_driver = {\n\t.driver\t= {\n\t\t.name\t= \"lp873x\",\n\t\t.of_match_table = of_lp873x_match_table,\n\t},\n\t.probe\t\t= lp873x_probe,\n\t.id_table\t= lp873x_id_table,\n};\nmodule_i2c_driver(lp873x_driver);\n\nMODULE_AUTHOR(\"J Keerthy <j-keerthy@ti.com>\");\nMODULE_DESCRIPTION(\"LP873X chip family Multi-Function Device driver\");\nMODULE_LICENSE(\"GPL v2\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}