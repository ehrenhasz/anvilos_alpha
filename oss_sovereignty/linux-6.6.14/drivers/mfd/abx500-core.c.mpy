{
  "module_name": "abx500-core.c",
  "hash_id": "4e23d0fd07c2b4adb74e22b09a4ef9e06417377d9d1a6d4049ca82632153b5d9",
  "original_prompt": "Ingested from linux-6.6.14/drivers/mfd/abx500-core.c",
  "human_readable_source": "\n \n\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/err.h>\n#include <linux/init.h>\n#include <linux/export.h>\n#include <linux/mfd/abx500.h>\n\nstatic LIST_HEAD(abx500_list);\n\nstruct abx500_device_entry {\n\tstruct list_head list;\n\tstruct abx500_ops ops;\n\tstruct device *dev;\n};\n\nstatic void lookup_ops(struct device *dev, struct abx500_ops **ops)\n{\n\tstruct abx500_device_entry *dev_entry;\n\n\t*ops = NULL;\n\tlist_for_each_entry(dev_entry, &abx500_list, list) {\n\t\tif (dev_entry->dev == dev) {\n\t\t\t*ops = &dev_entry->ops;\n\t\t\treturn;\n\t\t}\n\t}\n}\n\nint abx500_register_ops(struct device *dev, struct abx500_ops *ops)\n{\n\tstruct abx500_device_entry *dev_entry;\n\n\tdev_entry = devm_kzalloc(dev, sizeof(*dev_entry), GFP_KERNEL);\n\tif (!dev_entry)\n\t\treturn -ENOMEM;\n\n\tdev_entry->dev = dev;\n\tmemcpy(&dev_entry->ops, ops, sizeof(*ops));\n\n\tlist_add_tail(&dev_entry->list, &abx500_list);\n\treturn 0;\n}\nEXPORT_SYMBOL(abx500_register_ops);\n\nvoid abx500_remove_ops(struct device *dev)\n{\n\tstruct abx500_device_entry *dev_entry, *tmp;\n\n\tlist_for_each_entry_safe(dev_entry, tmp, &abx500_list, list)\n\t\tif (dev_entry->dev == dev)\n\t\t\tlist_del(&dev_entry->list);\n}\nEXPORT_SYMBOL(abx500_remove_ops);\n\nint abx500_set_register_interruptible(struct device *dev, u8 bank, u8 reg,\n\tu8 value)\n{\n\tstruct abx500_ops *ops;\n\n\tlookup_ops(dev->parent, &ops);\n\tif (ops && ops->set_register)\n\t\treturn ops->set_register(dev, bank, reg, value);\n\telse\n\t\treturn -ENOTSUPP;\n}\nEXPORT_SYMBOL(abx500_set_register_interruptible);\n\nint abx500_get_register_interruptible(struct device *dev, u8 bank, u8 reg,\n\tu8 *value)\n{\n\tstruct abx500_ops *ops;\n\n\tlookup_ops(dev->parent, &ops);\n\tif (ops && ops->get_register)\n\t\treturn ops->get_register(dev, bank, reg, value);\n\telse\n\t\treturn -ENOTSUPP;\n}\nEXPORT_SYMBOL(abx500_get_register_interruptible);\n\nint abx500_get_register_page_interruptible(struct device *dev, u8 bank,\n\tu8 first_reg, u8 *regvals, u8 numregs)\n{\n\tstruct abx500_ops *ops;\n\n\tlookup_ops(dev->parent, &ops);\n\tif (ops && ops->get_register_page)\n\t\treturn ops->get_register_page(dev, bank,\n\t\t\tfirst_reg, regvals, numregs);\n\telse\n\t\treturn -ENOTSUPP;\n}\nEXPORT_SYMBOL(abx500_get_register_page_interruptible);\n\nint abx500_mask_and_set_register_interruptible(struct device *dev, u8 bank,\n\tu8 reg, u8 bitmask, u8 bitvalues)\n{\n\tstruct abx500_ops *ops;\n\n\tlookup_ops(dev->parent, &ops);\n\tif (ops && ops->mask_and_set_register)\n\t\treturn ops->mask_and_set_register(dev, bank,\n\t\t\treg, bitmask, bitvalues);\n\telse\n\t\treturn -ENOTSUPP;\n}\nEXPORT_SYMBOL(abx500_mask_and_set_register_interruptible);\n\nint abx500_get_chip_id(struct device *dev)\n{\n\tstruct abx500_ops *ops;\n\n\tlookup_ops(dev->parent, &ops);\n\tif (ops && ops->get_chip_id)\n\t\treturn ops->get_chip_id(dev);\n\telse\n\t\treturn -ENOTSUPP;\n}\nEXPORT_SYMBOL(abx500_get_chip_id);\n\nint abx500_event_registers_startup_state_get(struct device *dev, u8 *event)\n{\n\tstruct abx500_ops *ops;\n\n\tlookup_ops(dev->parent, &ops);\n\tif (ops && ops->event_registers_startup_state_get)\n\t\treturn ops->event_registers_startup_state_get(dev, event);\n\telse\n\t\treturn -ENOTSUPP;\n}\nEXPORT_SYMBOL(abx500_event_registers_startup_state_get);\n\nint abx500_startup_irq_enabled(struct device *dev, unsigned int irq)\n{\n\tstruct abx500_ops *ops;\n\n\tlookup_ops(dev->parent, &ops);\n\tif (ops && ops->startup_irq_enabled)\n\t\treturn ops->startup_irq_enabled(dev, irq);\n\telse\n\t\treturn -ENOTSUPP;\n}\nEXPORT_SYMBOL(abx500_startup_irq_enabled);\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}