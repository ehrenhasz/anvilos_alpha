{
  "module_name": "tps65912-core.c",
  "hash_id": "6e4dc9a44aa7cc7abac1960d400c35632c7f693682dff419c3de345154c29401",
  "original_prompt": "Ingested from linux-6.6.14/drivers/mfd/tps65912-core.c",
  "human_readable_source": "\n \n\n#include <linux/interrupt.h>\n#include <linux/mfd/core.h>\n#include <linux/module.h>\n\n#include <linux/mfd/tps65912.h>\n\nstatic const struct mfd_cell tps65912_cells[] = {\n\t{ .name = \"tps65912-regulator\", },\n\t{ .name = \"tps65912-gpio\", },\n};\n\nstatic const struct regmap_irq tps65912_irqs[] = {\n\t \n\tREGMAP_IRQ_REG(TPS65912_IRQ_PWRHOLD_F, 0, TPS65912_INT_STS_PWRHOLD_F),\n\tREGMAP_IRQ_REG(TPS65912_IRQ_VMON, 0, TPS65912_INT_STS_VMON),\n\tREGMAP_IRQ_REG(TPS65912_IRQ_PWRON, 0, TPS65912_INT_STS_PWRON),\n\tREGMAP_IRQ_REG(TPS65912_IRQ_PWRON_LP, 0, TPS65912_INT_STS_PWRON_LP),\n\tREGMAP_IRQ_REG(TPS65912_IRQ_PWRHOLD_R, 0, TPS65912_INT_STS_PWRHOLD_R),\n\tREGMAP_IRQ_REG(TPS65912_IRQ_HOTDIE, 0, TPS65912_INT_STS_HOTDIE),\n\tREGMAP_IRQ_REG(TPS65912_IRQ_GPIO1_R, 0, TPS65912_INT_STS_GPIO1_R),\n\tREGMAP_IRQ_REG(TPS65912_IRQ_GPIO1_F, 0, TPS65912_INT_STS_GPIO1_F),\n\t \n\tREGMAP_IRQ_REG(TPS65912_IRQ_GPIO2_R, 1, TPS65912_INT_STS2_GPIO2_R),\n\tREGMAP_IRQ_REG(TPS65912_IRQ_GPIO2_F, 1, TPS65912_INT_STS2_GPIO2_F),\n\tREGMAP_IRQ_REG(TPS65912_IRQ_GPIO3_R, 1, TPS65912_INT_STS2_GPIO3_R),\n\tREGMAP_IRQ_REG(TPS65912_IRQ_GPIO3_F, 1, TPS65912_INT_STS2_GPIO3_F),\n\tREGMAP_IRQ_REG(TPS65912_IRQ_GPIO4_R, 1, TPS65912_INT_STS2_GPIO4_R),\n\tREGMAP_IRQ_REG(TPS65912_IRQ_GPIO4_F, 1, TPS65912_INT_STS2_GPIO4_F),\n\tREGMAP_IRQ_REG(TPS65912_IRQ_GPIO5_R, 1, TPS65912_INT_STS2_GPIO5_R),\n\tREGMAP_IRQ_REG(TPS65912_IRQ_GPIO5_F, 1, TPS65912_INT_STS2_GPIO5_F),\n\t \n\tREGMAP_IRQ_REG(TPS65912_IRQ_PGOOD_DCDC1, 2, TPS65912_INT_STS3_PGOOD_DCDC1),\n\tREGMAP_IRQ_REG(TPS65912_IRQ_PGOOD_DCDC2, 2, TPS65912_INT_STS3_PGOOD_DCDC2),\n\tREGMAP_IRQ_REG(TPS65912_IRQ_PGOOD_DCDC3, 2, TPS65912_INT_STS3_PGOOD_DCDC3),\n\tREGMAP_IRQ_REG(TPS65912_IRQ_PGOOD_DCDC4, 2, TPS65912_INT_STS3_PGOOD_DCDC4),\n\tREGMAP_IRQ_REG(TPS65912_IRQ_PGOOD_LDO1, 2, TPS65912_INT_STS3_PGOOD_LDO1),\n\tREGMAP_IRQ_REG(TPS65912_IRQ_PGOOD_LDO2, 2, TPS65912_INT_STS3_PGOOD_LDO2),\n\tREGMAP_IRQ_REG(TPS65912_IRQ_PGOOD_LDO3, 2, TPS65912_INT_STS3_PGOOD_LDO3),\n\tREGMAP_IRQ_REG(TPS65912_IRQ_PGOOD_LDO4, 2, TPS65912_INT_STS3_PGOOD_LDO4),\n\t \n\tREGMAP_IRQ_REG(TPS65912_IRQ_PGOOD_LDO5, 3, TPS65912_INT_STS4_PGOOD_LDO5),\n\tREGMAP_IRQ_REG(TPS65912_IRQ_PGOOD_LDO6, 3, TPS65912_INT_STS4_PGOOD_LDO6),\n\tREGMAP_IRQ_REG(TPS65912_IRQ_PGOOD_LDO7, 3, TPS65912_INT_STS4_PGOOD_LDO7),\n\tREGMAP_IRQ_REG(TPS65912_IRQ_PGOOD_LDO8, 3, TPS65912_INT_STS4_PGOOD_LDO8),\n\tREGMAP_IRQ_REG(TPS65912_IRQ_PGOOD_LDO9, 3, TPS65912_INT_STS4_PGOOD_LDO9),\n\tREGMAP_IRQ_REG(TPS65912_IRQ_PGOOD_LDO10, 3, TPS65912_INT_STS4_PGOOD_LDO10),\n};\n\nstatic struct regmap_irq_chip tps65912_irq_chip = {\n\t.name = \"tps65912\",\n\t.irqs = tps65912_irqs,\n\t.num_irqs = ARRAY_SIZE(tps65912_irqs),\n\t.num_regs = 4,\n\t.irq_reg_stride = 2,\n\t.mask_base = TPS65912_INT_MSK,\n\t.status_base = TPS65912_INT_STS,\n\t.ack_base = TPS65912_INT_STS,\n\t.init_ack_masked = true,\n};\n\nstatic const struct regmap_range tps65912_yes_ranges[] = {\n\tregmap_reg_range(TPS65912_INT_STS, TPS65912_GPIO5),\n};\n\nstatic const struct regmap_access_table tps65912_volatile_table = {\n\t.yes_ranges = tps65912_yes_ranges,\n\t.n_yes_ranges = ARRAY_SIZE(tps65912_yes_ranges),\n};\n\nconst struct regmap_config tps65912_regmap_config = {\n\t.reg_bits = 8,\n\t.val_bits = 8,\n\t.cache_type = REGCACHE_RBTREE,\n\t.volatile_table = &tps65912_volatile_table,\n};\nEXPORT_SYMBOL_GPL(tps65912_regmap_config);\n\nint tps65912_device_init(struct tps65912 *tps)\n{\n\tint ret;\n\n\tret = regmap_add_irq_chip(tps->regmap, tps->irq, IRQF_ONESHOT, 0,\n\t\t\t\t  &tps65912_irq_chip, &tps->irq_data);\n\tif (ret)\n\t\treturn ret;\n\n\tret = mfd_add_devices(tps->dev, PLATFORM_DEVID_AUTO, tps65912_cells,\n\t\t\t      ARRAY_SIZE(tps65912_cells), NULL, 0,\n\t\t\t      regmap_irq_get_domain(tps->irq_data));\n\tif (ret) {\n\t\tregmap_del_irq_chip(tps->irq, tps->irq_data);\n\t\treturn ret;\n\t}\n\n\treturn 0;\n}\nEXPORT_SYMBOL_GPL(tps65912_device_init);\n\nvoid tps65912_device_exit(struct tps65912 *tps)\n{\n\tregmap_del_irq_chip(tps->irq, tps->irq_data);\n}\nEXPORT_SYMBOL_GPL(tps65912_device_exit);\n\nMODULE_AUTHOR(\"Andrew F. Davis <afd@ti.com>\");\nMODULE_DESCRIPTION(\"TPS65912x MFD Driver\");\nMODULE_LICENSE(\"GPL v2\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}