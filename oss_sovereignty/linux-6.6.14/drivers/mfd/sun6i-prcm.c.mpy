{
  "module_name": "sun6i-prcm.c",
  "hash_id": "3fd589ac5d7b85b00989df81e6a37b57f3d4085d0e781d6eaa195bd0d78bd6d7",
  "original_prompt": "Ingested from linux-6.6.14/drivers/mfd/sun6i-prcm.c",
  "human_readable_source": "\n \n\n#include <linux/mfd/core.h>\n#include <linux/init.h>\n#include <linux/of.h>\n\n#define SUN8I_CODEC_ANALOG_BASE\t0x1c0\n#define SUN8I_CODEC_ANALOG_SIZE\t0x4\n\nstruct prcm_data {\n\tint nsubdevs;\n\tconst struct mfd_cell *subdevs;\n};\n\nstatic const struct resource sun6i_a31_ar100_clk_res[] = {\n\tDEFINE_RES_MEM(0x0, 4)\n};\n\nstatic const struct resource sun6i_a31_apb0_clk_res[] = {\n\tDEFINE_RES_MEM(0xc, 4)\n};\n\nstatic const struct resource sun6i_a31_apb0_gates_clk_res[] = {\n\tDEFINE_RES_MEM(0x28, 4)\n};\n\nstatic const struct resource sun6i_a31_ir_clk_res[] = {\n\tDEFINE_RES_MEM(0x54, 4)\n};\n\nstatic const struct resource sun6i_a31_apb0_rstc_res[] = {\n\tDEFINE_RES_MEM(0xb0, 4)\n};\n\nstatic const struct resource sun8i_codec_analog_res[] = {\n\tDEFINE_RES_MEM(SUN8I_CODEC_ANALOG_BASE, SUN8I_CODEC_ANALOG_SIZE),\n};\n\nstatic const struct mfd_cell sun6i_a31_prcm_subdevs[] = {\n\t{\n\t\t.name = \"sun6i-a31-ar100-clk\",\n\t\t.of_compatible = \"allwinner,sun6i-a31-ar100-clk\",\n\t\t.num_resources = ARRAY_SIZE(sun6i_a31_ar100_clk_res),\n\t\t.resources = sun6i_a31_ar100_clk_res,\n\t},\n\t{\n\t\t.name = \"sun6i-a31-apb0-clk\",\n\t\t.of_compatible = \"allwinner,sun6i-a31-apb0-clk\",\n\t\t.num_resources = ARRAY_SIZE(sun6i_a31_apb0_clk_res),\n\t\t.resources = sun6i_a31_apb0_clk_res,\n\t},\n\t{\n\t\t.name = \"sun6i-a31-apb0-gates-clk\",\n\t\t.of_compatible = \"allwinner,sun6i-a31-apb0-gates-clk\",\n\t\t.num_resources = ARRAY_SIZE(sun6i_a31_apb0_gates_clk_res),\n\t\t.resources = sun6i_a31_apb0_gates_clk_res,\n\t},\n\t{\n\t\t.name = \"sun6i-a31-ir-clk\",\n\t\t.of_compatible = \"allwinner,sun4i-a10-mod0-clk\",\n\t\t.num_resources = ARRAY_SIZE(sun6i_a31_ir_clk_res),\n\t\t.resources = sun6i_a31_ir_clk_res,\n\t},\n\t{\n\t\t.name = \"sun6i-a31-apb0-clock-reset\",\n\t\t.of_compatible = \"allwinner,sun6i-a31-clock-reset\",\n\t\t.num_resources = ARRAY_SIZE(sun6i_a31_apb0_rstc_res),\n\t\t.resources = sun6i_a31_apb0_rstc_res,\n\t},\n};\n\nstatic const struct mfd_cell sun8i_a23_prcm_subdevs[] = {\n\t{\n\t\t.name = \"sun8i-a23-apb0-clk\",\n\t\t.of_compatible = \"allwinner,sun8i-a23-apb0-clk\",\n\t\t.num_resources = ARRAY_SIZE(sun6i_a31_apb0_clk_res),\n\t\t.resources = sun6i_a31_apb0_clk_res,\n\t},\n\t{\n\t\t.name = \"sun6i-a31-apb0-gates-clk\",\n\t\t.of_compatible = \"allwinner,sun8i-a23-apb0-gates-clk\",\n\t\t.num_resources = ARRAY_SIZE(sun6i_a31_apb0_gates_clk_res),\n\t\t.resources = sun6i_a31_apb0_gates_clk_res,\n\t},\n\t{\n\t\t.name = \"sun6i-a31-apb0-clock-reset\",\n\t\t.of_compatible = \"allwinner,sun6i-a31-clock-reset\",\n\t\t.num_resources = ARRAY_SIZE(sun6i_a31_apb0_rstc_res),\n\t\t.resources = sun6i_a31_apb0_rstc_res,\n\t},\n\t{\n\t\t.name\t\t= \"sun8i-codec-analog\",\n\t\t.of_compatible\t= \"allwinner,sun8i-a23-codec-analog\",\n\t\t.num_resources\t= ARRAY_SIZE(sun8i_codec_analog_res),\n\t\t.resources\t= sun8i_codec_analog_res,\n\t},\n};\n\nstatic const struct prcm_data sun6i_a31_prcm_data = {\n\t.nsubdevs = ARRAY_SIZE(sun6i_a31_prcm_subdevs),\n\t.subdevs = sun6i_a31_prcm_subdevs,\n};\n\nstatic const struct prcm_data sun8i_a23_prcm_data = {\n\t.nsubdevs = ARRAY_SIZE(sun8i_a23_prcm_subdevs),\n\t.subdevs = sun8i_a23_prcm_subdevs,\n};\n\nstatic const struct of_device_id sun6i_prcm_dt_ids[] = {\n\t{\n\t\t.compatible = \"allwinner,sun6i-a31-prcm\",\n\t\t.data = &sun6i_a31_prcm_data,\n\t},\n\t{\n\t\t.compatible = \"allwinner,sun8i-a23-prcm\",\n\t\t.data = &sun8i_a23_prcm_data,\n\t},\n\t{   },\n};\n\nstatic int sun6i_prcm_probe(struct platform_device *pdev)\n{\n\tconst struct of_device_id *match;\n\tconst struct prcm_data *data;\n\tstruct resource *res;\n\tint ret;\n\n\tmatch = of_match_node(sun6i_prcm_dt_ids, pdev->dev.of_node);\n\tif (!match)\n\t\treturn -EINVAL;\n\n\tdata = match->data;\n\n\tres = platform_get_resource(pdev, IORESOURCE_MEM, 0);\n\tif (!res) {\n\t\tdev_err(&pdev->dev, \"no prcm memory region provided\\n\");\n\t\treturn -ENOENT;\n\t}\n\n\tret = mfd_add_devices(&pdev->dev, 0, data->subdevs, data->nsubdevs,\n\t\t\t      res, -1, NULL);\n\tif (ret) {\n\t\tdev_err(&pdev->dev, \"failed to add subdevices\\n\");\n\t\treturn ret;\n\t}\n\n\treturn 0;\n}\n\nstatic struct platform_driver sun6i_prcm_driver = {\n\t.driver = {\n\t\t.name = \"sun6i-prcm\",\n\t\t.of_match_table = sun6i_prcm_dt_ids,\n\t},\n\t.probe = sun6i_prcm_probe,\n};\nbuiltin_platform_driver(sun6i_prcm_driver);\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}