{
  "module_name": "da9052-core.c",
  "hash_id": "9ed5eff446db13085989c83c0c64151aef33117ee63b6c61e0030861aeb00a68",
  "original_prompt": "Ingested from linux-6.6.14/drivers/mfd/da9052-core.c",
  "human_readable_source": "\n \n\n#include <linux/device.h>\n#include <linux/delay.h>\n#include <linux/input.h>\n#include <linux/interrupt.h>\n#include <linux/mfd/core.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/property.h>\n\n#include <linux/mfd/da9052/da9052.h>\n#include <linux/mfd/da9052/pdata.h>\n#include <linux/mfd/da9052/reg.h>\n\nstatic bool da9052_reg_readable(struct device *dev, unsigned int reg)\n{\n\tswitch (reg) {\n\tcase DA9052_PAGE0_CON_REG:\n\tcase DA9052_STATUS_A_REG:\n\tcase DA9052_STATUS_B_REG:\n\tcase DA9052_STATUS_C_REG:\n\tcase DA9052_STATUS_D_REG:\n\tcase DA9052_EVENT_A_REG:\n\tcase DA9052_EVENT_B_REG:\n\tcase DA9052_EVENT_C_REG:\n\tcase DA9052_EVENT_D_REG:\n\tcase DA9052_FAULTLOG_REG:\n\tcase DA9052_IRQ_MASK_A_REG:\n\tcase DA9052_IRQ_MASK_B_REG:\n\tcase DA9052_IRQ_MASK_C_REG:\n\tcase DA9052_IRQ_MASK_D_REG:\n\tcase DA9052_CONTROL_A_REG:\n\tcase DA9052_CONTROL_B_REG:\n\tcase DA9052_CONTROL_C_REG:\n\tcase DA9052_CONTROL_D_REG:\n\tcase DA9052_PDDIS_REG:\n\tcase DA9052_INTERFACE_REG:\n\tcase DA9052_RESET_REG:\n\tcase DA9052_GPIO_0_1_REG:\n\tcase DA9052_GPIO_2_3_REG:\n\tcase DA9052_GPIO_4_5_REG:\n\tcase DA9052_GPIO_6_7_REG:\n\tcase DA9052_GPIO_8_9_REG:\n\tcase DA9052_GPIO_10_11_REG:\n\tcase DA9052_GPIO_12_13_REG:\n\tcase DA9052_GPIO_14_15_REG:\n\tcase DA9052_ID_0_1_REG:\n\tcase DA9052_ID_2_3_REG:\n\tcase DA9052_ID_4_5_REG:\n\tcase DA9052_ID_6_7_REG:\n\tcase DA9052_ID_8_9_REG:\n\tcase DA9052_ID_10_11_REG:\n\tcase DA9052_ID_12_13_REG:\n\tcase DA9052_ID_14_15_REG:\n\tcase DA9052_ID_16_17_REG:\n\tcase DA9052_ID_18_19_REG:\n\tcase DA9052_ID_20_21_REG:\n\tcase DA9052_SEQ_STATUS_REG:\n\tcase DA9052_SEQ_A_REG:\n\tcase DA9052_SEQ_B_REG:\n\tcase DA9052_SEQ_TIMER_REG:\n\tcase DA9052_BUCKA_REG:\n\tcase DA9052_BUCKB_REG:\n\tcase DA9052_BUCKCORE_REG:\n\tcase DA9052_BUCKPRO_REG:\n\tcase DA9052_BUCKMEM_REG:\n\tcase DA9052_BUCKPERI_REG:\n\tcase DA9052_LDO1_REG:\n\tcase DA9052_LDO2_REG:\n\tcase DA9052_LDO3_REG:\n\tcase DA9052_LDO4_REG:\n\tcase DA9052_LDO5_REG:\n\tcase DA9052_LDO6_REG:\n\tcase DA9052_LDO7_REG:\n\tcase DA9052_LDO8_REG:\n\tcase DA9052_LDO9_REG:\n\tcase DA9052_LDO10_REG:\n\tcase DA9052_SUPPLY_REG:\n\tcase DA9052_PULLDOWN_REG:\n\tcase DA9052_CHGBUCK_REG:\n\tcase DA9052_WAITCONT_REG:\n\tcase DA9052_ISET_REG:\n\tcase DA9052_BATCHG_REG:\n\tcase DA9052_CHG_CONT_REG:\n\tcase DA9052_INPUT_CONT_REG:\n\tcase DA9052_CHG_TIME_REG:\n\tcase DA9052_BBAT_CONT_REG:\n\tcase DA9052_BOOST_REG:\n\tcase DA9052_LED_CONT_REG:\n\tcase DA9052_LEDMIN123_REG:\n\tcase DA9052_LED1_CONF_REG:\n\tcase DA9052_LED2_CONF_REG:\n\tcase DA9052_LED3_CONF_REG:\n\tcase DA9052_LED1CONT_REG:\n\tcase DA9052_LED2CONT_REG:\n\tcase DA9052_LED3CONT_REG:\n\tcase DA9052_LED_CONT_4_REG:\n\tcase DA9052_LED_CONT_5_REG:\n\tcase DA9052_ADC_MAN_REG:\n\tcase DA9052_ADC_CONT_REG:\n\tcase DA9052_ADC_RES_L_REG:\n\tcase DA9052_ADC_RES_H_REG:\n\tcase DA9052_VDD_RES_REG:\n\tcase DA9052_VDD_MON_REG:\n\tcase DA9052_ICHG_AV_REG:\n\tcase DA9052_ICHG_THD_REG:\n\tcase DA9052_ICHG_END_REG:\n\tcase DA9052_TBAT_RES_REG:\n\tcase DA9052_TBAT_HIGHP_REG:\n\tcase DA9052_TBAT_HIGHN_REG:\n\tcase DA9052_TBAT_LOW_REG:\n\tcase DA9052_T_OFFSET_REG:\n\tcase DA9052_ADCIN4_RES_REG:\n\tcase DA9052_AUTO4_HIGH_REG:\n\tcase DA9052_AUTO4_LOW_REG:\n\tcase DA9052_ADCIN5_RES_REG:\n\tcase DA9052_AUTO5_HIGH_REG:\n\tcase DA9052_AUTO5_LOW_REG:\n\tcase DA9052_ADCIN6_RES_REG:\n\tcase DA9052_AUTO6_HIGH_REG:\n\tcase DA9052_AUTO6_LOW_REG:\n\tcase DA9052_TJUNC_RES_REG:\n\tcase DA9052_TSI_CONT_A_REG:\n\tcase DA9052_TSI_CONT_B_REG:\n\tcase DA9052_TSI_X_MSB_REG:\n\tcase DA9052_TSI_Y_MSB_REG:\n\tcase DA9052_TSI_LSB_REG:\n\tcase DA9052_TSI_Z_MSB_REG:\n\tcase DA9052_COUNT_S_REG:\n\tcase DA9052_COUNT_MI_REG:\n\tcase DA9052_COUNT_H_REG:\n\tcase DA9052_COUNT_D_REG:\n\tcase DA9052_COUNT_MO_REG:\n\tcase DA9052_COUNT_Y_REG:\n\tcase DA9052_ALARM_MI_REG:\n\tcase DA9052_ALARM_H_REG:\n\tcase DA9052_ALARM_D_REG:\n\tcase DA9052_ALARM_MO_REG:\n\tcase DA9052_ALARM_Y_REG:\n\tcase DA9052_SECOND_A_REG:\n\tcase DA9052_SECOND_B_REG:\n\tcase DA9052_SECOND_C_REG:\n\tcase DA9052_SECOND_D_REG:\n\tcase DA9052_PAGE1_CON_REG:\n\t\treturn true;\n\tdefault:\n\t\treturn false;\n\t}\n}\n\nstatic bool da9052_reg_writeable(struct device *dev, unsigned int reg)\n{\n\tswitch (reg) {\n\tcase DA9052_PAGE0_CON_REG:\n\tcase DA9052_EVENT_A_REG:\n\tcase DA9052_EVENT_B_REG:\n\tcase DA9052_EVENT_C_REG:\n\tcase DA9052_EVENT_D_REG:\n\tcase DA9052_FAULTLOG_REG:\n\tcase DA9052_IRQ_MASK_A_REG:\n\tcase DA9052_IRQ_MASK_B_REG:\n\tcase DA9052_IRQ_MASK_C_REG:\n\tcase DA9052_IRQ_MASK_D_REG:\n\tcase DA9052_CONTROL_A_REG:\n\tcase DA9052_CONTROL_B_REG:\n\tcase DA9052_CONTROL_C_REG:\n\tcase DA9052_CONTROL_D_REG:\n\tcase DA9052_PDDIS_REG:\n\tcase DA9052_RESET_REG:\n\tcase DA9052_GPIO_0_1_REG:\n\tcase DA9052_GPIO_2_3_REG:\n\tcase DA9052_GPIO_4_5_REG:\n\tcase DA9052_GPIO_6_7_REG:\n\tcase DA9052_GPIO_8_9_REG:\n\tcase DA9052_GPIO_10_11_REG:\n\tcase DA9052_GPIO_12_13_REG:\n\tcase DA9052_GPIO_14_15_REG:\n\tcase DA9052_ID_0_1_REG:\n\tcase DA9052_ID_2_3_REG:\n\tcase DA9052_ID_4_5_REG:\n\tcase DA9052_ID_6_7_REG:\n\tcase DA9052_ID_8_9_REG:\n\tcase DA9052_ID_10_11_REG:\n\tcase DA9052_ID_12_13_REG:\n\tcase DA9052_ID_14_15_REG:\n\tcase DA9052_ID_16_17_REG:\n\tcase DA9052_ID_18_19_REG:\n\tcase DA9052_ID_20_21_REG:\n\tcase DA9052_SEQ_STATUS_REG:\n\tcase DA9052_SEQ_A_REG:\n\tcase DA9052_SEQ_B_REG:\n\tcase DA9052_SEQ_TIMER_REG:\n\tcase DA9052_BUCKA_REG:\n\tcase DA9052_BUCKB_REG:\n\tcase DA9052_BUCKCORE_REG:\n\tcase DA9052_BUCKPRO_REG:\n\tcase DA9052_BUCKMEM_REG:\n\tcase DA9052_BUCKPERI_REG:\n\tcase DA9052_LDO1_REG:\n\tcase DA9052_LDO2_REG:\n\tcase DA9052_LDO3_REG:\n\tcase DA9052_LDO4_REG:\n\tcase DA9052_LDO5_REG:\n\tcase DA9052_LDO6_REG:\n\tcase DA9052_LDO7_REG:\n\tcase DA9052_LDO8_REG:\n\tcase DA9052_LDO9_REG:\n\tcase DA9052_LDO10_REG:\n\tcase DA9052_SUPPLY_REG:\n\tcase DA9052_PULLDOWN_REG:\n\tcase DA9052_CHGBUCK_REG:\n\tcase DA9052_WAITCONT_REG:\n\tcase DA9052_ISET_REG:\n\tcase DA9052_BATCHG_REG:\n\tcase DA9052_CHG_CONT_REG:\n\tcase DA9052_INPUT_CONT_REG:\n\tcase DA9052_BBAT_CONT_REG:\n\tcase DA9052_BOOST_REG:\n\tcase DA9052_LED_CONT_REG:\n\tcase DA9052_LEDMIN123_REG:\n\tcase DA9052_LED1_CONF_REG:\n\tcase DA9052_LED2_CONF_REG:\n\tcase DA9052_LED3_CONF_REG:\n\tcase DA9052_LED1CONT_REG:\n\tcase DA9052_LED2CONT_REG:\n\tcase DA9052_LED3CONT_REG:\n\tcase DA9052_LED_CONT_4_REG:\n\tcase DA9052_LED_CONT_5_REG:\n\tcase DA9052_ADC_MAN_REG:\n\tcase DA9052_ADC_CONT_REG:\n\tcase DA9052_ADC_RES_L_REG:\n\tcase DA9052_ADC_RES_H_REG:\n\tcase DA9052_VDD_RES_REG:\n\tcase DA9052_VDD_MON_REG:\n\tcase DA9052_ICHG_THD_REG:\n\tcase DA9052_ICHG_END_REG:\n\tcase DA9052_TBAT_HIGHP_REG:\n\tcase DA9052_TBAT_HIGHN_REG:\n\tcase DA9052_TBAT_LOW_REG:\n\tcase DA9052_T_OFFSET_REG:\n\tcase DA9052_AUTO4_HIGH_REG:\n\tcase DA9052_AUTO4_LOW_REG:\n\tcase DA9052_AUTO5_HIGH_REG:\n\tcase DA9052_AUTO5_LOW_REG:\n\tcase DA9052_AUTO6_HIGH_REG:\n\tcase DA9052_AUTO6_LOW_REG:\n\tcase DA9052_TSI_CONT_A_REG:\n\tcase DA9052_TSI_CONT_B_REG:\n\tcase DA9052_COUNT_S_REG:\n\tcase DA9052_COUNT_MI_REG:\n\tcase DA9052_COUNT_H_REG:\n\tcase DA9052_COUNT_D_REG:\n\tcase DA9052_COUNT_MO_REG:\n\tcase DA9052_COUNT_Y_REG:\n\tcase DA9052_ALARM_MI_REG:\n\tcase DA9052_ALARM_H_REG:\n\tcase DA9052_ALARM_D_REG:\n\tcase DA9052_ALARM_MO_REG:\n\tcase DA9052_ALARM_Y_REG:\n\tcase DA9052_PAGE1_CON_REG:\n\t\treturn true;\n\tdefault:\n\t\treturn false;\n\t}\n}\n\nstatic bool da9052_reg_volatile(struct device *dev, unsigned int reg)\n{\n\tswitch (reg) {\n\tcase DA9052_STATUS_A_REG:\n\tcase DA9052_STATUS_B_REG:\n\tcase DA9052_STATUS_C_REG:\n\tcase DA9052_STATUS_D_REG:\n\tcase DA9052_EVENT_A_REG:\n\tcase DA9052_EVENT_B_REG:\n\tcase DA9052_EVENT_C_REG:\n\tcase DA9052_EVENT_D_REG:\n\tcase DA9052_CONTROL_B_REG:\n\tcase DA9052_CONTROL_D_REG:\n\tcase DA9052_SUPPLY_REG:\n\tcase DA9052_FAULTLOG_REG:\n\tcase DA9052_CHG_TIME_REG:\n\tcase DA9052_ADC_RES_L_REG:\n\tcase DA9052_ADC_RES_H_REG:\n\tcase DA9052_VDD_RES_REG:\n\tcase DA9052_ICHG_AV_REG:\n\tcase DA9052_TBAT_RES_REG:\n\tcase DA9052_ADCIN4_RES_REG:\n\tcase DA9052_ADCIN5_RES_REG:\n\tcase DA9052_ADCIN6_RES_REG:\n\tcase DA9052_TJUNC_RES_REG:\n\tcase DA9052_TSI_X_MSB_REG:\n\tcase DA9052_TSI_Y_MSB_REG:\n\tcase DA9052_TSI_LSB_REG:\n\tcase DA9052_TSI_Z_MSB_REG:\n\tcase DA9052_COUNT_S_REG:\n\tcase DA9052_COUNT_MI_REG:\n\tcase DA9052_COUNT_H_REG:\n\tcase DA9052_COUNT_D_REG:\n\tcase DA9052_COUNT_MO_REG:\n\tcase DA9052_COUNT_Y_REG:\n\tcase DA9052_ALARM_MI_REG:\n\t\treturn true;\n\tdefault:\n\t\treturn false;\n\t}\n}\n\n \nstatic const int32_t tbat_lookup[255] = {\n\t183258, 144221, 124334, 111336, 101826, 94397, 88343, 83257,\n\t78889, 75071, 71688, 68656, 65914, 63414, 61120, 59001,\n\t570366, 55204, 53490, 51881, 50364, 48931, 47574, 46285,\n\t45059, 43889, 42772, 41703, 40678, 39694, 38748, 37838,\n\t36961, 36115, 35297, 34507, 33743, 33002, 32284, 31588,\n\t30911, 30254, 29615, 28994, 28389, 27799, 27225, 26664,\n\t26117, 25584, 25062, 24553, 24054, 23567, 23091, 22624,\n\t22167, 21719, 21281, 20851, 20429, 20015, 19610, 19211,\n\t18820, 18436, 18058, 17688, 17323, 16965, 16612, 16266,\n\t15925, 15589, 15259, 14933, 14613, 14298, 13987, 13681,\n\t13379, 13082, 12788, 12499, 12214, 11933, 11655, 11382,\n\t11112, 10845, 10582, 10322, 10066, 9812, 9562, 9315,\n\t9071, 8830, 8591, 8356, 8123, 7893, 7665, 7440,\n\t7218, 6998, 6780, 6565, 6352, 6141, 5933, 5726,\n\t5522, 5320, 5120, 4922, 4726, 4532, 4340, 4149,\n\t3961, 3774, 3589, 3406, 3225, 3045, 2867, 2690,\n\t2516, 2342, 2170, 2000, 1831, 1664, 1498, 1334,\n\t1171, 1009, 849, 690, 532, 376, 221, 67,\n\t-84, -236, -386, -535, -683, -830, -975, -1119,\n\t-1263, -1405, -1546, -1686, -1825, -1964, -2101, -2237,\n\t-2372, -2506, -2639, -2771, -2902, -3033, -3162, -3291,\n\t-3418, -3545, -3671, -3796, -3920, -4044, -4166, -4288,\n\t-4409, -4529, -4649, -4767, -4885, -5002, -5119, -5235,\n\t-5349, -5464, -5577, -5690, -5802, -5913, -6024, -6134,\n\t-6244, -6352, -6461, -6568, -6675, -6781, -6887, -6992,\n\t-7096, -7200, -7303, -7406, -7508, -7609, -7710, -7810,\n\t-7910, -8009, -8108, -8206, -8304, -8401, -8497, -8593,\n\t-8689, -8784, -8878, -8972, -9066, -9159, -9251, -9343,\n\t-9435, -9526, -9617, -9707, -9796, -9886, -9975, -10063,\n\t-10151, -10238, -10325, -10412, -10839, -10923, -11007, -11090,\n\t-11173, -11256, -11338, -11420, -11501, -11583, -11663, -11744,\n\t-11823, -11903, -11982\n};\n\nstatic const u8 chan_mux[DA9052_ADC_VBBAT + 1] = {\n\t[DA9052_ADC_VDDOUT]\t= DA9052_ADC_MAN_MUXSEL_VDDOUT,\n\t[DA9052_ADC_ICH]\t= DA9052_ADC_MAN_MUXSEL_ICH,\n\t[DA9052_ADC_TBAT]\t= DA9052_ADC_MAN_MUXSEL_TBAT,\n\t[DA9052_ADC_VBAT]\t= DA9052_ADC_MAN_MUXSEL_VBAT,\n\t[DA9052_ADC_IN4]\t= DA9052_ADC_MAN_MUXSEL_AD4,\n\t[DA9052_ADC_IN5]\t= DA9052_ADC_MAN_MUXSEL_AD5,\n\t[DA9052_ADC_IN6]\t= DA9052_ADC_MAN_MUXSEL_AD6,\n\t[DA9052_ADC_VBBAT]\t= DA9052_ADC_MAN_MUXSEL_VBBAT\n};\n\nint da9052_adc_manual_read(struct da9052 *da9052, unsigned char channel)\n{\n\tint ret;\n\tunsigned short calc_data;\n\tunsigned short data;\n\tunsigned char mux_sel;\n\n\tif (channel > DA9052_ADC_VBBAT)\n\t\treturn -EINVAL;\n\n\tmutex_lock(&da9052->auxadc_lock);\n\n\treinit_completion(&da9052->done);\n\n\t \n\tmux_sel = chan_mux[channel] | DA9052_ADC_MAN_MAN_CONV;\n\n\tret = da9052_reg_write(da9052, DA9052_ADC_MAN_REG, mux_sel);\n\tif (ret < 0)\n\t\tgoto err;\n\n\t \n\tif (!wait_for_completion_timeout(&da9052->done,\n\t\t\t\t\t msecs_to_jiffies(500))) {\n\t\tdev_err(da9052->dev,\n\t\t\t\"timeout waiting for ADC conversion interrupt\\n\");\n\t\tret = -ETIMEDOUT;\n\t\tgoto err;\n\t}\n\n\tret = da9052_reg_read(da9052, DA9052_ADC_RES_H_REG);\n\tif (ret < 0)\n\t\tgoto err;\n\n\tcalc_data = (unsigned short)ret;\n\tdata = calc_data << 2;\n\n\tret = da9052_reg_read(da9052, DA9052_ADC_RES_L_REG);\n\tif (ret < 0)\n\t\tgoto err;\n\n\tcalc_data = (unsigned short)(ret & DA9052_ADC_RES_LSB);\n\tdata |= calc_data;\n\n\tret = data;\n\nerr:\n\tmutex_unlock(&da9052->auxadc_lock);\n\treturn ret;\n}\nEXPORT_SYMBOL_GPL(da9052_adc_manual_read);\n\nint da9052_adc_read_temp(struct da9052 *da9052)\n{\n\tint tbat;\n\n\ttbat = da9052_reg_read(da9052, DA9052_TBAT_RES_REG);\n\tif (tbat <= 0)\n\t\treturn tbat;\n\n\t \n\treturn tbat_lookup[tbat - 1];\n}\nEXPORT_SYMBOL_GPL(da9052_adc_read_temp);\n\nstatic const struct mfd_cell da9052_subdev_info[] = {\n\t{\n\t\t.name = \"da9052-regulator\",\n\t\t.id = 0,\n\t},\n\t{\n\t\t.name = \"da9052-regulator\",\n\t\t.id = 1,\n\t},\n\t{\n\t\t.name = \"da9052-regulator\",\n\t\t.id = 2,\n\t},\n\t{\n\t\t.name = \"da9052-regulator\",\n\t\t.id = 3,\n\t},\n\t{\n\t\t.name = \"da9052-regulator\",\n\t\t.id = 4,\n\t},\n\t{\n\t\t.name = \"da9052-regulator\",\n\t\t.id = 5,\n\t},\n\t{\n\t\t.name = \"da9052-regulator\",\n\t\t.id = 6,\n\t},\n\t{\n\t\t.name = \"da9052-regulator\",\n\t\t.id = 7,\n\t},\n\t{\n\t\t.name = \"da9052-regulator\",\n\t\t.id = 8,\n\t},\n\t{\n\t\t.name = \"da9052-regulator\",\n\t\t.id = 9,\n\t},\n\t{\n\t\t.name = \"da9052-regulator\",\n\t\t.id = 10,\n\t},\n\t{\n\t\t.name = \"da9052-regulator\",\n\t\t.id = 11,\n\t},\n\t{\n\t\t.name = \"da9052-regulator\",\n\t\t.id = 12,\n\t},\n\t{\n\t\t.name = \"da9052-regulator\",\n\t\t.id = 13,\n\t},\n\t{\n\t\t.name = \"da9052-onkey\",\n\t},\n\t{\n\t\t.name = \"da9052-rtc\",\n\t},\n\t{\n\t\t.name = \"da9052-gpio\",\n\t},\n\t{\n\t\t.name = \"da9052-hwmon\",\n\t},\n\t{\n\t\t.name = \"da9052-leds\",\n\t},\n\t{\n\t\t.name = \"da9052-wled1\",\n\t},\n\t{\n\t\t.name = \"da9052-wled2\",\n\t},\n\t{\n\t\t.name = \"da9052-wled3\",\n\t},\n\t{\n\t\t.name = \"da9052-bat\",\n\t},\n\t{\n\t\t.name = \"da9052-watchdog\",\n\t},\n};\n\nstatic const struct mfd_cell da9052_tsi_subdev_info[] = {\n\t{ .name = \"da9052-tsi\" },\n};\n\nconst struct regmap_config da9052_regmap_config = {\n\t.reg_bits = 8,\n\t.val_bits = 8,\n\n\t.cache_type = REGCACHE_RBTREE,\n\n\t.max_register = DA9052_PAGE1_CON_REG,\n\t.readable_reg = da9052_reg_readable,\n\t.writeable_reg = da9052_reg_writeable,\n\t.volatile_reg = da9052_reg_volatile,\n};\nEXPORT_SYMBOL_GPL(da9052_regmap_config);\n\nstatic int da9052_clear_fault_log(struct da9052 *da9052)\n{\n\tint ret = 0;\n\tint fault_log = 0;\n\n\tfault_log = da9052_reg_read(da9052, DA9052_FAULTLOG_REG);\n\tif (fault_log < 0) {\n\t\tdev_err(da9052->dev,\n\t\t\t\"Cannot read FAULT_LOG %d\\n\", fault_log);\n\t\treturn fault_log;\n\t}\n\n\tif (fault_log) {\n\t\tif (fault_log & DA9052_FAULTLOG_TWDERROR)\n\t\t\tdev_dbg(da9052->dev,\n\t\t\t\t\"Fault log entry detected: TWD_ERROR\\n\");\n\t\tif (fault_log & DA9052_FAULTLOG_VDDFAULT)\n\t\t\tdev_dbg(da9052->dev,\n\t\t\t\t\"Fault log entry detected: VDD_FAULT\\n\");\n\t\tif (fault_log & DA9052_FAULTLOG_VDDSTART)\n\t\t\tdev_dbg(da9052->dev,\n\t\t\t\t\"Fault log entry detected: VDD_START\\n\");\n\t\tif (fault_log & DA9052_FAULTLOG_TEMPOVER)\n\t\t\tdev_dbg(da9052->dev,\n\t\t\t\t\"Fault log entry detected: TEMP_OVER\\n\");\n\t\tif (fault_log & DA9052_FAULTLOG_KEYSHUT)\n\t\t\tdev_dbg(da9052->dev,\n\t\t\t\t\"Fault log entry detected: KEY_SHUT\\n\");\n\t\tif (fault_log & DA9052_FAULTLOG_NSDSET)\n\t\t\tdev_dbg(da9052->dev,\n\t\t\t\t\"Fault log entry detected: nSD_SHUT\\n\");\n\t\tif (fault_log & DA9052_FAULTLOG_WAITSET)\n\t\t\tdev_dbg(da9052->dev,\n\t\t\t\t\"Fault log entry detected: WAIT_SHUT\\n\");\n\n\t\tret = da9052_reg_write(da9052,\n\t\t\t\t\tDA9052_FAULTLOG_REG,\n\t\t\t\t\t0xFF);\n\t\tif (ret < 0)\n\t\t\tdev_err(da9052->dev,\n\t\t\t\t\"Cannot reset FAULT_LOG values %d\\n\", ret);\n\t}\n\n\treturn ret;\n}\n\nint da9052_device_init(struct da9052 *da9052, u8 chip_id)\n{\n\tstruct da9052_pdata *pdata = dev_get_platdata(da9052->dev);\n\tint ret;\n\n\tmutex_init(&da9052->auxadc_lock);\n\tinit_completion(&da9052->done);\n\n\tret = da9052_clear_fault_log(da9052);\n\tif (ret < 0)\n\t\tdev_warn(da9052->dev, \"Cannot clear FAULT_LOG\\n\");\n\n\tif (pdata && pdata->init != NULL)\n\t\tpdata->init(da9052);\n\n\tda9052->chip_id = chip_id;\n\n\tret = da9052_irq_init(da9052);\n\tif (ret != 0) {\n\t\tdev_err(da9052->dev, \"da9052_irq_init failed: %d\\n\", ret);\n\t\treturn ret;\n\t}\n\n\tret = mfd_add_devices(da9052->dev, PLATFORM_DEVID_AUTO,\n\t\t\t      da9052_subdev_info,\n\t\t\t      ARRAY_SIZE(da9052_subdev_info), NULL, 0, NULL);\n\tif (ret) {\n\t\tdev_err(da9052->dev, \"mfd_add_devices failed: %d\\n\", ret);\n\t\tgoto err;\n\t}\n\n\t \n\tif (!device_property_read_bool(da9052->dev, \"dlg,tsi-as-adc\")) {\n\t\tret = mfd_add_devices(da9052->dev, PLATFORM_DEVID_AUTO,\n\t\t\t\t      da9052_tsi_subdev_info,\n\t\t\t\t      ARRAY_SIZE(da9052_tsi_subdev_info),\n\t\t\t\t      NULL, 0, NULL);\n\t\tif (ret) {\n\t\t\tdev_err(da9052->dev, \"failed to add TSI subdev: %d\\n\",\n\t\t\t\tret);\n\t\t\tgoto err;\n\t\t}\n\t}\n\n\treturn 0;\n\nerr:\n\tmfd_remove_devices(da9052->dev);\n\tda9052_irq_exit(da9052);\n\n\treturn ret;\n}\n\nvoid da9052_device_exit(struct da9052 *da9052)\n{\n\tmfd_remove_devices(da9052->dev);\n\tda9052_irq_exit(da9052);\n}\n\nMODULE_AUTHOR(\"David Dajun Chen <dchen@diasemi.com>\");\nMODULE_DESCRIPTION(\"DA9052 MFD Core\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}