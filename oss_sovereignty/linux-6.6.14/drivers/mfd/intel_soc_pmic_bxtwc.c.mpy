{
  "module_name": "intel_soc_pmic_bxtwc.c",
  "hash_id": "15fb40ccc1c70950793b0469b31adbb2c788a6a7ba6df8c47509fcdde4920692",
  "original_prompt": "Ingested from linux-6.6.14/drivers/mfd/intel_soc_pmic_bxtwc.c",
  "human_readable_source": "\n \n\n#include <linux/acpi.h>\n#include <linux/bits.h>\n#include <linux/delay.h>\n#include <linux/err.h>\n#include <linux/interrupt.h>\n#include <linux/kernel.h>\n#include <linux/mfd/core.h>\n#include <linux/mfd/intel_soc_pmic.h>\n#include <linux/mfd/intel_soc_pmic_bxtwc.h>\n#include <linux/module.h>\n\n#include <asm/intel_scu_ipc.h>\n\n \n#define REG_ADDR_MASK\t\tGENMASK(15, 8)\n#define REG_ADDR_SHIFT\t\t8\n#define REG_OFFSET_MASK\t\tGENMASK(7, 0)\n\n \n#define BXTWC_IRQLVL1\t\t0x4E02\n\n#define BXTWC_PWRBTNIRQ\t\t0x4E03\n#define BXTWC_THRM0IRQ\t\t0x4E04\n#define BXTWC_THRM1IRQ\t\t0x4E05\n#define BXTWC_THRM2IRQ\t\t0x4E06\n#define BXTWC_BCUIRQ\t\t0x4E07\n#define BXTWC_ADCIRQ\t\t0x4E08\n#define BXTWC_CHGR0IRQ\t\t0x4E09\n#define BXTWC_CHGR1IRQ\t\t0x4E0A\n#define BXTWC_GPIOIRQ0\t\t0x4E0B\n#define BXTWC_GPIOIRQ1\t\t0x4E0C\n#define BXTWC_CRITIRQ\t\t0x4E0D\n#define BXTWC_TMUIRQ\t\t0x4FB6\n\n \n#define BXTWC_MIRQLVL1\t\t0x4E0E\n#define BXTWC_MIRQLVL1_MCHGR\tBIT(5)\n\n#define BXTWC_MPWRBTNIRQ\t0x4E0F\n#define BXTWC_MTHRM0IRQ\t\t0x4E12\n#define BXTWC_MTHRM1IRQ\t\t0x4E13\n#define BXTWC_MTHRM2IRQ\t\t0x4E14\n#define BXTWC_MBCUIRQ\t\t0x4E15\n#define BXTWC_MADCIRQ\t\t0x4E16\n#define BXTWC_MCHGR0IRQ\t\t0x4E17\n#define BXTWC_MCHGR1IRQ\t\t0x4E18\n#define BXTWC_MGPIO0IRQ\t\t0x4E19\n#define BXTWC_MGPIO1IRQ\t\t0x4E1A\n#define BXTWC_MCRITIRQ\t\t0x4E1B\n#define BXTWC_MTMUIRQ\t\t0x4FB7\n\n \n#define BROXTON_PMIC_WC_HRV\t4\n\n#define PMC_PMIC_ACCESS\t\t0xFF\n#define PMC_PMIC_READ\t\t0x0\n#define PMC_PMIC_WRITE\t\t0x1\n\nenum bxtwc_irqs {\n\tBXTWC_PWRBTN_LVL1_IRQ = 0,\n\tBXTWC_TMU_LVL1_IRQ,\n\tBXTWC_THRM_LVL1_IRQ,\n\tBXTWC_BCU_LVL1_IRQ,\n\tBXTWC_ADC_LVL1_IRQ,\n\tBXTWC_CHGR_LVL1_IRQ,\n\tBXTWC_GPIO_LVL1_IRQ,\n\tBXTWC_CRIT_LVL1_IRQ,\n};\n\nenum bxtwc_irqs_pwrbtn {\n\tBXTWC_PWRBTN_IRQ = 0,\n\tBXTWC_UIBTN_IRQ,\n};\n\nenum bxtwc_irqs_bcu {\n\tBXTWC_BCU_IRQ = 0,\n};\n\nenum bxtwc_irqs_adc {\n\tBXTWC_ADC_IRQ = 0,\n};\n\nenum bxtwc_irqs_chgr {\n\tBXTWC_USBC_IRQ = 0,\n\tBXTWC_CHGR0_IRQ,\n\tBXTWC_CHGR1_IRQ,\n};\n\nenum bxtwc_irqs_tmu {\n\tBXTWC_TMU_IRQ = 0,\n};\n\nenum bxtwc_irqs_crit {\n\tBXTWC_CRIT_IRQ = 0,\n};\n\nstatic const struct regmap_irq bxtwc_regmap_irqs[] = {\n\tREGMAP_IRQ_REG(BXTWC_PWRBTN_LVL1_IRQ, 0, BIT(0)),\n\tREGMAP_IRQ_REG(BXTWC_TMU_LVL1_IRQ, 0, BIT(1)),\n\tREGMAP_IRQ_REG(BXTWC_THRM_LVL1_IRQ, 0, BIT(2)),\n\tREGMAP_IRQ_REG(BXTWC_BCU_LVL1_IRQ, 0, BIT(3)),\n\tREGMAP_IRQ_REG(BXTWC_ADC_LVL1_IRQ, 0, BIT(4)),\n\tREGMAP_IRQ_REG(BXTWC_CHGR_LVL1_IRQ, 0, BIT(5)),\n\tREGMAP_IRQ_REG(BXTWC_GPIO_LVL1_IRQ, 0, BIT(6)),\n\tREGMAP_IRQ_REG(BXTWC_CRIT_LVL1_IRQ, 0, BIT(7)),\n};\n\nstatic const struct regmap_irq bxtwc_regmap_irqs_pwrbtn[] = {\n\tREGMAP_IRQ_REG(BXTWC_PWRBTN_IRQ, 0, BIT(0)),\n};\n\nstatic const struct regmap_irq bxtwc_regmap_irqs_bcu[] = {\n\tREGMAP_IRQ_REG(BXTWC_BCU_IRQ, 0, GENMASK(4, 0)),\n};\n\nstatic const struct regmap_irq bxtwc_regmap_irqs_adc[] = {\n\tREGMAP_IRQ_REG(BXTWC_ADC_IRQ, 0, GENMASK(7, 0)),\n};\n\nstatic const struct regmap_irq bxtwc_regmap_irqs_chgr[] = {\n\tREGMAP_IRQ_REG(BXTWC_USBC_IRQ, 0, BIT(5)),\n\tREGMAP_IRQ_REG(BXTWC_CHGR0_IRQ, 0, GENMASK(4, 0)),\n\tREGMAP_IRQ_REG(BXTWC_CHGR1_IRQ, 1, GENMASK(4, 0)),\n};\n\nstatic const struct regmap_irq bxtwc_regmap_irqs_tmu[] = {\n\tREGMAP_IRQ_REG(BXTWC_TMU_IRQ, 0, GENMASK(2, 1)),\n};\n\nstatic const struct regmap_irq bxtwc_regmap_irqs_crit[] = {\n\tREGMAP_IRQ_REG(BXTWC_CRIT_IRQ, 0, GENMASK(1, 0)),\n};\n\nstatic struct regmap_irq_chip bxtwc_regmap_irq_chip = {\n\t.name = \"bxtwc_irq_chip\",\n\t.status_base = BXTWC_IRQLVL1,\n\t.mask_base = BXTWC_MIRQLVL1,\n\t.irqs = bxtwc_regmap_irqs,\n\t.num_irqs = ARRAY_SIZE(bxtwc_regmap_irqs),\n\t.num_regs = 1,\n};\n\nstatic struct regmap_irq_chip bxtwc_regmap_irq_chip_pwrbtn = {\n\t.name = \"bxtwc_irq_chip_pwrbtn\",\n\t.status_base = BXTWC_PWRBTNIRQ,\n\t.mask_base = BXTWC_MPWRBTNIRQ,\n\t.irqs = bxtwc_regmap_irqs_pwrbtn,\n\t.num_irqs = ARRAY_SIZE(bxtwc_regmap_irqs_pwrbtn),\n\t.num_regs = 1,\n};\n\nstatic struct regmap_irq_chip bxtwc_regmap_irq_chip_tmu = {\n\t.name = \"bxtwc_irq_chip_tmu\",\n\t.status_base = BXTWC_TMUIRQ,\n\t.mask_base = BXTWC_MTMUIRQ,\n\t.irqs = bxtwc_regmap_irqs_tmu,\n\t.num_irqs = ARRAY_SIZE(bxtwc_regmap_irqs_tmu),\n\t.num_regs = 1,\n};\n\nstatic struct regmap_irq_chip bxtwc_regmap_irq_chip_bcu = {\n\t.name = \"bxtwc_irq_chip_bcu\",\n\t.status_base = BXTWC_BCUIRQ,\n\t.mask_base = BXTWC_MBCUIRQ,\n\t.irqs = bxtwc_regmap_irqs_bcu,\n\t.num_irqs = ARRAY_SIZE(bxtwc_regmap_irqs_bcu),\n\t.num_regs = 1,\n};\n\nstatic struct regmap_irq_chip bxtwc_regmap_irq_chip_adc = {\n\t.name = \"bxtwc_irq_chip_adc\",\n\t.status_base = BXTWC_ADCIRQ,\n\t.mask_base = BXTWC_MADCIRQ,\n\t.irqs = bxtwc_regmap_irqs_adc,\n\t.num_irqs = ARRAY_SIZE(bxtwc_regmap_irqs_adc),\n\t.num_regs = 1,\n};\n\nstatic struct regmap_irq_chip bxtwc_regmap_irq_chip_chgr = {\n\t.name = \"bxtwc_irq_chip_chgr\",\n\t.status_base = BXTWC_CHGR0IRQ,\n\t.mask_base = BXTWC_MCHGR0IRQ,\n\t.irqs = bxtwc_regmap_irqs_chgr,\n\t.num_irqs = ARRAY_SIZE(bxtwc_regmap_irqs_chgr),\n\t.num_regs = 2,\n};\n\nstatic struct regmap_irq_chip bxtwc_regmap_irq_chip_crit = {\n\t.name = \"bxtwc_irq_chip_crit\",\n\t.status_base = BXTWC_CRITIRQ,\n\t.mask_base = BXTWC_MCRITIRQ,\n\t.irqs = bxtwc_regmap_irqs_crit,\n\t.num_irqs = ARRAY_SIZE(bxtwc_regmap_irqs_crit),\n\t.num_regs = 1,\n};\n\nstatic const struct resource gpio_resources[] = {\n\tDEFINE_RES_IRQ_NAMED(BXTWC_GPIO_LVL1_IRQ, \"GPIO\"),\n};\n\nstatic const struct resource adc_resources[] = {\n\tDEFINE_RES_IRQ_NAMED(BXTWC_ADC_IRQ, \"ADC\"),\n};\n\nstatic const struct resource usbc_resources[] = {\n\tDEFINE_RES_IRQ(BXTWC_USBC_IRQ),\n};\n\nstatic const struct resource charger_resources[] = {\n\tDEFINE_RES_IRQ_NAMED(BXTWC_CHGR0_IRQ, \"CHARGER\"),\n\tDEFINE_RES_IRQ_NAMED(BXTWC_CHGR1_IRQ, \"CHARGER1\"),\n};\n\nstatic const struct resource thermal_resources[] = {\n\tDEFINE_RES_IRQ(BXTWC_THRM_LVL1_IRQ),\n};\n\nstatic const struct resource bcu_resources[] = {\n\tDEFINE_RES_IRQ_NAMED(BXTWC_BCU_IRQ, \"BCU\"),\n};\n\nstatic const struct resource tmu_resources[] = {\n\tDEFINE_RES_IRQ_NAMED(BXTWC_TMU_IRQ, \"TMU\"),\n};\n\nstatic struct mfd_cell bxt_wc_dev[] = {\n\t{\n\t\t.name = \"bxt_wcove_gpadc\",\n\t\t.num_resources = ARRAY_SIZE(adc_resources),\n\t\t.resources = adc_resources,\n\t},\n\t{\n\t\t.name = \"bxt_wcove_thermal\",\n\t\t.num_resources = ARRAY_SIZE(thermal_resources),\n\t\t.resources = thermal_resources,\n\t},\n\t{\n\t\t.name = \"bxt_wcove_usbc\",\n\t\t.num_resources = ARRAY_SIZE(usbc_resources),\n\t\t.resources = usbc_resources,\n\t},\n\t{\n\t\t.name = \"bxt_wcove_ext_charger\",\n\t\t.num_resources = ARRAY_SIZE(charger_resources),\n\t\t.resources = charger_resources,\n\t},\n\t{\n\t\t.name = \"bxt_wcove_bcu\",\n\t\t.num_resources = ARRAY_SIZE(bcu_resources),\n\t\t.resources = bcu_resources,\n\t},\n\t{\n\t\t.name = \"bxt_wcove_tmu\",\n\t\t.num_resources = ARRAY_SIZE(tmu_resources),\n\t\t.resources = tmu_resources,\n\t},\n\n\t{\n\t\t.name = \"bxt_wcove_gpio\",\n\t\t.num_resources = ARRAY_SIZE(gpio_resources),\n\t\t.resources = gpio_resources,\n\t},\n\t{\n\t\t.name = \"bxt_wcove_region\",\n\t},\n};\n\nstatic int regmap_ipc_byte_reg_read(void *context, unsigned int reg,\n\t\t\t\t    unsigned int *val)\n{\n\tint ret;\n\tint i2c_addr;\n\tu8 ipc_in[2];\n\tu8 ipc_out[4];\n\tstruct intel_soc_pmic *pmic = context;\n\n\tif (!pmic)\n\t\treturn -EINVAL;\n\n\tif (reg & REG_ADDR_MASK)\n\t\ti2c_addr = (reg & REG_ADDR_MASK) >> REG_ADDR_SHIFT;\n\telse\n\t\ti2c_addr = BXTWC_DEVICE1_ADDR;\n\n\treg &= REG_OFFSET_MASK;\n\n\tipc_in[0] = reg;\n\tipc_in[1] = i2c_addr;\n\tret = intel_scu_ipc_dev_command(pmic->scu, PMC_PMIC_ACCESS,\n\t\t\t\t\tPMC_PMIC_READ, ipc_in, sizeof(ipc_in),\n\t\t\t\t\tipc_out, sizeof(ipc_out));\n\tif (ret)\n\t\treturn ret;\n\n\t*val = ipc_out[0];\n\n\treturn 0;\n}\n\nstatic int regmap_ipc_byte_reg_write(void *context, unsigned int reg,\n\t\t\t\t       unsigned int val)\n{\n\tint i2c_addr;\n\tu8 ipc_in[3];\n\tstruct intel_soc_pmic *pmic = context;\n\n\tif (!pmic)\n\t\treturn -EINVAL;\n\n\tif (reg & REG_ADDR_MASK)\n\t\ti2c_addr = (reg & REG_ADDR_MASK) >> REG_ADDR_SHIFT;\n\telse\n\t\ti2c_addr = BXTWC_DEVICE1_ADDR;\n\n\treg &= REG_OFFSET_MASK;\n\n\tipc_in[0] = reg;\n\tipc_in[1] = i2c_addr;\n\tipc_in[2] = val;\n\treturn intel_scu_ipc_dev_command(pmic->scu, PMC_PMIC_ACCESS,\n\t\t\t\t\t PMC_PMIC_WRITE, ipc_in, sizeof(ipc_in),\n\t\t\t\t\t NULL, 0);\n}\n\n \nstatic unsigned long bxtwc_reg_addr;\nstatic ssize_t addr_show(struct device *dev,\n\t\t\t struct device_attribute *attr, char *buf)\n{\n\treturn sysfs_emit(buf, \"0x%lx\\n\", bxtwc_reg_addr);\n}\n\nstatic ssize_t addr_store(struct device *dev,\n\t\t\t  struct device_attribute *attr, const char *buf, size_t count)\n{\n\tint ret;\n\n\tret = kstrtoul(buf, 0, &bxtwc_reg_addr);\n\tif (ret)\n\t\treturn ret;\n\n\treturn count;\n}\n\nstatic ssize_t val_show(struct device *dev,\n\t\t\tstruct device_attribute *attr, char *buf)\n{\n\tint ret;\n\tunsigned int val;\n\tstruct intel_soc_pmic *pmic = dev_get_drvdata(dev);\n\n\tret = regmap_read(pmic->regmap, bxtwc_reg_addr, &val);\n\tif (ret) {\n\t\tdev_err(dev, \"Failed to read 0x%lx\\n\", bxtwc_reg_addr);\n\t\treturn ret;\n\t}\n\n\treturn sysfs_emit(buf, \"0x%02x\\n\", val);\n}\n\nstatic ssize_t val_store(struct device *dev,\n\t\t\t struct device_attribute *attr, const char *buf, size_t count)\n{\n\tint ret;\n\tunsigned int val;\n\tstruct intel_soc_pmic *pmic = dev_get_drvdata(dev);\n\n\tret = kstrtouint(buf, 0, &val);\n\tif (ret)\n\t\treturn ret;\n\n\tret = regmap_write(pmic->regmap, bxtwc_reg_addr, val);\n\tif (ret) {\n\t\tdev_err(dev, \"Failed to write value 0x%02x to address 0x%lx\",\n\t\t\tval, bxtwc_reg_addr);\n\t\treturn ret;\n\t}\n\treturn count;\n}\n\nstatic DEVICE_ATTR_ADMIN_RW(addr);\nstatic DEVICE_ATTR_ADMIN_RW(val);\nstatic struct attribute *bxtwc_attrs[] = {\n\t&dev_attr_addr.attr,\n\t&dev_attr_val.attr,\n\tNULL\n};\n\nstatic const struct attribute_group bxtwc_group = {\n\t.attrs = bxtwc_attrs,\n};\n\nstatic const struct attribute_group *bxtwc_groups[] = {\n\t&bxtwc_group,\n\tNULL\n};\n\nstatic const struct regmap_config bxtwc_regmap_config = {\n\t.reg_bits = 16,\n\t.val_bits = 8,\n\t.reg_write = regmap_ipc_byte_reg_write,\n\t.reg_read = regmap_ipc_byte_reg_read,\n};\n\nstatic int bxtwc_add_chained_irq_chip(struct intel_soc_pmic *pmic,\n\t\t\t\tstruct regmap_irq_chip_data *pdata,\n\t\t\t\tint pirq, int irq_flags,\n\t\t\t\tconst struct regmap_irq_chip *chip,\n\t\t\t\tstruct regmap_irq_chip_data **data)\n{\n\tint irq;\n\n\tirq = regmap_irq_get_virq(pdata, pirq);\n\tif (irq < 0)\n\t\treturn dev_err_probe(pmic->dev, irq, \"Failed to get parent vIRQ(%d) for chip %s\\n\",\n\t\t\t\t     pirq, chip->name);\n\n\treturn devm_regmap_add_irq_chip(pmic->dev, pmic->regmap, irq, irq_flags,\n\t\t\t\t\t0, chip, data);\n}\n\nstatic int bxtwc_probe(struct platform_device *pdev)\n{\n\tstruct device *dev = &pdev->dev;\n\tint ret;\n\tacpi_status status;\n\tunsigned long long hrv;\n\tstruct intel_soc_pmic *pmic;\n\n\tstatus = acpi_evaluate_integer(ACPI_HANDLE(dev), \"_HRV\", NULL, &hrv);\n\tif (ACPI_FAILURE(status))\n\t\treturn dev_err_probe(dev, -ENODEV, \"Failed to get PMIC hardware revision\\n\");\n\tif (hrv != BROXTON_PMIC_WC_HRV)\n\t\treturn dev_err_probe(dev, -ENODEV, \"Invalid PMIC hardware revision: %llu\\n\", hrv);\n\n\tpmic = devm_kzalloc(dev, sizeof(*pmic), GFP_KERNEL);\n\tif (!pmic)\n\t\treturn -ENOMEM;\n\n\tret = platform_get_irq(pdev, 0);\n\tif (ret < 0)\n\t\treturn ret;\n\tpmic->irq = ret;\n\n\tplatform_set_drvdata(pdev, pmic);\n\tpmic->dev = dev;\n\n\tpmic->scu = devm_intel_scu_ipc_dev_get(dev);\n\tif (!pmic->scu)\n\t\treturn -EPROBE_DEFER;\n\n\tpmic->regmap = devm_regmap_init(dev, NULL, pmic, &bxtwc_regmap_config);\n\tif (IS_ERR(pmic->regmap))\n\t\treturn dev_err_probe(dev, PTR_ERR(pmic->regmap), \"Failed to initialise regmap\\n\");\n\n\tret = devm_regmap_add_irq_chip(dev, pmic->regmap, pmic->irq,\n\t\t\t\t       IRQF_ONESHOT | IRQF_SHARED,\n\t\t\t\t       0, &bxtwc_regmap_irq_chip,\n\t\t\t\t       &pmic->irq_chip_data);\n\tif (ret)\n\t\treturn dev_err_probe(dev, ret, \"Failed to add IRQ chip\\n\");\n\n\tret = bxtwc_add_chained_irq_chip(pmic, pmic->irq_chip_data,\n\t\t\t\t\t BXTWC_PWRBTN_LVL1_IRQ,\n\t\t\t\t\t IRQF_ONESHOT,\n\t\t\t\t\t &bxtwc_regmap_irq_chip_pwrbtn,\n\t\t\t\t\t &pmic->irq_chip_data_pwrbtn);\n\tif (ret)\n\t\treturn dev_err_probe(dev, ret, \"Failed to add PWRBTN IRQ chip\\n\");\n\n\tret = bxtwc_add_chained_irq_chip(pmic, pmic->irq_chip_data,\n\t\t\t\t\t BXTWC_TMU_LVL1_IRQ,\n\t\t\t\t\t IRQF_ONESHOT,\n\t\t\t\t\t &bxtwc_regmap_irq_chip_tmu,\n\t\t\t\t\t &pmic->irq_chip_data_tmu);\n\tif (ret)\n\t\treturn dev_err_probe(dev, ret, \"Failed to add TMU IRQ chip\\n\");\n\n\t \n\tret = bxtwc_add_chained_irq_chip(pmic, pmic->irq_chip_data,\n\t\t\t\t\t BXTWC_BCU_LVL1_IRQ,\n\t\t\t\t\t IRQF_ONESHOT,\n\t\t\t\t\t &bxtwc_regmap_irq_chip_bcu,\n\t\t\t\t\t &pmic->irq_chip_data_bcu);\n\tif (ret)\n\t\treturn dev_err_probe(dev, ret, \"Failed to add BUC IRQ chip\\n\");\n\n\t \n\tret = bxtwc_add_chained_irq_chip(pmic, pmic->irq_chip_data,\n\t\t\t\t\t BXTWC_ADC_LVL1_IRQ,\n\t\t\t\t\t IRQF_ONESHOT,\n\t\t\t\t\t &bxtwc_regmap_irq_chip_adc,\n\t\t\t\t\t &pmic->irq_chip_data_adc);\n\tif (ret)\n\t\treturn dev_err_probe(dev, ret, \"Failed to add ADC IRQ chip\\n\");\n\n\t \n\tret = bxtwc_add_chained_irq_chip(pmic, pmic->irq_chip_data,\n\t\t\t\t\t BXTWC_CHGR_LVL1_IRQ,\n\t\t\t\t\t IRQF_ONESHOT,\n\t\t\t\t\t &bxtwc_regmap_irq_chip_chgr,\n\t\t\t\t\t &pmic->irq_chip_data_chgr);\n\tif (ret)\n\t\treturn dev_err_probe(dev, ret, \"Failed to add CHGR IRQ chip\\n\");\n\n\t \n\tret = bxtwc_add_chained_irq_chip(pmic, pmic->irq_chip_data,\n\t\t\t\t\t BXTWC_CRIT_LVL1_IRQ,\n\t\t\t\t\t IRQF_ONESHOT,\n\t\t\t\t\t &bxtwc_regmap_irq_chip_crit,\n\t\t\t\t\t &pmic->irq_chip_data_crit);\n\tif (ret)\n\t\treturn dev_err_probe(dev, ret, \"Failed to add CRIT IRQ chip\\n\");\n\n\tret = devm_mfd_add_devices(dev, PLATFORM_DEVID_NONE, bxt_wc_dev, ARRAY_SIZE(bxt_wc_dev),\n\t\t\t\t   NULL, 0, NULL);\n\tif (ret)\n\t\treturn dev_err_probe(dev, ret, \"Failed to add devices\\n\");\n\n\t \n\tregmap_update_bits(pmic->regmap, BXTWC_MIRQLVL1, BXTWC_MIRQLVL1_MCHGR, 0);\n\n\treturn 0;\n}\n\nstatic void bxtwc_shutdown(struct platform_device *pdev)\n{\n\tstruct intel_soc_pmic *pmic = platform_get_drvdata(pdev);\n\n\tdisable_irq(pmic->irq);\n}\n\nstatic int bxtwc_suspend(struct device *dev)\n{\n\tstruct intel_soc_pmic *pmic = dev_get_drvdata(dev);\n\n\tdisable_irq(pmic->irq);\n\n\treturn 0;\n}\n\nstatic int bxtwc_resume(struct device *dev)\n{\n\tstruct intel_soc_pmic *pmic = dev_get_drvdata(dev);\n\n\tenable_irq(pmic->irq);\n\treturn 0;\n}\n\nstatic DEFINE_SIMPLE_DEV_PM_OPS(bxtwc_pm_ops, bxtwc_suspend, bxtwc_resume);\n\nstatic const struct acpi_device_id bxtwc_acpi_ids[] = {\n\t{ \"INT34D3\", },\n\t{ }\n};\nMODULE_DEVICE_TABLE(acpi, bxtwc_acpi_ids);\n\nstatic struct platform_driver bxtwc_driver = {\n\t.probe = bxtwc_probe,\n\t.shutdown = bxtwc_shutdown,\n\t.driver\t= {\n\t\t.name\t= \"BXTWC PMIC\",\n\t\t.pm     = pm_sleep_ptr(&bxtwc_pm_ops),\n\t\t.acpi_match_table = bxtwc_acpi_ids,\n\t\t.dev_groups = bxtwc_groups,\n\t},\n};\n\nmodule_platform_driver(bxtwc_driver);\n\nMODULE_LICENSE(\"GPL v2\");\nMODULE_AUTHOR(\"Qipeng Zha <qipeng.zha@intel.com>\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}