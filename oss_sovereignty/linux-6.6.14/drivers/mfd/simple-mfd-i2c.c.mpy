{
  "module_name": "simple-mfd-i2c.c",
  "hash_id": "bb73c1d2087ad4440cb425b38f20b233a430e91d14cb7f931966bb193163b4a7",
  "original_prompt": "Ingested from linux-6.6.14/drivers/mfd/simple-mfd-i2c.c",
  "human_readable_source": "\n \n\n#include <linux/i2c.h>\n#include <linux/kernel.h>\n#include <linux/mfd/core.h>\n#include <linux/module.h>\n#include <linux/of_platform.h>\n#include <linux/regmap.h>\n\n#include \"simple-mfd-i2c.h\"\n\nstatic const struct regmap_config regmap_config_8r_8v = {\n\t.reg_bits = 8,\n\t.val_bits = 8,\n};\n\nstatic int simple_mfd_i2c_probe(struct i2c_client *i2c)\n{\n\tconst struct simple_mfd_data *simple_mfd_data;\n\tconst struct regmap_config *regmap_config;\n\tstruct regmap *regmap;\n\tint ret;\n\n\tsimple_mfd_data = device_get_match_data(&i2c->dev);\n\n\t \n\tif (!simple_mfd_data || !simple_mfd_data->regmap_config)\n\t\tregmap_config = &regmap_config_8r_8v;\n\telse\n\t\tregmap_config = simple_mfd_data->regmap_config;\n\n\tregmap = devm_regmap_init_i2c(i2c, regmap_config);\n\tif (IS_ERR(regmap))\n\t\treturn PTR_ERR(regmap);\n\n\t \n\tif (!simple_mfd_data || !simple_mfd_data->mfd_cell)\n\t\treturn devm_of_platform_populate(&i2c->dev);\n\n\tret = devm_mfd_add_devices(&i2c->dev, PLATFORM_DEVID_AUTO,\n\t\t\t\t   simple_mfd_data->mfd_cell,\n\t\t\t\t   simple_mfd_data->mfd_cell_size,\n\t\t\t\t   NULL, 0, NULL);\n\tif (ret)\n\t\tdev_err(&i2c->dev, \"Failed to add child devices\\n\");\n\n\treturn ret;\n}\n\nstatic const struct mfd_cell sy7636a_cells[] = {\n\t{ .name = \"sy7636a-regulator\", },\n\t{ .name = \"sy7636a-temperature\", },\n};\n\nstatic const struct simple_mfd_data silergy_sy7636a = {\n\t.mfd_cell = sy7636a_cells,\n\t.mfd_cell_size = ARRAY_SIZE(sy7636a_cells),\n};\n\nstatic const struct mfd_cell max5970_cells[] = {\n\t{ .name = \"max5970-regulator\", },\n\t{ .name = \"max5970-iio\", },\n\t{ .name = \"max5970-led\", },\n};\n\nstatic const struct simple_mfd_data maxim_max5970 = {\n\t.mfd_cell = max5970_cells,\n\t.mfd_cell_size = ARRAY_SIZE(max5970_cells),\n};\n\nstatic const struct of_device_id simple_mfd_i2c_of_match[] = {\n\t{ .compatible = \"kontron,sl28cpld\" },\n\t{ .compatible = \"silergy,sy7636a\", .data = &silergy_sy7636a},\n\t{ .compatible = \"maxim,max5970\", .data = &maxim_max5970},\n\t{ .compatible = \"maxim,max5978\", .data = &maxim_max5970},\n\t{}\n};\nMODULE_DEVICE_TABLE(of, simple_mfd_i2c_of_match);\n\nstatic struct i2c_driver simple_mfd_i2c_driver = {\n\t.probe = simple_mfd_i2c_probe,\n\t.driver = {\n\t\t.name = \"simple-mfd-i2c\",\n\t\t.of_match_table = simple_mfd_i2c_of_match,\n\t},\n};\nmodule_i2c_driver(simple_mfd_i2c_driver);\n\nMODULE_AUTHOR(\"Michael Walle <michael@walle.cc>\");\nMODULE_DESCRIPTION(\"Simple MFD - I2C driver\");\nMODULE_LICENSE(\"GPL v2\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}