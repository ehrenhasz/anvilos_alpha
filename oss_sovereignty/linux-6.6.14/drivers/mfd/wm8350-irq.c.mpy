{
  "module_name": "wm8350-irq.c",
  "hash_id": "653fc8fe2d2f2ea7c6a6bfbf3ba5477b58aa61bd0c8adce0aed1d735afa6a28b",
  "original_prompt": "Ingested from linux-6.6.14/drivers/mfd/wm8350-irq.c",
  "human_readable_source": "\n \n\n#include <linux/kernel.h>\n#include <linux/module.h>\n#include <linux/bug.h>\n#include <linux/device.h>\n#include <linux/interrupt.h>\n#include <linux/irq.h>\n\n#include <linux/mfd/wm8350/core.h>\n#include <linux/mfd/wm8350/audio.h>\n#include <linux/mfd/wm8350/comparator.h>\n#include <linux/mfd/wm8350/gpio.h>\n#include <linux/mfd/wm8350/pmic.h>\n#include <linux/mfd/wm8350/rtc.h>\n#include <linux/mfd/wm8350/supply.h>\n#include <linux/mfd/wm8350/wdt.h>\n\n#define WM8350_INT_OFFSET_1                     0\n#define WM8350_INT_OFFSET_2                     1\n#define WM8350_POWER_UP_INT_OFFSET              2\n#define WM8350_UNDER_VOLTAGE_INT_OFFSET         3\n#define WM8350_OVER_CURRENT_INT_OFFSET          4\n#define WM8350_GPIO_INT_OFFSET                  5\n#define WM8350_COMPARATOR_INT_OFFSET            6\n\nstruct wm8350_irq_data {\n\tint primary;\n\tint reg;\n\tint mask;\n\tint primary_only;\n};\n\nstatic struct wm8350_irq_data wm8350_irqs[] = {\n\t[WM8350_IRQ_OC_LS] = {\n\t\t.primary = WM8350_OC_INT,\n\t\t.reg = WM8350_OVER_CURRENT_INT_OFFSET,\n\t\t.mask = WM8350_OC_LS_EINT,\n\t\t.primary_only = 1,\n\t},\n\t[WM8350_IRQ_UV_DC1] = {\n\t\t.primary = WM8350_UV_INT,\n\t\t.reg = WM8350_UNDER_VOLTAGE_INT_OFFSET,\n\t\t.mask = WM8350_UV_DC1_EINT,\n\t},\n\t[WM8350_IRQ_UV_DC2] = {\n\t\t.primary = WM8350_UV_INT,\n\t\t.reg = WM8350_UNDER_VOLTAGE_INT_OFFSET,\n\t\t.mask = WM8350_UV_DC2_EINT,\n\t},\n\t[WM8350_IRQ_UV_DC3] = {\n\t\t.primary = WM8350_UV_INT,\n\t\t.reg = WM8350_UNDER_VOLTAGE_INT_OFFSET,\n\t\t.mask = WM8350_UV_DC3_EINT,\n\t},\n\t[WM8350_IRQ_UV_DC4] = {\n\t\t.primary = WM8350_UV_INT,\n\t\t.reg = WM8350_UNDER_VOLTAGE_INT_OFFSET,\n\t\t.mask = WM8350_UV_DC4_EINT,\n\t},\n\t[WM8350_IRQ_UV_DC5] = {\n\t\t.primary = WM8350_UV_INT,\n\t\t.reg = WM8350_UNDER_VOLTAGE_INT_OFFSET,\n\t\t.mask = WM8350_UV_DC5_EINT,\n\t},\n\t[WM8350_IRQ_UV_DC6] = {\n\t\t.primary = WM8350_UV_INT,\n\t\t.reg = WM8350_UNDER_VOLTAGE_INT_OFFSET,\n\t\t.mask = WM8350_UV_DC6_EINT,\n\t},\n\t[WM8350_IRQ_UV_LDO1] = {\n\t\t.primary = WM8350_UV_INT,\n\t\t.reg = WM8350_UNDER_VOLTAGE_INT_OFFSET,\n\t\t.mask = WM8350_UV_LDO1_EINT,\n\t},\n\t[WM8350_IRQ_UV_LDO2] = {\n\t\t.primary = WM8350_UV_INT,\n\t\t.reg = WM8350_UNDER_VOLTAGE_INT_OFFSET,\n\t\t.mask = WM8350_UV_LDO2_EINT,\n\t},\n\t[WM8350_IRQ_UV_LDO3] = {\n\t\t.primary = WM8350_UV_INT,\n\t\t.reg = WM8350_UNDER_VOLTAGE_INT_OFFSET,\n\t\t.mask = WM8350_UV_LDO3_EINT,\n\t},\n\t[WM8350_IRQ_UV_LDO4] = {\n\t\t.primary = WM8350_UV_INT,\n\t\t.reg = WM8350_UNDER_VOLTAGE_INT_OFFSET,\n\t\t.mask = WM8350_UV_LDO4_EINT,\n\t},\n\t[WM8350_IRQ_CHG_BAT_HOT] = {\n\t\t.primary = WM8350_CHG_INT,\n\t\t.reg = WM8350_INT_OFFSET_1,\n\t\t.mask = WM8350_CHG_BAT_HOT_EINT,\n\t},\n\t[WM8350_IRQ_CHG_BAT_COLD] = {\n\t\t.primary = WM8350_CHG_INT,\n\t\t.reg = WM8350_INT_OFFSET_1,\n\t\t.mask = WM8350_CHG_BAT_COLD_EINT,\n\t},\n\t[WM8350_IRQ_CHG_BAT_FAIL] = {\n\t\t.primary = WM8350_CHG_INT,\n\t\t.reg = WM8350_INT_OFFSET_1,\n\t\t.mask = WM8350_CHG_BAT_FAIL_EINT,\n\t},\n\t[WM8350_IRQ_CHG_TO] = {\n\t\t.primary = WM8350_CHG_INT,\n\t\t.reg = WM8350_INT_OFFSET_1,\n\t\t.mask = WM8350_CHG_TO_EINT,\n\t},\n\t[WM8350_IRQ_CHG_END] = {\n\t\t.primary = WM8350_CHG_INT,\n\t\t.reg = WM8350_INT_OFFSET_1,\n\t\t.mask = WM8350_CHG_END_EINT,\n\t},\n\t[WM8350_IRQ_CHG_START] = {\n\t\t.primary = WM8350_CHG_INT,\n\t\t.reg = WM8350_INT_OFFSET_1,\n\t\t.mask = WM8350_CHG_START_EINT,\n\t},\n\t[WM8350_IRQ_CHG_FAST_RDY] = {\n\t\t.primary = WM8350_CHG_INT,\n\t\t.reg = WM8350_INT_OFFSET_1,\n\t\t.mask = WM8350_CHG_FAST_RDY_EINT,\n\t},\n\t[WM8350_IRQ_CHG_VBATT_LT_3P9] = {\n\t\t.primary = WM8350_CHG_INT,\n\t\t.reg = WM8350_INT_OFFSET_1,\n\t\t.mask = WM8350_CHG_VBATT_LT_3P9_EINT,\n\t},\n\t[WM8350_IRQ_CHG_VBATT_LT_3P1] = {\n\t\t.primary = WM8350_CHG_INT,\n\t\t.reg = WM8350_INT_OFFSET_1,\n\t\t.mask = WM8350_CHG_VBATT_LT_3P1_EINT,\n\t},\n\t[WM8350_IRQ_CHG_VBATT_LT_2P85] = {\n\t\t.primary = WM8350_CHG_INT,\n\t\t.reg = WM8350_INT_OFFSET_1,\n\t\t.mask = WM8350_CHG_VBATT_LT_2P85_EINT,\n\t},\n\t[WM8350_IRQ_RTC_ALM] = {\n\t\t.primary = WM8350_RTC_INT,\n\t\t.reg = WM8350_INT_OFFSET_1,\n\t\t.mask = WM8350_RTC_ALM_EINT,\n\t},\n\t[WM8350_IRQ_RTC_SEC] = {\n\t\t.primary = WM8350_RTC_INT,\n\t\t.reg = WM8350_INT_OFFSET_1,\n\t\t.mask = WM8350_RTC_SEC_EINT,\n\t},\n\t[WM8350_IRQ_RTC_PER] = {\n\t\t.primary = WM8350_RTC_INT,\n\t\t.reg = WM8350_INT_OFFSET_1,\n\t\t.mask = WM8350_RTC_PER_EINT,\n\t},\n\t[WM8350_IRQ_CS1] = {\n\t\t.primary = WM8350_CS_INT,\n\t\t.reg = WM8350_INT_OFFSET_2,\n\t\t.mask = WM8350_CS1_EINT,\n\t},\n\t[WM8350_IRQ_CS2] = {\n\t\t.primary = WM8350_CS_INT,\n\t\t.reg = WM8350_INT_OFFSET_2,\n\t\t.mask = WM8350_CS2_EINT,\n\t},\n\t[WM8350_IRQ_SYS_HYST_COMP_FAIL] = {\n\t\t.primary = WM8350_SYS_INT,\n\t\t.reg = WM8350_INT_OFFSET_2,\n\t\t.mask = WM8350_SYS_HYST_COMP_FAIL_EINT,\n\t},\n\t[WM8350_IRQ_SYS_CHIP_GT115] = {\n\t\t.primary = WM8350_SYS_INT,\n\t\t.reg = WM8350_INT_OFFSET_2,\n\t\t.mask = WM8350_SYS_CHIP_GT115_EINT,\n\t},\n\t[WM8350_IRQ_SYS_CHIP_GT140] = {\n\t\t.primary = WM8350_SYS_INT,\n\t\t.reg = WM8350_INT_OFFSET_2,\n\t\t.mask = WM8350_SYS_CHIP_GT140_EINT,\n\t},\n\t[WM8350_IRQ_SYS_WDOG_TO] = {\n\t\t.primary = WM8350_SYS_INT,\n\t\t.reg = WM8350_INT_OFFSET_2,\n\t\t.mask = WM8350_SYS_WDOG_TO_EINT,\n\t},\n\t[WM8350_IRQ_AUXADC_DATARDY] = {\n\t\t.primary = WM8350_AUXADC_INT,\n\t\t.reg = WM8350_INT_OFFSET_2,\n\t\t.mask = WM8350_AUXADC_DATARDY_EINT,\n\t},\n\t[WM8350_IRQ_AUXADC_DCOMP4] = {\n\t\t.primary = WM8350_AUXADC_INT,\n\t\t.reg = WM8350_INT_OFFSET_2,\n\t\t.mask = WM8350_AUXADC_DCOMP4_EINT,\n\t},\n\t[WM8350_IRQ_AUXADC_DCOMP3] = {\n\t\t.primary = WM8350_AUXADC_INT,\n\t\t.reg = WM8350_INT_OFFSET_2,\n\t\t.mask = WM8350_AUXADC_DCOMP3_EINT,\n\t},\n\t[WM8350_IRQ_AUXADC_DCOMP2] = {\n\t\t.primary = WM8350_AUXADC_INT,\n\t\t.reg = WM8350_INT_OFFSET_2,\n\t\t.mask = WM8350_AUXADC_DCOMP2_EINT,\n\t},\n\t[WM8350_IRQ_AUXADC_DCOMP1] = {\n\t\t.primary = WM8350_AUXADC_INT,\n\t\t.reg = WM8350_INT_OFFSET_2,\n\t\t.mask = WM8350_AUXADC_DCOMP1_EINT,\n\t},\n\t[WM8350_IRQ_USB_LIMIT] = {\n\t\t.primary = WM8350_USB_INT,\n\t\t.reg = WM8350_INT_OFFSET_2,\n\t\t.mask = WM8350_USB_LIMIT_EINT,\n\t\t.primary_only = 1,\n\t},\n\t[WM8350_IRQ_WKUP_OFF_STATE] = {\n\t\t.primary = WM8350_WKUP_INT,\n\t\t.reg = WM8350_COMPARATOR_INT_OFFSET,\n\t\t.mask = WM8350_WKUP_OFF_STATE_EINT,\n\t},\n\t[WM8350_IRQ_WKUP_HIB_STATE] = {\n\t\t.primary = WM8350_WKUP_INT,\n\t\t.reg = WM8350_COMPARATOR_INT_OFFSET,\n\t\t.mask = WM8350_WKUP_HIB_STATE_EINT,\n\t},\n\t[WM8350_IRQ_WKUP_CONV_FAULT] = {\n\t\t.primary = WM8350_WKUP_INT,\n\t\t.reg = WM8350_COMPARATOR_INT_OFFSET,\n\t\t.mask = WM8350_WKUP_CONV_FAULT_EINT,\n\t},\n\t[WM8350_IRQ_WKUP_WDOG_RST] = {\n\t\t.primary = WM8350_WKUP_INT,\n\t\t.reg = WM8350_COMPARATOR_INT_OFFSET,\n\t\t.mask = WM8350_WKUP_WDOG_RST_EINT,\n\t},\n\t[WM8350_IRQ_WKUP_GP_PWR_ON] = {\n\t\t.primary = WM8350_WKUP_INT,\n\t\t.reg = WM8350_COMPARATOR_INT_OFFSET,\n\t\t.mask = WM8350_WKUP_GP_PWR_ON_EINT,\n\t},\n\t[WM8350_IRQ_WKUP_ONKEY] = {\n\t\t.primary = WM8350_WKUP_INT,\n\t\t.reg = WM8350_COMPARATOR_INT_OFFSET,\n\t\t.mask = WM8350_WKUP_ONKEY_EINT,\n\t},\n\t[WM8350_IRQ_WKUP_GP_WAKEUP] = {\n\t\t.primary = WM8350_WKUP_INT,\n\t\t.reg = WM8350_COMPARATOR_INT_OFFSET,\n\t\t.mask = WM8350_WKUP_GP_WAKEUP_EINT,\n\t},\n\t[WM8350_IRQ_CODEC_JCK_DET_L] = {\n\t\t.primary = WM8350_CODEC_INT,\n\t\t.reg = WM8350_COMPARATOR_INT_OFFSET,\n\t\t.mask = WM8350_CODEC_JCK_DET_L_EINT,\n\t},\n\t[WM8350_IRQ_CODEC_JCK_DET_R] = {\n\t\t.primary = WM8350_CODEC_INT,\n\t\t.reg = WM8350_COMPARATOR_INT_OFFSET,\n\t\t.mask = WM8350_CODEC_JCK_DET_R_EINT,\n\t},\n\t[WM8350_IRQ_CODEC_MICSCD] = {\n\t\t.primary = WM8350_CODEC_INT,\n\t\t.reg = WM8350_COMPARATOR_INT_OFFSET,\n\t\t.mask = WM8350_CODEC_MICSCD_EINT,\n\t},\n\t[WM8350_IRQ_CODEC_MICD] = {\n\t\t.primary = WM8350_CODEC_INT,\n\t\t.reg = WM8350_COMPARATOR_INT_OFFSET,\n\t\t.mask = WM8350_CODEC_MICD_EINT,\n\t},\n\t[WM8350_IRQ_EXT_USB_FB] = {\n\t\t.primary = WM8350_EXT_INT,\n\t\t.reg = WM8350_COMPARATOR_INT_OFFSET,\n\t\t.mask = WM8350_EXT_USB_FB_EINT,\n\t},\n\t[WM8350_IRQ_EXT_WALL_FB] = {\n\t\t.primary = WM8350_EXT_INT,\n\t\t.reg = WM8350_COMPARATOR_INT_OFFSET,\n\t\t.mask = WM8350_EXT_WALL_FB_EINT,\n\t},\n\t[WM8350_IRQ_EXT_BAT_FB] = {\n\t\t.primary = WM8350_EXT_INT,\n\t\t.reg = WM8350_COMPARATOR_INT_OFFSET,\n\t\t.mask = WM8350_EXT_BAT_FB_EINT,\n\t},\n\t[WM8350_IRQ_GPIO(0)] = {\n\t\t.primary = WM8350_GP_INT,\n\t\t.reg = WM8350_GPIO_INT_OFFSET,\n\t\t.mask = WM8350_GP0_EINT,\n\t},\n\t[WM8350_IRQ_GPIO(1)] = {\n\t\t.primary = WM8350_GP_INT,\n\t\t.reg = WM8350_GPIO_INT_OFFSET,\n\t\t.mask = WM8350_GP1_EINT,\n\t},\n\t[WM8350_IRQ_GPIO(2)] = {\n\t\t.primary = WM8350_GP_INT,\n\t\t.reg = WM8350_GPIO_INT_OFFSET,\n\t\t.mask = WM8350_GP2_EINT,\n\t},\n\t[WM8350_IRQ_GPIO(3)] = {\n\t\t.primary = WM8350_GP_INT,\n\t\t.reg = WM8350_GPIO_INT_OFFSET,\n\t\t.mask = WM8350_GP3_EINT,\n\t},\n\t[WM8350_IRQ_GPIO(4)] = {\n\t\t.primary = WM8350_GP_INT,\n\t\t.reg = WM8350_GPIO_INT_OFFSET,\n\t\t.mask = WM8350_GP4_EINT,\n\t},\n\t[WM8350_IRQ_GPIO(5)] = {\n\t\t.primary = WM8350_GP_INT,\n\t\t.reg = WM8350_GPIO_INT_OFFSET,\n\t\t.mask = WM8350_GP5_EINT,\n\t},\n\t[WM8350_IRQ_GPIO(6)] = {\n\t\t.primary = WM8350_GP_INT,\n\t\t.reg = WM8350_GPIO_INT_OFFSET,\n\t\t.mask = WM8350_GP6_EINT,\n\t},\n\t[WM8350_IRQ_GPIO(7)] = {\n\t\t.primary = WM8350_GP_INT,\n\t\t.reg = WM8350_GPIO_INT_OFFSET,\n\t\t.mask = WM8350_GP7_EINT,\n\t},\n\t[WM8350_IRQ_GPIO(8)] = {\n\t\t.primary = WM8350_GP_INT,\n\t\t.reg = WM8350_GPIO_INT_OFFSET,\n\t\t.mask = WM8350_GP8_EINT,\n\t},\n\t[WM8350_IRQ_GPIO(9)] = {\n\t\t.primary = WM8350_GP_INT,\n\t\t.reg = WM8350_GPIO_INT_OFFSET,\n\t\t.mask = WM8350_GP9_EINT,\n\t},\n\t[WM8350_IRQ_GPIO(10)] = {\n\t\t.primary = WM8350_GP_INT,\n\t\t.reg = WM8350_GPIO_INT_OFFSET,\n\t\t.mask = WM8350_GP10_EINT,\n\t},\n\t[WM8350_IRQ_GPIO(11)] = {\n\t\t.primary = WM8350_GP_INT,\n\t\t.reg = WM8350_GPIO_INT_OFFSET,\n\t\t.mask = WM8350_GP11_EINT,\n\t},\n\t[WM8350_IRQ_GPIO(12)] = {\n\t\t.primary = WM8350_GP_INT,\n\t\t.reg = WM8350_GPIO_INT_OFFSET,\n\t\t.mask = WM8350_GP12_EINT,\n\t},\n};\n\nstatic inline struct wm8350_irq_data *irq_to_wm8350_irq(struct wm8350 *wm8350,\n\t\t\t\t\t\t\tint irq)\n{\n\treturn &wm8350_irqs[irq - wm8350->irq_base];\n}\n\n \nstatic irqreturn_t wm8350_irq(int irq, void *irq_data)\n{\n\tstruct wm8350 *wm8350 = irq_data;\n\tu16 level_one;\n\tu16 sub_reg[WM8350_NUM_IRQ_REGS];\n\tint read_done[WM8350_NUM_IRQ_REGS];\n\tstruct wm8350_irq_data *data;\n\tint i;\n\n\tlevel_one = wm8350_reg_read(wm8350, WM8350_SYSTEM_INTERRUPTS)\n\t\t& ~wm8350_reg_read(wm8350, WM8350_SYSTEM_INTERRUPTS_MASK);\n\n\tif (!level_one)\n\t\treturn IRQ_NONE;\n\n\tmemset(&read_done, 0, sizeof(read_done));\n\n\tfor (i = 0; i < ARRAY_SIZE(wm8350_irqs); i++) {\n\t\tdata = &wm8350_irqs[i];\n\n\t\tif (!(level_one & data->primary))\n\t\t\tcontinue;\n\n\t\tif (!read_done[data->reg]) {\n\t\t\tsub_reg[data->reg] =\n\t\t\t\twm8350_reg_read(wm8350, WM8350_INT_STATUS_1 +\n\t\t\t\t\t\tdata->reg);\n\t\t\tsub_reg[data->reg] &= ~wm8350->irq_masks[data->reg];\n\t\t\tread_done[data->reg] = 1;\n\t\t}\n\n\t\tif (sub_reg[data->reg] & data->mask)\n\t\t\thandle_nested_irq(wm8350->irq_base + i);\n\t}\n\n\treturn IRQ_HANDLED;\n}\n\nstatic void wm8350_irq_lock(struct irq_data *data)\n{\n\tstruct wm8350 *wm8350 = irq_data_get_irq_chip_data(data);\n\n\tmutex_lock(&wm8350->irq_lock);\n}\n\nstatic void wm8350_irq_sync_unlock(struct irq_data *data)\n{\n\tstruct wm8350 *wm8350 = irq_data_get_irq_chip_data(data);\n\tint i;\n\n\tfor (i = 0; i < ARRAY_SIZE(wm8350->irq_masks); i++) {\n\t\t \n\t\tWARN_ON(regmap_update_bits(wm8350->regmap,\n\t\t\t\t\t   WM8350_INT_STATUS_1_MASK + i,\n\t\t\t\t\t   0xffff, wm8350->irq_masks[i]));\n\t}\n\n\tmutex_unlock(&wm8350->irq_lock);\n}\n\nstatic void wm8350_irq_enable(struct irq_data *data)\n{\n\tstruct wm8350 *wm8350 = irq_data_get_irq_chip_data(data);\n\tstruct wm8350_irq_data *irq_data = irq_to_wm8350_irq(wm8350,\n\t\t\t\t\t\t\t     data->irq);\n\n\twm8350->irq_masks[irq_data->reg] &= ~irq_data->mask;\n}\n\nstatic void wm8350_irq_disable(struct irq_data *data)\n{\n\tstruct wm8350 *wm8350 = irq_data_get_irq_chip_data(data);\n\tstruct wm8350_irq_data *irq_data = irq_to_wm8350_irq(wm8350,\n\t\t\t\t\t\t\t     data->irq);\n\n\twm8350->irq_masks[irq_data->reg] |= irq_data->mask;\n}\n\nstatic struct irq_chip wm8350_irq_chip = {\n\t.name\t\t\t= \"wm8350\",\n\t.irq_bus_lock\t\t= wm8350_irq_lock,\n\t.irq_bus_sync_unlock\t= wm8350_irq_sync_unlock,\n\t.irq_disable\t\t= wm8350_irq_disable,\n\t.irq_enable\t\t= wm8350_irq_enable,\n};\n\nint wm8350_irq_init(struct wm8350 *wm8350, int irq,\n\t\t    struct wm8350_platform_data *pdata)\n{\n\tint ret, cur_irq, i;\n\tint flags = IRQF_ONESHOT;\n\tint irq_base = -1;\n\n\tif (!irq) {\n\t\tdev_warn(wm8350->dev, \"No interrupt support, no core IRQ\\n\");\n\t\treturn 0;\n\t}\n\n\t \n\twm8350_reg_write(wm8350, WM8350_SYSTEM_INTERRUPTS_MASK, 0xFFFF);\n\n\t \n\tfor (i = 0; i < ARRAY_SIZE(wm8350->irq_masks); i++) {\n\t\twm8350_reg_write(wm8350, WM8350_INT_STATUS_1_MASK + i,\n\t\t\t\t 0xFFFF);\n\t\twm8350->irq_masks[i] =\n\t\t\twm8350_reg_read(wm8350,\n\t\t\t\t\tWM8350_INT_STATUS_1_MASK + i);\n\t}\n\n\tmutex_init(&wm8350->irq_lock);\n\twm8350->chip_irq = irq;\n\n\tif (pdata && pdata->irq_base > 0)\n\t\tirq_base = pdata->irq_base;\n\n\twm8350->irq_base =\n\t\tirq_alloc_descs(irq_base, 0, ARRAY_SIZE(wm8350_irqs), 0);\n\tif (wm8350->irq_base < 0) {\n\t\tdev_warn(wm8350->dev, \"Allocating irqs failed with %d\\n\",\n\t\t\twm8350->irq_base);\n\t\treturn 0;\n\t}\n\n\tif (pdata && pdata->irq_high) {\n\t\tflags |= IRQF_TRIGGER_HIGH;\n\n\t\twm8350_set_bits(wm8350, WM8350_SYSTEM_CONTROL_1,\n\t\t\t\tWM8350_IRQ_POL);\n\t} else {\n\t\tflags |= IRQF_TRIGGER_LOW;\n\n\t\twm8350_clear_bits(wm8350, WM8350_SYSTEM_CONTROL_1,\n\t\t\t\t  WM8350_IRQ_POL);\n\t}\n\n\t \n\tfor (cur_irq = wm8350->irq_base;\n\t     cur_irq < ARRAY_SIZE(wm8350_irqs) + wm8350->irq_base;\n\t     cur_irq++) {\n\t\tirq_set_chip_data(cur_irq, wm8350);\n\t\tirq_set_chip_and_handler(cur_irq, &wm8350_irq_chip,\n\t\t\t\t\t handle_edge_irq);\n\t\tirq_set_nested_thread(cur_irq, 1);\n\n\t\tirq_clear_status_flags(cur_irq, IRQ_NOREQUEST | IRQ_NOPROBE);\n\t}\n\n\tret = request_threaded_irq(irq, NULL, wm8350_irq, flags,\n\t\t\t\t   \"wm8350\", wm8350);\n\tif (ret != 0)\n\t\tdev_err(wm8350->dev, \"Failed to request IRQ: %d\\n\", ret);\n\n\t \n\twm8350_reg_write(wm8350, WM8350_SYSTEM_INTERRUPTS_MASK, 0);\n\n\treturn ret;\n}\n\nint wm8350_irq_exit(struct wm8350 *wm8350)\n{\n\tfree_irq(wm8350->chip_irq, wm8350);\n\treturn 0;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}