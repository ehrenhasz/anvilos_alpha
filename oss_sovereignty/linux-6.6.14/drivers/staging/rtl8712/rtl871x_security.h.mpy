{
  "module_name": "rtl871x_security.h",
  "hash_id": "073cb7221e47119557cb69fb1a7f8a4cf548b7f44db80820ab9901d1c39975a2",
  "original_prompt": "Ingested from linux-6.6.14/drivers/staging/rtl8712/rtl871x_security.h",
  "human_readable_source": " \n \n#ifndef __RTL871X_SECURITY_H_\n#define __RTL871X_SECURITY_H_\n\n#include \"osdep_service.h\"\n#include \"drv_types.h\"\n\n#define _NO_PRIVACY_\t0x0\n#define _WEP40_\t\t0x1\n#define _TKIP_\t\t0x2\n#define _TKIP_WTMIC_\t0x3\n#define _AES_\t\t0x4\n#define _WEP104_\t0x5\n\n#define _WPA_IE_ID_\t0xdd\n#define _WPA2_IE_ID_\t0x30\n\n#ifndef Ndis802_11AuthModeWPA2\n#define Ndis802_11AuthModeWPA2 (Ndis802_11AuthModeWPANone + 1)\n#endif\n\n#ifndef Ndis802_11AuthModeWPA2PSK\n#define Ndis802_11AuthModeWPA2PSK (Ndis802_11AuthModeWPANone + 2)\n#endif\n\nunion pn48 {\n\tu64 val;\n#if defined(__BIG_ENDIAN)\n\tstruct {\n\t\tu8 TSC7;\n\t\tu8 TSC6;\n\t\tu8 TSC5;\n\t\tu8 TSC4;\n\t\tu8 TSC3;\n\t\tu8 TSC2;\n\t\tu8 TSC1;\n\t\tu8 TSC0;\n\t} _byte_;\n#else\n\tstruct {\n\t\tu8 TSC0;\n\t\tu8 TSC1;\n\t\tu8 TSC2;\n\t\tu8 TSC3;\n\t\tu8 TSC4;\n\t\tu8 TSC5;\n\t\tu8 TSC6;\n\t\tu8 TSC7;\n\t} _byte_;\n#endif\n};\n\nunion Keytype {\n\tu8 skey[16];\n\tu32 lkey[4];\n};\n\nstruct RT_PMKID_LIST {\n\tu8 bUsed;\n\tu8 Bssid[6];\n\tu8 PMKID[16];\n\tu8 SsidBuf[33];\n\tu8 *ssid_octet;\n\tu16 ssid_length;\n};\n\nstruct security_priv {\n\tu32 AuthAlgrthm;\t\t \n\tu32 PrivacyAlgrthm;\t\t \n\tu32 PrivacyKeyIndex;\t\t \n\tunion Keytype DefKey[4];\t \n\tu32 DefKeylen[4];\n\tu32 XGrpPrivacy;\t\t \n\tu32 XGrpKeyid;\t\t\t \n\tunion Keytype\tXGrpKey[2];\t \n\tunion Keytype\tXGrptxmickey[2];\n\tunion Keytype\tXGrprxmickey[2];\n\tunion pn48 Grptxpn;\t\t \n\tunion pn48 Grprxpn;\t\t \n\tu8 wps_hw_pbc_pressed; \n\tu8 wps_phase; \n\tu8 wps_ie[MAX_WPA_IE_LEN << 2];\n\tint wps_ie_len;\n\tu8\tbinstallGrpkey;\n\tu8\tbusetkipkey;\n\tstruct timer_list tkip_timer;\n\tu8\tbcheck_grpkey;\n\tu8\tbgrpkey_handshake;\n\ts32\tsw_encrypt;\t \n\ts32\tsw_decrypt;\t \n\ts32\thw_decrypted;\t \n\tu32 ndisauthtype;\t \n\tu32 ndisencryptstatus;\n\tstruct wlan_bssid_ex sec_bss;   \n\tstruct NDIS_802_11_WEP ndiswep;\n\tu8 assoc_info[600];\n\tu8 szofcapability[256];  \n\tu8 oidassociation[512];  \n\tu8 authenticator_ie[256];   \n\tu8 supplicant_ie[256];   \n\t \n\tu32 last_mic_err_time;\n\tu8\tbtkip_countermeasure;\n\tu8\tbtkip_wait_report;\n\tu32 btkip_countermeasure_time;\n\t \n\tstruct RT_PMKID_LIST\t\tPMKIDList[NUM_PMKID_CACHE];\n\tu8\t\t\t\tPMKIDIndex;\n};\n\n#define GET_ENCRY_ALGO(psecuritypriv, psta, encry_algo, bmcst) \\\ndo { \\\n\tswitch (psecuritypriv->AuthAlgrthm) { \\\n\tcase 0: \\\n\tcase 1: \\\n\tcase 3: \\\n\t\tencry_algo = (u8)psecuritypriv->PrivacyAlgrthm; \\\n\t\tbreak; \\\n\tcase 2: \\\n\t\tif (bmcst) \\\n\t\t\tencry_algo = (u8)psecuritypriv->XGrpPrivacy; \\\n\t\telse \\\n\t\t\tencry_algo = (u8)psta->XPrivacy; \\\n\t\tbreak; \\\n\t} \\\n} while (0)\n#define SET_ICE_IV_LEN(iv_len, icv_len, encrypt)\\\ndo {\\\n\tswitch (encrypt) { \\\n\tcase _WEP40_: \\\n\tcase _WEP104_: \\\n\t\tiv_len = 4; \\\n\t\ticv_len = 4; \\\n\t\tbreak; \\\n\tcase _TKIP_: \\\n\t\tiv_len = 8; \\\n\t\ticv_len = 4; \\\n\t\tbreak; \\\n\tcase _AES_: \\\n\t\tiv_len = 8; \\\n\t\ticv_len = 8; \\\n\t\tbreak; \\\n\tdefault: \\\n\t\tiv_len = 0; \\\n\t\ticv_len = 0; \\\n\t\tbreak; \\\n\t} \\\n} while (0)\n#define GET_TKIP_PN(iv, txpn) \\\ndo {\\\n\ttxpn._byte_.TSC0 = iv[2];\\\n\ttxpn._byte_.TSC1 = iv[0];\\\n\ttxpn._byte_.TSC2 = iv[4];\\\n\ttxpn._byte_.TSC3 = iv[5];\\\n\ttxpn._byte_.TSC4 = iv[6];\\\n\ttxpn._byte_.TSC5 = iv[7];\\\n} while (0)\n\n#define ROL32(A, n) (((A) << (n)) | (((A) >> (32 - (n)))  & ((1UL << (n)) - 1)))\n#define ROR32(A, n) ROL32((A), 32 - (n))\n\nstruct mic_data {\n\tu32  K0, K1;          \n\tu32  L, R;            \n\tu32  M;               \n\tu32  nBytesInM;       \n};\n\nvoid seccalctkipmic(\n\tu8  *key,\n\tu8  *header,\n\tu8  *data,\n\tu32  data_len,\n\tu8  *Miccode,\n\tu8   priority);\n\nvoid r8712_secmicsetkey(struct mic_data *pmicdata, u8 *key);\nvoid r8712_secmicappend(struct mic_data *pmicdata, u8 *src, u32 nBytes);\nvoid r8712_secgetmic(struct mic_data *pmicdata, u8 *dst);\nu32 r8712_aes_encrypt(struct _adapter *padapter, u8 *pxmitframe);\nu32 r8712_tkip_encrypt(struct _adapter *padapter, u8 *pxmitframe);\nvoid r8712_wep_encrypt(struct _adapter *padapter, u8  *pxmitframe);\nvoid r8712_aes_decrypt(struct _adapter *padapter, u8  *precvframe);\nvoid r8712_tkip_decrypt(struct _adapter *padapter, u8  *precvframe);\nvoid r8712_wep_decrypt(struct _adapter *padapter, u8  *precvframe);\nvoid r8712_use_tkipkey_handler(struct timer_list *t);\n\n#endif\t \n\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}