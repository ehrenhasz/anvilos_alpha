{
  "module_name": "rtl871x_mlme.h",
  "hash_id": "232adb04d55cab3bf62cdefa6e3e4d5c8a768daadc6c35d31aa77f11fe8546a7",
  "original_prompt": "Ingested from linux-6.6.14/drivers/staging/rtl8712/rtl871x_mlme.h",
  "human_readable_source": " \n \n#ifndef __RTL871X_MLME_H_\n#define __RTL871X_MLME_H_\n\n#include \"osdep_service.h\"\n#include \"drv_types.h\"\n#include \"wlan_bssdef.h\"\n\n#define\tMAX_BSS_CNT\t64\n#define   MAX_JOIN_TIMEOUT\t6000\n\n#define\t\tSCANNING_TIMEOUT\t4500\n\n#define\tSCANQUEUE_LIFETIME 20  \n\n#define\t\tWIFI_NULL_STATE\t0x00000000\n#define\tWIFI_ASOC_STATE\t\t0x00000001\t \n#define\t\tWIFI_REASOC_STATE 0x00000002\n#define\tWIFI_SLEEP_STATE\t0x00000004\n#define\tWIFI_STATION_STATE\t0x00000008\n#define\tWIFI_AP_STATE\t\t0x00000010\n#define\tWIFI_ADHOC_STATE\t0x00000020\n#define   WIFI_ADHOC_MASTER_STATE 0x00000040\n#define   WIFI_UNDER_LINKING\t0x00000080\n#define WIFI_SITE_MONITOR\t0x00000800\t \n#define\tWIFI_MP_STATE\t\t0x00010000\n#define\tWIFI_MP_CTX_BACKGROUND\t0x00020000\t \n#define\tWIFI_MP_CTX_ST\t\t0x00040000\t \n#define\tWIFI_MP_CTX_BACKGROUND_PENDING\t0x00080000  \n#define\tWIFI_MP_CTX_CCK_HW\t0x00100000\t \n#define\tWIFI_MP_CTX_CCK_CS\t0x00200000\t \n#define   WIFI_MP_LPBK_STATE\t0x00400000\n\n#define _FW_UNDER_LINKING\tWIFI_UNDER_LINKING\n#define _FW_LINKED\t\tWIFI_ASOC_STATE\n#define _FW_UNDER_SURVEY\tWIFI_SITE_MONITOR\n\n \n\n#define traffic_threshold\t10\n#define\ttraffic_scan_period\t500\n\nstruct sitesurvey_ctrl {\n\tu64\tlast_tx_pkts;\n\tuint\tlast_rx_pkts;\n\tsint\ttraffic_busy;\n\tstruct timer_list sitesurvey_ctrl_timer;\n};\n\nstruct mlme_priv {\n\tspinlock_t lock;\n\tspinlock_t lock2;\n\tsint\tfw_state;\t \n\tu8 to_join;  \n\tu8 *nic_hdl;\n\tstruct list_head *pscanned;\n\tstruct  __queue free_bss_pool;\n\tstruct  __queue scanned_queue;\n\tu8 *free_bss_buf;\n\tunsigned long num_of_scanned;\n\tu8 passive_mode;  \n\tstruct ndis_802_11_ssid\tassoc_ssid;\n\tu8 assoc_bssid[6];\n\tstruct wlan_network cur_network;\n\tstruct sitesurvey_ctrl sitesurveyctrl;\n\tstruct timer_list assoc_timer;\n\tuint assoc_by_bssid;\n\tuint assoc_by_rssi;\n\tstruct timer_list scan_to_timer;  \n\tstruct timer_list dhcp_timer;  \n\tstruct qos_priv qospriv;\n\tstruct ht_priv\thtpriv;\n\tstruct timer_list wdg_timer;  \n};\n\nstatic inline u8 *get_bssid(struct mlme_priv *pmlmepriv)\n{\n\treturn pmlmepriv->cur_network.network.MacAddress;\n}\n\nstatic inline u8 check_fwstate(struct mlme_priv *pmlmepriv, sint state)\n{\n\tif (pmlmepriv->fw_state & state)\n\t\treturn true;\n\treturn false;\n}\n\nstatic inline sint get_fwstate(struct mlme_priv *pmlmepriv)\n{\n\treturn pmlmepriv->fw_state;\n}\n\n \nstatic inline void set_fwstate(struct mlme_priv *pmlmepriv, sint state)\n{\n\tpmlmepriv->fw_state |= state;\n}\n\nstatic inline void _clr_fwstate_(struct mlme_priv *pmlmepriv, sint state)\n{\n\tpmlmepriv->fw_state &= ~state;\n}\n\n \nstatic inline void clr_fwstate(struct mlme_priv *pmlmepriv, sint state)\n{\n\tunsigned long irqL;\n\n\tspin_lock_irqsave(&pmlmepriv->lock, irqL);\n\tif (check_fwstate(pmlmepriv, state))\n\t\tpmlmepriv->fw_state ^= state;\n\tspin_unlock_irqrestore(&pmlmepriv->lock, irqL);\n}\n\nstatic inline void set_scanned_network_val(struct mlme_priv *pmlmepriv,\n\t\t\t\t\t     sint val)\n{\n\tunsigned long irqL;\n\n\tspin_lock_irqsave(&pmlmepriv->lock, irqL);\n\tpmlmepriv->num_of_scanned = val;\n\tspin_unlock_irqrestore(&pmlmepriv->lock, irqL);\n}\n\nvoid r8712_survey_event_callback(struct _adapter *adapter, u8 *pbuf);\nvoid r8712_surveydone_event_callback(struct _adapter *adapter, u8 *pbuf);\nvoid r8712_joinbss_event_callback(struct _adapter *adapter, u8 *pbuf);\nvoid r8712_stassoc_event_callback(struct _adapter *adapter, u8 *pbuf);\nvoid r8712_stadel_event_callback(struct _adapter *adapter, u8 *pbuf);\nvoid r8712_atimdone_event_callback(struct _adapter *adapter, u8 *pbuf);\nvoid r8712_cpwm_event_callback(struct _adapter *adapter, u8 *pbuf);\nvoid r8712_wpspbc_event_callback(struct _adapter *adapter, u8 *pbuf);\nvoid r8712_free_network_queue(struct _adapter *adapter);\nint r8712_init_mlme_priv(struct _adapter *adapter);\nvoid r8712_free_mlme_priv(struct mlme_priv *pmlmepriv);\nint r8712_select_and_join_from_scan(struct mlme_priv *pmlmepriv);\nint r8712_set_key(struct _adapter *adapter,\n\t\t  struct security_priv *psecuritypriv, sint keyid);\nint r8712_set_auth(struct _adapter *adapter,\n\t\t   struct security_priv *psecuritypriv);\nuint r8712_get_wlan_bssid_ex_sz(struct wlan_bssid_ex *bss);\nvoid r8712_generate_random_ibss(u8 *pibss);\nu8 *r8712_get_capability_from_ie(u8 *ie);\nstruct wlan_network *r8712_get_oldest_wlan_network(\n\t\t\t\tstruct  __queue *scanned_queue);\nvoid r8712_free_assoc_resources(struct _adapter *adapter);\nvoid r8712_ind_disconnect(struct _adapter *adapter);\nvoid r8712_indicate_connect(struct _adapter *adapter);\nint r8712_restruct_sec_ie(struct _adapter *adapter, u8 *in_ie,\n\t\t\t  u8 *out_ie, uint in_len);\nint r8712_restruct_wmm_ie(struct _adapter *adapter, u8 *in_ie,\n\t\t\t  u8 *out_ie, uint in_len, uint initial_out_len);\nvoid r8712_init_registrypriv_dev_network(struct _adapter *adapter);\nvoid r8712_update_registrypriv_dev_network(struct _adapter *adapter);\nvoid _r8712_sitesurvey_ctrl_handler(struct _adapter *adapter);\nvoid _r8712_join_timeout_handler(struct _adapter *adapter);\nvoid r8712_scan_timeout_handler(struct _adapter *adapter);\nvoid _r8712_dhcp_timeout_handler(struct _adapter *adapter);\nstruct wlan_network *_r8712_alloc_network(struct mlme_priv *pmlmepriv);\nsint r8712_if_up(struct _adapter *padapter);\nvoid r8712_joinbss_reset(struct _adapter *padapter);\nunsigned int r8712_restructure_ht_ie(struct _adapter *padapter, u8 *in_ie,\n\t\t\t\t     u8 *out_ie, uint in_len, uint *pout_len);\nvoid r8712_issue_addbareq_cmd(struct _adapter *padapter, int priority);\nint r8712_is_same_ibss(struct _adapter *adapter, struct wlan_network *pnetwork);\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}