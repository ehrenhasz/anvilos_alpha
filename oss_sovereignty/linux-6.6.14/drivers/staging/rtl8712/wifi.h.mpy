{
  "module_name": "wifi.h",
  "hash_id": "2c04c780c3bb926ce268da450293c12deb8e4eaf449fb6fdfbcdcd4563886251",
  "original_prompt": "Ingested from linux-6.6.14/drivers/staging/rtl8712/wifi.h",
  "human_readable_source": " \n \n#ifndef _WIFI_H_\n#define _WIFI_H_\n\n#include <linux/compiler.h>\n#include <linux/ieee80211.h>\n\n#define WLAN_HDR_A3_LEN\t\t24\n#define WLAN_HDR_A3_QOS_LEN\t26\n\nenum WIFI_FRAME_TYPE {\n\tWIFI_QOS_DATA_TYPE\t= (BIT(7) | BIT(3)),\t \n};\n\n#define SetToDs(pbuf) ({ \\\n\t*(__le16 *)(pbuf) |= cpu_to_le16(IEEE80211_FCTL_TODS); \\\n})\n\n#define GetToDs(pbuf)\t(((*(__le16 *)(pbuf)) & cpu_to_le16(IEEE80211_FCTL_TODS)) != 0)\n\n#define ClearToDs(pbuf)\t({ \\\n\t*(__le16 *)(pbuf) &= (~cpu_to_le16(IEEE80211_FCTL_TODS)); \\\n})\n\n#define SetFrDs(pbuf) ({ \\\n\t*(__le16 *)(pbuf) |= cpu_to_le16(IEEE80211_FCTL_FROMDS); \\\n})\n\n#define GetFrDs(pbuf)\t(((*(__le16 *)(pbuf)) & cpu_to_le16(IEEE80211_FCTL_FROMDS)) != 0)\n\n#define ClearFrDs(pbuf)\t({ \\\n\t*(__le16 *)(pbuf) &= (~cpu_to_le16(IEEE80211_FCTL_FROMDS)); \\\n})\n\nstatic inline unsigned char get_tofr_ds(unsigned char *pframe)\n{\n\treturn ((GetToDs(pframe) << 1) | GetFrDs(pframe));\n}\n\n#define SetMFrag(pbuf) ({ \\\n\t*(__le16 *)(pbuf) |= cpu_to_le16(IEEE80211_FCTL_MOREFRAGS); \\\n})\n\n#define GetMFrag(pbuf)\t(((*(__le16 *)(pbuf)) & cpu_to_le16(IEEE80211_FCTL_MOREFRAGS)) != 0)\n\n#define ClearMFrag(pbuf) ({ \\\n\t*(__le16 *)(pbuf) &= (~cpu_to_le16(IEEE80211_FCTL_MOREFRAGS)); \\\n})\n\n#define SetRetry(pbuf) ({ \\\n\t*(__le16 *)(pbuf) |= cpu_to_le16(IEEE80211_FCTL_RETRY); \\\n})\n\n#define GetRetry(pbuf)\t(((*(__le16 *)(pbuf)) & cpu_to_le16(IEEE80211_FCTL_RETRY)) != 0)\n\n#define ClearRetry(pbuf) ({ \\\n\t*(__le16 *)(pbuf) &= (~cpu_to_le16(IEEE80211_FCTL_RETRY)); \\\n})\n\n#define SetPwrMgt(pbuf) ({ \\\n\t*(__le16 *)(pbuf) |= cpu_to_le16(IEEE80211_FCTL_PM); \\\n})\n\n#define GetPwrMgt(pbuf)\t(((*(__le16 *)(pbuf)) & \\\n\t\t\tcpu_to_le16(IEEE80211_FCTL_PM)) != 0)\n\n#define ClearPwrMgt(pbuf) ({ \\\n\t*(__le16 *)(pbuf) &= (~cpu_to_le16(IEEE80211_FCTL_PM)); \\\n})\n\n#define SetMData(pbuf) ({ \\\n\t*(__le16 *)(pbuf) |= cpu_to_le16(IEEE80211_FCTL_MOREDATA); \\\n})\n\n#define GetMData(pbuf)\t(((*(__le16 *)(pbuf)) & \\\n\t\t\tcpu_to_le16(IEEE80211_FCTL_MOREDATA)) != 0)\n\n#define ClearMData(pbuf) ({ \\\n\t*(__le16 *)(pbuf) &= (~cpu_to_le16(IEEE80211_FCTL_MOREDATA)); \\\n})\n\n#define SetPrivacy(pbuf) ({ \\\n\t*(__le16 *)(pbuf) |= cpu_to_le16(IEEE80211_FCTL_PROTECTED); \\\n})\n\n#define GetPrivacy(pbuf)\t(((*(__le16 *)(pbuf)) & \\\n\t\t\t\tcpu_to_le16(IEEE80211_FCTL_PROTECTED)) != 0)\n\n#define GetOrder(pbuf)\t(((*(__le16 *)(pbuf)) & \\\n\t\t\tcpu_to_le16(IEEE80211_FCTL_ORDER)) != 0)\n\n#define GetFrameType(pbuf)\t(le16_to_cpu(*(__le16 *)(pbuf)) & \\\n\t\t\t\t(BIT(3) | BIT(2)))\n\n#define SetFrameType(pbuf, type)\t\\\n\tdo {\t\\\n\t\t*(__le16 *)(pbuf) &= cpu_to_le16(~(BIT(3) | \\\n\t\tBIT(2))); \\\n\t\t*(__le16 *)(pbuf) |= cpu_to_le16(type); \\\n\t} while (0)\n\n#define GetFrameSubType(pbuf)\t(le16_to_cpu(*(__le16 *)(pbuf)) & \\\n\t\t\t\t(BIT(7) | BIT(6) | BIT(5) | BIT(4) | BIT(3) | \\\n\t\t\t\tBIT(2)))\n\n#define SetFrameSubType(pbuf, type) \\\n\tdo {    \\\n\t\t*(__le16 *)(pbuf) &= cpu_to_le16(~(BIT(7) | BIT(6) | \\\n\t\tBIT(5) | BIT(4) | BIT(3) | BIT(2))); \\\n\t\t*(__le16 *)(pbuf) |= cpu_to_le16(type); \\\n\t} while (0)\n\n#define GetSequence(pbuf)\t(le16_to_cpu(*(__le16 *)\\\n\t\t\t\t((addr_t)(pbuf) + 22)) >> 4)\n\n#define GetFragNum(pbuf)\t(le16_to_cpu(*(__le16 *)((addr_t)\\\n\t\t\t\t(pbuf) + 22)) & 0x0f)\n\n#define SetSeqNum(pbuf, num) ({ \\\n\t*(__le16 *)((addr_t)(pbuf) + 22) = \\\n\tcpu_to_le16((le16_to_cpu(*(__le16 *)((addr_t)(pbuf) + 22)) & \\\n\t0x000f) | (0xfff0 & (num << 4))); \\\n})\n\n#define SetPriority(pbuf, tid) ({ \\\n\t*(__le16 *)(pbuf) |= cpu_to_le16(tid & 0xf); \\\n})\n\n#define GetPriority(pbuf)\t((le16_to_cpu(*(__le16 *)(pbuf))) & 0xf)\n\n#define SetAckpolicy(pbuf, ack) ({ \\\n\t*(__le16 *)(pbuf) |= cpu_to_le16((ack & 3) << 5); \\\n})\n\n#define GetAckpolicy(pbuf) (((le16_to_cpu(*(__le16 *)pbuf)) >> 5) & 0x3)\n\n#define GetAMsdu(pbuf) (((le16_to_cpu(*(__le16 *)pbuf)) >> 7) & 0x1)\n\n#define GetAddr1Ptr(pbuf)\t((unsigned char *)((addr_t)(pbuf) + 4))\n\n#define GetAddr2Ptr(pbuf)\t((unsigned char *)((addr_t)(pbuf) + 10))\n\n#define GetAddr3Ptr(pbuf)\t((unsigned char *)((addr_t)(pbuf) + 16))\n\n#define GetAddr4Ptr(pbuf)\t((unsigned char *)((addr_t)(pbuf) + 24))\n\nstatic inline unsigned char *get_hdr_bssid(unsigned char *pframe)\n{\n\tunsigned char\t*sa;\n\tunsigned int\tto_fr_ds = (GetToDs(pframe) << 1) | GetFrDs(pframe);\n\n\tswitch (to_fr_ds) {\n\tcase 0x00:\t \n\t\tsa = GetAddr3Ptr(pframe);\n\t\tbreak;\n\tcase 0x01:\t \n\t\tsa = GetAddr2Ptr(pframe);\n\t\tbreak;\n\tcase 0x02:\t \n\t\tsa = GetAddr1Ptr(pframe);\n\t\tbreak;\n\tdefault:\t \n\t\tsa = NULL;\n\t\tbreak;\n\t}\n\treturn sa;\n}\n\n \n#define _BEACON_ITERVAL_\t\t2\n#define _CAPABILITY_\t\t\t2\n#define _TIMESTAMP_\t\t\t\t8\n\n \n#define _WMM_IE_Length_\t\t\t\t7   \n\n#endif  \n\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}