{
  "module_name": "rkvdec.h",
  "hash_id": "6a24c6ba7e2b057db1a5bb1de5e68d5b5d618babe117b17cc6c640685ae018d3",
  "original_prompt": "Ingested from linux-6.6.14/drivers/staging/media/rkvdec/rkvdec.h",
  "human_readable_source": " \n \n#ifndef RKVDEC_H_\n#define RKVDEC_H_\n\n#include <linux/platform_device.h>\n#include <linux/videodev2.h>\n#include <linux/wait.h>\n#include <linux/clk.h>\n\n#include <media/v4l2-ctrls.h>\n#include <media/v4l2-device.h>\n#include <media/v4l2-ioctl.h>\n#include <media/videobuf2-core.h>\n#include <media/videobuf2-dma-contig.h>\n\nstruct rkvdec_ctx;\n\nstruct rkvdec_ctrl_desc {\n\tstruct v4l2_ctrl_config cfg;\n};\n\nstruct rkvdec_ctrls {\n\tconst struct rkvdec_ctrl_desc *ctrls;\n\tunsigned int num_ctrls;\n};\n\nstruct rkvdec_run {\n\tstruct {\n\t\tstruct vb2_v4l2_buffer *src;\n\t\tstruct vb2_v4l2_buffer *dst;\n\t} bufs;\n};\n\nstruct rkvdec_vp9_decoded_buffer_info {\n\t \n\tunsigned short width;\n\tunsigned short height;\n\tunsigned int bit_depth : 4;\n};\n\nstruct rkvdec_decoded_buffer {\n\t \n\tstruct v4l2_m2m_buffer base;\n\n\tunion {\n\t\tstruct rkvdec_vp9_decoded_buffer_info vp9;\n\t};\n};\n\nstatic inline struct rkvdec_decoded_buffer *\nvb2_to_rkvdec_decoded_buf(struct vb2_buffer *buf)\n{\n\treturn container_of(buf, struct rkvdec_decoded_buffer,\n\t\t\t    base.vb.vb2_buf);\n}\n\nstruct rkvdec_coded_fmt_ops {\n\tint (*adjust_fmt)(struct rkvdec_ctx *ctx,\n\t\t\t  struct v4l2_format *f);\n\tint (*start)(struct rkvdec_ctx *ctx);\n\tvoid (*stop)(struct rkvdec_ctx *ctx);\n\tint (*run)(struct rkvdec_ctx *ctx);\n\tvoid (*done)(struct rkvdec_ctx *ctx, struct vb2_v4l2_buffer *src_buf,\n\t\t     struct vb2_v4l2_buffer *dst_buf,\n\t\t     enum vb2_buffer_state result);\n\tint (*try_ctrl)(struct rkvdec_ctx *ctx, struct v4l2_ctrl *ctrl);\n};\n\nstruct rkvdec_coded_fmt_desc {\n\tu32 fourcc;\n\tstruct v4l2_frmsize_stepwise frmsize;\n\tconst struct rkvdec_ctrls *ctrls;\n\tconst struct rkvdec_coded_fmt_ops *ops;\n\tunsigned int num_decoded_fmts;\n\tconst u32 *decoded_fmts;\n\tu32 subsystem_flags;\n};\n\nstruct rkvdec_dev {\n\tstruct v4l2_device v4l2_dev;\n\tstruct media_device mdev;\n\tstruct video_device vdev;\n\tstruct v4l2_m2m_dev *m2m_dev;\n\tstruct device *dev;\n\tstruct clk_bulk_data *clocks;\n\tvoid __iomem *regs;\n\tstruct mutex vdev_lock;  \n\tstruct delayed_work watchdog_work;\n};\n\nstruct rkvdec_ctx {\n\tstruct v4l2_fh fh;\n\tstruct v4l2_format coded_fmt;\n\tstruct v4l2_format decoded_fmt;\n\tconst struct rkvdec_coded_fmt_desc *coded_fmt_desc;\n\tstruct v4l2_ctrl_handler ctrl_hdl;\n\tstruct rkvdec_dev *dev;\n\tvoid *priv;\n};\n\nstatic inline struct rkvdec_ctx *fh_to_rkvdec_ctx(struct v4l2_fh *fh)\n{\n\treturn container_of(fh, struct rkvdec_ctx, fh);\n}\n\nstruct rkvdec_aux_buf {\n\tvoid *cpu;\n\tdma_addr_t dma;\n\tsize_t size;\n};\n\nvoid rkvdec_run_preamble(struct rkvdec_ctx *ctx, struct rkvdec_run *run);\nvoid rkvdec_run_postamble(struct rkvdec_ctx *ctx, struct rkvdec_run *run);\n\nextern const struct rkvdec_coded_fmt_ops rkvdec_h264_fmt_ops;\nextern const struct rkvdec_coded_fmt_ops rkvdec_vp9_fmt_ops;\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}