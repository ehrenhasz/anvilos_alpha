{
  "module_name": "ia_css_eed1_8.host.c",
  "hash_id": "b95cf2ec35d40cf117ceb4a660d1fda433e0fb1098aba3c282e29e1b4efc1aa0",
  "original_prompt": "Ingested from linux-6.6.14/drivers/staging/media/atomisp/pci/isp/kernels/eed1_8/ia_css_eed1_8.host.c",
  "human_readable_source": "\n \n\n#ifndef IA_CSS_NO_DEBUG\n#include \"ia_css_debug.h\"\n#endif\n\n#include \"type_support.h\"\n#include \"assert_support.h\"\n#include \"math_support.h\"  \n\n#include \"ia_css_eed1_8.host.h\"\n\n \n#define NUMBER_OF_CHGRINV_POINTS 15\n#define NUMBER_OF_TCINV_POINTS 9\n#define NUMBER_OF_FCINV_POINTS 9\n\nstatic const s16 chgrinv_x[NUMBER_OF_CHGRINV_POINTS] = {\n\t0, 16, 64, 144, 272, 448, 672, 976,\n\t1376, 1888, 2528, 3312, 4256, 5376, 6688\n};\n\nstatic const s16 chgrinv_a[NUMBER_OF_CHGRINV_POINTS] = {\n\t-7171, -256, -29, -3456, -1071, -475, -189, -102,\n\t    -48, -38, -10, -9, -7, -6, 0\n    };\n\nstatic const s16 chgrinv_b[NUMBER_OF_CHGRINV_POINTS] = {\n\t8191, 1021, 256, 114, 60, 37, 24, 17,\n\t12, 9, 6, 5, 4, 3, 2\n};\n\nstatic const s16 chgrinv_c[NUMBER_OF_CHGRINV_POINTS] = {\n\t1, 1, 1, 0, 0, 0, 0, 0,\n\t0, 0, 0, 0, 0, 0, 0\n};\n\nstatic const s16 tcinv_x[NUMBER_OF_TCINV_POINTS] = {\n\t0, 4, 11, 23, 42, 68, 102, 148, 205\n};\n\nstatic const s16 tcinv_a[NUMBER_OF_TCINV_POINTS] = {\n\t-6364, -631, -126, -34, -13, -6, -4452, -2156, 0\n    };\n\nstatic const s16 tcinv_b[NUMBER_OF_TCINV_POINTS] = {\n\t8191, 1828, 726, 352, 197, 121, 80, 55, 40\n};\n\nstatic const s16 tcinv_c[NUMBER_OF_TCINV_POINTS] = {\n\t1, 1, 1, 1, 1, 1, 0, 0, 0\n};\n\nstatic const s16 fcinv_x[NUMBER_OF_FCINV_POINTS] = {\n\t0, 80, 216, 456, 824, 1344, 2040, 2952, 4096\n};\n\nstatic const s16 fcinv_a[NUMBER_OF_FCINV_POINTS] = {\n\t-5244, -486, -86, -2849, -961, -400, -180, -86, 0\n    };\n\nstatic const s16 fcinv_b[NUMBER_OF_FCINV_POINTS] = {\n\t8191, 1637, 607, 287, 159, 98, 64, 44, 32\n};\n\nstatic const s16 fcinv_c[NUMBER_OF_FCINV_POINTS] = {\n\t1, 1, 1, 0, 0, 0, 0, 0, 0\n};\n\nvoid\nia_css_eed1_8_vmem_encode(\n    struct eed1_8_vmem_params *to,\n    const struct ia_css_eed1_8_config *from,\n    size_t size)\n{\n\tunsigned int i, j, base;\n\tconst unsigned int total_blocks = 4;\n\tconst unsigned int shuffle_block = 16;\n\n\t(void)size;\n\n\t \n\tfor (i = 0; i < ISP_VEC_NELEMS; i++) {\n\t\tto->e_dew_enh_x[0][i] = 0;\n\t\tto->e_dew_enh_y[0][i] = 0;\n\t\tto->e_dew_enh_a[0][i] = 0;\n\t\tto->e_dew_enh_f[0][i] = 0;\n\t\tto->chgrinv_x[0][i] = 0;\n\t\tto->chgrinv_a[0][i] = 0;\n\t\tto->chgrinv_b[0][i] = 0;\n\t\tto->chgrinv_c[0][i] = 0;\n\t\tto->tcinv_x[0][i] = 0;\n\t\tto->tcinv_a[0][i] = 0;\n\t\tto->tcinv_b[0][i] = 0;\n\t\tto->tcinv_c[0][i] = 0;\n\t\tto->fcinv_x[0][i] = 0;\n\t\tto->fcinv_a[0][i] = 0;\n\t\tto->fcinv_b[0][i] = 0;\n\t\tto->fcinv_c[0][i] = 0;\n\t}\n\n\t \n\n\t \n\t \n\tfor (j = 0; j < IA_CSS_NUMBER_OF_DEW_ENHANCE_SEGMENTS; j++) {\n\t\tassert(from->dew_enhance_seg_x[j] > -1);\n\t\tassert(from->dew_enhance_seg_y[j] > -1);\n\t}\n\n\tfor (j = 1; j < IA_CSS_NUMBER_OF_DEW_ENHANCE_SEGMENTS; j++) {\n\t\tassert(from->dew_enhance_seg_x[j] > from->dew_enhance_seg_x[j - 1]);\n\t\tassert(from->dew_enhance_seg_y[j] > from->dew_enhance_seg_y[j - 1]);\n\t}\n\n\tassert(from->dew_enhance_seg_x[0] == 0);\n\tassert(from->dew_enhance_seg_y[0] == 0);\n\n\t \n\tassert(chgrinv_x[0] == 0);\n\tassert(tcinv_x[0] == 0);\n\tassert(fcinv_x[0] == 0);\n\n\tfor (j = 1; j < NUMBER_OF_CHGRINV_POINTS; j++) {\n\t\tassert(chgrinv_x[j] > chgrinv_x[j - 1]);\n\t}\n\n\tfor (j = 1; j < NUMBER_OF_TCINV_POINTS; j++) {\n\t\tassert(tcinv_x[j] > tcinv_x[j - 1]);\n\t}\n\n\tfor (j = 1; j < NUMBER_OF_FCINV_POINTS; j++) {\n\t\tassert(fcinv_x[j] > fcinv_x[j - 1]);\n\t}\n\n\t \n\t \n\tfor (i = 0; i < total_blocks; i++) {\n\t\tbase = shuffle_block * i;\n\n\t\tfor (j = 0; j < IA_CSS_NUMBER_OF_DEW_ENHANCE_SEGMENTS; j++) {\n\t\t\tto->e_dew_enh_x[0][base + j] = min_t(int, max_t(int,\n\t\t\t\t\t\t\t     from->dew_enhance_seg_x[j], 0),\n\t\t\t\t\t\t\t     8191);\n\t\t\tto->e_dew_enh_y[0][base + j] = min_t(int, max_t(int,\n\t\t\t\t\t\t\t     from->dew_enhance_seg_y[j], -8192),\n\t\t\t\t\t\t\t     8191);\n\t\t}\n\n\t\tfor (j = 0; j < (IA_CSS_NUMBER_OF_DEW_ENHANCE_SEGMENTS - 1); j++) {\n\t\t\tto->e_dew_enh_a[0][base + j] = min_t(int, max_t(int,\n\t\t\t\t\t\t\t     from->dew_enhance_seg_slope[j],\n\t\t\t\t\t\t\t     -8192), 8191);\n\t\t\t \n\t\t\tto->e_dew_enh_f[0][base + j] = (min_t(int, max_t(int,\n\t\t\t\t\t\t\t      from->dew_enhance_seg_exp[j],\n\t\t\t\t\t\t\t      0), 13) > 0);\n\t\t}\n\n\t\t \n\t\tto->e_dew_enh_a[0][base + (IA_CSS_NUMBER_OF_DEW_ENHANCE_SEGMENTS - 1)] = 0;\n\t\tto->e_dew_enh_f[0][base + (IA_CSS_NUMBER_OF_DEW_ENHANCE_SEGMENTS - 1)] = 0;\n\n\t\tfor (j = 0; j < NUMBER_OF_CHGRINV_POINTS; j++) {\n\t\t\tto->chgrinv_x[0][base + j] = chgrinv_x[j];\n\t\t\tto->chgrinv_a[0][base + j] = chgrinv_a[j];\n\t\t\tto->chgrinv_b[0][base + j] = chgrinv_b[j];\n\t\t\tto->chgrinv_c[0][base + j] = chgrinv_c[j];\n\t\t}\n\n\t\tfor (j = 0; j < NUMBER_OF_TCINV_POINTS; j++) {\n\t\t\tto->tcinv_x[0][base + j] = tcinv_x[j];\n\t\t\tto->tcinv_a[0][base + j] = tcinv_a[j];\n\t\t\tto->tcinv_b[0][base + j] = tcinv_b[j];\n\t\t\tto->tcinv_c[0][base + j] = tcinv_c[j];\n\t\t}\n\n\t\tfor (j = 0; j < NUMBER_OF_FCINV_POINTS; j++) {\n\t\t\tto->fcinv_x[0][base + j] = fcinv_x[j];\n\t\t\tto->fcinv_a[0][base + j] = fcinv_a[j];\n\t\t\tto->fcinv_b[0][base + j] = fcinv_b[j];\n\t\t\tto->fcinv_c[0][base + j] = fcinv_c[j];\n\t\t}\n\t}\n}\n\nvoid\nia_css_eed1_8_encode(\n    struct eed1_8_dmem_params *to,\n    const struct ia_css_eed1_8_config *from,\n    size_t size)\n{\n\tint i;\n\tint min_exp = 0;\n\n\t(void)size;\n\n\tto->rbzp_strength = from->rbzp_strength;\n\n\tto->fcstrength = from->fcstrength;\n\tto->fcthres_0 = from->fcthres_0;\n\tto->fc_sat_coef = from->fc_sat_coef;\n\tto->fc_coring_prm = from->fc_coring_prm;\n\tto->fc_slope = from->fcthres_1 - from->fcthres_0;\n\n\tto->aerel_thres0 = from->aerel_thres0;\n\tto->aerel_gain0 = from->aerel_gain0;\n\tto->aerel_thres_diff = from->aerel_thres1 - from->aerel_thres0;\n\tto->aerel_gain_diff = from->aerel_gain1 - from->aerel_gain0;\n\n\tto->derel_thres0 = from->derel_thres0;\n\tto->derel_gain0 = from->derel_gain0;\n\tto->derel_thres_diff = (from->derel_thres1 - from->derel_thres0);\n\tto->derel_gain_diff = (from->derel_gain1 - from->derel_gain0);\n\n\tto->coring_pos0 = from->coring_pos0;\n\tto->coring_pos_diff = (from->coring_pos1 - from->coring_pos0);\n\tto->coring_neg0 = from->coring_neg0;\n\tto->coring_neg_diff = (from->coring_neg1 - from->coring_neg0);\n\n\t \n\tto->gain_exp = (13 - from->gain_exp);\n\tto->gain_pos0 = from->gain_pos0;\n\tto->gain_pos_diff = (from->gain_pos1 - from->gain_pos0);\n\tto->gain_neg0 = from->gain_neg0;\n\tto->gain_neg_diff = (from->gain_neg1 - from->gain_neg0);\n\n\tto->margin_pos0 = from->pos_margin0;\n\tto->margin_pos_diff = (from->pos_margin1 - from->pos_margin0);\n\tto->margin_neg0 = from->neg_margin0;\n\tto->margin_neg_diff = (from->neg_margin1 - from->neg_margin0);\n\n\t \n\tfor (i = 0; i < (IA_CSS_NUMBER_OF_DEW_ENHANCE_SEGMENTS - 1); i++) {\n\t\tmin_exp = max(min_exp, from->dew_enhance_seg_exp[i]);\n\t}\n\tto->e_dew_enh_asr = 13 - min(max(min_exp, 0), 13);\n\n\tto->dedgew_max = from->dedgew_max;\n}\n\nvoid\nia_css_init_eed1_8_state(\n    void *state,\n    size_t size)\n{\n\tmemset(state, 0, size);\n}\n\n#ifndef IA_CSS_NO_DEBUG\nvoid\nia_css_eed1_8_debug_dtrace(\n    const struct ia_css_eed1_8_config *eed,\n    unsigned int level)\n{\n\tif (!eed)\n\t\treturn;\n\n\tia_css_debug_dtrace(level, \"Edge Enhancing Demosaic 1.8:\\n\");\n\tia_css_debug_dtrace(level, \"\\t%-32s = %d\\n\", \"rbzp_strength\",\n\t\t\t    eed->rbzp_strength);\n\tia_css_debug_dtrace(level, \"\\t%-32s = %d\\n\", \"fcstrength\", eed->fcstrength);\n\tia_css_debug_dtrace(level, \"\\t%-32s = %d\\n\", \"fcthres_0\", eed->fcthres_0);\n\tia_css_debug_dtrace(level, \"\\t%-32s = %d\\n\", \"fcthres_1\", eed->fcthres_1);\n\tia_css_debug_dtrace(level, \"\\t%-32s = %d\\n\", \"fc_sat_coef\", eed->fc_sat_coef);\n\tia_css_debug_dtrace(level, \"\\t%-32s = %d\\n\", \"fc_coring_prm\",\n\t\t\t    eed->fc_coring_prm);\n\n\tia_css_debug_dtrace(level, \"\\t%-32s = %d\\n\", \"aerel_thres0\", eed->aerel_thres0);\n\tia_css_debug_dtrace(level, \"\\t%-32s = %d\\n\", \"aerel_gain0\", eed->aerel_gain0);\n\tia_css_debug_dtrace(level, \"\\t%-32s = %d\\n\", \"aerel_thres1\", eed->aerel_thres1);\n\tia_css_debug_dtrace(level, \"\\t%-32s = %d\\n\", \"aerel_gain1\", eed->aerel_gain1);\n\n\tia_css_debug_dtrace(level, \"\\t%-32s = %d\\n\", \"derel_thres0\", eed->derel_thres0);\n\tia_css_debug_dtrace(level, \"\\t%-32s = %d\\n\", \"derel_gain0\", eed->derel_gain0);\n\tia_css_debug_dtrace(level, \"\\t%-32s = %d\\n\", \"derel_thres1\", eed->derel_thres1);\n\tia_css_debug_dtrace(level, \"\\t%-32s = %d\\n\", \"derel_gain1\", eed->derel_gain1);\n\n\tia_css_debug_dtrace(level, \"\\t%-32s = %d\\n\", \"coring_pos0\", eed->coring_pos0);\n\tia_css_debug_dtrace(level, \"\\t%-32s = %d\\n\", \"coring_pos1\", eed->coring_pos1);\n\tia_css_debug_dtrace(level, \"\\t%-32s = %d\\n\", \"coring_neg0\", eed->coring_neg0);\n\tia_css_debug_dtrace(level, \"\\t%-32s = %d\\n\", \"coring_neg1\", eed->coring_neg1);\n\n\tia_css_debug_dtrace(level, \"\\t%-32s = %d\\n\", \"gain_exp\", eed->gain_exp);\n\tia_css_debug_dtrace(level, \"\\t%-32s = %d\\n\", \"gain_pos0\", eed->gain_pos0);\n\tia_css_debug_dtrace(level, \"\\t%-32s = %d\\n\", \"gain_pos1\", eed->gain_pos1);\n\tia_css_debug_dtrace(level, \"\\t%-32s = %d\\n\", \"gain_neg0\", eed->gain_neg0);\n\tia_css_debug_dtrace(level, \"\\t%-32s = %d\\n\", \"gain_neg1\", eed->gain_neg1);\n\n\tia_css_debug_dtrace(level, \"\\t%-32s = %d\\n\", \"pos_margin0\", eed->pos_margin0);\n\tia_css_debug_dtrace(level, \"\\t%-32s = %d\\n\", \"pos_margin1\", eed->pos_margin1);\n\tia_css_debug_dtrace(level, \"\\t%-32s = %d\\n\", \"neg_margin0\", eed->neg_margin0);\n\tia_css_debug_dtrace(level, \"\\t%-32s = %d\\n\", \"neg_margin1\", eed->neg_margin1);\n\n\tia_css_debug_dtrace(level, \"\\t%-32s = %d\\n\", \"dedgew_max\", eed->dedgew_max);\n}\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}