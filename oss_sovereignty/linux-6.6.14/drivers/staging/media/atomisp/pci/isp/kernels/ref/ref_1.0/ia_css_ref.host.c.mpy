{
  "module_name": "ia_css_ref.host.c",
  "hash_id": "468fbf06a07dc8a9e41aefa1931ce96a76b3cf4f6c8a7c76d6ab8f516b58677b",
  "original_prompt": "Ingested from linux-6.6.14/drivers/staging/media/atomisp/pci/isp/kernels/ref/ref_1.0/ia_css_ref.host.c",
  "human_readable_source": "\n \n\n#include <assert_support.h>\n#include <ia_css_frame_public.h>\n#include <ia_css_frame.h>\n#include <ia_css_binary.h>\n#define IA_CSS_INCLUDE_CONFIGURATIONS\n#include \"ia_css_isp_configs.h\"\n#include \"isp.h\"\n#include \"ia_css_ref.host.h\"\n\nint ia_css_ref_config(struct sh_css_isp_ref_isp_config *to,\n\t\t      const struct ia_css_ref_configuration  *from,\n\t\t      unsigned int size)\n{\n\tunsigned int elems_a = ISP_VEC_NELEMS, i;\n\tint ret;\n\n\tif (from->ref_frames[0]) {\n\t\tret = ia_css_dma_configure_from_info(&to->port_b, &from->ref_frames[0]->frame_info);\n\t\tif (ret)\n\t\t\treturn ret;\n\t\tto->width_a_over_b = elems_a / to->port_b.elems;\n\t\tto->dvs_frame_delay = from->dvs_frame_delay;\n\t} else {\n\t\tto->width_a_over_b = 1;\n\t\tto->dvs_frame_delay = 0;\n\t\tto->port_b.elems = elems_a;\n\t}\n\tfor (i = 0; i < MAX_NUM_VIDEO_DELAY_FRAMES; i++) {\n\t\tif (from->ref_frames[i]) {\n\t\t\tto->ref_frame_addr_y[i] = from->ref_frames[i]->data +\n\t\t\t\t\t\t  from->ref_frames[i]->planes.yuv.y.offset;\n\t\t\tto->ref_frame_addr_c[i] = from->ref_frames[i]->data +\n\t\t\t\t\t\t  from->ref_frames[i]->planes.yuv.u.offset;\n\t\t} else {\n\t\t\tto->ref_frame_addr_y[i] = 0;\n\t\t\tto->ref_frame_addr_c[i] = 0;\n\t\t}\n\t}\n\n\t \n\tif (elems_a % to->port_b.elems != 0)\n\t\treturn -EINVAL;\n\n\treturn 0;\n}\n\nint ia_css_ref_configure(const struct ia_css_binary        *binary,\n\t\t\t const struct ia_css_frame * const *ref_frames,\n\t\t\t const uint32_t dvs_frame_delay)\n{\n\tstruct ia_css_ref_configuration config;\n\tunsigned int i;\n\n\tfor (i = 0; i < MAX_NUM_VIDEO_DELAY_FRAMES; i++)\n\t\tconfig.ref_frames[i] = ref_frames[i];\n\n\tconfig.dvs_frame_delay = dvs_frame_delay;\n\n\treturn ia_css_configure_ref(binary, &config);\n}\n\nvoid\nia_css_init_ref_state(\n    struct sh_css_isp_ref_dmem_state *state,\n    unsigned int size)\n{\n\t(void)size;\n\tassert(MAX_NUM_VIDEO_DELAY_FRAMES >= 2);\n\tstate->ref_in_buf_idx = 0;\n\tstate->ref_out_buf_idx = 1;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}