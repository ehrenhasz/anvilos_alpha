{
  "module_name": "sh_css_defs.h",
  "hash_id": "95e2b03ff381abd14b118342263855707e298e05c64905d59254e51ea4b6f4f0",
  "original_prompt": "Ingested from linux-6.6.14/drivers/staging/media/atomisp/pci/sh_css_defs.h",
  "human_readable_source": " \n \n\n#ifndef _SH_CSS_DEFS_H_\n#define _SH_CSS_DEFS_H_\n\n#include \"isp.h\"\n\n   \n\n#include \"math_support.h\"\t \n\n \n#define IA_CSS_REFCOUNT_PARAM_SET_POOL  0xCAFE0001\n#define IA_CSS_REFCOUNT_PARAM_BUFFER    0xCAFE0002\n\n \n#define SH_CSS_DIS_DECI_FACTOR_LOG2       6\n\n \n#define SH_CSS_UV_OFFSET_IS_0             0\n\n \n#define SH_CSS_BAYER_BITS                 13\n\n \n#define SH_CSS_BAYER_MAXVAL               ((1U << SH_CSS_BAYER_BITS) - 1)\n\n \n#define SH_CSS_ISP_YUV_BITS               8\n\n#define SH_CSS_DP_GAIN_SHIFT              5\n#define SH_CSS_BNR_GAIN_SHIFT             13\n#define SH_CSS_YNR_GAIN_SHIFT             13\n#define SH_CSS_AE_YCOEF_SHIFT             13\n#define SH_CSS_AF_FIR_SHIFT               13\n#define SH_CSS_YEE_DETAIL_GAIN_SHIFT      8   \n#define SH_CSS_YEE_SCALE_SHIFT            8\n#define SH_CSS_TNR_COEF_SHIFT             13\n#define SH_CSS_MACC_COEF_SHIFT            11  \n#define SH_CSS_MACC2_COEF_SHIFT           13  \n#define SH_CSS_DIS_COEF_SHIFT             13\n\n \n#define SH_CSS_BDS_FACTOR_1_00\t(0)\n#define SH_CSS_BDS_FACTOR_1_25\t(1)\n#define SH_CSS_BDS_FACTOR_1_50\t(2)\n#define SH_CSS_BDS_FACTOR_2_00\t(3)\n#define SH_CSS_BDS_FACTOR_2_25\t(4)\n#define SH_CSS_BDS_FACTOR_2_50\t(5)\n#define SH_CSS_BDS_FACTOR_3_00\t(6)\n#define SH_CSS_BDS_FACTOR_4_00\t(7)\n#define SH_CSS_BDS_FACTOR_4_50\t(8)\n#define SH_CSS_BDS_FACTOR_5_00\t(9)\n#define SH_CSS_BDS_FACTOR_6_00\t(10)\n#define SH_CSS_BDS_FACTOR_8_00\t(11)\n#define NUM_BDS_FACTORS\t\t(12)\n\n#define PACK_BDS_FACTOR(factor)\t(1 << (factor))\n\n \n#define SH_CSS_ISP_PIPE_VERSION_1\t1\n#define SH_CSS_ISP_PIPE_VERSION_2_2\t2\n#define SH_CSS_ISP_PIPE_VERSION_2_6_1\t3\n#define SH_CSS_ISP_PIPE_VERSION_2_7\t4\n\n \n \n#define SH_CSS_RGB_GAMMA_INPUT_BITS       12  \n#define SH_CSS_RGB_GAMMA_OUTPUT_BITS      13  \n\n \n#define SH_CSS_RGB_GAMMA_FRAC_BITS        \\\n\t(SH_CSS_RGB_GAMMA_INPUT_BITS - SH_CSS_ISP_RGB_GAMMA_TABLE_SIZE_LOG2)\n#define SH_CSS_RGB_GAMMA_ONE              BIT(SH_CSS_RGB_GAMMA_FRAC_BITS)\n\n \n#define SH_CSS_YUV2RGB_CCM_INPUT_BITS     SH_CSS_BAYER_BITS\n\n \n#define SH_CSS_YUV2RGB_CCM_OUTPUT_BITS    SH_CSS_RGB_GAMMA_INPUT_BITS\n\n \n#define SH_CSS_YUV2RGB_CCM_MAX_OUTPUT     \\\n\t((1 << SH_CSS_YUV2RGB_CCM_OUTPUT_BITS) - 1)\n\n#define SH_CSS_NUM_INPUT_BUF_LINES        4\n\n \n#define SH_CSS_MAX_LEFT_CROPPING          12\n#define SH_CSS_MAX_TOP_CROPPING           12\n\n#define\tSH_CSS_SP_MAX_WIDTH               1280\n\n \n#define SH_CSS_MAX_BQ_GRID_WIDTH          80\n#define SH_CSS_MAX_BQ_GRID_HEIGHT         60\n\n \n#define SH_CSS_MIN_DVS_ENVELOPE           12U\n\n \n#define SH_CSS_MAX_SENSOR_WIDTH           4608\n#define SH_CSS_MAX_SENSOR_HEIGHT          3450\n\n \n#if ISP_VMEM_DEPTH >= 3072\n#define SH_CSS_MAX_CONTINUOUS_SENSOR_WIDTH  SH_CSS_MAX_SENSOR_WIDTH\n#define SH_CSS_MAX_CONTINUOUS_SENSOR_HEIGHT SH_CSS_MAX_SENSOR_HEIGHT\n#else\n#define SH_CSS_MAX_CONTINUOUS_SENSOR_WIDTH  3264\n#define SH_CSS_MAX_CONTINUOUS_SENSOR_HEIGHT 2448\n#endif\n \n \n#define SH_CSS_MAX_CONTINUOUS_SENSOR_WIDTH_DEC  SH_CSS_MAX_SENSOR_WIDTH\n#define SH_CSS_MAX_CONTINUOUS_SENSOR_HEIGHT_DEC SH_CSS_MAX_SENSOR_HEIGHT\n\n#define SH_CSS_MIN_SENSOR_WIDTH           2\n#define SH_CSS_MIN_SENSOR_HEIGHT          2\n\n \n#define SH_CSS_MAX_VF_WIDTH_DEC               SH_CSS_MAX_VF_WIDTH\n#define SH_CSS_MAX_VF_HEIGHT_DEC              SH_CSS_MAX_VF_HEIGHT\n\n \n#define SH_CSS_MORPH_TABLE_GRID               ISP_VEC_NELEMS\n#define SH_CSS_MORPH_TABLE_ELEM_BYTES         2\n#define SH_CSS_MORPH_TABLE_ELEMS_PER_DDR_WORD \\\n\t(HIVE_ISP_DDR_WORD_BYTES / SH_CSS_MORPH_TABLE_ELEM_BYTES)\n\n#define SH_CSS_MAX_SCTBL_WIDTH_PER_COLOR   (SH_CSS_MAX_BQ_GRID_WIDTH + 1)\n#define SH_CSS_MAX_SCTBL_HEIGHT_PER_COLOR   (SH_CSS_MAX_BQ_GRID_HEIGHT + 1)\n\n#define SH_CSS_MAX_SCTBL_ALIGNED_WIDTH_PER_COLOR \\\n\tCEIL_MUL(SH_CSS_MAX_SCTBL_WIDTH_PER_COLOR, ISP_VEC_NELEMS)\n\n \n#define SH_CSS_MAX_S3ATBL_WIDTH              SH_CSS_MAX_BQ_GRID_WIDTH\n\n \n \n#define MAX_DVS_FRAME_DELAY\t\t2\n \n#define MAX_NUM_VIDEO_DELAY_FRAMES\t(MAX_DVS_FRAME_DELAY + 1)\n\n#define NUM_VIDEO_TNR_FRAMES\t\t2\n\n \n \n \n#define _ISP_BQS(num)  ((num) / 2)\n#define _ISP_VECS(width) CEIL_DIV(width, ISP_VEC_NELEMS)\n\n#define ISP_BQ_GRID_WIDTH(elements_per_line, deci_factor_log2) \\\n\tCEIL_SHIFT(elements_per_line / 2,  deci_factor_log2)\n#define ISP_BQ_GRID_HEIGHT(lines_per_frame, deci_factor_log2) \\\n\tCEIL_SHIFT(lines_per_frame / 2,  deci_factor_log2)\n#define ISP_C_VECTORS_PER_LINE(elements_per_line) \\\n\t_ISP_VECS(elements_per_line / 2)\n\n \n#define _ISP_MORPH_TABLE_WIDTH(int_width) \\\n\t(CEIL_DIV(int_width, SH_CSS_MORPH_TABLE_GRID) + 1)\n#define _ISP_MORPH_TABLE_HEIGHT(int_height) \\\n\t(CEIL_DIV(int_height, SH_CSS_MORPH_TABLE_GRID) + 1)\n#define _ISP_MORPH_TABLE_ALIGNED_WIDTH(width) \\\n\tCEIL_MUL(_ISP_MORPH_TABLE_WIDTH(width), \\\n\t\t SH_CSS_MORPH_TABLE_ELEMS_PER_DDR_WORD)\n\n#define _ISP_SCTBL_WIDTH_PER_COLOR(input_width, deci_factor_log2) \\\n\t(ISP_BQ_GRID_WIDTH(input_width, deci_factor_log2) + 1)\n#define _ISP_SCTBL_HEIGHT(input_height, deci_factor_log2) \\\n\t(ISP_BQ_GRID_HEIGHT(input_height, deci_factor_log2) + 1)\n#define _ISP_SCTBL_ALIGNED_WIDTH_PER_COLOR(input_width, deci_factor_log2) \\\n\tCEIL_MUL(_ISP_SCTBL_WIDTH_PER_COLOR(input_width, deci_factor_log2), \\\n\t\t ISP_VEC_NELEMS)\n\n \n#define SH_CSS_SCTBL_CENTERING_MARGIN\t1\n\n \n#define SH_CSS_SCTBL_LAST_GRID_COUNT\t1\n\n \n#define _ISP2401_SCTBL_WIDTH_PER_COLOR(input_width, deci_factor_log2) \\\n\t(ISP_BQ_GRID_WIDTH(input_width, deci_factor_log2) + \\\n\tSH_CSS_SCTBL_CENTERING_MARGIN + SH_CSS_SCTBL_LAST_GRID_COUNT)\n\n \n#define _ISP2401_SCTBL_HEIGHT(input_height, deci_factor_log2) \\\n\t(ISP_BQ_GRID_HEIGHT(input_height, deci_factor_log2) + \\\n\tSH_CSS_SCTBL_CENTERING_MARGIN + SH_CSS_SCTBL_LAST_GRID_COUNT)\n\n \n#define _ISP_SCTBL_LEGACY_WIDTH_PER_COLOR(input_width, deci_factor_log2) \\\n\t(ISP_BQ_GRID_WIDTH(input_width, deci_factor_log2) + SH_CSS_SCTBL_LAST_GRID_COUNT)\n\n \n#define _ISP_SCTBL_LEGACY_HEIGHT(input_height, deci_factor_log2) \\\n\t(ISP_BQ_GRID_HEIGHT(input_height, deci_factor_log2) + SH_CSS_SCTBL_LAST_GRID_COUNT)\n\n \n \n#define _ISP_S3ATBL_WIDTH(in_width, deci_factor_log2) \\\n\t(_ISP_BQS(in_width) >> deci_factor_log2)\n#define _ISP_S3ATBL_HEIGHT(in_height, deci_factor_log2) \\\n\t(_ISP_BQS(in_height) >> deci_factor_log2)\n#define _ISP_S3A_ELEMS_ISP_WIDTH(width, left_crop) \\\n\t(width - ((left_crop) ? 2 * ISP_VEC_NELEMS : 0))\n\n#define _ISP_S3ATBL_ISP_WIDTH(in_width, deci_factor_log2) \\\n\tCEIL_SHIFT(_ISP_BQS(in_width), deci_factor_log2)\n#define _ISP_S3ATBL_ISP_HEIGHT(in_height, deci_factor_log2) \\\n\tCEIL_SHIFT(_ISP_BQS(in_height), deci_factor_log2)\n#define ISP_S3ATBL_VECTORS \\\n\t_ISP_VECS(SH_CSS_MAX_S3ATBL_WIDTH * \\\n\t\t  (sizeof(struct ia_css_3a_output) / sizeof(int32_t)))\n#define ISP_S3ATBL_HI_LO_STRIDE \\\n\t(ISP_S3ATBL_VECTORS * ISP_VEC_NELEMS)\n#define ISP_S3ATBL_HI_LO_STRIDE_BYTES \\\n\t(sizeof(unsigned short) * ISP_S3ATBL_HI_LO_STRIDE)\n\n \n#define __ISP_MAX_VF_OUTPUT_WIDTH(width, left_crop) \\\n\t(width - 2 * ISP_VEC_NELEMS + ((left_crop) ? 2 * ISP_VEC_NELEMS : 0))\n\n#define __ISP_VF_OUTPUT_WIDTH_VECS(out_width, vf_log_downscale) \\\n\t(_ISP_VECS((out_width) >> (vf_log_downscale)))\n\n#define _ISP_VF_OUTPUT_WIDTH(vf_out_vecs) ((vf_out_vecs) * ISP_VEC_NELEMS)\n#define _ISP_VF_OUTPUT_HEIGHT(out_height, vf_log_ds) \\\n\t((out_height) >> (vf_log_ds))\n\n#define _ISP_LOG_VECTOR_STEP(mode) \\\n\t((mode) == IA_CSS_BINARY_MODE_CAPTURE_PP ? 2 : 1)\n\n \n#define MAX_PREFERRED_YUV_DS_PER_STEP\t2\n\n \n#define _ISP_LEFT_CROP_EXTRA(left_crop) ((left_crop) > 0 ? 2 * ISP_VEC_NELEMS : 0)\n\n#define __ISP_MIN_INTERNAL_WIDTH(num_chunks, pipelining, mode) \\\n\t((num_chunks) * (pipelining) * (1 << _ISP_LOG_VECTOR_STEP(mode)) * \\\n\t ISP_VEC_NELEMS)\n\n#define __ISP_PADDED_OUTPUT_WIDTH(out_width, dvs_env_width, left_crop) \\\n\t((out_width) + MAX(dvs_env_width, _ISP_LEFT_CROP_EXTRA(left_crop)))\n\n#define __ISP_CHUNK_STRIDE_ISP(mode) \\\n\t((1 << _ISP_LOG_VECTOR_STEP(mode)) * ISP_VEC_NELEMS)\n\n#define __ISP_CHUNK_STRIDE_DDR(c_subsampling, num_chunks) \\\n\t((c_subsampling) * (num_chunks) * HIVE_ISP_DDR_WORD_BYTES)\n#define __ISP_INTERNAL_WIDTH(out_width, \\\n\t\t\t     dvs_env_width, \\\n\t\t\t     left_crop, \\\n\t\t\t     mode, \\\n\t\t\t     c_subsampling, \\\n\t\t\t     num_chunks, \\\n\t\t\t     pipelining) \\\n\tCEIL_MUL2(CEIL_MUL2(MAX(__ISP_PADDED_OUTPUT_WIDTH(out_width, \\\n\t\t\t\t\t\t\t    dvs_env_width, \\\n\t\t\t\t\t\t\t    left_crop), \\\n\t\t\t\t  __ISP_MIN_INTERNAL_WIDTH(num_chunks, \\\n\t\t\t\t\t\t\t   pipelining, \\\n\t\t\t\t\t\t\t   mode) \\\n\t\t\t\t ), \\\n\t\t\t  __ISP_CHUNK_STRIDE_ISP(mode) \\\n\t\t\t ), \\\n\t\t __ISP_CHUNK_STRIDE_DDR(c_subsampling, num_chunks) \\\n\t\t)\n\n#define __ISP_INTERNAL_HEIGHT(out_height, dvs_env_height, top_crop) \\\n\t((out_height) + (dvs_env_height) + top_crop)\n\n \n#define _ISP_MAX_INPUT_WIDTH(max_internal_width, enable_ds, enable_fixed_bayer_ds, enable_raw_bin, \\\n\t\t\t\tenable_continuous) \\\n\t((enable_ds) ? \\\n\t   SH_CSS_MAX_SENSOR_WIDTH :\\\n\t (enable_fixed_bayer_ds) ? \\\n\t   CEIL_MUL(SH_CSS_MAX_CONTINUOUS_SENSOR_WIDTH_DEC, 4 * ISP_VEC_NELEMS) : \\\n\t (enable_raw_bin) ? \\\n\t   CEIL_MUL(SH_CSS_MAX_CONTINUOUS_SENSOR_WIDTH, 4 * ISP_VEC_NELEMS) : \\\n\t (enable_continuous) ? \\\n\t   SH_CSS_MAX_CONTINUOUS_SENSOR_WIDTH \\\n\t   : max_internal_width)\n\n#define _ISP_INPUT_WIDTH(internal_width, ds_input_width, enable_ds) \\\n\t((enable_ds) ? (ds_input_width) : (internal_width))\n\n#define _ISP_MAX_INPUT_HEIGHT(max_internal_height, enable_ds, enable_fixed_bayer_ds, enable_raw_bin, \\\n\t\t\t\tenable_continuous) \\\n\t((enable_ds) ? \\\n\t   SH_CSS_MAX_SENSOR_HEIGHT :\\\n\t (enable_fixed_bayer_ds) ? \\\n\t   SH_CSS_MAX_CONTINUOUS_SENSOR_HEIGHT_DEC : \\\n\t (enable_raw_bin || enable_continuous) ? \\\n\t   SH_CSS_MAX_CONTINUOUS_SENSOR_HEIGHT \\\n\t   : max_internal_height)\n\n#define _ISP_INPUT_HEIGHT(internal_height, ds_input_height, enable_ds) \\\n\t((enable_ds) ? (ds_input_height) : (internal_height))\n\n#define SH_CSS_MAX_STAGES 8  \n\n \n#define _ISP_EXTRA_PADDING_VECS 0\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}