{
  "module_name": "ia_css_circbuf.h",
  "hash_id": "49439ed1085834c567bbb76483ef0b832fb5f4dd3da670f5dc0904d603fe64ea",
  "original_prompt": "Ingested from linux-6.6.14/drivers/staging/media/atomisp/pci/base/circbuf/interface/ia_css_circbuf.h",
  "human_readable_source": " \n \n\n#ifndef _IA_CSS_CIRCBUF_H\n#define _IA_CSS_CIRCBUF_H\n\n#include <sp.h>\n#include <type_support.h>\n#include <math_support.h>\n#include <assert_support.h>\n#include <platform_support.h>\n#include \"ia_css_circbuf_comm.h\"\n#include \"ia_css_circbuf_desc.h\"\n\n \n \ntypedef struct ia_css_circbuf_s ia_css_circbuf_t;\nstruct ia_css_circbuf_s {\n\tia_css_circbuf_desc_t *desc;     \n\tia_css_circbuf_elem_t *elems;\t \n};\n\n \nvoid ia_css_circbuf_create(\n    ia_css_circbuf_t *cb,\n    ia_css_circbuf_elem_t *elems,\n    ia_css_circbuf_desc_t *desc);\n\n \nvoid ia_css_circbuf_destroy(\n    ia_css_circbuf_t *cb);\n\n \nuint32_t ia_css_circbuf_pop(\n    ia_css_circbuf_t *cb);\n\n \nuint32_t ia_css_circbuf_extract(\n    ia_css_circbuf_t *cb,\n    int offset);\n\n \n \nstatic inline void ia_css_circbuf_elem_set_val(\n    ia_css_circbuf_elem_t *elem,\n    uint32_t val)\n{\n\tOP___assert(elem);\n\n\telem->val = val;\n}\n\n \nstatic inline void ia_css_circbuf_elem_init(\n    ia_css_circbuf_elem_t *elem)\n{\n\tOP___assert(elem);\n\tia_css_circbuf_elem_set_val(elem, 0);\n}\n\n \nstatic inline void ia_css_circbuf_elem_cpy(\n    ia_css_circbuf_elem_t *src,\n    ia_css_circbuf_elem_t *dest)\n{\n\tOP___assert(src);\n\tOP___assert(dest);\n\n\tia_css_circbuf_elem_set_val(dest, src->val);\n}\n\n \nstatic inline uint8_t ia_css_circbuf_get_pos_at_offset(\n    ia_css_circbuf_t *cb,\n    u32 base,\n    int offset)\n{\n\tu8 dest;\n\n\tOP___assert(cb);\n\tOP___assert(cb->desc);\n\tOP___assert(cb->desc->size > 0);\n\n\t \n\twhile (offset < 0) {\n\t\toffset += cb->desc->size;\n\t}\n\n\t \n\tdest = OP_std_modadd(base, offset, cb->desc->size);\n\n\treturn dest;\n}\n\n \nstatic inline int ia_css_circbuf_get_offset(\n    ia_css_circbuf_t *cb,\n    u32 src_pos,\n    uint32_t dest_pos)\n{\n\tint offset;\n\n\tOP___assert(cb);\n\tOP___assert(cb->desc);\n\n\toffset = (int)(dest_pos - src_pos);\n\toffset += (offset < 0) ? cb->desc->size : 0;\n\n\treturn offset;\n}\n\n \nstatic inline uint32_t ia_css_circbuf_get_size(\n    ia_css_circbuf_t *cb)\n{\n\tOP___assert(cb);\n\tOP___assert(cb->desc);\n\n\treturn cb->desc->size;\n}\n\n \nstatic inline uint32_t ia_css_circbuf_get_num_elems(\n    ia_css_circbuf_t *cb)\n{\n\tint num;\n\n\tOP___assert(cb);\n\tOP___assert(cb->desc);\n\n\tnum = ia_css_circbuf_get_offset(cb, cb->desc->start, cb->desc->end);\n\n\treturn (uint32_t)num;\n}\n\n \nstatic inline bool ia_css_circbuf_is_empty(\n    ia_css_circbuf_t *cb)\n{\n\tOP___assert(cb);\n\tOP___assert(cb->desc);\n\n\treturn ia_css_circbuf_desc_is_empty(cb->desc);\n}\n\n \nstatic inline bool ia_css_circbuf_is_full(ia_css_circbuf_t *cb)\n{\n\tOP___assert(cb);\n\tOP___assert(cb->desc);\n\n\treturn ia_css_circbuf_desc_is_full(cb->desc);\n}\n\n \nstatic inline void ia_css_circbuf_write(\n    ia_css_circbuf_t *cb,\n    ia_css_circbuf_elem_t elem)\n{\n\tOP___assert(cb);\n\tOP___assert(cb->desc);\n\n\t \n\tassert(!ia_css_circbuf_is_full(cb));\n\n\tia_css_circbuf_elem_cpy(&elem, &cb->elems[cb->desc->end]);\n\n\tcb->desc->end = ia_css_circbuf_get_pos_at_offset(cb, cb->desc->end, 1);\n}\n\n \nstatic inline void ia_css_circbuf_push(\n    ia_css_circbuf_t *cb,\n    uint32_t val)\n{\n\tia_css_circbuf_elem_t elem;\n\n\tOP___assert(cb);\n\n\t \n\tia_css_circbuf_elem_init(&elem);\n\tia_css_circbuf_elem_set_val(&elem, val);\n\n\t \n\tia_css_circbuf_write(cb, elem);\n}\n\n \nstatic inline uint32_t ia_css_circbuf_get_free_elems(\n    ia_css_circbuf_t *cb)\n{\n\tOP___assert(cb);\n\tOP___assert(cb->desc);\n\n\treturn ia_css_circbuf_desc_get_free_elems(cb->desc);\n}\n\n \nuint32_t ia_css_circbuf_peek(\n    ia_css_circbuf_t *cb,\n    int offset);\n\n \nuint32_t ia_css_circbuf_peek_from_start(\n    ia_css_circbuf_t *cb,\n    int offset);\n\n \nbool ia_css_circbuf_increase_size(\n    ia_css_circbuf_t *cb,\n    unsigned int sz_delta,\n    ia_css_circbuf_elem_t *elems);\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}