{
  "module_name": "input_formatter.c",
  "hash_id": "658134f541109875cbdb8918aa6ccecc52ce38b4542c78cbbefd78d67524be3a",
  "original_prompt": "Ingested from linux-6.6.14/drivers/staging/media/atomisp/pci/hive_isp_css_common/host/input_formatter.c",
  "human_readable_source": "\n \n\n#include \"system_global.h\"\n\n#ifndef ISP2401\n\n#include \"input_formatter.h\"\n#include <type_support.h>\n#include \"gp_device.h\"\n\n#include \"assert_support.h\"\n\n#ifndef __INLINE_INPUT_FORMATTER__\n#include \"input_formatter_private.h\"\n#endif  \n\nstatic const unsigned int input_formatter_alignment[N_INPUT_FORMATTER_ID] = {\n\tISP_VEC_ALIGN, ISP_VEC_ALIGN, HIVE_ISP_CTRL_DATA_BYTES\n};\n\nconst hrt_address HIVE_IF_SRST_ADDRESS[N_INPUT_FORMATTER_ID] = {\n\tINPUT_FORMATTER0_SRST_OFFSET,\n\tINPUT_FORMATTER1_SRST_OFFSET,\n\tINPUT_FORMATTER2_SRST_OFFSET,\n\tINPUT_FORMATTER3_SRST_OFFSET\n};\n\nconst hrt_data HIVE_IF_SRST_MASK[N_INPUT_FORMATTER_ID] = {\n\tINPUT_FORMATTER0_SRST_MASK,\n\tINPUT_FORMATTER1_SRST_MASK,\n\tINPUT_FORMATTER2_SRST_MASK,\n\tINPUT_FORMATTER3_SRST_MASK\n};\n\nconst u8 HIVE_IF_SWITCH_CODE[N_INPUT_FORMATTER_ID] = {\n\tHIVE_INPUT_SWITCH_SELECT_IF_PRIM,\n\tHIVE_INPUT_SWITCH_SELECT_IF_PRIM,\n\tHIVE_INPUT_SWITCH_SELECT_IF_SEC,\n\tHIVE_INPUT_SWITCH_SELECT_STR_TO_MEM\n};\n\n \nstatic const bool HIVE_IF_BIN_COPY[N_INPUT_FORMATTER_ID] = {\n\tfalse, false, false, true\n};\n\nvoid input_formatter_rst(\n    const input_formatter_ID_t\t\tID)\n{\n\thrt_address\taddr;\n\thrt_data\trst;\n\n\tassert(ID < N_INPUT_FORMATTER_ID);\n\n\taddr = HIVE_IF_SRST_ADDRESS[ID];\n\trst = HIVE_IF_SRST_MASK[ID];\n\n\t \n\tif (!HIVE_IF_BIN_COPY[ID]) {\n\t\tinput_formatter_reg_store(ID, addr, rst);\n\t}\n\n\treturn;\n}\n\nunsigned int input_formatter_get_alignment(\n    const input_formatter_ID_t\t\tID)\n{\n\tassert(ID < N_INPUT_FORMATTER_ID);\n\n\treturn input_formatter_alignment[ID];\n}\n\nvoid input_formatter_set_fifo_blocking_mode(\n    const input_formatter_ID_t\t\tID,\n    const bool\t\t\t\t\t\tenable)\n{\n\tassert(ID < N_INPUT_FORMATTER_ID);\n\n\t \n\tif (!HIVE_IF_BIN_COPY[ID]) {\n\t\tinput_formatter_reg_store(ID,\n\t\t\t\t\t  HIVE_IF_BLOCK_FIFO_NO_REQ_ADDRESS, enable);\n\t}\n\treturn;\n}\n\nvoid input_formatter_get_switch_state(\n    const input_formatter_ID_t\t\tID,\n    input_formatter_switch_state_t\t*state)\n{\n\tassert(ID < N_INPUT_FORMATTER_ID);\n\tassert(state);\n\n\t \n\t(void)ID;\n\n\tstate->if_input_switch_lut_reg[0] = gp_device_reg_load(GP_DEVICE0_ID,\n\t\t\t\t\t    _REG_GP_IFMT_input_switch_lut_reg0);\n\tstate->if_input_switch_lut_reg[1] = gp_device_reg_load(GP_DEVICE0_ID,\n\t\t\t\t\t    _REG_GP_IFMT_input_switch_lut_reg1);\n\tstate->if_input_switch_lut_reg[2] = gp_device_reg_load(GP_DEVICE0_ID,\n\t\t\t\t\t    _REG_GP_IFMT_input_switch_lut_reg2);\n\tstate->if_input_switch_lut_reg[3] = gp_device_reg_load(GP_DEVICE0_ID,\n\t\t\t\t\t    _REG_GP_IFMT_input_switch_lut_reg3);\n\tstate->if_input_switch_lut_reg[4] = gp_device_reg_load(GP_DEVICE0_ID,\n\t\t\t\t\t    _REG_GP_IFMT_input_switch_lut_reg4);\n\tstate->if_input_switch_lut_reg[5] = gp_device_reg_load(GP_DEVICE0_ID,\n\t\t\t\t\t    _REG_GP_IFMT_input_switch_lut_reg5);\n\tstate->if_input_switch_lut_reg[6] = gp_device_reg_load(GP_DEVICE0_ID,\n\t\t\t\t\t    _REG_GP_IFMT_input_switch_lut_reg6);\n\tstate->if_input_switch_lut_reg[7] = gp_device_reg_load(GP_DEVICE0_ID,\n\t\t\t\t\t    _REG_GP_IFMT_input_switch_lut_reg7);\n\tstate->if_input_switch_fsync_lut = gp_device_reg_load(GP_DEVICE0_ID,\n\t\t\t\t\t   _REG_GP_IFMT_input_switch_fsync_lut);\n\tstate->if_input_switch_ch_id_fmt_type = gp_device_reg_load(GP_DEVICE0_ID,\n\t\t\t\t\t\t_REG_GP_IFMT_input_switch_ch_id_fmt_type);\n\n\treturn;\n}\n\nvoid input_formatter_get_state(\n    const input_formatter_ID_t\t\tID,\n    input_formatter_state_t\t\t\t*state)\n{\n\tassert(ID < N_INPUT_FORMATTER_ID);\n\tassert(state);\n\t \n\tstate->start_line = input_formatter_reg_load(ID,\n\t\t\t    HIVE_IF_START_LINE_ADDRESS);\n\tstate->start_column = input_formatter_reg_load(ID,\n\t\t\t      HIVE_IF_START_COLUMN_ADDRESS);\n\tstate->cropped_height = input_formatter_reg_load(ID,\n\t\t\t\tHIVE_IF_CROPPED_HEIGHT_ADDRESS);\n\tstate->cropped_width = input_formatter_reg_load(ID,\n\t\t\t       HIVE_IF_CROPPED_WIDTH_ADDRESS);\n\tstate->ver_decimation = input_formatter_reg_load(ID,\n\t\t\t\tHIVE_IF_VERTICAL_DECIMATION_ADDRESS);\n\tstate->hor_decimation = input_formatter_reg_load(ID,\n\t\t\t\tHIVE_IF_HORIZONTAL_DECIMATION_ADDRESS);\n\tstate->hor_deinterleaving = input_formatter_reg_load(ID,\n\t\t\t\t    HIVE_IF_H_DEINTERLEAVING_ADDRESS);\n\tstate->left_padding = input_formatter_reg_load(ID,\n\t\t\t      HIVE_IF_LEFTPADDING_WIDTH_ADDRESS);\n\tstate->eol_offset = input_formatter_reg_load(ID,\n\t\t\t    HIVE_IF_END_OF_LINE_OFFSET_ADDRESS);\n\tstate->vmem_start_address = input_formatter_reg_load(ID,\n\t\t\t\t    HIVE_IF_VMEM_START_ADDRESS_ADDRESS);\n\tstate->vmem_end_address = input_formatter_reg_load(ID,\n\t\t\t\t  HIVE_IF_VMEM_END_ADDRESS_ADDRESS);\n\tstate->vmem_increment = input_formatter_reg_load(ID,\n\t\t\t\tHIVE_IF_VMEM_INCREMENT_ADDRESS);\n\tstate->is_yuv420 = input_formatter_reg_load(ID,\n\t\t\t   HIVE_IF_YUV_420_FORMAT_ADDRESS);\n\tstate->vsync_active_low = input_formatter_reg_load(ID,\n\t\t\t\t  HIVE_IF_VSYNCK_ACTIVE_LOW_ADDRESS);\n\tstate->hsync_active_low = input_formatter_reg_load(ID,\n\t\t\t\t  HIVE_IF_HSYNCK_ACTIVE_LOW_ADDRESS);\n\tstate->allow_fifo_overflow = input_formatter_reg_load(ID,\n\t\t\t\t     HIVE_IF_ALLOW_FIFO_OVERFLOW_ADDRESS);\n\tstate->block_fifo_when_no_req = input_formatter_reg_load(ID,\n\t\t\t\t\tHIVE_IF_BLOCK_FIFO_NO_REQ_ADDRESS);\n\tstate->ver_deinterleaving = input_formatter_reg_load(ID,\n\t\t\t\t    HIVE_IF_V_DEINTERLEAVING_ADDRESS);\n\t \n\tstate->fsm_sync_status = input_formatter_reg_load(ID,\n\t\t\t\t HIVE_IF_FSM_SYNC_STATUS);\n\tstate->fsm_sync_counter = input_formatter_reg_load(ID,\n\t\t\t\t  HIVE_IF_FSM_SYNC_COUNTER);\n\tstate->fsm_crop_status = input_formatter_reg_load(ID,\n\t\t\t\t HIVE_IF_FSM_CROP_STATUS);\n\tstate->fsm_crop_line_counter = input_formatter_reg_load(ID,\n\t\t\t\t       HIVE_IF_FSM_CROP_LINE_COUNTER);\n\tstate->fsm_crop_pixel_counter = input_formatter_reg_load(ID,\n\t\t\t\t\tHIVE_IF_FSM_CROP_PIXEL_COUNTER);\n\tstate->fsm_deinterleaving_index = input_formatter_reg_load(ID,\n\t\t\t\t\t  HIVE_IF_FSM_DEINTERLEAVING_IDX);\n\tstate->fsm_dec_h_counter = input_formatter_reg_load(ID,\n\t\t\t\t   HIVE_IF_FSM_DECIMATION_H_COUNTER);\n\tstate->fsm_dec_v_counter = input_formatter_reg_load(ID,\n\t\t\t\t   HIVE_IF_FSM_DECIMATION_V_COUNTER);\n\tstate->fsm_dec_block_v_counter = input_formatter_reg_load(ID,\n\t\t\t\t\t HIVE_IF_FSM_DECIMATION_BLOCK_V_COUNTER);\n\tstate->fsm_padding_status = input_formatter_reg_load(ID,\n\t\t\t\t    HIVE_IF_FSM_PADDING_STATUS);\n\tstate->fsm_padding_elem_counter = input_formatter_reg_load(ID,\n\t\t\t\t\t  HIVE_IF_FSM_PADDING_ELEMENT_COUNTER);\n\tstate->fsm_vector_support_error = input_formatter_reg_load(ID,\n\t\t\t\t\t  HIVE_IF_FSM_VECTOR_SUPPORT_ERROR);\n\tstate->fsm_vector_buffer_full = input_formatter_reg_load(ID,\n\t\t\t\t\tHIVE_IF_FSM_VECTOR_SUPPORT_BUFF_FULL);\n\tstate->vector_support = input_formatter_reg_load(ID,\n\t\t\t\tHIVE_IF_FSM_VECTOR_SUPPORT);\n\tstate->sensor_data_lost = input_formatter_reg_load(ID,\n\t\t\t\t  HIVE_IF_FIFO_SENSOR_STATUS);\n\n\treturn;\n}\n\nvoid input_formatter_bin_get_state(\n    const input_formatter_ID_t\t\tID,\n    input_formatter_bin_state_t\t\t*state)\n{\n\tassert(ID < N_INPUT_FORMATTER_ID);\n\tassert(state);\n\n\tstate->reset = input_formatter_reg_load(ID,\n\t\t\t\t\t\tHIVE_STR2MEM_SOFT_RESET_REG_ADDRESS);\n\tstate->input_endianness = input_formatter_reg_load(ID,\n\t\t\t\t  HIVE_STR2MEM_INPUT_ENDIANNESS_REG_ADDRESS);\n\tstate->output_endianness = input_formatter_reg_load(ID,\n\t\t\t\t   HIVE_STR2MEM_OUTPUT_ENDIANNESS_REG_ADDRESS);\n\tstate->bitswap = input_formatter_reg_load(ID,\n\t\t\t HIVE_STR2MEM_BIT_SWAPPING_REG_ADDRESS);\n\tstate->block_synch = input_formatter_reg_load(ID,\n\t\t\t     HIVE_STR2MEM_BLOCK_SYNC_LEVEL_REG_ADDRESS);\n\tstate->packet_synch = input_formatter_reg_load(ID,\n\t\t\t      HIVE_STR2MEM_PACKET_SYNC_LEVEL_REG_ADDRESS);\n\tstate->readpostwrite_synch = input_formatter_reg_load(ID,\n\t\t\t\t     HIVE_STR2MEM_READ_POST_WRITE_SYNC_ENABLE_REG_ADDRESS);\n\tstate->is_2ppc = input_formatter_reg_load(ID,\n\t\t\t HIVE_STR2MEM_DUAL_BYTE_INPUTS_ENABLED_REG_ADDRESS);\n\tstate->en_status_update = input_formatter_reg_load(ID,\n\t\t\t\t  HIVE_STR2MEM_EN_STAT_UPDATE_ADDRESS);\n\treturn;\n}\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}