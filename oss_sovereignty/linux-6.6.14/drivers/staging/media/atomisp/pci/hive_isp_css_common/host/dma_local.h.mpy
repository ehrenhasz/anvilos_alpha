{
  "module_name": "dma_local.h",
  "hash_id": "b148a5b9905059b8502914796676b27e68869d2375aa4a31a34c334af0a62521",
  "original_prompt": "Ingested from linux-6.6.14/drivers/staging/media/atomisp/pci/hive_isp_css_common/host/dma_local.h",
  "human_readable_source": " \n \n\n#ifndef __DMA_LOCAL_H_INCLUDED__\n#define __DMA_LOCAL_H_INCLUDED__\n\n#include <type_support.h>\n#include \"dma_global.h\"\n\n#include <defs.h>\t\t\t\t \n#include <bits.h>\t\t\t\t \n#include <hive_isp_css_defs.h>\t\t \n#include <dma_v2_defs.h>\n\n#define _DMA_FSM_GROUP_CMD_IDX\t\t\t\t\t\t_DMA_V2_FSM_GROUP_CMD_IDX\n#define _DMA_FSM_GROUP_ADDR_A_IDX\t\t\t\t\t_DMA_V2_FSM_GROUP_ADDR_SRC_IDX\n#define _DMA_FSM_GROUP_ADDR_B_IDX\t\t\t\t\t_DMA_V2_FSM_GROUP_ADDR_DEST_IDX\n\n#define _DMA_FSM_GROUP_CMD_CTRL_IDX\t\t\t\t\t_DMA_V2_FSM_GROUP_CMD_CTRL_IDX\n\n#define _DMA_FSM_GROUP_FSM_CTRL_IDX\t\t\t\t\t_DMA_V2_FSM_GROUP_FSM_CTRL_IDX\n#define _DMA_FSM_GROUP_FSM_CTRL_STATE_IDX\t\t\t_DMA_V2_FSM_GROUP_FSM_CTRL_STATE_IDX\n#define _DMA_FSM_GROUP_FSM_CTRL_REQ_DEV_IDX\t\t\t_DMA_V2_FSM_GROUP_FSM_CTRL_REQ_DEV_IDX\n#define _DMA_FSM_GROUP_FSM_CTRL_REQ_ADDR_IDX\t\t_DMA_V2_FSM_GROUP_FSM_CTRL_REQ_ADDR_IDX\n#define _DMA_FSM_GROUP_FSM_CTRL_REQ_STRIDE_IDX\t\t_DMA_V2_FSM_GROUP_FSM_CTRL_REQ_STRIDE_IDX\n#define _DMA_FSM_GROUP_FSM_CTRL_REQ_XB_IDX\t\t\t_DMA_V2_FSM_GROUP_FSM_CTRL_REQ_XB_IDX\n#define _DMA_FSM_GROUP_FSM_CTRL_REQ_YB_IDX\t\t\t_DMA_V2_FSM_GROUP_FSM_CTRL_REQ_YB_IDX\n#define _DMA_FSM_GROUP_FSM_CTRL_PACK_REQ_DEV_IDX\t_DMA_V2_FSM_GROUP_FSM_CTRL_PACK_REQ_DEV_IDX\n#define _DMA_FSM_GROUP_FSM_CTRL_PACK_WR_DEV_IDX\t\t_DMA_V2_FSM_GROUP_FSM_CTRL_PACK_WR_DEV_IDX\n#define _DMA_FSM_GROUP_FSM_CTRL_WR_ADDR_IDX\t\t\t_DMA_V2_FSM_GROUP_FSM_CTRL_WR_ADDR_IDX\n#define _DMA_FSM_GROUP_FSM_CTRL_WR_STRIDE_IDX\t\t_DMA_V2_FSM_GROUP_FSM_CTRL_WR_STRIDE_IDX\n#define _DMA_FSM_GROUP_FSM_CTRL_PACK_REQ_XB_IDX\t\t_DMA_V2_FSM_GROUP_FSM_CTRL_PACK_REQ_XB_IDX\n#define _DMA_FSM_GROUP_FSM_CTRL_PACK_WR_YB_IDX\t\t_DMA_V2_FSM_GROUP_FSM_CTRL_PACK_WR_YB_IDX\n#define _DMA_FSM_GROUP_FSM_CTRL_PACK_WR_XB_IDX\t\t_DMA_V2_FSM_GROUP_FSM_CTRL_PACK_WR_XB_IDX\n#define _DMA_FSM_GROUP_FSM_CTRL_PACK_ELEM_REQ_IDX\t_DMA_V2_FSM_GROUP_FSM_CTRL_PACK_ELEM_REQ_IDX\n#define _DMA_FSM_GROUP_FSM_CTRL_PACK_ELEM_WR_IDX\t_DMA_V2_FSM_GROUP_FSM_CTRL_PACK_ELEM_WR_IDX\n#define _DMA_FSM_GROUP_FSM_CTRL_PACK_S_Z_IDX\t\t_DMA_V2_FSM_GROUP_FSM_CTRL_PACK_S_Z_IDX\n\n#define _DMA_FSM_GROUP_FSM_PACK_IDX\t\t\t\t\t_DMA_V2_FSM_GROUP_FSM_PACK_IDX\n#define _DMA_FSM_GROUP_FSM_PACK_STATE_IDX\t\t\t_DMA_V2_FSM_GROUP_FSM_PACK_STATE_IDX\n#define _DMA_FSM_GROUP_FSM_PACK_CNT_YB_IDX\t\t\t_DMA_V2_FSM_GROUP_FSM_PACK_CNT_YB_IDX\n#define _DMA_FSM_GROUP_FSM_PACK_CNT_XB_REQ_IDX\t\t_DMA_V2_FSM_GROUP_FSM_PACK_CNT_XB_REQ_IDX\n#define _DMA_FSM_GROUP_FSM_PACK_CNT_XB_WR_IDX\t\t_DMA_V2_FSM_GROUP_FSM_PACK_CNT_XB_WR_IDX\n\n#define _DMA_FSM_GROUP_FSM_REQ_IDX\t\t\t\t\t_DMA_V2_FSM_GROUP_FSM_REQ_IDX\n#define _DMA_FSM_GROUP_FSM_REQ_STATE_IDX\t\t\t_DMA_V2_FSM_GROUP_FSM_REQ_STATE_IDX\n#define _DMA_FSM_GROUP_FSM_REQ_CNT_YB_IDX\t\t\t_DMA_V2_FSM_GROUP_FSM_REQ_CNT_YB_IDX\n#define _DMA_FSM_GROUP_FSM_REQ_CNT_XB_IDX\t\t\t_DMA_V2_FSM_GROUP_FSM_REQ_CNT_XB_IDX\n\n#define _DMA_FSM_GROUP_FSM_WR_IDX\t\t\t\t\t_DMA_V2_FSM_GROUP_FSM_WR_IDX\n#define _DMA_FSM_GROUP_FSM_WR_STATE_IDX\t\t\t\t_DMA_V2_FSM_GROUP_FSM_WR_STATE_IDX\n#define _DMA_FSM_GROUP_FSM_WR_CNT_YB_IDX\t\t\t_DMA_V2_FSM_GROUP_FSM_WR_CNT_YB_IDX\n#define _DMA_FSM_GROUP_FSM_WR_CNT_XB_IDX\t\t\t_DMA_V2_FSM_GROUP_FSM_WR_CNT_XB_IDX\n\n#define _DMA_DEV_INTERF_MAX_BURST_IDX\t\t\t_DMA_V2_DEV_INTERF_MAX_BURST_IDX\n\n \n#define DMA_SEL_COMP(comp)     (((comp)  & _hrt_ones(_DMA_V2_ADDR_SEL_COMP_BITS))            << _DMA_V2_ADDR_SEL_COMP_IDX)\n#define DMA_SEL_CH(ch)         (((ch)    & _hrt_ones(_DMA_V2_ADDR_SEL_CH_REG_BITS))          << _DMA_V2_ADDR_SEL_CH_REG_IDX)\n#define DMA_SEL_PARAM(param)   (((param) & _hrt_ones(_DMA_V2_ADDR_SEL_PARAM_BITS))           << _DMA_V2_ADDR_SEL_PARAM_IDX)\n \n#define DMA_SEL_CG_INFO(info)  (((info)  & _hrt_ones(_DMA_V2_ADDR_SEL_GROUP_COMP_INFO_BITS)) << _DMA_V2_ADDR_SEL_GROUP_COMP_INFO_IDX)\n#define DMA_SEL_CG_COMP(comp)  (((comp)  & _hrt_ones(_DMA_V2_ADDR_SEL_GROUP_COMP_BITS))      << _DMA_V2_ADDR_SEL_GROUP_COMP_IDX)\n#define DMA_SEL_DEV_INFO(info) (((info)  & _hrt_ones(_DMA_V2_ADDR_SEL_DEV_INTERF_INFO_BITS)) << _DMA_V2_ADDR_SEL_DEV_INTERF_INFO_IDX)\n#define DMA_SEL_DEV_ID(dev)    (((dev)   & _hrt_ones(_DMA_V2_ADDR_SEL_DEV_INTERF_IDX_BITS))  << _DMA_V2_ADDR_SEL_DEV_INTERF_IDX_IDX)\n\n#define DMA_COMMAND_FSM_REG_IDX\t\t\t\t\t(DMA_SEL_COMP(_DMA_V2_SEL_FSM_CMD) >> 2)\n#define DMA_CHANNEL_PARAM_REG_IDX(ch, param)\t((DMA_SEL_COMP(_DMA_V2_SEL_CH_REG) | DMA_SEL_CH(ch) | DMA_SEL_PARAM(param)) >> 2)\n#define DMA_CG_INFO_REG_IDX(info_id, comp_id)\t((DMA_SEL_COMP(_DMA_V2_SEL_CONN_GROUP) | DMA_SEL_CG_INFO(info_id) | DMA_SEL_CG_COMP(comp_id)) >> 2)\n#define DMA_DEV_INFO_REG_IDX(info_id, dev_id)\t((DMA_SEL_COMP(_DMA_V2_SEL_DEV_INTERF) | DMA_SEL_DEV_INFO(info_id) | DMA_SEL_DEV_ID(dev_id)) >> 2)\n#define DMA_RST_REG_IDX\t\t\t\t\t\t\t(DMA_SEL_COMP(_DMA_V2_SEL_RESET) >> 2)\n\n#define DMA_GET_CONNECTION(val)    _hrt_get_bits(val, _DMA_V2_CONNECTION_IDX,    _DMA_V2_CONNECTION_BITS)\n#define DMA_GET_EXTENSION(val)     _hrt_get_bits(val, _DMA_V2_EXTENSION_IDX,     _DMA_V2_EXTENSION_BITS)\n#define DMA_GET_ELEMENTS(val)      _hrt_get_bits(val, _DMA_V2_ELEMENTS_IDX,      _DMA_V2_ELEMENTS_BITS)\n#define DMA_GET_CROPPING(val)      _hrt_get_bits(val, _DMA_V2_LEFT_CROPPING_IDX, _DMA_V2_LEFT_CROPPING_BITS)\n\ntypedef enum {\n\tDMA_CTRL_STATE_IDLE,\n\tDMA_CTRL_STATE_REQ_RCV,\n\tDMA_CTRL_STATE_RCV,\n\tDMA_CTRL_STATE_RCV_REQ,\n\tDMA_CTRL_STATE_INIT,\n\tN_DMA_CTRL_STATES\n} dma_ctrl_states_t;\n\ntypedef enum {\n\tDMA_COMMAND_READ,\n\tDMA_COMMAND_WRITE,\n\tDMA_COMMAND_SET_CHANNEL,\n\tDMA_COMMAND_SET_PARAM,\n\tDMA_COMMAND_READ_SPECIFIC,\n\tDMA_COMMAND_WRITE_SPECIFIC,\n\tDMA_COMMAND_INIT,\n\tDMA_COMMAND_INIT_SPECIFIC,\n\tDMA_COMMAND_RST,\n\tN_DMA_COMMANDS\n} dma_commands_t;\n\ntypedef enum {\n\tDMA_RW_STATE_IDLE,\n\tDMA_RW_STATE_REQ,\n\tDMA_RW_STATE_NEXT_LINE,\n\tDMA_RW_STATE_UNLOCK_CHANNEL,\n\tN_DMA_RW_STATES\n} dma_rw_states_t;\n\ntypedef enum {\n\tDMA_FIFO_STATE_WILL_BE_FULL,\n\tDMA_FIFO_STATE_FULL,\n\tDMA_FIFO_STATE_EMPTY,\n\tN_DMA_FIFO_STATES\n} dma_fifo_states_t;\n\n \ntypedef struct dma_channel_state_s\tdma_channel_state_t;\ntypedef struct dma_port_state_s\t\tdma_port_state_t;\n\nstruct dma_port_state_s {\n\tbool                       req_cs;\n\tbool                       req_we_n;\n\tbool                       req_run;\n\tbool                       req_ack;\n\tbool                       send_cs;\n\tbool                       send_we_n;\n\tbool                       send_run;\n\tbool                       send_ack;\n\tdma_fifo_states_t          fifo_state;\n\tint                        fifo_counter;\n};\n\nstruct dma_channel_state_s {\n\tint                        connection;\n\tbool                       sign_extend;\n\tint                        height;\n\tint                        stride_a;\n\tint                        elems_a;\n\tint                        cropping_a;\n\tint                        width_a;\n\tint                        stride_b;\n\tint                        elems_b;\n\tint                        cropping_b;\n\tint                        width_b;\n};\n\nstruct dma_state_s {\n\tbool                       fsm_command_idle;\n\tbool                       fsm_command_run;\n\tbool                       fsm_command_stalling;\n\tbool                       fsm_command_error;\n\tdma_commands_t             last_command;\n\tint                        last_command_channel;\n\tint                        last_command_param;\n\tdma_commands_t             current_command;\n\tint                        current_addr_a;\n\tint                        current_addr_b;\n\tbool                       fsm_ctrl_idle;\n\tbool                       fsm_ctrl_run;\n\tbool                       fsm_ctrl_stalling;\n\tbool                       fsm_ctrl_error;\n\tdma_ctrl_states_t          fsm_ctrl_state;\n\tint                        fsm_ctrl_source_dev;\n\tint                        fsm_ctrl_source_addr;\n\tint                        fsm_ctrl_source_stride;\n\tint                        fsm_ctrl_source_width;\n\tint                        fsm_ctrl_source_height;\n\tint                        fsm_ctrl_pack_source_dev;\n\tint                        fsm_ctrl_pack_dest_dev;\n\tint                        fsm_ctrl_dest_addr;\n\tint                        fsm_ctrl_dest_stride;\n\tint                        fsm_ctrl_pack_source_width;\n\tint                        fsm_ctrl_pack_dest_height;\n\tint                        fsm_ctrl_pack_dest_width;\n\tint                        fsm_ctrl_pack_source_elems;\n\tint                        fsm_ctrl_pack_dest_elems;\n\tint                        fsm_ctrl_pack_extension;\n\tint\t\t\t\t\t\t   pack_idle;\n\tint\t\t\t       pack_run;\n\tint\t\t\t\t   pack_stalling;\n\tint\t\t\t\t   pack_error;\n\tint                        pack_cnt_height;\n\tint                        pack_src_cnt_width;\n\tint                        pack_dest_cnt_width;\n\tdma_rw_states_t            read_state;\n\tint                        read_cnt_height;\n\tint                        read_cnt_width;\n\tdma_rw_states_t            write_state;\n\tint                        write_height;\n\tint                        write_width;\n\tdma_port_state_t           port_states[HIVE_ISP_NUM_DMA_CONNS];\n\tdma_channel_state_t        channel_states[HIVE_DMA_NUM_CHANNELS];\n};\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}