{
  "module_name": "rtw_mlme.h",
  "hash_id": "e33f3e847d56a611f9571a8283975ed7d75675cf79a88652fb3758ece8a1cf67",
  "original_prompt": "Ingested from linux-6.6.14/drivers/staging/rtl8723bs/include/rtw_mlme.h",
  "human_readable_source": " \n \n#ifndef __RTW_MLME_H_\n#define __RTW_MLME_H_\n\n\n#define\tMAX_BSS_CNT\t128\n \n \n#define   MAX_JOIN_TIMEOUT\t6500\n\n \n \n\n#define\t\tSCANNING_TIMEOUT\t8000\n\n#ifdef PALTFORM_OS_WINCE\n#define\tSCANQUEUE_LIFETIME 12000000  \n#else\n#define\tSCANQUEUE_LIFETIME 20000  \n#endif\n\n#define WIFI_NULL_STATE\t\t0x00000000\n#define WIFI_ASOC_STATE\t\t0x00000001\t\t \n#define WIFI_REASOC_STATE\t0x00000002\n#define WIFI_SLEEP_STATE\t0x00000004\n#define WIFI_STATION_STATE\t0x00000008\n#define\tWIFI_AP_STATE\t\t\t0x00000010\n#define\tWIFI_ADHOC_STATE\t\t0x00000020\n#define WIFI_ADHOC_MASTER_STATE\t0x00000040\n#define WIFI_UNDER_LINKING\t0x00000080\n\n#define WIFI_UNDER_WPS\t\t\t0x00000100\n \n \n#define\tWIFI_STA_ALIVE_CHK_STATE\t0x00000400\n#define\tWIFI_SITE_MONITOR\t\t\t0x00000800\t\t \n#ifdef WDS\n#define\tWIFI_WDS\t\t\t\t0x00001000\n#define\tWIFI_WDS_RX_BEACON\t0x00002000\t\t \n#endif\n#ifdef AUTO_CONFIG\n#define\tWIFI_AUTOCONF\t\t\t0x00004000\n#define\tWIFI_AUTOCONF_IND\t0x00008000\n#endif\n\n \n\n \n#define\tWIFI_MP_STATE\t\t\t\t\t\t\t0x00010000\n#define\tWIFI_MP_CTX_BACKGROUND\t\t\t\t0x00020000\t \n#define\tWIFI_MP_CTX_ST\t\t\t\t\t\t0x00040000\t \n#define\tWIFI_MP_CTX_BACKGROUND_PENDING\t0x00080000\t \n#define\tWIFI_MP_CTX_CCK_HW\t\t\t\t\t0x00100000\t \n#define\tWIFI_MP_CTX_CCK_CS\t\t\t\t\t0x00200000\t \n#define   WIFI_MP_LPBK_STATE\t\t\t\t\t0x00400000\n \n\n \n#define _FW_UNDER_LINKING\tWIFI_UNDER_LINKING\n#define _FW_LINKED\t\t\tWIFI_ASOC_STATE\n#define _FW_UNDER_SURVEY\tWIFI_SITE_MONITOR\n\n\nenum {\n dot11AuthAlgrthm_Open = 0,\n dot11AuthAlgrthm_Shared,\n dot11AuthAlgrthm_8021X,\n dot11AuthAlgrthm_Auto,\n dot11AuthAlgrthm_WAPI,\n dot11AuthAlgrthm_MaxNum\n};\n\n \nenum rt_scan_type {\n\tSCAN_PASSIVE,\n\tSCAN_ACTIVE,\n\tSCAN_MIX,\n};\n\nenum {\n\tGHZ24_50 = 0,\n\tGHZ_50,\n\tGHZ_24,\n\tGHZ_MAX,\n};\n\n#define rtw_band_valid(band) ((band) >= GHZ24_50 && (band) < GHZ_MAX)\n\n \n\n\n#define traffic_threshold\t10\n#define\ttraffic_scan_period\t500\n\nstruct sitesurvey_ctrl {\n\tu64\tlast_tx_pkts;\n\tuint\tlast_rx_pkts;\n\tsigned int\ttraffic_busy;\n\tstruct timer_list\tsitesurvey_ctrl_timer;\n};\n\nstruct rt_link_detect_t {\n\tu32 \t\t\tNumTxOkInPeriod;\n\tu32 \t\t\tNumRxOkInPeriod;\n\tu32 \t\t\tNumRxUnicastOkInPeriod;\n\tbool\t\t\tbBusyTraffic;\n\tbool\t\t\tbTxBusyTraffic;\n\tbool\t\t\tbRxBusyTraffic;\n\tbool\t\t\tbHigherBusyTraffic;  \n\tbool\t\t\tbHigherBusyRxTraffic;  \n\tbool\t\t\tbHigherBusyTxTraffic;  \n\t \n\tu8 TrafficTransitionCount;\n\tu32 LowPowerTransitionCount;\n};\n\nstruct profile_info {\n\tu8 ssidlen;\n\tu8 ssid[WLAN_SSID_MAXLEN];\n\tu8 peermac[ETH_ALEN];\n};\n\nstruct tx_invite_req_info {\n\tu8 \t\t\ttoken;\n\tu8 \t\t\tbenable;\n\tu8\t\t\tgo_ssid[WLAN_SSID_MAXLEN];\n\tu8 \t\t\tssidlen;\n\tu8\t\t\tgo_bssid[ETH_ALEN];\n\tu8\t\t\tpeer_macaddr[ETH_ALEN];\n\tu8 \t\t\toperating_ch;\t \n\tu8 \t\t\tpeer_ch;\t\t \n\n};\n\nstruct tx_invite_resp_info {\n\tu8 \t\t\ttoken;\t \n};\n\nstruct tx_provdisc_req_info {\n\tu16 \t\t\t\twps_config_method_request;\t \n\tu16 \t\t\t\tpeer_channel_num[2];\t\t \n\tstruct ndis_802_11_ssid\tssid;\n\tu8\t\t\tpeerDevAddr[ETH_ALEN];\t\t \n\tu8\t\t\tpeerIFAddr[ETH_ALEN];\t\t \n\tu8 \t\t\tbenable;\t\t\t\t\t \n};\n\nstruct rx_provdisc_req_info {\t \n\tu8\t\t\tpeerDevAddr[ETH_ALEN];\t\t \n\tu8 \t\t\tstrconfig_method_desc_of_prov_disc_req[4];\t \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t \n};\n\nstruct tx_nego_req_info {\n\tu16 \t\t\t\tpeer_channel_num[2];\t\t \n\tu8\t\t\tpeerDevAddr[ETH_ALEN];\t\t \n\tu8 \t\t\tbenable;\t\t\t\t\t \n};\n\nstruct group_id_info {\n\tu8\t\t\tgo_device_addr[ETH_ALEN];\t \n\tu8\t\t\tssid[WLAN_SSID_MAXLEN];\t \n};\n\nstruct scan_limit_info {\n\tu8 \t\t\tscan_op_ch_only;\t\t\t \n\tu8 \t\t\toperation_ch[2];\t\t\t\t \n};\n\nstruct wifidirect_info {\n\tstruct adapter\t\t\t\t*padapter;\n\tstruct timer_list\t\t\t\t\tfind_phase_timer;\n\tstruct timer_list\t\t\t\t\trestore_p2p_state_timer;\n\n\t \n\tstruct timer_list\t\t\t\t\tpre_tx_scan_timer;\n\tstruct timer_list\t\t\t\t\treset_ch_sitesurvey;\n\tstruct timer_list\t\t\t\t\treset_ch_sitesurvey2;\t \n\tstruct tx_provdisc_req_info tx_prov_disc_info;\n\tstruct rx_provdisc_req_info rx_prov_disc_info;\n\tstruct tx_invite_req_info invitereq_info;\n\tstruct profile_info\t\tprofileinfo[P2P_MAX_PERSISTENT_GROUP_NUM];\t \n\tstruct tx_invite_resp_info inviteresp_info;\n\tstruct tx_nego_req_info nego_req_info;\n\tstruct group_id_info \tgroupid_info;\t \n\tstruct scan_limit_info \trx_invitereq_info;\t \n\tstruct scan_limit_info \tp2p_info;\t\t \n\tenum p2p_role\t\t\trole;\n\tenum p2p_state\t\t\tpre_p2p_state;\n\tenum p2p_state\t\t\tp2p_state;\n\tu8 \t\t\t\tdevice_addr[ETH_ALEN];\t \n\tu8 \t\t\t\tinterface_addr[ETH_ALEN];\n\tu8 \t\t\t\tsocial_chan[4];\n\tu8 \t\t\t\tlisten_channel;\n\tu8 \t\t\t\toperating_channel;\n\tu8 \t\t\t\tlisten_dwell;\t\t \n\tu8 \t\t\t\tsupport_rate[8];\n\tu8 \t\t\t\tp2p_wildcard_ssid[P2P_WILDCARD_SSID_LEN];\n\tu8 \t\t\t\tintent;\t\t \n\tu8\t\t\t\tp2p_peer_interface_addr[ETH_ALEN];\n\tu8\t\t\t\tp2p_peer_device_addr[ETH_ALEN];\n\tu8 \t\t\t\tpeer_intent;\t \n\tu8\t\t\t\tdevice_name[WPS_MAX_DEVICE_NAME_LEN];\t \n\tu8 \t\t\t\tdevice_name_len;\n\tu8 \t\t\t\tprofileindex;\t \n\tu8 \t\t\t\tpeer_operating_ch;\n\tu8 \t\t\t\tfind_phase_state_exchange_cnt;\n\tu16 \t\t\t\t\tdevice_password_id_for_nego;\t \n\tu8 \t\t\t\tnegotiation_dialog_token;\n\tu8\t\t\t\tnego_ssid[WLAN_SSID_MAXLEN];\t \n\tu8 \t\t\t\tnego_ssidlen;\n\tu8 \t\t\t\tp2p_group_ssid[WLAN_SSID_MAXLEN];\n\tu8 \t\t\t\tp2p_group_ssid_len;\n\tu8 \t\t\t\tpersistent_supported;\t\t \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t \n\tu8 \t\t\t\tsession_available;\t\t\t \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t \n\n\tu8 \t\t\t\twfd_tdls_enable;\t\t\t \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t \n\tu8 \t\t\t\twfd_tdls_weaksec;\t\t\t \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t \n\n\tenum\tp2p_wpsinfo\t\tui_got_wps_info;\t\t\t \n\tu16 \t\t\t\t\tsupported_wps_cm;\t\t\t \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t \n\tu8 \t\t\t\texternal_uuid;\t\t\t\t \n\tu8 \t\t\t\tuuid[16];\t\t\t\t\t \n\tuint\t\t\t\t\t\tchannel_list_attr_len;\t\t \n\tu8 \t\t\t\tchannel_list_attr[100];\t\t \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t \n\tu8 \t\t\t\tdriver_interface;\t\t\t \n};\n\nstruct tdls_ss_record {\t \n\tu8 macaddr[ETH_ALEN];\n\tu8 rx_pwd_ba11;\n\tu8 is_tdls_sta;\t \n};\n\n \nenum {\n\tRTW_ROAM_ON_EXPIRED = BIT0,\n\tRTW_ROAM_ON_RESUME = BIT1,\n\tRTW_ROAM_ACTIVE = BIT2,\n};\n\nstruct mlme_priv {\n\n\tspinlock_t\tlock;\n\tsigned int\tfw_state;\t \n\tu8 bScanInProcess;\n\tu8 to_join;  \n\n\tu8 to_roam;  \n\tstruct wlan_network *roam_network;  \n\tu8 roam_flags;\n\tu8 roam_rssi_diff_th;  \n\tu32 roam_scan_int_ms;  \n\tu32 roam_scanr_exp_ms;  \n\tu8 roam_tgt_addr[ETH_ALEN];  \n\n\tu8 *nic_hdl;\n\n\tu8 not_indic_disco;\n\tstruct list_head\t\t*pscanned;\n\tstruct __queue\tfree_bss_pool;\n\tstruct __queue\tscanned_queue;\n\tu8 *free_bss_buf;\n\n\tstruct ndis_802_11_ssid\tassoc_ssid;\n\tu8 assoc_bssid[6];\n\n\tstruct wlan_network\tcur_network;\n\tstruct wlan_network *cur_network_scanned;\n\n\t \n\n\tu32 auto_scan_int_ms;\n\n\tstruct timer_list assoc_timer;\n\n\tuint assoc_by_bssid;\n\tuint assoc_by_rssi;\n\n\tstruct timer_list scan_to_timer;  \n\tunsigned long scan_start_time;  \n\n\tstruct timer_list set_scan_deny_timer;\n\tatomic_t set_scan_deny;  \n\n\tstruct qos_priv qospriv;\n\n\t \n\tint num_sta_no_ht;\n\n\t \n\t \n\n\n\tint num_FortyMHzIntolerant;\n\n\tstruct ht_priv htpriv;\n\n\tstruct rt_link_detect_t\tLinkDetectInfo;\n\tstruct timer_list\tdynamic_chk_timer;  \n\n\tu8 acm_mask;  \n\tu8 ChannelPlan;\n\tenum rt_scan_type\tscan_mode;  \n\n\tu8 *wps_probe_req_ie;\n\tu32 wps_probe_req_ie_len;\n\n\t \n\tint num_sta_non_erp;\n\n\t \n\tint num_sta_no_short_slot_time;\n\n\t \n\tint num_sta_no_short_preamble;\n\n\tint olbc;  \n\n\t \n\tint num_sta_ht_no_gf;\n\n\t \n\t \n\n\t \n\tint num_sta_ht_20mhz;\n\n\t \n\tint olbc_ht;\n\n\tu16 ht_op_mode;\n\n\tu8 *assoc_req;\n\tu32 assoc_req_len;\n\tu8 *assoc_rsp;\n\tu32 assoc_rsp_len;\n\n\tu8 *wps_beacon_ie;\n\t \n\tu8 *wps_probe_resp_ie;\n\tu8 *wps_assoc_resp_ie;  \n\n\tu32 wps_beacon_ie_len;\n\t \n\tu32 wps_probe_resp_ie_len;\n\tu32 wps_assoc_resp_ie_len;  \n\n\tu8 *p2p_beacon_ie;\n\tu8 *p2p_probe_req_ie;\n\tu8 *p2p_probe_resp_ie;\n\tu8 *p2p_go_probe_resp_ie;  \n\tu8 *p2p_assoc_req_ie;\n\n\tu32 p2p_beacon_ie_len;\n\tu32 p2p_probe_req_ie_len;\n\tu32 p2p_probe_resp_ie_len;\n\tu32 p2p_go_probe_resp_ie_len;  \n\tu32 p2p_assoc_req_ie_len;\n\n\tspinlock_t\tbcn_update_lock;\n\tu8 update_bcn;\n\n\tu8 NumOfBcnInfoChkFail;\n\tunsigned long\ttimeBcnInfoChkStart;\n};\n\n#define rtw_mlme_set_auto_scan_int(adapter, ms) \\\n\tdo { \\\n\t\tadapter->mlmepriv.auto_scan_int_ms = ms; \\\n\twhile (0)\n\nvoid rtw_mlme_reset_auto_scan_int(struct adapter *adapter);\n\nstruct hostapd_priv {\n\tstruct adapter *padapter;\n};\n\nextern int hostapd_mode_init(struct adapter *padapter);\nextern void hostapd_mode_unload(struct adapter *padapter);\n\nextern void rtw_joinbss_event_prehandle(struct adapter *adapter, u8 *pbuf);\nextern void rtw_survey_event_callback(struct adapter *adapter, u8 *pbuf);\nextern void rtw_surveydone_event_callback(struct adapter *adapter, u8 *pbuf);\nextern void rtw_joinbss_event_callback(struct adapter *adapter, u8 *pbuf);\nextern void rtw_stassoc_event_callback(struct adapter *adapter, u8 *pbuf);\nextern void rtw_stadel_event_callback(struct adapter *adapter, u8 *pbuf);\nextern void rtw_atimdone_event_callback(struct adapter *adapter, u8 *pbuf);\nextern void rtw_cpwm_event_callback(struct adapter *adapter, u8 *pbuf);\nextern void rtw_wmm_event_callback(struct adapter *padapter, u8 *pbuf);\n\nextern void rtw_join_timeout_handler(struct timer_list *t);\nextern void _rtw_scan_timeout_handler(struct timer_list *t);\n\nint event_thread(void *context);\n\nextern void rtw_free_network_queue(struct adapter *adapter, u8 isfreeall);\nextern int rtw_init_mlme_priv(struct adapter *adapter); \n\nextern void rtw_free_mlme_priv(struct mlme_priv *pmlmepriv);\n\n\nextern signed int rtw_select_and_join_from_scanned_queue(struct mlme_priv *pmlmepriv);\nextern signed int rtw_set_key(struct adapter *adapter, struct security_priv *psecuritypriv, signed int keyid, u8 set_tx, bool enqueue);\nextern signed int rtw_set_auth(struct adapter *adapter, struct security_priv *psecuritypriv);\n\nstatic inline u8 *get_bssid(struct mlme_priv *pmlmepriv)\n{\t \n\t \n\treturn pmlmepriv->cur_network.network.mac_address;\n}\n\nstatic inline signed int check_fwstate(struct mlme_priv *pmlmepriv, signed int state)\n{\n\tif (pmlmepriv->fw_state & state)\n\t\treturn true;\n\n\treturn false;\n}\n\nstatic inline signed int get_fwstate(struct mlme_priv *pmlmepriv)\n{\n\treturn pmlmepriv->fw_state;\n}\n\n \nstatic inline void set_fwstate(struct mlme_priv *pmlmepriv, signed int state)\n{\n\tpmlmepriv->fw_state |= state;\n\t \n\tif (state == _FW_UNDER_SURVEY)\n\t\tpmlmepriv->bScanInProcess = true;\n}\n\nstatic inline void _clr_fwstate_(struct mlme_priv *pmlmepriv, signed int state)\n{\n\tpmlmepriv->fw_state &= ~state;\n\t \n\tif (state == _FW_UNDER_SURVEY)\n\t\tpmlmepriv->bScanInProcess = false;\n}\n\nextern u16 rtw_get_capability(struct wlan_bssid_ex *bss);\nextern void rtw_update_scanned_network(struct adapter *adapter, struct wlan_bssid_ex *target);\nextern void rtw_disconnect_hdl_under_linked(struct adapter *adapter, struct sta_info *psta, u8 free_assoc);\nextern void rtw_generate_random_ibss(u8 *pibss);\nextern struct wlan_network *rtw_find_network(struct __queue *scanned_queue, u8 *addr);\nextern struct wlan_network *rtw_get_oldest_wlan_network(struct __queue *scanned_queue);\nstruct wlan_network *_rtw_find_same_network(struct __queue *scanned_queue, struct wlan_network *network);\n\nextern void rtw_free_assoc_resources(struct adapter *adapter, int lock_scanned_queue);\nextern void rtw_indicate_disconnect(struct adapter *adapter);\nextern void rtw_indicate_connect(struct adapter *adapter);\nvoid rtw_indicate_scan_done(struct adapter *padapter, bool aborted);\nvoid rtw_scan_abort(struct adapter *adapter);\n\nextern int rtw_restruct_sec_ie(struct adapter *adapter, u8 *in_ie, u8 *out_ie, uint in_len);\nextern int rtw_restruct_wmm_ie(struct adapter *adapter, u8 *in_ie, u8 *out_ie, uint in_len, uint initial_out_len);\nextern void rtw_init_registrypriv_dev_network(struct adapter *adapter);\n\nextern void rtw_update_registrypriv_dev_network(struct adapter *adapter);\n\nextern void rtw_get_encrypt_decrypt_from_registrypriv(struct adapter *adapter);\n\nextern void _rtw_join_timeout_handler(struct timer_list *t);\nextern void rtw_scan_timeout_handler(struct timer_list *t);\n\nextern void rtw_dynamic_check_timer_handler(struct adapter *adapter);\nbool rtw_is_scan_deny(struct adapter *adapter);\nvoid rtw_clear_scan_deny(struct adapter *adapter);\nvoid rtw_set_scan_deny(struct adapter *adapter, u32 ms);\n\nvoid rtw_free_mlme_priv_ie_data(struct mlme_priv *pmlmepriv);\n\nextern void _rtw_free_mlme_priv(struct mlme_priv *pmlmepriv);\n\n \n\nextern struct wlan_network *rtw_alloc_network(struct mlme_priv *pmlmepriv);\n\n\nextern void _rtw_free_network(struct mlme_priv *pmlmepriv, struct wlan_network *pnetwork, u8 isfreeall);\nextern void _rtw_free_network_nolock(struct mlme_priv *pmlmepriv, struct wlan_network *pnetwork);\n\n\nextern struct wlan_network *_rtw_find_network(struct __queue *scanned_queue, u8 *addr);\n\nextern signed int rtw_if_up(struct adapter *padapter);\n\nsigned int rtw_linked_check(struct adapter *padapter);\n\nu8 *rtw_get_capability_from_ie(u8 *ie);\nu8 *rtw_get_beacon_interval_from_ie(u8 *ie);\n\n\nvoid rtw_joinbss_reset(struct adapter *padapter);\n\nvoid rtw_ht_use_default_setting(struct adapter *padapter);\nvoid rtw_build_wmm_ie_ht(struct adapter *padapter, u8 *out_ie, uint *pout_len);\nunsigned int rtw_restructure_ht_ie(struct adapter *padapter, u8 *in_ie, u8 *out_ie, uint in_len, uint *pout_len, u8 channel);\nvoid rtw_update_ht_cap(struct adapter *padapter, u8 *pie, uint ie_len, u8 channel);\nvoid rtw_issue_addbareq_cmd(struct adapter *padapter, struct xmit_frame *pxmitframe);\nvoid rtw_append_exented_cap(struct adapter *padapter, u8 *out_ie, uint *pout_len);\n\nint rtw_is_same_ibss(struct adapter *adapter, struct wlan_network *pnetwork);\nint is_same_network(struct wlan_bssid_ex *src, struct wlan_bssid_ex *dst, u8 feature);\n\n#define rtw_roam_flags(adapter) ((adapter)->mlmepriv.roam_flags)\n#define rtw_chk_roam_flags(adapter, flags) ((adapter)->mlmepriv.roam_flags & flags)\n#define rtw_clr_roam_flags(adapter, flags) \\\n\tdo { \\\n\t\t((adapter)->mlmepriv.roam_flags &= ~flags); \\\n\t} while (0)\n\n#define rtw_set_roam_flags(adapter, flags) \\\n\tdo { \\\n\t\t((adapter)->mlmepriv.roam_flags |= flags); \\\n\t} while (0)\n\n#define rtw_assign_roam_flags(adapter, flags) \\\n\tdo { \\\n\t\t((adapter)->mlmepriv.roam_flags = flags); \\\n\t} while (0)\n\nvoid _rtw_roaming(struct adapter *adapter, struct wlan_network *tgt_network);\nvoid rtw_roaming(struct adapter *adapter, struct wlan_network *tgt_network);\nvoid rtw_set_to_roam(struct adapter *adapter, u8 to_roam);\nu8 rtw_dec_to_roam(struct adapter *adapter);\nu8 rtw_to_roam(struct adapter *adapter);\nint rtw_select_roaming_candidate(struct mlme_priv *pmlmepriv);\n\nvoid rtw_sta_media_status_rpt(struct adapter *adapter, struct sta_info *psta, u32 mstatus);\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}