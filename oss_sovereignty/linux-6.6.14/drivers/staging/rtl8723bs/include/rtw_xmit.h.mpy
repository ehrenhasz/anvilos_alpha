{
  "module_name": "rtw_xmit.h",
  "hash_id": "008c2d9a9dd26b09eca134b7ff74253dc0f75b40c938e1e47860d606b83983a1",
  "original_prompt": "Ingested from linux-6.6.14/drivers/staging/rtl8723bs/include/rtw_xmit.h",
  "human_readable_source": " \n \n#ifndef _RTW_XMIT_H_\n#define _RTW_XMIT_H_\n\n#include <linux/completion.h>\n\n#define MAX_XMITBUF_SZ\t(20480)\t \n\n#define NR_XMITBUFF\t(16)\n\n#define XMITBUF_ALIGN_SZ 512\n\n \n#define MAX_XMIT_EXTBUF_SZ\t(1536)\n#define NR_XMIT_EXTBUFF\t(32)\n\n#define MAX_CMDBUF_SZ\t(5120)\t \n\n#define MAX_NUMBLKS\t\t(1)\n\n#define XMIT_VO_QUEUE (0)\n#define XMIT_VI_QUEUE (1)\n#define XMIT_BE_QUEUE (2)\n#define XMIT_BK_QUEUE (3)\n\n#define VO_QUEUE_INX\t\t0\n#define VI_QUEUE_INX\t\t1\n#define BE_QUEUE_INX\t\t2\n#define BK_QUEUE_INX\t\t3\n#define BCN_QUEUE_INX\t\t4\n#define MGT_QUEUE_INX\t\t5\n#define HIGH_QUEUE_INX\t\t6\n#define TXCMD_QUEUE_INX\t7\n\n#define HW_QUEUE_ENTRY\t8\n\n#define WEP_IV(pattrib_iv, dot11txpn, keyidx)\\\ndo {\\\n\tpattrib_iv[0] = dot11txpn._byte_.TSC0;\\\n\tpattrib_iv[1] = dot11txpn._byte_.TSC1;\\\n\tpattrib_iv[2] = dot11txpn._byte_.TSC2;\\\n\tpattrib_iv[3] = ((keyidx & 0x3)<<6);\\\n\tdot11txpn.val = (dot11txpn.val == 0xffffff) ? 0 : (dot11txpn.val + 1);\\\n} while (0)\n\n\n#define TKIP_IV(pattrib_iv, dot11txpn, keyidx)\\\ndo {\\\n\tpattrib_iv[0] = dot11txpn._byte_.TSC1;\\\n\tpattrib_iv[1] = (dot11txpn._byte_.TSC1 | 0x20) & 0x7f;\\\n\tpattrib_iv[2] = dot11txpn._byte_.TSC0;\\\n\tpattrib_iv[3] = BIT(5) | ((keyidx & 0x3)<<6);\\\n\tpattrib_iv[4] = dot11txpn._byte_.TSC2;\\\n\tpattrib_iv[5] = dot11txpn._byte_.TSC3;\\\n\tpattrib_iv[6] = dot11txpn._byte_.TSC4;\\\n\tpattrib_iv[7] = dot11txpn._byte_.TSC5;\\\n\tdot11txpn.val = dot11txpn.val == 0xffffffffffffULL ? 0 : (dot11txpn.val + 1);\\\n} while (0)\n\n#define AES_IV(pattrib_iv, dot11txpn, keyidx)\\\ndo {\\\n\tpattrib_iv[0] = dot11txpn._byte_.TSC0;\\\n\tpattrib_iv[1] = dot11txpn._byte_.TSC1;\\\n\tpattrib_iv[2] = 0;\\\n\tpattrib_iv[3] = BIT(5) | ((keyidx & 0x3)<<6);\\\n\tpattrib_iv[4] = dot11txpn._byte_.TSC2;\\\n\tpattrib_iv[5] = dot11txpn._byte_.TSC3;\\\n\tpattrib_iv[6] = dot11txpn._byte_.TSC4;\\\n\tpattrib_iv[7] = dot11txpn._byte_.TSC5;\\\n\tdot11txpn.val = dot11txpn.val == 0xffffffffffffULL ? 0 : (dot11txpn.val + 1);\\\n} while (0)\n\n\n#define HWXMIT_ENTRY\t4\n\n \n#define TXDESC_SIZE 40\n\n#define TXDESC_OFFSET TXDESC_SIZE\n\n#define TXDESC_40_BYTES\n\nstruct tx_desc {\n\t__le32 txdw0;\n\t__le32 txdw1;\n\t__le32 txdw2;\n\t__le32 txdw3;\n\t__le32 txdw4;\n\t__le32 txdw5;\n\t__le32 txdw6;\n\t__le32 txdw7;\n\n#if defined(TXDESC_40_BYTES) || defined(TXDESC_64_BYTES)\n\t__le32 txdw8;\n\t__le32 txdw9;\n#endif  \n\n#ifdef TXDESC_64_BYTES\n\t__le32 txdw10;\n\t__le32 txdw11;\n\n\t \n\t \n\t \n\t \n\t__le32 txdw12;\n\t__le32 txdw13;\n\t__le32 txdw14;\n\t__le32 txdw15;\n#endif\n};\n\nunion txdesc {\n\tstruct tx_desc txdesc;\n\tunsigned int value[TXDESC_SIZE>>2];\n};\n\nstruct\thw_xmit\t{\n\t \n\t \n\tstruct __queue *sta_queue;\n\t \n\t \n\tint\taccnt;\n};\n\n \nstruct pkt_attrib {\n\tu8 type;\n\tu8 subtype;\n\tu8 bswenc;\n\tu8 dhcp_pkt;\n\tu16 ether_type;\n\tu16 seqnum;\n\tu16 pkt_hdrlen;\t \n\tu16 hdrlen;\t\t \n\tu32 pktlen;\t\t \n\tu32 last_txcmdsz;\n\tu8 nr_frags;\n\tu8 encrypt;\t \n\tu8 iv_len;\n\tu8 icv_len;\n\tu8 iv[18];\n\tu8 icv[16];\n\tu8 priority;\n\tu8 ack_policy;\n\tu8 mac_id;\n\tu8 vcs_mode;\t \n\tu8 dst[ETH_ALEN];\n\tu8 src[ETH_ALEN];\n\tu8 ta[ETH_ALEN];\n\tu8 ra[ETH_ALEN];\n\tu8 key_idx;\n\tu8 qos_en;\n\tu8 ht_en;\n\tu8 raid; \n\tu8 bwmode;\n\tu8 ch_offset; \n\tu8 sgi; \n\tu8 ampdu_en; \n\tu8 ampdu_spacing;  \n\tu8 mdata; \n\tu8 pctrl; \n\tu8 triggered; \n\tu8 qsel;\n\tu8 order; \n\tu8 eosp;\n\tu8 rate;\n\tu8 intel_proxim;\n\tu8 retry_ctrl;\n\tu8   mbssid;\n\tu8 ldpc;\n\tu8 stbc;\n\tstruct sta_info *psta;\n\n\tu8 rtsen;\n\tu8 cts2self;\n\tunion Keytype\tdot11tkiptxmickey;\n\t \n\tunion Keytype\tdot118021x_UncstKey;\n\n\tu8 icmp_pkt;\n\n};\n\n#define WLANHDR_OFFSET\t64\n\n#define NULL_FRAMETAG\t\t(0x0)\n#define DATA_FRAMETAG\t\t0x01\n#define L2_FRAMETAG\t\t0x02\n#define MGNT_FRAMETAG\t\t0x03\n#define AMSDU_FRAMETAG\t0x04\n\n#define EII_FRAMETAG\t\t0x05\n#define IEEE8023_FRAMETAG  0x06\n\n#define MP_FRAMETAG\t\t0x07\n\n#define TXAGG_FRAMETAG\t0x08\n\nenum {\n\tXMITBUF_DATA = 0,\n\tXMITBUF_MGNT = 1,\n\tXMITBUF_CMD = 2,\n};\n\nstruct  submit_ctx {\n\tunsigned long submit_time;  \n\tu32 timeout_ms;  \n\tint status;  \n\tstruct completion done;\n};\n\nenum {\n\tRTW_SCTX_SUBMITTED = -1,\n\tRTW_SCTX_DONE_SUCCESS = 0,\n\tRTW_SCTX_DONE_UNKNOWN,\n\tRTW_SCTX_DONE_TIMEOUT,\n\tRTW_SCTX_DONE_BUF_ALLOC,\n\tRTW_SCTX_DONE_BUF_FREE,\n\tRTW_SCTX_DONE_WRITE_PORT_ERR,\n\tRTW_SCTX_DONE_TX_DESC_NA,\n\tRTW_SCTX_DONE_TX_DENY,\n\tRTW_SCTX_DONE_CCX_PKT_FAIL,\n\tRTW_SCTX_DONE_DRV_STOP,\n\tRTW_SCTX_DONE_DEV_REMOVE,\n\tRTW_SCTX_DONE_CMD_ERROR,\n};\n\n\nvoid rtw_sctx_init(struct submit_ctx *sctx, int timeout_ms);\nint rtw_sctx_wait(struct submit_ctx *sctx);\nvoid rtw_sctx_done_err(struct submit_ctx **sctx, int status);\nvoid rtw_sctx_done(struct submit_ctx **sctx);\n\nstruct xmit_buf {\n\tstruct list_head\tlist;\n\n\tstruct adapter *padapter;\n\n\tu8 *pallocated_buf;\n\n\tu8 *pbuf;\n\n\tvoid *priv_data;\n\n\tu16 buf_tag;  \n\tu16 flags;\n\tu32 alloc_sz;\n\n\tu32  len;\n\n\tstruct submit_ctx *sctx;\n\n\tu8 *phead;\n\tu8 *pdata;\n\tu8 *ptail;\n\tu8 *pend;\n\tu32 ff_hwaddr;\n\tu8 pg_num;\n\tu8 agg_num;\n\n#if defined(DBG_XMIT_BUF) || defined(DBG_XMIT_BUF_EXT)\n\tu8 no;\n#endif\n\n};\n\n\nstruct xmit_frame {\n\tstruct list_head\tlist;\n\n\tstruct pkt_attrib attrib;\n\n\tstruct sk_buff *pkt;\n\n\tint\tframe_tag;\n\n\tstruct adapter *padapter;\n\n\tu8 *buf_addr;\n\n\tstruct xmit_buf *pxmitbuf;\n\n\tu8 pg_num;\n\tu8 agg_num;\n\n\tu8 ack_report;\n\n\tu8 *alloc_addr;  \n\tu8 ext_tag;  \n\n};\n\nstruct tx_servq {\n\tstruct list_head\ttx_pending;\n\tstruct __queue\tsta_pending;\n\tint qcnt;\n};\n\n\nstruct sta_xmit_priv {\n\tspinlock_t\tlock;\n\tsigned int\toption;\n\tsigned int\tapsd_setting;\t \n\n\n\t \n\tstruct tx_servq\tbe_q;\t\t\t \n\tstruct tx_servq\tbk_q;\t\t\t \n\tstruct tx_servq\tvi_q;\t\t\t \n\tstruct tx_servq\tvo_q;\t\t\t \n\tstruct list_head\tlegacy_dz;\n\tstruct list_head  apsd;\n\n\tu16 txseq_tid[16];\n\n\t \n\t \n\t \n\n\n};\n\n\nstruct\thw_txqueue\t{\n\tvolatile signed int\thead;\n\tvolatile signed int\ttail;\n\tvolatile signed int\tfree_sz;\t \n\tvolatile signed int      free_cmdsz;\n\tvolatile signed int\t txsz[8];\n\tuint\tff_hwaddr;\n\tuint\tcmd_hwaddr;\n\tsigned int\tac_tag;\n};\n\nenum cmdbuf_type {\n\tCMDBUF_BEACON = 0x00,\n\tCMDBUF_RSVD,\n\tCMDBUF_MAX\n};\n\nstruct\txmit_priv {\n\n\tspinlock_t\tlock;\n\n\tstruct completion xmit_comp;\n\tstruct completion terminate_xmitthread_comp;\n\n\t \n\tstruct __queue\tbe_pending;\n\tstruct __queue\tbk_pending;\n\tstruct __queue\tvi_pending;\n\tstruct __queue\tvo_pending;\n\tstruct __queue\tbm_pending;\n\n\t \n\t \n\n\tu8 *pallocated_frame_buf;\n\tu8 *pxmit_frame_buf;\n\tuint free_xmitframe_cnt;\n\tstruct __queue\tfree_xmit_queue;\n\n\t \n\t \n\n\tu8 *xframe_ext_alloc_addr;\n\tu8 *xframe_ext;\n\tuint free_xframe_ext_cnt;\n\tstruct __queue free_xframe_ext_queue;\n\n\t \n\t \n\t \n\t \n\t \n\n\tuint\tfrag_len;\n\n\tstruct adapter\t*adapter;\n\n\tu8   vcs_setting;\n\tu8 vcs;\n\tu8 vcs_type;\n\t \n\n\tu64\ttx_bytes;\n\tu64\ttx_pkts;\n\tu64\ttx_drop;\n\tu64\tlast_tx_pkts;\n\n\tstruct hw_xmit *hwxmits;\n\tu8 hwxmit_entry;\n\n\tu8 wmm_para_seq[4]; \n\n\tvoid *SdioXmitThread;\n\tstruct completion SdioXmitStart;\n\tstruct completion SdioXmitTerminate;\n\n\tstruct __queue free_xmitbuf_queue;\n\tstruct __queue pending_xmitbuf_queue;\n\tu8 *pallocated_xmitbuf;\n\tu8 *pxmitbuf;\n\tuint free_xmitbuf_cnt;\n\n\tstruct __queue free_xmit_extbuf_queue;\n\tu8 *pallocated_xmit_extbuf;\n\tu8 *pxmit_extbuf;\n\tuint free_xmit_extbuf_cnt;\n\n\tstruct xmit_buf\tpcmd_xmitbuf[CMDBUF_MAX];\n\n\tu16 nqos_ssn;\n\n\tint\tack_tx;\n\tstruct mutex ack_tx_mutex;\n\tstruct submit_ctx ack_tx_ops;\n\tu8 seq_no;\n\tspinlock_t lock_sctx;\n};\n\nextern struct xmit_frame *__rtw_alloc_cmdxmitframe(struct xmit_priv *pxmitpriv,\n\t\tenum cmdbuf_type buf_type);\n#define rtw_alloc_cmdxmitframe(p) __rtw_alloc_cmdxmitframe(p, CMDBUF_RSVD)\n#define rtw_alloc_bcnxmitframe(p) __rtw_alloc_cmdxmitframe(p, CMDBUF_BEACON)\n\nextern struct xmit_buf *rtw_alloc_xmitbuf_ext(struct xmit_priv *pxmitpriv);\nextern s32 rtw_free_xmitbuf_ext(struct xmit_priv *pxmitpriv, struct xmit_buf *pxmitbuf);\n\nextern struct xmit_buf *rtw_alloc_xmitbuf(struct xmit_priv *pxmitpriv);\nextern s32 rtw_free_xmitbuf(struct xmit_priv *pxmitpriv, struct xmit_buf *pxmitbuf);\n\nvoid rtw_count_tx_stats(struct adapter *padapter, struct xmit_frame *pxmitframe, int sz);\nextern void rtw_update_protection(struct adapter *padapter, u8 *ie, uint ie_len);\nextern s32 rtw_make_wlanhdr(struct adapter *padapter, u8 *hdr, struct pkt_attrib *pattrib);\nextern s32 rtw_put_snap(u8 *data, u16 h_proto);\n\nextern struct xmit_frame *rtw_alloc_xmitframe(struct xmit_priv *pxmitpriv);\nstruct xmit_frame *rtw_alloc_xmitframe_ext(struct xmit_priv *pxmitpriv);\nstruct xmit_frame *rtw_alloc_xmitframe_once(struct xmit_priv *pxmitpriv);\nextern s32 rtw_free_xmitframe(struct xmit_priv *pxmitpriv, struct xmit_frame *pxmitframe);\nextern void rtw_free_xmitframe_queue(struct xmit_priv *pxmitpriv, struct __queue *pframequeue);\nstruct tx_servq *rtw_get_sta_pending(struct adapter *padapter, struct sta_info *psta, signed int up, u8 *ac);\nextern s32 rtw_xmitframe_enqueue(struct adapter *padapter, struct xmit_frame *pxmitframe);\n\nextern s32 rtw_xmit_classifier(struct adapter *padapter, struct xmit_frame *pxmitframe);\nextern u32 rtw_calculate_wlan_pkt_size_by_attribue(struct pkt_attrib *pattrib);\n#define rtw_wlan_pkt_size(f) rtw_calculate_wlan_pkt_size_by_attribue(&f->attrib)\nextern s32 rtw_xmitframe_coalesce(struct adapter *padapter, struct sk_buff *pkt, struct xmit_frame *pxmitframe);\nextern s32 rtw_mgmt_xmitframe_coalesce(struct adapter *padapter, struct sk_buff *pkt, struct xmit_frame *pxmitframe);\ns32 _rtw_init_hw_txqueue(struct hw_txqueue *phw_txqueue, u8 ac_tag);\nvoid _rtw_init_sta_xmit_priv(struct sta_xmit_priv *psta_xmitpriv);\n\n\ns32 rtw_txframes_pending(struct adapter *padapter);\nvoid rtw_init_hwxmits(struct hw_xmit *phwxmit, signed int entry);\n\n\ns32 _rtw_init_xmit_priv(struct xmit_priv *pxmitpriv, struct adapter *padapter);\nvoid _rtw_free_xmit_priv(struct xmit_priv *pxmitpriv);\n\n\ns32 rtw_alloc_hwxmits(struct adapter *padapter);\nvoid rtw_free_hwxmits(struct adapter *padapter);\n\n\ns32 rtw_xmit(struct adapter *padapter, struct sk_buff **pkt);\nbool xmitframe_hiq_filter(struct xmit_frame *xmitframe);\n\nsigned int xmitframe_enqueue_for_sleeping_sta(struct adapter *padapter, struct xmit_frame *pxmitframe);\nvoid stop_sta_xmit(struct adapter *padapter, struct sta_info *psta);\nvoid wakeup_sta_to_xmit(struct adapter *padapter, struct sta_info *psta);\nvoid xmit_delivery_enabled_frames(struct adapter *padapter, struct sta_info *psta);\n\nu8 query_ra_short_GI(struct sta_info *psta);\n\nu8 qos_acm(u8 acm_mask, u8 priority);\n\nvoid enqueue_pending_xmitbuf(struct xmit_priv *pxmitpriv, struct xmit_buf *pxmitbuf);\nvoid enqueue_pending_xmitbuf_to_head(struct xmit_priv *pxmitpriv, struct xmit_buf *pxmitbuf);\nstruct xmit_buf *dequeue_pending_xmitbuf(struct xmit_priv *pxmitpriv);\nstruct xmit_buf *dequeue_pending_xmitbuf_under_survey(struct xmit_priv *pxmitpriv);\nsigned int\tcheck_pending_xmitbuf(struct xmit_priv *pxmitpriv);\nint\trtw_xmit_thread(void *context);\n\nu32 rtw_get_ff_hwaddr(struct xmit_frame\t*pxmitframe);\n\nint rtw_ack_tx_wait(struct xmit_priv *pxmitpriv, u32 timeout_ms);\nvoid rtw_ack_tx_done(struct xmit_priv *pxmitpriv, int status);\n\n \n#include <xmit_osdep.h>\n\n#endif\t \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}