{
  "module_name": "rtw_security.h",
  "hash_id": "df651cc3f5498b5fe64f03bd0e2e844fd63e147aacaecc70c6328a8da9eba041",
  "original_prompt": "Ingested from linux-6.6.14/drivers/staging/rtl8723bs/include/rtw_security.h",
  "human_readable_source": " \n \n#ifndef __RTW_SECURITY_H_\n#define __RTW_SECURITY_H_\n\n#include <crypto/arc4.h>\n\n#define _NO_PRIVACY_\t\t0x0\n#define _WEP40_\t\t\t\t0x1\n#define _TKIP_\t\t\t\t0x2\n#define _TKIP_WTMIC_\t\t0x3\n#define _AES_\t\t\t\t0x4\n#define _WEP104_\t\t\t0x5\n#define _WEP_WPA_MIXED_\t0x07   \n#define _SMS4_\t\t\t\t0x06\n#define _BIP_\t\t\t\t0x8\n#define is_wep_enc(alg) (((alg) == _WEP40_) || ((alg) == _WEP104_))\n\nconst char *security_type_str(u8 value);\n\n#define SHA256_MAC_LEN 32\n#define AES_BLOCK_SIZE 16\n#define AES_PRIV_SIZE (4 * 44)\n\n#define RTW_KEK_LEN 16\n#define RTW_KCK_LEN 16\n#define RTW_REPLAY_CTR_LEN 8\n\nenum {\n\tENCRYP_PROTOCOL_OPENSYS,    \n\tENCRYP_PROTOCOL_WEP,        \n\tENCRYP_PROTOCOL_WPA,        \n\tENCRYP_PROTOCOL_WPA2,       \n\tENCRYP_PROTOCOL_WAPI,       \n\tENCRYP_PROTOCOL_MAX\n};\n\n\n#ifndef Ndis802_11AuthModeWPA2\n#define Ndis802_11AuthModeWPA2 (Ndis802_11AuthModeWPANone + 1)\n#endif\n\n#ifndef Ndis802_11AuthModeWPA2PSK\n#define Ndis802_11AuthModeWPA2PSK (Ndis802_11AuthModeWPANone + 2)\n#endif\n\nunion pn48\t{\n\n\tu64\tval;\n\n#ifdef __LITTLE_ENDIAN\n\nstruct {\n  u8 TSC0;\n  u8 TSC1;\n  u8 TSC2;\n  u8 TSC3;\n  u8 TSC4;\n  u8 TSC5;\n  u8 TSC6;\n  u8 TSC7;\n} _byte_;\n#else\nstruct {\n  u8 TSC7;\n  u8 TSC6;\n  u8 TSC5;\n  u8 TSC4;\n  u8 TSC3;\n  u8 TSC2;\n  u8 TSC1;\n  u8 TSC0;\n} _byte_;\n#endif\n\n};\n\nunion Keytype {\n        u8   skey[16];\n        u32    lkey[4];\n};\n\n\nstruct rt_pmkid_list {\n\tu8 \t\t\t\tbUsed;\n\tu8 \t\t\t\tBssid[6];\n\tu8 \t\t\t\tPMKID[16];\n\tu8 \t\t\t\tSsidBuf[33];\n\tu8 *ssid_octet;\n\tu16 \t\t\t\t\tssid_length;\n};\n\n\nstruct security_priv {\n\tu32   dot11AuthAlgrthm;\t\t \n\tu32   dot11PrivacyAlgrthm;\t \n\n\t \n\tu32   dot11PrivacyKeyIndex;\t \n\tunion Keytype dot11DefKey[4];\t \n\tu32 dot11DefKeylen[4];\n\tu8 key_mask;  \n\n\tu32 dot118021XGrpPrivacy;\t \n\tu32 dot118021XGrpKeyid;\t\t \n\tunion Keytype\tdot118021XGrpKey[BIP_MAX_KEYID + 1];\t \n\tunion Keytype\tdot118021XGrptxmickey[BIP_MAX_KEYID + 1];\n\tunion Keytype\tdot118021XGrprxmickey[BIP_MAX_KEYID + 1];\n\tunion pn48\t\tdot11Grptxpn;\t\t\t \n\tunion pn48\t\tdot11Grprxpn;\t\t\t \n\tu32 dot11wBIPKeyid;\t\t\t\t\t\t \n\tunion Keytype\tdot11wBIPKey[BIP_MAX_KEYID + 1];\t \n\tunion pn48\t\tdot11wBIPtxpn;\t\t\t \n\tunion pn48\t\tdot11wBIPrxpn;\t\t\t \n\n\t \n\tunsigned int dot8021xalg; \n\tunsigned int wpa_psk; \n\tunsigned int wpa_group_cipher;\n\tunsigned int wpa2_group_cipher;\n\tunsigned int wpa_pairwise_cipher;\n\tunsigned int wpa2_pairwise_cipher;\n\n\tu8 wps_ie[MAX_WPS_IE_LEN]; \n\tint wps_ie_len;\n\n\tstruct arc4_ctx xmit_arc4_ctx;\n\tstruct arc4_ctx recv_arc4_ctx;\n\n\tu8 binstallGrpkey;\n\tu8 binstallBIPkey;\n\tu8 busetkipkey;\n\t \n\tu8 bcheck_grpkey;\n\tu8 bgrpkey_handshake;\n\n\ts32\tsw_encrypt; \n\ts32\tsw_decrypt; \n\n\ts32\thw_decrypted; \n\n\n\t \n\tu32 ndisauthtype;\t \n\tu32 ndisencryptstatus;\t \n\n\tstruct wlan_bssid_ex sec_bss;   \n\n\tstruct ndis_802_11_wep ndiswep;\n\n\tu8 assoc_info[600];\n\tu8 szofcapability[256];  \n\tu8 oidassociation[512];  \n\tu8 authenticator_ie[256];   \n\tu8 supplicant_ie[256];   \n\n\n\t \n\tunsigned long last_mic_err_time;\n\tu8 btkip_countermeasure;\n\tu8 btkip_wait_report;\n\tu32 btkip_countermeasure_time;\n\n\t \n\tstruct rt_pmkid_list\t\tPMKIDList[NUM_PMKID_CACHE];\t \n\tu8 \t\tPMKIDIndex;\n\n\tu8 bWepDefaultKeyIdxSet;\n\n};\n\n#define GET_ENCRY_ALGO(psecuritypriv, psta, encry_algo, bmcst)\\\ndo {\\\n\tswitch (psecuritypriv->dot11AuthAlgrthm)\\\n\t{\\\n\t\tcase dot11AuthAlgrthm_Open:\\\n\t\tcase dot11AuthAlgrthm_Shared:\\\n\t\tcase dot11AuthAlgrthm_Auto:\\\n\t\t\tencry_algo = (u8)psecuritypriv->dot11PrivacyAlgrthm;\\\n\t\t\tbreak;\\\n\t\tcase dot11AuthAlgrthm_8021X:\\\n\t\t\tif (bmcst)\\\n\t\t\t\tencry_algo = (u8)psecuritypriv->dot118021XGrpPrivacy;\\\n\t\t\telse\\\n\t\t\t\tencry_algo = (u8)psta->dot118021XPrivacy;\\\n\t\t\tbreak;\\\n\t     case dot11AuthAlgrthm_WAPI:\\\n\t\t     encry_algo = (u8)psecuritypriv->dot11PrivacyAlgrthm;\\\n\t\t     break;\\\n\t} \\\n} while (0)\n\n#define SET_ICE_IV_LEN(iv_len, icv_len, encrypt)\\\ndo {\\\n\tswitch (encrypt)\\\n\t{\\\n\t\tcase _WEP40_:\\\n\t\tcase _WEP104_:\\\n\t\t\tiv_len = 4;\\\n\t\t\ticv_len = 4;\\\n\t\t\tbreak;\\\n\t\tcase _TKIP_:\\\n\t\t\tiv_len = 8;\\\n\t\t\ticv_len = 4;\\\n\t\t\tbreak;\\\n\t\tcase _AES_:\\\n\t\t\tiv_len = 8;\\\n\t\t\ticv_len = 8;\\\n\t\t\tbreak;\\\n\t\tcase _SMS4_:\\\n\t\t\tiv_len = 18;\\\n\t\t\ticv_len = 16;\\\n\t\t\tbreak;\\\n\t\tdefault:\\\n\t\t\tiv_len = 0;\\\n\t\t\ticv_len = 0;\\\n\t\t\tbreak;\\\n\t} \\\n} while (0)\n\n\n#define GET_TKIP_PN(iv, dot11txpn)\\\ndo {\\\n\tdot11txpn._byte_.TSC0 = iv[2];\\\n\tdot11txpn._byte_.TSC1 = iv[0];\\\n\tdot11txpn._byte_.TSC2 = iv[4];\\\n\tdot11txpn._byte_.TSC3 = iv[5];\\\n\tdot11txpn._byte_.TSC4 = iv[6];\\\n\tdot11txpn._byte_.TSC5 = iv[7];\\\n} while (0)\n\n\n#define ROL32(A, n)\t(((A) << (n)) | (((A)>>(32-(n)))  & ((1UL << (n)) - 1)))\n#define ROR32(A, n)\tROL32((A), 32-(n))\n\nstruct mic_data {\n\tu32  K0, K1;          \n\tu32  L, R;            \n\tu32  M;               \n\tu32     nBytesInM;       \n};\n\n \n\n \n\nint omac1_aes_128(u8 *key, u8 *data, size_t data_len, u8 *mac);\nvoid rtw_secmicsetkey(struct mic_data *pmicdata, u8 *key);\nvoid rtw_secmicappendbyte(struct mic_data *pmicdata, u8 b);\nvoid rtw_secmicappend(struct mic_data *pmicdata, u8 *src, u32 nBytes);\nvoid rtw_secgetmic(struct mic_data *pmicdata, u8 *dst);\n\nvoid rtw_seccalctkipmic(\n\tu8 *key,\n\tu8 *header,\n\tu8 *data,\n\tu32 data_len,\n\tu8 *Miccode,\n\tu8   priority);\n\nu32 rtw_aes_encrypt(struct adapter *padapter, u8 *pxmitframe);\nu32 rtw_tkip_encrypt(struct adapter *padapter, u8 *pxmitframe);\nvoid rtw_wep_encrypt(struct adapter *padapter, u8  *pxmitframe);\n\nu32 rtw_aes_decrypt(struct adapter *padapter, u8  *precvframe);\nu32 rtw_tkip_decrypt(struct adapter *padapter, u8  *precvframe);\nvoid rtw_wep_decrypt(struct adapter *padapter, u8  *precvframe);\nu32 rtw_BIP_verify(struct adapter *padapter, u8 *precvframe);\n\nvoid rtw_sec_restore_wep_key(struct adapter *adapter);\nu8 rtw_handle_tkip_countermeasure(struct adapter *adapter, const char *caller);\n\n#endif\t \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}