{
  "module_name": "HalPwrSeqCmd.c",
  "hash_id": "818fd858c0ba69321426faa50be1493aabd075de34b25369219b071fee5ffc18",
  "original_prompt": "Ingested from linux-6.6.14/drivers/staging/rtl8723bs/hal/HalPwrSeqCmd.c",
  "human_readable_source": "\n \n \n#include <drv_types.h>\n#include <rtw_debug.h>\n#include <HalPwrSeqCmd.h>\n\n\n \n \n \n \n \n \n \n \n \nu8 HalPwrSeqCmdParsing(\n\tstruct adapter *padapter,\n\tu8 CutVersion,\n\tu8 FabVersion,\n\tu8 InterfaceType,\n\tstruct wlan_pwr_cfg PwrSeqCmd[]\n)\n{\n\tstruct wlan_pwr_cfg PwrCfgCmd;\n\tu8 bPollingBit = false;\n\tu32 AryIdx = 0;\n\tu8 value = 0;\n\tu32 offset = 0;\n\tu32 pollingCount = 0;  \n\tu32 maxPollingCnt = 5000;\n\n\tdo {\n\t\tPwrCfgCmd = PwrSeqCmd[AryIdx];\n\n\t\t \n\t\tif (\n\t\t\t(GET_PWR_CFG_FAB_MASK(PwrCfgCmd) & FabVersion) &&\n\t\t\t(GET_PWR_CFG_CUT_MASK(PwrCfgCmd) & CutVersion) &&\n\t\t\t(GET_PWR_CFG_INTF_MASK(PwrCfgCmd) & InterfaceType)\n\t\t) {\n\t\t\tswitch (GET_PWR_CFG_CMD(PwrCfgCmd)) {\n\t\t\tcase PWR_CMD_READ:\n\t\t\t\tbreak;\n\n\t\t\tcase PWR_CMD_WRITE:\n\t\t\t\toffset = GET_PWR_CFG_OFFSET(PwrCfgCmd);\n\n\t\t\t\t \n\t\t\t\t \n\t\t\t\t \n\t\t\t\t \n\t\t\t\tif (GET_PWR_CFG_BASE(PwrCfgCmd) == PWR_BASEADDR_SDIO) {\n\t\t\t\t\t \n\t\t\t\t\tvalue = SdioLocalCmd52Read1Byte(padapter, offset);\n\n\t\t\t\t\tvalue &= ~(GET_PWR_CFG_MASK(PwrCfgCmd));\n\t\t\t\t\tvalue |= (\n\t\t\t\t\t\tGET_PWR_CFG_VALUE(PwrCfgCmd) &\n\t\t\t\t\t\tGET_PWR_CFG_MASK(PwrCfgCmd)\n\t\t\t\t\t);\n\n\t\t\t\t\t \n\t\t\t\t\tSdioLocalCmd52Write1Byte(padapter, offset, value);\n\t\t\t\t} else {\n\t\t\t\t\t \n\t\t\t\t\tvalue = rtw_read8(padapter, offset);\n\n\t\t\t\t\tvalue &= (~(GET_PWR_CFG_MASK(PwrCfgCmd)));\n\t\t\t\t\tvalue |= (\n\t\t\t\t\t\tGET_PWR_CFG_VALUE(PwrCfgCmd)\n\t\t\t\t\t\t&GET_PWR_CFG_MASK(PwrCfgCmd)\n\t\t\t\t\t);\n\n\t\t\t\t\t \n\t\t\t\t\trtw_write8(padapter, offset, value);\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase PWR_CMD_POLLING:\n\n\t\t\t\tbPollingBit = false;\n\t\t\t\toffset = GET_PWR_CFG_OFFSET(PwrCfgCmd);\n\t\t\t\tdo {\n\t\t\t\t\tif (GET_PWR_CFG_BASE(PwrCfgCmd) == PWR_BASEADDR_SDIO)\n\t\t\t\t\t\tvalue = SdioLocalCmd52Read1Byte(padapter, offset);\n\t\t\t\t\telse\n\t\t\t\t\t\tvalue = rtw_read8(padapter, offset);\n\n\t\t\t\t\tvalue = value&GET_PWR_CFG_MASK(PwrCfgCmd);\n\t\t\t\t\tif (\n\t\t\t\t\t\tvalue == (GET_PWR_CFG_VALUE(PwrCfgCmd) &\n\t\t\t\t\t\tGET_PWR_CFG_MASK(PwrCfgCmd))\n\t\t\t\t\t)\n\t\t\t\t\t\tbPollingBit = true;\n\t\t\t\t\telse\n\t\t\t\t\t\tudelay(10);\n\n\t\t\t\t\tif (pollingCount++ > maxPollingCnt)\n\t\t\t\t\t\treturn false;\n\n\t\t\t\t} while (!bPollingBit);\n\n\t\t\t\tbreak;\n\n\t\t\tcase PWR_CMD_DELAY:\n\t\t\t\tif (GET_PWR_CFG_VALUE(PwrCfgCmd) == PWRSEQ_DELAY_US)\n\t\t\t\t\tudelay(GET_PWR_CFG_OFFSET(PwrCfgCmd));\n\t\t\t\telse\n\t\t\t\t\tudelay(GET_PWR_CFG_OFFSET(PwrCfgCmd)*1000);\n\t\t\t\tbreak;\n\n\t\t\tcase PWR_CMD_END:\n\t\t\t\t \n\t\t\t\treturn true;\n\n\t\t\tdefault:\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tAryIdx++; \n\t} while (1);\n\n\treturn true;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}