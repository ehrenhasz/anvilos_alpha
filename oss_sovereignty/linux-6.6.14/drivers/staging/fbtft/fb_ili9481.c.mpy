{
  "module_name": "fb_ili9481.c",
  "hash_id": "c8b992d72c4a1a776ada52e955c1953000d2e50f1e447b497b877640a970d587",
  "original_prompt": "Ingested from linux-6.6.14/drivers/staging/fbtft/fb_ili9481.c",
  "human_readable_source": "\n \n\n#include <linux/module.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <video/mipi_display.h>\n\n#include \"fbtft.h\"\n\n#define DRVNAME\t\"fb_ili9481\"\n#define WIDTH\t\t320\n#define HEIGHT\t\t480\n\nstatic const s16 default_init_sequence[] = {\n\t \n\t-1, MIPI_DCS_EXIT_SLEEP_MODE,\n\t-2, 50,\n\t \n\t-1, 0xD0, 0x07, 0x42, 0x18,\n\t \n\t-1, 0xD1, 0x00, 0x07, 0x10,\n\t \n\t-1, 0xD2, 0x01, 0x02,\n\t \n\t-1, 0xC0, 0x10, 0x3B, 0x00, 0x02, 0x11,\n\t \n\t-1, 0xC5, 0x03,\n\t \n\t-1, MIPI_DCS_SET_PIXEL_FORMAT, 0x55,\n\t \n\t-1, 0xC8, 0x00, 0x32, 0x36, 0x45, 0x06, 0x16,\n\t\t  0x37, 0x75, 0x77, 0x54, 0x0C, 0x00,\n\t \n\t-1, MIPI_DCS_SET_DISPLAY_ON,\n\t-3\n};\n\nstatic void set_addr_win(struct fbtft_par *par, int xs, int ys, int xe, int ye)\n{\n\twrite_reg(par, MIPI_DCS_SET_COLUMN_ADDRESS,\n\t\t  xs >> 8, xs & 0xff, xe >> 8, xe & 0xff);\n\n\twrite_reg(par, MIPI_DCS_SET_PAGE_ADDRESS,\n\t\t  ys >> 8, ys & 0xff, ye >> 8, ye & 0xff);\n\n\twrite_reg(par, MIPI_DCS_WRITE_MEMORY_START);\n}\n\n#define HFLIP 0x01\n#define VFLIP 0x02\n#define ROW_X_COL 0x20\nstatic int set_var(struct fbtft_par *par)\n{\n\tswitch (par->info->var.rotate) {\n\tcase 270:\n\t\twrite_reg(par, MIPI_DCS_SET_ADDRESS_MODE,\n\t\t\t  ROW_X_COL | HFLIP | VFLIP | (par->bgr << 3));\n\t\tbreak;\n\tcase 180:\n\t\twrite_reg(par, MIPI_DCS_SET_ADDRESS_MODE,\n\t\t\t  VFLIP | (par->bgr << 3));\n\t\tbreak;\n\tcase 90:\n\t\twrite_reg(par, MIPI_DCS_SET_ADDRESS_MODE,\n\t\t\t  ROW_X_COL | (par->bgr << 3));\n\t\tbreak;\n\tdefault:\n\t\twrite_reg(par, MIPI_DCS_SET_ADDRESS_MODE,\n\t\t\t  HFLIP | (par->bgr << 3));\n\t\tbreak;\n\t}\n\n\treturn 0;\n}\n\nstatic struct fbtft_display display = {\n\t.regwidth = 8,\n\t.width = WIDTH,\n\t.height = HEIGHT,\n\t.init_sequence = default_init_sequence,\n\t.fbtftops = {\n\t\t.set_addr_win = set_addr_win,\n\t\t.set_var = set_var,\n\t},\n};\n\nFBTFT_REGISTER_DRIVER(DRVNAME, \"ilitek,ili9481\", &display);\n\nMODULE_ALIAS(\"spi:\" DRVNAME);\nMODULE_ALIAS(\"platform:\" DRVNAME);\nMODULE_ALIAS(\"spi:ili9481\");\nMODULE_ALIAS(\"platform:ili9481\");\n\nMODULE_DESCRIPTION(\"FB driver for the ILI9481 LCD Controller\");\nMODULE_AUTHOR(\"Petr Olivka\");\nMODULE_LICENSE(\"GPL\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}