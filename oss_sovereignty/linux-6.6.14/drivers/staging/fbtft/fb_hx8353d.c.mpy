{
  "module_name": "fb_hx8353d.c",
  "hash_id": "6ae3ec7c8109972c92a943e419c69b0be75bb6898fb4e7e8ed9cfb6d33166567",
  "original_prompt": "Ingested from linux-6.6.14/drivers/staging/fbtft/fb_hx8353d.c",
  "human_readable_source": "\n \n\n#include <linux/module.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n#include <video/mipi_display.h>\n\n#include \"fbtft.h\"\n\n#define DRVNAME \"fb_hx8353d\"\n#define DEFAULT_GAMMA \"50 77 40 08 BF 00 03 0F 00 01 73 00 72 03 B0 0F 08 00 0F\"\n\nstatic int init_display(struct fbtft_par *par)\n{\n\tpar->fbtftops.reset(par);\n\tmdelay(150);\n\n\t \n\twrite_reg(par, 0xB9, 0xFF, 0x83, 0x53);\n\n\t \n\twrite_reg(par, 0xB0, 0x3C, 0x01);\n\n\t \n\twrite_reg(par, 0xB6, 0x94, 0x6C, 0x50);\n\n\t \n\twrite_reg(par, 0xB1, 0x00, 0x01, 0x1B, 0x03, 0x01, 0x08, 0x77, 0x89);\n\n\t \n\twrite_reg(par, 0x3A, 0x05);\n\n\t \n\twrite_reg(par, MIPI_DCS_SET_ADDRESS_MODE, 0xC0);\n\n\t \n\twrite_reg(par, MIPI_DCS_EXIT_SLEEP_MODE);\n\tmdelay(150);\n\n\t \n\twrite_reg(par, MIPI_DCS_SET_DISPLAY_ON);\n\n\t \n\twrite_reg(par, MIPI_DCS_WRITE_LUT,\n\t\t  0,  2,  4,  6,  8, 10, 12, 14, 16, 18, 20, 22, 24, 26, 28, 30,\n\t\t32, 34, 36, 38, 40, 42, 44, 46, 48, 50, 52, 54, 56, 58, 60, 62,\n\t\t 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15,\n\t\t16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31,\n\t\t32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47,\n\t\t48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63,\n\t\t 0,  2,  4,  6,  8, 10, 12, 14, 16, 18, 20, 22, 24, 26, 28, 30,\n\t\t32, 34, 36, 38, 40, 42, 44, 46, 48, 50, 52, 54, 56, 58, 60, 62);\n\n\treturn 0;\n};\n\nstatic void set_addr_win(struct fbtft_par *par, int xs, int ys, int xe, int ye)\n{\n\t \n\twrite_reg(par, 0x2a, xs >> 8, xs & 0xff, xe >> 8, xe & 0xff);\n\n\t \n\twrite_reg(par, 0x2b, ys >> 8, ys & 0xff, ye >> 8, ye & 0xff);\n\n\t \n\twrite_reg(par, 0x2c);\n}\n\n#define my BIT(7)\n#define mx BIT(6)\n#define mv BIT(5)\nstatic int set_var(struct fbtft_par *par)\n{\n\t \n\tswitch (par->info->var.rotate) {\n\tcase 0:\n\t\twrite_reg(par, MIPI_DCS_SET_ADDRESS_MODE,\n\t\t\t  mx | my | (par->bgr << 3));\n\t\tbreak;\n\tcase 270:\n\t\twrite_reg(par, MIPI_DCS_SET_ADDRESS_MODE,\n\t\t\t  my | mv | (par->bgr << 3));\n\t\tbreak;\n\tcase 180:\n\t\twrite_reg(par, MIPI_DCS_SET_ADDRESS_MODE,\n\t\t\t  par->bgr << 3);\n\t\tbreak;\n\tcase 90:\n\t\twrite_reg(par, MIPI_DCS_SET_ADDRESS_MODE,\n\t\t\t  mx | mv | (par->bgr << 3));\n\t\tbreak;\n\t}\n\n\treturn 0;\n}\n\n \nstatic int set_gamma(struct fbtft_par *par, u32 *curves)\n{\n\twrite_reg(par, 0xE0,\n\t\t  curves[0], curves[1], curves[2], curves[3],\n\t\t  curves[4], curves[5], curves[6], curves[7],\n\t\t  curves[8], curves[9], curves[10], curves[11],\n\t\t  curves[12], curves[13], curves[14], curves[15],\n\t\t  curves[16], curves[17], curves[18]);\n\n\treturn 0;\n}\n\nstatic struct fbtft_display display = {\n\t.regwidth = 8,\n\t.width = 128,\n\t.height = 160,\n\t.gamma_num = 1,\n\t.gamma_len = 19,\n\t.gamma = DEFAULT_GAMMA,\n\t.fbtftops = {\n\t\t.init_display = init_display,\n\t\t.set_addr_win = set_addr_win,\n\t\t.set_var = set_var,\n\t\t.set_gamma = set_gamma,\n\t},\n};\n\nFBTFT_REGISTER_DRIVER(DRVNAME, \"himax,hx8353d\", &display);\n\nMODULE_ALIAS(\"spi:\" DRVNAME);\nMODULE_ALIAS(\"platform:\" DRVNAME);\nMODULE_ALIAS(\"spi:hx8353d\");\nMODULE_ALIAS(\"platform:hx8353d\");\n\nMODULE_DESCRIPTION(\"FB driver for the HX8353D LCD Controller\");\nMODULE_AUTHOR(\"Petr Olivka\");\nMODULE_LICENSE(\"GPL\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}