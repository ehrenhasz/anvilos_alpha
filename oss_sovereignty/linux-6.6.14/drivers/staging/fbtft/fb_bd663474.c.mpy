{
  "module_name": "fb_bd663474.c",
  "hash_id": "252ee51791aacc20547e28544e372740da2f7527cfb26eb9d509494adad3ad72",
  "original_prompt": "Ingested from linux-6.6.14/drivers/staging/fbtft/fb_bd663474.c",
  "human_readable_source": "\n \n\n#include <linux/module.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/delay.h>\n\n#include \"fbtft.h\"\n\n#define DRVNAME\t\t\"fb_bd663474\"\n#define WIDTH\t\t240\n#define HEIGHT\t\t320\n#define BPP\t\t16\n\nstatic int init_display(struct fbtft_par *par)\n{\n\tpar->fbtftops.reset(par);\n\n\t \n\n\t \n\twrite_reg(par, 0x000, 0x0001);\t \n\tmdelay(10);\n\n\t \n\twrite_reg(par, 0x100, 0x0000);  \n\twrite_reg(par, 0x101, 0x0000);\n\twrite_reg(par, 0x102, 0x3110);\n\twrite_reg(par, 0x103, 0xe200);\n\twrite_reg(par, 0x110, 0x009d);\n\twrite_reg(par, 0x111, 0x0022);\n\twrite_reg(par, 0x100, 0x0120);\n\tmdelay(20);\n\n\twrite_reg(par, 0x100, 0x3120);\n\tmdelay(80);\n\t \n\twrite_reg(par, 0x001, 0x0100);\n\twrite_reg(par, 0x002, 0x0000);\n\twrite_reg(par, 0x003, 0x1230);\n\twrite_reg(par, 0x006, 0x0000);\n\twrite_reg(par, 0x007, 0x0101);\n\twrite_reg(par, 0x008, 0x0808);\n\twrite_reg(par, 0x009, 0x0000);\n\twrite_reg(par, 0x00b, 0x0000);\n\twrite_reg(par, 0x00c, 0x0000);\n\twrite_reg(par, 0x00d, 0x0018);\n\t \n\twrite_reg(par, 0x012, 0x0000);\n\twrite_reg(par, 0x013, 0x0000);\n\twrite_reg(par, 0x018, 0x0000);\n\twrite_reg(par, 0x019, 0x0000);\n\n\twrite_reg(par, 0x203, 0x0000);\n\twrite_reg(par, 0x204, 0x0000);\n\n\twrite_reg(par, 0x210, 0x0000);\n\twrite_reg(par, 0x211, 0x00ef);\n\twrite_reg(par, 0x212, 0x0000);\n\twrite_reg(par, 0x213, 0x013f);\n\twrite_reg(par, 0x214, 0x0000);\n\twrite_reg(par, 0x215, 0x0000);\n\twrite_reg(par, 0x216, 0x0000);\n\twrite_reg(par, 0x217, 0x0000);\n\n\t \n\twrite_reg(par, 0x300, 0x5343);\n\twrite_reg(par, 0x301, 0x1021);\n\twrite_reg(par, 0x302, 0x0003);\n\twrite_reg(par, 0x303, 0x0011);\n\twrite_reg(par, 0x304, 0x050a);\n\twrite_reg(par, 0x305, 0x4342);\n\twrite_reg(par, 0x306, 0x1100);\n\twrite_reg(par, 0x307, 0x0003);\n\twrite_reg(par, 0x308, 0x1201);\n\twrite_reg(par, 0x309, 0x050a);\n\n\t \n\twrite_reg(par, 0x400, 0x4027);\n\twrite_reg(par, 0x401, 0x0000);\n\twrite_reg(par, 0x402, 0x0000);   \n\twrite_reg(par, 0x403, 0x013f);   \n\twrite_reg(par, 0x404, 0x0000);\n\n\twrite_reg(par, 0x200, 0x0000);\n\twrite_reg(par, 0x201, 0x0000);\n\twrite_reg(par, 0x100, 0x7120);\n\twrite_reg(par, 0x007, 0x0103);\n\tmdelay(10);\n\twrite_reg(par, 0x007, 0x0113);\n\n\treturn 0;\n}\n\nstatic void set_addr_win(struct fbtft_par *par, int xs, int ys, int xe, int ye)\n{\n\tswitch (par->info->var.rotate) {\n\t \n\t \n\tcase 0:\n\t\twrite_reg(par, 0x0200, xs);\n\t\twrite_reg(par, 0x0201, ys);\n\t\tbreak;\n\tcase 180:\n\t\twrite_reg(par, 0x0200, WIDTH - 1 - xs);\n\t\twrite_reg(par, 0x0201, HEIGHT - 1 - ys);\n\t\tbreak;\n\tcase 270:\n\t\twrite_reg(par, 0x0200, WIDTH - 1 - ys);\n\t\twrite_reg(par, 0x0201, xs);\n\t\tbreak;\n\tcase 90:\n\t\twrite_reg(par, 0x0200, ys);\n\t\twrite_reg(par, 0x0201, HEIGHT - 1 - xs);\n\t\tbreak;\n\t}\n\twrite_reg(par, 0x202);  \n}\n\nstatic int set_var(struct fbtft_par *par)\n{\n\tswitch (par->info->var.rotate) {\n\t \n\tcase 0:\n\t\twrite_reg(par, 0x003, 0x1230);\n\t\tbreak;\n\tcase 180:\n\t\twrite_reg(par, 0x003, 0x1200);\n\t\tbreak;\n\tcase 270:\n\t\twrite_reg(par, 0x003, 0x1228);\n\t\tbreak;\n\tcase 90:\n\t\twrite_reg(par, 0x003, 0x1218);\n\t\tbreak;\n\t}\n\n\treturn 0;\n}\n\nstatic struct fbtft_display display = {\n\t.regwidth = 16,\n\t.width = WIDTH,\n\t.height = HEIGHT,\n\t.bpp = BPP,\n\t.fbtftops = {\n\t\t.init_display = init_display,\n\t\t.set_addr_win = set_addr_win,\n\t\t.set_var = set_var,\n\t},\n};\n\nFBTFT_REGISTER_DRIVER(DRVNAME, \"hitachi,bd663474\", &display);\n\nMODULE_ALIAS(\"spi:\" DRVNAME);\nMODULE_ALIAS(\"platform:\" DRVNAME);\nMODULE_ALIAS(\"spi:bd663474\");\nMODULE_ALIAS(\"platform:bd663474\");\n\nMODULE_DESCRIPTION(\"FB driver for the uPD161704 LCD Controller\");\nMODULE_AUTHOR(\"Seong-Woo Kim\");\nMODULE_LICENSE(\"GPL\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}