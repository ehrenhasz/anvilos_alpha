{
  "module_name": "ks_wlan.h",
  "hash_id": "b7723bc47b57e29def046a6a6342808a391ab51d98e79365329005e55c1d7699",
  "original_prompt": "Ingested from linux-6.6.14/drivers/staging/ks7010/ks_wlan.h",
  "human_readable_source": " \n \n\n#ifndef _KS_WLAN_H\n#define _KS_WLAN_H\n\n#include <linux/atomic.h>\n#include <linux/circ_buf.h>\n#include <linux/completion.h>\n#include <linux/netdevice.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n#include <linux/wireless.h>\n\nstruct ks_wlan_parameter {\n\tu8 operation_mode;\n\tu8 channel;\n\tu8 tx_rate;\n\tstruct {\n\t\tu8 size;\n\t\tu8 body[16];\n\t} rate_set;\n\tu8 bssid[ETH_ALEN];\n\tstruct {\n\t\tu8 size;\n\t\tu8 body[32 + 1];\n\t} ssid;\n\tu8 preamble;\n\tu8 power_mgmt;\n\tu32 scan_type;\n#define BEACON_LOST_COUNT_MAX 65535\n\tu32 beacon_lost_count;\n\tu32 rts;\n\tu32 fragment;\n\tu32 privacy_invoked;\n\tu32 wep_index;\n\tstruct {\n\t\tu8 size;\n\t\tu8 val[13 * 2 + 1];\n\t} wep_key[4];\n\tu16 authenticate_type;\n\tu16 phy_type;\n\tu16 cts_mode;\n\tu16 phy_info_timer;\n};\n\nenum {\n\tDEVICE_STATE_OFF = 0,\t \n\tDEVICE_STATE_PREBOOT,\t \n\tDEVICE_STATE_BOOT,\t \n\tDEVICE_STATE_PREINIT,\t \n\tDEVICE_STATE_INIT,\t \n\tDEVICE_STATE_READY,\t \n\tDEVICE_STATE_SLEEP\t \n};\n\n \n#define SME_MODE_SET\t    BIT(0)\n#define SME_RTS             BIT(1)\n#define SME_FRAG            BIT(2)\n#define SME_WEP_FLAG        BIT(3)\n#define SME_WEP_INDEX       BIT(4)\n#define SME_WEP_VAL1        BIT(5)\n#define SME_WEP_VAL2        BIT(6)\n#define SME_WEP_VAL3        BIT(7)\n#define SME_WEP_VAL4        BIT(8)\n#define SME_WEP_VAL_MASK    GENMASK(8, 5)\n#define SME_RSN             BIT(9)\n#define SME_RSN_MULTICAST   BIT(10)\n#define SME_RSN_UNICAST\t    BIT(11)\n#define SME_RSN_AUTH\t    BIT(12)\n\n#define SME_AP_SCAN         BIT(13)\n#define SME_MULTICAST       BIT(14)\n\n \nenum {\n\tSME_START,\n\n\tSME_MULTICAST_REQUEST,\n\tSME_MACADDRESS_SET_REQUEST,\n\tSME_BSS_SCAN_REQUEST,\n\tSME_SET_FLAG,\n\tSME_SET_TXKEY,\n\tSME_SET_KEY1,\n\tSME_SET_KEY2,\n\tSME_SET_KEY3,\n\tSME_SET_KEY4,\n\tSME_SET_PMK_TSC,\n\tSME_SET_GMK1_TSC,\n\tSME_SET_GMK2_TSC,\n\tSME_SET_GMK3_TSC,\n\tSME_SET_PMKSA,\n\tSME_POW_MNGMT_REQUEST,\n\tSME_PHY_INFO_REQUEST,\n\tSME_MIC_FAILURE_REQUEST,\n\tSME_GET_MAC_ADDRESS,\n\tSME_GET_PRODUCT_VERSION,\n\tSME_STOP_REQUEST,\n\tSME_RTS_THRESHOLD_REQUEST,\n\tSME_FRAGMENTATION_THRESHOLD_REQUEST,\n\tSME_WEP_INDEX_REQUEST,\n\tSME_WEP_KEY1_REQUEST,\n\tSME_WEP_KEY2_REQUEST,\n\tSME_WEP_KEY3_REQUEST,\n\tSME_WEP_KEY4_REQUEST,\n\tSME_WEP_FLAG_REQUEST,\n\tSME_RSN_UCAST_REQUEST,\n\tSME_RSN_MCAST_REQUEST,\n\tSME_RSN_AUTH_REQUEST,\n\tSME_RSN_ENABLED_REQUEST,\n\tSME_RSN_MODE_REQUEST,\n\tSME_WPS_ENABLE_REQUEST,\n\tSME_WPS_PROBE_REQUEST,\n\tSME_SET_GAIN,\n\tSME_GET_GAIN,\n\tSME_SLEEP_REQUEST,\n\tSME_SET_REGION,\n\tSME_MODE_SET_REQUEST,\n\tSME_START_REQUEST,\n\tSME_GET_EEPROM_CKSUM,\n\n\tSME_MIC_FAILURE_CONFIRM,\n\tSME_START_CONFIRM,\n\n\tSME_MULTICAST_CONFIRM,\n\tSME_BSS_SCAN_CONFIRM,\n\tSME_GET_CURRENT_AP,\n\tSME_POW_MNGMT_CONFIRM,\n\tSME_PHY_INFO_CONFIRM,\n\tSME_STOP_CONFIRM,\n\tSME_RTS_THRESHOLD_CONFIRM,\n\tSME_FRAGMENTATION_THRESHOLD_CONFIRM,\n\tSME_WEP_INDEX_CONFIRM,\n\tSME_WEP_KEY1_CONFIRM,\n\tSME_WEP_KEY2_CONFIRM,\n\tSME_WEP_KEY3_CONFIRM,\n\tSME_WEP_KEY4_CONFIRM,\n\tSME_WEP_FLAG_CONFIRM,\n\tSME_RSN_UCAST_CONFIRM,\n\tSME_RSN_MCAST_CONFIRM,\n\tSME_RSN_AUTH_CONFIRM,\n\tSME_RSN_ENABLED_CONFIRM,\n\tSME_RSN_MODE_CONFIRM,\n\tSME_MODE_SET_CONFIRM,\n\tSME_SLEEP_CONFIRM,\n\n\tSME_RSN_SET_CONFIRM,\n\tSME_WEP_SET_CONFIRM,\n\tSME_TERMINATE,\n\n\tSME_EVENT_SIZE\n};\n\n \nenum {\n\tSME_IDLE,\n\tSME_SETUP,\n\tSME_DISCONNECT,\n\tSME_CONNECT\n};\n\n#define\tSME_EVENT_BUFF_SIZE\t128\n\nstruct sme_info {\n\tint sme_status;\n\tint event_buff[SME_EVENT_BUFF_SIZE];\n\tunsigned int qhead;\n\tunsigned int qtail;\n\tspinlock_t sme_spin;\n\tunsigned long sme_flag;\n};\n\nstruct hostt {\n\tint buff[SME_EVENT_BUFF_SIZE];\n\tunsigned int qhead;\n\tunsigned int qtail;\n};\n\n#define RSN_IE_BODY_MAX 64\nstruct rsn_ie {\n\tu8 id;\t \n\tu8 size;\t \n\tu8 body[RSN_IE_BODY_MAX];\n} __packed;\n\n#define WPA_INFO_ELEM_ID 0xdd\n#define RSN_INFO_ELEM_ID 0x30\n\n#define WPS_IE_BODY_MAX 255\nstruct wps_ie {\n\tu8 id;\t \n\tu8 size;\t \n\tu8 body[WPS_IE_BODY_MAX];\n} __packed;\n\nstruct local_ap {\n\tu8 bssid[6];\n\tu8 rssi;\n\tu8 sq;\n\tstruct {\n\t\tu8 size;\n\t\tu8 body[32];\n\t\tu8 ssid_pad;\n\t} ssid;\n\tstruct {\n\t\tu8 size;\n\t\tu8 body[16];\n\t\tu8 rate_pad;\n\t} rate_set;\n\tu16 capability;\n\tu8 channel;\n\tu8 noise;\n\tstruct rsn_ie wpa_ie;\n\tstruct rsn_ie rsn_ie;\n\tstruct wps_ie wps_ie;\n};\n\n#define LOCAL_APLIST_MAX 31\n#define LOCAL_CURRENT_AP LOCAL_APLIST_MAX\nstruct local_aplist {\n\tint size;\n\tstruct local_ap ap[LOCAL_APLIST_MAX + 1];\n};\n\nstruct local_gain {\n\tu8 tx_mode;\n\tu8 rx_mode;\n\tu8 tx_gain;\n\tu8 rx_gain;\n};\n\nstruct local_eeprom_sum {\n\tu8 type;\n\tu8 result;\n};\n\nenum {\n\tEEPROM_OK,\n\tEEPROM_CHECKSUM_NONE,\n\tEEPROM_FW_NOT_SUPPORT,\n\tEEPROM_NG,\n};\n\n \nenum {\n\tPS_NONE,\n\tPS_ACTIVE_SET,\n\tPS_SAVE_SET,\n\tPS_CONF_WAIT,\n\tPS_SNOOZE,\n\tPS_WAKEUP\n};\n\nstruct power_save_status {\n\tatomic_t status;\t \n\tstruct completion wakeup_wait;\n\tatomic_t confirm_wait;\n\tatomic_t snooze_guard;\n};\n\nstruct sleep_status {\n\tatomic_t status;\t \n\tatomic_t doze_request;\n\tatomic_t wakeup_request;\n};\n\n \nstruct scan_ext {\n\tunsigned int flag;\n\tchar ssid[IW_ESSID_MAX_SIZE + 1];\n};\n\n#define CIPHER_ID_WPA_NONE    \"\\x00\\x50\\xf2\\x00\"\n#define CIPHER_ID_WPA_WEP40   \"\\x00\\x50\\xf2\\x01\"\n#define CIPHER_ID_WPA_TKIP    \"\\x00\\x50\\xf2\\x02\"\n#define CIPHER_ID_WPA_CCMP    \"\\x00\\x50\\xf2\\x04\"\n#define CIPHER_ID_WPA_WEP104  \"\\x00\\x50\\xf2\\x05\"\n\n#define CIPHER_ID_WPA2_NONE   \"\\x00\\x0f\\xac\\x00\"\n#define CIPHER_ID_WPA2_WEP40  \"\\x00\\x0f\\xac\\x01\"\n#define CIPHER_ID_WPA2_TKIP   \"\\x00\\x0f\\xac\\x02\"\n#define CIPHER_ID_WPA2_CCMP   \"\\x00\\x0f\\xac\\x04\"\n#define CIPHER_ID_WPA2_WEP104 \"\\x00\\x0f\\xac\\x05\"\n\n#define CIPHER_ID_LEN    4\n\nenum {\n\tKEY_MGMT_802_1X,\n\tKEY_MGMT_PSK,\n\tKEY_MGMT_WPANONE,\n};\n\n#define KEY_MGMT_ID_WPA_NONE     \"\\x00\\x50\\xf2\\x00\"\n#define KEY_MGMT_ID_WPA_1X       \"\\x00\\x50\\xf2\\x01\"\n#define KEY_MGMT_ID_WPA_PSK      \"\\x00\\x50\\xf2\\x02\"\n#define KEY_MGMT_ID_WPA_WPANONE  \"\\x00\\x50\\xf2\\xff\"\n\n#define KEY_MGMT_ID_WPA2_NONE    \"\\x00\\x0f\\xac\\x00\"\n#define KEY_MGMT_ID_WPA2_1X      \"\\x00\\x0f\\xac\\x01\"\n#define KEY_MGMT_ID_WPA2_PSK     \"\\x00\\x0f\\xac\\x02\"\n#define KEY_MGMT_ID_WPA2_WPANONE \"\\x00\\x0f\\xac\\xff\"\n\n#define KEY_MGMT_ID_LEN  4\n\n#define MIC_KEY_SIZE 8\n\nstruct wpa_key {\n\tu32 ext_flags;\t \n\tu8 tx_seq[IW_ENCODE_SEQ_MAX_SIZE];\t \n\tu8 rx_seq[IW_ENCODE_SEQ_MAX_SIZE];\t \n\tstruct sockaddr addr;\t \n\tu16 alg;\n\tu16 key_len;\t \n\tu8 key_val[IW_ENCODING_TOKEN_MAX];\n\tu8 tx_mic_key[MIC_KEY_SIZE];\n\tu8 rx_mic_key[MIC_KEY_SIZE];\n};\n\n#define WPA_KEY_INDEX_MAX 4\n#define WPA_RX_SEQ_LEN 6\n\nstruct mic_failure {\n\tu16 failure;\t \n\tu16 counter;\t \n\tu32 last_failure_time;\n\tint stop;\n};\n\nstruct wpa_status {\n\tint wpa_enabled;\n\tbool rsn_enabled;\n\tint version;\n\tint pairwise_suite;\t \n\tint group_suite;\t \n\tint key_mgmt_suite;\n\tint auth_alg;\n\tint txkey;\n\tstruct wpa_key key[WPA_KEY_INDEX_MAX];\n\tstruct scan_ext scan_ext;\n\tstruct mic_failure mic_failure;\n};\n\n#include <linux/list.h>\n#define PMK_LIST_MAX 8\nstruct pmk_list {\n\tu16 size;\n\tstruct list_head head;\n\tstruct pmk {\n\t\tstruct list_head list;\n\t\tu8 bssid[ETH_ALEN];\n\t\tu8 pmkid[IW_PMKID_LEN];\n\t} pmk[PMK_LIST_MAX];\n};\n\nstruct wps_status {\n\tint wps_enabled;\n\tint ielen;\n\tu8 ie[255];\n};\n\n \n#define\tTX_DEVICE_BUFF_SIZE\t1024\n\nstruct ks_wlan_private;\n\n \nstruct tx_device_buffer {\n\tunsigned char *sendp;\n\tunsigned int size;\n\tvoid (*complete_handler)(struct ks_wlan_private *priv,\n\t\t\t\t struct sk_buff *skb);\n\tstruct sk_buff *skb;\n};\n\n \nstruct tx_device {\n\tstruct tx_device_buffer tx_dev_buff[TX_DEVICE_BUFF_SIZE];\n\tunsigned int qhead;\n\tunsigned int qtail;\n\tspinlock_t tx_dev_lock;\t \n};\n\n \n#define\tRX_DATA_SIZE\t(2 + 2 + 2347 + 1)\n#define\tRX_DEVICE_BUFF_SIZE\t32\n\n \nstruct rx_device_buffer {\n\tunsigned char data[RX_DATA_SIZE];\n\tunsigned int size;\n};\n\n \nstruct rx_device {\n\tstruct rx_device_buffer rx_dev_buff[RX_DEVICE_BUFF_SIZE];\n\tunsigned int qhead;\n\tunsigned int qtail;\n\tspinlock_t rx_dev_lock;\t \n};\n\nstruct ks_wlan_private {\n\t \n\tvoid *if_hw;\n\tstruct workqueue_struct *wq;\n\tstruct delayed_work rw_dwork;\n\tstruct tasklet_struct rx_bh_task;\n\n\tstruct net_device *net_dev;\n\tstruct net_device_stats nstats;\n\tstruct iw_statistics wstats;\n\n\tstruct completion confirm_wait;\n\n\t \n\tstruct tx_device tx_dev;\n\tstruct rx_device rx_dev;\n\tstruct sme_info sme_i;\n\tu8 *rxp;\n\tunsigned int rx_size;\n\tstruct work_struct sme_work;\n\tstruct work_struct wakeup_work;\n\tint scan_ind_count;\n\n\tunsigned char eth_addr[ETH_ALEN];\n\n\tstruct local_aplist aplist;\n\tstruct local_ap current_ap;\n\tstruct power_save_status psstatus;\n\tstruct sleep_status sleepstatus;\n\tstruct wpa_status wpa;\n\tstruct pmk_list pmklist;\n\t \n\tstruct ks_wlan_parameter reg;\n\tu8 current_rate;\n\n\tchar nick[IW_ESSID_MAX_SIZE + 1];\n\n\tspinlock_t multicast_spin;\n\n\tspinlock_t dev_read_lock;\n\twait_queue_head_t devread_wait;\n\n\tunsigned int need_commit;\t \n\n\t \n\tbool is_device_open;\n\tatomic_t event_count;\n\tatomic_t rec_count;\n\tint dev_count;\n#define DEVICE_STOCK_COUNT 20\n\tunsigned char *dev_data[DEVICE_STOCK_COUNT];\n\tint dev_size[DEVICE_STOCK_COUNT];\n\n\t \n\tunsigned char firmware_version[128 + 1];\n\tint version_size;\n\n\tbool mac_address_valid;\n\n\tint dev_state;\n\n\tstruct sk_buff *skb;\n\tunsigned int cur_rx;\t \n#define FORCE_DISCONNECT    0x80000000\n#define CONNECT_STATUS_MASK 0x7FFFFFFF\n\tu32 connect_status;\n\tint infra_status;\n\tu8 scan_ssid_len;\n\tu8 scan_ssid[IW_ESSID_MAX_SIZE + 1];\n\tstruct local_gain gain;\n\tstruct wps_status wps;\n\tu8 sleep_mode;\n\n\tu8 region;\n\tstruct local_eeprom_sum eeprom_sum;\n\tu8 eeprom_checksum;\n\n\tstruct hostt hostt;\n\n\tunsigned long last_doze;\n\tunsigned long last_wakeup;\n\n\tunsigned int wakeup_count;\t \n};\n\nstatic inline void inc_txqhead(struct ks_wlan_private *priv)\n{\n\tpriv->tx_dev.qhead = (priv->tx_dev.qhead + 1) % TX_DEVICE_BUFF_SIZE;\n}\n\nstatic inline void inc_txqtail(struct ks_wlan_private *priv)\n{\n\tpriv->tx_dev.qtail = (priv->tx_dev.qtail + 1) % TX_DEVICE_BUFF_SIZE;\n}\n\nstatic inline bool txq_has_space(struct ks_wlan_private *priv)\n{\n\treturn (CIRC_SPACE(priv->tx_dev.qhead, priv->tx_dev.qtail,\n\t\t\t   TX_DEVICE_BUFF_SIZE) > 0);\n}\n\nstatic inline void inc_rxqhead(struct ks_wlan_private *priv)\n{\n\tpriv->rx_dev.qhead = (priv->rx_dev.qhead + 1) % RX_DEVICE_BUFF_SIZE;\n}\n\nstatic inline void inc_rxqtail(struct ks_wlan_private *priv)\n{\n\tpriv->rx_dev.qtail = (priv->rx_dev.qtail + 1) % RX_DEVICE_BUFF_SIZE;\n}\n\nstatic inline bool rxq_has_space(struct ks_wlan_private *priv)\n{\n\treturn (CIRC_SPACE(priv->rx_dev.qhead, priv->rx_dev.qtail,\n\t\t\t   RX_DEVICE_BUFF_SIZE) > 0);\n}\n\nstatic inline unsigned int txq_count(struct ks_wlan_private *priv)\n{\n\treturn CIRC_CNT_TO_END(priv->tx_dev.qhead, priv->tx_dev.qtail,\n\t\t\t       TX_DEVICE_BUFF_SIZE);\n}\n\nstatic inline unsigned int rxq_count(struct ks_wlan_private *priv)\n{\n\treturn CIRC_CNT_TO_END(priv->rx_dev.qhead, priv->rx_dev.qtail,\n\t\t\t       RX_DEVICE_BUFF_SIZE);\n}\n\nint ks_wlan_net_start(struct net_device *dev);\nint ks_wlan_net_stop(struct net_device *dev);\nbool is_connect_status(u32 status);\nbool is_disconnect_status(u32 status);\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}