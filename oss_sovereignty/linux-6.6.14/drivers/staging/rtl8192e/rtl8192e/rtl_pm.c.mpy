{
  "module_name": "rtl_pm.c",
  "hash_id": "fe1bf977502960c377dc50622ad252b01eb314b610a2ebd86f132139edc7ec12",
  "original_prompt": "Ingested from linux-6.6.14/drivers/staging/rtl8192e/rtl8192e/rtl_pm.c",
  "human_readable_source": "\n \n#include \"rtl_core.h\"\n#include \"r8192E_hw.h\"\n#include \"r8190P_rtl8256.h\"\n#include \"rtl_pm.h\"\n\nint rtl92e_suspend(struct device *dev_d)\n{\n\tstruct net_device *dev = dev_get_drvdata(dev_d);\n\tstruct r8192_priv *priv = rtllib_priv(dev);\n\tu32\tulRegRead;\n\n\tnetdev_info(dev, \"============> r8192E suspend call.\\n\");\n\tdel_timer_sync(&priv->gpio_polling_timer);\n\tcancel_delayed_work_sync(&priv->gpio_change_rf_wq);\n\tpriv->polling_timer_on = 0;\n\n\tif (!netif_running(dev)) {\n\t\tnetdev_info(dev,\n\t\t\t    \"RTL819XE:UI is open out of suspend function\\n\");\n\t\tgoto out_pci_suspend;\n\t}\n\n\tif (dev->netdev_ops->ndo_stop)\n\t\tdev->netdev_ops->ndo_stop(dev);\n\tnetif_device_detach(dev);\n\n\tif (!priv->rtllib->bSupportRemoteWakeUp) {\n\t\trtl92e_set_rf_state(dev, rf_off, RF_CHANGE_BY_INIT);\n\t\tulRegRead = rtl92e_readl(dev, CPU_GEN);\n\t\tulRegRead |= CPU_GEN_SYSTEM_RESET;\n\t\trtl92e_writel(dev, CPU_GEN, ulRegRead);\n\t} else {\n\t\trtl92e_writel(dev, WFCRC0, 0xffffffff);\n\t\trtl92e_writel(dev, WFCRC1, 0xffffffff);\n\t\trtl92e_writel(dev, WFCRC2, 0xffffffff);\n\t\trtl92e_writeb(dev, PMR, 0x5);\n\t\trtl92e_writeb(dev, MAC_BLK_CTRL, 0xa);\n\t}\nout_pci_suspend:\n\tnetdev_info(dev, \"WOL is %s\\n\", priv->rtllib->bSupportRemoteWakeUp ?\n\t\t\t    \"Supported\" : \"Not supported\");\n\tdevice_set_wakeup_enable(dev_d, priv->rtllib->bSupportRemoteWakeUp);\n\n\tmdelay(20);\n\n\treturn 0;\n}\n\nint rtl92e_resume(struct device *dev_d)\n{\n\tstruct pci_dev *pdev = to_pci_dev(dev_d);\n\tstruct net_device *dev = dev_get_drvdata(dev_d);\n\tstruct r8192_priv *priv = rtllib_priv(dev);\n\tu32 val;\n\n\tnetdev_info(dev, \"================>r8192E resume call.\\n\");\n\n\tpci_read_config_dword(pdev, 0x40, &val);\n\tif ((val & 0x0000ff00) != 0)\n\t\tpci_write_config_dword(pdev, 0x40, val & 0xffff00ff);\n\n\tdevice_wakeup_disable(dev_d);\n\n\tif (priv->polling_timer_on == 0)\n\t\trtl92e_check_rfctrl_gpio_timer(&priv->gpio_polling_timer);\n\n\tif (!netif_running(dev)) {\n\t\tnetdev_info(dev,\n\t\t\t    \"RTL819XE:UI is open out of resume function\\n\");\n\t\tgoto out;\n\t}\n\n\tnetif_device_attach(dev);\n\tif (dev->netdev_ops->ndo_open)\n\t\tdev->netdev_ops->ndo_open(dev);\n\n\tif (!priv->rtllib->bSupportRemoteWakeUp)\n\t\trtl92e_set_rf_state(dev, rf_on, RF_CHANGE_BY_INIT);\n\nout:\n\treturn 0;\n}\n\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}