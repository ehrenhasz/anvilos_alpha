{
  "module_name": "ieee80211.h",
  "hash_id": "d4887e8c35eef80dc96f781be24faaa2972a67adab2a08d0af6b50b5bed7123c",
  "original_prompt": "Ingested from linux-6.6.14/drivers/staging/rtl8192u/ieee80211/ieee80211.h",
  "human_readable_source": " \n \n#ifndef IEEE80211_H\n#define IEEE80211_H\n#include <linux/if_ether.h>  \n#include <linux/kernel.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/timer.h>\n#include <linux/sched.h>\n#include <linux/semaphore.h>\n#include <linux/interrupt.h>\n\n#include <linux/delay.h>\n#include <linux/wireless.h>\n#include <linux/ieee80211.h>\n\n#include \"rtl819x_HT.h\"\n#include \"rtl819x_BA.h\"\n#include \"rtl819x_TS.h\"\n\n\n#ifndef IW_MODE_MONITOR\n#define IW_MODE_MONITOR 6\n#endif\n\n#ifndef IWEVCUSTOM\n#define IWEVCUSTOM 0x8c02\n#endif\n\n#define KEY_TYPE_NA\t\t0x0\n#define KEY_TYPE_WEP40\t\t0x1\n#define KEY_TYPE_TKIP\t\t0x2\n#define KEY_TYPE_CCMP\t\t0x4\n#define KEY_TYPE_WEP104\t\t0x5\n\n \n#define MAX_QUEUE_SIZE\t\t0x10\n\n\n\n\n#define BK_QUEUE                               0\n#define BE_QUEUE                               1\n#define VI_QUEUE                               2\n#define VO_QUEUE                               3\n#define HCCA_QUEUE                             4\n#define TXCMD_QUEUE                            5\n#define MGNT_QUEUE                             6\n#define HIGH_QUEUE                             7\n#define BEACON_QUEUE                           8\n\n#define LOW_QUEUE                              BE_QUEUE\n#define NORMAL_QUEUE                           MGNT_QUEUE\n\n\n#define SWRF_TIMEOUT\t\t\t\t50\n\n\n#define IE_CISCO_FLAG_POSITION\t\t0x08\t\n#define SUPPORT_CKIP_MIC\t\t\t0x08\t\n#define SUPPORT_CKIP_PK\t\t\t0x10\t\n \n \nstruct cb_desc {\n\t \n\tu8 bLastIniPkt:1;\n\tu8 bCmdOrInit:1;\n\tu8 bFirstSeg:1;\n\tu8 bLastSeg:1;\n\tu8 bEncrypt:1;\n\tu8 bTxDisableRateFallBack:1;\n\tu8 bTxUseDriverAssingedRate:1;\n\tu8 bHwSec:1; \n\n\tu8 reserved1;\n\n\t \n\tu8 bCTSEnable:1;\n\tu8 bRTSEnable:1;\n\tu8 bUseShortGI:1;\n\tu8 bUseShortPreamble:1;\n\tu8 bTxEnableFwCalcDur:1;\n\tu8 bAMPDUEnable:1;\n\tu8 bRTSSTBC:1;\n\tu8 RTSSC:1;\n\n\tu8 bRTSBW:1;\n\tu8 bPacketBW:1;\n\tu8 bRTSUseShortPreamble:1;\n\tu8 bRTSUseShortGI:1;\n\tu8 bMulticast:1;\n\tu8 bBroadcast:1;\n\t\n\tu8 drv_agg_enable:1;\n\tu8 reserved2:1;\n\n\t \n\tu8 rata_index;\n\tu8 queue_index;\n\t\n\t\n\tu16 txbuf_size;\n\t\n\tu8 RATRIndex;\n\tu8 reserved6;\n\tu8 reserved7;\n\tu8 reserved8;\n\n\t \n\tu8 data_rate;\n\tu8 rts_rate;\n\tu8 ampdu_factor;\n\tu8 ampdu_density;\n\t\n\t\n\t\n\tu8 DrvAggrNum;\n\tu16 pkt_size;\n\tu8 reserved12;\n};\n\n \n#define MGN_1M                  0x02\n#define MGN_2M                  0x04\n#define MGN_5_5M                0x0b\n#define MGN_11M                 0x16\n\n#define MGN_6M                  0x0c\n#define MGN_9M                  0x12\n#define MGN_12M                 0x18\n#define MGN_18M                 0x24\n#define MGN_24M                 0x30\n#define MGN_36M                 0x48\n#define MGN_48M                 0x60\n#define MGN_54M                 0x6c\n\n#define MGN_MCS0                0x80\n#define MGN_MCS1                0x81\n#define MGN_MCS2                0x82\n#define MGN_MCS3                0x83\n#define MGN_MCS4                0x84\n#define MGN_MCS5                0x85\n#define MGN_MCS6                0x86\n#define MGN_MCS7                0x87\n#define MGN_MCS8                0x88\n#define MGN_MCS9                0x89\n#define MGN_MCS10               0x8a\n#define MGN_MCS11               0x8b\n#define MGN_MCS12               0x8c\n#define MGN_MCS13               0x8d\n#define MGN_MCS14               0x8e\n#define MGN_MCS15               0x8f\n\n#define aSifsTime ((priv->ieee80211->current_network.mode == IEEE_A ||     \\\n\t\t    priv->ieee80211->current_network.mode == IEEE_N_24G || \\\n\t\t    priv->ieee80211->current_network.mode == IEEE_N_5G) ?  \\\n\t\t   16 : 10)\n\n#define MGMT_QUEUE_NUM 5\n\n#define IEEE_CMD_SET_WPA_PARAM\t\t\t1\n#define\tIEEE_CMD_SET_WPA_IE\t\t\t2\n#define IEEE_CMD_SET_ENCRYPTION\t\t\t3\n#define IEEE_CMD_MLME\t\t\t\t4\n\n#define IEEE_PARAM_WPA_ENABLED\t\t\t1\n#define IEEE_PARAM_TKIP_COUNTERMEASURES\t\t2\n#define IEEE_PARAM_DROP_UNENCRYPTED\t\t3\n#define IEEE_PARAM_PRIVACY_INVOKED\t\t4\n#define IEEE_PARAM_AUTH_ALGS\t\t\t5\n#define IEEE_PARAM_IEEE_802_1X\t\t\t6\n\n\n#define IEEE_PARAM_WPAX_SELECT\t\t\t7\n\n\n#define IEEE_PROTO_WPA\t\t\t\t1\n#define IEEE_PROTO_RSN\t\t\t\t2\n\n\n#define IEEE_WPAX_USEGROUP\t\t\t0\n#define IEEE_WPAX_WEP40\t\t\t\t1\n#define IEEE_WPAX_TKIP\t\t\t\t2\n#define IEEE_WPAX_WRAP\t\t\t\t3\n#define IEEE_WPAX_CCMP\t\t\t\t4\n#define IEEE_WPAX_WEP104\t\t\t5\n\n#define IEEE_KEY_MGMT_IEEE8021X\t\t\t1\n#define IEEE_KEY_MGMT_PSK\t\t\t2\n\n#define IEEE_MLME_STA_DEAUTH\t\t\t1\n#define IEEE_MLME_STA_DISASSOC\t\t\t2\n\n\n#define IEEE_CRYPT_ERR_UNKNOWN_ALG\t\t2\n#define IEEE_CRYPT_ERR_UNKNOWN_ADDR\t\t3\n#define IEEE_CRYPT_ERR_CRYPT_INIT_FAILED\t4\n#define IEEE_CRYPT_ERR_KEY_SET_FAILED\t\t5\n#define IEEE_CRYPT_ERR_TX_KEY_SET_FAILED\t6\n#define IEEE_CRYPT_ERR_CARD_CONF_FAILED\t\t7\n\n\n#define\tIEEE_CRYPT_ALG_NAME_LEN\t\t\t16\n\n#define MAX_IE_LEN  0xff\n\n\n#define ieee80211_wake_queue\t\tieee80211_wake_queue_rsl\n#define ieee80211_stop_queue\t\tieee80211_stop_queue_rsl\n#define notify_wx_assoc_event\t\tnotify_wx_assoc_event_rsl\n#define SendDisassociation\t\tSendDisassociation_rsl\n\n\nstruct ieee_param {\n\tu32 cmd;\n\tu8 sta_addr[ETH_ALEN];\n\tunion {\n\t\tstruct {\n\t\t\tu8 name;\n\t\t\tu32 value;\n\t\t} wpa_param;\n\t\tstruct {\n\t\t\tu32 len;\n\t\t\tu8 reserved[32];\n\t\t\tu8 data[];\n\t\t} wpa_ie;\n\t\tstruct{\n\t\t\tint command;\n\t\t\tint reason_code;\n\t\t} mlme;\n\t\tstruct {\n\t\t\tu8 alg[IEEE_CRYPT_ALG_NAME_LEN];\n\t\t\tu8 set_tx;\n\t\t\tu32 err;\n\t\t\tu8 idx;\n\t\t\tu8 seq[8];  \n\t\t\tu16 key_len;\n\t\t\tu8 key[];\n\t\t} crypt;\n\t} u;\n};\n\n\n\n#define IEEE80211_DATA_LEN\t\t2304\n \n#define IEEE80211_1ADDR_LEN 10\n#define IEEE80211_2ADDR_LEN 16\n#define IEEE80211_3ADDR_LEN 24\n#define IEEE80211_4ADDR_LEN 30\n#define IEEE80211_FCS_LEN    4\n#define IEEE80211_HLEN                  (IEEE80211_4ADDR_LEN)\n#define IEEE80211_FRAME_LEN             (IEEE80211_DATA_LEN + IEEE80211_HLEN)\n#define IEEE80211_MGMT_HDR_LEN 24\n#define IEEE80211_DATA_HDR3_LEN 24\n#define IEEE80211_DATA_HDR4_LEN 30\n\n#define MIN_FRAG_THRESHOLD     256U\n#define MAX_FRAG_THRESHOLD     2346U\n\n\n \n#define IEEE80211_FCTL_VERS\t\t0x0003\n#define IEEE80211_FCTL_FTYPE\t\t0x000c\n#define IEEE80211_FCTL_STYPE\t\t0x00f0\n#define IEEE80211_FCTL_FRAMETYPE\t0x00fc\n#define IEEE80211_FCTL_TODS\t\t0x0100\n#define IEEE80211_FCTL_FROMDS\t\t0x0200\n#define IEEE80211_FCTL_DSTODS\t\t0x0300 \n#define IEEE80211_FCTL_MOREFRAGS\t0x0400\n#define IEEE80211_FCTL_RETRY\t\t0x0800\n#define IEEE80211_FCTL_PM\t\t0x1000\n#define IEEE80211_FCTL_MOREDATA\t\t0x2000\n#define IEEE80211_FCTL_WEP\t\t0x4000\n#define IEEE80211_FCTL_ORDER\t\t0x8000\n\n#define IEEE80211_FTYPE_MGMT\t\t0x0000\n#define IEEE80211_FTYPE_CTL\t\t0x0004\n#define IEEE80211_FTYPE_DATA\t\t0x0008\n\n \n#define IEEE80211_STYPE_ASSOC_REQ\t0x0000\n#define IEEE80211_STYPE_ASSOC_RESP\t0x0010\n#define IEEE80211_STYPE_REASSOC_REQ\t0x0020\n#define IEEE80211_STYPE_REASSOC_RESP\t0x0030\n#define IEEE80211_STYPE_PROBE_REQ\t0x0040\n#define IEEE80211_STYPE_PROBE_RESP\t0x0050\n#define IEEE80211_STYPE_BEACON\t\t0x0080\n#define IEEE80211_STYPE_ATIM\t\t0x0090\n#define IEEE80211_STYPE_DISASSOC\t0x00A0\n#define IEEE80211_STYPE_AUTH\t\t0x00B0\n#define IEEE80211_STYPE_DEAUTH\t\t0x00C0\n#define IEEE80211_STYPE_MANAGE_ACT\t0x00D0\n\n \n#define IEEE80211_STYPE_PSPOLL\t\t0x00A0\n#define IEEE80211_STYPE_RTS\t\t0x00B0\n#define IEEE80211_STYPE_CTS\t\t0x00C0\n#define IEEE80211_STYPE_ACK\t\t0x00D0\n#define IEEE80211_STYPE_CFEND\t\t0x00E0\n#define IEEE80211_STYPE_CFENDACK\t0x00F0\n#define IEEE80211_STYPE_BLOCKACK\t0x0094\n\n \n#define IEEE80211_STYPE_DATA\t\t0x0000\n#define IEEE80211_STYPE_DATA_CFACK\t0x0010\n#define IEEE80211_STYPE_DATA_CFPOLL\t0x0020\n#define IEEE80211_STYPE_DATA_CFACKPOLL\t0x0030\n#define IEEE80211_STYPE_NULLFUNC\t0x0040\n#define IEEE80211_STYPE_CFACK\t\t0x0050\n#define IEEE80211_STYPE_CFPOLL\t\t0x0060\n#define IEEE80211_STYPE_CFACKPOLL\t0x0070\n#define IEEE80211_STYPE_QOS_DATA\t0x0080 \n#define IEEE80211_STYPE_QOS_NULL\t0x00C0\n\n#define IEEE80211_SCTL_FRAG\t\t0x000F\n#define IEEE80211_SCTL_SEQ\t\t0xFFF0\n\n \n#define IEEE80211_QCTL_TID              0x000F\n\n#define\tFC_QOS_BIT\t\t\t\t\tBIT(7)\n#define IsDataFrame(pdu)\t\t\t(((pdu[0] & 0x0C) == 0x08) ? true : false)\n#define\tIsLegacyDataFrame(pdu)\t(IsDataFrame(pdu) && (!(pdu[0] & FC_QOS_BIT)))\n\n#define IsQoSDataFrame(pframe)  ((*(u16 *)pframe & (IEEE80211_STYPE_QOS_DATA | IEEE80211_FTYPE_DATA)) == (IEEE80211_STYPE_QOS_DATA | IEEE80211_FTYPE_DATA))\n#define Frame_Order(pframe)     (*(u16 *)pframe & IEEE80211_FCTL_ORDER)\n#define SN_LESS(a, b)\t\t(((a - b) & 0x800) != 0)\n#define SN_EQUAL(a, b)\t(a == b)\n#define MAX_DEV_ADDR_SIZE 8\ntypedef enum _ACT_CATEGORY {\n\tACT_CAT_QOS = 1,\n\tACT_CAT_DLS = 2,\n\tACT_CAT_BA  = 3,\n\tACT_CAT_HT  = 7,\n\tACT_CAT_WMM = 17,\n} ACT_CATEGORY, *PACT_CATEGORY;\n\ntypedef enum _TS_ACTION {\n\tACT_ADDTSREQ = 0,\n\tACT_ADDTSRSP = 1,\n\tACT_DELTS    = 2,\n\tACT_SCHEDULE = 3,\n} TS_ACTION, *PTS_ACTION;\n\ntypedef enum _BA_ACTION {\n\tACT_ADDBAREQ = 0,\n\tACT_ADDBARSP = 1,\n\tACT_DELBA    = 2,\n} BA_ACTION, *PBA_ACTION;\n\ntypedef enum _InitialGainOpType {\n\tIG_Backup = 0,\n\tIG_Restore,\n\tIG_Max\n} InitialGainOpType;\n\n \n#define CONFIG_IEEE80211_DEBUG\n#ifdef CONFIG_IEEE80211_DEBUG\nextern u32 ieee80211_debug_level;\n#define IEEE80211_DEBUG(level, fmt, args...) \\\ndo { if (ieee80211_debug_level & (level)) \\\n  printk(KERN_DEBUG \"ieee80211: \" fmt, ## args); } while (0)\n\n\n#define IEEE80211_DEBUG_DATA(level, data, datalen)                             \\\n\tdo { if ((ieee80211_debug_level & (level)) == (level))                 \\\n\t\t{                                                              \\\n\t\t\tint i;                                                 \\\n\t\t\tu8 *pdata = (u8 *)data;                                \\\n\t\t\tprintk(KERN_DEBUG \"ieee80211: %s()\\n\", __func__);      \\\n\t\t\tfor (i = 0; i < (int)(datalen); i++) {                 \\\n\t\t\t\tprintk(\"%2x \", pdata[i]);                      \\\n\t\t\t\tif ((i + 1) % 16 == 0)                         \\\n\t\t\t\t\tprintk(\"\\n\");                          \\\n\t\t\t}                                                      \\\n\t\t\tprintk(\"\\n\");                                          \\\n\t\t}                                                              \\\n\t} while (0)\n#else\n#define IEEE80211_DEBUG(level, fmt, args...)\n#define IEEE80211_DEBUG_DATA(level, data, datalen)\n#endif\t \n\n \n\n \n\n#define IEEE80211_DL_INFO          (1<<0)\n#define IEEE80211_DL_WX            (1<<1)\n#define IEEE80211_DL_SCAN          (1<<2)\n#define IEEE80211_DL_STATE         (1<<3)\n#define IEEE80211_DL_MGMT          (1<<4)\n#define IEEE80211_DL_FRAG          (1<<5)\n#define IEEE80211_DL_EAP           (1<<6)\n#define IEEE80211_DL_DROP          (1<<7)\n\n#define IEEE80211_DL_TX            (1<<8)\n#define IEEE80211_DL_RX            (1<<9)\n\n#define IEEE80211_DL_HT\t\t   (1<<10)  \n#define IEEE80211_DL_BA\t\t   (1<<11)  \n#define IEEE80211_DL_TS\t\t   (1<<12)  \n#define IEEE80211_DL_QOS           (1<<13)\n#define IEEE80211_DL_REORDER\t   (1<<14)\n#define IEEE80211_DL_IOT\t   (1<<15)\n#define IEEE80211_DL_IPS\t   (1<<16)\n#define IEEE80211_DL_TRACE\t   (1<<29)  \n#define IEEE80211_DL_DATA\t   (1<<30)   \n#define IEEE80211_DL_ERR\t   (1<<31)   \n#define IEEE80211_ERROR(f, a...) printk(KERN_ERR \"ieee80211: \" f, ## a)\n#define IEEE80211_WARNING(f, a...) printk(KERN_WARNING \"ieee80211: \" f, ## a)\n#define IEEE80211_DEBUG_INFO(f, a...)   IEEE80211_DEBUG(IEEE80211_DL_INFO, f, ## a)\n\n#define IEEE80211_DEBUG_WX(f, a...)     IEEE80211_DEBUG(IEEE80211_DL_WX, f, ## a)\n#define IEEE80211_DEBUG_SCAN(f, a...)   IEEE80211_DEBUG(IEEE80211_DL_SCAN, f, ## a)\n#define IEEE80211_DEBUG_STATE(f, a...)  IEEE80211_DEBUG(IEEE80211_DL_STATE, f, ## a)\n#define IEEE80211_DEBUG_MGMT(f, a...)  IEEE80211_DEBUG(IEEE80211_DL_MGMT, f, ## a)\n#define IEEE80211_DEBUG_FRAG(f, a...)  IEEE80211_DEBUG(IEEE80211_DL_FRAG, f, ## a)\n#define IEEE80211_DEBUG_EAP(f, a...)  IEEE80211_DEBUG(IEEE80211_DL_EAP, f, ## a)\n#define IEEE80211_DEBUG_DROP(f, a...)  IEEE80211_DEBUG(IEEE80211_DL_DROP, f, ## a)\n#define IEEE80211_DEBUG_TX(f, a...)  IEEE80211_DEBUG(IEEE80211_DL_TX, f, ## a)\n#define IEEE80211_DEBUG_RX(f, a...)  IEEE80211_DEBUG(IEEE80211_DL_RX, f, ## a)\n#define IEEE80211_DEBUG_QOS(f, a...)  IEEE80211_DEBUG(IEEE80211_DL_QOS, f, ## a)\n\n#include <linux/if_arp.h>  \n\n#ifndef WIRELESS_SPY\n#define WIRELESS_SPY\t\t\n#endif\n#include <net/iw_handler.h>\t\n\n#ifndef ETH_P_PAE\n#define ETH_P_PAE 0x888E  \n#endif  \n\n#define ETH_P_PREAUTH 0x88C7  \n\n#ifndef ETH_P_80211_RAW\n#define ETH_P_80211_RAW (ETH_P_ECONET + 1)\n#endif\n\n \n\n#define P80211_OUI_LEN 3\n\nstruct ieee80211_snap_hdr {\n\n\tu8    dsap;    \n\tu8    ssap;    \n\tu8    ctrl;    \n\tu8    oui[P80211_OUI_LEN];     \n\n} __packed;\n\n#define SNAP_SIZE sizeof(struct ieee80211_snap_hdr)\n\n#define WLAN_FC_GET_VERS(fc) ((fc) & IEEE80211_FCTL_VERS)\n#define WLAN_FC_GET_TYPE(fc) ((fc) & IEEE80211_FCTL_FTYPE)\n#define WLAN_FC_GET_STYPE(fc) ((fc) & IEEE80211_FCTL_STYPE)\n\n#define WLAN_FC_GET_FRAMETYPE(fc) ((fc) & IEEE80211_FCTL_FRAMETYPE)\n#define WLAN_GET_SEQ_FRAG(seq) ((seq) & IEEE80211_SCTL_FRAG)\n#define WLAN_GET_SEQ_SEQ(seq)  (((seq) & IEEE80211_SCTL_SEQ) >> 4)\n\n#define WLAN_CAPABILITY_BSS (1<<0)\n#define WLAN_CAPABILITY_IBSS (1<<1)\n#define WLAN_CAPABILITY_CF_POLLABLE (1<<2)\n#define WLAN_CAPABILITY_CF_POLL_REQUEST (1<<3)\n#define WLAN_CAPABILITY_PRIVACY (1<<4)\n#define WLAN_CAPABILITY_SHORT_PREAMBLE (1<<5)\n#define WLAN_CAPABILITY_PBCC (1<<6)\n#define WLAN_CAPABILITY_CHANNEL_AGILITY (1<<7)\n#define WLAN_CAPABILITY_SPECTRUM_MGMT (1<<8)\n#define WLAN_CAPABILITY_QOS (1<<9)\n#define WLAN_CAPABILITY_SHORT_SLOT (1<<10)\n#define WLAN_CAPABILITY_DSSS_OFDM (1<<13)\n\n \n#define WLAN_ERP_NON_ERP_PRESENT (1<<0)\n#define WLAN_ERP_USE_PROTECTION (1<<1)\n#define WLAN_ERP_BARKER_PREAMBLE (1<<2)\n\n#define IEEE80211_STATMASK_SIGNAL (1<<0)\n#define IEEE80211_STATMASK_RSSI (1<<1)\n#define IEEE80211_STATMASK_NOISE (1<<2)\n#define IEEE80211_STATMASK_RATE (1<<3)\n#define IEEE80211_STATMASK_WEMASK 0x7\n\n#define IEEE80211_CCK_MODULATION    (1<<0)\n#define IEEE80211_OFDM_MODULATION   (1<<1)\n\n#define IEEE80211_24GHZ_BAND     (1<<0)\n#define IEEE80211_52GHZ_BAND     (1<<1)\n\n#define IEEE80211_CCK_RATE_LEN\t\t\t4\n#define IEEE80211_CCK_RATE_1MB\t\t\t0x02\n#define IEEE80211_CCK_RATE_2MB\t\t\t0x04\n#define IEEE80211_CCK_RATE_5MB\t\t\t0x0B\n#define IEEE80211_CCK_RATE_11MB\t\t\t0x16\n#define IEEE80211_OFDM_RATE_LEN\t\t\t8\n#define IEEE80211_OFDM_RATE_6MB\t\t\t0x0C\n#define IEEE80211_OFDM_RATE_9MB\t\t\t0x12\n#define IEEE80211_OFDM_RATE_12MB\t\t0x18\n#define IEEE80211_OFDM_RATE_18MB\t\t0x24\n#define IEEE80211_OFDM_RATE_24MB\t\t0x30\n#define IEEE80211_OFDM_RATE_36MB\t\t0x48\n#define IEEE80211_OFDM_RATE_48MB\t\t0x60\n#define IEEE80211_OFDM_RATE_54MB\t\t0x6C\n#define IEEE80211_BASIC_RATE_MASK\t\t0x80\n\n#define IEEE80211_CCK_RATE_1MB_MASK\t\t(1<<0)\n#define IEEE80211_CCK_RATE_2MB_MASK\t\t(1<<1)\n#define IEEE80211_CCK_RATE_5MB_MASK\t\t(1<<2)\n#define IEEE80211_CCK_RATE_11MB_MASK\t\t(1<<3)\n#define IEEE80211_OFDM_RATE_6MB_MASK\t\t(1<<4)\n#define IEEE80211_OFDM_RATE_9MB_MASK\t\t(1<<5)\n#define IEEE80211_OFDM_RATE_12MB_MASK\t\t(1<<6)\n#define IEEE80211_OFDM_RATE_18MB_MASK\t\t(1<<7)\n#define IEEE80211_OFDM_RATE_24MB_MASK\t\t(1<<8)\n#define IEEE80211_OFDM_RATE_36MB_MASK\t\t(1<<9)\n#define IEEE80211_OFDM_RATE_48MB_MASK\t\t(1<<10)\n#define IEEE80211_OFDM_RATE_54MB_MASK\t\t(1<<11)\n\n#define IEEE80211_CCK_RATES_MASK\t\t0x0000000F\n#define IEEE80211_CCK_BASIC_RATES_MASK\t(IEEE80211_CCK_RATE_1MB_MASK | \\\n\tIEEE80211_CCK_RATE_2MB_MASK)\n#define IEEE80211_CCK_DEFAULT_RATES_MASK\t(IEEE80211_CCK_BASIC_RATES_MASK | \\\n\tIEEE80211_CCK_RATE_5MB_MASK | \\\n\tIEEE80211_CCK_RATE_11MB_MASK)\n\n#define IEEE80211_OFDM_RATES_MASK\t\t0x00000FF0\n#define IEEE80211_OFDM_BASIC_RATES_MASK\t(IEEE80211_OFDM_RATE_6MB_MASK | \\\n\tIEEE80211_OFDM_RATE_12MB_MASK | \\\n\tIEEE80211_OFDM_RATE_24MB_MASK)\n#define IEEE80211_OFDM_DEFAULT_RATES_MASK\t(IEEE80211_OFDM_BASIC_RATES_MASK | \\\n\tIEEE80211_OFDM_RATE_9MB_MASK  | \\\n\tIEEE80211_OFDM_RATE_18MB_MASK | \\\n\tIEEE80211_OFDM_RATE_36MB_MASK | \\\n\tIEEE80211_OFDM_RATE_48MB_MASK | \\\n\tIEEE80211_OFDM_RATE_54MB_MASK)\n#define IEEE80211_DEFAULT_RATES_MASK (IEEE80211_OFDM_DEFAULT_RATES_MASK | \\\n\t\t\t\tIEEE80211_CCK_DEFAULT_RATES_MASK)\n\n#define IEEE80211_NUM_OFDM_RATES\t    8\n#define IEEE80211_NUM_CCK_RATES\t\t    4\n#define IEEE80211_OFDM_SHIFT_MASK_A         4\n\n\n \n#define IEEE80211_FC0_TYPE_MASK\t\t0x0c\n#define IEEE80211_FC0_TYPE_DATA\t\t0x08\n#define IEEE80211_FC0_SUBTYPE_MASK\t0xB0\n#define IEEE80211_FC0_SUBTYPE_QOS\t0x80\n\n#define IEEE80211_QOS_HAS_SEQ(fc) \\\n\t(((fc) & (IEEE80211_FC0_TYPE_MASK | IEEE80211_FC0_SUBTYPE_MASK)) == \\\n\t (IEEE80211_FC0_TYPE_DATA | IEEE80211_FC0_SUBTYPE_QOS))\n\n \n#define IEEE_IBSS_MAC_HASH_SIZE 31\nstruct ieee_ibss_seq {\n\tu8 mac[ETH_ALEN];\n\tu16 seq_num[17];\n\tu16 frag_num[17];\n\tunsigned long packet_time[17];\n\tstruct list_head list;\n};\n\n \nstruct ieee80211_rx_stats {\n\tu32 mac_time[2];\n\ts8 rssi;\n\tu8 signal;\n\tu8 noise;\n\tu16 rate;  \n\tu8 received_channel;\n\tu8 control;\n\tu8 mask;\n\tu8 freq;\n\tu16 len;\n\tu64 tsf;\n\tu32 beacon_time;\n\tu8 nic_type;\n\tu16       Length;\n\t\n\tu8        SignalQuality; \n\ts32       RecvSignalPower; \n\ts8        RxPower; \n\tu8        SignalStrength; \n\tu16       bHwError:1;\n\tu16       bCRC:1;\n\tu16       bICV:1;\n\tu16       bShortPreamble:1;\n\tu16       Antenna:1;      \n\tu16       Decrypted:1;    \n\tu16       Wakeup:1;       \n\tu16       Reserved0:1;    \n\tu8        AGC;\n\tu32       TimeStampLow;\n\tu32       TimeStampHigh;\n\tbool      bShift;\n\tbool      bIsQosData;             \n\tu8        UserPriority;\n\n\t\n\t\n\t\n\n\tu8        RxDrvInfoSize;\n\tu8        RxBufShift;\n\tbool      bIsAMPDU;\n\tbool      bFirstMPDU;\n\tbool      bContainHTC;\n\tbool      RxIs40MHzPacket;\n\tu32       RxPWDBAll;\n\tu8        RxMIMOSignalStrength[4];        \n\ts8        RxMIMOSignalQuality[2];\n\tbool      bPacketMatchBSSID;\n\tbool      bIsCCK;\n\tbool      bPacketToSelf;\n\t\n\tu8        *virtual_address;\n\tu16          packetlength;              \n\tu16          fraglength;                        \n\tu16          fragoffset;                        \n\tu16          ntotalfrag;\n\tbool\t\t  bisrxaggrsubframe;\n\tbool\t\t  bPacketBeacon;\t\n\tbool\t\t  bToSelfBA;\t\t\n\ts8\t\t  cck_adc_pwdb[4];\t\n\tu16\t\t  Seq_Num;\n\n};\n\n \n#define IEEE80211_FRAG_CACHE_LEN 4\n\nstruct ieee80211_frag_entry {\n\tunsigned long first_frag_time;\n\tunsigned int seq;\n\tunsigned int last_frag;\n\tstruct sk_buff *skb;\n\tu8 src_addr[ETH_ALEN];\n\tu8 dst_addr[ETH_ALEN];\n};\n\nstruct ieee80211_stats {\n\tunsigned int tx_unicast_frames;\n\tunsigned int tx_multicast_frames;\n\tunsigned int tx_fragments;\n\tunsigned int tx_unicast_octets;\n\tunsigned int tx_multicast_octets;\n\tunsigned int tx_deferred_transmissions;\n\tunsigned int tx_single_retry_frames;\n\tunsigned int tx_multiple_retry_frames;\n\tunsigned int tx_retry_limit_exceeded;\n\tunsigned int tx_discards;\n\tunsigned int rx_unicast_frames;\n\tunsigned int rx_multicast_frames;\n\tunsigned int rx_fragments;\n\tunsigned int rx_unicast_octets;\n\tunsigned int rx_multicast_octets;\n\tunsigned int rx_fcs_errors;\n\tunsigned int rx_discards_no_buffer;\n\tunsigned int tx_discards_wrong_sa;\n\tunsigned int rx_discards_undecryptable;\n\tunsigned int rx_message_in_msg_fragments;\n\tunsigned int rx_message_in_bad_msg_fragments;\n};\n\nstruct ieee80211_device;\n\n#include \"ieee80211_crypt.h\"\n\n#define SEC_KEY_1         (1<<0)\n#define SEC_KEY_2         (1<<1)\n#define SEC_KEY_3         (1<<2)\n#define SEC_KEY_4         (1<<3)\n#define SEC_ACTIVE_KEY    (1<<4)\n#define SEC_AUTH_MODE     (1<<5)\n#define SEC_UNICAST_GROUP (1<<6)\n#define SEC_LEVEL         (1<<7)\n#define SEC_ENABLED       (1<<8)\n#define SEC_ENCRYPT       (1<<9)\n\n#define SEC_LEVEL_0      0  \n#define SEC_LEVEL_1      1  \n#define SEC_LEVEL_2      2  \n#define SEC_LEVEL_2_CKIP 3  \n#define SEC_LEVEL_3      4  \n\n#define SEC_ALG_NONE            0\n#define SEC_ALG_WEP             1\n#define SEC_ALG_TKIP            2\n#define SEC_ALG_CCMP            3\n\n#define WEP_KEYS\t\t4\n#define WEP_KEY_LEN\t\t13\n#define SCM_KEY_LEN             32\n#define SCM_TEMPORAL_KEY_LENGTH 16\n\nstruct ieee80211_security {\n\tu16 active_key:2,\n\t    enabled:1,\n\t    auth_algo:4,\n\t    unicast_uses_group:1,\n\t    encrypt:1;\n\tu8 auth_mode;\n\tu8 key_sizes[WEP_KEYS];\n\tu8 keys[WEP_KEYS][SCM_KEY_LEN];\n\tu8 level;\n\tu16 flags;\n} __packed;\n\n\n \n\n \nenum ieee80211_mfie {\n\tMFIE_TYPE_SSID = 0,\n\tMFIE_TYPE_RATES = 1,\n\tMFIE_TYPE_FH_SET = 2,\n\tMFIE_TYPE_DS_SET = 3,\n\tMFIE_TYPE_CF_SET = 4,\n\tMFIE_TYPE_TIM = 5,\n\tMFIE_TYPE_IBSS_SET = 6,\n\tMFIE_TYPE_COUNTRY = 7,\n\tMFIE_TYPE_HOP_PARAMS = 8,\n\tMFIE_TYPE_HOP_TABLE = 9,\n\tMFIE_TYPE_REQUEST = 10,\n\tMFIE_TYPE_CHALLENGE = 16,\n\tMFIE_TYPE_POWER_CONSTRAINT = 32,\n\tMFIE_TYPE_POWER_CAPABILITY = 33,\n\tMFIE_TYPE_TPC_REQUEST = 34,\n\tMFIE_TYPE_TPC_REPORT = 35,\n\tMFIE_TYPE_SUPP_CHANNELS = 36,\n\tMFIE_TYPE_CSA = 37,\n\tMFIE_TYPE_MEASURE_REQUEST = 38,\n\tMFIE_TYPE_MEASURE_REPORT = 39,\n\tMFIE_TYPE_QUIET = 40,\n\tMFIE_TYPE_IBSS_DFS = 41,\n\tMFIE_TYPE_ERP = 42,\n\tMFIE_TYPE_RSN = 48,\n\tMFIE_TYPE_RATES_EX = 50,\n\tMFIE_TYPE_HT_CAP = 45,\n\t MFIE_TYPE_HT_INFO = 61,\n\t MFIE_TYPE_AIRONET = 133,\n\tMFIE_TYPE_GENERIC = 221,\n\tMFIE_TYPE_QOS_PARAMETER = 222,\n};\n\n \nstruct rtl_80211_hdr {\n\t__le16 frame_ctl;\n\t__le16 duration_id;\n\tu8 payload[];\n} __packed;\n\nstruct rtl_80211_hdr_1addr {\n\t__le16 frame_ctl;\n\t__le16 duration_id;\n\tu8 addr1[ETH_ALEN];\n\tu8 payload[];\n} __packed;\n\nstruct rtl_80211_hdr_2addr {\n\t__le16 frame_ctl;\n\t__le16 duration_id;\n\tu8 addr1[ETH_ALEN];\n\tu8 addr2[ETH_ALEN];\n\tu8 payload[];\n} __packed;\n\nstruct rtl_80211_hdr_3addr {\n\t__le16 frame_ctl;\n\t__le16 duration_id;\n\tu8 addr1[ETH_ALEN];\n\tu8 addr2[ETH_ALEN];\n\tu8 addr3[ETH_ALEN];\n\t__le16 seq_ctl;\n\tu8 payload[];\n} __packed;\n\nstruct rtl_80211_hdr_4addr {\n\t__le16 frame_ctl;\n\t__le16 duration_id;\n\tu8 addr1[ETH_ALEN];\n\tu8 addr2[ETH_ALEN];\n\tu8 addr3[ETH_ALEN];\n\t__le16 seq_ctl;\n\tu8 addr4[ETH_ALEN];\n\tu8 payload[];\n} __packed;\n\nstruct rtl_80211_hdr_3addrqos {\n\t__le16 frame_ctl;\n\t__le16 duration_id;\n\tu8 addr1[ETH_ALEN];\n\tu8 addr2[ETH_ALEN];\n\tu8 addr3[ETH_ALEN];\n\t__le16 seq_ctl;\n\tu8 payload[0];\n\t__le16 qos_ctl;\n} __packed;\n\nstruct rtl_80211_hdr_4addrqos {\n\t__le16 frame_ctl;\n\t__le16 duration_id;\n\tu8 addr1[ETH_ALEN];\n\tu8 addr2[ETH_ALEN];\n\tu8 addr3[ETH_ALEN];\n\t__le16 seq_ctl;\n\tu8 addr4[ETH_ALEN];\n\tu8 payload[0];\n\t__le16 qos_ctl;\n} __packed;\n\nstruct ieee80211_info_element {\n\tu8 id;\n\tu8 len;\n\tu8 data[];\n} __packed;\n\nstruct ieee80211_authentication {\n\tstruct rtl_80211_hdr_3addr header;\n\t__le16 algorithm;\n\t__le16 transaction;\n\t__le16 status;\n\t \n\tstruct ieee80211_info_element info_element[];\n} __packed;\n\nstruct ieee80211_disassoc {\n\tstruct rtl_80211_hdr_3addr header;\n\t__le16 reason;\n} __packed;\n\nstruct ieee80211_probe_request {\n\tstruct rtl_80211_hdr_3addr header;\n\t \n\tstruct ieee80211_info_element info_element[];\n} __packed;\n\nstruct ieee80211_probe_response {\n\tstruct rtl_80211_hdr_3addr header;\n\t__le32 time_stamp[2];\n\t__le16 beacon_interval;\n\t__le16 capability;\n\t \n\tstruct ieee80211_info_element info_element[];\n} __packed;\n\n \n#define ieee80211_beacon ieee80211_probe_response\n\nstruct ieee80211_assoc_request_frame {\n\tstruct rtl_80211_hdr_3addr header;\n\t__le16 capability;\n\t__le16 listen_interval;\n\t \n\tstruct ieee80211_info_element info_element[];\n} __packed;\n\nstruct ieee80211_reassoc_request_frame {\n\tstruct rtl_80211_hdr_3addr header;\n\t__le16 capability;\n\t__le16 listen_interval;\n\tu8 current_ap[ETH_ALEN];\n\t \n\tstruct ieee80211_info_element info_element[];\n} __packed;\n\nstruct ieee80211_assoc_response_frame {\n\tstruct rtl_80211_hdr_3addr header;\n\t__le16 capability;\n\t__le16 status;\n\t__le16 aid;\n\tstruct ieee80211_info_element info_element[];  \n} __packed;\n\nstruct ieee80211_txb {\n\tu8 nr_frags;\n\tu8 encrypted;\n\tu8 queue_index;\n\tu8 rts_included;\n\tu16 reserved;\n\t__le16 frag_size;\n\t__le16 payload_size;\n\tstruct sk_buff *fragments[];\n};\n\n#define MAX_TX_AGG_COUNT\t\t  16\nstruct ieee80211_drv_agg_txb {\n\tu8 nr_drv_agg_frames;\n\tstruct sk_buff *tx_agg_frames[MAX_TX_AGG_COUNT];\n} __packed;\n\n#define MAX_SUBFRAME_COUNT\t\t  64\nstruct ieee80211_rxb {\n\tu8 nr_subframes;\n\tstruct sk_buff *subframes[MAX_SUBFRAME_COUNT];\n\tu8 dst[ETH_ALEN];\n\tu8 src[ETH_ALEN];\n} __packed;\n\ntypedef union _frameqos {\n\tu16 shortdata;\n\tu8  chardata[2];\n\tstruct {\n\t\tu16 tid:4;\n\t\tu16 eosp:1;\n\t\tu16 ack_policy:2;\n\t\tu16 reserved:1;\n\t\tu16 txop:8;\n\t} field;\n} frameqos, *pframeqos;\n\n \n#define MAX_SWEEP_TAB_ENTRIES\t\t  42\n#define MAX_SWEEP_TAB_ENTRIES_PER_PACKET  7\n \n#define MAX_RATES_LENGTH                  ((u8)12)\n#define MAX_RATES_EX_LENGTH               ((u8)16)\n#define MAX_NETWORK_COUNT                  128\n\n#define MAX_CHANNEL_NUMBER                 161\n#define IEEE80211_SOFTMAC_SCAN_TIME\t   100\n\n#define IEEE80211_SOFTMAC_ASSOC_RETRY_TIME (HZ * 2)\n\n#define CRC_LENGTH                 4U\n\n#define MAX_WPA_IE_LEN 64\n\n#define NETWORK_EMPTY_ESSID (1<<0)\n#define NETWORK_HAS_OFDM    (1<<1)\n#define NETWORK_HAS_CCK     (1<<2)\n\n \n#define NETWORK_HAS_QOS_PARAMETERS      (1<<3)\n#define NETWORK_HAS_QOS_INFORMATION     (1<<4)\n#define NETWORK_HAS_QOS_MASK            (NETWORK_HAS_QOS_PARAMETERS | \\\n\t\t\t\t\t NETWORK_HAS_QOS_INFORMATION)\n \n#define NETWORK_HAS_POWER_CONSTRAINT    (1<<5)\n#define NETWORK_HAS_CSA                 (1<<6)\n#define NETWORK_HAS_QUIET               (1<<7)\n#define NETWORK_HAS_IBSS_DFS            (1<<8)\n#define NETWORK_HAS_TPC_REPORT          (1<<9)\n\n#define NETWORK_HAS_ERP_VALUE           (1<<10)\n\n#define QOS_QUEUE_NUM                   4\n#define QOS_OUI_LEN                     3\n#define QOS_OUI_TYPE                    2\n#define QOS_ELEMENT_ID                  221\n#define QOS_OUI_INFO_SUB_TYPE           0\n#define QOS_OUI_PARAM_SUB_TYPE          1\n#define QOS_VERSION_1                   1\n#define QOS_AIFSN_MIN_VALUE             2\nstruct ieee80211_qos_information_element {\n\tu8 elementID;\n\tu8 length;\n\tu8 qui[QOS_OUI_LEN];\n\tu8 qui_type;\n\tu8 qui_subtype;\n\tu8 version;\n\tu8 ac_info;\n} __packed;\n\nstruct ieee80211_qos_ac_parameter {\n\tu8 aci_aifsn;\n\tu8 ecw_min_max;\n\t__le16 tx_op_limit;\n} __packed;\n\nstruct ieee80211_qos_parameter_info {\n\tstruct ieee80211_qos_information_element info_element;\n\tu8 reserved;\n\tstruct ieee80211_qos_ac_parameter ac_params_record[QOS_QUEUE_NUM];\n} __packed;\n\nstruct ieee80211_qos_parameters {\n\t__le16 cw_min[QOS_QUEUE_NUM];\n\t__le16 cw_max[QOS_QUEUE_NUM];\n\tu8 aifs[QOS_QUEUE_NUM];\n\tu8 flag[QOS_QUEUE_NUM];\n\t__le16 tx_op_limit[QOS_QUEUE_NUM];\n} __packed;\n\nstruct ieee80211_qos_data {\n\tstruct ieee80211_qos_parameters parameters;\n\tint active;\n\tint supported;\n\tu8 param_count;\n\tu8 old_param_count;\n};\n\nstruct ieee80211_tim_parameters {\n\tu8 tim_count;\n\tu8 tim_period;\n} __packed;\n\n\nstruct ieee80211_wmm_ts_info {\n\tu8 ac_dir_tid;\n\tu8 ac_up_psb;\n\tu8 reserved;\n} __packed;\n\nstruct ieee80211_wmm_tspec_elem {\n\tstruct ieee80211_wmm_ts_info ts_info;\n\tu16 norm_msdu_size;\n\tu16 max_msdu_size;\n\tu32 min_serv_inter;\n\tu32 max_serv_inter;\n\tu32 inact_inter;\n\tu32 suspen_inter;\n\tu32 serv_start_time;\n\tu32 min_data_rate;\n\tu32 mean_data_rate;\n\tu32 peak_data_rate;\n\tu32 max_burst_size;\n\tu32 delay_bound;\n\tu32 min_phy_rate;\n\tu16 surp_band_allow;\n\tu16 medium_time;\n} __packed;\nenum eap_type {\n\tEAP_PACKET = 0,\n\tEAPOL_START,\n\tEAPOL_LOGOFF,\n\tEAPOL_KEY,\n\tEAPOL_ENCAP_ASF_ALERT\n};\n\nstatic const char *eap_types[] = {\n\t[EAP_PACKET]\t\t= \"EAP-Packet\",\n\t[EAPOL_START]\t\t= \"EAPOL-Start\",\n\t[EAPOL_LOGOFF]\t\t= \"EAPOL-Logoff\",\n\t[EAPOL_KEY]\t\t= \"EAPOL-Key\",\n\t[EAPOL_ENCAP_ASF_ALERT]\t= \"EAPOL-Encap-ASF-Alert\"\n};\n\nstatic inline const char *eap_get_type(int type)\n{\n\treturn ((u32)type >= ARRAY_SIZE(eap_types)) ? \"Unknown\" : eap_types[type];\n}\n\nstatic inline u8 Frame_QoSTID(u8 *buf)\n{\n\tstruct rtl_80211_hdr_3addr *hdr;\n\tu16 fc;\n\thdr = (struct rtl_80211_hdr_3addr *)buf;\n\tfc = le16_to_cpu(hdr->frame_ctl);\n\treturn (u8)((frameqos *)(buf + (((fc & IEEE80211_FCTL_TODS) && (fc & IEEE80211_FCTL_FROMDS)) ? 30 : 24)))->field.tid;\n}\n\n\n\nstruct eapol {\n\tu8 snap[6];\n\tu16 ethertype;\n\tu8 version;\n\tu8 type;\n\tu16 length;\n} __packed;\n\nstruct ieee80211_softmac_stats {\n\tunsigned int rx_ass_ok;\n\tunsigned int rx_ass_err;\n\tunsigned int rx_probe_rq;\n\tunsigned int tx_probe_rs;\n\tunsigned int tx_beacons;\n\tunsigned int rx_auth_rq;\n\tunsigned int rx_auth_rs_ok;\n\tunsigned int rx_auth_rs_err;\n\tunsigned int tx_auth_rq;\n\tunsigned int no_auth_rs;\n\tunsigned int no_ass_rs;\n\tunsigned int tx_ass_rq;\n\tunsigned int rx_ass_rq;\n\tunsigned int tx_probe_rq;\n\tunsigned int reassoc;\n\tunsigned int swtxstop;\n\tunsigned int swtxawake;\n\tunsigned char CurrentShowTxate;\n\tunsigned char last_packet_rate;\n\tunsigned int txretrycount;\n};\n\n#define BEACON_PROBE_SSID_ID_POSITION 12\n\nstruct ieee80211_info_element_hdr {\n\tu8 id;\n\tu8 len;\n} __packed;\n\n \n\n#define IEEE80211_DEFAULT_TX_ESSID \"Penguin\"\n#define IEEE80211_DEFAULT_BASIC_RATE 2 \n\nenum {WMM_all_frame, WMM_two_frame, WMM_four_frame, WMM_six_frame};\n#define MAX_SP_Len  (WMM_all_frame << 4)\n#define IEEE80211_QOS_TID 0x0f\n#define QOS_CTL_NOTCONTAIN_ACK (0x01 << 5)\n\n#define IEEE80211_DTIM_MBCAST 4\n#define IEEE80211_DTIM_UCAST 2\n#define IEEE80211_DTIM_VALID 1\n#define IEEE80211_DTIM_INVALID 0\n\n#define IEEE80211_PS_DISABLED 0\n#define IEEE80211_PS_UNICAST IEEE80211_DTIM_UCAST\n#define IEEE80211_PS_MBCAST IEEE80211_DTIM_MBCAST\n\n\n\n#ifdef WMM_Hang_8187\n#undef WMM_Hang_8187\n#endif\n\n#define WME_AC_BK   0x00\n#define WME_AC_BE   0x01\n#define WME_AC_VI   0x02\n#define WME_AC_VO   0x03\n#define WME_ACI_MASK 0x03\n#define WME_AIFSN_MASK 0x03\n#define WME_AC_PRAM_LEN 16\n\n#define MAX_RECEIVE_BUFFER_SIZE 9100\n\n\n\n#define UP2AC(up) (\t\t   \\\n\t((up) < 1) ? WME_AC_BE : \\\n\t((up) < 3) ? WME_AC_BK : \\\n\t((up) < 4) ? WME_AC_BE : \\\n\t((up) < 6) ? WME_AC_VI : \\\n\tWME_AC_VO)\n\n#define AC2UP(_ac)\t(       \\\n\t((_ac) == WME_AC_VO) ? 6 : \\\n\t((_ac) == WME_AC_VI) ? 5 : \\\n\t((_ac) == WME_AC_BK) ? 1 : \\\n\t0)\n\n#define\tETHER_ADDR_LEN\t\t6\t \n#define ETHERNET_HEADER_SIZE    14       \n\nstruct\tether_header {\n\tu8 ether_dhost[ETHER_ADDR_LEN];\n\tu8 ether_shost[ETHER_ADDR_LEN];\n\tu16 ether_type;\n} __packed;\n\n#ifndef ETHERTYPE_PAE\n#define\tETHERTYPE_PAE\t0x888e\t\t \n#endif\n#ifndef ETHERTYPE_IP\n#define\tETHERTYPE_IP\t0x0800\t\t \n#endif\n\ntypedef enum _erp_t {\n\tERP_NonERPpresent\t= 0x01,\n\tERP_UseProtection\t= 0x02,\n\tERP_BarkerPreambleMode = 0x04,\n} erp_t;\n\n\nstruct ieee80211_network {\n\t \n\tu8 bssid[ETH_ALEN];    \n\tu8 channel;\n\n\t\n\tbool\tbMBssidValid;\n\tu8\tMBssid[ETH_ALEN];     \n\tu8\tMBssidMask;\n\t \n\tu8 ssid[IW_ESSID_MAX_SIZE + 1];\n\tu8 ssid_len;\n\tstruct ieee80211_qos_data qos_data;\n\n\t\n\tbool\tbWithAironetIE;\n\tbool\tbCkipSupported;\n\tbool\tbCcxRmEnable;\n\tu16\tCcxRmState[2];\n\t\n\tbool\tbWithCcxVerNum;\n\tu8\tBssCcxVerNumber;\n\t \n\tstruct ieee80211_rx_stats stats;\n\tu16 capability;\n\tu8  rates[MAX_RATES_LENGTH];\n\tu8  rates_len;\n\tu8  rates_ex[MAX_RATES_EX_LENGTH];\n\tu8  rates_ex_len;\n\tunsigned long last_scanned;\n\tu8  mode;\n\tu32 flags;\n\tu32 last_associate;\n\tu32 time_stamp[2];\n\tu16 beacon_interval;\n\tu16 listen_interval;\n\tu16 atim_window;\n\tu8  erp_value;\n\tu8  wpa_ie[MAX_WPA_IE_LEN];\n\tsize_t wpa_ie_len;\n\tu8  rsn_ie[MAX_WPA_IE_LEN];\n\tsize_t rsn_ie_len;\n\n\tstruct ieee80211_tim_parameters tim;\n\tu8  dtim_period;\n\tu8  dtim_data;\n\tu32 last_dtim_sta_time[2];\n\n\t\n\tu8 wmm_info;\n\tstruct ieee80211_wmm_ac_param wmm_param[4];\n\tu8 QoS_Enable;\n#ifdef THOMAS_TURBO\n\tu8 Turbo_Enable;\n#endif\n\tu16 CountryIeLen;\n\tu8 CountryIeBuf[MAX_IE_LEN];\n\t\n\tBSS_HT\tbssht;\n\t\n\tbool broadcom_cap_exist;\n\tbool ralink_cap_exist;\n\tbool atheros_cap_exist;\n\tbool cisco_cap_exist;\n\tbool unknown_cap_exist;\n\n\tbool\tberp_info_valid;\n\tbool buseprotection;\n\t\n\tstruct list_head list;\n};\n\nenum ieee80211_state {\n\n\t \n\tIEEE80211_NOLINK = 0,\n\n\t \n\n\t \n\tIEEE80211_ASSOCIATING,\n\tIEEE80211_ASSOCIATING_RETRY,\n\n\t \n\tIEEE80211_ASSOCIATING_AUTHENTICATING,\n\n\t \n\tIEEE80211_ASSOCIATING_AUTHENTICATED,\n\n\t \n\tIEEE80211_LINKED,\n\n\t \n\tIEEE80211_LINKED_SCANNING,\n\n};\n\n#define DEFAULT_MAX_SCAN_AGE (15 * HZ)\n#define DEFAULT_FTS 2346\n\n#define CFG_IEEE80211_RESERVE_FCS (1<<0)\n#define CFG_IEEE80211_COMPUTE_FCS (1<<1)\n#define CFG_IEEE80211_RTS (1<<2)\n\n#define IEEE80211_24GHZ_MIN_CHANNEL 1\n#define IEEE80211_24GHZ_MAX_CHANNEL 14\n#define IEEE80211_24GHZ_CHANNELS (IEEE80211_24GHZ_MAX_CHANNEL - \\\n\t\t\t\t  IEEE80211_24GHZ_MIN_CHANNEL + 1)\n\n#define IEEE80211_52GHZ_MIN_CHANNEL 34\n#define IEEE80211_52GHZ_MAX_CHANNEL 165\n#define IEEE80211_52GHZ_CHANNELS (IEEE80211_52GHZ_MAX_CHANNEL - \\\n\t\t\t\t  IEEE80211_52GHZ_MIN_CHANNEL + 1)\n\n\n\nstruct tx_pending {\n\tint frag;\n\tstruct ieee80211_txb *txb;\n};\n\nstruct bandwidth_autoswitch {\n\tlong threshold_20Mhzto40Mhz;\n\tlong\tthreshold_40Mhzto20Mhz;\n\tbool bforced_tx20Mhz;\n\tbool bautoswitch_enable;\n};\n\n\n\n\n#define REORDER_WIN_SIZE\t128\n#define REORDER_ENTRY_NUM\t128\nstruct rx_reorder_entry {\n\tstruct list_head\tList;\n\tu16\t\t\tSeqNum;\n\tstruct ieee80211_rxb *prxb;\n};\n\ntypedef enum _Fsync_State {\n\tDefault_Fsync,\n\tHW_Fsync,\n\tSW_Fsync\n} Fsync_State;\n\n\ntypedef\tenum _RT_PS_MODE {\n\teActive,\t\n\teMaxPs,\t\t\n\teFastPs\t\t\n} RT_PS_MODE;\n\ntypedef enum _IPS_CALLBACK_FUNCION {\n\tIPS_CALLBACK_NONE = 0,\n\tIPS_CALLBACK_MGNT_LINK_REQUEST = 1,\n\tIPS_CALLBACK_JOIN_REQUEST = 2,\n} IPS_CALLBACK_FUNCION;\n\ntypedef enum _RT_JOIN_ACTION {\n\tRT_JOIN_INFRA   = 1,\n\tRT_JOIN_IBSS  = 2,\n\tRT_START_IBSS = 3,\n\tRT_NO_ACTION  = 4,\n} RT_JOIN_ACTION;\n\nstruct ibss_parms {\n\tu16   atimWin;\n};\n#define MAX_NUM_RATES\t264 \n\n\ntypedef\tenum _RT_RF_POWER_STATE {\n\teRfOn,\n\teRfSleep,\n\teRfOff\n} RT_RF_POWER_STATE;\n\nstruct rt_power_save_control {\n\n\t\n\t\n\t\n\tbool\t\t\t\tbInactivePs;\n\tbool\t\t\t\tbIPSModeBackup;\n\tbool\t\t\t\tbSwRfProcessing;\n\tRT_RF_POWER_STATE\teInactivePowerState;\n\tstruct work_struct\tInactivePsWorkItem;\n\tstruct timer_list\tInactivePsTimer;\n\n\t\n\tIPS_CALLBACK_FUNCION\tReturnPoint;\n\n\t\n\tbool\t\t\t\tbTmpBssDesc;\n\tRT_JOIN_ACTION\t\ttmpJoinAction;\n\tstruct ieee80211_network tmpBssDesc;\n\n\t\n\tbool\t\t\t\tbTmpScanOnly;\n\tbool\t\t\t\tbTmpActiveScan;\n\tbool\t\t\t\tbTmpFilterHiddenAP;\n\tbool\t\t\t\tbTmpUpdateParms;\n\tu8\t\t\t\t\ttmpSsidBuf[33];\n\tstruct octet_string\t\t\ttmpSsid2Scan;\n\tbool\t\t\t\tbTmpSsid2Scan;\n\tu8\t\t\t\t\ttmpNetworkType;\n\tu8\t\t\t\t\ttmpChannelNumber;\n\tu16\t\t\t\t\ttmpBcnPeriod;\n\tu8\t\t\t\t\ttmpDtimPeriod;\n\tu16\t\t\t\t\ttmpmCap;\n\tstruct octet_string\t\t\ttmpSuppRateSet;\n\tu8\t\t\t\t\ttmpSuppRateBuf[MAX_NUM_RATES];\n\tbool\t\t\t\tbTmpSuppRate;\n\tstruct ibss_parms\t\t\ttmpIbpm;\n\tbool\t\t\t\tbTmpIbpm;\n\n\t\n\t\n\t\n\tbool\t\t\t\tbLeisurePs;\n\n};\n\ntypedef u32 RT_RF_CHANGE_SOURCE;\n#define RF_CHANGE_BY_SW\t\tBIT(31)\n#define RF_CHANGE_BY_HW\t\tBIT(30)\n#define RF_CHANGE_BY_PS\t\tBIT(29)\n#define RF_CHANGE_BY_IPS\tBIT(28)\n#define RF_CHANGE_BY_INIT\t0\t\n\ntypedef enum {\n\tCOUNTRY_CODE_FCC = 0,\n\tCOUNTRY_CODE_IC = 1,\n\tCOUNTRY_CODE_ETSI = 2,\n\tCOUNTRY_CODE_SPAIN = 3,\n\tCOUNTRY_CODE_FRANCE = 4,\n\tCOUNTRY_CODE_MKK = 5,\n\tCOUNTRY_CODE_MKK1 = 6,\n\tCOUNTRY_CODE_ISRAEL = 7,\n\tCOUNTRY_CODE_TELEC,\n\tCOUNTRY_CODE_MIC,\n\tCOUNTRY_CODE_GLOBAL_DOMAIN\n} country_code_type_t;\n\n#define RT_MAX_LD_SLOT_NUM\t10\nstruct rt_link_detect {\n\n\tu32\t\t\t\tNumRecvBcnInPeriod;\n\tu32\t\t\t\tNumRecvDataInPeriod;\n\n\tu32\t\t\t\tRxBcnNum[RT_MAX_LD_SLOT_NUM];\t\n\tu32\t\t\t\tRxDataNum[RT_MAX_LD_SLOT_NUM];\t\n\tu16\t\t\t\tSlotNum;\t\n\tu16\t\t\t\tSlotIndex;\n\n\tu32\t\t\t\tNumTxOkInPeriod;\n\tu32\t\t\t\tNumRxOkInPeriod;\n\tbool\t\t\t\tbBusyTraffic;\n};\n\n\nstruct ieee80211_device {\n\tstruct net_device *dev;\n\tstruct ieee80211_security sec;\n\n\t\n\n\tu8 hwsec_active;  \n\tbool is_silent_reset;\n\tbool ieee_up;\n\t\n\tbool bSupportRemoteWakeUp;\n\tRT_PS_MODE\tdot11PowerSaveMode; \n\tbool actscanning;\n\tbool beinretry;\n\tRT_RF_POWER_STATE\t\teRFPowerState;\n\tRT_RF_CHANGE_SOURCE\tRfOffReason;\n\tbool is_set_key;\n\t\n\n\t\n\tPRT_HIGH_THROUGHPUT\tpHTInfo;\n\t\n\n\tspinlock_t bw_spinlock;\n\n\tspinlock_t reorder_spinlock;\n\t\n\t\n\tu8\tRegdot11HTOperationalRateSet[16];\t\t\n\tu8\tdot11HTOperationalRateSet[16];\t\t\n\tu8\tRegHTSuppRateSet[16];\n\tu8\t\t\t\tHTCurrentOperaRate;\n\tu8\t\t\t\tHTHighestOperaRate;\n\t\n\tu8\tbTxDisableRateFallBack;\n\tu8\tbTxUseDriverAssingedRate;\n\tatomic_t\tatm_chnlop;\n\tatomic_t\tatm_swbw;\n\n\n\n\t\n\tstruct list_head\t\tTx_TS_Admit_List;\n\tstruct list_head\t\tTx_TS_Pending_List;\n\tstruct list_head\t\tTx_TS_Unused_List;\n\tstruct tx_ts_record\t\tTxTsRecord[TOTAL_TS_NUM];\n\t\n\tstruct list_head\t\tRx_TS_Admit_List;\n\tstruct list_head\t\tRx_TS_Pending_List;\n\tstruct list_head\t\tRx_TS_Unused_List;\n\tstruct rx_ts_record\t\tRxTsRecord[TOTAL_TS_NUM];\n\tstruct rx_reorder_entry\tRxReorderEntry[128];\n\tstruct list_head\t\tRxReorder_Unused_List;\n\t\n\n\tu8\t\t\t\tForcedPriority;\t\t\n\n\n\t \n\tstruct net_device_stats stats;\n\tstruct ieee80211_stats ieee_stats;\n\tstruct ieee80211_softmac_stats softmac_stats;\n\n\t \n\tstruct list_head network_free_list;\n\tstruct list_head network_list;\n\tstruct ieee80211_network *networks;\n\tint scans;\n\tint scan_age;\n\n\tint iw_mode;  \n\tstruct iw_spy_data spy_data;\n\n\tspinlock_t lock;\n\tspinlock_t wpax_suitlist_lock;\n\n\tint tx_headroom;  \n\tu32 config;\n\n\t \n\tint open_wep;  \n\tint auth_mode;\n\tint reset_on_keychange;  \n\n\t \n\tint host_encrypt;\n\tint host_encrypt_msdu;\n\tint host_decrypt;\n\t \n\tint host_mc_decrypt;\n\n\t \n\t \n\tint host_strip_iv_icv;\n\n\tint host_open_frag;\n\tint host_build_iv;\n\tint ieee802_1x;  \n\n\t \n\tbool bHalfWirelessN24GMode;\n\tint wpa_enabled;\n\tint drop_unencrypted;\n\tint tkip_countermeasures;\n\tint privacy_invoked;\n\tsize_t wpa_ie_len;\n\tu8 *wpa_ie;\n\tu8 ap_mac_addr[6];\n\tu16 pairwise_key_type;\n\tu16 group_key_type;\n\tstruct list_head crypt_deinit_list;\n\tstruct ieee80211_crypt_data *crypt[WEP_KEYS];\n\tint tx_keyidx;  \n\tstruct timer_list crypt_deinit_timer;\n\tint crypt_quiesced;\n\n\tint bcrx_sta_key;  \n\n\t \n\t\n\tstruct ieee80211_frag_entry frag_cache[17][IEEE80211_FRAG_CACHE_LEN];\n\tunsigned int frag_next_idx[17];\n\tu16 fts;  \n#define DEFAULT_RTS_THRESHOLD 2346U\n#define MIN_RTS_THRESHOLD 1\n#define MAX_RTS_THRESHOLD 2346U\n\tu16 rts;  \n\n\t \n\tu8 bssid[ETH_ALEN];\n\n\t \n\tstruct ieee80211_network current_network;\n\n\tenum ieee80211_state state;\n\n\tint short_slot;\n\tint reg_mode;\n\tint mode;        \n\tint modulation;  \n\tint freq_band;   \n\tint abg_true;    \n\n\t \n\tshort sync_scan_hurryup;\n\n\tint perfect_rssi;\n\tint worst_rssi;\n\n\tu16 prev_seq_ctl;        \n\n\t \n\t\n\tvoid *dot11d_info;\n\tbool bGlobalDomain;\n\tint rate;        \n\tint basic_rate;\n\t\n\tshort active_scan;\n\n\t \n\tu16 softmac_features;\n\n\t \n\tu16 seq_ctrl[5];\n\n\t \n\tu16 associate_seq;\n\n\t \n\tu16 assoc_id;\n\n\t \n\tshort ps;\n\tshort sta_sleep;\n\tint ps_timeout;\n\tint ps_period;\n\tstruct work_struct ps_task;\n\tu32 ps_th;\n\tu32 ps_tl;\n\n\tshort raw_tx;\n\t \n\tshort queue_stop;\n\tshort scanning;\n\tshort proto_started;\n\n\tstruct mutex wx_mutex;\n\tstruct mutex scan_mutex;\n\n\tspinlock_t mgmt_tx_lock;\n\tspinlock_t beacon_lock;\n\n\tshort beacon_txing;\n\n\tshort wap_set;\n\tshort ssid_set;\n\n\tu8  wpax_type_set;    \n\tu32 wpax_type_notify; \n\n\t \n\ts8  init_wmmparam_flag;\n\t \n\tu8  qos_support;\n\n\t \n\tstruct list_head ibss_mac_hash[IEEE_IBSS_MAC_HASH_SIZE];\n\n\t \n\tu16 last_rxseq_num[17];  \n\tu16 last_rxfrag_num[17]; \n\tunsigned long last_packet_time[17];\n\n\t \n\tunsigned long last_rx_ps_time;\n\n\t \n\tstruct sk_buff *mgmt_queue_ring[MGMT_QUEUE_NUM];\n\tint mgmt_queue_head;\n\tint mgmt_queue_tail;\n\n#define IEEE80211_QUEUE_LIMIT 128\n\tu8 AsocRetryCount;\n\tunsigned int hw_header;\n\tstruct sk_buff_head skb_waitQ[MAX_QUEUE_SIZE];\n\tstruct sk_buff_head  skb_aggQ[MAX_QUEUE_SIZE];\n\tstruct sk_buff_head  skb_drv_aggQ[MAX_QUEUE_SIZE];\n\tu32\tsta_edca_param[4];\n\tbool aggregation;\n\t\n\tbool enable_rx_imm_BA;\n\tbool bibsscoordinator;\n\n\t\n\t\n\tbool\tbdynamic_txpower_enable;\n\n\tbool bCTSToSelfEnable;\n\tu8\tCTSToSelfTH;\n\n\tu32\tfsync_time_interval;\n\tu32\tfsync_rate_bitmap;\n\tu8\tfsync_rssi_threshold;\n\tbool\tbfsync_enable;\n\n\tu8\tfsync_multiple_timeinterval;\t\t\n\tu32\tfsync_firstdiff_ratethreshold;\t\t\n\tu32\tfsync_seconddiff_ratethreshold;\t \n\tFsync_State\t\t\tfsync_state;\n\tbool\t\tbis_any_nonbepkts;\n\t\n\tstruct bandwidth_autoswitch bandwidth_auto_switch;\n\t\n\tbool FwRWRF;\n\n\t\n\tstruct rt_link_detect LinkDetectInfo;\n\t\n\tstruct rt_power_save_control PowerSaveControl;\n\n\t \n\tstruct  tx_pending tx_pending;\n\n\t \n\tstruct timer_list associate_timer;\n\n\t \n\tstruct timer_list beacon_timer;\n\tstruct work_struct associate_complete_wq;\n\tstruct work_struct associate_procedure_wq;\n\tstruct delayed_work softmac_scan_wq;\n\tstruct delayed_work associate_retry_wq;\n\tstruct delayed_work start_ibss_wq;\n\tstruct work_struct wx_sync_scan_wq;\n\tstruct workqueue_struct *wq;\n\t\n\t\n\n\t\n\t\n\n\tstruct ieee80211_rxb *stats_IndicateArray[REORDER_WIN_SIZE];\n\n\t \n\tvoid (*set_security)(struct net_device *dev,\n\t\t\t     struct ieee80211_security *sec);\n\n\t \n\tint (*hard_start_xmit)(struct ieee80211_txb *txb,\n\t\t\t       struct net_device *dev);\n\n\tint (*reset_port)(struct net_device *dev);\n\tint (*is_queue_full)(struct net_device *dev, int pri);\n\n\tint (*handle_management)(struct net_device *dev,\n\t\t\t\t  struct ieee80211_network *network, u16 type);\n\tint (*is_qos_active)(struct net_device *dev, struct sk_buff *skb);\n\n\t \n\tint (*softmac_hard_start_xmit)(struct sk_buff *skb,\n\t\t\t       struct net_device *dev);\n\n\t \n\tvoid (*softmac_data_hard_start_xmit)(struct sk_buff *skb,\n\t\t\t       struct net_device *dev, int rate);\n\n\t \n\tvoid (*data_hard_stop)(struct net_device *dev);\n\n\t \n\tvoid (*data_hard_resume)(struct net_device *dev);\n\n\t \n\tvoid (*set_chan)(struct net_device *dev, short ch);\n\n\t \n\tvoid (*scan_syncro)(struct net_device *dev);\n\tvoid (*start_scan)(struct net_device *dev);\n\tvoid (*stop_scan)(struct net_device *dev);\n\n\t \n\tvoid (*link_change)(struct net_device *dev);\n\n\t \n\tvoid (*start_send_beacons)(struct net_device *dev, u16 tx_rate);\n\tvoid (*stop_send_beacons)(struct net_device *dev);\n\n\t \n\tvoid (*sta_wake_up)(struct net_device *dev);\n\tvoid (*ps_request_tx_ack)(struct net_device *dev);\n\tvoid (*enter_sleep_state)(struct net_device *dev, u32 th, u32 tl);\n\tshort (*ps_is_queue_empty)(struct net_device *dev);\n\tint (*handle_beacon)(struct net_device *dev, struct ieee80211_beacon *beacon, struct ieee80211_network *network);\n\tint (*handle_assoc_response)(struct net_device *dev, struct ieee80211_assoc_response_frame *resp, struct ieee80211_network *network);\n\n\n\t \n\tshort (*check_nic_enough_desc)(struct net_device *dev, int queue_index);\n\t \n \n\tvoid (*SetBWModeHandler)(struct net_device *dev, enum ht_channel_width Bandwidth, enum ht_extension_chan_offset Offset);\n \n\tbool (*GetNmodeSupportBySecCfg)(struct net_device *dev);\n\tvoid (*SetWirelessMode)(struct net_device *dev, u8 wireless_mode);\n\tbool (*GetHalfNmodeSupportByAPsHandler)(struct net_device *dev);\n\tvoid (*InitialGainHandler)(struct net_device *dev, u8 Operation);\n\n\t \n\tu8 priv[];\n};\n\n#define IEEE_A            (1<<0)\n#define IEEE_B            (1<<1)\n#define IEEE_G            (1<<2)\n#define IEEE_N_24G        (1<<4)\n#define IEEE_N_5G         (1<<5)\n#define IEEE_MODE_MASK    (IEEE_A | IEEE_B | IEEE_G)\n\n \n\n \n#define IEEE_SOFTMAC_SCAN (1<<2)\n\n \n#define IEEE_SOFTMAC_ASSOCIATE (1<<3)\n\n \n#define IEEE_SOFTMAC_PROBERQ (1<<4)\n\n \n#define IEEE_SOFTMAC_PROBERS (1<<5)\n\n \n#define IEEE_SOFTMAC_TX_QUEUE (1<<7)\n\n \n#define IEEE_SOFTMAC_SINGLE_QUEUE (1<<8)\n\n \n#define IEEE_SOFTMAC_BEACONS (1<<6)\n\nstatic inline void *ieee80211_priv(struct net_device *dev)\n{\n\treturn ((struct ieee80211_device *)netdev_priv(dev))->priv;\n}\n\nstatic inline int ieee80211_is_empty_essid(const char *essid, int essid_len)\n{\n\t \n\tif (essid_len == 1 && essid[0] == ' ')\n\t\treturn 1;\n\n\t \n\twhile (essid_len) {\n\t\tessid_len--;\n\t\tif (essid[essid_len] != '\\0')\n\t\t\treturn 0;\n\t}\n\n\treturn 1;\n}\n\nstatic inline int ieee80211_is_valid_mode(struct ieee80211_device *ieee, int mode)\n{\n\t \n\tif ((mode & IEEE_A) &&\n\t    (ieee->modulation & IEEE80211_OFDM_MODULATION) &&\n\t    (ieee->freq_band & IEEE80211_52GHZ_BAND))\n\t\treturn 1;\n\n\tif ((mode & IEEE_G) &&\n\t    (ieee->modulation & IEEE80211_OFDM_MODULATION) &&\n\t    (ieee->freq_band & IEEE80211_24GHZ_BAND))\n\t\treturn 1;\n\n\tif ((mode & IEEE_B) &&\n\t    (ieee->modulation & IEEE80211_CCK_MODULATION) &&\n\t    (ieee->freq_band & IEEE80211_24GHZ_BAND))\n\t\treturn 1;\n\n\treturn 0;\n}\n\nstatic inline int ieee80211_get_hdrlen(u16 fc)\n{\n\tint hdrlen = IEEE80211_3ADDR_LEN;\n\n\tswitch (WLAN_FC_GET_TYPE(fc)) {\n\tcase IEEE80211_FTYPE_DATA:\n\t\tif ((fc & IEEE80211_FCTL_FROMDS) && (fc & IEEE80211_FCTL_TODS))\n\t\t\thdrlen = IEEE80211_4ADDR_LEN;  \n\t\tif (IEEE80211_QOS_HAS_SEQ(fc))\n\t\t\thdrlen += 2;  \n\t\tbreak;\n\tcase IEEE80211_FTYPE_CTL:\n\t\tswitch (WLAN_FC_GET_STYPE(fc)) {\n\t\tcase IEEE80211_STYPE_CTS:\n\t\tcase IEEE80211_STYPE_ACK:\n\t\t\thdrlen = IEEE80211_1ADDR_LEN;\n\t\t\tbreak;\n\t\tdefault:\n\t\t\thdrlen = IEEE80211_2ADDR_LEN;\n\t\t\tbreak;\n\t\t}\n\t\tbreak;\n\t}\n\n\treturn hdrlen;\n}\n\nstatic inline u8 *ieee80211_get_payload(struct rtl_80211_hdr *hdr)\n{\n\tswitch (ieee80211_get_hdrlen(le16_to_cpu(hdr->frame_ctl))) {\n\tcase IEEE80211_1ADDR_LEN:\n\t\treturn ((struct rtl_80211_hdr_1addr *)hdr)->payload;\n\tcase IEEE80211_2ADDR_LEN:\n\t\treturn ((struct rtl_80211_hdr_2addr *)hdr)->payload;\n\tcase IEEE80211_3ADDR_LEN:\n\t\treturn ((struct rtl_80211_hdr_3addr *)hdr)->payload;\n\tcase IEEE80211_4ADDR_LEN:\n\t\treturn ((struct rtl_80211_hdr_4addr *)hdr)->payload;\n\t}\n\treturn NULL;\n}\n\nstatic inline int ieee80211_is_ofdm_rate(u8 rate)\n{\n\tswitch (rate & ~IEEE80211_BASIC_RATE_MASK) {\n\tcase IEEE80211_OFDM_RATE_6MB:\n\tcase IEEE80211_OFDM_RATE_9MB:\n\tcase IEEE80211_OFDM_RATE_12MB:\n\tcase IEEE80211_OFDM_RATE_18MB:\n\tcase IEEE80211_OFDM_RATE_24MB:\n\tcase IEEE80211_OFDM_RATE_36MB:\n\tcase IEEE80211_OFDM_RATE_48MB:\n\tcase IEEE80211_OFDM_RATE_54MB:\n\t\treturn 1;\n\t}\n\treturn 0;\n}\n\nstatic inline int ieee80211_is_cck_rate(u8 rate)\n{\n\tswitch (rate & ~IEEE80211_BASIC_RATE_MASK) {\n\tcase IEEE80211_CCK_RATE_1MB:\n\tcase IEEE80211_CCK_RATE_2MB:\n\tcase IEEE80211_CCK_RATE_5MB:\n\tcase IEEE80211_CCK_RATE_11MB:\n\t\treturn 1;\n\t}\n\treturn 0;\n}\n\n\n \nvoid free_ieee80211(struct net_device *dev);\nstruct net_device *alloc_ieee80211(int sizeof_priv);\n\nint ieee80211_set_encryption(struct ieee80211_device *ieee);\n\n \n\nint ieee80211_encrypt_fragment(struct ieee80211_device *ieee,\n\t\t\t       struct sk_buff *frag, int hdr_len);\n\nnetdev_tx_t ieee80211_xmit(struct sk_buff *skb, struct net_device *dev);\nvoid ieee80211_txb_free(struct ieee80211_txb *txb);\n\n\n \nint ieee80211_rx(struct ieee80211_device *ieee, struct sk_buff *skb,\n\t\t struct ieee80211_rx_stats *rx_stats);\nvoid ieee80211_rx_mgt(struct ieee80211_device *ieee,\n\t\t      struct rtl_80211_hdr_4addr *header,\n\t\t      struct ieee80211_rx_stats *stats);\n\n \nint ieee80211_wx_get_scan(struct ieee80211_device *ieee,\n\t\t\t  struct iw_request_info *info,\n\t\t\t  union iwreq_data *wrqu, char *key);\nint ieee80211_wx_set_encode(struct ieee80211_device *ieee,\n\t\t\t    struct iw_request_info *info,\n\t\t\t    union iwreq_data *wrqu, char *key);\nint ieee80211_wx_get_encode(struct ieee80211_device *ieee,\n\t\t\t    struct iw_request_info *info,\n\t\t\t    union iwreq_data *wrqu, char *key);\nint ieee80211_wx_get_encode_ext(struct ieee80211_device *ieee,\n\t\t\t\tstruct iw_request_info *info,\n\t\t\t\tunion iwreq_data *wrqu, char *extra);\nint ieee80211_wx_set_encode_ext(struct ieee80211_device *ieee,\n\t\t\t\tstruct iw_request_info *info,\n\t\t\t\tunion iwreq_data *wrqu, char *extra);\nint ieee80211_wx_set_auth(struct ieee80211_device *ieee,\n\t\t\t  struct iw_request_info *info,\n\t\t\t  struct iw_param *data, char *extra);\nint ieee80211_wx_set_mlme(struct ieee80211_device *ieee,\n\t\t\t  struct iw_request_info *info,\n\t\t\t  union iwreq_data *wrqu, char *extra);\nint ieee80211_wx_set_gen_ie(struct ieee80211_device *ieee, u8 *ie, size_t len);\n\n \nshort ieee80211_is_54g(const struct ieee80211_network *net);\nshort ieee80211_is_shortslot(const struct ieee80211_network *net);\nint ieee80211_rx_frame_softmac(struct ieee80211_device *ieee,\n\t\t\t       struct sk_buff *skb,\n\t\t\t       struct ieee80211_rx_stats *rx_stats,\n\t\t\t       u16 type, u16 stype);\nvoid ieee80211_softmac_new_net(struct ieee80211_device *ieee,\n\t\t\t       struct ieee80211_network *net);\n\nvoid SendDisassociation(struct ieee80211_device *ieee, u8 *asSta, u8 asRsn);\nvoid ieee80211_softmac_xmit(struct ieee80211_txb *txb,\n\t\t\t    struct ieee80211_device *ieee);\n\nvoid ieee80211_stop_send_beacons(struct ieee80211_device *ieee);\nvoid notify_wx_assoc_event(struct ieee80211_device *ieee);\nvoid ieee80211_softmac_check_all_nets(struct ieee80211_device *ieee);\nvoid ieee80211_start_bss(struct ieee80211_device *ieee);\nvoid ieee80211_start_master_bss(struct ieee80211_device *ieee);\nvoid ieee80211_start_ibss(struct ieee80211_device *ieee);\nvoid ieee80211_softmac_init(struct ieee80211_device *ieee);\nvoid ieee80211_softmac_free(struct ieee80211_device *ieee);\nvoid ieee80211_associate_abort(struct ieee80211_device *ieee);\nvoid ieee80211_disassociate(struct ieee80211_device *ieee);\nvoid ieee80211_stop_scan(struct ieee80211_device *ieee);\nvoid ieee80211_start_scan_syncro(struct ieee80211_device *ieee);\nvoid ieee80211_check_all_nets(struct ieee80211_device *ieee);\nvoid ieee80211_start_protocol(struct ieee80211_device *ieee);\nvoid ieee80211_stop_protocol(struct ieee80211_device *ieee);\nvoid ieee80211_softmac_start_protocol(struct ieee80211_device *ieee);\nvoid ieee80211_softmac_stop_protocol(struct ieee80211_device *ieee);\nvoid ieee80211_reset_queue(struct ieee80211_device *ieee);\nvoid ieee80211_wake_queue(struct ieee80211_device *ieee);\nvoid ieee80211_stop_queue(struct ieee80211_device *ieee);\nstruct sk_buff *ieee80211_get_beacon(struct ieee80211_device *ieee);\nvoid ieee80211_start_send_beacons(struct ieee80211_device *ieee);\nint ieee80211_wpa_supplicant_ioctl(struct ieee80211_device *ieee,\n\t\t\t\t   struct iw_point *p);\nvoid ieee80211_ps_tx_ack(struct ieee80211_device *ieee, short success);\n\nvoid softmac_mgmt_xmit(struct sk_buff *skb, struct ieee80211_device *ieee);\n\n \n\nint ieee80211_crypto_init(void);\nvoid ieee80211_crypto_deinit(void);\nint ieee80211_crypto_tkip_init(void);\nvoid ieee80211_crypto_tkip_exit(void);\nint ieee80211_crypto_ccmp_init(void);\nvoid ieee80211_crypto_ccmp_exit(void);\nint ieee80211_crypto_wep_init(void);\nvoid ieee80211_crypto_wep_exit(void);\n\n \n\nint ieee80211_wx_get_wap(struct ieee80211_device *ieee,\n\t\t\t struct iw_request_info *info,\n\t\t\t union iwreq_data *wrqu, char *ext);\n\nint ieee80211_wx_set_wap(struct ieee80211_device *ieee,\n\t\t\t struct iw_request_info *info,\n\t\t\t union iwreq_data *awrq,\n\t\t\t char *extra);\n\nint ieee80211_wx_get_essid(struct ieee80211_device *ieee,\n\t\t\t   struct iw_request_info *a,\n\t\t\t   union iwreq_data *wrqu, char *b);\n\nint ieee80211_wx_set_rate(struct ieee80211_device *ieee,\n\t\t\t  struct iw_request_info *info,\n\t\t\t  union iwreq_data *wrqu, char *extra);\n\nint ieee80211_wx_get_rate(struct ieee80211_device *ieee,\n\t\t\t  struct iw_request_info *info,\n\t\t\t  union iwreq_data *wrqu, char *extra);\n\nint ieee80211_wx_set_mode(struct ieee80211_device *ieee,\n\t\t\t  struct iw_request_info *a,\n\t\t\t  union iwreq_data *wrqu, char *b);\n\nint ieee80211_wx_set_scan(struct ieee80211_device *ieee,\n\t\t\t  struct iw_request_info *a,\n\t\t\t  union iwreq_data *wrqu, char *b);\n\nint ieee80211_wx_set_essid(struct ieee80211_device *ieee,\n\t\t\t   struct iw_request_info *a,\n\t\t\t   union iwreq_data *wrqu, char *extra);\n\nint ieee80211_wx_get_mode(struct ieee80211_device *ieee,\n\t\t\t  struct iw_request_info *a,\n\t\t\t  union iwreq_data *wrqu, char *b);\n\nint ieee80211_wx_set_freq(struct ieee80211_device *ieee,\n\t\t\t  struct iw_request_info *a,\n\t\t\t  union iwreq_data *wrqu, char *b);\n\nint ieee80211_wx_get_freq(struct ieee80211_device *ieee,\n\t\t\t  struct iw_request_info *a,\n\t\t\t  union iwreq_data *wrqu, char *b);\n\n \n#ifdef CONFIG_IEEE80211_DEBUG\nint ieee80211_debug_init(void);\nvoid ieee80211_debug_exit(void);\n#else\nstatic inline int ieee80211_debug_init(void) { return 0; }\nstatic inline void ieee80211_debug_exit(void) { }\n#endif\n\n \nvoid ieee80211_wx_sync_scan_wq(struct work_struct *work);\n\n\nint ieee80211_wx_set_rawtx(struct ieee80211_device *ieee,\n\t\t\t   struct iw_request_info *info,\n\t\t\t       union iwreq_data *wrqu, char *extra);\n\nint ieee80211_wx_get_name(struct ieee80211_device *ieee,\n\t\t\t  struct iw_request_info *info,\n\t\t\t  union iwreq_data *wrqu, char *extra);\n\nint ieee80211_wx_set_power(struct ieee80211_device *ieee,\n\t\t\t   struct iw_request_info *info,\n\t\t\t   union iwreq_data *wrqu, char *extra);\n\nint ieee80211_wx_get_power(struct ieee80211_device *ieee,\n\t\t\t   struct iw_request_info *info,\n\t\t\t   union iwreq_data *wrqu, char *extra);\n\nint ieee80211_wx_set_rts(struct ieee80211_device *ieee,\n\t\t\t struct iw_request_info *info,\n\t\t\t union iwreq_data *wrqu, char *extra);\n\nint ieee80211_wx_get_rts(struct ieee80211_device *ieee,\n\t\t\t struct iw_request_info *info,\n\t\t\t union iwreq_data *wrqu, char *extra);\n \n#define MAX_RECEIVE_BUFFER_SIZE 9100   \nvoid HTDebugHTCapability(u8 *CapIE, u8 *TitleString);\nvoid HTDebugHTInfo(u8 *InfoIE, u8 *TitleString);\n\nvoid HTSetConnectBwMode(struct ieee80211_device *ieee,\n\t\t\tenum ht_channel_width Bandwidth, enum ht_extension_chan_offset Offset);\nvoid HTUpdateDefaultSetting(struct ieee80211_device *ieee);\nvoid HTConstructCapabilityElement(struct ieee80211_device *ieee, u8 *posHTCap,\n\t\t\t\t  u8 *len, u8 isEncrypt);\nvoid HTConstructInfoElement(struct ieee80211_device *ieee, u8 *posHTInfo,\n\t\t\t    u8 *len, u8 isEncrypt);\nvoid HTConstructRT2RTAggElement(struct ieee80211_device *ieee, u8 *posRT2RTAgg,\n\t\t\t\tu8 *len);\nvoid HTOnAssocRsp(struct ieee80211_device *ieee);\nvoid HTInitializeHTInfo(struct ieee80211_device *ieee);\nvoid HTInitializeBssDesc(PBSS_HT pBssHT);\nvoid HTResetSelfAndSavePeerSetting(struct ieee80211_device *ieee,\n\t\t\t\t   struct ieee80211_network *pNetwork);\nvoid HTUpdateSelfAndPeerSetting(struct ieee80211_device *ieee,\n\t\t\t\tstruct ieee80211_network *pNetwork);\nu8 HTGetHighestMCSRate(struct ieee80211_device *ieee,\n\t\t       u8 *pMCSRateSet, u8 *pMCSFilter);\nextern u8 MCS_FILTER_ALL[];\nextern u16 MCS_DATA_RATE[2][2][77];\nu8 HTCCheck(struct ieee80211_device *ieee, u8 *pFrame);\nvoid HTResetIOTSetting(PRT_HIGH_THROUGHPUT pHTInfo);\nbool IsHTHalfNmodeAPs(struct ieee80211_device *ieee);\nu16 TxCountToDataRate(struct ieee80211_device *ieee, u8 nDataRate);\n \nint ieee80211_rx_ADDBAReq(struct ieee80211_device *ieee, struct sk_buff *skb);\nint ieee80211_rx_ADDBARsp(struct ieee80211_device *ieee, struct sk_buff *skb);\nint ieee80211_rx_DELBA(struct ieee80211_device *ieee, struct sk_buff *skb);\nvoid TsInitAddBA(struct ieee80211_device *ieee, struct tx_ts_record *pTS,\n\t\t u8 Policy, u8 bOverwritePending);\nvoid TsInitDelBA(struct ieee80211_device *ieee,\n\t\t struct ts_common_info *pTsCommonInfo, enum tr_select TxRxSelect);\nvoid BaSetupTimeOut(struct timer_list *t);\nvoid TxBaInactTimeout(struct timer_list *t);\nvoid RxBaInactTimeout(struct timer_list *t);\nvoid ResetBaEntry(struct ba_record *pBA);\n \nbool GetTs(\n\tstruct ieee80211_device\t\t*ieee,\n\tstruct ts_common_info           **ppTS,\n\tu8                              *Addr,\n\tu8                              TID,\n\tenum tr_select                  TxRxSelect,   \n\tbool                            bAddNewTs\n\t);\nvoid TSInitialize(struct ieee80211_device *ieee);\nvoid TsStartAddBaProcess(struct ieee80211_device *ieee, struct tx_ts_record   *pTxTS);\nvoid RemovePeerTS(struct ieee80211_device *ieee, u8 *Addr);\nvoid RemoveAllTS(struct ieee80211_device *ieee);\nvoid ieee80211_softmac_scan_syncro(struct ieee80211_device *ieee);\n\nextern const long ieee80211_wlan_frequencies[];\n\nstatic inline void ieee80211_increment_scans(struct ieee80211_device *ieee)\n{\n\tieee->scans++;\n}\n\nstatic inline int ieee80211_get_scans(struct ieee80211_device *ieee)\n{\n\treturn ieee->scans;\n}\n\nstatic inline const char *escape_essid(const char *essid, u8 essid_len)\n{\n\tstatic char escaped[IW_ESSID_MAX_SIZE * 2 + 1];\n\n\tif (ieee80211_is_empty_essid(essid, essid_len)) {\n\t\tmemcpy(escaped, \"<hidden>\", sizeof(\"<hidden>\"));\n\t\treturn escaped;\n\t}\n\n\tsnprintf(escaped, sizeof(escaped), \"%*pE\", essid_len, essid);\n\treturn escaped;\n}\n\n \nshort check_nic_enough_desc(struct net_device *dev, int queue_index);\nint ieee80211_data_xmit(struct sk_buff *skb, struct net_device *dev);\nint ieee80211_parse_info_param(struct ieee80211_device *ieee,\n\t\t\t       struct ieee80211_info_element *info_element,\n\t\t\t       u16 length,\n\t\t\t       struct ieee80211_network *network,\n\t\t\t       struct ieee80211_rx_stats *stats);\n\nvoid ieee80211_indicate_packets(struct ieee80211_device *ieee,\n\t\t\t\tstruct ieee80211_rxb **prxbIndicateArray,\n\t\t\t\tu8 index);\n#define RT_ASOC_RETRY_LIMIT\t5\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}