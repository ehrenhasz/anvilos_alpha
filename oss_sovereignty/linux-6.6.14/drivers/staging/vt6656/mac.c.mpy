{
  "module_name": "mac.c",
  "hash_id": "0e92df8bfc365e12864e0aa48a3a377a1dc526c6aadf73a7df807fdd22b775be",
  "original_prompt": "Ingested from linux-6.6.14/drivers/staging/vt6656/mac.c",
  "human_readable_source": "\n \n\n#include <linux/etherdevice.h>\n\n#include \"desc.h\"\n#include \"mac.h\"\n#include \"usbpipe.h\"\n\nint vnt_mac_set_filter(struct vnt_private *priv, u64 mc_filter)\n{\n\t__le64 le_mc = cpu_to_le64(mc_filter);\n\n\treturn vnt_control_out(priv, MESSAGE_TYPE_WRITE, MAC_REG_MAR0,\n\t\t\t       MESSAGE_REQUEST_MACREG, sizeof(le_mc),\n\t\t\t       (u8 *)&le_mc);\n}\n\nint vnt_mac_shutdown(struct vnt_private *priv)\n{\n\treturn vnt_control_out(priv, MESSAGE_TYPE_MACSHUTDOWN, 0, 0, 0, NULL);\n}\n\nint vnt_mac_set_bb_type(struct vnt_private *priv, u8 type)\n{\n\tu8 data[2];\n\n\tdata[0] = type;\n\tdata[1] = EN_CFG_BB_TYPE_MASK;\n\n\treturn vnt_control_out(priv, MESSAGE_TYPE_WRITE_MASK, MAC_REG_ENCFG0,\n\t\t\t       MESSAGE_REQUEST_MACREG,\tARRAY_SIZE(data),\n\t\t\t       data);\n}\n\nint vnt_mac_disable_keyentry(struct vnt_private *priv, u8 entry_idx)\n{\n\treturn vnt_control_out(priv, MESSAGE_TYPE_CLRKEYENTRY, 0, 0,\n\t\t\t       sizeof(entry_idx), &entry_idx);\n}\n\nint vnt_mac_set_keyentry(struct vnt_private *priv, u16 key_ctl, u32 entry_idx,\n\t\t\t u32 key_idx, u8 *addr, u8 *key)\n{\n\tstruct vnt_mac_set_key set_key;\n\tu16 offset;\n\n\toffset = MISCFIFO_KEYETRY0;\n\toffset += entry_idx * MISCFIFO_KEYENTRYSIZE;\n\n\tset_key.u.write.key_ctl = cpu_to_le16(key_ctl);\n\tether_addr_copy(set_key.u.write.addr, addr);\n\n\t \n\tswap(set_key.u.swap[0], set_key.u.swap[1]);\n\n\tmemcpy(set_key.key, key, WLAN_KEY_LEN_CCMP);\n\n\tdev_dbg(&priv->usb->dev, \"offset %d key ctl %d set key %24ph\\n\",\n\t\toffset, key_ctl, (u8 *)&set_key);\n\n\treturn vnt_control_out(priv, MESSAGE_TYPE_SETKEY, offset,\n\t\t\t       (u16)key_idx, sizeof(struct vnt_mac_set_key),\n\t\t\t       (u8 *)&set_key);\n}\n\nint vnt_mac_reg_bits_off(struct vnt_private *priv, u8 reg_ofs, u8 bits)\n{\n\tu8 data[2];\n\n\tdata[0] = 0;\n\tdata[1] = bits;\n\n\treturn vnt_control_out(priv, MESSAGE_TYPE_WRITE_MASK, reg_ofs,\n\t\t\t       MESSAGE_REQUEST_MACREG, ARRAY_SIZE(data), data);\n}\n\nint vnt_mac_reg_bits_on(struct vnt_private *priv, u8 reg_ofs, u8 bits)\n{\n\tu8 data[2];\n\n\tdata[0] = bits;\n\tdata[1] = bits;\n\n\treturn vnt_control_out(priv, MESSAGE_TYPE_WRITE_MASK, reg_ofs,\n\t\t\t       MESSAGE_REQUEST_MACREG, ARRAY_SIZE(data), data);\n}\n\nint vnt_mac_write_word(struct vnt_private *priv, u8 reg_ofs, u16 word)\n{\n\tu8 data[2];\n\n\tdata[0] = (u8)(word & 0xff);\n\tdata[1] = (u8)(word >> 8);\n\n\treturn vnt_control_out(priv, MESSAGE_TYPE_WRITE, reg_ofs,\n\t\t\t       MESSAGE_REQUEST_MACREG, ARRAY_SIZE(data), data);\n}\n\nint vnt_mac_set_bssid_addr(struct vnt_private *priv, u8 *addr)\n{\n\treturn vnt_control_out(priv, MESSAGE_TYPE_WRITE, MAC_REG_BSSID0,\n\t\t\t       MESSAGE_REQUEST_MACREG, ETH_ALEN, addr);\n}\n\nint vnt_mac_enable_protect_mode(struct vnt_private *priv)\n{\n\tu8 data[2];\n\n\tdata[0] = EN_CFG_PROTECT_MD;\n\tdata[1] = EN_CFG_PROTECT_MD;\n\n\treturn vnt_control_out(priv, MESSAGE_TYPE_WRITE_MASK, MAC_REG_ENCFG0,\n\t\t\t       MESSAGE_REQUEST_MACREG, ARRAY_SIZE(data), data);\n}\n\nint vnt_mac_disable_protect_mode(struct vnt_private *priv)\n{\n\tu8 data[2];\n\n\tdata[0] = 0;\n\tdata[1] = EN_CFG_PROTECT_MD;\n\n\treturn vnt_control_out(priv, MESSAGE_TYPE_WRITE_MASK, MAC_REG_ENCFG0,\n\t\t\t       MESSAGE_REQUEST_MACREG, ARRAY_SIZE(data), data);\n}\n\nint vnt_mac_enable_barker_preamble_mode(struct vnt_private *priv)\n{\n\tu8 data[2];\n\n\tdata[0] = EN_CFG_BARKER_PREAM;\n\tdata[1] = EN_CFG_BARKER_PREAM;\n\n\treturn vnt_control_out(priv, MESSAGE_TYPE_WRITE_MASK, MAC_REG_ENCFG2,\n\t\t\t       MESSAGE_REQUEST_MACREG, ARRAY_SIZE(data), data);\n}\n\nint vnt_mac_disable_barker_preamble_mode(struct vnt_private *priv)\n{\n\tu8 data[2];\n\n\tdata[0] = 0;\n\tdata[1] = EN_CFG_BARKER_PREAM;\n\n\treturn vnt_control_out(priv, MESSAGE_TYPE_WRITE_MASK, MAC_REG_ENCFG2,\n\t\t\t       MESSAGE_REQUEST_MACREG, ARRAY_SIZE(data), data);\n}\n\nint vnt_mac_set_beacon_interval(struct vnt_private *priv, u16 interval)\n{\n\tu8 data[2];\n\n\tdata[0] = (u8)(interval & 0xff);\n\tdata[1] = (u8)(interval >> 8);\n\n\treturn vnt_control_out(priv, MESSAGE_TYPE_WRITE, MAC_REG_BI,\n\t\t\t       MESSAGE_REQUEST_MACREG, ARRAY_SIZE(data), data);\n}\n\nint vnt_mac_set_led(struct vnt_private *priv, u8 state, u8 led)\n{\n\tu8 data[2];\n\n\tdata[0] = led;\n\tdata[1] = state;\n\n\treturn vnt_control_out(priv, MESSAGE_TYPE_WRITE_MASK, MAC_REG_PAPEDELAY,\n\t\t\t       MESSAGE_REQUEST_MACREG, ARRAY_SIZE(data), data);\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}