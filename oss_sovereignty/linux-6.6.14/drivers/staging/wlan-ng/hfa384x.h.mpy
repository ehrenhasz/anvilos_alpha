{
  "module_name": "hfa384x.h",
  "hash_id": "9fcf9d7b9759d16edf6dc84ec1aeae27d5f2be1ffc2d03c18e311ae1b9201c0e",
  "original_prompt": "Ingested from linux-6.6.14/drivers/staging/wlan-ng/hfa384x.h",
  "human_readable_source": " \n \n\n#ifndef _HFA384x_H\n#define _HFA384x_H\n\n#define HFA384x_FIRMWARE_VERSION(a, b, c) (((a) << 16) + ((b) << 8) + (c))\n\n#include <linux/if_ether.h>\n#include <linux/usb.h>\n\n \n#define\tHFA384x_PORTID_MAX\t\t((u16)7)\n#define\tHFA384x_NUMPORTS_MAX\t\t((u16)(HFA384x_PORTID_MAX + 1))\n#define\tHFA384x_PDR_LEN_MAX\t\t((u16)512)  \n#define\tHFA384x_PDA_RECS_MAX\t\t((u16)200)  \n#define\tHFA384x_PDA_LEN_MAX\t\t((u16)1024)  \n#define\tHFA384x_SCANRESULT_MAX\t\t((u16)31)\n#define\tHFA384x_HSCANRESULT_MAX\t\t((u16)31)\n#define\tHFA384x_CHINFORESULT_MAX\t((u16)16)\n#define\tHFA384x_RID_GUESSING_MAXLEN\t2048\t \n#define\tHFA384x_RIDDATA_MAXLEN\t\tHFA384x_RID_GUESSING_MAXLEN\n#define\tHFA384x_USB_RWMEM_MAXLEN\t2048\n\n \n#define\t\tHFA384x_PORTTYPE_IBSS\t\t\t((u16)0)\n#define\t\tHFA384x_PORTTYPE_BSS\t\t\t((u16)1)\n#define\t\tHFA384x_PORTTYPE_PSUEDOIBSS\t\t((u16)3)\n#define\t\tHFA384x_WEPFLAGS_PRIVINVOKED\t\t((u16)BIT(0))\n#define\t\tHFA384x_WEPFLAGS_EXCLUDE\t\t((u16)BIT(1))\n#define\t\tHFA384x_WEPFLAGS_DISABLE_TXCRYPT\t((u16)BIT(4))\n#define\t\tHFA384x_WEPFLAGS_DISABLE_RXCRYPT\t((u16)BIT(7))\n#define\t\tHFA384x_ROAMMODE_HOSTSCAN_HOSTROAM\t((u16)3)\n#define\t\tHFA384x_PORTSTATUS_DISABLED\t\t((u16)1)\n#define\t\tHFA384x_RATEBIT_1\t\t\t((u16)1)\n#define\t\tHFA384x_RATEBIT_2\t\t\t((u16)2)\n#define\t\tHFA384x_RATEBIT_5dot5\t\t\t((u16)4)\n#define\t\tHFA384x_RATEBIT_11\t\t\t((u16)8)\n\n \n \n \n\n \n#define\t\tHFA384x_ADDR_FLAT_AUX_PAGE_MASK\t(0x007fff80)\n#define\t\tHFA384x_ADDR_FLAT_AUX_OFF_MASK\t(0x0000007f)\n#define\t\tHFA384x_ADDR_FLAT_CMD_PAGE_MASK\t(0xffff0000)\n#define\t\tHFA384x_ADDR_FLAT_CMD_OFF_MASK\t(0x0000ffff)\n\n \n#define\t\tHFA384x_ADDR_AUX_PAGE_MASK\t(0xffff)\n#define\t\tHFA384x_ADDR_AUX_OFF_MASK\t(0x007f)\n\n \n#define\t\tHFA384x_ADDR_AUX_MKFLAT(p, o)\t\\\n\t\t((((u32)(((u16)(p)) & HFA384x_ADDR_AUX_PAGE_MASK)) << 7) | \\\n\t\t((u32)(((u16)(o)) & HFA384x_ADDR_AUX_OFF_MASK)))\n\n \n#define\t\tHFA384x_ADDR_CMD_MKPAGE(f) \\\n\t\t((u16)((((u32)(f)) & HFA384x_ADDR_FLAT_CMD_PAGE_MASK) >> 16))\n#define\t\tHFA384x_ADDR_CMD_MKOFF(f) \\\n\t\t((u16)(((u32)(f)) & HFA384x_ADDR_FLAT_CMD_OFF_MASK))\n\n \n#define\t\tHFA3842_PDA_BASE\t(0x007f0000UL)\n#define\t\tHFA3841_PDA_BASE\t(0x003f0000UL)\n#define\t\tHFA3841_PDA_BOGUS_BASE\t(0x00390000UL)\n\n \n#define\t\tHFA384x_DLSTATE_DISABLED\t\t0\n#define\t\tHFA384x_DLSTATE_RAMENABLED\t\t1\n#define\t\tHFA384x_DLSTATE_FLASHENABLED\t\t2\n\n \n#define\t\tHFA384x_CMD_AINFO\t\t((u16)GENMASK(14, 8))\n#define\t\tHFA384x_CMD_MACPORT\t\t((u16)GENMASK(10, 8))\n#define\t\tHFA384x_CMD_PROGMODE\t\t((u16)GENMASK(9, 8))\n#define\t\tHFA384x_CMD_CMDCODE\t\t((u16)GENMASK(5, 0))\n#define\t\tHFA384x_STATUS_RESULT\t\t((u16)GENMASK(14, 8))\n\n \n \n#define\t\tHFA384x_CMDCODE_INIT\t\t((u16)0x00)\n#define\t\tHFA384x_CMDCODE_ENABLE\t\t((u16)0x01)\n#define\t\tHFA384x_CMDCODE_DISABLE\t\t((u16)0x02)\n\n \n#define\t\tHFA384x_CMDCODE_INQ\t\t((u16)0x11)\n\n \n#define\t\tHFA384x_CMDCODE_DOWNLD\t\t((u16)0x22)\n\n \n#define\t\tHFA384x_CMDCODE_MONITOR\t\t((u16)(0x38))\n#define\t\tHFA384x_MONITOR_ENABLE\t\t((u16)(0x0b))\n#define\t\tHFA384x_MONITOR_DISABLE\t\t((u16)(0x0f))\n\n \n#define\t\tHFA384x_CMD_ERR\t\t\t((u16)(0x7F))\n\n \n#define\t\tHFA384x_PROGMODE_DISABLE\t((u16)0x00)\n#define\t\tHFA384x_PROGMODE_RAM\t\t((u16)0x01)\n#define\t\tHFA384x_PROGMODE_NV\t\t((u16)0x02)\n#define\t\tHFA384x_PROGMODE_NVWRITE\t((u16)0x03)\n\n \n \n#define\t\tHFA384x_RID_CNFPORTTYPE\t\t((u16)0xFC00)\n#define\t\tHFA384x_RID_CNFOWNMACADDR\t((u16)0xFC01)\n#define\t\tHFA384x_RID_CNFDESIREDSSID\t((u16)0xFC02)\n#define\t\tHFA384x_RID_CNFOWNCHANNEL\t((u16)0xFC03)\n#define\t\tHFA384x_RID_CNFOWNSSID\t\t((u16)0xFC04)\n#define\t\tHFA384x_RID_CNFMAXDATALEN\t((u16)0xFC07)\n\n \n#define\t\tHFA384x_RID_CNFOWNMACADDR_LEN\t((u16)6)\n#define\t\tHFA384x_RID_CNFDESIREDSSID_LEN\t((u16)34)\n#define\t\tHFA384x_RID_CNFOWNSSID_LEN\t((u16)34)\n\n \n#define\t\tHFA384x_RID_CREATEIBSS\t\t((u16)0xFC81)\n#define\t\tHFA384x_RID_FRAGTHRESH\t\t((u16)0xFC82)\n#define\t\tHFA384x_RID_RTSTHRESH\t\t((u16)0xFC83)\n#define\t\tHFA384x_RID_TXRATECNTL\t\t((u16)0xFC84)\n#define\t\tHFA384x_RID_PROMISCMODE\t\t((u16)0xFC85)\n\n \n#define\t\tHFA384x_RID_MAXLOADTIME\t\t((u16)0xFD00)\n#define\t\tHFA384x_RID_DOWNLOADBUFFER\t((u16)0xFD01)\n#define\t\tHFA384x_RID_PRIIDENTITY\t\t((u16)0xFD02)\n#define\t\tHFA384x_RID_PRISUPRANGE\t\t((u16)0xFD03)\n#define\t\tHFA384x_RID_PRI_CFIACTRANGES\t((u16)0xFD04)\n#define\t\tHFA384x_RID_NICSERIALNUMBER\t((u16)0xFD0A)\n#define\t\tHFA384x_RID_NICIDENTITY\t\t((u16)0xFD0B)\n#define\t\tHFA384x_RID_MFISUPRANGE\t\t((u16)0xFD0C)\n#define\t\tHFA384x_RID_CFISUPRANGE\t\t((u16)0xFD0D)\n#define\t\tHFA384x_RID_STAIDENTITY\t\t((u16)0xFD20)\n#define\t\tHFA384x_RID_STASUPRANGE\t\t((u16)0xFD21)\n#define\t\tHFA384x_RID_STA_MFIACTRANGES\t((u16)0xFD22)\n#define\t\tHFA384x_RID_STA_CFIACTRANGES\t((u16)0xFD23)\n\n \n#define\t\tHFA384x_RID_NICSERIALNUMBER_LEN\t\t((u16)12)\n\n \n#define\t\tHFA384x_RID_PORTSTATUS\t\t((u16)0xFD40)\n#define\t\tHFA384x_RID_CURRENTSSID\t\t((u16)0xFD41)\n#define\t\tHFA384x_RID_CURRENTBSSID\t((u16)0xFD42)\n#define\t\tHFA384x_RID_CURRENTTXRATE\t((u16)0xFD44)\n#define\t\tHFA384x_RID_SHORTRETRYLIMIT\t((u16)0xFD48)\n#define\t\tHFA384x_RID_LONGRETRYLIMIT\t((u16)0xFD49)\n#define\t\tHFA384x_RID_MAXTXLIFETIME\t((u16)0xFD4A)\n#define\t\tHFA384x_RID_PRIVACYOPTIMP\t((u16)0xFD4F)\n#define\t\tHFA384x_RID_DBMCOMMSQUALITY\t((u16)0xFD51)\n\n \n#define\t\tHFA384x_RID_DBMCOMMSQUALITY_LEN\t \\\n\t((u16)sizeof(struct hfa384x_dbmcommsquality))\n#define\t\tHFA384x_RID_JOINREQUEST_LEN \\\n\t((u16)sizeof(struct hfa384x_join_request_data))\n\n \n#define\t\tHFA384x_RID_CURRENTCHANNEL\t((u16)0xFDC1)\n\n \n#define\t\tHFA384x_RID_CNFWEPDEFAULTKEYID\t((u16)0xFC23)\n#define\t\tHFA384x_RID_CNFWEPDEFAULTKEY0\t((u16)0xFC24)\n#define\t\tHFA384x_RID_CNFWEPDEFAULTKEY1\t((u16)0xFC25)\n#define\t\tHFA384x_RID_CNFWEPDEFAULTKEY2\t((u16)0xFC26)\n#define\t\tHFA384x_RID_CNFWEPDEFAULTKEY3\t((u16)0xFC27)\n#define\t\tHFA384x_RID_CNFWEPFLAGS\t\t((u16)0xFC28)\n#define\t\tHFA384x_RID_CNFAUTHENTICATION\t((u16)0xFC2A)\n#define\t\tHFA384x_RID_CNFROAMINGMODE\t((u16)0xFC2D)\n#define\t\tHFA384x_RID_CNFAPBCNINT\t\t((u16)0xFC33)\n#define\t\tHFA384x_RID_CNFDBMADJUST\t((u16)0xFC46)\n#define\t\tHFA384x_RID_CNFWPADATA\t\t((u16)0xFC48)\n#define\t\tHFA384x_RID_CNFBASICRATES\t((u16)0xFCB3)\n#define\t\tHFA384x_RID_CNFSUPPRATES\t((u16)0xFCB4)\n#define\t\tHFA384x_RID_CNFPASSIVESCANCTRL\t((u16)0xFCBA)\n#define\t\tHFA384x_RID_TXPOWERMAX\t\t((u16)0xFCBE)\n#define\t\tHFA384x_RID_JOINREQUEST\t\t((u16)0xFCE2)\n#define\t\tHFA384x_RID_AUTHENTICATESTA\t((u16)0xFCE3)\n#define\t\tHFA384x_RID_HOSTSCAN\t\t((u16)0xFCE5)\n\n#define\t\tHFA384x_RID_CNFWEPDEFAULTKEY_LEN\t((u16)6)\n#define\t\tHFA384x_RID_CNFWEP128DEFAULTKEY_LEN\t((u16)14)\n\n \n#define HFA384x_PDR_PCB_PARTNUM\t\t((u16)0x0001)\n#define HFA384x_PDR_PDAVER\t\t((u16)0x0002)\n#define HFA384x_PDR_NIC_SERIAL\t\t((u16)0x0003)\n#define HFA384x_PDR_MKK_MEASUREMENTS\t((u16)0x0004)\n#define HFA384x_PDR_NIC_RAMSIZE\t\t((u16)0x0005)\n#define HFA384x_PDR_MFISUPRANGE\t\t((u16)0x0006)\n#define HFA384x_PDR_CFISUPRANGE\t\t((u16)0x0007)\n#define HFA384x_PDR_NICID\t\t((u16)0x0008)\n#define HFA384x_PDR_MAC_ADDRESS\t\t((u16)0x0101)\n#define HFA384x_PDR_REGDOMAIN\t\t((u16)0x0103)\n#define HFA384x_PDR_ALLOWED_CHANNEL\t((u16)0x0104)\n#define HFA384x_PDR_DEFAULT_CHANNEL\t((u16)0x0105)\n#define HFA384x_PDR_TEMPTYPE\t\t((u16)0x0107)\n#define HFA384x_PDR_IFR_SETTING\t\t((u16)0x0200)\n#define HFA384x_PDR_RFR_SETTING\t\t((u16)0x0201)\n#define HFA384x_PDR_HFA3861_BASELINE\t((u16)0x0202)\n#define HFA384x_PDR_HFA3861_SHADOW\t((u16)0x0203)\n#define HFA384x_PDR_HFA3861_IFRF\t((u16)0x0204)\n#define HFA384x_PDR_HFA3861_CHCALSP\t((u16)0x0300)\n#define HFA384x_PDR_HFA3861_CHCALI\t((u16)0x0301)\n#define HFA384x_PDR_MAX_TX_POWER\t((u16)0x0302)\n#define HFA384x_PDR_MASTER_CHAN_LIST\t((u16)0x0303)\n#define HFA384x_PDR_3842_NIC_CONFIG\t((u16)0x0400)\n#define HFA384x_PDR_USB_ID\t\t((u16)0x0401)\n#define HFA384x_PDR_PCI_ID\t\t((u16)0x0402)\n#define HFA384x_PDR_PCI_IFCONF\t\t((u16)0x0403)\n#define HFA384x_PDR_PCI_PMCONF\t\t((u16)0x0404)\n#define HFA384x_PDR_RFENRGY\t\t((u16)0x0406)\n#define HFA384x_PDR_USB_POWER_TYPE      ((u16)0x0407)\n#define HFA384x_PDR_USB_MAX_POWER\t((u16)0x0409)\n#define HFA384x_PDR_USB_MANUFACTURER\t((u16)0x0410)\n#define HFA384x_PDR_USB_PRODUCT\t\t((u16)0x0411)\n#define HFA384x_PDR_ANT_DIVERSITY\t((u16)0x0412)\n#define HFA384x_PDR_HFO_DELAY\t\t((u16)0x0413)\n#define HFA384x_PDR_SCALE_THRESH\t((u16)0x0414)\n\n#define HFA384x_PDR_HFA3861_MANF_TESTSP\t((u16)0x0900)\n#define HFA384x_PDR_HFA3861_MANF_TESTI\t((u16)0x0901)\n#define HFA384x_PDR_END_OF_PDA\t\t((u16)0x0000)\n\n \n\n#define\t\tHFA384x_CMD_AINFO_SET(value)\t((u16)((u16)(value) << 8))\n#define\t\tHFA384x_CMD_MACPORT_SET(value)\t\\\n\t\t\t((u16)HFA384x_CMD_AINFO_SET(value))\n#define\t\tHFA384x_CMD_PROGMODE_SET(value)\t\\\n\t\t\t((u16)HFA384x_CMD_AINFO_SET((u16)value))\n#define\t\tHFA384x_CMD_CMDCODE_SET(value)\t\t((u16)(value))\n\n#define\t\tHFA384x_STATUS_RESULT_SET(value)\t(((u16)(value)) << 8)\n\n \n#define HFA384x_STATE_PREINIT\t0\n#define HFA384x_STATE_INIT\t1\n#define HFA384x_STATE_RUNNING\t2\n\n \n \nstruct hfa384x_bytestr {\n\t__le16 len;\n\tu8 data[];\n} __packed;\n\nstruct hfa384x_bytestr32 {\n\t__le16 len;\n\tu8 data[32];\n} __packed;\n\n \n\n \nstruct hfa384x_compident {\n\tu16 id;\n\tu16 variant;\n\tu16 major;\n\tu16 minor;\n} __packed;\n\nstruct hfa384x_caplevel {\n\tu16 role;\n\tu16 id;\n\tu16 variant;\n\tu16 bottom;\n\tu16 top;\n} __packed;\n\n \n#define HFA384x_CNFAUTHENTICATION_OPENSYSTEM\t0x0001\n#define HFA384x_CNFAUTHENTICATION_SHAREDKEY\t0x0002\n#define HFA384x_CNFAUTHENTICATION_LEAP\t\t0x0004\n\n \n\n#define HFA384x_CREATEIBSS_JOINCREATEIBSS          0\n\n \nstruct hfa384x_host_scan_request_data {\n\t__le16 channel_list;\n\t__le16 tx_rate;\n\tstruct hfa384x_bytestr32 ssid;\n} __packed;\n\n \nstruct hfa384x_join_request_data {\n\tu8 bssid[WLAN_BSSID_LEN];\n\tu16 channel;\n} __packed;\n\n \nstruct hfa384x_authenticate_station_data {\n\tu8 address[ETH_ALEN];\n\t__le16 status;\n\t__le16 algorithm;\n} __packed;\n\n \nstruct hfa384x_wpa_data {\n\t__le16 datalen;\n\tu8 data[];\t\t \n} __packed;\n\n \n\n \n \nstruct hfa384x_downloadbuffer {\n\tu16 page;\n\tu16 offset;\n\tu16 len;\n} __packed;\n\n \n\n#define HFA384x_PSTATUS_CONN_IBSS\t((u16)3)\n\n \nstruct hfa384x_commsquality {\n\t__le16 cq_curr_bss;\n\t__le16 asl_curr_bss;\n\t__le16 anl_curr_fc;\n} __packed;\n\n \nstruct hfa384x_dbmcommsquality {\n\tu16 cq_dbm_curr_bss;\n\tu16 asl_dbm_curr_bss;\n\tu16 anl_dbm_curr_fc;\n} __packed;\n\n \n \nstruct hfa384x_tx_frame {\n\tu16 status;\n\tu16 reserved1;\n\tu16 reserved2;\n\tu32 sw_support;\n\tu8 tx_retrycount;\n\tu8 tx_rate;\n\tu16 tx_control;\n\n\t \n\tstruct p80211_hdr hdr;\n\t__le16 data_len;\t\t \n\n\t \n\n\tu8 dest_addr[6];\n\tu8 src_addr[6];\n\tu16 data_length;\t \n} __packed;\n \n \n#define\t\tHFA384x_TXSTATUS_ACKERR\t\t\t((u16)BIT(5))\n#define\t\tHFA384x_TXSTATUS_FORMERR\t\t((u16)BIT(3))\n#define\t\tHFA384x_TXSTATUS_DISCON\t\t\t((u16)BIT(2))\n#define\t\tHFA384x_TXSTATUS_AGEDERR\t\t((u16)BIT(1))\n#define\t\tHFA384x_TXSTATUS_RETRYERR\t\t((u16)BIT(0))\n \n#define\t\tHFA384x_TX_MACPORT\t\t\t((u16)GENMASK(10, 8))\n#define\t\tHFA384x_TX_STRUCTYPE\t\t\t((u16)GENMASK(4, 3))\n#define\t\tHFA384x_TX_TXEX\t\t\t\t((u16)BIT(2))\n#define\t\tHFA384x_TX_TXOK\t\t\t\t((u16)BIT(1))\n \n \n#define HFA384x_TXSTATUS_ISERROR(v)\t\\\n\t(((u16)(v)) & \\\n\t(HFA384x_TXSTATUS_ACKERR | HFA384x_TXSTATUS_FORMERR | \\\n\tHFA384x_TXSTATUS_DISCON | HFA384x_TXSTATUS_AGEDERR | \\\n\tHFA384x_TXSTATUS_RETRYERR))\n\n#define\tHFA384x_TX_SET(v, m, s)\t\t((((u16)(v)) << ((u16)(s))) & ((u16)(m)))\n\n#define\tHFA384x_TX_MACPORT_SET(v)\tHFA384x_TX_SET(v, HFA384x_TX_MACPORT, 8)\n#define\tHFA384x_TX_STRUCTYPE_SET(v)\tHFA384x_TX_SET(v, \\\n\t\t\t\t\t\tHFA384x_TX_STRUCTYPE, 3)\n#define\tHFA384x_TX_TXEX_SET(v)\t\tHFA384x_TX_SET(v, HFA384x_TX_TXEX, 2)\n#define\tHFA384x_TX_TXOK_SET(v)\t\tHFA384x_TX_SET(v, HFA384x_TX_TXOK, 1)\n \n \nstruct hfa384x_rx_frame {\n\t \n\tu16 status;\n\tu32 time;\n\tu8 silence;\n\tu8 signal;\n\tu8 rate;\n\tu8 rx_flow;\n\tu16 reserved1;\n\tu16 reserved2;\n\n\t \n\tstruct p80211_hdr hdr;\n\t__le16 data_len;\t\t \n\n\t \n\tu8 dest_addr[6];\n\tu8 src_addr[6];\n\tu16 data_length;\t \n} __packed;\n \n\n \n#define\t\tHFA384x_RXSTATUS_MACPORT\t\t((u16)GENMASK(10, 8))\n#define\t\tHFA384x_RXSTATUS_FCSERR\t\t\t((u16)BIT(0))\n \n#define\t\tHFA384x_RXSTATUS_MACPORT_GET(value)\t((u16)((((u16)(value)) \\\n\t\t\t\t\t    & HFA384x_RXSTATUS_MACPORT) >> 8))\n#define\t\tHFA384x_RXSTATUS_ISFCSERR(value)\t((u16)(((u16)(value)) \\\n\t\t\t\t\t\t  & HFA384x_RXSTATUS_FCSERR))\n \n#define\t\tHFA384x_IT_HANDOVERADDR\t\t\t((u16)0xF000UL)\n#define\t\tHFA384x_IT_COMMTALLIES\t\t\t((u16)0xF100UL)\n#define\t\tHFA384x_IT_SCANRESULTS\t\t\t((u16)0xF101UL)\n#define\t\tHFA384x_IT_CHINFORESULTS\t\t((u16)0xF102UL)\n#define\t\tHFA384x_IT_HOSTSCANRESULTS\t\t((u16)0xF103UL)\n#define\t\tHFA384x_IT_LINKSTATUS\t\t\t((u16)0xF200UL)\n#define\t\tHFA384x_IT_ASSOCSTATUS\t\t\t((u16)0xF201UL)\n#define\t\tHFA384x_IT_AUTHREQ\t\t\t((u16)0xF202UL)\n#define\t\tHFA384x_IT_PSUSERCNT\t\t\t((u16)0xF203UL)\n#define\t\tHFA384x_IT_KEYIDCHANGED\t\t\t((u16)0xF204UL)\n#define\t\tHFA384x_IT_ASSOCREQ\t\t\t((u16)0xF205UL)\n#define\t\tHFA384x_IT_MICFAILURE\t\t\t((u16)0xF206UL)\n\n \n\n \nstruct hfa384x_comm_tallies_16 {\n\t__le16 txunicastframes;\n\t__le16 txmulticastframes;\n\t__le16 txfragments;\n\t__le16 txunicastoctets;\n\t__le16 txmulticastoctets;\n\t__le16 txdeferredtrans;\n\t__le16 txsingleretryframes;\n\t__le16 txmultipleretryframes;\n\t__le16 txretrylimitexceeded;\n\t__le16 txdiscards;\n\t__le16 rxunicastframes;\n\t__le16 rxmulticastframes;\n\t__le16 rxfragments;\n\t__le16 rxunicastoctets;\n\t__le16 rxmulticastoctets;\n\t__le16 rxfcserrors;\n\t__le16 rxdiscardsnobuffer;\n\t__le16 txdiscardswrongsa;\n\t__le16 rxdiscardswepundecr;\n\t__le16 rxmsginmsgfrag;\n\t__le16 rxmsginbadmsgfrag;\n} __packed;\n\nstruct hfa384x_comm_tallies_32 {\n\t__le32 txunicastframes;\n\t__le32 txmulticastframes;\n\t__le32 txfragments;\n\t__le32 txunicastoctets;\n\t__le32 txmulticastoctets;\n\t__le32 txdeferredtrans;\n\t__le32 txsingleretryframes;\n\t__le32 txmultipleretryframes;\n\t__le32 txretrylimitexceeded;\n\t__le32 txdiscards;\n\t__le32 rxunicastframes;\n\t__le32 rxmulticastframes;\n\t__le32 rxfragments;\n\t__le32 rxunicastoctets;\n\t__le32 rxmulticastoctets;\n\t__le32 rxfcserrors;\n\t__le32 rxdiscardsnobuffer;\n\t__le32 txdiscardswrongsa;\n\t__le32 rxdiscardswepundecr;\n\t__le32 rxmsginmsgfrag;\n\t__le32 rxmsginbadmsgfrag;\n} __packed;\n\n \nstruct hfa384x_scan_result_sub {\n\tu16 chid;\n\tu16 anl;\n\tu16 sl;\n\tu8 bssid[WLAN_BSSID_LEN];\n\tu16 bcnint;\n\tu16 capinfo;\n\tstruct hfa384x_bytestr32 ssid;\n\tu8 supprates[10];\t \n\tu16 proberesp_rate;\n} __packed;\n\nstruct hfa384x_scan_result {\n\tu16 rsvd;\n\tu16 scanreason;\n\tstruct hfa384x_scan_result_sub result[HFA384x_SCANRESULT_MAX];\n} __packed;\n\n \nstruct hfa384x_ch_info_result_sub {\n\tu16 chid;\n\tu16 anl;\n\tu16 pnl;\n\tu16 active;\n} __packed;\n\n#define HFA384x_CHINFORESULT_BSSACTIVE\tBIT(0)\n#define HFA384x_CHINFORESULT_PCFACTIVE\tBIT(1)\n\nstruct hfa384x_ch_info_result {\n\tu16 scanchannels;\n\tstruct hfa384x_ch_info_result_sub result[HFA384x_CHINFORESULT_MAX];\n} __packed;\n\n \nstruct hfa384x_hscan_result_sub {\n\t__le16 chid;\n\t__le16 anl;\n\t__le16 sl;\n\tu8 bssid[WLAN_BSSID_LEN];\n\t__le16 bcnint;\n\t__le16 capinfo;\n\tstruct hfa384x_bytestr32 ssid;\n\tu8 supprates[10];\t \n\tu16 proberesp_rate;\n\t__le16 atim;\n} __packed;\n\nstruct hfa384x_hscan_result {\n\tu16 nresult;\n\tu16 rsvd;\n\tstruct hfa384x_hscan_result_sub result[HFA384x_HSCANRESULT_MAX];\n} __packed;\n\n \n\n#define HFA384x_LINK_NOTCONNECTED\t((u16)0)\n#define HFA384x_LINK_CONNECTED\t\t((u16)1)\n#define HFA384x_LINK_DISCONNECTED\t((u16)2)\n#define HFA384x_LINK_AP_CHANGE\t\t((u16)3)\n#define HFA384x_LINK_AP_OUTOFRANGE\t((u16)4)\n#define HFA384x_LINK_AP_INRANGE\t\t((u16)5)\n#define HFA384x_LINK_ASSOCFAIL\t\t((u16)6)\n\nstruct hfa384x_link_status {\n\t__le16 linkstatus;\n} __packed;\n\n \n\n#define HFA384x_ASSOCSTATUS_STAASSOC\t((u16)1)\n#define HFA384x_ASSOCSTATUS_REASSOC\t((u16)2)\n#define HFA384x_ASSOCSTATUS_AUTHFAIL\t((u16)5)\n\nstruct hfa384x_assoc_status {\n\tu16 assocstatus;\n\tu8 sta_addr[ETH_ALEN];\n\t \n\tu8 old_ap_addr[ETH_ALEN];\n\tu16 reason;\n\tu16 reserved;\n} __packed;\n\n \n\nstruct hfa384x_auth_request {\n\tu8 sta_addr[ETH_ALEN];\n\t__le16 algorithm;\n} __packed;\n\n \n\nstruct hfa384x_ps_user_count {\n\t__le16 usercnt;\n} __packed;\n\nstruct hfa384x_key_id_changed {\n\tu8 sta_addr[ETH_ALEN];\n\tu16 keyid;\n} __packed;\n\n \nunion hfa384x_infodata {\n\tstruct hfa384x_comm_tallies_16 commtallies16;\n\tstruct hfa384x_comm_tallies_32 commtallies32;\n\tstruct hfa384x_scan_result scanresult;\n\tstruct hfa384x_ch_info_result chinforesult;\n\tstruct hfa384x_hscan_result hscanresult;\n\tstruct hfa384x_link_status linkstatus;\n\tstruct hfa384x_assoc_status assocstatus;\n\tstruct hfa384x_auth_request authreq;\n\tstruct hfa384x_ps_user_count psusercnt;\n\tstruct hfa384x_key_id_changed keyidchanged;\n} __packed;\n\nstruct hfa384x_inf_frame {\n\tu16 framelen;\n\tu16 infotype;\n\tunion hfa384x_infodata info;\n} __packed;\n\n \n\n \n#define HFA384x_USB_TXFRM\t0\n#define HFA384x_USB_CMDREQ\t1\n#define HFA384x_USB_WRIDREQ\t2\n#define HFA384x_USB_RRIDREQ\t3\n#define HFA384x_USB_WMEMREQ\t4\n#define HFA384x_USB_RMEMREQ\t5\n\n \n#define HFA384x_USB_ISTXFRM(a)\t(((a) & 0x9000) == 0x1000)\n#define HFA384x_USB_ISRXFRM(a)\t(!((a) & 0x9000))\n#define HFA384x_USB_INFOFRM\t0x8000\n#define HFA384x_USB_CMDRESP\t0x8001\n#define HFA384x_USB_WRIDRESP\t0x8002\n#define HFA384x_USB_RRIDRESP\t0x8003\n#define HFA384x_USB_WMEMRESP\t0x8004\n#define HFA384x_USB_RMEMRESP\t0x8005\n#define HFA384x_USB_BUFAVAIL\t0x8006\n#define HFA384x_USB_ERROR\t0x8007\n\n \n \n\nstruct hfa384x_usb_txfrm {\n\tstruct hfa384x_tx_frame desc;\n\tu8 data[WLAN_DATA_MAXLEN];\n} __packed;\n\nstruct hfa384x_usb_cmdreq {\n\t__le16 type;\n\t__le16 cmd;\n\t__le16 parm0;\n\t__le16 parm1;\n\t__le16 parm2;\n\tu8 pad[54];\n} __packed;\n\nstruct hfa384x_usb_wridreq {\n\t__le16 type;\n\t__le16 frmlen;\n\t__le16 rid;\n\tu8 data[HFA384x_RIDDATA_MAXLEN];\n} __packed;\n\nstruct hfa384x_usb_rridreq {\n\t__le16 type;\n\t__le16 frmlen;\n\t__le16 rid;\n\tu8 pad[58];\n} __packed;\n\nstruct hfa384x_usb_wmemreq {\n\t__le16 type;\n\t__le16 frmlen;\n\t__le16 offset;\n\t__le16 page;\n\tu8 data[HFA384x_USB_RWMEM_MAXLEN];\n} __packed;\n\nstruct hfa384x_usb_rmemreq {\n\t__le16 type;\n\t__le16 frmlen;\n\t__le16 offset;\n\t__le16 page;\n\tu8 pad[56];\n} __packed;\n\n \n \n\nstruct hfa384x_usb_rxfrm {\n\tstruct hfa384x_rx_frame desc;\n\tu8 data[WLAN_DATA_MAXLEN];\n} __packed;\n\nstruct hfa384x_usb_infofrm {\n\tu16 type;\n\tstruct hfa384x_inf_frame info;\n} __packed;\n\nstruct hfa384x_usb_statusresp {\n\tu16 type;\n\t__le16 status;\n\t__le16 resp0;\n\t__le16 resp1;\n\t__le16 resp2;\n} __packed;\n\nstruct hfa384x_usb_rridresp {\n\tu16 type;\n\t__le16 frmlen;\n\t__le16 rid;\n\tu8 data[HFA384x_RIDDATA_MAXLEN];\n} __packed;\n\nstruct hfa384x_usb_rmemresp {\n\tu16 type;\n\tu16 frmlen;\n\tu8 data[HFA384x_USB_RWMEM_MAXLEN];\n} __packed;\n\nstruct hfa384x_usb_bufavail {\n\tu16 type;\n\tu16 frmlen;\n} __packed;\n\nstruct hfa384x_usb_error {\n\tu16 type;\n\tu16 errortype;\n} __packed;\n\n \n \n\nunion hfa384x_usbout {\n\t__le16 type;\n\tstruct hfa384x_usb_txfrm txfrm;\n\tstruct hfa384x_usb_cmdreq cmdreq;\n\tstruct hfa384x_usb_wridreq wridreq;\n\tstruct hfa384x_usb_rridreq rridreq;\n\tstruct hfa384x_usb_wmemreq wmemreq;\n\tstruct hfa384x_usb_rmemreq rmemreq;\n} __packed;\n\nunion hfa384x_usbin {\n\t__le16 type;\n\tstruct hfa384x_usb_rxfrm rxfrm;\n\tstruct hfa384x_usb_txfrm txfrm;\n\tstruct hfa384x_usb_infofrm infofrm;\n\tstruct hfa384x_usb_statusresp cmdresp;\n\tstruct hfa384x_usb_statusresp wridresp;\n\tstruct hfa384x_usb_rridresp rridresp;\n\tstruct hfa384x_usb_statusresp wmemresp;\n\tstruct hfa384x_usb_rmemresp rmemresp;\n\tstruct hfa384x_usb_bufavail bufavail;\n\tstruct hfa384x_usb_error usberror;\n\tu8 boguspad[3000];\n} __packed;\n\n \n\nstruct hfa384x_pdr_mfisuprange {\n\tu16 id;\n\tu16 variant;\n\tu16 bottom;\n\tu16 top;\n} __packed;\n\nstruct hfa384x_pdr_cfisuprange {\n\tu16 id;\n\tu16 variant;\n\tu16 bottom;\n\tu16 top;\n} __packed;\n\nstruct hfa384x_pdr_nicid {\n\tu16 id;\n\tu16 variant;\n\tu16 major;\n\tu16 minor;\n} __packed;\n\nstruct hfa384x_pdrec {\n\t__le16 len;\t\t \n\t__le16 code;\n\tunion pdr {\n\t\tstruct hfa384x_pdr_mfisuprange mfisuprange;\n\t\tstruct hfa384x_pdr_cfisuprange cfisuprange;\n\t\tstruct hfa384x_pdr_nicid nicid;\n\n\t} data;\n} __packed;\n\n#ifdef __KERNEL__\n \nstruct hfa384x_cmdresult {\n\tu16 status;\n\tu16 resp0;\n\tu16 resp1;\n\tu16 resp2;\n};\n\n \n \nstruct hfa384x_rridresult {\n\tu16 rid;\n\tconst void *riddata;\n\tunsigned int riddata_len;\n};\n\nenum ctlx_state {\n\tCTLX_START = 0,\t\t \n\n\tCTLX_COMPLETE,\t\t \n\tCTLX_REQ_FAILED,\t \n\n\tCTLX_PENDING,\t\t \n\tCTLX_REQ_SUBMITTED,\t \n\tCTLX_REQ_COMPLETE,\t \n\tCTLX_RESP_COMPLETE\t \n};\n\nstruct hfa384x_usbctlx;\nstruct hfa384x;\n\ntypedef void (*ctlx_cmdcb_t) (struct hfa384x *, const struct hfa384x_usbctlx *);\n\ntypedef void (*ctlx_usercb_t) (struct hfa384x *hw,\n\t\t\t       void *ctlxresult, void *usercb_data);\n\nstruct hfa384x_usbctlx {\n\tstruct list_head list;\n\n\tsize_t outbufsize;\n\tunion hfa384x_usbout outbuf;\t \n\tunion hfa384x_usbin inbuf;\t \n\n\tenum ctlx_state state;\t \n\n\tstruct completion done;\n\tint reapable;\t\t \n\n\tctlx_cmdcb_t cmdcb;\t \n\tctlx_usercb_t usercb;\t \n\tvoid *usercb_data;\t \n};\n\nstruct hfa384x_usbctlxq {\n\tspinlock_t lock;\n\tstruct list_head pending;\n\tstruct list_head active;\n\tstruct list_head completing;\n\tstruct list_head reapable;\n};\n\nstruct hfa384x_metacmd {\n\tu16 cmd;\n\n\tu16 parm0;\n\tu16 parm1;\n\tu16 parm2;\n\n\tstruct hfa384x_cmdresult result;\n};\n\n#define\tMAX_GRP_ADDR\t\t32\n#define WLAN_COMMENT_MAX\t80   \n\n#define WLAN_AUTH_MAX           60   \n#define WLAN_ACCESS_MAX\t\t60   \n#define WLAN_ACCESS_NONE\t0    \n#define WLAN_ACCESS_ALL\t\t1    \n#define WLAN_ACCESS_ALLOW\t2    \n#define WLAN_ACCESS_DENY\t3    \n\n \nstruct prism2sta_authlist {\n\tunsigned int cnt;\n\tu8 addr[WLAN_AUTH_MAX][ETH_ALEN];\n\tu8 assoc[WLAN_AUTH_MAX];\n};\n\nstruct prism2sta_accesslist {\n\tunsigned int modify;\n\tunsigned int cnt;\n\tu8 addr[WLAN_ACCESS_MAX][ETH_ALEN];\n\tunsigned int cnt1;\n\tu8 addr1[WLAN_ACCESS_MAX][ETH_ALEN];\n};\n\nstruct hfa384x {\n\t \n\tstruct usb_device *usb;\n\tstruct urb rx_urb;\n\tstruct sk_buff *rx_urb_skb;\n\tstruct urb tx_urb;\n\tstruct urb ctlx_urb;\n\tunion hfa384x_usbout txbuff;\n\tstruct hfa384x_usbctlxq ctlxq;\n\tstruct timer_list reqtimer;\n\tstruct timer_list resptimer;\n\n\tstruct timer_list throttle;\n\n\tstruct work_struct reaper_bh;\n\tstruct work_struct completion_bh;\n\n\tstruct work_struct usb_work;\n\n\tunsigned long usb_flags;\n#define THROTTLE_RX\t0\n#define THROTTLE_TX\t1\n#define WORK_RX_HALT\t2\n#define WORK_TX_HALT\t3\n#define WORK_RX_RESUME\t4\n#define WORK_TX_RESUME\t5\n\n\tunsigned short req_timer_done:1;\n\tunsigned short resp_timer_done:1;\n\n\tint endp_in;\n\tint endp_out;\n\n\tint sniff_fcs;\n\tint sniff_channel;\n\tint sniff_truncate;\n\tint sniffhdr;\n\n\twait_queue_head_t cmdq;\t \n\n\t \n\tu32 state;\n\tu32 isap;\n\tu8 port_enabled[HFA384x_NUMPORTS_MAX];\n\n\t \n\tunsigned int dlstate;\n\tstruct hfa384x_downloadbuffer bufinfo;\n\tu16 dltimeout;\n\n\tint scanflag;\t\t \n\tint join_ap;\t\t \n\tint join_retries;\t \n\tstruct hfa384x_join_request_data joinreq; \n\n\tstruct wlandevice *wlandev;\n\t \n\tstruct work_struct link_bh;\n\n\tstruct work_struct commsqual_bh;\n\tstruct hfa384x_commsquality qual;\n\tstruct timer_list commsqual_timer;\n\n\tu16 link_status;\n\tu16 link_status_new;\n\tstruct sk_buff_head authq;\n\n\tu32 txrate;\n\n\t \n\n\t \n\tunsigned int presniff_port_type;\n\tu16 presniff_wepflags;\n\tu32 dot11_desired_bss_type;\n\n\tint dbmadjust;\n\n\t \n\tu8 dot11_grp_addr[MAX_GRP_ADDR][ETH_ALEN];\n\tunsigned int dot11_grpcnt;\n\n\t \n\tstruct hfa384x_compident ident_nic;\n\tstruct hfa384x_compident ident_pri_fw;\n\tstruct hfa384x_compident ident_sta_fw;\n\tstruct hfa384x_compident ident_ap_fw;\n\tu16 mm_mods;\n\n\t \n\tstruct hfa384x_caplevel cap_sup_mfi;\n\tstruct hfa384x_caplevel cap_sup_cfi;\n\tstruct hfa384x_caplevel cap_sup_pri;\n\tstruct hfa384x_caplevel cap_sup_sta;\n\tstruct hfa384x_caplevel cap_sup_ap;\n\n\t \n\tstruct hfa384x_caplevel cap_act_pri_cfi;  \n\n\tstruct hfa384x_caplevel cap_act_sta_cfi;  \n\n\tstruct hfa384x_caplevel cap_act_sta_mfi;  \n\n\tstruct hfa384x_caplevel cap_act_ap_cfi;\t \n\n\tstruct hfa384x_caplevel cap_act_ap_mfi;\t \n\n\tu32 psusercount;\t \n\tstruct hfa384x_comm_tallies_32 tallies;\t \n\tu8 comment[WLAN_COMMENT_MAX + 1];\t \n\n\t \n\tstruct {\n\t\tatomic_t done;\n\t\tu8 count;\n\t\tstruct hfa384x_ch_info_result results;\n\t} channel_info;\n\n\tstruct hfa384x_inf_frame *scanresults;\n\n\tstruct prism2sta_authlist authlist;\t \n\tunsigned int accessmode;\t\t \n\tstruct prism2sta_accesslist allow;\t \n\tstruct prism2sta_accesslist deny;\t \n\n};\n\nvoid hfa384x_create(struct hfa384x *hw, struct usb_device *usb);\nvoid hfa384x_destroy(struct hfa384x *hw);\n\nint hfa384x_corereset(struct hfa384x *hw, int holdtime, int settletime,\n\t\t      int genesis);\nint hfa384x_drvr_disable(struct hfa384x *hw, u16 macport);\nint hfa384x_drvr_enable(struct hfa384x *hw, u16 macport);\nint hfa384x_drvr_flashdl_enable(struct hfa384x *hw);\nint hfa384x_drvr_flashdl_disable(struct hfa384x *hw);\nint hfa384x_drvr_flashdl_write(struct hfa384x *hw, u32 daddr, void *buf,\n\t\t\t       u32 len);\nint hfa384x_drvr_getconfig(struct hfa384x *hw, u16 rid, void *buf, u16 len);\nint hfa384x_drvr_ramdl_enable(struct hfa384x *hw, u32 exeaddr);\nint hfa384x_drvr_ramdl_disable(struct hfa384x *hw);\nint hfa384x_drvr_ramdl_write(struct hfa384x *hw, u32 daddr, void *buf, u32 len);\nint hfa384x_drvr_readpda(struct hfa384x *hw, void *buf, unsigned int len);\nint hfa384x_drvr_setconfig(struct hfa384x *hw, u16 rid, void *buf, u16 len);\n\nstatic inline int\nhfa384x_drvr_getconfig16(struct hfa384x *hw, u16 rid, void *val)\n{\n\tint result = 0;\n\n\tresult = hfa384x_drvr_getconfig(hw, rid, val, sizeof(u16));\n\tif (result == 0)\n\t\tle16_to_cpus(val);\n\treturn result;\n}\n\nstatic inline int hfa384x_drvr_setconfig16(struct hfa384x *hw, u16 rid, u16 val)\n{\n\t__le16 value = cpu_to_le16(val);\n\n\treturn hfa384x_drvr_setconfig(hw, rid, &value, sizeof(value));\n}\n\nint\nhfa384x_drvr_setconfig_async(struct hfa384x *hw,\n\t\t\t     u16 rid,\n\t\t\t     void *buf,\n\t\t\t     u16 len, ctlx_usercb_t usercb, void *usercb_data);\n\nstatic inline int\nhfa384x_drvr_setconfig16_async(struct hfa384x *hw, u16 rid, u16 val)\n{\n\t__le16 value = cpu_to_le16(val);\n\n\treturn hfa384x_drvr_setconfig_async(hw, rid, &value, sizeof(value),\n\t\t\t\t\t    NULL, NULL);\n}\n\nint hfa384x_drvr_start(struct hfa384x *hw);\nint hfa384x_drvr_stop(struct hfa384x *hw);\nint\nhfa384x_drvr_txframe(struct hfa384x *hw, struct sk_buff *skb,\n\t\t     struct p80211_hdr *p80211_hdr,\n\t\t     struct p80211_metawep *p80211_wep);\nvoid hfa384x_tx_timeout(struct wlandevice *wlandev);\n\nint hfa384x_cmd_initialize(struct hfa384x *hw);\nint hfa384x_cmd_enable(struct hfa384x *hw, u16 macport);\nint hfa384x_cmd_disable(struct hfa384x *hw, u16 macport);\nint hfa384x_cmd_allocate(struct hfa384x *hw, u16 len);\nint hfa384x_cmd_monitor(struct hfa384x *hw, u16 enable);\nint\nhfa384x_cmd_download(struct hfa384x *hw,\n\t\t     u16 mode, u16 lowaddr, u16 highaddr, u16 codelen);\n\n#endif  \n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}