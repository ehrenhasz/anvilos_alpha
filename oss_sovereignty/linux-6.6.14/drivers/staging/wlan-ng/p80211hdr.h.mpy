{
  "module_name": "p80211hdr.h",
  "hash_id": "fe0315ddaba2bcec75d71586dc20cb617b6fd25e0da46ed054352f6aef374d82",
  "original_prompt": "Ingested from linux-6.6.14/drivers/staging/wlan-ng/p80211hdr.h",
  "human_readable_source": " \n \n\n#ifndef _P80211HDR_H\n#define _P80211HDR_H\n\n#include <linux/if_ether.h>\n\n \n#define WLAN_CRC_LEN\t\t\t4\n#define WLAN_BSSID_LEN\t\t\t6\n#define WLAN_HDR_A3_LEN\t\t\t24\n#define WLAN_HDR_A4_LEN\t\t\t30\n#define WLAN_SSID_MAXLEN\t\t32\n#define WLAN_DATA_MAXLEN\t\t2312\n#define WLAN_WEP_IV_LEN\t\t\t4\n#define WLAN_WEP_ICV_LEN\t\t4\n\n \n \n#define WLAN_FTYPE_MGMT\t\t\t0x00\n#define WLAN_FTYPE_CTL\t\t\t0x01\n#define WLAN_FTYPE_DATA\t\t\t0x02\n\n \n \n#define WLAN_FSTYPE_ASSOCREQ\t\t0x00\n#define WLAN_FSTYPE_ASSOCRESP\t\t0x01\n#define WLAN_FSTYPE_REASSOCREQ\t\t0x02\n#define WLAN_FSTYPE_REASSOCRESP\t\t0x03\n#define WLAN_FSTYPE_PROBEREQ\t\t0x04\n#define WLAN_FSTYPE_PROBERESP\t\t0x05\n#define WLAN_FSTYPE_BEACON\t\t0x08\n#define WLAN_FSTYPE_ATIM\t\t0x09\n#define WLAN_FSTYPE_DISASSOC\t\t0x0a\n#define WLAN_FSTYPE_AUTHEN\t\t0x0b\n#define WLAN_FSTYPE_DEAUTHEN\t\t0x0c\n\n \n#define WLAN_FSTYPE_BLOCKACKREQ\t\t0x8\n#define WLAN_FSTYPE_BLOCKACK\t\t0x9\n#define WLAN_FSTYPE_PSPOLL\t\t0x0a\n#define WLAN_FSTYPE_RTS\t\t\t0x0b\n#define WLAN_FSTYPE_CTS\t\t\t0x0c\n#define WLAN_FSTYPE_ACK\t\t\t0x0d\n#define WLAN_FSTYPE_CFEND\t\t0x0e\n#define WLAN_FSTYPE_CFENDCFACK\t\t0x0f\n\n \n#define WLAN_FSTYPE_DATAONLY\t\t0x00\n#define WLAN_FSTYPE_DATA_CFACK\t\t0x01\n#define WLAN_FSTYPE_DATA_CFPOLL\t\t0x02\n#define WLAN_FSTYPE_DATA_CFACK_CFPOLL\t0x03\n#define WLAN_FSTYPE_NULL\t\t0x04\n#define WLAN_FSTYPE_CFACK\t\t0x05\n#define WLAN_FSTYPE_CFPOLL\t\t0x06\n#define WLAN_FSTYPE_CFACK_CFPOLL\t0x07\n\n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n\n#define WLAN_GET_FC_FTYPE(n)\t((((u16)(n)) & GENMASK(3, 2)) >> 2)\n#define WLAN_GET_FC_FSTYPE(n)\t((((u16)(n)) & GENMASK(7, 4)) >> 4)\n#define WLAN_GET_FC_TODS(n)\t((((u16)(n)) & (BIT(8))) >> 8)\n#define WLAN_GET_FC_FROMDS(n)\t((((u16)(n)) & (BIT(9))) >> 9)\n#define WLAN_GET_FC_ISWEP(n)\t((((u16)(n)) & (BIT(14))) >> 14)\n\n#define WLAN_SET_FC_FTYPE(n)\t(((u16)(n)) << 2)\n#define WLAN_SET_FC_FSTYPE(n)\t(((u16)(n)) << 4)\n#define WLAN_SET_FC_TODS(n)\t(((u16)(n)) << 8)\n#define WLAN_SET_FC_FROMDS(n)\t(((u16)(n)) << 9)\n#define WLAN_SET_FC_ISWEP(n)\t(((u16)(n)) << 14)\n\n#define DOT11_RATE5_ISBASIC_GET(r)     (((u8)(r)) & BIT(7))\n\n \n\nstruct p80211_hdr {\n\t__le16\tframe_control;\n\tu16\tduration_id;\n\tu8\taddress1[ETH_ALEN];\n\tu8\taddress2[ETH_ALEN];\n\tu8\taddress3[ETH_ALEN];\n\tu16\tsequence_control;\n\tu8\taddress4[ETH_ALEN];\n} __packed;\n\n \n\nstatic inline u16 wlan_ctl_framelen(u16 fstype)\n{\n\tswitch (fstype)\t{\n\tcase WLAN_FSTYPE_BLOCKACKREQ:\n\t\treturn 24;\n\tcase WLAN_FSTYPE_BLOCKACK:\n\t\treturn 152;\n\tcase WLAN_FSTYPE_PSPOLL:\n\tcase WLAN_FSTYPE_RTS:\n\tcase WLAN_FSTYPE_CFEND:\n\tcase WLAN_FSTYPE_CFENDCFACK:\n\t\treturn 20;\n\tcase WLAN_FSTYPE_CTS:\n\tcase WLAN_FSTYPE_ACK:\n\t\treturn 14;\n\tdefault:\n\t\treturn 4;\n\t}\n}\n\n#define WLAN_FCS_LEN\t\t\t4\n\n \nstatic inline u16 p80211_headerlen(u16 fctl)\n{\n\tu16 hdrlen = 0;\n\n\tswitch (WLAN_GET_FC_FTYPE(fctl)) {\n\tcase WLAN_FTYPE_MGMT:\n\t\thdrlen = WLAN_HDR_A3_LEN;\n\t\tbreak;\n\tcase WLAN_FTYPE_DATA:\n\t\thdrlen = WLAN_HDR_A3_LEN;\n\t\tif (WLAN_GET_FC_TODS(fctl) && WLAN_GET_FC_FROMDS(fctl))\n\t\t\thdrlen += ETH_ALEN;\n\t\tbreak;\n\tcase WLAN_FTYPE_CTL:\n\t\thdrlen = wlan_ctl_framelen(WLAN_GET_FC_FSTYPE(fctl)) -\n\t\t    WLAN_FCS_LEN;\n\t\tbreak;\n\tdefault:\n\t\thdrlen = WLAN_HDR_A3_LEN;\n\t}\n\n\treturn hdrlen;\n}\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}