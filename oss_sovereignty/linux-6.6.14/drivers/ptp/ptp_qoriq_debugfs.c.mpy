{
  "module_name": "ptp_qoriq_debugfs.c",
  "hash_id": "51906159368aadd9ebb8801d7490a69c19c7b6bca6ffa8ebc00b94614e53e56d",
  "original_prompt": "Ingested from linux-6.6.14/drivers/ptp/ptp_qoriq_debugfs.c",
  "human_readable_source": "\n \n#include <linux/device.h>\n#include <linux/debugfs.h>\n#include <linux/fsl/ptp_qoriq.h>\n\nstatic int ptp_qoriq_fiper1_lpbk_get(void *data, u64 *val)\n{\n\tstruct ptp_qoriq *ptp_qoriq = data;\n\tstruct ptp_qoriq_registers *regs = &ptp_qoriq->regs;\n\tu32 ctrl;\n\n\tctrl = ptp_qoriq->read(&regs->ctrl_regs->tmr_ctrl);\n\t*val = ctrl & PP1L ? 1 : 0;\n\n\treturn 0;\n}\n\nstatic int ptp_qoriq_fiper1_lpbk_set(void *data, u64 val)\n{\n\tstruct ptp_qoriq *ptp_qoriq = data;\n\tstruct ptp_qoriq_registers *regs = &ptp_qoriq->regs;\n\tu32 ctrl;\n\n\tctrl = ptp_qoriq->read(&regs->ctrl_regs->tmr_ctrl);\n\tif (val == 0)\n\t\tctrl &= ~PP1L;\n\telse\n\t\tctrl |= PP1L;\n\n\tptp_qoriq->write(&regs->ctrl_regs->tmr_ctrl, ctrl);\n\treturn 0;\n}\n\nDEFINE_DEBUGFS_ATTRIBUTE(ptp_qoriq_fiper1_fops, ptp_qoriq_fiper1_lpbk_get,\n\t\t\t ptp_qoriq_fiper1_lpbk_set, \"%llu\\n\");\n\nstatic int ptp_qoriq_fiper2_lpbk_get(void *data, u64 *val)\n{\n\tstruct ptp_qoriq *ptp_qoriq = data;\n\tstruct ptp_qoriq_registers *regs = &ptp_qoriq->regs;\n\tu32 ctrl;\n\n\tctrl = ptp_qoriq->read(&regs->ctrl_regs->tmr_ctrl);\n\t*val = ctrl & PP2L ? 1 : 0;\n\n\treturn 0;\n}\n\nstatic int ptp_qoriq_fiper2_lpbk_set(void *data, u64 val)\n{\n\tstruct ptp_qoriq *ptp_qoriq = data;\n\tstruct ptp_qoriq_registers *regs = &ptp_qoriq->regs;\n\tu32 ctrl;\n\n\tctrl = ptp_qoriq->read(&regs->ctrl_regs->tmr_ctrl);\n\tif (val == 0)\n\t\tctrl &= ~PP2L;\n\telse\n\t\tctrl |= PP2L;\n\n\tptp_qoriq->write(&regs->ctrl_regs->tmr_ctrl, ctrl);\n\treturn 0;\n}\n\nDEFINE_DEBUGFS_ATTRIBUTE(ptp_qoriq_fiper2_fops, ptp_qoriq_fiper2_lpbk_get,\n\t\t\t ptp_qoriq_fiper2_lpbk_set, \"%llu\\n\");\n\nvoid ptp_qoriq_create_debugfs(struct ptp_qoriq *ptp_qoriq)\n{\n\tstruct dentry *root;\n\n\troot = debugfs_create_dir(dev_name(ptp_qoriq->dev), NULL);\n\tif (IS_ERR(root))\n\t\treturn;\n\tif (!root)\n\t\tgoto err_root;\n\n\tptp_qoriq->debugfs_root = root;\n\n\tif (!debugfs_create_file_unsafe(\"fiper1-loopback\", 0600, root,\n\t\t\t\t\tptp_qoriq, &ptp_qoriq_fiper1_fops))\n\t\tgoto err_node;\n\tif (!debugfs_create_file_unsafe(\"fiper2-loopback\", 0600, root,\n\t\t\t\t\tptp_qoriq, &ptp_qoriq_fiper2_fops))\n\t\tgoto err_node;\n\treturn;\n\nerr_node:\n\tdebugfs_remove_recursive(root);\n\tptp_qoriq->debugfs_root = NULL;\nerr_root:\n\tdev_err(ptp_qoriq->dev, \"failed to initialize debugfs\\n\");\n}\n\nvoid ptp_qoriq_remove_debugfs(struct ptp_qoriq *ptp_qoriq)\n{\n\tdebugfs_remove_recursive(ptp_qoriq->debugfs_root);\n\tptp_qoriq->debugfs_root = NULL;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}