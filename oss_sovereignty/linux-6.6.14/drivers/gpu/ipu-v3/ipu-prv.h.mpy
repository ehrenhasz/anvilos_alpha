{
  "module_name": "ipu-prv.h",
  "hash_id": "e30432a5cde56930f4ecb25cd7c00c2b509f401a21ee791886ddd46a315908eb",
  "original_prompt": "Ingested from linux-6.6.14/drivers/gpu/ipu-v3/ipu-prv.h",
  "human_readable_source": " \n \n#ifndef __IPU_PRV_H__\n#define __IPU_PRV_H__\n\nstruct ipu_soc;\n\n#include <linux/io.h>\n#include <linux/types.h>\n#include <linux/device.h>\n#include <linux/clk.h>\n#include <linux/platform_device.h>\n\n#include <video/imx-ipu-v3.h>\n\n#define IPU_MCU_T_DEFAULT\t8\n#define IPU_CM_IDMAC_REG_OFS\t0x00008000\n#define IPU_CM_IC_REG_OFS\t0x00020000\n#define IPU_CM_IRT_REG_OFS\t0x00028000\n#define IPU_CM_CSI0_REG_OFS\t0x00030000\n#define IPU_CM_CSI1_REG_OFS\t0x00038000\n#define IPU_CM_SMFC_REG_OFS\t0x00050000\n#define IPU_CM_DC_REG_OFS\t0x00058000\n#define IPU_CM_DMFC_REG_OFS\t0x00060000\n\n \n \n#define IPU_CM_REG(offset)\t(offset)\n\n#define IPU_CONF\t\t\tIPU_CM_REG(0)\n\n#define IPU_SRM_PRI1\t\t\tIPU_CM_REG(0x00a0)\n#define IPU_SRM_PRI2\t\t\tIPU_CM_REG(0x00a4)\n#define IPU_FS_PROC_FLOW1\t\tIPU_CM_REG(0x00a8)\n#define IPU_FS_PROC_FLOW2\t\tIPU_CM_REG(0x00ac)\n#define IPU_FS_PROC_FLOW3\t\tIPU_CM_REG(0x00b0)\n#define IPU_FS_DISP_FLOW1\t\tIPU_CM_REG(0x00b4)\n#define IPU_FS_DISP_FLOW2\t\tIPU_CM_REG(0x00b8)\n#define IPU_SKIP\t\t\tIPU_CM_REG(0x00bc)\n#define IPU_DISP_ALT_CONF\t\tIPU_CM_REG(0x00c0)\n#define IPU_DISP_GEN\t\t\tIPU_CM_REG(0x00c4)\n#define IPU_DISP_ALT1\t\t\tIPU_CM_REG(0x00c8)\n#define IPU_DISP_ALT2\t\t\tIPU_CM_REG(0x00cc)\n#define IPU_DISP_ALT3\t\t\tIPU_CM_REG(0x00d0)\n#define IPU_DISP_ALT4\t\t\tIPU_CM_REG(0x00d4)\n#define IPU_SNOOP\t\t\tIPU_CM_REG(0x00d8)\n#define IPU_MEM_RST\t\t\tIPU_CM_REG(0x00dc)\n#define IPU_PM\t\t\t\tIPU_CM_REG(0x00e0)\n#define IPU_GPR\t\t\t\tIPU_CM_REG(0x00e4)\n#define IPU_CHA_DB_MODE_SEL(ch)\t\tIPU_CM_REG(0x0150 + 4 * ((ch) / 32))\n#define IPU_ALT_CHA_DB_MODE_SEL(ch)\tIPU_CM_REG(0x0168 + 4 * ((ch) / 32))\n#define IPU_CHA_CUR_BUF(ch)\t\tIPU_CM_REG(0x023C + 4 * ((ch) / 32))\n#define IPU_ALT_CUR_BUF0\t\tIPU_CM_REG(0x0244)\n#define IPU_ALT_CUR_BUF1\t\tIPU_CM_REG(0x0248)\n#define IPU_SRM_STAT\t\t\tIPU_CM_REG(0x024C)\n#define IPU_PROC_TASK_STAT\t\tIPU_CM_REG(0x0250)\n#define IPU_DISP_TASK_STAT\t\tIPU_CM_REG(0x0254)\n#define IPU_CHA_BUF0_RDY(ch)\t\tIPU_CM_REG(0x0268 + 4 * ((ch) / 32))\n#define IPU_CHA_BUF1_RDY(ch)\t\tIPU_CM_REG(0x0270 + 4 * ((ch) / 32))\n#define IPU_CHA_BUF2_RDY(ch)\t\tIPU_CM_REG(0x0288 + 4 * ((ch) / 32))\n#define IPU_ALT_CHA_BUF0_RDY(ch)\tIPU_CM_REG(0x0278 + 4 * ((ch) / 32))\n#define IPU_ALT_CHA_BUF1_RDY(ch)\tIPU_CM_REG(0x0280 + 4 * ((ch) / 32))\n\n#define IPU_INT_CTRL(n)\t\tIPU_CM_REG(0x003C + 4 * (n))\n#define IPU_INT_STAT(n)\t\tIPU_CM_REG(0x0200 + 4 * (n))\n\n \n#define DP_S_SRM_MODE_MASK\t\t(0x3 << 3)\n#define DP_S_SRM_MODE_NOW\t\t(0x3 << 3)\n#define DP_S_SRM_MODE_NEXT_FRAME\t(0x1 << 3)\n\n \n#define FS_PRPENC_ROT_SRC_SEL_MASK\t(0xf << 0)\n#define FS_PRPENC_ROT_SRC_SEL_ENC\t\t(0x7 << 0)\n#define FS_PRPVF_ROT_SRC_SEL_MASK\t(0xf << 8)\n#define FS_PRPVF_ROT_SRC_SEL_VF\t\t\t(0x8 << 8)\n#define FS_PP_SRC_SEL_MASK\t\t(0xf << 12)\n#define FS_PP_ROT_SRC_SEL_MASK\t\t(0xf << 16)\n#define FS_PP_ROT_SRC_SEL_PP\t\t\t(0x5 << 16)\n#define FS_VDI1_SRC_SEL_MASK\t\t(0x3 << 20)\n#define FS_VDI3_SRC_SEL_MASK\t\t(0x3 << 20)\n#define FS_PRP_SRC_SEL_MASK\t\t(0xf << 24)\n#define FS_VDI_SRC_SEL_MASK\t\t(0x3 << 28)\n#define FS_VDI_SRC_SEL_CSI_DIRECT\t\t(0x1 << 28)\n#define FS_VDI_SRC_SEL_VDOA\t\t\t(0x2 << 28)\n\n \n#define FS_PRP_ENC_DEST_SEL_MASK\t(0xf << 0)\n#define FS_PRP_ENC_DEST_SEL_IRT_ENC\t\t(0x1 << 0)\n#define FS_PRPVF_DEST_SEL_MASK\t\t(0xf << 4)\n#define FS_PRPVF_DEST_SEL_IRT_VF\t\t(0x1 << 4)\n#define FS_PRPVF_ROT_DEST_SEL_MASK\t(0xf << 8)\n#define FS_PP_DEST_SEL_MASK\t\t(0xf << 12)\n#define FS_PP_DEST_SEL_IRT_PP\t\t\t(0x3 << 12)\n#define FS_PP_ROT_DEST_SEL_MASK\t\t(0xf << 16)\n#define FS_PRPENC_ROT_DEST_SEL_MASK\t(0xf << 20)\n#define FS_PRP_DEST_SEL_MASK\t\t(0xf << 24)\n\n#define IPU_DI0_COUNTER_RELEASE\t\t\t(1 << 24)\n#define IPU_DI1_COUNTER_RELEASE\t\t\t(1 << 25)\n\n#define IPU_IDMAC_REG(offset)\t(offset)\n\n#define IDMAC_CONF\t\t\tIPU_IDMAC_REG(0x0000)\n#define IDMAC_CHA_EN(ch)\t\tIPU_IDMAC_REG(0x0004 + 4 * ((ch) / 32))\n#define IDMAC_SEP_ALPHA\t\t\tIPU_IDMAC_REG(0x000c)\n#define IDMAC_ALT_SEP_ALPHA\t\tIPU_IDMAC_REG(0x0010)\n#define IDMAC_CHA_PRI(ch)\t\tIPU_IDMAC_REG(0x0014 + 4 * ((ch) / 32))\n#define IDMAC_WM_EN(ch)\t\t\tIPU_IDMAC_REG(0x001c + 4 * ((ch) / 32))\n#define IDMAC_CH_LOCK_EN_1\t\tIPU_IDMAC_REG(0x0024)\n#define IDMAC_CH_LOCK_EN_2\t\tIPU_IDMAC_REG(0x0028)\n#define IDMAC_SUB_ADDR_0\t\tIPU_IDMAC_REG(0x002c)\n#define IDMAC_SUB_ADDR_1\t\tIPU_IDMAC_REG(0x0030)\n#define IDMAC_SUB_ADDR_2\t\tIPU_IDMAC_REG(0x0034)\n#define IDMAC_BAND_EN(ch)\t\tIPU_IDMAC_REG(0x0040 + 4 * ((ch) / 32))\n#define IDMAC_CHA_BUSY(ch)\t\tIPU_IDMAC_REG(0x0100 + 4 * ((ch) / 32))\n\n#define IPU_NUM_IRQS\t(32 * 15)\n\nenum ipu_modules {\n\tIPU_CONF_CSI0_EN\t\t= (1 << 0),\n\tIPU_CONF_CSI1_EN\t\t= (1 << 1),\n\tIPU_CONF_IC_EN\t\t\t= (1 << 2),\n\tIPU_CONF_ROT_EN\t\t\t= (1 << 3),\n\tIPU_CONF_ISP_EN\t\t\t= (1 << 4),\n\tIPU_CONF_DP_EN\t\t\t= (1 << 5),\n\tIPU_CONF_DI0_EN\t\t\t= (1 << 6),\n\tIPU_CONF_DI1_EN\t\t\t= (1 << 7),\n\tIPU_CONF_SMFC_EN\t\t= (1 << 8),\n\tIPU_CONF_DC_EN\t\t\t= (1 << 9),\n\tIPU_CONF_DMFC_EN\t\t= (1 << 10),\n\n\tIPU_CONF_VDI_EN\t\t\t= (1 << 12),\n\n\tIPU_CONF_IDMAC_DIS\t\t= (1 << 22),\n\n\tIPU_CONF_IC_DMFC_SEL\t\t= (1 << 25),\n\tIPU_CONF_IC_DMFC_SYNC\t\t= (1 << 26),\n\tIPU_CONF_VDI_DMFC_SYNC\t\t= (1 << 27),\n\n\tIPU_CONF_CSI0_DATA_SOURCE\t= (1 << 28),\n\tIPU_CONF_CSI1_DATA_SOURCE\t= (1 << 29),\n\tIPU_CONF_IC_INPUT\t\t= (1 << 30),\n\tIPU_CONF_CSI_SEL\t\t= (1 << 31),\n};\n\nstruct ipuv3_channel {\n\tunsigned int num;\n\tstruct ipu_soc *ipu;\n\tstruct list_head list;\n};\n\nstruct ipu_cpmem;\nstruct ipu_csi;\nstruct ipu_dc_priv;\nstruct ipu_dmfc_priv;\nstruct ipu_di;\nstruct ipu_ic_priv;\nstruct ipu_vdi;\nstruct ipu_image_convert_priv;\nstruct ipu_smfc_priv;\nstruct ipu_pre;\nstruct ipu_prg;\n\nstruct ipu_devtype;\n\nstruct ipu_soc {\n\tstruct device\t\t*dev;\n\tconst struct ipu_devtype\t*devtype;\n\tenum ipuv3_type\t\tipu_type;\n\tspinlock_t\t\tlock;\n\tstruct mutex\t\tchannel_lock;\n\tstruct list_head\tchannels;\n\n\tvoid __iomem\t\t*cm_reg;\n\tvoid __iomem\t\t*idmac_reg;\n\n\tint\t\t\tid;\n\tint\t\t\tusecount;\n\n\tstruct clk\t\t*clk;\n\n\tint\t\t\tirq_sync;\n\tint\t\t\tirq_err;\n\tstruct irq_domain\t*domain;\n\n\tstruct ipu_cpmem\t*cpmem_priv;\n\tstruct ipu_dc_priv\t*dc_priv;\n\tstruct ipu_dp_priv\t*dp_priv;\n\tstruct ipu_dmfc_priv\t*dmfc_priv;\n\tstruct ipu_di\t\t*di_priv[2];\n\tstruct ipu_csi\t\t*csi_priv[2];\n\tstruct ipu_ic_priv\t*ic_priv;\n\tstruct ipu_vdi          *vdi_priv;\n\tstruct ipu_image_convert_priv *image_convert_priv;\n\tstruct ipu_smfc_priv\t*smfc_priv;\n\tstruct ipu_prg\t\t*prg_priv;\n};\n\nstatic inline u32 ipu_idmac_read(struct ipu_soc *ipu, unsigned offset)\n{\n\treturn readl(ipu->idmac_reg + offset);\n}\n\nstatic inline void ipu_idmac_write(struct ipu_soc *ipu, u32 value,\n\t\t\t\t   unsigned offset)\n{\n\twritel(value, ipu->idmac_reg + offset);\n}\n\nvoid ipu_srm_dp_update(struct ipu_soc *ipu, bool sync);\n\nint ipu_module_enable(struct ipu_soc *ipu, u32 mask);\nint ipu_module_disable(struct ipu_soc *ipu, u32 mask);\n\nbool ipu_idmac_channel_busy(struct ipu_soc *ipu, unsigned int chno);\n\nint ipu_csi_init(struct ipu_soc *ipu, struct device *dev, int id,\n\t\t unsigned long base, u32 module, struct clk *clk_ipu);\nvoid ipu_csi_exit(struct ipu_soc *ipu, int id);\n\nint ipu_ic_init(struct ipu_soc *ipu, struct device *dev,\n\t\tunsigned long base, unsigned long tpmem_base);\nvoid ipu_ic_exit(struct ipu_soc *ipu);\n\nint ipu_vdi_init(struct ipu_soc *ipu, struct device *dev,\n\t\t unsigned long base, u32 module);\nvoid ipu_vdi_exit(struct ipu_soc *ipu);\n\nint ipu_image_convert_init(struct ipu_soc *ipu, struct device *dev);\nvoid ipu_image_convert_exit(struct ipu_soc *ipu);\n\nint ipu_di_init(struct ipu_soc *ipu, struct device *dev, int id,\n\t\tunsigned long base, u32 module, struct clk *ipu_clk);\nvoid ipu_di_exit(struct ipu_soc *ipu, int id);\n\nint ipu_dmfc_init(struct ipu_soc *ipu, struct device *dev, unsigned long base,\n\t\tstruct clk *ipu_clk);\nvoid ipu_dmfc_exit(struct ipu_soc *ipu);\n\nint ipu_dp_init(struct ipu_soc *ipu, struct device *dev, unsigned long base);\nvoid ipu_dp_exit(struct ipu_soc *ipu);\n\nint ipu_dc_init(struct ipu_soc *ipu, struct device *dev, unsigned long base,\n\t\tunsigned long template_base);\nvoid ipu_dc_exit(struct ipu_soc *ipu);\n\nint ipu_cpmem_init(struct ipu_soc *ipu, struct device *dev, unsigned long base);\nvoid ipu_cpmem_exit(struct ipu_soc *ipu);\n\nint ipu_smfc_init(struct ipu_soc *ipu, struct device *dev, unsigned long base);\nvoid ipu_smfc_exit(struct ipu_soc *ipu);\n\nstruct ipu_pre *ipu_pre_lookup_by_phandle(struct device *dev, const char *name,\n\t\t\t\t\t  int index);\nint ipu_pre_get_available_count(void);\nint ipu_pre_get(struct ipu_pre *pre);\nvoid ipu_pre_put(struct ipu_pre *pre);\nu32 ipu_pre_get_baddr(struct ipu_pre *pre);\nvoid ipu_pre_configure(struct ipu_pre *pre, unsigned int width,\n\t\t       unsigned int height, unsigned int stride, u32 format,\n\t\t       uint64_t modifier, unsigned int bufaddr);\nvoid ipu_pre_update(struct ipu_pre *pre, unsigned int bufaddr);\nbool ipu_pre_update_pending(struct ipu_pre *pre);\n\nstruct ipu_prg *ipu_prg_lookup_by_phandle(struct device *dev, const char *name,\n\t\t\t\t\t  int ipu_id);\n\nextern struct platform_driver ipu_pre_drv;\nextern struct platform_driver ipu_prg_drv;\n\n#endif\t\t\t\t \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}