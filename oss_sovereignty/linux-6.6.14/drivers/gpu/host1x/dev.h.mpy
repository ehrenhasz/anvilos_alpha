{
  "module_name": "dev.h",
  "hash_id": "88e48bc18c1482b35a95399d060c869b89726f9e53ec1ae24326a14d2bb84736",
  "original_prompt": "Ingested from linux-6.6.14/drivers/gpu/host1x/dev.h",
  "human_readable_source": " \n \n\n#ifndef HOST1X_DEV_H\n#define HOST1X_DEV_H\n\n#include <linux/device.h>\n#include <linux/iommu.h>\n#include <linux/iova.h>\n#include <linux/platform_device.h>\n#include <linux/reset.h>\n\n#include \"cdma.h\"\n#include \"channel.h\"\n#include \"context.h\"\n#include \"intr.h\"\n#include \"job.h\"\n#include \"syncpt.h\"\n\nstruct host1x_syncpt;\nstruct host1x_syncpt_base;\nstruct host1x_channel;\nstruct host1x_cdma;\nstruct host1x_job;\nstruct push_buffer;\nstruct output;\nstruct dentry;\n\nstruct host1x_channel_ops {\n\tint (*init)(struct host1x_channel *channel, struct host1x *host,\n\t\t    unsigned int id);\n\tint (*submit)(struct host1x_job *job);\n};\n\nstruct host1x_cdma_ops {\n\tvoid (*start)(struct host1x_cdma *cdma);\n\tvoid (*stop)(struct host1x_cdma *cdma);\n\tvoid (*flush)(struct  host1x_cdma *cdma);\n\tint (*timeout_init)(struct host1x_cdma *cdma);\n\tvoid (*timeout_destroy)(struct host1x_cdma *cdma);\n\tvoid (*freeze)(struct host1x_cdma *cdma);\n\tvoid (*resume)(struct host1x_cdma *cdma, u32 getptr);\n\tvoid (*timeout_cpu_incr)(struct host1x_cdma *cdma, u32 getptr,\n\t\t\t\t u32 syncpt_incrs, u32 syncval, u32 nr_slots);\n};\n\nstruct host1x_pushbuffer_ops {\n\tvoid (*init)(struct push_buffer *pb);\n};\n\nstruct host1x_debug_ops {\n\tvoid (*debug_init)(struct dentry *de);\n\tvoid (*show_channel_cdma)(struct host1x *host,\n\t\t\t\t  struct host1x_channel *ch,\n\t\t\t\t  struct output *o);\n\tvoid (*show_channel_fifo)(struct host1x *host,\n\t\t\t\t  struct host1x_channel *ch,\n\t\t\t\t  struct output *o);\n\tvoid (*show_mlocks)(struct host1x *host, struct output *output);\n\n};\n\nstruct host1x_syncpt_ops {\n\tvoid (*restore)(struct host1x_syncpt *syncpt);\n\tvoid (*restore_wait_base)(struct host1x_syncpt *syncpt);\n\tvoid (*load_wait_base)(struct host1x_syncpt *syncpt);\n\tu32 (*load)(struct host1x_syncpt *syncpt);\n\tint (*cpu_incr)(struct host1x_syncpt *syncpt);\n\tvoid (*assign_to_channel)(struct host1x_syncpt *syncpt,\n\t                          struct host1x_channel *channel);\n\tvoid (*enable_protection)(struct host1x *host);\n};\n\nstruct host1x_intr_ops {\n\tint (*init_host_sync)(struct host1x *host, u32 cpm);\n\tvoid (*set_syncpt_threshold)(\n\t\tstruct host1x *host, unsigned int id, u32 thresh);\n\tvoid (*enable_syncpt_intr)(struct host1x *host, unsigned int id);\n\tvoid (*disable_syncpt_intr)(struct host1x *host, unsigned int id);\n\tvoid (*disable_all_syncpt_intrs)(struct host1x *host);\n\tint (*free_syncpt_irq)(struct host1x *host);\n};\n\nstruct host1x_sid_entry {\n\tunsigned int base;\n\tunsigned int offset;\n\tunsigned int limit;\n};\n\nstruct host1x_table_desc {\n\tunsigned int base;\n\tunsigned int count;\n};\n\nstruct host1x_info {\n\tunsigned int nb_channels;  \n\tunsigned int nb_pts;  \n\tunsigned int nb_bases;  \n\tunsigned int nb_mlocks;  \n\tint (*init)(struct host1x *host1x);  \n\tunsigned int sync_offset;  \n\tu64 dma_mask;  \n\tbool has_wide_gather;  \n\tbool has_hypervisor;  \n\tbool has_common;  \n\tunsigned int num_sid_entries;\n\tconst struct host1x_sid_entry *sid_table;\n\tstruct host1x_table_desc streamid_vm_table;\n\tstruct host1x_table_desc classid_vm_table;\n\tstruct host1x_table_desc mmio_vm_table;\n\t \n\tbool reserve_vblank_syncpts;\n};\n\nstruct host1x {\n\tconst struct host1x_info *info;\n\n\tvoid __iomem *regs;\n\tvoid __iomem *hv_regs;  \n\tvoid __iomem *common_regs;\n\tint syncpt_irq;\n\tstruct host1x_syncpt *syncpt;\n\tstruct host1x_syncpt_base *bases;\n\tstruct device *dev;\n\tstruct clk *clk;\n\tstruct reset_control_bulk_data resets[2];\n\tunsigned int nresets;\n\n\tstruct iommu_group *group;\n\tstruct iommu_domain *domain;\n\tstruct iova_domain iova;\n\tdma_addr_t iova_end;\n\n\tstruct mutex intr_mutex;\n\n\tconst struct host1x_syncpt_ops *syncpt_op;\n\tconst struct host1x_intr_ops *intr_op;\n\tconst struct host1x_channel_ops *channel_op;\n\tconst struct host1x_cdma_ops *cdma_op;\n\tconst struct host1x_pushbuffer_ops *cdma_pb_op;\n\tconst struct host1x_debug_ops *debug_op;\n\n\tstruct host1x_syncpt *nop_sp;\n\n\tstruct mutex syncpt_mutex;\n\n\tstruct host1x_channel_list channel_list;\n\tstruct host1x_memory_context_list context_list;\n\n\tstruct dentry *debugfs;\n\n\tstruct mutex devices_lock;\n\tstruct list_head devices;\n\n\tstruct list_head list;\n\n\tstruct device_dma_parameters dma_parms;\n\n\tstruct host1x_bo_cache cache;\n};\n\nvoid host1x_common_writel(struct host1x *host1x, u32 v, u32 r);\nvoid host1x_hypervisor_writel(struct host1x *host1x, u32 r, u32 v);\nu32 host1x_hypervisor_readl(struct host1x *host1x, u32 r);\nvoid host1x_sync_writel(struct host1x *host1x, u32 r, u32 v);\nu32 host1x_sync_readl(struct host1x *host1x, u32 r);\nvoid host1x_ch_writel(struct host1x_channel *ch, u32 r, u32 v);\nu32 host1x_ch_readl(struct host1x_channel *ch, u32 r);\n\nstatic inline void host1x_hw_syncpt_restore(struct host1x *host,\n\t\t\t\t\t    struct host1x_syncpt *sp)\n{\n\thost->syncpt_op->restore(sp);\n}\n\nstatic inline void host1x_hw_syncpt_restore_wait_base(struct host1x *host,\n\t\t\t\t\t\t      struct host1x_syncpt *sp)\n{\n\thost->syncpt_op->restore_wait_base(sp);\n}\n\nstatic inline void host1x_hw_syncpt_load_wait_base(struct host1x *host,\n\t\t\t\t\t\t   struct host1x_syncpt *sp)\n{\n\thost->syncpt_op->load_wait_base(sp);\n}\n\nstatic inline u32 host1x_hw_syncpt_load(struct host1x *host,\n\t\t\t\t\tstruct host1x_syncpt *sp)\n{\n\treturn host->syncpt_op->load(sp);\n}\n\nstatic inline int host1x_hw_syncpt_cpu_incr(struct host1x *host,\n\t\t\t\t\t    struct host1x_syncpt *sp)\n{\n\treturn host->syncpt_op->cpu_incr(sp);\n}\n\nstatic inline void host1x_hw_syncpt_assign_to_channel(\n\tstruct host1x *host, struct host1x_syncpt *sp,\n\tstruct host1x_channel *ch)\n{\n\treturn host->syncpt_op->assign_to_channel(sp, ch);\n}\n\nstatic inline void host1x_hw_syncpt_enable_protection(struct host1x *host)\n{\n\treturn host->syncpt_op->enable_protection(host);\n}\n\nstatic inline int host1x_hw_intr_init_host_sync(struct host1x *host, u32 cpm)\n{\n\treturn host->intr_op->init_host_sync(host, cpm);\n}\n\nstatic inline void host1x_hw_intr_set_syncpt_threshold(struct host1x *host,\n\t\t\t\t\t\t       unsigned int id,\n\t\t\t\t\t\t       u32 thresh)\n{\n\thost->intr_op->set_syncpt_threshold(host, id, thresh);\n}\n\nstatic inline void host1x_hw_intr_enable_syncpt_intr(struct host1x *host,\n\t\t\t\t\t\t     unsigned int id)\n{\n\thost->intr_op->enable_syncpt_intr(host, id);\n}\n\nstatic inline void host1x_hw_intr_disable_syncpt_intr(struct host1x *host,\n\t\t\t\t\t\t      unsigned int id)\n{\n\thost->intr_op->disable_syncpt_intr(host, id);\n}\n\nstatic inline void host1x_hw_intr_disable_all_syncpt_intrs(struct host1x *host)\n{\n\thost->intr_op->disable_all_syncpt_intrs(host);\n}\n\nstatic inline int host1x_hw_intr_free_syncpt_irq(struct host1x *host)\n{\n\treturn host->intr_op->free_syncpt_irq(host);\n}\n\nstatic inline int host1x_hw_channel_init(struct host1x *host,\n\t\t\t\t\t struct host1x_channel *channel,\n\t\t\t\t\t unsigned int id)\n{\n\treturn host->channel_op->init(channel, host, id);\n}\n\nstatic inline int host1x_hw_channel_submit(struct host1x *host,\n\t\t\t\t\t   struct host1x_job *job)\n{\n\treturn host->channel_op->submit(job);\n}\n\nstatic inline void host1x_hw_cdma_start(struct host1x *host,\n\t\t\t\t\tstruct host1x_cdma *cdma)\n{\n\thost->cdma_op->start(cdma);\n}\n\nstatic inline void host1x_hw_cdma_stop(struct host1x *host,\n\t\t\t\t       struct host1x_cdma *cdma)\n{\n\thost->cdma_op->stop(cdma);\n}\n\nstatic inline void host1x_hw_cdma_flush(struct host1x *host,\n\t\t\t\t\tstruct host1x_cdma *cdma)\n{\n\thost->cdma_op->flush(cdma);\n}\n\nstatic inline int host1x_hw_cdma_timeout_init(struct host1x *host,\n\t\t\t\t\t      struct host1x_cdma *cdma)\n{\n\treturn host->cdma_op->timeout_init(cdma);\n}\n\nstatic inline void host1x_hw_cdma_timeout_destroy(struct host1x *host,\n\t\t\t\t\t\t  struct host1x_cdma *cdma)\n{\n\thost->cdma_op->timeout_destroy(cdma);\n}\n\nstatic inline void host1x_hw_cdma_freeze(struct host1x *host,\n\t\t\t\t\t struct host1x_cdma *cdma)\n{\n\thost->cdma_op->freeze(cdma);\n}\n\nstatic inline void host1x_hw_cdma_resume(struct host1x *host,\n\t\t\t\t\t struct host1x_cdma *cdma, u32 getptr)\n{\n\thost->cdma_op->resume(cdma, getptr);\n}\n\nstatic inline void host1x_hw_cdma_timeout_cpu_incr(struct host1x *host,\n\t\t\t\t\t\t   struct host1x_cdma *cdma,\n\t\t\t\t\t\t   u32 getptr,\n\t\t\t\t\t\t   u32 syncpt_incrs,\n\t\t\t\t\t\t   u32 syncval, u32 nr_slots)\n{\n\thost->cdma_op->timeout_cpu_incr(cdma, getptr, syncpt_incrs, syncval,\n\t\t\t\t\tnr_slots);\n}\n\nstatic inline void host1x_hw_pushbuffer_init(struct host1x *host,\n\t\t\t\t\t     struct push_buffer *pb)\n{\n\thost->cdma_pb_op->init(pb);\n}\n\nstatic inline void host1x_hw_debug_init(struct host1x *host, struct dentry *de)\n{\n\tif (host->debug_op && host->debug_op->debug_init)\n\t\thost->debug_op->debug_init(de);\n}\n\nstatic inline void host1x_hw_show_channel_cdma(struct host1x *host,\n\t\t\t\t\t       struct host1x_channel *channel,\n\t\t\t\t\t       struct output *o)\n{\n\thost->debug_op->show_channel_cdma(host, channel, o);\n}\n\nstatic inline void host1x_hw_show_channel_fifo(struct host1x *host,\n\t\t\t\t\t       struct host1x_channel *channel,\n\t\t\t\t\t       struct output *o)\n{\n\thost->debug_op->show_channel_fifo(host, channel, o);\n}\n\nstatic inline void host1x_hw_show_mlocks(struct host1x *host, struct output *o)\n{\n\thost->debug_op->show_mlocks(host, o);\n}\n\nextern struct platform_driver tegra_mipi_driver;\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}