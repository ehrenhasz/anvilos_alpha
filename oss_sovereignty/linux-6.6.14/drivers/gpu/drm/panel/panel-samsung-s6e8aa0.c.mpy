{
  "module_name": "panel-samsung-s6e8aa0.c",
  "hash_id": "f26aeaa556582c3452832794cf9f0754bef8f0b9cf16dadf204b6a317d68c98e",
  "original_prompt": "Ingested from linux-6.6.14/drivers/gpu/drm/panel/panel-samsung-s6e8aa0.c",
  "human_readable_source": "\n \n\n#include <linux/delay.h>\n#include <linux/gpio/consumer.h>\n#include <linux/module.h>\n#include <linux/of.h>\n#include <linux/regulator/consumer.h>\n\n#include <video/mipi_display.h>\n#include <video/of_videomode.h>\n#include <video/videomode.h>\n\n#include <drm/drm_mipi_dsi.h>\n#include <drm/drm_modes.h>\n#include <drm/drm_panel.h>\n\n#define LDI_MTP_LENGTH\t\t\t24\n#define GAMMA_LEVEL_NUM\t\t\t25\n#define GAMMA_TABLE_LEN\t\t\t26\n\n#define PANELCTL_SS_MASK\t\t(1 << 5)\n#define PANELCTL_SS_1_800\t\t(0 << 5)\n#define PANELCTL_SS_800_1\t\t(1 << 5)\n#define PANELCTL_GTCON_MASK\t\t(7 << 2)\n#define PANELCTL_GTCON_110\t\t(6 << 2)\n#define PANELCTL_GTCON_111\t\t(7 << 2)\n\n#define PANELCTL_CLK1_CON_MASK\t\t(7 << 3)\n#define PANELCTL_CLK1_000\t\t(0 << 3)\n#define PANELCTL_CLK1_001\t\t(1 << 3)\n#define PANELCTL_CLK2_CON_MASK\t\t(7 << 0)\n#define PANELCTL_CLK2_000\t\t(0 << 0)\n#define PANELCTL_CLK2_001\t\t(1 << 0)\n\n#define PANELCTL_INT1_CON_MASK\t\t(7 << 3)\n#define PANELCTL_INT1_000\t\t(0 << 3)\n#define PANELCTL_INT1_001\t\t(1 << 3)\n#define PANELCTL_INT2_CON_MASK\t\t(7 << 0)\n#define PANELCTL_INT2_000\t\t(0 << 0)\n#define PANELCTL_INT2_001\t\t(1 << 0)\n\n#define PANELCTL_BICTL_CON_MASK\t\t(7 << 3)\n#define PANELCTL_BICTL_000\t\t(0 << 3)\n#define PANELCTL_BICTL_001\t\t(1 << 3)\n#define PANELCTL_BICTLB_CON_MASK\t(7 << 0)\n#define PANELCTL_BICTLB_000\t\t(0 << 0)\n#define PANELCTL_BICTLB_001\t\t(1 << 0)\n\n#define PANELCTL_EM_CLK1_CON_MASK\t(7 << 3)\n#define PANELCTL_EM_CLK1_110\t\t(6 << 3)\n#define PANELCTL_EM_CLK1_111\t\t(7 << 3)\n#define PANELCTL_EM_CLK1B_CON_MASK\t(7 << 0)\n#define PANELCTL_EM_CLK1B_110\t\t(6 << 0)\n#define PANELCTL_EM_CLK1B_111\t\t(7 << 0)\n\n#define PANELCTL_EM_CLK2_CON_MASK\t(7 << 3)\n#define PANELCTL_EM_CLK2_110\t\t(6 << 3)\n#define PANELCTL_EM_CLK2_111\t\t(7 << 3)\n#define PANELCTL_EM_CLK2B_CON_MASK\t(7 << 0)\n#define PANELCTL_EM_CLK2B_110\t\t(6 << 0)\n#define PANELCTL_EM_CLK2B_111\t\t(7 << 0)\n\n#define PANELCTL_EM_INT1_CON_MASK\t(7 << 3)\n#define PANELCTL_EM_INT1_000\t\t(0 << 3)\n#define PANELCTL_EM_INT1_001\t\t(1 << 3)\n#define PANELCTL_EM_INT2_CON_MASK\t(7 << 0)\n#define PANELCTL_EM_INT2_000\t\t(0 << 0)\n#define PANELCTL_EM_INT2_001\t\t(1 << 0)\n\n#define AID_DISABLE\t\t\t(0x4)\n#define AID_1\t\t\t\t(0x5)\n#define AID_2\t\t\t\t(0x6)\n#define AID_3\t\t\t\t(0x7)\n\ntypedef u8 s6e8aa0_gamma_table[GAMMA_TABLE_LEN];\n\nstruct s6e8aa0_variant {\n\tu8 version;\n\tconst s6e8aa0_gamma_table *gamma_tables;\n};\n\nstruct s6e8aa0 {\n\tstruct device *dev;\n\tstruct drm_panel panel;\n\n\tstruct regulator_bulk_data supplies[2];\n\tstruct gpio_desc *reset_gpio;\n\tu32 power_on_delay;\n\tu32 reset_delay;\n\tu32 init_delay;\n\tbool flip_horizontal;\n\tbool flip_vertical;\n\tstruct videomode vm;\n\tu32 width_mm;\n\tu32 height_mm;\n\n\tu8 version;\n\tu8 id;\n\tconst struct s6e8aa0_variant *variant;\n\tint brightness;\n\n\t \n\tint error;\n};\n\nstatic inline struct s6e8aa0 *panel_to_s6e8aa0(struct drm_panel *panel)\n{\n\treturn container_of(panel, struct s6e8aa0, panel);\n}\n\nstatic int s6e8aa0_clear_error(struct s6e8aa0 *ctx)\n{\n\tint ret = ctx->error;\n\n\tctx->error = 0;\n\treturn ret;\n}\n\nstatic void s6e8aa0_dcs_write(struct s6e8aa0 *ctx, const void *data, size_t len)\n{\n\tstruct mipi_dsi_device *dsi = to_mipi_dsi_device(ctx->dev);\n\tssize_t ret;\n\n\tif (ctx->error < 0)\n\t\treturn;\n\n\tret = mipi_dsi_dcs_write_buffer(dsi, data, len);\n\tif (ret < 0) {\n\t\tdev_err(ctx->dev, \"error %zd writing dcs seq: %*ph\\n\", ret,\n\t\t\t(int)len, data);\n\t\tctx->error = ret;\n\t}\n}\n\nstatic int s6e8aa0_dcs_read(struct s6e8aa0 *ctx, u8 cmd, void *data, size_t len)\n{\n\tstruct mipi_dsi_device *dsi = to_mipi_dsi_device(ctx->dev);\n\tint ret;\n\n\tif (ctx->error < 0)\n\t\treturn ctx->error;\n\n\tret = mipi_dsi_dcs_read(dsi, cmd, data, len);\n\tif (ret < 0) {\n\t\tdev_err(ctx->dev, \"error %d reading dcs seq(%#x)\\n\", ret, cmd);\n\t\tctx->error = ret;\n\t}\n\n\treturn ret;\n}\n\n#define s6e8aa0_dcs_write_seq(ctx, seq...) \\\n({\\\n\tconst u8 d[] = { seq };\\\n\tBUILD_BUG_ON_MSG(ARRAY_SIZE(d) > 64, \"DCS sequence too big for stack\");\\\n\ts6e8aa0_dcs_write(ctx, d, ARRAY_SIZE(d));\\\n})\n\n#define s6e8aa0_dcs_write_seq_static(ctx, seq...) \\\n({\\\n\tstatic const u8 d[] = { seq };\\\n\ts6e8aa0_dcs_write(ctx, d, ARRAY_SIZE(d));\\\n})\n\nstatic void s6e8aa0_apply_level_1_key(struct s6e8aa0 *ctx)\n{\n\ts6e8aa0_dcs_write_seq_static(ctx, 0xf0, 0x5a, 0x5a);\n}\n\nstatic void s6e8aa0_panel_cond_set_v142(struct s6e8aa0 *ctx)\n{\n\tstatic const u8 aids[] = {\n\t\t0x04, 0x04, 0x04, 0x04, 0x04, 0x60, 0x80, 0xA0\n\t};\n\tu8 aid = aids[ctx->id >> 5];\n\tu8 cfg = 0x3d;\n\tu8 clk_con = 0xc8;\n\tu8 int_con = 0x08;\n\tu8 bictl_con = 0x48;\n\tu8 em_clk1_con = 0xff;\n\tu8 em_clk2_con = 0xff;\n\tu8 em_int_con = 0xc8;\n\n\tif (ctx->flip_vertical) {\n\t\t \n\t\tcfg &= ~(PANELCTL_GTCON_MASK);\n\t\tcfg |= (PANELCTL_GTCON_110);\n\t}\n\n\tif (ctx->flip_horizontal) {\n\t\t \n\t\tcfg &= ~(PANELCTL_SS_MASK);\n\t\tcfg |= (PANELCTL_SS_1_800);\n\t}\n\n\tif (ctx->flip_horizontal || ctx->flip_vertical) {\n\t\t \n\t\tclk_con &= ~(PANELCTL_CLK1_CON_MASK |\n\t\t\tPANELCTL_CLK2_CON_MASK);\n\t\tclk_con |= (PANELCTL_CLK1_000 | PANELCTL_CLK2_001);\n\n\t\t \n\t\tint_con &= ~(PANELCTL_INT1_CON_MASK |\n\t\t\tPANELCTL_INT2_CON_MASK);\n\t\tint_con |= (PANELCTL_INT1_000 | PANELCTL_INT2_001);\n\n\t\t \n\t\tbictl_con &= ~(PANELCTL_BICTL_CON_MASK |\n\t\t\tPANELCTL_BICTLB_CON_MASK);\n\t\tbictl_con |= (PANELCTL_BICTL_000 |\n\t\t\tPANELCTL_BICTLB_001);\n\n\t\t \n\t\tem_clk1_con &= ~(PANELCTL_EM_CLK1_CON_MASK |\n\t\t\tPANELCTL_EM_CLK1B_CON_MASK);\n\t\tem_clk1_con |= (PANELCTL_EM_CLK1_110 |\n\t\t\tPANELCTL_EM_CLK1B_110);\n\n\t\t \n\t\tem_clk2_con &= ~(PANELCTL_EM_CLK2_CON_MASK |\n\t\t\tPANELCTL_EM_CLK2B_CON_MASK);\n\t\tem_clk2_con |= (PANELCTL_EM_CLK2_110 |\n\t\t\tPANELCTL_EM_CLK2B_110);\n\n\t\t \n\t\tem_int_con &= ~(PANELCTL_EM_INT1_CON_MASK |\n\t\t\tPANELCTL_EM_INT2_CON_MASK);\n\t\tem_int_con |= (PANELCTL_EM_INT1_000 |\n\t\t\tPANELCTL_EM_INT2_001);\n\t}\n\n\ts6e8aa0_dcs_write_seq(ctx,\n\t\t0xf8, cfg, 0x35, 0x00, 0x00, 0x00, 0x93, 0x00,\n\t\t0x3c, 0x78, 0x08, 0x27, 0x7d, 0x3f, 0x00, 0x00,\n\t\t0x00, 0x20, aid, 0x08, 0x6e, 0x00, 0x00, 0x00,\n\t\t0x02, 0x07, 0x07, 0x23, 0x23, 0xc0, clk_con, int_con,\n\t\tbictl_con, 0xc1, 0x00, 0xc1, em_clk1_con, em_clk2_con,\n\t\tem_int_con);\n}\n\nstatic void s6e8aa0_panel_cond_set(struct s6e8aa0 *ctx)\n{\n\tif (ctx->version < 142)\n\t\ts6e8aa0_dcs_write_seq_static(ctx,\n\t\t\t0xf8, 0x19, 0x35, 0x00, 0x00, 0x00, 0x94, 0x00,\n\t\t\t0x3c, 0x78, 0x10, 0x27, 0x08, 0x6e, 0x00, 0x00,\n\t\t\t0x00, 0x00, 0x04, 0x08, 0x6e, 0x00, 0x00, 0x00,\n\t\t\t0x00, 0x07, 0x07, 0x23, 0x6e, 0xc0, 0xc1, 0x01,\n\t\t\t0x81, 0xc1, 0x00, 0xc3, 0xf6, 0xf6, 0xc1\n\t\t);\n\telse\n\t\ts6e8aa0_panel_cond_set_v142(ctx);\n}\n\nstatic void s6e8aa0_display_condition_set(struct s6e8aa0 *ctx)\n{\n\ts6e8aa0_dcs_write_seq_static(ctx, 0xf2, 0x80, 0x03, 0x0d);\n}\n\nstatic void s6e8aa0_etc_source_control(struct s6e8aa0 *ctx)\n{\n\ts6e8aa0_dcs_write_seq_static(ctx, 0xf6, 0x00, 0x02, 0x00);\n}\n\nstatic void s6e8aa0_etc_pentile_control(struct s6e8aa0 *ctx)\n{\n\tstatic const u8 pent32[] = {\n\t\t0xb6, 0x0c, 0x02, 0x03, 0x32, 0xc0, 0x44, 0x44, 0xc0, 0x00\n\t};\n\n\tstatic const u8 pent142[] = {\n\t\t0xb6, 0x0c, 0x02, 0x03, 0x32, 0xff, 0x44, 0x44, 0xc0, 0x00\n\t};\n\n\tif (ctx->version < 142)\n\t\ts6e8aa0_dcs_write(ctx, pent32, ARRAY_SIZE(pent32));\n\telse\n\t\ts6e8aa0_dcs_write(ctx, pent142, ARRAY_SIZE(pent142));\n}\n\nstatic void s6e8aa0_etc_power_control(struct s6e8aa0 *ctx)\n{\n\tstatic const u8 pwr142[] = {\n\t\t0xf4, 0xcf, 0x0a, 0x12, 0x10, 0x1e, 0x33, 0x02\n\t};\n\n\tstatic const u8 pwr32[] = {\n\t\t0xf4, 0xcf, 0x0a, 0x15, 0x10, 0x19, 0x33, 0x02\n\t};\n\n\tif (ctx->version < 142)\n\t\ts6e8aa0_dcs_write(ctx, pwr32, ARRAY_SIZE(pwr32));\n\telse\n\t\ts6e8aa0_dcs_write(ctx, pwr142, ARRAY_SIZE(pwr142));\n}\n\nstatic void s6e8aa0_etc_elvss_control(struct s6e8aa0 *ctx)\n{\n\tu8 id = ctx->id ? 0 : 0x95;\n\n\ts6e8aa0_dcs_write_seq(ctx, 0xb1, 0x04, id);\n}\n\nstatic void s6e8aa0_elvss_nvm_set_v142(struct s6e8aa0 *ctx)\n{\n\tu8 br;\n\n\tswitch (ctx->brightness) {\n\tcase 0 ... 6:  \n\t\tbr = 0xdf;\n\t\tbreak;\n\tcase 7 ... 11:  \n\t\tbr = 0xdd;\n\t\tbreak;\n\tcase 12 ... 15:  \n\tdefault:\n\t\tbr = 0xd9;\n\t\tbreak;\n\tcase 16 ... 24:  \n\t\tbr = 0xd0;\n\t\tbreak;\n\t}\n\n\ts6e8aa0_dcs_write_seq(ctx, 0xd9, 0x14, 0x40, 0x0c, 0xcb, 0xce, 0x6e,\n\t\t0xc4, 0x0f, 0x40, 0x41, br, 0x00, 0x60, 0x19);\n}\n\nstatic void s6e8aa0_elvss_nvm_set(struct s6e8aa0 *ctx)\n{\n\tif (ctx->version < 142)\n\t\ts6e8aa0_dcs_write_seq_static(ctx,\n\t\t\t0xd9, 0x14, 0x40, 0x0c, 0xcb, 0xce, 0x6e, 0xc4, 0x07,\n\t\t\t0x40, 0x41, 0xc1, 0x00, 0x60, 0x19);\n\telse\n\t\ts6e8aa0_elvss_nvm_set_v142(ctx);\n};\n\nstatic void s6e8aa0_apply_level_2_key(struct s6e8aa0 *ctx)\n{\n\ts6e8aa0_dcs_write_seq_static(ctx, 0xfc, 0x5a, 0x5a);\n}\n\nstatic const s6e8aa0_gamma_table s6e8aa0_gamma_tables_v142[GAMMA_LEVEL_NUM] = {\n\t{\n\t\t0xfa, 0x01, 0x71, 0x31, 0x7b, 0x62, 0x55, 0x55,\n\t\t0xaf, 0xb1, 0xb1, 0xbd, 0xce, 0xb7, 0x9a, 0xb1,\n\t\t0x90, 0xb2, 0xc4, 0xae, 0x00, 0x60, 0x00, 0x40,\n\t\t0x00, 0x70,\n\t}, {\n\t\t0xfa, 0x01, 0x71, 0x31, 0x7b, 0x74, 0x68, 0x69,\n\t\t0xb8, 0xc1, 0xb7, 0xbd, 0xcd, 0xb8, 0x93, 0xab,\n\t\t0x88, 0xb4, 0xc4, 0xb1, 0x00, 0x6b, 0x00, 0x4d,\n\t\t0x00, 0x7d,\n\t}, {\n\t\t0xfa, 0x01, 0x71, 0x31, 0x7b, 0x95, 0x8a, 0x89,\n\t\t0xb4, 0xc6, 0xb2, 0xc5, 0xd2, 0xbf, 0x90, 0xa8,\n\t\t0x85, 0xb5, 0xc4, 0xb3, 0x00, 0x7b, 0x00, 0x5d,\n\t\t0x00, 0x8f,\n\t}, {\n\t\t0xfa, 0x01, 0x71, 0x31, 0x7b, 0x9f, 0x98, 0x92,\n\t\t0xb3, 0xc4, 0xb0, 0xbc, 0xcc, 0xb4, 0x91, 0xa6,\n\t\t0x87, 0xb5, 0xc5, 0xb4, 0x00, 0x87, 0x00, 0x6a,\n\t\t0x00, 0x9e,\n\t}, {\n\t\t0xfa, 0x01, 0x71, 0x31, 0x7b, 0x99, 0x93, 0x8b,\n\t\t0xb2, 0xc2, 0xb0, 0xbd, 0xce, 0xb4, 0x90, 0xa6,\n\t\t0x87, 0xb3, 0xc3, 0xb2, 0x00, 0x8d, 0x00, 0x70,\n\t\t0x00, 0xa4,\n\t}, {\n\t\t0xfa, 0x01, 0x71, 0x31, 0x7b, 0xa7, 0xa5, 0x99,\n\t\t0xb2, 0xc2, 0xb0, 0xbb, 0xcd, 0xb1, 0x93, 0xa7,\n\t\t0x8a, 0xb2, 0xc1, 0xb0, 0x00, 0x92, 0x00, 0x75,\n\t\t0x00, 0xaa,\n\t}, {\n\t\t0xfa, 0x01, 0x71, 0x31, 0x7b, 0xa0, 0xa0, 0x93,\n\t\t0xb6, 0xc4, 0xb4, 0xb5, 0xc8, 0xaa, 0x94, 0xa9,\n\t\t0x8c, 0xb2, 0xc0, 0xb0, 0x00, 0x97, 0x00, 0x7a,\n\t\t0x00, 0xaf,\n\t}, {\n\t\t0xfa, 0x01, 0x71, 0x31, 0x7b, 0xa3, 0xa7, 0x96,\n\t\t0xb3, 0xc2, 0xb0, 0xba, 0xcb, 0xb0, 0x94, 0xa8,\n\t\t0x8c, 0xb0, 0xbf, 0xaf, 0x00, 0x9f, 0x00, 0x83,\n\t\t0x00, 0xb9,\n\t}, {\n\t\t0xfa, 0x01, 0x71, 0x31, 0x7b, 0x9d, 0xa2, 0x90,\n\t\t0xb6, 0xc5, 0xb3, 0xb8, 0xc9, 0xae, 0x94, 0xa8,\n\t\t0x8d, 0xaf, 0xbd, 0xad, 0x00, 0xa4, 0x00, 0x88,\n\t\t0x00, 0xbf,\n\t}, {\n\t\t0xfa, 0x01, 0x71, 0x31, 0x7b, 0xa6, 0xac, 0x97,\n\t\t0xb4, 0xc4, 0xb1, 0xbb, 0xcb, 0xb2, 0x93, 0xa7,\n\t\t0x8d, 0xae, 0xbc, 0xad, 0x00, 0xa7, 0x00, 0x8c,\n\t\t0x00, 0xc3,\n\t}, {\n\t\t0xfa, 0x01, 0x71, 0x31, 0x7b, 0xa2, 0xa9, 0x93,\n\t\t0xb6, 0xc5, 0xb2, 0xba, 0xc9, 0xb0, 0x93, 0xa7,\n\t\t0x8d, 0xae, 0xbb, 0xac, 0x00, 0xab, 0x00, 0x90,\n\t\t0x00, 0xc8,\n\t}, {\n\t\t0xfa, 0x01, 0x71, 0x31, 0x7b, 0x9e, 0xa6, 0x8f,\n\t\t0xb7, 0xc6, 0xb3, 0xb8, 0xc8, 0xb0, 0x93, 0xa6,\n\t\t0x8c, 0xae, 0xbb, 0xad, 0x00, 0xae, 0x00, 0x93,\n\t\t0x00, 0xcc,\n\t}, {\n\t\t0xfa, 0x01, 0x71, 0x31, 0x7b, 0xab, 0xb4, 0x9c,\n\t\t0xb3, 0xc3, 0xaf, 0xb7, 0xc7, 0xaf, 0x93, 0xa6,\n\t\t0x8c, 0xaf, 0xbc, 0xad, 0x00, 0xb1, 0x00, 0x97,\n\t\t0x00, 0xcf,\n\t}, {\n\t\t0xfa, 0x01, 0x71, 0x31, 0x7b, 0xa6, 0xb1, 0x98,\n\t\t0xb1, 0xc2, 0xab, 0xba, 0xc9, 0xb2, 0x93, 0xa6,\n\t\t0x8d, 0xae, 0xba, 0xab, 0x00, 0xb5, 0x00, 0x9b,\n\t\t0x00, 0xd4,\n\t}, {\n\t\t0xfa, 0x01, 0x71, 0x31, 0x7b, 0xa3, 0xae, 0x94,\n\t\t0xb2, 0xc3, 0xac, 0xbb, 0xca, 0xb4, 0x91, 0xa4,\n\t\t0x8a, 0xae, 0xba, 0xac, 0x00, 0xb8, 0x00, 0x9e,\n\t\t0x00, 0xd8,\n\t}, {\n\t\t0xfa, 0x01, 0x71, 0x31, 0x7b, 0xab, 0xb7, 0x9c,\n\t\t0xae, 0xc0, 0xa9, 0xba, 0xc9, 0xb3, 0x92, 0xa5,\n\t\t0x8b, 0xad, 0xb9, 0xab, 0x00, 0xbb, 0x00, 0xa1,\n\t\t0x00, 0xdc,\n\t}, {\n\t\t0xfa, 0x01, 0x71, 0x31, 0x7b, 0xa7, 0xb4, 0x97,\n\t\t0xb0, 0xc1, 0xaa, 0xb9, 0xc8, 0xb2, 0x92, 0xa5,\n\t\t0x8c, 0xae, 0xb9, 0xab, 0x00, 0xbe, 0x00, 0xa4,\n\t\t0x00, 0xdf,\n\t}, {\n\t\t0xfa, 0x01, 0x71, 0x31, 0x7b, 0xa3, 0xb0, 0x94,\n\t\t0xb0, 0xc2, 0xab, 0xbb, 0xc9, 0xb3, 0x91, 0xa4,\n\t\t0x8b, 0xad, 0xb8, 0xaa, 0x00, 0xc1, 0x00, 0xa8,\n\t\t0x00, 0xe2,\n\t}, {\n\t\t0xfa, 0x01, 0x71, 0x31, 0x7b, 0xa3, 0xb0, 0x94,\n\t\t0xae, 0xbf, 0xa8, 0xb9, 0xc8, 0xb3, 0x92, 0xa4,\n\t\t0x8b, 0xad, 0xb7, 0xa9, 0x00, 0xc4, 0x00, 0xab,\n\t\t0x00, 0xe6,\n\t}, {\n\t\t0xfa, 0x01, 0x71, 0x31, 0x7b, 0xa7, 0xb6, 0x98,\n\t\t0xaf, 0xc0, 0xa8, 0xb8, 0xc7, 0xb2, 0x93, 0xa5,\n\t\t0x8d, 0xad, 0xb7, 0xa9, 0x00, 0xc7, 0x00, 0xae,\n\t\t0x00, 0xe9,\n\t}, {\n\t\t0xfa, 0x01, 0x71, 0x31, 0x7b, 0xa4, 0xb3, 0x95,\n\t\t0xaf, 0xc1, 0xa9, 0xb9, 0xc8, 0xb3, 0x92, 0xa4,\n\t\t0x8b, 0xad, 0xb7, 0xaa, 0x00, 0xc9, 0x00, 0xb0,\n\t\t0x00, 0xec,\n\t}, {\n\t\t0xfa, 0x01, 0x71, 0x31, 0x7b, 0xa4, 0xb3, 0x95,\n\t\t0xac, 0xbe, 0xa6, 0xbb, 0xc9, 0xb4, 0x90, 0xa3,\n\t\t0x8a, 0xad, 0xb7, 0xa9, 0x00, 0xcc, 0x00, 0xb4,\n\t\t0x00, 0xf0,\n\t}, {\n\t\t0xfa, 0x01, 0x71, 0x31, 0x7b, 0xa0, 0xb0, 0x91,\n\t\t0xae, 0xc0, 0xa6, 0xba, 0xc8, 0xb4, 0x91, 0xa4,\n\t\t0x8b, 0xad, 0xb7, 0xa9, 0x00, 0xcf, 0x00, 0xb7,\n\t\t0x00, 0xf3,\n\t}, {\n\t\t0xfa, 0x01, 0x71, 0x31, 0x7b, 0xa7, 0xb8, 0x98,\n\t\t0xab, 0xbd, 0xa4, 0xbb, 0xc9, 0xb5, 0x91, 0xa3,\n\t\t0x8b, 0xac, 0xb6, 0xa8, 0x00, 0xd1, 0x00, 0xb9,\n\t\t0x00, 0xf6,\n\t}, {\n\t\t0xfa, 0x01, 0x71, 0x31, 0x7b, 0xa4, 0xb5, 0x95,\n\t\t0xa9, 0xbc, 0xa1, 0xbb, 0xc9, 0xb5, 0x91, 0xa3,\n\t\t0x8a, 0xad, 0xb6, 0xa8, 0x00, 0xd6, 0x00, 0xbf,\n\t\t0x00, 0xfc,\n\t},\n};\n\nstatic const s6e8aa0_gamma_table s6e8aa0_gamma_tables_v96[GAMMA_LEVEL_NUM] = {\n\t{\n\t\t0xfa, 0x01, 0x1f, 0x1f, 0x1f, 0xff, 0x00, 0xff,\n\t\t0xdf, 0x1f, 0xd7, 0xdc, 0xb7, 0xe1, 0xc0, 0xaf,\n\t\t0xc4, 0xd2, 0xd0, 0xcf, 0x00, 0x4d, 0x00, 0x40,\n\t\t0x00, 0x5f,\n\t}, {\n\t\t0xfa, 0x01, 0x1f, 0x1f, 0x1f, 0xff, 0x00, 0xff,\n\t\t0xd5, 0x35, 0xcf, 0xdc, 0xc1, 0xe1, 0xbf, 0xb3,\n\t\t0xc1, 0xd2, 0xd1, 0xce,\t0x00, 0x53, 0x00, 0x46,\n\t\t0x00, 0x67,\n\t}, {\n\t\t0xfa, 0x01, 0x1f, 0x1f, 0x1f, 0xff, 0x00, 0xff,\n\t\t0xd2, 0x64, 0xcf, 0xdb, 0xc6, 0xe1, 0xbd, 0xb3,\n\t\t0xbd, 0xd2, 0xd2, 0xce,\t0x00, 0x59, 0x00, 0x4b,\n\t\t0x00, 0x6e,\n\t}, {\n\t\t0xfa, 0x01, 0x1f, 0x1f, 0x1f, 0xff, 0x00, 0xff,\n\t\t0xd0, 0x7c, 0xcf, 0xdb, 0xc9, 0xe0, 0xbc, 0xb4,\n\t\t0xbb, 0xcf, 0xd1, 0xcc, 0x00, 0x5f, 0x00, 0x50,\n\t\t0x00, 0x75,\n\t}, {\n\t\t0xfa, 0x01, 0x1f, 0x1f, 0x1f, 0xff, 0x00, 0xff,\n\t\t0xd0, 0x8e, 0xd1, 0xdb, 0xcc, 0xdf, 0xbb, 0xb6,\n\t\t0xb9, 0xd0, 0xd1, 0xcd,\t0x00, 0x63, 0x00, 0x54,\n\t\t0x00, 0x7a,\n\t}, {\n\t\t0xfa, 0x01, 0x1f, 0x1f, 0x1f, 0xff, 0x00, 0xff,\n\t\t0xd1, 0x9e, 0xd5, 0xda, 0xcd, 0xdd, 0xbb, 0xb7,\n\t\t0xb9, 0xce, 0xce, 0xc9,\t0x00, 0x68, 0x00, 0x59,\n\t\t0x00, 0x81,\n\t}, {\n\t\t0xfa, 0x01, 0x1f, 0x1f, 0x1f, 0xff, 0x00, 0xff,\n\t\t0xd0, 0xa5, 0xd6, 0xda, 0xcf, 0xdd, 0xbb, 0xb7,\n\t\t0xb8, 0xcc, 0xcd, 0xc7,\t0x00, 0x6c, 0x00, 0x5c,\n\t\t0x00, 0x86,\n\t}, {\n\t\t0xfa, 0x01, 0x1f, 0x1f, 0x1f, 0xff, 0x1f, 0xfe,\n\t\t0xd0, 0xae, 0xd7, 0xd9, 0xd0, 0xdb, 0xb9, 0xb6,\n\t\t0xb5, 0xca, 0xcc, 0xc5,\t0x00, 0x74, 0x00, 0x63,\n\t\t0x00, 0x90,\n\t}, {\n\t\t0xfa, 0x01, 0x1f, 0x1f, 0x1f, 0xff, 0x1f, 0xf9,\n\t\t0xcf, 0xb0, 0xd6, 0xd9, 0xd1, 0xdb, 0xb9, 0xb6,\n\t\t0xb4, 0xca, 0xcb, 0xc5,\t0x00, 0x77, 0x00, 0x66,\n\t\t0x00, 0x94,\n\t}, {\n\t\t0xfa, 0x01, 0x1f, 0x1f, 0x1f, 0xff, 0x1f, 0xf7,\n\t\t0xcf, 0xb3, 0xd7, 0xd8, 0xd1, 0xd9, 0xb7, 0xb6,\n\t\t0xb3, 0xc9, 0xca, 0xc3,\t0x00, 0x7b, 0x00, 0x69,\n\t\t0x00, 0x99,\n\n\t}, {\n\t\t0xfa, 0x01, 0x1f, 0x1f, 0x1f, 0xfd, 0x2f, 0xf7,\n\t\t0xdf, 0xb5, 0xd6, 0xd8, 0xd1, 0xd8, 0xb6, 0xb5,\n\t\t0xb2, 0xca, 0xcb, 0xc4,\t0x00, 0x7e, 0x00, 0x6c,\n\t\t0x00, 0x9d,\n\t}, {\n\t\t0xfa, 0x01, 0x1f, 0x1f, 0x1f, 0xfa, 0x2f, 0xf5,\n\t\t0xce, 0xb6, 0xd5, 0xd7, 0xd2, 0xd8, 0xb6, 0xb4,\n\t\t0xb0, 0xc7, 0xc9, 0xc1,\t0x00, 0x84, 0x00, 0x71,\n\t\t0x00, 0xa5,\n\t}, {\n\t\t0xfa, 0x01, 0x1f, 0x1f, 0x1f, 0xf7, 0x2f, 0xf2,\n\t\t0xce, 0xb9, 0xd5, 0xd8, 0xd2, 0xd8, 0xb4, 0xb4,\n\t\t0xaf, 0xc7, 0xc9, 0xc1,\t0x00, 0x87, 0x00, 0x73,\n\t\t0x00, 0xa8,\n\t}, {\n\t\t0xfa, 0x01, 0x1f, 0x1f, 0x1f, 0xf5, 0x2f, 0xf0,\n\t\t0xdf, 0xba, 0xd5, 0xd7, 0xd2, 0xd7, 0xb4, 0xb4,\n\t\t0xaf, 0xc5, 0xc7, 0xbf,\t0x00, 0x8a, 0x00, 0x76,\n\t\t0x00, 0xac,\n\t}, {\n\t\t0xfa, 0x01, 0x1f, 0x1f, 0x1f, 0xf2, 0x2f, 0xed,\n\t\t0xcE, 0xbb, 0xd4, 0xd6, 0xd2, 0xd6, 0xb5, 0xb4,\n\t\t0xaF, 0xc5, 0xc7, 0xbf,\t0x00, 0x8c, 0x00, 0x78,\n\t\t0x00, 0xaf,\n\t}, {\n\t\t0xfa, 0x01, 0x1f, 0x1f, 0x1f, 0xef, 0x2f, 0xeb,\n\t\t0xcd, 0xbb, 0xd2, 0xd7, 0xd3, 0xd6, 0xb3, 0xb4,\n\t\t0xae, 0xc5, 0xc6, 0xbe,\t0x00, 0x91, 0x00, 0x7d,\n\t\t0x00, 0xb6,\n\t}, {\n\t\t0xfa, 0x01, 0x1f, 0x1f, 0x1f, 0xee, 0x2f, 0xea,\n\t\t0xce, 0xbd, 0xd4, 0xd6, 0xd2, 0xd5, 0xb2, 0xb3,\n\t\t0xad, 0xc3, 0xc4, 0xbb,\t0x00, 0x94, 0x00, 0x7f,\n\t\t0x00, 0xba,\n\t}, {\n\t\t0xfa, 0x01, 0x1f, 0x1f, 0x1f, 0xec, 0x2f, 0xe8,\n\t\t0xce, 0xbe, 0xd3, 0xd6, 0xd3, 0xd5, 0xb2, 0xb2,\n\t\t0xac, 0xc3, 0xc5, 0xbc,\t0x00, 0x96, 0x00, 0x81,\n\t\t0x00, 0xbd,\n\t}, {\n\t\t0xfa, 0x01, 0x1f, 0x1f, 0x1f, 0xeb, 0x2f, 0xe7,\n\t\t0xce, 0xbf, 0xd3, 0xd6, 0xd2, 0xd5, 0xb1, 0xb2,\n\t\t0xab, 0xc2, 0xc4, 0xbb,\t0x00, 0x99, 0x00, 0x83,\n\t\t0x00, 0xc0,\n\t}, {\n\t\t0xfa, 0x01, 0x1f, 0x1f, 0x1f, 0xef, 0x5f, 0xe9,\n\t\t0xca, 0xbf, 0xd3, 0xd5, 0xd2, 0xd4, 0xb2, 0xb2,\n\t\t0xab, 0xc1, 0xc4, 0xba,\t0x00, 0x9b, 0x00, 0x85,\n\t\t0x00, 0xc3,\n\t}, {\n\t\t0xfa, 0x01, 0x1f, 0x1f, 0x1f, 0xea, 0x5f, 0xe8,\n\t\t0xee, 0xbf, 0xd2, 0xd5, 0xd2, 0xd4, 0xb1, 0xb2,\n\t\t0xab, 0xc1, 0xc2, 0xb9,\t0x00, 0x9D, 0x00, 0x87,\n\t\t0x00, 0xc6,\n\t}, {\n\t\t0xfa, 0x01, 0x1f, 0x1f, 0x1f, 0xe9, 0x5f, 0xe7,\n\t\t0xcd, 0xbf, 0xd2, 0xd6, 0xd2, 0xd4, 0xb1, 0xb2,\n\t\t0xab, 0xbe, 0xc0, 0xb7,\t0x00, 0xa1, 0x00, 0x8a,\n\t\t0x00, 0xca,\n\t}, {\n\t\t0xfa, 0x01, 0x1f, 0x1f, 0x1f, 0xe8, 0x61, 0xe6,\n\t\t0xcd, 0xbf, 0xd1, 0xd6, 0xd3, 0xd4, 0xaf, 0xb0,\n\t\t0xa9, 0xbe, 0xc1, 0xb7,\t0x00, 0xa3, 0x00, 0x8b,\n\t\t0x00, 0xce,\n\t}, {\n\t\t0xfa, 0x01, 0x1f, 0x1f, 0x1f, 0xe8, 0x62, 0xe5,\n\t\t0xcc, 0xc0, 0xd0, 0xd6, 0xd2, 0xd4, 0xaf, 0xb1,\n\t\t0xa9, 0xbd, 0xc0, 0xb6,\t0x00, 0xa5, 0x00, 0x8d,\n\t\t0x00, 0xd0,\n\t}, {\n\t\t0xfa, 0x01, 0x1f, 0x1f, 0x1f, 0xe7, 0x7f, 0xe3,\n\t\t0xcc, 0xc1, 0xd0, 0xd5, 0xd3, 0xd3, 0xae, 0xaf,\n\t\t0xa8, 0xbe, 0xc0, 0xb7,\t0x00, 0xa8, 0x00, 0x90,\n\t\t0x00, 0xd3,\n\t}\n};\n\nstatic const s6e8aa0_gamma_table s6e8aa0_gamma_tables_v32[GAMMA_LEVEL_NUM] = {\n\t{\n\t\t0xfa, 0x01, 0x43, 0x14, 0x45, 0x72, 0x5e, 0x6b,\n\t\t0xa1, 0xa7, 0x9a, 0xb4, 0xcb, 0xb8, 0x92, 0xac,\n\t\t0x97, 0xb4, 0xc3, 0xb5, 0x00, 0x4e, 0x00, 0x37,\n\t\t0x00, 0x58,\n\t}, {\n\t\t0xfa, 0x01, 0x43, 0x14, 0x45, 0x85, 0x71, 0x7d,\n\t\t0xa6, 0xb6, 0xa1, 0xb5, 0xca, 0xba, 0x93, 0xac,\n\t\t0x98, 0xb2, 0xc0, 0xaf, 0x00, 0x59, 0x00, 0x43,\n\t\t0x00, 0x64,\n\t}, {\n\t\t0xfa, 0x01, 0x43, 0x14, 0x45, 0xa4, 0x94, 0x9e,\n\t\t0xa0, 0xbb, 0x9c, 0xc3, 0xd2, 0xc6, 0x93, 0xaa,\n\t\t0x95, 0xb7, 0xc2, 0xb4, 0x00, 0x65, 0x00, 0x50,\n\t\t0x00, 0x74,\n\t}, {\n\t\t0xfa, 0x01, 0x43, 0x14, 0x45, 0xad, 0xa1, 0xa6,\n\t\t0xa0, 0xb9, 0x9b, 0xc3, 0xd1, 0xc8, 0x90, 0xa6,\n\t\t0x90, 0xbb, 0xc3, 0xb7, 0x00, 0x6f, 0x00, 0x5b,\n\t\t0x00, 0x80,\n\t}, {\n\t\t0xfa, 0x01, 0x43, 0x14, 0x45, 0xa6, 0x9d, 0x9f,\n\t\t0x9f, 0xb8, 0x9a, 0xc7, 0xd5, 0xcc, 0x90, 0xa5,\n\t\t0x8f, 0xb8, 0xc1, 0xb6, 0x00, 0x74, 0x00, 0x60,\n\t\t0x00, 0x85,\n\t}, {\n\t\t0xfa, 0x01, 0x43, 0x14, 0x45, 0xb3, 0xae, 0xae,\n\t\t0x9e, 0xb7, 0x9a, 0xc8, 0xd6, 0xce, 0x91, 0xa6,\n\t\t0x90, 0xb6, 0xc0, 0xb3, 0x00, 0x78, 0x00, 0x65,\n\t\t0x00, 0x8a,\n\t}, {\n\t\t0xfa, 0x01, 0x43, 0x14, 0x45, 0xad, 0xa9, 0xa8,\n\t\t0xa3, 0xb9, 0x9e, 0xc4, 0xd3, 0xcb, 0x94, 0xa6,\n\t\t0x90, 0xb6, 0xbf, 0xb3, 0x00, 0x7c, 0x00, 0x69,\n\t\t0x00, 0x8e,\n\t}, {\n\t\t0xfa, 0x01, 0x43, 0x14, 0x45, 0xaf, 0xaf, 0xa9,\n\t\t0xa5, 0xbc, 0xa2, 0xc7, 0xd5, 0xcd, 0x93, 0xa5,\n\t\t0x8f, 0xb4, 0xbd, 0xb1, 0x00, 0x83, 0x00, 0x70,\n\t\t0x00, 0x96,\n\t}, {\n\t\t0xfa, 0x01, 0x43, 0x14, 0x45, 0xa9, 0xab, 0xa3,\n\t\t0xaa, 0xbf, 0xa7, 0xc5, 0xd3, 0xcb, 0x93, 0xa5,\n\t\t0x8f, 0xb2, 0xbb, 0xb0, 0x00, 0x86, 0x00, 0x74,\n\t\t0x00, 0x9b,\n\t}, {\n\t\t0xfa, 0x01, 0x43, 0x14, 0x45, 0xb1, 0xb5, 0xab,\n\t\t0xab, 0xc0, 0xa9, 0xc7, 0xd4, 0xcc, 0x94, 0xa4,\n\t\t0x8f, 0xb1, 0xbb, 0xaf, 0x00, 0x8a, 0x00, 0x77,\n\t\t0x00, 0x9e,\n\t}, {\n\t\t0xfa, 0x01, 0x43, 0x14, 0x45, 0xad, 0xb2, 0xa7,\n\t\t0xae, 0xc2, 0xab, 0xc5, 0xd3, 0xca, 0x93, 0xa4,\n\t\t0x8f, 0xb1, 0xba, 0xae, 0x00, 0x8d, 0x00, 0x7b,\n\t\t0x00, 0xa2,\n\t}, {\n\t\t0xfa, 0x01, 0x43, 0x14, 0x45, 0xa9, 0xaf, 0xa3,\n\t\t0xb0, 0xc3, 0xae, 0xc4, 0xd1, 0xc8, 0x93, 0xa4,\n\t\t0x8f, 0xb1, 0xba, 0xaf, 0x00, 0x8f, 0x00, 0x7d,\n\t\t0x00, 0xa5,\n\t}, {\n\t\t0xfa, 0x01, 0x43, 0x14, 0x45, 0xb4, 0xbd, 0xaf,\n\t\t0xae, 0xc1, 0xab, 0xc2, 0xd0, 0xc6, 0x94, 0xa4,\n\t\t0x8f, 0xb1, 0xba, 0xaf, 0x00, 0x92, 0x00, 0x80,\n\t\t0x00, 0xa8,\n\t}, {\n\t\t0xfa, 0x01, 0x43, 0x14, 0x45, 0xb0, 0xb9, 0xac,\n\t\t0xad, 0xc1, 0xab, 0xc4, 0xd1, 0xc7, 0x95, 0xa4,\n\t\t0x90, 0xb0, 0xb9, 0xad, 0x00, 0x95, 0x00, 0x84,\n\t\t0x00, 0xac,\n\t}, {\n\t\t0xfa, 0x01, 0x43, 0x14, 0x45, 0xad, 0xb6, 0xa7,\n\t\t0xaf, 0xc2, 0xae, 0xc5, 0xd1, 0xc7, 0x93, 0xa3,\n\t\t0x8e, 0xb0, 0xb9, 0xad, 0x00, 0x98, 0x00, 0x86,\n\t\t0x00, 0xaf,\n\t}, {\n\t\t0xfa, 0x01, 0x43, 0x14, 0x45, 0xb4, 0xbf, 0xaf,\n\t\t0xad, 0xc1, 0xab, 0xc3, 0xd0, 0xc6, 0x94, 0xa3,\n\t\t0x8f, 0xaf, 0xb8, 0xac, 0x00, 0x9a, 0x00, 0x89,\n\t\t0x00, 0xb2,\n\t}, {\n\t\t0xfa, 0x01, 0x43, 0x14, 0x45, 0xb0, 0xbc, 0xac,\n\t\t0xaf, 0xc2, 0xad, 0xc2, 0xcf, 0xc4, 0x94, 0xa3,\n\t\t0x90, 0xaf, 0xb8, 0xad, 0x00, 0x9c, 0x00, 0x8b,\n\t\t0x00, 0xb5,\n\t}, {\n\t\t0xfa, 0x01, 0x43, 0x14, 0x45, 0xad, 0xb9, 0xa7,\n\t\t0xb1, 0xc4, 0xaf, 0xc3, 0xcf, 0xc5, 0x94, 0xa3,\n\t\t0x8f, 0xae, 0xb7, 0xac, 0x00, 0x9f, 0x00, 0x8e,\n\t\t0x00, 0xb8,\n\t}, {\n\t\t0xfa, 0x01, 0x43, 0x14, 0x45, 0xad, 0xb9, 0xa7,\n\t\t0xaf, 0xc2, 0xad, 0xc1, 0xce, 0xc3, 0x95, 0xa3,\n\t\t0x90, 0xad, 0xb6, 0xab, 0x00, 0xa2, 0x00, 0x91,\n\t\t0x00, 0xbb,\n\t}, {\n\t\t0xfa, 0x01, 0x43, 0x14, 0x45, 0xb1, 0xbe, 0xac,\n\t\t0xb1, 0xc4, 0xaf, 0xc1, 0xcd, 0xc1, 0x95, 0xa4,\n\t\t0x91, 0xad, 0xb6, 0xab, 0x00, 0xa4, 0x00, 0x93,\n\t\t0x00, 0xbd,\n\t}, {\n\t\t0xfa, 0x01, 0x43, 0x14, 0x45, 0xad, 0xbb, 0xa8,\n\t\t0xb3, 0xc5, 0xb2, 0xc1, 0xcd, 0xc2, 0x95, 0xa3,\n\t\t0x90, 0xad, 0xb6, 0xab, 0x00, 0xa6, 0x00, 0x95,\n\t\t0x00, 0xc0,\n\t}, {\n\t\t0xfa, 0x01, 0x43, 0x14, 0x45, 0xad, 0xbb, 0xa8,\n\t\t0xb0, 0xc3, 0xaf, 0xc2, 0xce, 0xc2, 0x94, 0xa2,\n\t\t0x90, 0xac, 0xb6, 0xab, 0x00, 0xa8, 0x00, 0x98,\n\t\t0x00, 0xc3,\n\t}, {\n\t\t0xfa, 0x01, 0x43, 0x14, 0x45, 0xa9, 0xb8, 0xa5,\n\t\t0xb3, 0xc5, 0xb2, 0xc1, 0xcc, 0xc0, 0x95, 0xa2,\n\t\t0x90, 0xad, 0xb6, 0xab, 0x00, 0xaa, 0x00, 0x9a,\n\t\t0x00, 0xc5,\n\t}, {\n\t\t0xfa, 0x01, 0x43, 0x14, 0x45, 0xb0, 0xc0, 0xac,\n\t\t0xb0, 0xc3, 0xaf, 0xc1, 0xcd, 0xc1, 0x95, 0xa2,\n\t\t0x90, 0xac, 0xb5, 0xa9, 0x00, 0xac, 0x00, 0x9c,\n\t\t0x00, 0xc8,\n\t}, {\n\t\t0xfa, 0x01, 0x43, 0x14, 0x45, 0xad, 0xbd, 0xa8,\n\t\t0xaf, 0xc2, 0xaf, 0xc1, 0xcc, 0xc0, 0x95, 0xa2,\n\t\t0x90, 0xac, 0xb5, 0xaa, 0x00, 0xb1, 0x00, 0xa1,\n\t\t0x00, 0xcc,\n\t},\n};\n\nstatic const struct s6e8aa0_variant s6e8aa0_variants[] = {\n\t{\n\t\t.version = 32,\n\t\t.gamma_tables = s6e8aa0_gamma_tables_v32,\n\t}, {\n\t\t.version = 96,\n\t\t.gamma_tables = s6e8aa0_gamma_tables_v96,\n\t}, {\n\t\t.version = 142,\n\t\t.gamma_tables = s6e8aa0_gamma_tables_v142,\n\t}, {\n\t\t.version = 210,\n\t\t.gamma_tables = s6e8aa0_gamma_tables_v142,\n\t}\n};\n\nstatic void s6e8aa0_brightness_set(struct s6e8aa0 *ctx)\n{\n\tconst u8 *gamma;\n\n\tif (ctx->error)\n\t\treturn;\n\n\tgamma = ctx->variant->gamma_tables[ctx->brightness];\n\n\tif (ctx->version >= 142)\n\t\ts6e8aa0_elvss_nvm_set(ctx);\n\n\ts6e8aa0_dcs_write(ctx, gamma, GAMMA_TABLE_LEN);\n\n\t \n\ts6e8aa0_dcs_write_seq_static(ctx, 0xf7, 0x03);\n}\n\nstatic void s6e8aa0_panel_init(struct s6e8aa0 *ctx)\n{\n\ts6e8aa0_apply_level_1_key(ctx);\n\ts6e8aa0_apply_level_2_key(ctx);\n\tmsleep(20);\n\n\ts6e8aa0_dcs_write_seq_static(ctx, MIPI_DCS_EXIT_SLEEP_MODE);\n\tmsleep(40);\n\n\ts6e8aa0_panel_cond_set(ctx);\n\ts6e8aa0_display_condition_set(ctx);\n\ts6e8aa0_brightness_set(ctx);\n\ts6e8aa0_etc_source_control(ctx);\n\ts6e8aa0_etc_pentile_control(ctx);\n\ts6e8aa0_elvss_nvm_set(ctx);\n\ts6e8aa0_etc_power_control(ctx);\n\ts6e8aa0_etc_elvss_control(ctx);\n\tmsleep(ctx->init_delay);\n}\n\nstatic void s6e8aa0_set_maximum_return_packet_size(struct s6e8aa0 *ctx,\n\t\t\t\t\t\t   u16 size)\n{\n\tstruct mipi_dsi_device *dsi = to_mipi_dsi_device(ctx->dev);\n\tint ret;\n\n\tif (ctx->error < 0)\n\t\treturn;\n\n\tret = mipi_dsi_set_maximum_return_packet_size(dsi, size);\n\tif (ret < 0) {\n\t\tdev_err(ctx->dev,\n\t\t\t\"error %d setting maximum return packet size to %d\\n\",\n\t\t\tret, size);\n\t\tctx->error = ret;\n\t}\n}\n\nstatic void s6e8aa0_read_mtp_id(struct s6e8aa0 *ctx)\n{\n\tu8 id[3];\n\tint ret, i;\n\n\tret = s6e8aa0_dcs_read(ctx, 0xd1, id, ARRAY_SIZE(id));\n\tif (ret < 0 || ret < ARRAY_SIZE(id) || id[0] == 0x00) {\n\t\tdev_err(ctx->dev, \"read id failed\\n\");\n\t\tctx->error = -EIO;\n\t\treturn;\n\t}\n\n\tdev_info(ctx->dev, \"ID: 0x%2x, 0x%2x, 0x%2x\\n\", id[0], id[1], id[2]);\n\n\tfor (i = 0; i < ARRAY_SIZE(s6e8aa0_variants); ++i) {\n\t\tif (id[1] == s6e8aa0_variants[i].version)\n\t\t\tbreak;\n\t}\n\tif (i >= ARRAY_SIZE(s6e8aa0_variants)) {\n\t\tdev_err(ctx->dev, \"unsupported display version %d\\n\", id[1]);\n\t\tctx->error = -EINVAL;\n\t\treturn;\n\t}\n\n\tctx->variant = &s6e8aa0_variants[i];\n\tctx->version = id[1];\n\tctx->id = id[2];\n}\n\nstatic void s6e8aa0_set_sequence(struct s6e8aa0 *ctx)\n{\n\ts6e8aa0_set_maximum_return_packet_size(ctx, 3);\n\ts6e8aa0_read_mtp_id(ctx);\n\ts6e8aa0_panel_init(ctx);\n\ts6e8aa0_dcs_write_seq_static(ctx, MIPI_DCS_SET_DISPLAY_ON);\n}\n\nstatic int s6e8aa0_power_on(struct s6e8aa0 *ctx)\n{\n\tint ret;\n\n\tret = regulator_bulk_enable(ARRAY_SIZE(ctx->supplies), ctx->supplies);\n\tif (ret < 0)\n\t\treturn ret;\n\n\tmsleep(ctx->power_on_delay);\n\n\tgpiod_set_value(ctx->reset_gpio, 0);\n\tusleep_range(10000, 11000);\n\tgpiod_set_value(ctx->reset_gpio, 1);\n\n\tmsleep(ctx->reset_delay);\n\n\treturn 0;\n}\n\nstatic int s6e8aa0_power_off(struct s6e8aa0 *ctx)\n{\n\treturn regulator_bulk_disable(ARRAY_SIZE(ctx->supplies), ctx->supplies);\n}\n\nstatic int s6e8aa0_disable(struct drm_panel *panel)\n{\n\treturn 0;\n}\n\nstatic int s6e8aa0_unprepare(struct drm_panel *panel)\n{\n\tstruct s6e8aa0 *ctx = panel_to_s6e8aa0(panel);\n\n\ts6e8aa0_dcs_write_seq_static(ctx, MIPI_DCS_ENTER_SLEEP_MODE);\n\ts6e8aa0_dcs_write_seq_static(ctx, MIPI_DCS_SET_DISPLAY_OFF);\n\tmsleep(40);\n\n\ts6e8aa0_clear_error(ctx);\n\n\treturn s6e8aa0_power_off(ctx);\n}\n\nstatic int s6e8aa0_prepare(struct drm_panel *panel)\n{\n\tstruct s6e8aa0 *ctx = panel_to_s6e8aa0(panel);\n\tint ret;\n\n\tret = s6e8aa0_power_on(ctx);\n\tif (ret < 0)\n\t\treturn ret;\n\n\ts6e8aa0_set_sequence(ctx);\n\tret = ctx->error;\n\n\tif (ret < 0)\n\t\ts6e8aa0_unprepare(panel);\n\n\treturn ret;\n}\n\nstatic int s6e8aa0_enable(struct drm_panel *panel)\n{\n\treturn 0;\n}\n\nstatic int s6e8aa0_get_modes(struct drm_panel *panel,\n\t\t\t     struct drm_connector *connector)\n{\n\tstruct s6e8aa0 *ctx = panel_to_s6e8aa0(panel);\n\tstruct drm_display_mode *mode;\n\n\tmode = drm_mode_create(connector->dev);\n\tif (!mode) {\n\t\tdev_err(panel->dev, \"failed to create a new display mode\\n\");\n\t\treturn 0;\n\t}\n\n\tdrm_display_mode_from_videomode(&ctx->vm, mode);\n\tmode->width_mm = ctx->width_mm;\n\tmode->height_mm = ctx->height_mm;\n\tconnector->display_info.width_mm = mode->width_mm;\n\tconnector->display_info.height_mm = mode->height_mm;\n\n\tmode->type = DRM_MODE_TYPE_DRIVER | DRM_MODE_TYPE_PREFERRED;\n\tdrm_mode_probed_add(connector, mode);\n\n\treturn 1;\n}\n\nstatic const struct drm_panel_funcs s6e8aa0_drm_funcs = {\n\t.disable = s6e8aa0_disable,\n\t.unprepare = s6e8aa0_unprepare,\n\t.prepare = s6e8aa0_prepare,\n\t.enable = s6e8aa0_enable,\n\t.get_modes = s6e8aa0_get_modes,\n};\n\nstatic int s6e8aa0_parse_dt(struct s6e8aa0 *ctx)\n{\n\tstruct device *dev = ctx->dev;\n\tstruct device_node *np = dev->of_node;\n\tint ret;\n\n\tret = of_get_videomode(np, &ctx->vm, 0);\n\tif (ret < 0)\n\t\treturn ret;\n\n\tof_property_read_u32(np, \"power-on-delay\", &ctx->power_on_delay);\n\tof_property_read_u32(np, \"reset-delay\", &ctx->reset_delay);\n\tof_property_read_u32(np, \"init-delay\", &ctx->init_delay);\n\tof_property_read_u32(np, \"panel-width-mm\", &ctx->width_mm);\n\tof_property_read_u32(np, \"panel-height-mm\", &ctx->height_mm);\n\n\tctx->flip_horizontal = of_property_read_bool(np, \"flip-horizontal\");\n\tctx->flip_vertical = of_property_read_bool(np, \"flip-vertical\");\n\n\treturn 0;\n}\n\nstatic int s6e8aa0_probe(struct mipi_dsi_device *dsi)\n{\n\tstruct device *dev = &dsi->dev;\n\tstruct s6e8aa0 *ctx;\n\tint ret;\n\n\tctx = devm_kzalloc(dev, sizeof(struct s6e8aa0), GFP_KERNEL);\n\tif (!ctx)\n\t\treturn -ENOMEM;\n\n\tmipi_dsi_set_drvdata(dsi, ctx);\n\n\tctx->dev = dev;\n\n\tdsi->lanes = 4;\n\tdsi->format = MIPI_DSI_FMT_RGB888;\n\tdsi->mode_flags = MIPI_DSI_MODE_VIDEO | MIPI_DSI_MODE_VIDEO_BURST\n\t\t| MIPI_DSI_MODE_VSYNC_FLUSH | MIPI_DSI_MODE_VIDEO_AUTO_VERT;\n\n\tret = s6e8aa0_parse_dt(ctx);\n\tif (ret < 0)\n\t\treturn ret;\n\n\tctx->supplies[0].supply = \"vdd3\";\n\tctx->supplies[1].supply = \"vci\";\n\tret = devm_regulator_bulk_get(dev, ARRAY_SIZE(ctx->supplies),\n\t\t\t\t      ctx->supplies);\n\tif (ret < 0) {\n\t\tdev_err(dev, \"failed to get regulators: %d\\n\", ret);\n\t\treturn ret;\n\t}\n\n\tctx->reset_gpio = devm_gpiod_get(dev, \"reset\", GPIOD_OUT_HIGH);\n\tif (IS_ERR(ctx->reset_gpio)) {\n\t\tdev_err(dev, \"cannot get reset-gpios %ld\\n\",\n\t\t\tPTR_ERR(ctx->reset_gpio));\n\t\treturn PTR_ERR(ctx->reset_gpio);\n\t}\n\n\tctx->brightness = GAMMA_LEVEL_NUM - 1;\n\n\tdrm_panel_init(&ctx->panel, dev, &s6e8aa0_drm_funcs,\n\t\t       DRM_MODE_CONNECTOR_DSI);\n\tctx->panel.prepare_prev_first = true;\n\n\tdrm_panel_add(&ctx->panel);\n\n\tret = mipi_dsi_attach(dsi);\n\tif (ret < 0)\n\t\tdrm_panel_remove(&ctx->panel);\n\n\treturn ret;\n}\n\nstatic void s6e8aa0_remove(struct mipi_dsi_device *dsi)\n{\n\tstruct s6e8aa0 *ctx = mipi_dsi_get_drvdata(dsi);\n\n\tmipi_dsi_detach(dsi);\n\tdrm_panel_remove(&ctx->panel);\n}\n\nstatic const struct of_device_id s6e8aa0_of_match[] = {\n\t{ .compatible = \"samsung,s6e8aa0\" },\n\t{ }\n};\nMODULE_DEVICE_TABLE(of, s6e8aa0_of_match);\n\nstatic struct mipi_dsi_driver s6e8aa0_driver = {\n\t.probe = s6e8aa0_probe,\n\t.remove = s6e8aa0_remove,\n\t.driver = {\n\t\t.name = \"panel-samsung-s6e8aa0\",\n\t\t.of_match_table = s6e8aa0_of_match,\n\t},\n};\nmodule_mipi_dsi_driver(s6e8aa0_driver);\n\nMODULE_AUTHOR(\"Donghwa Lee <dh09.lee@samsung.com>\");\nMODULE_AUTHOR(\"Inki Dae <inki.dae@samsung.com>\");\nMODULE_AUTHOR(\"Joongmock Shin <jmock.shin@samsung.com>\");\nMODULE_AUTHOR(\"Eunchul Kim <chulspro.kim@samsung.com>\");\nMODULE_AUTHOR(\"Tomasz Figa <t.figa@samsung.com>\");\nMODULE_AUTHOR(\"Andrzej Hajda <a.hajda@samsung.com>\");\nMODULE_DESCRIPTION(\"MIPI-DSI based s6e8aa0 AMOLED LCD Panel Driver\");\nMODULE_LICENSE(\"GPL v2\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}