{
  "module_name": "drm.h",
  "hash_id": "6477e2405103b725035a12145ac2dbe97cce0a7884b689236f2bfdf46ff1682d",
  "original_prompt": "Ingested from linux-6.6.14/drivers/gpu/drm/tegra/drm.h",
  "human_readable_source": " \n \n\n#ifndef HOST1X_DRM_H\n#define HOST1X_DRM_H 1\n\n#include <linux/host1x.h>\n#include <linux/iova.h>\n#include <linux/gpio/consumer.h>\n\n#include <drm/drm_atomic.h>\n#include <drm/drm_bridge.h>\n#include <drm/drm_edid.h>\n#include <drm/drm_encoder.h>\n#include <drm/drm_fixed.h>\n#include <drm/drm_probe_helper.h>\n#include <uapi/drm/tegra_drm.h>\n\n#include \"gem.h\"\n#include \"hub.h\"\n#include \"trace.h\"\n\n \n#define DRM_FORMAT_MOD_NVIDIA_SECTOR_LAYOUT BIT_ULL(22)\n\nstruct reset_control;\n\nstruct tegra_drm {\n\tstruct drm_device *drm;\n\n\tstruct iommu_domain *domain;\n\tbool use_explicit_iommu;\n\tstruct mutex mm_lock;\n\tstruct drm_mm mm;\n\n\tstruct {\n\t\tstruct iova_domain domain;\n\t\tunsigned long shift;\n\t\tunsigned long limit;\n\t} carveout;\n\n\tstruct mutex clients_lock;\n\tstruct list_head clients;\n\n\tunsigned int hmask, vmask;\n\tunsigned int pitch_align;\n\tunsigned int num_crtcs;\n\n\tstruct tegra_display_hub *hub;\n};\n\nstatic inline struct host1x *tegra_drm_to_host1x(struct tegra_drm *tegra)\n{\n\treturn dev_get_drvdata(tegra->drm->dev->parent);\n}\n\nstruct tegra_drm_client;\n\nstruct tegra_drm_context {\n\tstruct tegra_drm_client *client;\n\tstruct host1x_channel *channel;\n\n\t \n\tunsigned int id;\n\n\t \n\tstruct xarray mappings;\n\tstruct host1x_memory_context *memory_context;\n};\n\nstruct tegra_drm_client_ops {\n\tint (*open_channel)(struct tegra_drm_client *client,\n\t\t\t    struct tegra_drm_context *context);\n\tvoid (*close_channel)(struct tegra_drm_context *context);\n\tint (*is_addr_reg)(struct device *dev, u32 class, u32 offset);\n\tint (*is_valid_class)(u32 class);\n\tint (*submit)(struct tegra_drm_context *context,\n\t\t      struct drm_tegra_submit *args, struct drm_device *drm,\n\t\t      struct drm_file *file);\n\tint (*get_streamid_offset)(struct tegra_drm_client *client, u32 *offset);\n\tint (*can_use_memory_ctx)(struct tegra_drm_client *client, bool *supported);\n};\n\nint tegra_drm_submit(struct tegra_drm_context *context,\n\t\t     struct drm_tegra_submit *args, struct drm_device *drm,\n\t\t     struct drm_file *file);\n\nstatic inline int\ntegra_drm_get_streamid_offset_thi(struct tegra_drm_client *client, u32 *offset)\n{\n\t*offset = 0x30;\n\n\treturn 0;\n}\n\nstruct tegra_drm_client {\n\tstruct host1x_client base;\n\tstruct list_head list;\n\tstruct tegra_drm *drm;\n\tstruct host1x_channel *shared_channel;\n\n\t \n\tunsigned int version;\n\tconst struct tegra_drm_client_ops *ops;\n};\n\nstatic inline struct tegra_drm_client *\nhost1x_to_drm_client(struct host1x_client *client)\n{\n\treturn container_of(client, struct tegra_drm_client, base);\n}\n\nint tegra_drm_register_client(struct tegra_drm *tegra,\n\t\t\t      struct tegra_drm_client *client);\nint tegra_drm_unregister_client(struct tegra_drm *tegra,\n\t\t\t\tstruct tegra_drm_client *client);\nint host1x_client_iommu_attach(struct host1x_client *client);\nvoid host1x_client_iommu_detach(struct host1x_client *client);\n\nint tegra_drm_init(struct tegra_drm *tegra, struct drm_device *drm);\nint tegra_drm_exit(struct tegra_drm *tegra);\n\nvoid *tegra_drm_alloc(struct tegra_drm *tegra, size_t size, dma_addr_t *iova);\nvoid tegra_drm_free(struct tegra_drm *tegra, size_t size, void *virt,\n\t\t    dma_addr_t iova);\n\nstruct cec_notifier;\n\nstruct tegra_output {\n\tstruct device_node *of_node;\n\tstruct device *dev;\n\n\tstruct drm_bridge *bridge;\n\tstruct drm_panel *panel;\n\tstruct i2c_adapter *ddc;\n\tconst struct edid *edid;\n\tstruct cec_notifier *cec;\n\tunsigned int hpd_irq;\n\tstruct gpio_desc *hpd_gpio;\n\n\tstruct drm_encoder encoder;\n\tstruct drm_connector connector;\n};\n\nstatic inline struct tegra_output *encoder_to_output(struct drm_encoder *e)\n{\n\treturn container_of(e, struct tegra_output, encoder);\n}\n\nstatic inline struct tegra_output *connector_to_output(struct drm_connector *c)\n{\n\treturn container_of(c, struct tegra_output, connector);\n}\n\n \nint tegra_output_probe(struct tegra_output *output);\nvoid tegra_output_remove(struct tegra_output *output);\nint tegra_output_init(struct drm_device *drm, struct tegra_output *output);\nvoid tegra_output_exit(struct tegra_output *output);\nvoid tegra_output_find_possible_crtcs(struct tegra_output *output,\n\t\t\t\t      struct drm_device *drm);\nint tegra_output_suspend(struct tegra_output *output);\nint tegra_output_resume(struct tegra_output *output);\n\nint tegra_output_connector_get_modes(struct drm_connector *connector);\nenum drm_connector_status\ntegra_output_connector_detect(struct drm_connector *connector, bool force);\nvoid tegra_output_connector_destroy(struct drm_connector *connector);\n\n \nstruct drm_dp_aux *drm_dp_aux_find_by_of_node(struct device_node *np);\nenum drm_connector_status drm_dp_aux_detect(struct drm_dp_aux *aux);\nint drm_dp_aux_attach(struct drm_dp_aux *aux, struct tegra_output *output);\nint drm_dp_aux_detach(struct drm_dp_aux *aux);\nint drm_dp_aux_enable(struct drm_dp_aux *aux);\nint drm_dp_aux_disable(struct drm_dp_aux *aux);\n\n \nstruct tegra_bo *tegra_fb_get_plane(struct drm_framebuffer *framebuffer,\n\t\t\t\t    unsigned int index);\nbool tegra_fb_is_bottom_up(struct drm_framebuffer *framebuffer);\nint tegra_fb_get_tiling(struct drm_framebuffer *framebuffer,\n\t\t\tstruct tegra_bo_tiling *tiling);\nstruct drm_framebuffer *tegra_fb_alloc(struct drm_device *drm,\n\t\t\t\t       const struct drm_mode_fb_cmd2 *mode_cmd,\n\t\t\t\t       struct tegra_bo **planes,\n\t\t\t\t       unsigned int num_planes);\nstruct drm_framebuffer *tegra_fb_create(struct drm_device *drm,\n\t\t\t\t\tstruct drm_file *file,\n\t\t\t\t\tconst struct drm_mode_fb_cmd2 *cmd);\n\n#ifdef CONFIG_DRM_FBDEV_EMULATION\nvoid tegra_fbdev_setup(struct drm_device *drm);\n#else\nstatic inline void tegra_fbdev_setup(struct drm_device *drm)\n{ }\n#endif\n\nextern struct platform_driver tegra_display_hub_driver;\nextern struct platform_driver tegra_dc_driver;\nextern struct platform_driver tegra_hdmi_driver;\nextern struct platform_driver tegra_dsi_driver;\nextern struct platform_driver tegra_dpaux_driver;\nextern struct platform_driver tegra_sor_driver;\nextern struct platform_driver tegra_gr2d_driver;\nextern struct platform_driver tegra_gr3d_driver;\nextern struct platform_driver tegra_vic_driver;\nextern struct platform_driver tegra_nvdec_driver;\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}