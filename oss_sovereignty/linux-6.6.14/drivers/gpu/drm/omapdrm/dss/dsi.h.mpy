{
  "module_name": "dsi.h",
  "hash_id": "b2e81c19bed346de664bcdc84e51b2549ce891b81cc3273da3cda0f3826eb597",
  "original_prompt": "Ingested from linux-6.6.14/drivers/gpu/drm/omapdrm/dss/dsi.h",
  "human_readable_source": " \n \n\n#ifndef __OMAP_DRM_DSS_DSI_H\n#define __OMAP_DRM_DSS_DSI_H\n\n#include <drm/drm_mipi_dsi.h>\n\nstruct dsi_reg {\n\tu16 module;\n\tu16 idx;\n};\n\n#define DSI_REG(mod, idx)\t\t((const struct dsi_reg) { mod, idx })\n\n \n\n#define DSI_PROTO\t\t\t0\n#define DSI_PROTO_SZ\t\t\t0x200\n\n#define DSI_REVISION\t\t\tDSI_REG(DSI_PROTO, 0x0000)\n#define DSI_SYSCONFIG\t\t\tDSI_REG(DSI_PROTO, 0x0010)\n#define DSI_SYSSTATUS\t\t\tDSI_REG(DSI_PROTO, 0x0014)\n#define DSI_IRQSTATUS\t\t\tDSI_REG(DSI_PROTO, 0x0018)\n#define DSI_IRQENABLE\t\t\tDSI_REG(DSI_PROTO, 0x001C)\n#define DSI_CTRL\t\t\tDSI_REG(DSI_PROTO, 0x0040)\n#define DSI_GNQ\t\t\t\tDSI_REG(DSI_PROTO, 0x0044)\n#define DSI_COMPLEXIO_CFG1\t\tDSI_REG(DSI_PROTO, 0x0048)\n#define DSI_COMPLEXIO_IRQ_STATUS\tDSI_REG(DSI_PROTO, 0x004C)\n#define DSI_COMPLEXIO_IRQ_ENABLE\tDSI_REG(DSI_PROTO, 0x0050)\n#define DSI_CLK_CTRL\t\t\tDSI_REG(DSI_PROTO, 0x0054)\n#define DSI_TIMING1\t\t\tDSI_REG(DSI_PROTO, 0x0058)\n#define DSI_TIMING2\t\t\tDSI_REG(DSI_PROTO, 0x005C)\n#define DSI_VM_TIMING1\t\t\tDSI_REG(DSI_PROTO, 0x0060)\n#define DSI_VM_TIMING2\t\t\tDSI_REG(DSI_PROTO, 0x0064)\n#define DSI_VM_TIMING3\t\t\tDSI_REG(DSI_PROTO, 0x0068)\n#define DSI_CLK_TIMING\t\t\tDSI_REG(DSI_PROTO, 0x006C)\n#define DSI_TX_FIFO_VC_SIZE\t\tDSI_REG(DSI_PROTO, 0x0070)\n#define DSI_RX_FIFO_VC_SIZE\t\tDSI_REG(DSI_PROTO, 0x0074)\n#define DSI_COMPLEXIO_CFG2\t\tDSI_REG(DSI_PROTO, 0x0078)\n#define DSI_RX_FIFO_VC_FULLNESS\t\tDSI_REG(DSI_PROTO, 0x007C)\n#define DSI_VM_TIMING4\t\t\tDSI_REG(DSI_PROTO, 0x0080)\n#define DSI_TX_FIFO_VC_EMPTINESS\tDSI_REG(DSI_PROTO, 0x0084)\n#define DSI_VM_TIMING5\t\t\tDSI_REG(DSI_PROTO, 0x0088)\n#define DSI_VM_TIMING6\t\t\tDSI_REG(DSI_PROTO, 0x008C)\n#define DSI_VM_TIMING7\t\t\tDSI_REG(DSI_PROTO, 0x0090)\n#define DSI_STOPCLK_TIMING\t\tDSI_REG(DSI_PROTO, 0x0094)\n#define DSI_VC_CTRL(n)\t\t\tDSI_REG(DSI_PROTO, 0x0100 + (n * 0x20))\n#define DSI_VC_TE(n)\t\t\tDSI_REG(DSI_PROTO, 0x0104 + (n * 0x20))\n#define DSI_VC_LONG_PACKET_HEADER(n)\tDSI_REG(DSI_PROTO, 0x0108 + (n * 0x20))\n#define DSI_VC_LONG_PACKET_PAYLOAD(n)\tDSI_REG(DSI_PROTO, 0x010C + (n * 0x20))\n#define DSI_VC_SHORT_PACKET_HEADER(n)\tDSI_REG(DSI_PROTO, 0x0110 + (n * 0x20))\n#define DSI_VC_IRQSTATUS(n)\t\tDSI_REG(DSI_PROTO, 0x0118 + (n * 0x20))\n#define DSI_VC_IRQENABLE(n)\t\tDSI_REG(DSI_PROTO, 0x011C + (n * 0x20))\n\n \n\n#define DSI_PHY\t\t\t\t1\n#define DSI_PHY_OFFSET\t\t\t0x200\n#define DSI_PHY_SZ\t\t\t0x40\n\n#define DSI_DSIPHY_CFG0\t\t\tDSI_REG(DSI_PHY, 0x0000)\n#define DSI_DSIPHY_CFG1\t\t\tDSI_REG(DSI_PHY, 0x0004)\n#define DSI_DSIPHY_CFG2\t\t\tDSI_REG(DSI_PHY, 0x0008)\n#define DSI_DSIPHY_CFG5\t\t\tDSI_REG(DSI_PHY, 0x0014)\n#define DSI_DSIPHY_CFG10\t\tDSI_REG(DSI_PHY, 0x0028)\n\n \n\n#define DSI_PLL\t\t\t\t2\n#define DSI_PLL_OFFSET\t\t\t0x300\n#define DSI_PLL_SZ\t\t\t0x20\n\n#define DSI_PLL_CONTROL\t\t\tDSI_REG(DSI_PLL, 0x0000)\n#define DSI_PLL_STATUS\t\t\tDSI_REG(DSI_PLL, 0x0004)\n#define DSI_PLL_GO\t\t\tDSI_REG(DSI_PLL, 0x0008)\n#define DSI_PLL_CONFIGURATION1\t\tDSI_REG(DSI_PLL, 0x000C)\n#define DSI_PLL_CONFIGURATION2\t\tDSI_REG(DSI_PLL, 0x0010)\n\n \n#define DSI_IRQ_VC0\t\t(1 << 0)\n#define DSI_IRQ_VC1\t\t(1 << 1)\n#define DSI_IRQ_VC2\t\t(1 << 2)\n#define DSI_IRQ_VC3\t\t(1 << 3)\n#define DSI_IRQ_WAKEUP\t\t(1 << 4)\n#define DSI_IRQ_RESYNC\t\t(1 << 5)\n#define DSI_IRQ_PLL_LOCK\t(1 << 7)\n#define DSI_IRQ_PLL_UNLOCK\t(1 << 8)\n#define DSI_IRQ_PLL_RECALL\t(1 << 9)\n#define DSI_IRQ_COMPLEXIO_ERR\t(1 << 10)\n#define DSI_IRQ_HS_TX_TIMEOUT\t(1 << 14)\n#define DSI_IRQ_LP_RX_TIMEOUT\t(1 << 15)\n#define DSI_IRQ_TE_TRIGGER\t(1 << 16)\n#define DSI_IRQ_ACK_TRIGGER\t(1 << 17)\n#define DSI_IRQ_SYNC_LOST\t(1 << 18)\n#define DSI_IRQ_LDO_POWER_GOOD\t(1 << 19)\n#define DSI_IRQ_TA_TIMEOUT\t(1 << 20)\n#define DSI_IRQ_ERROR_MASK \\\n\t(DSI_IRQ_HS_TX_TIMEOUT | DSI_IRQ_LP_RX_TIMEOUT | DSI_IRQ_SYNC_LOST | \\\n\tDSI_IRQ_TA_TIMEOUT)\n#define DSI_IRQ_CHANNEL_MASK\t0xf\n\n \n#define DSI_VC_IRQ_CS\t\t(1 << 0)\n#define DSI_VC_IRQ_ECC_CORR\t(1 << 1)\n#define DSI_VC_IRQ_PACKET_SENT\t(1 << 2)\n#define DSI_VC_IRQ_FIFO_TX_OVF\t(1 << 3)\n#define DSI_VC_IRQ_FIFO_RX_OVF\t(1 << 4)\n#define DSI_VC_IRQ_BTA\t\t(1 << 5)\n#define DSI_VC_IRQ_ECC_NO_CORR\t(1 << 6)\n#define DSI_VC_IRQ_FIFO_TX_UDF\t(1 << 7)\n#define DSI_VC_IRQ_PP_BUSY_CHANGE (1 << 8)\n#define DSI_VC_IRQ_ERROR_MASK \\\n\t(DSI_VC_IRQ_CS | DSI_VC_IRQ_ECC_CORR | DSI_VC_IRQ_FIFO_TX_OVF | \\\n\tDSI_VC_IRQ_FIFO_RX_OVF | DSI_VC_IRQ_ECC_NO_CORR | \\\n\tDSI_VC_IRQ_FIFO_TX_UDF)\n\n \n#define DSI_CIO_IRQ_ERRSYNCESC1\t\t(1 << 0)\n#define DSI_CIO_IRQ_ERRSYNCESC2\t\t(1 << 1)\n#define DSI_CIO_IRQ_ERRSYNCESC3\t\t(1 << 2)\n#define DSI_CIO_IRQ_ERRSYNCESC4\t\t(1 << 3)\n#define DSI_CIO_IRQ_ERRSYNCESC5\t\t(1 << 4)\n#define DSI_CIO_IRQ_ERRESC1\t\t(1 << 5)\n#define DSI_CIO_IRQ_ERRESC2\t\t(1 << 6)\n#define DSI_CIO_IRQ_ERRESC3\t\t(1 << 7)\n#define DSI_CIO_IRQ_ERRESC4\t\t(1 << 8)\n#define DSI_CIO_IRQ_ERRESC5\t\t(1 << 9)\n#define DSI_CIO_IRQ_ERRCONTROL1\t\t(1 << 10)\n#define DSI_CIO_IRQ_ERRCONTROL2\t\t(1 << 11)\n#define DSI_CIO_IRQ_ERRCONTROL3\t\t(1 << 12)\n#define DSI_CIO_IRQ_ERRCONTROL4\t\t(1 << 13)\n#define DSI_CIO_IRQ_ERRCONTROL5\t\t(1 << 14)\n#define DSI_CIO_IRQ_STATEULPS1\t\t(1 << 15)\n#define DSI_CIO_IRQ_STATEULPS2\t\t(1 << 16)\n#define DSI_CIO_IRQ_STATEULPS3\t\t(1 << 17)\n#define DSI_CIO_IRQ_STATEULPS4\t\t(1 << 18)\n#define DSI_CIO_IRQ_STATEULPS5\t\t(1 << 19)\n#define DSI_CIO_IRQ_ERRCONTENTIONLP0_1\t(1 << 20)\n#define DSI_CIO_IRQ_ERRCONTENTIONLP1_1\t(1 << 21)\n#define DSI_CIO_IRQ_ERRCONTENTIONLP0_2\t(1 << 22)\n#define DSI_CIO_IRQ_ERRCONTENTIONLP1_2\t(1 << 23)\n#define DSI_CIO_IRQ_ERRCONTENTIONLP0_3\t(1 << 24)\n#define DSI_CIO_IRQ_ERRCONTENTIONLP1_3\t(1 << 25)\n#define DSI_CIO_IRQ_ERRCONTENTIONLP0_4\t(1 << 26)\n#define DSI_CIO_IRQ_ERRCONTENTIONLP1_4\t(1 << 27)\n#define DSI_CIO_IRQ_ERRCONTENTIONLP0_5\t(1 << 28)\n#define DSI_CIO_IRQ_ERRCONTENTIONLP1_5\t(1 << 29)\n#define DSI_CIO_IRQ_ULPSACTIVENOT_ALL0\t(1 << 30)\n#define DSI_CIO_IRQ_ULPSACTIVENOT_ALL1\t(1 << 31)\n#define DSI_CIO_IRQ_ERROR_MASK \\\n\t(DSI_CIO_IRQ_ERRSYNCESC1 | DSI_CIO_IRQ_ERRSYNCESC2 | \\\n\t DSI_CIO_IRQ_ERRSYNCESC3 | DSI_CIO_IRQ_ERRSYNCESC4 | \\\n\t DSI_CIO_IRQ_ERRSYNCESC5 | \\\n\t DSI_CIO_IRQ_ERRESC1 | DSI_CIO_IRQ_ERRESC2 | \\\n\t DSI_CIO_IRQ_ERRESC3 | DSI_CIO_IRQ_ERRESC4 | \\\n\t DSI_CIO_IRQ_ERRESC5 | \\\n\t DSI_CIO_IRQ_ERRCONTROL1 | DSI_CIO_IRQ_ERRCONTROL2 | \\\n\t DSI_CIO_IRQ_ERRCONTROL3 | DSI_CIO_IRQ_ERRCONTROL4 | \\\n\t DSI_CIO_IRQ_ERRCONTROL5 | \\\n\t DSI_CIO_IRQ_ERRCONTENTIONLP0_1 | DSI_CIO_IRQ_ERRCONTENTIONLP1_1 | \\\n\t DSI_CIO_IRQ_ERRCONTENTIONLP0_2 | DSI_CIO_IRQ_ERRCONTENTIONLP1_2 | \\\n\t DSI_CIO_IRQ_ERRCONTENTIONLP0_3 | DSI_CIO_IRQ_ERRCONTENTIONLP1_3 | \\\n\t DSI_CIO_IRQ_ERRCONTENTIONLP0_4 | DSI_CIO_IRQ_ERRCONTENTIONLP1_4 | \\\n\t DSI_CIO_IRQ_ERRCONTENTIONLP0_5 | DSI_CIO_IRQ_ERRCONTENTIONLP1_5)\n\nenum omap_dss_dsi_mode {\n\tOMAP_DSS_DSI_CMD_MODE = 0,\n\tOMAP_DSS_DSI_VIDEO_MODE,\n};\n\nenum omap_dss_dsi_trans_mode {\n\t \n\tOMAP_DSS_DSI_PULSE_MODE,\n\t \n\tOMAP_DSS_DSI_EVENT_MODE,\n\t \n\tOMAP_DSS_DSI_BURST_MODE,\n};\n\nstruct omap_dss_dsi_videomode_timings {\n\tunsigned long hsclk;\n\n\tunsigned int ndl;\n\tunsigned int bitspp;\n\n\t \n\tu16 hact;\n\t \n\tu16 vact;\n\n\t \n\t \n\tu16 hss;\n\tu16 hsa;\n\tu16 hse;\n\tu16 hfp;\n\tu16 hbp;\n\t \n\tu16 vsa;\n\tu16 vfp;\n\tu16 vbp;\n\n\t \n\tint blanking_mode;\n\tint hsa_blanking_mode;\n\tint hbp_blanking_mode;\n\tint hfp_blanking_mode;\n\n\tenum omap_dss_dsi_trans_mode trans_mode;\n\n\tint window_sync;\n};\n\nstruct omap_dss_dsi_config {\n\tenum omap_dss_dsi_mode mode;\n\tenum mipi_dsi_pixel_format pixel_format;\n\tconst struct videomode *vm;\n\n\tunsigned long hs_clk_min, hs_clk_max;\n\tunsigned long lp_clk_min, lp_clk_max;\n\n\tenum omap_dss_dsi_trans_mode trans_mode;\n};\n\n \n#define HSDIV_DISPC\t0\n#define HSDIV_DSI\t1\n\n#define DSI_MAX_NR_ISRS                2\n#define DSI_MAX_NR_LANES\t5\n\nenum dsi_model {\n\tDSI_MODEL_OMAP3,\n\tDSI_MODEL_OMAP4,\n\tDSI_MODEL_OMAP5,\n};\n\nenum dsi_lane_function {\n\tDSI_LANE_UNUSED\t= 0,\n\tDSI_LANE_CLK,\n\tDSI_LANE_DATA1,\n\tDSI_LANE_DATA2,\n\tDSI_LANE_DATA3,\n\tDSI_LANE_DATA4,\n};\n\nstruct dsi_lane_config {\n\tenum dsi_lane_function function;\n\tu8 polarity;\n};\n\ntypedef void (*omap_dsi_isr_t) (void *arg, u32 mask);\n\nstruct dsi_isr_data {\n\tomap_dsi_isr_t\tisr;\n\tvoid\t\t*arg;\n\tu32\t\tmask;\n};\n\nenum fifo_size {\n\tDSI_FIFO_SIZE_0\t\t= 0,\n\tDSI_FIFO_SIZE_32\t= 1,\n\tDSI_FIFO_SIZE_64\t= 2,\n\tDSI_FIFO_SIZE_96\t= 3,\n\tDSI_FIFO_SIZE_128\t= 4,\n};\n\nenum dsi_vc_source {\n\tDSI_VC_SOURCE_L4 = 0,\n\tDSI_VC_SOURCE_VP,\n};\n\nstruct dsi_irq_stats {\n\tunsigned long last_reset;\n\tunsigned int irq_count;\n\tunsigned int dsi_irqs[32];\n\tunsigned int vc_irqs[4][32];\n\tunsigned int cio_irqs[32];\n};\n\nstruct dsi_isr_tables {\n\tstruct dsi_isr_data isr_table[DSI_MAX_NR_ISRS];\n\tstruct dsi_isr_data isr_table_vc[4][DSI_MAX_NR_ISRS];\n\tstruct dsi_isr_data isr_table_cio[DSI_MAX_NR_ISRS];\n};\n\nstruct dsi_lp_clock_info {\n\tunsigned long lp_clk;\n\tu16 lp_clk_div;\n};\n\nstruct dsi_clk_calc_ctx {\n\tstruct dsi_data *dsi;\n\tstruct dss_pll *pll;\n\n\t \n\n\tconst struct omap_dss_dsi_config *config;\n\n\tunsigned long req_pck_min, req_pck_nom, req_pck_max;\n\n\t \n\n\tstruct dss_pll_clock_info dsi_cinfo;\n\tstruct dispc_clock_info dispc_cinfo;\n\tstruct dsi_lp_clock_info lp_cinfo;\n\n\tstruct videomode vm;\n\tstruct omap_dss_dsi_videomode_timings dsi_vm;\n};\n\nstruct dsi_module_id_data {\n\tu32 address;\n\tint id;\n};\n\nenum dsi_quirks {\n\tDSI_QUIRK_PLL_PWR_BUG = (1 << 0),\t \n\tDSI_QUIRK_DCS_CMD_CONFIG_VC = (1 << 1),\n\tDSI_QUIRK_VC_OCP_WIDTH = (1 << 2),\n\tDSI_QUIRK_REVERSE_TXCLKESC = (1 << 3),\n\tDSI_QUIRK_GNQ = (1 << 4),\n\tDSI_QUIRK_PHY_DCC = (1 << 5),\n};\n\nstruct dsi_of_data {\n\tenum dsi_model model;\n\tconst struct dss_pll_hw *pll_hw;\n\tconst struct dsi_module_id_data *modules;\n\tunsigned int max_fck_freq;\n\tunsigned int max_pll_lpdiv;\n\tenum dsi_quirks quirks;\n};\n\nstruct dsi_data {\n\tstruct device *dev;\n\tvoid __iomem *proto_base;\n\tvoid __iomem *phy_base;\n\tvoid __iomem *pll_base;\n\n\tconst struct dsi_of_data *data;\n\tint module_id;\n\n\tint irq;\n\n\tbool is_enabled;\n\n\tstruct clk *dss_clk;\n\tstruct regmap *syscon;\n\tstruct dss_device *dss;\n\n\tstruct mipi_dsi_host host;\n\n\tstruct dispc_clock_info user_dispc_cinfo;\n\tstruct dss_pll_clock_info user_dsi_cinfo;\n\n\tstruct dsi_lp_clock_info user_lp_cinfo;\n\tstruct dsi_lp_clock_info current_lp_cinfo;\n\n\tstruct dss_pll pll;\n\n\tbool vdds_dsi_enabled;\n\tstruct regulator *vdds_dsi_reg;\n\n\tstruct mipi_dsi_device *dsidev;\n\n\tstruct {\n\t\tenum dsi_vc_source source;\n\t\tenum fifo_size tx_fifo_size;\n\t\tenum fifo_size rx_fifo_size;\n\t} vc[4];\n\n\tstruct mutex lock;\n\tstruct semaphore bus_lock;\n\n\tspinlock_t irq_lock;\n\tstruct dsi_isr_tables isr_tables;\n\t \n\tstruct dsi_isr_tables isr_tables_copy;\n\n\tint update_vc;\n#ifdef DSI_PERF_MEASURE\n\tunsigned int update_bytes;\n#endif\n\n\t \n\tstruct gpio_desc *te_gpio;\n\tint te_irq;\n\tstruct delayed_work te_timeout_work;\n\tatomic_t do_ext_te_update;\n\n\tbool te_enabled;\n\tbool iface_enabled;\n\tbool video_enabled;\n\n\tstruct delayed_work framedone_timeout_work;\n\n#ifdef DSI_CATCH_MISSING_TE\n\tstruct timer_list te_timer;\n#endif\n\n\tunsigned long cache_req_pck;\n\tunsigned long cache_clk_freq;\n\tstruct dss_pll_clock_info cache_cinfo;\n\n\tu32\t\terrors;\n\tspinlock_t\terrors_lock;\n#ifdef DSI_PERF_MEASURE\n\tktime_t perf_setup_time;\n\tktime_t perf_start_time;\n#endif\n\tint debug_read;\n\tint debug_write;\n\tstruct {\n\t\tstruct dss_debugfs_entry *irqs;\n\t\tstruct dss_debugfs_entry *regs;\n\t\tstruct dss_debugfs_entry *clks;\n\t} debugfs;\n\n#ifdef CONFIG_OMAP2_DSS_COLLECT_IRQ_STATS\n\tspinlock_t irq_stats_lock;\n\tstruct dsi_irq_stats irq_stats;\n#endif\n\n\tunsigned int num_lanes_supported;\n\tunsigned int line_buffer_size;\n\n\tstruct dsi_lane_config lanes[DSI_MAX_NR_LANES];\n\tunsigned int num_lanes_used;\n\n\tunsigned int scp_clk_refcount;\n\n\tstruct omap_dss_dsi_config config;\n\n\tstruct dss_lcd_mgr_config mgr_config;\n\tstruct videomode vm;\n\tenum mipi_dsi_pixel_format pix_fmt;\n\tenum omap_dss_dsi_mode mode;\n\tstruct omap_dss_dsi_videomode_timings vm_timings;\n\n\tstruct omap_dss_device output;\n\tstruct drm_bridge bridge;\n\n\tstruct delayed_work dsi_disable_work;\n};\n\nstruct dsi_packet_sent_handler_data {\n\tstruct dsi_data *dsi;\n\tstruct completion *completion;\n};\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}