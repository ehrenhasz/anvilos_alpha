{
  "module_name": "sun4i_backend.h",
  "hash_id": "3894f5de769a5d63f839ae01c382d1c24f0d80164b3f61f67048d6b8f10f5fc0",
  "original_prompt": "Ingested from linux-6.6.14/drivers/gpu/drm/sun4i/sun4i_backend.h",
  "human_readable_source": " \n \n\n#ifndef _SUN4I_BACKEND_H_\n#define _SUN4I_BACKEND_H_\n\n#include <linux/clk.h>\n#include <linux/list.h>\n#include <linux/of.h>\n#include <linux/regmap.h>\n#include <linux/reset.h>\n\n#include \"sunxi_engine.h\"\n\n#define SUN4I_BACKEND_MODCTL_REG\t\t0x800\n#define SUN4I_BACKEND_MODCTL_LINE_SEL\t\t\tBIT(29)\n#define SUN4I_BACKEND_MODCTL_ITLMOD_EN\t\t\tBIT(28)\n#define SUN4I_BACKEND_MODCTL_OUT_SEL\t\t\tGENMASK(22, 20)\n#define SUN4I_BACKEND_MODCTL_OUT_LCD0\t\t\t\t(0 << 20)\n#define SUN4I_BACKEND_MODCTL_OUT_LCD1\t\t\t\t(1 << 20)\n#define SUN4I_BACKEND_MODCTL_OUT_FE0\t\t\t\t(6 << 20)\n#define SUN4I_BACKEND_MODCTL_OUT_FE1\t\t\t\t(7 << 20)\n#define SUN4I_BACKEND_MODCTL_HWC_EN\t\t\tBIT(16)\n#define SUN4I_BACKEND_MODCTL_LAY_EN(l)\t\t\tBIT(8 + l)\n#define SUN4I_BACKEND_MODCTL_OCSC_EN\t\t\tBIT(5)\n#define SUN4I_BACKEND_MODCTL_DFLK_EN\t\t\tBIT(4)\n#define SUN4I_BACKEND_MODCTL_DLP_START_CTL\t\tBIT(2)\n#define SUN4I_BACKEND_MODCTL_START_CTL\t\t\tBIT(1)\n#define SUN4I_BACKEND_MODCTL_DEBE_EN\t\t\tBIT(0)\n\n#define SUN4I_BACKEND_BACKCOLOR_REG\t\t0x804\n#define SUN4I_BACKEND_BACKCOLOR(r, g, b)\t\t(((r) << 16) | ((g) << 8) | (b))\n\n#define SUN4I_BACKEND_DISSIZE_REG\t\t0x808\n#define SUN4I_BACKEND_DISSIZE(w, h)\t\t\t(((((h) - 1) & 0xffff) << 16) | \\\n\t\t\t\t\t\t\t (((w) - 1) & 0xffff))\n\n#define SUN4I_BACKEND_LAYSIZE_REG(l)\t\t(0x810 + (0x4 * (l)))\n#define SUN4I_BACKEND_LAYSIZE(w, h)\t\t\t(((((h) - 1) & 0x1fff) << 16) | \\\n\t\t\t\t\t\t\t (((w) - 1) & 0x1fff))\n\n#define SUN4I_BACKEND_LAYCOOR_REG(l)\t\t(0x820 + (0x4 * (l)))\n#define SUN4I_BACKEND_LAYCOOR(x, y)\t\t\t((((u32)(y) & 0xffff) << 16) | \\\n\t\t\t\t\t\t\t ((u32)(x) & 0xffff))\n\n#define SUN4I_BACKEND_LAYLINEWIDTH_REG(l)\t(0x840 + (0x4 * (l)))\n\n#define SUN4I_BACKEND_LAYFB_L32ADD_REG(l)\t(0x850 + (0x4 * (l)))\n\n#define SUN4I_BACKEND_LAYFB_H4ADD_REG\t\t0x860\n#define SUN4I_BACKEND_LAYFB_H4ADD_MSK(l)\t\tGENMASK(3 + ((l) * 8), (l) * 8)\n#define SUN4I_BACKEND_LAYFB_H4ADD(l, val)\t\t((val) << ((l) * 8))\n\n#define SUN4I_BACKEND_REGBUFFCTL_REG\t\t0x870\n#define SUN4I_BACKEND_REGBUFFCTL_AUTOLOAD_DIS\t\tBIT(1)\n#define SUN4I_BACKEND_REGBUFFCTL_LOADCTL\t\tBIT(0)\n\n#define SUN4I_BACKEND_CKMAX_REG\t\t\t0x880\n#define SUN4I_BACKEND_CKMIN_REG\t\t\t0x884\n#define SUN4I_BACKEND_CKCFG_REG\t\t\t0x888\n#define SUN4I_BACKEND_ATTCTL_REG0(l)\t\t(0x890 + (0x4 * (l)))\n#define SUN4I_BACKEND_ATTCTL_REG0_LAY_GLBALPHA_MASK\tGENMASK(31, 24)\n#define SUN4I_BACKEND_ATTCTL_REG0_LAY_GLBALPHA(x)\t\t((x) << 24)\n#define SUN4I_BACKEND_ATTCTL_REG0_LAY_PIPESEL_MASK\tBIT(15)\n#define SUN4I_BACKEND_ATTCTL_REG0_LAY_PIPESEL(x)\t\t((x) << 15)\n#define SUN4I_BACKEND_ATTCTL_REG0_LAY_PRISEL_MASK\tGENMASK(11, 10)\n#define SUN4I_BACKEND_ATTCTL_REG0_LAY_PRISEL(x)\t\t\t((x) << 10)\n#define SUN4I_BACKEND_ATTCTL_REG0_LAY_YUVEN\t\tBIT(2)\n#define SUN4I_BACKEND_ATTCTL_REG0_LAY_VDOEN\t\tBIT(1)\n#define SUN4I_BACKEND_ATTCTL_REG0_LAY_GLBALPHA_EN\tBIT(0)\n\n#define SUN4I_BACKEND_ATTCTL_REG1(l)\t\t(0x8a0 + (0x4 * (l)))\n#define SUN4I_BACKEND_ATTCTL_REG1_LAY_HSCAFCT\t\tGENMASK(15, 14)\n#define SUN4I_BACKEND_ATTCTL_REG1_LAY_WSCAFCT\t\tGENMASK(13, 12)\n#define SUN4I_BACKEND_ATTCTL_REG1_LAY_FBFMT\t\tGENMASK(11, 8)\n#define SUN4I_BACKEND_LAY_FBFMT_1BPP\t\t\t\t(0 << 8)\n#define SUN4I_BACKEND_LAY_FBFMT_2BPP\t\t\t\t(1 << 8)\n#define SUN4I_BACKEND_LAY_FBFMT_4BPP\t\t\t\t(2 << 8)\n#define SUN4I_BACKEND_LAY_FBFMT_8BPP\t\t\t\t(3 << 8)\n#define SUN4I_BACKEND_LAY_FBFMT_RGB655\t\t\t\t(4 << 8)\n#define SUN4I_BACKEND_LAY_FBFMT_RGB565\t\t\t\t(5 << 8)\n#define SUN4I_BACKEND_LAY_FBFMT_RGB556\t\t\t\t(6 << 8)\n#define SUN4I_BACKEND_LAY_FBFMT_ARGB1555\t\t\t(7 << 8)\n#define SUN4I_BACKEND_LAY_FBFMT_RGBA5551\t\t\t(8 << 8)\n#define SUN4I_BACKEND_LAY_FBFMT_XRGB8888\t\t\t(9 << 8)\n#define SUN4I_BACKEND_LAY_FBFMT_ARGB8888\t\t\t(10 << 8)\n#define SUN4I_BACKEND_LAY_FBFMT_RGB888\t\t\t\t(11 << 8)\n#define SUN4I_BACKEND_LAY_FBFMT_ARGB4444\t\t\t(12 << 8)\n#define SUN4I_BACKEND_LAY_FBFMT_RGBA4444\t\t\t(13 << 8)\n\n#define SUN4I_BACKEND_DLCDPCTL_REG\t\t0x8b0\n#define SUN4I_BACKEND_DLCDPFRMBUF_ADDRCTL_REG\t0x8b4\n#define SUN4I_BACKEND_DLCDPCOOR_REG0\t\t0x8b8\n#define SUN4I_BACKEND_DLCDPCOOR_REG1\t\t0x8bc\n\n#define SUN4I_BACKEND_INT_EN_REG\t\t0x8c0\n#define SUN4I_BACKEND_INT_FLAG_REG\t\t0x8c4\n#define SUN4I_BACKEND_REG_LOAD_FINISHED\t\t\tBIT(1)\n\n#define SUN4I_BACKEND_HWCCTL_REG\t\t0x8d8\n#define SUN4I_BACKEND_HWCFBCTL_REG\t\t0x8e0\n#define SUN4I_BACKEND_WBCTL_REG\t\t\t0x8f0\n#define SUN4I_BACKEND_WBADD_REG\t\t\t0x8f4\n#define SUN4I_BACKEND_WBLINEWIDTH_REG\t\t0x8f8\n#define SUN4I_BACKEND_SPREN_REG\t\t\t0x900\n#define SUN4I_BACKEND_SPRFMTCTL_REG\t\t0x908\n#define SUN4I_BACKEND_SPRALPHACTL_REG\t\t0x90c\n\n#define SUN4I_BACKEND_IYUVCTL_REG\t\t0x920\n#define SUN4I_BACKEND_IYUVCTL_FBFMT_MASK\t\tGENMASK(14, 12)\n#define SUN4I_BACKEND_IYUVCTL_FBFMT_PACKED_YUV444\t\t(4 << 12)\n#define SUN4I_BACKEND_IYUVCTL_FBFMT_PACKED_YUV422\t\t(3 << 12)\n#define SUN4I_BACKEND_IYUVCTL_FBFMT_PLANAR_YUV444\t\t(2 << 12)\n#define SUN4I_BACKEND_IYUVCTL_FBFMT_PLANAR_YUV222\t\t(1 << 12)\n#define SUN4I_BACKEND_IYUVCTL_FBFMT_PLANAR_YUV111\t\t(0 << 12)\n#define SUN4I_BACKEND_IYUVCTL_FBPS_MASK\t\t\tGENMASK(9, 8)\n#define SUN4I_BACKEND_IYUVCTL_FBPS_YVYU\t\t\t\t(3 << 8)\n#define SUN4I_BACKEND_IYUVCTL_FBPS_VYUY\t\t\t\t(2 << 8)\n#define SUN4I_BACKEND_IYUVCTL_FBPS_YUYV\t\t\t\t(1 << 8)\n#define SUN4I_BACKEND_IYUVCTL_FBPS_UYVY\t\t\t\t(0 << 8)\n#define SUN4I_BACKEND_IYUVCTL_FBPS_VUYA\t\t\t\t(1 << 8)\n#define SUN4I_BACKEND_IYUVCTL_FBPS_AYUV\t\t\t\t(0 << 8)\n#define SUN4I_BACKEND_IYUVCTL_EN\t\t\tBIT(0)\n\n#define SUN4I_BACKEND_IYUVADD_REG(c)\t\t(0x930 + (0x4 * (c)))\n\n#define SUN4I_BACKEND_IYUVLINEWIDTH_REG(c)\t(0x940 + (0x4 * (c)))\n\n#define SUN4I_BACKEND_YGCOEF_REG(c)\t\t(0x950 + (0x4 * (c)))\n#define SUN4I_BACKEND_YGCONS_REG\t\t0x95c\n#define SUN4I_BACKEND_URCOEF_REG(c)\t\t(0x960 + (0x4 * (c)))\n#define SUN4I_BACKEND_URCONS_REG\t\t0x96c\n#define SUN4I_BACKEND_VBCOEF_REG(c)\t\t(0x970 + (0x4 * (c)))\n#define SUN4I_BACKEND_VBCONS_REG\t\t0x97c\n#define SUN4I_BACKEND_KSCTL_REG\t\t\t0x980\n#define SUN4I_BACKEND_KSBKCOLOR_REG\t\t0x984\n#define SUN4I_BACKEND_KSFSTLINEWIDTH_REG\t0x988\n#define SUN4I_BACKEND_KSVSCAFCT_REG\t\t0x98c\n#define SUN4I_BACKEND_KSHSCACOEF_REG(x)\t\t(0x9a0 + (0x4 * (x)))\n#define SUN4I_BACKEND_OCCTL_REG\t\t\t0x9c0\n#define SUN4I_BACKEND_OCCTL_ENABLE\t\t\tBIT(0)\n\n#define SUN4I_BACKEND_OCRCOEF_REG(x)\t\t(0x9d0 + (0x4 * (x)))\n#define SUN4I_BACKEND_OCRCONS_REG\t\t0x9dc\n#define SUN4I_BACKEND_OCGCOEF_REG(x)\t\t(0x9e0 + (0x4 * (x)))\n#define SUN4I_BACKEND_OCGCONS_REG\t\t0x9ec\n#define SUN4I_BACKEND_OCBCOEF_REG(x)\t\t(0x9f0 + (0x4 * (x)))\n#define SUN4I_BACKEND_OCBCONS_REG\t\t0x9fc\n#define SUN4I_BACKEND_SPRCOORCTL_REG(s)\t\t(0xa00 + (0x4 * (s)))\n#define SUN4I_BACKEND_SPRATTCTL_REG(s)\t\t(0xb00 + (0x4 * (s)))\n#define SUN4I_BACKEND_SPRADD_REG(s)\t\t(0xc00 + (0x4 * (s)))\n#define SUN4I_BACKEND_SPRLINEWIDTH_REG(s)\t(0xd00 + (0x4 * (s)))\n\n#define SUN4I_BACKEND_SPRPALTAB_OFF\t\t0x4000\n#define SUN4I_BACKEND_GAMMATAB_OFF\t\t0x4400\n#define SUN4I_BACKEND_HWCPATTERN_OFF\t\t0x4800\n#define SUN4I_BACKEND_HWCCOLORTAB_OFF\t\t0x4c00\n#define SUN4I_BACKEND_PIPE_OFF(p)\t\t(0x5000 + (0x400 * (p)))\n\n#define SUN4I_BACKEND_NUM_LAYERS\t\t4\n#define SUN4I_BACKEND_NUM_FRONTEND_LAYERS\t1\n#define SUN4I_BACKEND_NUM_YUV_PLANES\t\t1\n\nstruct sun4i_backend {\n\tstruct sunxi_engine\tengine;\n\tstruct sun4i_frontend\t*frontend;\n\n\tstruct reset_control\t*reset;\n\n\tstruct clk\t\t*bus_clk;\n\tstruct clk\t\t*mod_clk;\n\tstruct clk\t\t*ram_clk;\n\n\tstruct clk\t\t*sat_clk;\n\tstruct reset_control\t*sat_reset;\n\n\t \n\tspinlock_t\t\tfrontend_lock;\n\tbool\t\t\tfrontend_teardown;\n\n\tconst struct sun4i_backend_quirks\t*quirks;\n};\n\nstatic inline struct sun4i_backend *\nengine_to_sun4i_backend(struct sunxi_engine *engine)\n{\n\treturn container_of(engine, struct sun4i_backend, engine);\n}\n\nvoid sun4i_backend_layer_enable(struct sun4i_backend *backend,\n\t\t\t\tint layer, bool enable);\nbool sun4i_backend_format_is_supported(uint32_t fmt, uint64_t modifier);\nint sun4i_backend_update_layer_coord(struct sun4i_backend *backend,\n\t\t\t\t     int layer, struct drm_plane *plane);\nint sun4i_backend_update_layer_formats(struct sun4i_backend *backend,\n\t\t\t\t       int layer, struct drm_plane *plane);\nint sun4i_backend_update_layer_buffer(struct sun4i_backend *backend,\n\t\t\t\t      int layer, struct drm_plane *plane);\nint sun4i_backend_update_layer_frontend(struct sun4i_backend *backend,\n\t\t\t\t\tint layer, uint32_t in_fmt);\nint sun4i_backend_update_layer_zpos(struct sun4i_backend *backend,\n\t\t\t\t    int layer, struct drm_plane *plane);\nvoid sun4i_backend_cleanup_layer(struct sun4i_backend *backend,\n\t\t\t\t int layer);\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}