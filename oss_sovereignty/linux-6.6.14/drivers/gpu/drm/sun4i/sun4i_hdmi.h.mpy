{
  "module_name": "sun4i_hdmi.h",
  "hash_id": "2c14a33a87d91430fc505cd0b358d344d72ab2cca5955b09321c389c89ff1698",
  "original_prompt": "Ingested from linux-6.6.14/drivers/gpu/drm/sun4i/sun4i_hdmi.h",
  "human_readable_source": " \n \n\n#ifndef _SUN4I_HDMI_H_\n#define _SUN4I_HDMI_H_\n\n#include <drm/drm_connector.h>\n#include <drm/drm_encoder.h>\n#include <linux/regmap.h>\n\n#include <media/cec-pin.h>\n\n#define SUN4I_HDMI_CTRL_REG\t\t0x004\n#define SUN4I_HDMI_CTRL_ENABLE\t\t\tBIT(31)\n\n#define SUN4I_HDMI_IRQ_REG\t\t0x008\n#define SUN4I_HDMI_IRQ_STA_MASK\t\t\t0x73\n#define SUN4I_HDMI_IRQ_STA_FIFO_OF\t\tBIT(1)\n#define SUN4I_HDMI_IRQ_STA_FIFO_UF\t\tBIT(0)\n\n#define SUN4I_HDMI_HPD_REG\t\t0x00c\n#define SUN4I_HDMI_HPD_HIGH\t\t\tBIT(0)\n\n#define SUN4I_HDMI_VID_CTRL_REG\t\t0x010\n#define SUN4I_HDMI_VID_CTRL_ENABLE\t\tBIT(31)\n#define SUN4I_HDMI_VID_CTRL_HDMI_MODE\t\tBIT(30)\n\n#define SUN4I_HDMI_VID_TIMING_ACT_REG\t0x014\n#define SUN4I_HDMI_VID_TIMING_BP_REG\t0x018\n#define SUN4I_HDMI_VID_TIMING_FP_REG\t0x01c\n#define SUN4I_HDMI_VID_TIMING_SPW_REG\t0x020\n\n#define SUN4I_HDMI_VID_TIMING_X(x)\t\t((((x) - 1) & GENMASK(11, 0)))\n#define SUN4I_HDMI_VID_TIMING_Y(y)\t\t((((y) - 1) & GENMASK(11, 0)) << 16)\n\n#define SUN4I_HDMI_VID_TIMING_POL_REG\t0x024\n#define SUN4I_HDMI_VID_TIMING_POL_TX_CLK        (0x3e0 << 16)\n#define SUN4I_HDMI_VID_TIMING_POL_VSYNC\t\tBIT(1)\n#define SUN4I_HDMI_VID_TIMING_POL_HSYNC\t\tBIT(0)\n\n#define SUN4I_HDMI_AVI_INFOFRAME_REG(n)\t(0x080 + (n))\n\n#define SUN4I_HDMI_PAD_CTRL0_REG\t0x200\n#define SUN4I_HDMI_PAD_CTRL0_BIASEN\t\tBIT(31)\n#define SUN4I_HDMI_PAD_CTRL0_LDOCEN\t\tBIT(30)\n#define SUN4I_HDMI_PAD_CTRL0_LDODEN\t\tBIT(29)\n#define SUN4I_HDMI_PAD_CTRL0_PWENC\t\tBIT(28)\n#define SUN4I_HDMI_PAD_CTRL0_PWEND\t\tBIT(27)\n#define SUN4I_HDMI_PAD_CTRL0_PWENG\t\tBIT(26)\n#define SUN4I_HDMI_PAD_CTRL0_CKEN\t\tBIT(25)\n#define SUN4I_HDMI_PAD_CTRL0_TXEN\t\tBIT(23)\n\n#define SUN4I_HDMI_PAD_CTRL1_REG\t0x204\n#define SUN4I_HDMI_PAD_CTRL1_UNKNOWN\t\tBIT(24)\t \n#define SUN4I_HDMI_PAD_CTRL1_AMP_OPT\t\tBIT(23)\n#define SUN4I_HDMI_PAD_CTRL1_AMPCK_OPT\t\tBIT(22)\n#define SUN4I_HDMI_PAD_CTRL1_EMP_OPT\t\tBIT(20)\n#define SUN4I_HDMI_PAD_CTRL1_EMPCK_OPT\t\tBIT(19)\n#define SUN4I_HDMI_PAD_CTRL1_PWSCK\t\tBIT(18)\n#define SUN4I_HDMI_PAD_CTRL1_PWSDT\t\tBIT(17)\n#define SUN4I_HDMI_PAD_CTRL1_REG_DEN\t\tBIT(15)\n#define SUN4I_HDMI_PAD_CTRL1_REG_DENCK\t\tBIT(14)\n#define SUN4I_HDMI_PAD_CTRL1_REG_EMP(n)\t\t(((n) & 7) << 10)\n#define SUN4I_HDMI_PAD_CTRL1_HALVE_CLK\t\tBIT(6)\n#define SUN4I_HDMI_PAD_CTRL1_REG_AMP(n)\t\t(((n) & 7) << 3)\n\n \n#define SUN4I_HDMI_PAD_CTRL1_INVERT_R\t\tBIT(2)\n#define SUN4I_HDMI_PAD_CTRL1_INVERT_G\t\tBIT(1)\n#define SUN4I_HDMI_PAD_CTRL1_INVERT_B\t\tBIT(0)\n\n#define SUN4I_HDMI_PLL_CTRL_REG\t\t0x208\n#define SUN4I_HDMI_PLL_CTRL_PLL_EN\t\tBIT(31)\n#define SUN4I_HDMI_PLL_CTRL_BWS\t\t\tBIT(30)\n#define SUN4I_HDMI_PLL_CTRL_HV_IS_33\t\tBIT(29)\n#define SUN4I_HDMI_PLL_CTRL_LDO1_EN\t\tBIT(28)\n#define SUN4I_HDMI_PLL_CTRL_LDO2_EN\t\tBIT(27)\n#define SUN4I_HDMI_PLL_CTRL_SDIV2\t\tBIT(25)\n#define SUN4I_HDMI_PLL_CTRL_VCO_GAIN(n)\t\t(((n) & 7) << 20)\n#define SUN4I_HDMI_PLL_CTRL_S(n)\t\t(((n) & 7) << 17)\n#define SUN4I_HDMI_PLL_CTRL_CP_S(n)\t\t(((n) & 0x1f) << 12)\n#define SUN4I_HDMI_PLL_CTRL_CS(n)\t\t(((n) & 0xf) << 8)\n#define SUN4I_HDMI_PLL_CTRL_DIV(n)\t\t(((n) & 0xf) << 4)\n#define SUN4I_HDMI_PLL_CTRL_DIV_MASK\t\tGENMASK(7, 4)\n#define SUN4I_HDMI_PLL_CTRL_VCO_S(n)\t\t((n) & 0xf)\n\n#define SUN4I_HDMI_PLL_DBG0_REG\t\t0x20c\n#define SUN4I_HDMI_PLL_DBG0_TMDS_PARENT(n)\t(((n) & 1) << 21)\n#define SUN4I_HDMI_PLL_DBG0_TMDS_PARENT_MASK\tBIT(21)\n#define SUN4I_HDMI_PLL_DBG0_TMDS_PARENT_SHIFT\t21\n\n#define SUN4I_HDMI_CEC\t\t\t0x214\n#define SUN4I_HDMI_CEC_ENABLE\t\t\tBIT(11)\n#define SUN4I_HDMI_CEC_TX\t\t\tBIT(9)\n#define SUN4I_HDMI_CEC_RX\t\t\tBIT(8)\n\n#define SUN4I_HDMI_PKT_CTRL_REG(n)\t(0x2f0 + (4 * (n)))\n#define SUN4I_HDMI_PKT_CTRL_TYPE(n, t)\t\t((t) << (((n) % 4) * 4))\n\n#define SUN4I_HDMI_UNKNOWN_REG\t\t0x300\n#define SUN4I_HDMI_UNKNOWN_INPUT_SYNC\t\tBIT(27)\n\n#define SUN4I_HDMI_DDC_CTRL_REG\t\t0x500\n#define SUN4I_HDMI_DDC_CTRL_ENABLE\t\tBIT(31)\n#define SUN4I_HDMI_DDC_CTRL_START_CMD\t\tBIT(30)\n#define SUN4I_HDMI_DDC_CTRL_FIFO_DIR_MASK\tBIT(8)\n#define SUN4I_HDMI_DDC_CTRL_FIFO_DIR_WRITE\t(1 << 8)\n#define SUN4I_HDMI_DDC_CTRL_FIFO_DIR_READ\t(0 << 8)\n#define SUN4I_HDMI_DDC_CTRL_RESET\t\tBIT(0)\n\n#define SUN4I_HDMI_DDC_ADDR_REG\t\t0x504\n#define SUN4I_HDMI_DDC_ADDR_SEGMENT(seg)\t(((seg) & 0xff) << 24)\n#define SUN4I_HDMI_DDC_ADDR_EDDC(addr)\t\t(((addr) & 0xff) << 16)\n#define SUN4I_HDMI_DDC_ADDR_OFFSET(off)\t\t(((off) & 0xff) << 8)\n#define SUN4I_HDMI_DDC_ADDR_SLAVE(addr)\t\t((addr) & 0xff)\n\n#define SUN4I_HDMI_DDC_INT_STATUS_REG\t\t0x50c\n#define SUN4I_HDMI_DDC_INT_STATUS_ILLEGAL_FIFO_OPERATION\tBIT(7)\n#define SUN4I_HDMI_DDC_INT_STATUS_DDC_RX_FIFO_UNDERFLOW\t\tBIT(6)\n#define SUN4I_HDMI_DDC_INT_STATUS_DDC_TX_FIFO_OVERFLOW\t\tBIT(5)\n#define SUN4I_HDMI_DDC_INT_STATUS_FIFO_REQUEST\t\t\tBIT(4)\n#define SUN4I_HDMI_DDC_INT_STATUS_ARBITRATION_ERROR\t\tBIT(3)\n#define SUN4I_HDMI_DDC_INT_STATUS_ACK_ERROR\t\t\tBIT(2)\n#define SUN4I_HDMI_DDC_INT_STATUS_BUS_ERROR\t\t\tBIT(1)\n#define SUN4I_HDMI_DDC_INT_STATUS_TRANSFER_COMPLETE\t\tBIT(0)\n\n#define SUN4I_HDMI_DDC_FIFO_CTRL_REG\t0x510\n#define SUN4I_HDMI_DDC_FIFO_CTRL_CLEAR\t\tBIT(31)\n#define SUN4I_HDMI_DDC_FIFO_CTRL_RX_THRES(n)\t(((n) & 0xf) << 4)\n#define SUN4I_HDMI_DDC_FIFO_CTRL_RX_THRES_MASK\tGENMASK(7, 4)\n#define SUN4I_HDMI_DDC_FIFO_CTRL_RX_THRES_MAX\t(BIT(4) - 1)\n#define SUN4I_HDMI_DDC_FIFO_CTRL_TX_THRES(n)\t((n) & 0xf)\n#define SUN4I_HDMI_DDC_FIFO_CTRL_TX_THRES_MASK\tGENMASK(3, 0)\n#define SUN4I_HDMI_DDC_FIFO_CTRL_TX_THRES_MAX\t(BIT(4) - 1)\n\n#define SUN4I_HDMI_DDC_FIFO_DATA_REG\t0x518\n\n#define SUN4I_HDMI_DDC_BYTE_COUNT_REG\t0x51c\n#define SUN4I_HDMI_DDC_BYTE_COUNT_MAX\t\t(BIT(10) - 1)\n\n#define SUN4I_HDMI_DDC_CMD_REG\t\t0x520\n#define SUN4I_HDMI_DDC_CMD_EXPLICIT_EDDC_READ\t6\n#define SUN4I_HDMI_DDC_CMD_IMPLICIT_READ\t5\n#define SUN4I_HDMI_DDC_CMD_IMPLICIT_WRITE\t3\n\n#define SUN4I_HDMI_DDC_CLK_REG\t\t0x528\n#define SUN4I_HDMI_DDC_CLK_M(m)\t\t\t(((m) & 0xf) << 3)\n#define SUN4I_HDMI_DDC_CLK_N(n)\t\t\t((n) & 0x7)\n\n#define SUN4I_HDMI_DDC_LINE_CTRL_REG\t0x540\n#define SUN4I_HDMI_DDC_LINE_CTRL_SDA_ENABLE\tBIT(9)\n#define SUN4I_HDMI_DDC_LINE_CTRL_SCL_ENABLE\tBIT(8)\n\n#define SUN4I_HDMI_DDC_FIFO_SIZE\t16\n\n \n#define SUN6I_HDMI_DDC_CTRL_REG\t\t0x500\n#define SUN6I_HDMI_DDC_CTRL_RESET\t\tBIT(31)\n#define SUN6I_HDMI_DDC_CTRL_START_CMD\t\tBIT(27)\n#define SUN6I_HDMI_DDC_CTRL_SDA_ENABLE\t\tBIT(6)\n#define SUN6I_HDMI_DDC_CTRL_SCL_ENABLE\t\tBIT(4)\n#define SUN6I_HDMI_DDC_CTRL_ENABLE\t\tBIT(0)\n\n#define SUN6I_HDMI_DDC_CMD_REG\t\t0x508\n#define SUN6I_HDMI_DDC_CMD_BYTE_COUNT(count)\t((count) << 16)\n \n\n#define SUN6I_HDMI_DDC_ADDR_REG\t\t0x50c\n#define SUN6I_HDMI_DDC_ADDR_SEGMENT(seg)\t(((seg) & 0xff) << 24)\n#define SUN6I_HDMI_DDC_ADDR_EDDC(addr)\t\t(((addr) & 0xff) << 16)\n#define SUN6I_HDMI_DDC_ADDR_OFFSET(off)\t\t(((off) & 0xff) << 8)\n#define SUN6I_HDMI_DDC_ADDR_SLAVE(addr)\t\t(((addr) & 0xff) << 1)\n\n#define SUN6I_HDMI_DDC_INT_STATUS_REG\t0x514\n#define SUN6I_HDMI_DDC_INT_STATUS_TIMEOUT\tBIT(8)\n \n\n#define SUN6I_HDMI_DDC_FIFO_CTRL_REG\t0x518\n#define SUN6I_HDMI_DDC_FIFO_CTRL_CLEAR\t\tBIT(15)\n \n\n#define SUN6I_HDMI_DDC_CLK_REG\t\t0x520\n \n\n#define SUN6I_HDMI_DDC_FIFO_DATA_REG\t0x580\n\nenum sun4i_hdmi_pkt_type {\n\tSUN4I_HDMI_PKT_AVI = 2,\n\tSUN4I_HDMI_PKT_END = 15,\n};\n\nstruct sun4i_hdmi_variant {\n\tbool has_ddc_parent_clk;\n\tbool has_reset_control;\n\n\tu32 pad_ctrl0_init_val;\n\tu32 pad_ctrl1_init_val;\n\tu32 pll_ctrl_init_val;\n\n\tstruct reg_field ddc_clk_reg;\n\tu8 ddc_clk_pre_divider;\n\tu8 ddc_clk_m_offset;\n\n\tu8 tmds_clk_div_offset;\n\n\t \n\tstruct reg_field\tfield_ddc_en;\n\tstruct reg_field\tfield_ddc_start;\n\tstruct reg_field\tfield_ddc_reset;\n\tstruct reg_field\tfield_ddc_addr_reg;\n\tstruct reg_field\tfield_ddc_slave_addr;\n\tstruct reg_field\tfield_ddc_int_mask;\n\tstruct reg_field\tfield_ddc_int_status;\n\tstruct reg_field\tfield_ddc_fifo_clear;\n\tstruct reg_field\tfield_ddc_fifo_rx_thres;\n\tstruct reg_field\tfield_ddc_fifo_tx_thres;\n\tstruct reg_field\tfield_ddc_byte_count;\n\tstruct reg_field\tfield_ddc_cmd;\n\tstruct reg_field\tfield_ddc_sda_en;\n\tstruct reg_field\tfield_ddc_sck_en;\n\n\t \n\tu32\t\t\tddc_fifo_reg;\n\n\t \n\tbool\t\t\tddc_fifo_thres_incl;\n\n\tbool\t\t\tddc_fifo_has_dir;\n};\n\nstruct sun4i_hdmi {\n\tstruct drm_connector\tconnector;\n\tstruct drm_encoder\tencoder;\n\tstruct device\t\t*dev;\n\n\tvoid __iomem\t\t*base;\n\tstruct regmap\t\t*regmap;\n\n\t \n\tstruct reset_control\t*reset;\n\n\t \n\tstruct clk\t\t*bus_clk;\n\tstruct clk\t\t*mod_clk;\n\tstruct clk\t\t*ddc_parent_clk;\n\tstruct clk\t\t*pll0_clk;\n\tstruct clk\t\t*pll1_clk;\n\n\t \n\tstruct clk\t\t*ddc_clk;\n\tstruct clk\t\t*tmds_clk;\n\n\tstruct i2c_adapter\t*i2c;\n\tstruct i2c_adapter\t*ddc_i2c;\n\n\t \n\tstruct regmap_field\t*field_ddc_en;\n\tstruct regmap_field\t*field_ddc_start;\n\tstruct regmap_field\t*field_ddc_reset;\n\tstruct regmap_field\t*field_ddc_addr_reg;\n\tstruct regmap_field\t*field_ddc_slave_addr;\n\tstruct regmap_field\t*field_ddc_int_mask;\n\tstruct regmap_field\t*field_ddc_int_status;\n\tstruct regmap_field\t*field_ddc_fifo_clear;\n\tstruct regmap_field\t*field_ddc_fifo_rx_thres;\n\tstruct regmap_field\t*field_ddc_fifo_tx_thres;\n\tstruct regmap_field\t*field_ddc_byte_count;\n\tstruct regmap_field\t*field_ddc_cmd;\n\tstruct regmap_field\t*field_ddc_sda_en;\n\tstruct regmap_field\t*field_ddc_sck_en;\n\n\tstruct sun4i_drv\t*drv;\n\n\tstruct cec_adapter\t*cec_adap;\n\n\tconst struct sun4i_hdmi_variant\t*variant;\n};\n\nint sun4i_ddc_create(struct sun4i_hdmi *hdmi, struct clk *clk);\nint sun4i_tmds_create(struct sun4i_hdmi *hdmi);\nint sun4i_hdmi_i2c_create(struct device *dev, struct sun4i_hdmi *hdmi);\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}