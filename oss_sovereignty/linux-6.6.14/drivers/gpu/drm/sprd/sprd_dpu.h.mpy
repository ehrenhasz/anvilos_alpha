{
  "module_name": "sprd_dpu.h",
  "hash_id": "2124653ba8de20163f7788e16e4b6e83c873fb6ff3b5f5c1e368eaa2c375c7d5",
  "original_prompt": "Ingested from linux-6.6.14/drivers/gpu/drm/sprd/sprd_dpu.h",
  "human_readable_source": " \n \n\n#ifndef __SPRD_DPU_H__\n#define __SPRD_DPU_H__\n\n#include <linux/bug.h>\n#include <linux/delay.h>\n#include <linux/device.h>\n#include <linux/kernel.h>\n#include <linux/platform_device.h>\n#include <linux/string.h>\n#include <video/videomode.h>\n\n#include <drm/drm_crtc.h>\n#include <drm/drm_fourcc.h>\n#include <drm/drm_print.h>\n#include <drm/drm_vblank.h>\n#include <uapi/drm/drm_mode.h>\n\n \n#define DPU_LAY_REG_OFFSET\t0x30\n\nenum {\n\tSPRD_DPU_IF_DPI,\n\tSPRD_DPU_IF_EDPI,\n\tSPRD_DPU_IF_LIMIT\n};\n\n \nstruct dpu_context {\n\tvoid __iomem *base;\n\tint irq;\n\tu8 if_type;\n\tstruct videomode vm;\n\tbool stopped;\n\twait_queue_head_t wait_queue;\n\tbool evt_update;\n\tbool evt_stop;\n};\n\n \nstruct sprd_dpu {\n\tstruct drm_crtc base;\n\tstruct drm_device *drm;\n\tstruct dpu_context ctx;\n};\n\nstatic inline struct sprd_dpu *to_sprd_crtc(struct drm_crtc *crtc)\n{\n\treturn container_of(crtc, struct sprd_dpu, base);\n}\n\nstatic inline void\ndpu_reg_set(struct dpu_context *ctx, u32 offset, u32 set_bits)\n{\n\tu32 bits = readl_relaxed(ctx->base + offset);\n\n\twritel(bits | set_bits, ctx->base + offset);\n}\n\nstatic inline void\ndpu_reg_clr(struct dpu_context *ctx, u32 offset, u32 clr_bits)\n{\n\tu32 bits = readl_relaxed(ctx->base + offset);\n\n\twritel(bits & ~clr_bits, ctx->base + offset);\n}\n\nstatic inline u32\nlayer_reg_rd(struct dpu_context *ctx, u32 offset, int index)\n{\n\tu32 layer_offset = offset + index * DPU_LAY_REG_OFFSET;\n\n\treturn readl(ctx->base + layer_offset);\n}\n\nstatic inline void\nlayer_reg_wr(struct dpu_context *ctx, u32 offset, u32 cfg_bits, int index)\n{\n\tu32 layer_offset =  offset + index * DPU_LAY_REG_OFFSET;\n\n\twritel(cfg_bits, ctx->base + layer_offset);\n}\n\nvoid sprd_dpu_run(struct sprd_dpu *dpu);\nvoid sprd_dpu_stop(struct sprd_dpu *dpu);\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}