{
  "module_name": "lima_device.h",
  "hash_id": "48fa6445868ecf506cd1b8969cc71fd30bd9351e9f1aa431aa9bd6aed7a59903",
  "original_prompt": "Ingested from linux-6.6.14/drivers/gpu/drm/lima/lima_device.h",
  "human_readable_source": " \n \n\n#ifndef __LIMA_DEVICE_H__\n#define __LIMA_DEVICE_H__\n\n#include <drm/drm_device.h>\n#include <linux/delay.h>\n#include <linux/list.h>\n#include <linux/mutex.h>\n\n#include \"lima_sched.h\"\n#include \"lima_dump.h\"\n#include \"lima_devfreq.h\"\n\nenum lima_gpu_id {\n\tlima_gpu_mali400 = 0,\n\tlima_gpu_mali450,\n\tlima_gpu_num,\n};\n\nenum lima_ip_id {\n\tlima_ip_pmu,\n\tlima_ip_gpmmu,\n\tlima_ip_ppmmu0,\n\tlima_ip_ppmmu1,\n\tlima_ip_ppmmu2,\n\tlima_ip_ppmmu3,\n\tlima_ip_ppmmu4,\n\tlima_ip_ppmmu5,\n\tlima_ip_ppmmu6,\n\tlima_ip_ppmmu7,\n\tlima_ip_gp,\n\tlima_ip_pp0,\n\tlima_ip_pp1,\n\tlima_ip_pp2,\n\tlima_ip_pp3,\n\tlima_ip_pp4,\n\tlima_ip_pp5,\n\tlima_ip_pp6,\n\tlima_ip_pp7,\n\tlima_ip_l2_cache0,\n\tlima_ip_l2_cache1,\n\tlima_ip_l2_cache2,\n\tlima_ip_dlbu,\n\tlima_ip_bcast,\n\tlima_ip_pp_bcast,\n\tlima_ip_ppmmu_bcast,\n\tlima_ip_num,\n};\n\nstruct lima_device;\n\nstruct lima_ip {\n\tstruct lima_device *dev;\n\tenum lima_ip_id id;\n\tbool present;\n\n\tvoid __iomem *iomem;\n\tint irq;\n\n\tunion {\n\t\t \n\t\tbool async_reset;\n\t\t \n\t\tspinlock_t lock;\n\t\t \n\t\tu32 mask;\n\t} data;\n};\n\nenum lima_pipe_id {\n\tlima_pipe_gp,\n\tlima_pipe_pp,\n\tlima_pipe_num,\n};\n\nstruct lima_device {\n\tstruct device *dev;\n\tstruct drm_device *ddev;\n\n\tenum lima_gpu_id id;\n\tu32 gp_version;\n\tu32 pp_version;\n\tint num_pp;\n\n\tvoid __iomem *iomem;\n\tstruct clk *clk_bus;\n\tstruct clk *clk_gpu;\n\tstruct reset_control *reset;\n\tstruct regulator *regulator;\n\n\tstruct lima_ip ip[lima_ip_num];\n\tstruct lima_sched_pipe pipe[lima_pipe_num];\n\n\tstruct lima_vm *empty_vm;\n\tuint64_t va_start;\n\tuint64_t va_end;\n\n\tu32 *dlbu_cpu;\n\tdma_addr_t dlbu_dma;\n\n\tstruct lima_devfreq devfreq;\n\n\t \n\tstruct lima_dump_head dump;\n\tstruct list_head error_task_list;\n\tstruct mutex error_task_list_lock;\n};\n\nstatic inline struct lima_device *\nto_lima_dev(struct drm_device *dev)\n{\n\treturn dev->dev_private;\n}\n\nint lima_device_init(struct lima_device *ldev);\nvoid lima_device_fini(struct lima_device *ldev);\n\nconst char *lima_ip_name(struct lima_ip *ip);\n\ntypedef int (*lima_poll_func_t)(struct lima_ip *);\n\nstatic inline int lima_poll_timeout(struct lima_ip *ip, lima_poll_func_t func,\n\t\t\t\t    int sleep_us, int timeout_us)\n{\n\tktime_t timeout = ktime_add_us(ktime_get(), timeout_us);\n\n\tmight_sleep_if(sleep_us);\n\twhile (1) {\n\t\tif (func(ip))\n\t\t\treturn 0;\n\n\t\tif (timeout_us && ktime_compare(ktime_get(), timeout) > 0)\n\t\t\treturn -ETIMEDOUT;\n\n\t\tif (sleep_us)\n\t\t\tusleep_range((sleep_us >> 2) + 1, sleep_us);\n\t}\n\treturn 0;\n}\n\nint lima_device_suspend(struct device *dev);\nint lima_device_resume(struct device *dev);\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}