{
  "module_name": "lima_sched.h",
  "hash_id": "aeabf24ef906b47f0731d27d6647e7c5dbba623429b0270a8f451a9997b19b74",
  "original_prompt": "Ingested from linux-6.6.14/drivers/gpu/drm/lima/lima_sched.h",
  "human_readable_source": " \n \n\n#ifndef __LIMA_SCHED_H__\n#define __LIMA_SCHED_H__\n\n#include <drm/gpu_scheduler.h>\n#include <linux/list.h>\n#include <linux/xarray.h>\n\nstruct lima_device;\nstruct lima_vm;\n\nstruct lima_sched_error_task {\n\tstruct list_head list;\n\tvoid *data;\n\tu32 size;\n};\n\nstruct lima_sched_task {\n\tstruct drm_sched_job base;\n\n\tstruct lima_vm *vm;\n\tvoid *frame;\n\n\tstruct lima_bo **bos;\n\tint num_bos;\n\n\tbool recoverable;\n\tstruct lima_bo *heap;\n\n\t \n\tstruct dma_fence *fence;\n};\n\nstruct lima_sched_context {\n\tstruct drm_sched_entity base;\n};\n\n#define LIMA_SCHED_PIPE_MAX_MMU       8\n#define LIMA_SCHED_PIPE_MAX_L2_CACHE  2\n#define LIMA_SCHED_PIPE_MAX_PROCESSOR 8\n\nstruct lima_ip;\n\nstruct lima_sched_pipe {\n\tstruct drm_gpu_scheduler base;\n\n\tu64 fence_context;\n\tu32 fence_seqno;\n\tspinlock_t fence_lock;\n\n\tstruct lima_device *ldev;\n\n\tstruct lima_sched_task *current_task;\n\tstruct lima_vm *current_vm;\n\n\tstruct lima_ip *mmu[LIMA_SCHED_PIPE_MAX_MMU];\n\tint num_mmu;\n\n\tstruct lima_ip *l2_cache[LIMA_SCHED_PIPE_MAX_L2_CACHE];\n\tint num_l2_cache;\n\n\tstruct lima_ip *processor[LIMA_SCHED_PIPE_MAX_PROCESSOR];\n\tint num_processor;\n\n\tstruct lima_ip *bcast_processor;\n\tstruct lima_ip *bcast_mmu;\n\n\tu32 done;\n\tbool error;\n\tatomic_t task;\n\n\tint frame_size;\n\tstruct kmem_cache *task_slab;\n\n\tint (*task_validate)(struct lima_sched_pipe *pipe, struct lima_sched_task *task);\n\tvoid (*task_run)(struct lima_sched_pipe *pipe, struct lima_sched_task *task);\n\tvoid (*task_fini)(struct lima_sched_pipe *pipe);\n\tvoid (*task_error)(struct lima_sched_pipe *pipe);\n\tvoid (*task_mmu_error)(struct lima_sched_pipe *pipe);\n\tint (*task_recover)(struct lima_sched_pipe *pipe);\n\n\tstruct work_struct recover_work;\n};\n\nint lima_sched_task_init(struct lima_sched_task *task,\n\t\t\t struct lima_sched_context *context,\n\t\t\t struct lima_bo **bos, int num_bos,\n\t\t\t struct lima_vm *vm);\nvoid lima_sched_task_fini(struct lima_sched_task *task);\n\nint lima_sched_context_init(struct lima_sched_pipe *pipe,\n\t\t\t    struct lima_sched_context *context,\n\t\t\t    atomic_t *guilty);\nvoid lima_sched_context_fini(struct lima_sched_pipe *pipe,\n\t\t\t     struct lima_sched_context *context);\nstruct dma_fence *lima_sched_context_queue_task(struct lima_sched_task *task);\n\nint lima_sched_pipe_init(struct lima_sched_pipe *pipe, const char *name);\nvoid lima_sched_pipe_fini(struct lima_sched_pipe *pipe);\nvoid lima_sched_pipe_task_done(struct lima_sched_pipe *pipe);\n\nstatic inline void lima_sched_pipe_mmu_error(struct lima_sched_pipe *pipe)\n{\n\tpipe->error = true;\n\tpipe->task_mmu_error(pipe);\n}\n\nint lima_sched_slab_init(void);\nvoid lima_sched_slab_fini(void);\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}