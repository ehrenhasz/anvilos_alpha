{
  "module_name": "komeda_dev.h",
  "hash_id": "b69c636173c247c740e09bb664cca7e419426dae78dc002440d3c882a68a7df2",
  "original_prompt": "Ingested from linux-6.6.14/drivers/gpu/drm/arm/display/komeda/komeda_dev.h",
  "human_readable_source": " \n \n#ifndef _KOMEDA_DEV_H_\n#define _KOMEDA_DEV_H_\n\n#include <linux/device.h>\n#include <linux/clk.h>\n#include \"komeda_pipeline.h\"\n#include \"malidp_product.h\"\n#include \"komeda_format_caps.h\"\n\n#define KOMEDA_EVENT_VSYNC\t\tBIT_ULL(0)\n#define KOMEDA_EVENT_FLIP\t\tBIT_ULL(1)\n#define KOMEDA_EVENT_URUN\t\tBIT_ULL(2)\n#define KOMEDA_EVENT_IBSY\t\tBIT_ULL(3)\n#define KOMEDA_EVENT_OVR\t\tBIT_ULL(4)\n#define KOMEDA_EVENT_EOW\t\tBIT_ULL(5)\n#define KOMEDA_EVENT_MODE\t\tBIT_ULL(6)\n#define KOMEDA_EVENT_FULL\t\tBIT_ULL(7)\n#define KOMEDA_EVENT_EMPTY\t\tBIT_ULL(8)\n\n#define KOMEDA_ERR_TETO\t\t\tBIT_ULL(14)\n#define KOMEDA_ERR_TEMR\t\t\tBIT_ULL(15)\n#define KOMEDA_ERR_TITR\t\t\tBIT_ULL(16)\n#define KOMEDA_ERR_CPE\t\t\tBIT_ULL(17)\n#define KOMEDA_ERR_CFGE\t\t\tBIT_ULL(18)\n#define KOMEDA_ERR_AXIE\t\t\tBIT_ULL(19)\n#define KOMEDA_ERR_ACE0\t\t\tBIT_ULL(20)\n#define KOMEDA_ERR_ACE1\t\t\tBIT_ULL(21)\n#define KOMEDA_ERR_ACE2\t\t\tBIT_ULL(22)\n#define KOMEDA_ERR_ACE3\t\t\tBIT_ULL(23)\n#define KOMEDA_ERR_DRIFTTO\t\tBIT_ULL(24)\n#define KOMEDA_ERR_FRAMETO\t\tBIT_ULL(25)\n#define KOMEDA_ERR_CSCE\t\t\tBIT_ULL(26)\n#define KOMEDA_ERR_ZME\t\t\tBIT_ULL(27)\n#define KOMEDA_ERR_MERR\t\t\tBIT_ULL(28)\n#define KOMEDA_ERR_TCF\t\t\tBIT_ULL(29)\n#define KOMEDA_ERR_TTNG\t\t\tBIT_ULL(30)\n#define KOMEDA_ERR_TTF\t\t\tBIT_ULL(31)\n\n#define KOMEDA_ERR_EVENTS\t\\\n\t(KOMEDA_EVENT_URUN\t| KOMEDA_EVENT_IBSY\t| KOMEDA_EVENT_OVR |\\\n\tKOMEDA_ERR_TETO\t\t| KOMEDA_ERR_TEMR\t| KOMEDA_ERR_TITR |\\\n\tKOMEDA_ERR_CPE\t\t| KOMEDA_ERR_CFGE\t| KOMEDA_ERR_AXIE |\\\n\tKOMEDA_ERR_ACE0\t\t| KOMEDA_ERR_ACE1\t| KOMEDA_ERR_ACE2 |\\\n\tKOMEDA_ERR_ACE3\t\t| KOMEDA_ERR_DRIFTTO\t| KOMEDA_ERR_FRAMETO |\\\n\tKOMEDA_ERR_ZME\t\t| KOMEDA_ERR_MERR\t| KOMEDA_ERR_TCF |\\\n\tKOMEDA_ERR_TTNG\t\t| KOMEDA_ERR_TTF)\n\n#define KOMEDA_WARN_EVENTS\t\\\n\t(KOMEDA_ERR_CSCE | KOMEDA_EVENT_FULL | KOMEDA_EVENT_EMPTY)\n\n#define KOMEDA_INFO_EVENTS (0 \\\n\t\t\t    | KOMEDA_EVENT_VSYNC \\\n\t\t\t    | KOMEDA_EVENT_FLIP \\\n\t\t\t    | KOMEDA_EVENT_EOW \\\n\t\t\t    | KOMEDA_EVENT_MODE \\\n\t\t\t    )\n\n \nenum {\n\tKOMEDA_OF_PORT_OUTPUT\t\t= 0,\n\tKOMEDA_OF_PORT_COPROC\t\t= 1,\n};\n\nstruct komeda_chip_info {\n\tu32 arch_id;\n\tu32 core_id;\n\tu32 core_info;\n\tu32 bus_width;\n};\n\nstruct komeda_dev;\n\nstruct komeda_events {\n\tu64 global;\n\tu64 pipes[KOMEDA_MAX_PIPELINES];\n};\n\n \nstruct komeda_dev_funcs {\n\t \n\tvoid (*init_format_table)(struct komeda_dev *mdev);\n\t \n\tint (*enum_resources)(struct komeda_dev *mdev);\n\t \n\tvoid (*cleanup)(struct komeda_dev *mdev);\n\t \n\tint (*connect_iommu)(struct komeda_dev *mdev);\n\t \n\tint (*disconnect_iommu)(struct komeda_dev *mdev);\n\t \n\tirqreturn_t (*irq_handler)(struct komeda_dev *mdev,\n\t\t\t\t   struct komeda_events *events);\n\t \n\tint (*enable_irq)(struct komeda_dev *mdev);\n\t \n\tint (*disable_irq)(struct komeda_dev *mdev);\n\t \n\tvoid (*on_off_vblank)(struct komeda_dev *mdev,\n\t\t\t      int master_pipe, bool on);\n\n\t \n\tvoid (*dump_register)(struct komeda_dev *mdev, struct seq_file *seq);\n\t \n\tint (*change_opmode)(struct komeda_dev *mdev, int new_mode);\n\t \n\tvoid (*flush)(struct komeda_dev *mdev,\n\t\t      int master_pipe, u32 active_pipes);\n};\n\n \nenum {\n\tKOMEDA_MODE_INACTIVE\t= 0,\n\tKOMEDA_MODE_DISP0\t= BIT(0),\n\tKOMEDA_MODE_DISP1\t= BIT(1),\n\tKOMEDA_MODE_DUAL_DISP\t= KOMEDA_MODE_DISP0 | KOMEDA_MODE_DISP1,\n};\n\n \nstruct komeda_dev {\n\t \n\tstruct device *dev;\n\t \n\tu32 __iomem   *reg_base;\n\n\t \n\tstruct komeda_chip_info chip;\n\t \n\tstruct komeda_format_caps_table fmt_tbl;\n\t \n\tstruct clk *aclk;\n\n\t \n\tint irq;\n\n\t \n\tstruct mutex lock;\n\t \n\tu32 dpmode;\n\n\t \n\tint n_pipelines;\n\t \n\tstruct komeda_pipeline *pipelines[KOMEDA_MAX_PIPELINES];\n\n\t \n\tconst struct komeda_dev_funcs *funcs;\n\t \n\tvoid *chip_data;\n\n\t \n\tstruct iommu_domain *iommu;\n\n\t \n\tstruct dentry *debugfs_root;\n\t \n\tu16 err_verbosity;\n\t \n#define KOMEDA_DEV_PRINT_ERR_EVENTS BIT(0)\n\t \n#define KOMEDA_DEV_PRINT_WARN_EVENTS BIT(1)\n\t \n#define KOMEDA_DEV_PRINT_INFO_EVENTS BIT(2)\n\t \n#define KOMEDA_DEV_PRINT_DUMP_STATE_ON_EVENT BIT(8)\n\t \n#define KOMEDA_DEV_PRINT_DISABLE_RATELIMIT BIT(12)\n};\n\nstatic inline bool\nkomeda_product_match(struct komeda_dev *mdev, u32 target)\n{\n\treturn MALIDP_CORE_ID_PRODUCT_ID(mdev->chip.core_id) == target;\n}\n\ntypedef const struct komeda_dev_funcs *\n(*komeda_identify_func)(u32 __iomem *reg, struct komeda_chip_info *chip);\n\nconst struct komeda_dev_funcs *\nd71_identify(u32 __iomem *reg, struct komeda_chip_info *chip);\n\nstruct komeda_dev *komeda_dev_create(struct device *dev);\nvoid komeda_dev_destroy(struct komeda_dev *mdev);\n\nstruct komeda_dev *dev_to_mdev(struct device *dev);\n\nvoid komeda_print_events(struct komeda_events *evts, struct drm_device *dev);\n\nint komeda_dev_resume(struct komeda_dev *mdev);\nint komeda_dev_suspend(struct komeda_dev *mdev);\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}