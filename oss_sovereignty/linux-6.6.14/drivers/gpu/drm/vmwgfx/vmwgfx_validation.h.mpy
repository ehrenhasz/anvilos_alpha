{
  "module_name": "vmwgfx_validation.h",
  "hash_id": "497b7c86c487e9678f340bb67cf0ebf66b5035b537a75c7795499988b0f2b905",
  "original_prompt": "Ingested from linux-6.6.14/drivers/gpu/drm/vmwgfx/vmwgfx_validation.h",
  "human_readable_source": " \n \n#ifndef _VMWGFX_VALIDATION_H_\n#define _VMWGFX_VALIDATION_H_\n\n#include <linux/list.h>\n#include <linux/hashtable.h>\n#include <linux/ww_mutex.h>\n\n#include <drm/ttm/ttm_execbuf_util.h>\n\n#define VMW_RES_DIRTY_NONE 0\n#define VMW_RES_DIRTY_SET BIT(0)\n#define VMW_RES_DIRTY_CLEAR BIT(1)\n\n \nstruct vmw_validation_context {\n\tstruct vmw_sw_context *sw_context;\n\tstruct list_head resource_list;\n\tstruct list_head resource_ctx_list;\n\tstruct list_head bo_list;\n\tstruct list_head page_list;\n\tstruct ww_acquire_ctx ticket;\n\tstruct mutex *res_mutex;\n\tunsigned int merge_dups;\n\tunsigned int mem_size_left;\n\tu8 *page_address;\n\tstruct vmw_validation_mem *vm;\n\tsize_t vm_size_left;\n\tsize_t total_mem;\n};\n\nstruct vmw_bo;\nstruct vmw_resource;\nstruct vmw_fence_obj;\n\n#if 0\n \n#endif\n#define DECLARE_VAL_CONTEXT(_name, _sw_context, _merge_dups)\t\t\\\n\tstruct vmw_validation_context _name =\t\t\t\t\\\n\t{ .sw_context = _sw_context,\t\t\t\t\t\\\n\t  .resource_list = LIST_HEAD_INIT((_name).resource_list),\t\\\n\t  .resource_ctx_list = LIST_HEAD_INIT((_name).resource_ctx_list), \\\n\t  .bo_list = LIST_HEAD_INIT((_name).bo_list),\t\t\t\\\n\t  .page_list = LIST_HEAD_INIT((_name).page_list),\t\t\\\n\t  .res_mutex = NULL,\t\t\t\t\t\t\\\n\t  .merge_dups = _merge_dups,\t\t\t\t\t\\\n\t  .mem_size_left = 0,\t\t\t\t\t\t\\\n\t}\n\n \nstatic inline bool\nvmw_validation_has_bos(struct vmw_validation_context *ctx)\n{\n\treturn !list_empty(&ctx->bo_list);\n}\n\n \nstatic inline int\nvmw_validation_bo_reserve(struct vmw_validation_context *ctx,\n\t\t\t  bool intr)\n{\n\treturn ttm_eu_reserve_buffers(&ctx->ticket, &ctx->bo_list, intr,\n\t\t\t\t      NULL);\n}\n\n \nstatic inline void\nvmw_validation_bo_fence(struct vmw_validation_context *ctx,\n\t\t\tstruct vmw_fence_obj *fence)\n{\n\tttm_eu_fence_buffer_objects(&ctx->ticket, &ctx->bo_list,\n\t\t\t\t    (void *) fence);\n}\n\n \nstatic inline unsigned int vmw_validation_align(unsigned int val)\n{\n\treturn ALIGN(val, sizeof(long));\n}\n\nint vmw_validation_add_bo(struct vmw_validation_context *ctx,\n\t\t\t  struct vmw_bo *vbo);\nint vmw_validation_bo_validate(struct vmw_validation_context *ctx, bool intr);\nvoid vmw_validation_unref_lists(struct vmw_validation_context *ctx);\nint vmw_validation_add_resource(struct vmw_validation_context *ctx,\n\t\t\t\tstruct vmw_resource *res,\n\t\t\t\tsize_t priv_size,\n\t\t\t\tu32 dirty,\n\t\t\t\tvoid **p_node,\n\t\t\t\tbool *first_usage);\nvoid vmw_validation_drop_ht(struct vmw_validation_context *ctx);\nint vmw_validation_res_reserve(struct vmw_validation_context *ctx,\n\t\t\t       bool intr);\nvoid vmw_validation_res_unreserve(struct vmw_validation_context *ctx,\n\t\t\t\t  bool backoff);\nvoid vmw_validation_res_switch_backup(struct vmw_validation_context *ctx,\n\t\t\t\t      void *val_private,\n\t\t\t\t      struct vmw_bo *vbo,\n\t\t\t\t      unsigned long backup_offset);\nint vmw_validation_res_validate(struct vmw_validation_context *ctx, bool intr);\n\nint vmw_validation_prepare(struct vmw_validation_context *ctx,\n\t\t\t   struct mutex *mutex, bool intr);\nvoid vmw_validation_revert(struct vmw_validation_context *ctx);\nvoid vmw_validation_done(struct vmw_validation_context *ctx,\n\t\t\t struct vmw_fence_obj *fence);\n\nvoid *vmw_validation_mem_alloc(struct vmw_validation_context *ctx,\n\t\t\t       unsigned int size);\nint vmw_validation_preload_bo(struct vmw_validation_context *ctx);\nint vmw_validation_preload_res(struct vmw_validation_context *ctx,\n\t\t\t       unsigned int size);\nvoid vmw_validation_res_set_dirty(struct vmw_validation_context *ctx,\n\t\t\t\t  void *val_private, u32 dirty);\nvoid vmw_validation_bo_backoff(struct vmw_validation_context *ctx);\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}