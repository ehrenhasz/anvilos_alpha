{
  "module_name": "lava-submit.sh",
  "hash_id": "a5c830e993656c309481b5773f0ca01ab411f382294c8473bebc101440158f05",
  "original_prompt": "Ingested from linux-6.6.14/drivers/gpu/drm/ci/lava-submit.sh",
  "human_readable_source": "#!/bin/bash\n# SPDX-License-Identifier: MIT\n\nset -e\nset -x\n\n# Try to use the kernel and rootfs built in mainline first, so we're more\n# likely to hit cache\nif curl -L --retry 4 -f --retry-all-errors --retry-delay 60 -s \"https://${BASE_SYSTEM_MAINLINE_HOST_PATH}/done\"; then\n\tBASE_SYSTEM_HOST_PATH=\"${BASE_SYSTEM_MAINLINE_HOST_PATH}\"\nelse\n\tBASE_SYSTEM_HOST_PATH=\"${BASE_SYSTEM_FORK_HOST_PATH}\"\nfi\n\nrm -rf results\nmkdir -p results/job-rootfs-overlay/\n\ncp artifacts/ci-common/capture-devcoredump.sh results/job-rootfs-overlay/\ncp artifacts/ci-common/init-*.sh results/job-rootfs-overlay/\ncp artifacts/ci-common/intel-gpu-freq.sh results/job-rootfs-overlay/\ncp \"$SCRIPTS_DIR\"/setup-test-env.sh results/job-rootfs-overlay/\n\n# Prepare env vars for upload.\nsection_start variables \"Variables passed through:\"\nKERNEL_IMAGE_BASE_URL=\"https://${BASE_SYSTEM_HOST_PATH}\" \\\n\tartifacts/ci-common/generate-env.sh | tee results/job-rootfs-overlay/set-job-env-vars.sh\nsection_end variables\n\ntar zcf job-rootfs-overlay.tar.gz -C results/job-rootfs-overlay/ .\nci-fairy s3cp --token-file \"${CI_JOB_JWT_FILE}\" job-rootfs-overlay.tar.gz \"https://${JOB_ROOTFS_OVERLAY_PATH}\"\n\ntouch results/lava.log\ntail -f results/lava.log &\n\nPYTHONPATH=artifacts/ artifacts/lava/lava_job_submitter.py \\\n\tsubmit \\\n\t--dump-yaml \\\n\t--pipeline-info \"$CI_JOB_NAME: $CI_PIPELINE_URL on $CI_COMMIT_REF_NAME ${CI_NODE_INDEX}/${CI_NODE_TOTAL}\" \\\n\t--rootfs-url-prefix \"https://${BASE_SYSTEM_HOST_PATH}\" \\\n\t--kernel-url-prefix \"https://${PIPELINE_ARTIFACTS_BASE}/${ARCH}\" \\\n\t--build-url \"${FDO_HTTP_CACHE_URI:-}https://${PIPELINE_ARTIFACTS_BASE}/${ARCH}/kernel-files.tar.zst\" \\\n\t--job-rootfs-overlay-url \"${FDO_HTTP_CACHE_URI:-}https://${JOB_ROOTFS_OVERLAY_PATH}\" \\\n\t--job-timeout-min ${JOB_TIMEOUT:-80} \\\n\t--first-stage-init artifacts/ci-common/init-stage1.sh \\\n\t--ci-project-dir \"${CI_PROJECT_DIR}\" \\\n\t--device-type \"${DEVICE_TYPE}\" \\\n\t--dtb-filename \"${DTB}\" \\\n\t--jwt-file \"${CI_JOB_JWT_FILE}\" \\\n\t--kernel-image-name \"${KERNEL_IMAGE_NAME}\" \\\n\t--kernel-image-type \"${KERNEL_IMAGE_TYPE}\" \\\n\t--boot-method \"${BOOT_METHOD}\" \\\n\t--visibility-group \"${VISIBILITY_GROUP}\" \\\n\t--lava-tags \"${LAVA_TAGS}\" \\\n\t--mesa-job-name \"$CI_JOB_NAME\" \\\n\t--structured-log-file \"results/lava_job_detail.json\" \\\n\t--ssh-client-image \"${LAVA_SSH_CLIENT_IMAGE}\" \\\n\t>> results/lava.log\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}