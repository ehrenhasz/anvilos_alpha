{
  "module_name": "ch7006_priv.h",
  "hash_id": "49281b2d4f49b54ff071aeb3185369e7791184feefdfbc80f0a4247e9e79c1af",
  "original_prompt": "Ingested from linux-6.6.14/drivers/gpu/drm/i2c/ch7006_priv.h",
  "human_readable_source": " \n\n#ifndef __DRM_I2C_CH7006_PRIV_H__\n#define __DRM_I2C_CH7006_PRIV_H__\n\n#include <drm/drm_encoder_slave.h>\n#include <drm/drm_probe_helper.h>\n#include <drm/i2c/ch7006.h>\n\ntypedef int64_t fixed;\n#define fixed1 (1LL << 32)\n\nenum ch7006_tv_norm {\n\tTV_NORM_PAL,\n\tTV_NORM_PAL_M,\n\tTV_NORM_PAL_N,\n\tTV_NORM_PAL_NC,\n\tTV_NORM_PAL_60,\n\tTV_NORM_NTSC_M,\n\tTV_NORM_NTSC_J,\n\tNUM_TV_NORMS\n};\n\nstruct ch7006_tv_norm_info {\n\tfixed vrefresh;\n\tint vdisplay;\n\tint vtotal;\n\tint hvirtual;\n\n\tfixed subc_freq;\n\tfixed black_level;\n\n\tuint32_t dispmode;\n\tint voffset;\n};\n\nstruct ch7006_mode {\n\tstruct drm_display_mode mode;\n\n\tint enc_hdisp;\n\tint enc_vdisp;\n\n\tfixed subc_coeff;\n\tuint32_t dispmode;\n\n\tuint32_t valid_scales;\n\tuint32_t valid_norms;\n};\n\nstruct ch7006_state {\n\tuint8_t regs[0x26];\n};\n\nstruct ch7006_priv {\n\tstruct ch7006_encoder_params params;\n\tconst struct ch7006_mode *mode;\n\n\tstruct ch7006_state state;\n\tstruct ch7006_state saved_state;\n\n\tstruct drm_property *scale_property;\n\n\tint select_subconnector;\n\tint subconnector;\n\tint hmargin;\n\tint vmargin;\n\tenum ch7006_tv_norm norm;\n\tint brightness;\n\tint contrast;\n\tint flicker;\n\tint scale;\n\n\tint chip_version;\n\tint last_dpms;\n};\n\n#define to_ch7006_priv(x) \\\n\t((struct ch7006_priv *)to_encoder_slave(x)->slave_priv)\n\nextern int ch7006_debug;\nextern char *ch7006_tv_norm;\nextern int ch7006_scale;\n\nextern const char * const ch7006_tv_norm_names[];\nextern const struct ch7006_tv_norm_info ch7006_tv_norms[];\nextern const struct ch7006_mode ch7006_modes[];\n\nconst struct ch7006_mode *ch7006_lookup_mode(struct drm_encoder *encoder,\n\t\t\t\t\t     const struct drm_display_mode *drm_mode);\n\nvoid ch7006_setup_levels(struct drm_encoder *encoder);\nvoid ch7006_setup_subcarrier(struct drm_encoder *encoder);\nvoid ch7006_setup_pll(struct drm_encoder *encoder);\nvoid ch7006_setup_power_state(struct drm_encoder *encoder);\nvoid ch7006_setup_properties(struct drm_encoder *encoder);\n\nvoid ch7006_write(struct i2c_client *client, uint8_t addr, uint8_t val);\nuint8_t ch7006_read(struct i2c_client *client, uint8_t addr);\n\nvoid ch7006_state_load(struct i2c_client *client,\n\t\t       struct ch7006_state *state);\nvoid ch7006_state_save(struct i2c_client *client,\n\t\t       struct ch7006_state *state);\n\n \n\n#define ch7006_dbg(client, format, ...) do {\t\t\t\t\\\n\t\tif (ch7006_debug)\t\t\t\t\t\\\n\t\t\tdev_printk(KERN_DEBUG, &client->dev,\t\t\\\n\t\t\t\t   \"%s: \" format, __func__, ## __VA_ARGS__); \\\n\t} while (0)\n#define ch7006_info(client, format, ...) \\\n\t\t\t\tdev_info(&client->dev, format, __VA_ARGS__)\n#define ch7006_err(client, format, ...) \\\n\t\t\t\tdev_err(&client->dev, format, __VA_ARGS__)\n\n#define __mask(src, bitfield) \\\n\t\t(((2 << (1 ? bitfield)) - 1) & ~((1 << (0 ? bitfield)) - 1))\n#define mask(bitfield) __mask(bitfield)\n\n#define __bitf(src, bitfield, x) \\\n\t\t(((x) >> (src) << (0 ? bitfield)) &  __mask(src, bitfield))\n#define bitf(bitfield, x) __bitf(bitfield, x)\n#define bitfs(bitfield, s) __bitf(bitfield, bitfield##_##s)\n#define setbitf(state, reg, bitfield, x)\t\t\t\t\\\n\tstate->regs[reg] = (state->regs[reg] & ~mask(reg##_##bitfield))\t\\\n\t\t| bitf(reg##_##bitfield, x)\n\n#define __unbitf(src, bitfield, x) \\\n\t\t((x & __mask(src, bitfield)) >> (0 ? bitfield) << (src))\n#define unbitf(bitfield, x) __unbitf(bitfield, x)\n\nstatic inline int interpolate(int y0, int y1, int y2, int x)\n{\n\treturn y1 + (x < 50 ? y1 - y0 : y2 - y1) * (x - 50) / 50;\n}\n\nstatic inline int32_t round_fixed(fixed x)\n{\n\treturn (x + fixed1/2) >> 32;\n}\n\n#define ch7006_load_reg(client, state, reg) ch7006_write(client, reg, state->regs[reg])\n#define ch7006_save_reg(client, state, reg) state->regs[reg] = ch7006_read(client, reg)\n\n \n\n#define CH7006_FREQ0\t\t\t\t14318\n#define CH7006_MAXN\t\t\t\t650\n#define CH7006_MAXM\t\t\t\t315\n\n \n\n#define CH7006_DISPMODE\t\t\t\t0x00\n#define CH7006_DISPMODE_INPUT_RES\t\t0, 7:5\n#define CH7006_DISPMODE_INPUT_RES_512x384\t0x0\n#define CH7006_DISPMODE_INPUT_RES_720x400\t0x1\n#define CH7006_DISPMODE_INPUT_RES_640x400\t0x2\n#define CH7006_DISPMODE_INPUT_RES_640x480\t0x3\n#define CH7006_DISPMODE_INPUT_RES_800x600\t0x4\n#define CH7006_DISPMODE_INPUT_RES_NATIVE\t0x5\n#define CH7006_DISPMODE_OUTPUT_STD\t\t0, 4:3\n#define CH7006_DISPMODE_OUTPUT_STD_PAL\t\t0x0\n#define CH7006_DISPMODE_OUTPUT_STD_NTSC\t\t0x1\n#define CH7006_DISPMODE_OUTPUT_STD_PAL_M\t0x2\n#define CH7006_DISPMODE_OUTPUT_STD_NTSC_J\t0x3\n#define CH7006_DISPMODE_SCALING_RATIO\t\t0, 2:0\n#define CH7006_DISPMODE_SCALING_RATIO_5_4\t0x0\n#define CH7006_DISPMODE_SCALING_RATIO_1_1\t0x1\n#define CH7006_DISPMODE_SCALING_RATIO_7_8\t0x2\n#define CH7006_DISPMODE_SCALING_RATIO_5_6\t0x3\n#define CH7006_DISPMODE_SCALING_RATIO_3_4\t0x4\n#define CH7006_DISPMODE_SCALING_RATIO_7_10\t0x5\n\n#define CH7006_FFILTER\t\t\t\t0x01\n#define CH7006_FFILTER_TEXT\t\t\t0, 5:4\n#define CH7006_FFILTER_LUMA\t\t\t0, 3:2\n#define CH7006_FFILTER_CHROMA\t\t\t0, 1:0\n#define CH7006_FFILTER_CHROMA_NO_DCRAWL\t\t0x3\n\n#define CH7006_BWIDTH\t\t\t\t0x03\n#define CH7006_BWIDTH_5L_FFILER\t\t\t(1 << 7)\n#define CH7006_BWIDTH_CVBS_NO_CHROMA\t\t(1 << 6)\n#define CH7006_BWIDTH_CHROMA\t\t\t0, 5:4\n#define CH7006_BWIDTH_SVIDEO_YPEAK\t\t(1 << 3)\n#define CH7006_BWIDTH_SVIDEO_LUMA\t\t0, 2:1\n#define CH7006_BWIDTH_CVBS_LUMA\t\t\t0, 0:0\n\n#define CH7006_INPUT_FORMAT\t\t\t0x04\n#define CH7006_INPUT_FORMAT_DAC_GAIN\t\t(1 << 6)\n#define CH7006_INPUT_FORMAT_RGB_PASS_THROUGH\t(1 << 5)\n#define CH7006_INPUT_FORMAT_FORMAT\t\t0, 3:0\n#define CH7006_INPUT_FORMAT_FORMAT_RGB16\t0x0\n#define CH7006_INPUT_FORMAT_FORMAT_YCrCb24m16\t0x1\n#define CH7006_INPUT_FORMAT_FORMAT_RGB24m16\t0x2\n#define CH7006_INPUT_FORMAT_FORMAT_RGB15\t0x3\n#define CH7006_INPUT_FORMAT_FORMAT_RGB24m12C\t0x4\n#define CH7006_INPUT_FORMAT_FORMAT_RGB24m12I\t0x5\n#define CH7006_INPUT_FORMAT_FORMAT_RGB24m8\t0x6\n#define CH7006_INPUT_FORMAT_FORMAT_RGB16m8\t0x7\n#define CH7006_INPUT_FORMAT_FORMAT_RGB15m8\t0x8\n#define CH7006_INPUT_FORMAT_FORMAT_YCrCb24m8\t0x9\n\n#define CH7006_CLKMODE\t\t\t\t0x06\n#define CH7006_CLKMODE_SUBC_LOCK\t\t(1 << 7)\n#define CH7006_CLKMODE_MASTER\t\t\t(1 << 6)\n#define CH7006_CLKMODE_POS_EDGE\t\t\t(1 << 4)\n#define CH7006_CLKMODE_XCM\t\t\t0, 3:2\n#define CH7006_CLKMODE_PCM\t\t\t0, 1:0\n\n#define CH7006_START_ACTIVE\t\t\t0x07\n#define CH7006_START_ACTIVE_0\t\t\t0, 7:0\n\n#define CH7006_POV\t\t\t\t0x08\n#define CH7006_POV_START_ACTIVE_8\t\t8, 2:2\n#define CH7006_POV_HPOS_8\t\t\t8, 1:1\n#define CH7006_POV_VPOS_8\t\t\t8, 0:0\n\n#define CH7006_BLACK_LEVEL\t\t\t0x09\n#define CH7006_BLACK_LEVEL_0\t\t\t0, 7:0\n\n#define CH7006_HPOS\t\t\t\t0x0a\n#define CH7006_HPOS_0\t\t\t\t0, 7:0\n\n#define CH7006_VPOS\t\t\t\t0x0b\n#define CH7006_VPOS_0\t\t\t\t0, 7:0\n\n#define CH7006_INPUT_SYNC\t\t\t0x0d\n#define CH7006_INPUT_SYNC_EMBEDDED\t\t(1 << 3)\n#define CH7006_INPUT_SYNC_OUTPUT\t\t(1 << 2)\n#define CH7006_INPUT_SYNC_PVSYNC\t\t(1 << 1)\n#define CH7006_INPUT_SYNC_PHSYNC\t\t(1 << 0)\n\n#define CH7006_POWER\t\t\t\t0x0e\n#define CH7006_POWER_SCART\t\t\t(1 << 4)\n#define CH7006_POWER_RESET\t\t\t(1 << 3)\n#define CH7006_POWER_LEVEL\t\t\t0, 2:0\n#define CH7006_POWER_LEVEL_CVBS_OFF\t\t0x0\n#define CH7006_POWER_LEVEL_POWER_OFF\t\t0x1\n#define CH7006_POWER_LEVEL_SVIDEO_OFF\t\t0x2\n#define CH7006_POWER_LEVEL_NORMAL\t\t0x3\n#define CH7006_POWER_LEVEL_FULL_POWER_OFF\t0x4\n\n#define CH7006_DETECT\t\t\t\t0x10\n#define CH7006_DETECT_SVIDEO_Y_TEST\t\t(1 << 3)\n#define CH7006_DETECT_SVIDEO_C_TEST\t\t(1 << 2)\n#define CH7006_DETECT_CVBS_TEST\t\t\t(1 << 1)\n#define CH7006_DETECT_SENSE\t\t\t(1 << 0)\n\n#define CH7006_CONTRAST\t\t\t\t0x11\n#define CH7006_CONTRAST_0\t\t\t0, 2:0\n\n#define CH7006_PLLOV\t \t\t\t0x13\n#define CH7006_PLLOV_N_8\t \t\t8, 2:1\n#define CH7006_PLLOV_M_8\t \t\t8, 0:0\n\n#define CH7006_PLLM\t \t\t\t0x14\n#define CH7006_PLLM_0\t \t\t\t0, 7:0\n\n#define CH7006_PLLN\t \t\t\t0x15\n#define CH7006_PLLN_0\t \t\t\t0, 7:0\n\n#define CH7006_BCLKOUT\t \t\t\t0x17\n\n#define CH7006_SUBC_INC0\t\t\t0x18\n#define CH7006_SUBC_INC0_28\t\t\t28, 3:0\n\n#define CH7006_SUBC_INC1\t\t\t0x19\n#define CH7006_SUBC_INC1_24\t\t\t24, 3:0\n\n#define CH7006_SUBC_INC2\t\t\t0x1a\n#define CH7006_SUBC_INC2_20\t\t\t20, 3:0\n\n#define CH7006_SUBC_INC3\t\t\t0x1b\n#define CH7006_SUBC_INC3_GPIO1_VAL\t\t(1 << 7)\n#define CH7006_SUBC_INC3_GPIO0_VAL\t\t(1 << 6)\n#define CH7006_SUBC_INC3_POUT_3_3V\t\t(1 << 5)\n#define CH7006_SUBC_INC3_POUT_INV\t\t(1 << 4)\n#define CH7006_SUBC_INC3_16\t\t\t16, 3:0\n\n#define CH7006_SUBC_INC4\t\t\t0x1c\n#define CH7006_SUBC_INC4_GPIO1_IN\t\t(1 << 7)\n#define CH7006_SUBC_INC4_GPIO0_IN\t\t(1 << 6)\n#define CH7006_SUBC_INC4_DS_INPUT\t\t(1 << 4)\n#define CH7006_SUBC_INC4_12\t\t\t12, 3:0\n\n#define CH7006_SUBC_INC5\t\t\t0x1d\n#define CH7006_SUBC_INC5_8\t\t\t8, 3:0\n\n#define CH7006_SUBC_INC6\t\t\t0x1e\n#define CH7006_SUBC_INC6_4\t\t\t4, 3:0\n\n#define CH7006_SUBC_INC7\t\t\t0x1f\n#define CH7006_SUBC_INC7_0\t\t\t0, 3:0\n\n#define CH7006_PLL_CONTROL\t\t\t0x20\n#define CH7006_PLL_CONTROL_CPI\t\t\t(1 << 5)\n#define CH7006_PLL_CONTROL_CAPACITOR\t\t(1 << 4)\n#define CH7006_PLL_CONTROL_7STAGES\t\t(1 << 3)\n#define CH7006_PLL_CONTROL_DIGITAL_5V\t\t(1 << 2)\n#define CH7006_PLL_CONTROL_ANALOG_5V\t\t(1 << 1)\n#define CH7006_PLL_CONTROL_MEMORY_5V\t\t(1 << 0)\n\n#define CH7006_CALC_SUBC_INC0\t\t\t0x21\n#define CH7006_CALC_SUBC_INC0_24\t\t24, 4:3\n#define CH7006_CALC_SUBC_INC0_HYST\t\t0, 2:1\n#define CH7006_CALC_SUBC_INC0_AUTO\t\t(1 << 0)\n\n#define CH7006_CALC_SUBC_INC1\t\t\t0x22\n#define CH7006_CALC_SUBC_INC1_16\t\t16, 7:0\n\n#define CH7006_CALC_SUBC_INC2\t\t\t0x23\n#define CH7006_CALC_SUBC_INC2_8\t\t\t8, 7:0\n\n#define CH7006_CALC_SUBC_INC3\t\t\t0x24\n#define CH7006_CALC_SUBC_INC3_0\t\t\t0, 7:0\n\n#define CH7006_VERSION_ID\t\t\t0x25\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}