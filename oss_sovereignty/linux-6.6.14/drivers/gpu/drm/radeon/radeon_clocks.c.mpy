{
  "module_name": "radeon_clocks.c",
  "hash_id": "0a123a92bda5bd1ca2a292a1f2c4e747cfa6eb883385d25c24746abdab4af14f",
  "original_prompt": "Ingested from linux-6.6.14/drivers/gpu/drm/radeon/radeon_clocks.c",
  "human_readable_source": " \n\n#include <linux/pci.h>\n\n#include <drm/drm_device.h>\n#include <drm/radeon_drm.h>\n\n#include \"atom.h\"\n#include \"radeon.h\"\n#include \"radeon_asic.h\"\n#include \"radeon_reg.h\"\n\n \nuint32_t radeon_legacy_get_engine_clock(struct radeon_device *rdev)\n{\n\tstruct radeon_pll *spll = &rdev->clock.spll;\n\tuint32_t fb_div, ref_div, post_div, sclk;\n\n\tfb_div = RREG32_PLL(RADEON_M_SPLL_REF_FB_DIV);\n\tfb_div = (fb_div >> RADEON_SPLL_FB_DIV_SHIFT) & RADEON_SPLL_FB_DIV_MASK;\n\tfb_div <<= 1;\n\tfb_div *= spll->reference_freq;\n\n\tref_div =\n\t    RREG32_PLL(RADEON_M_SPLL_REF_FB_DIV) & RADEON_M_SPLL_REF_DIV_MASK;\n\n\tif (ref_div == 0)\n\t\treturn 0;\n\n\tsclk = fb_div / ref_div;\n\n\tpost_div = RREG32_PLL(RADEON_SCLK_CNTL) & RADEON_SCLK_SRC_SEL_MASK;\n\tif (post_div == 2)\n\t\tsclk >>= 1;\n\telse if (post_div == 3)\n\t\tsclk >>= 2;\n\telse if (post_div == 4)\n\t\tsclk >>= 3;\n\n\treturn sclk;\n}\n\n \nuint32_t radeon_legacy_get_memory_clock(struct radeon_device *rdev)\n{\n\tstruct radeon_pll *mpll = &rdev->clock.mpll;\n\tuint32_t fb_div, ref_div, post_div, mclk;\n\n\tfb_div = RREG32_PLL(RADEON_M_SPLL_REF_FB_DIV);\n\tfb_div = (fb_div >> RADEON_MPLL_FB_DIV_SHIFT) & RADEON_MPLL_FB_DIV_MASK;\n\tfb_div <<= 1;\n\tfb_div *= mpll->reference_freq;\n\n\tref_div =\n\t    RREG32_PLL(RADEON_M_SPLL_REF_FB_DIV) & RADEON_M_SPLL_REF_DIV_MASK;\n\n\tif (ref_div == 0)\n\t\treturn 0;\n\n\tmclk = fb_div / ref_div;\n\n\tpost_div = RREG32_PLL(RADEON_MCLK_CNTL) & 0x7;\n\tif (post_div == 2)\n\t\tmclk >>= 1;\n\telse if (post_div == 3)\n\t\tmclk >>= 2;\n\telse if (post_div == 4)\n\t\tmclk >>= 3;\n\n\treturn mclk;\n}\n\n#ifdef CONFIG_OF\n \nstatic bool radeon_read_clocks_OF(struct drm_device *dev)\n{\n\tstruct radeon_device *rdev = dev->dev_private;\n\tstruct device_node *dp = rdev->pdev->dev.of_node;\n\tconst u32 *val;\n\tstruct radeon_pll *p1pll = &rdev->clock.p1pll;\n\tstruct radeon_pll *p2pll = &rdev->clock.p2pll;\n\tstruct radeon_pll *spll = &rdev->clock.spll;\n\tstruct radeon_pll *mpll = &rdev->clock.mpll;\n\n\tif (dp == NULL)\n\t\treturn false;\n\tval = of_get_property(dp, \"ATY,RefCLK\", NULL);\n\tif (!val || !*val) {\n\t\tpr_warn(\"radeonfb: No ATY,RefCLK property !\\n\");\n\t\treturn false;\n\t}\n\tp1pll->reference_freq = p2pll->reference_freq = (*val) / 10;\n\tp1pll->reference_div = RREG32_PLL(RADEON_PPLL_REF_DIV) & 0x3ff;\n\tif (p1pll->reference_div < 2)\n\t\tp1pll->reference_div = 12;\n\tp2pll->reference_div = p1pll->reference_div;\n\n\t \n\tif (rdev->family >= CHIP_R420) {\n\t\tp1pll->pll_in_min = 100;\n\t\tp1pll->pll_in_max = 1350;\n\t\tp1pll->pll_out_min = 20000;\n\t\tp1pll->pll_out_max = 50000;\n\t\tp2pll->pll_in_min = 100;\n\t\tp2pll->pll_in_max = 1350;\n\t\tp2pll->pll_out_min = 20000;\n\t\tp2pll->pll_out_max = 50000;\n\t} else {\n\t\tp1pll->pll_in_min = 40;\n\t\tp1pll->pll_in_max = 500;\n\t\tp1pll->pll_out_min = 12500;\n\t\tp1pll->pll_out_max = 35000;\n\t\tp2pll->pll_in_min = 40;\n\t\tp2pll->pll_in_max = 500;\n\t\tp2pll->pll_out_min = 12500;\n\t\tp2pll->pll_out_max = 35000;\n\t}\n\t \n\trdev->clock.max_pixel_clock = 35000;\n\n\tspll->reference_freq = mpll->reference_freq = p1pll->reference_freq;\n\tspll->reference_div = mpll->reference_div =\n\t\tRREG32_PLL(RADEON_M_SPLL_REF_FB_DIV) &\n\t\t\t    RADEON_M_SPLL_REF_DIV_MASK;\n\n\tval = of_get_property(dp, \"ATY,SCLK\", NULL);\n\tif (val && *val)\n\t\trdev->clock.default_sclk = (*val) / 10;\n\telse\n\t\trdev->clock.default_sclk =\n\t\t\tradeon_legacy_get_engine_clock(rdev);\n\n\tval = of_get_property(dp, \"ATY,MCLK\", NULL);\n\tif (val && *val)\n\t\trdev->clock.default_mclk = (*val) / 10;\n\telse\n\t\trdev->clock.default_mclk =\n\t\t\tradeon_legacy_get_memory_clock(rdev);\n\n\tDRM_INFO(\"Using device-tree clock info\\n\");\n\n\treturn true;\n}\n#else\nstatic bool radeon_read_clocks_OF(struct drm_device *dev)\n{\n\treturn false;\n}\n#endif  \n\nvoid radeon_get_clock_info(struct drm_device *dev)\n{\n\tstruct radeon_device *rdev = dev->dev_private;\n\tstruct radeon_pll *p1pll = &rdev->clock.p1pll;\n\tstruct radeon_pll *p2pll = &rdev->clock.p2pll;\n\tstruct radeon_pll *dcpll = &rdev->clock.dcpll;\n\tstruct radeon_pll *spll = &rdev->clock.spll;\n\tstruct radeon_pll *mpll = &rdev->clock.mpll;\n\tint ret;\n\n\tif (rdev->is_atom_bios)\n\t\tret = radeon_atom_get_clock_info(dev);\n\telse\n\t\tret = radeon_combios_get_clock_info(dev);\n\tif (!ret)\n\t\tret = radeon_read_clocks_OF(dev);\n\n\tif (ret) {\n\t\tif (p1pll->reference_div < 2) {\n\t\t\tif (!ASIC_IS_AVIVO(rdev)) {\n\t\t\t\tu32 tmp = RREG32_PLL(RADEON_PPLL_REF_DIV);\n\t\t\t\tif (ASIC_IS_R300(rdev))\n\t\t\t\t\tp1pll->reference_div =\n\t\t\t\t\t\t(tmp & R300_PPLL_REF_DIV_ACC_MASK) >> R300_PPLL_REF_DIV_ACC_SHIFT;\n\t\t\t\telse\n\t\t\t\t\tp1pll->reference_div = tmp & RADEON_PPLL_REF_DIV_MASK;\n\t\t\t\tif (p1pll->reference_div < 2)\n\t\t\t\t\tp1pll->reference_div = 12;\n\t\t\t} else\n\t\t\t\tp1pll->reference_div = 12;\n\t\t}\n\t\tif (p2pll->reference_div < 2)\n\t\t\tp2pll->reference_div = 12;\n\t\tif (rdev->family < CHIP_RS600) {\n\t\t\tif (spll->reference_div < 2)\n\t\t\t\tspll->reference_div =\n\t\t\t\t\tRREG32_PLL(RADEON_M_SPLL_REF_FB_DIV) &\n\t\t\t\t\tRADEON_M_SPLL_REF_DIV_MASK;\n\t\t}\n\t\tif (mpll->reference_div < 2)\n\t\t\tmpll->reference_div = spll->reference_div;\n\t} else {\n\t\tif (ASIC_IS_AVIVO(rdev)) {\n\t\t\t \n\t\t} else {\n\t\t\tDRM_INFO(\"Using generic clock info\\n\");\n\n\t\t\t \n\t\t\trdev->clock.max_pixel_clock = 35000;\n\n\t\t\tif (rdev->flags & RADEON_IS_IGP) {\n\t\t\t\tp1pll->reference_freq = 1432;\n\t\t\t\tp2pll->reference_freq = 1432;\n\t\t\t\tspll->reference_freq = 1432;\n\t\t\t\tmpll->reference_freq = 1432;\n\t\t\t} else {\n\t\t\t\tp1pll->reference_freq = 2700;\n\t\t\t\tp2pll->reference_freq = 2700;\n\t\t\t\tspll->reference_freq = 2700;\n\t\t\t\tmpll->reference_freq = 2700;\n\t\t\t}\n\t\t\tp1pll->reference_div =\n\t\t\t    RREG32_PLL(RADEON_PPLL_REF_DIV) & 0x3ff;\n\t\t\tif (p1pll->reference_div < 2)\n\t\t\t\tp1pll->reference_div = 12;\n\t\t\tp2pll->reference_div = p1pll->reference_div;\n\n\t\t\tif (rdev->family >= CHIP_R420) {\n\t\t\t\tp1pll->pll_in_min = 100;\n\t\t\t\tp1pll->pll_in_max = 1350;\n\t\t\t\tp1pll->pll_out_min = 20000;\n\t\t\t\tp1pll->pll_out_max = 50000;\n\t\t\t\tp2pll->pll_in_min = 100;\n\t\t\t\tp2pll->pll_in_max = 1350;\n\t\t\t\tp2pll->pll_out_min = 20000;\n\t\t\t\tp2pll->pll_out_max = 50000;\n\t\t\t} else {\n\t\t\t\tp1pll->pll_in_min = 40;\n\t\t\t\tp1pll->pll_in_max = 500;\n\t\t\t\tp1pll->pll_out_min = 12500;\n\t\t\t\tp1pll->pll_out_max = 35000;\n\t\t\t\tp2pll->pll_in_min = 40;\n\t\t\t\tp2pll->pll_in_max = 500;\n\t\t\t\tp2pll->pll_out_min = 12500;\n\t\t\t\tp2pll->pll_out_max = 35000;\n\t\t\t}\n\n\t\t\tspll->reference_div =\n\t\t\t    RREG32_PLL(RADEON_M_SPLL_REF_FB_DIV) &\n\t\t\t    RADEON_M_SPLL_REF_DIV_MASK;\n\t\t\tmpll->reference_div = spll->reference_div;\n\t\t\trdev->clock.default_sclk =\n\t\t\t    radeon_legacy_get_engine_clock(rdev);\n\t\t\trdev->clock.default_mclk =\n\t\t\t    radeon_legacy_get_memory_clock(rdev);\n\t\t}\n\t}\n\n\t \n\tif (ASIC_IS_AVIVO(rdev)) {\n\t\tp1pll->min_post_div = 2;\n\t\tp1pll->max_post_div = 0x7f;\n\t\tp1pll->min_frac_feedback_div = 0;\n\t\tp1pll->max_frac_feedback_div = 9;\n\t\tp2pll->min_post_div = 2;\n\t\tp2pll->max_post_div = 0x7f;\n\t\tp2pll->min_frac_feedback_div = 0;\n\t\tp2pll->max_frac_feedback_div = 9;\n\t} else {\n\t\tp1pll->min_post_div = 1;\n\t\tp1pll->max_post_div = 16;\n\t\tp1pll->min_frac_feedback_div = 0;\n\t\tp1pll->max_frac_feedback_div = 0;\n\t\tp2pll->min_post_div = 1;\n\t\tp2pll->max_post_div = 12;\n\t\tp2pll->min_frac_feedback_div = 0;\n\t\tp2pll->max_frac_feedback_div = 0;\n\t}\n\n\t \n\tdcpll->min_post_div = 2;\n\tdcpll->max_post_div = 0x7f;\n\tdcpll->min_frac_feedback_div = 0;\n\tdcpll->max_frac_feedback_div = 9;\n\tdcpll->min_ref_div = 2;\n\tdcpll->max_ref_div = 0x3ff;\n\tdcpll->min_feedback_div = 4;\n\tdcpll->max_feedback_div = 0xfff;\n\tdcpll->best_vco = 0;\n\n\tp1pll->min_ref_div = 2;\n\tp1pll->max_ref_div = 0x3ff;\n\tp1pll->min_feedback_div = 4;\n\tp1pll->max_feedback_div = 0x7ff;\n\tp1pll->best_vco = 0;\n\n\tp2pll->min_ref_div = 2;\n\tp2pll->max_ref_div = 0x3ff;\n\tp2pll->min_feedback_div = 4;\n\tp2pll->max_feedback_div = 0x7ff;\n\tp2pll->best_vco = 0;\n\n\t \n\tspll->min_post_div = 1;\n\tspll->max_post_div = 1;\n\tspll->min_ref_div = 2;\n\tspll->max_ref_div = 0xff;\n\tspll->min_feedback_div = 4;\n\tspll->max_feedback_div = 0xff;\n\tspll->best_vco = 0;\n\n\t \n\tmpll->min_post_div = 1;\n\tmpll->max_post_div = 1;\n\tmpll->min_ref_div = 2;\n\tmpll->max_ref_div = 0xff;\n\tmpll->min_feedback_div = 4;\n\tmpll->max_feedback_div = 0xff;\n\tmpll->best_vco = 0;\n\n\tif (!rdev->clock.default_sclk)\n\t\trdev->clock.default_sclk = radeon_get_engine_clock(rdev);\n\tif ((!rdev->clock.default_mclk) && rdev->asic->pm.get_memory_clock)\n\t\trdev->clock.default_mclk = radeon_get_memory_clock(rdev);\n\n\trdev->pm.current_sclk = rdev->clock.default_sclk;\n\trdev->pm.current_mclk = rdev->clock.default_mclk;\n\n}\n\n \nstatic uint32_t calc_eng_mem_clock(struct radeon_device *rdev,\n\t\t\t\t   uint32_t req_clock,\n\t\t\t\t   int *fb_div, int *post_div)\n{\n\tstruct radeon_pll *spll = &rdev->clock.spll;\n\tint ref_div = spll->reference_div;\n\n\tif (!ref_div)\n\t\tref_div =\n\t\t    RREG32_PLL(RADEON_M_SPLL_REF_FB_DIV) &\n\t\t    RADEON_M_SPLL_REF_DIV_MASK;\n\n\tif (req_clock < 15000) {\n\t\t*post_div = 8;\n\t\treq_clock *= 8;\n\t} else if (req_clock < 30000) {\n\t\t*post_div = 4;\n\t\treq_clock *= 4;\n\t} else if (req_clock < 60000) {\n\t\t*post_div = 2;\n\t\treq_clock *= 2;\n\t} else\n\t\t*post_div = 1;\n\n\treq_clock *= ref_div;\n\treq_clock += spll->reference_freq;\n\treq_clock /= (2 * spll->reference_freq);\n\n\t*fb_div = req_clock & 0xff;\n\n\treq_clock = (req_clock & 0xffff) << 1;\n\treq_clock *= spll->reference_freq;\n\treq_clock /= ref_div;\n\treq_clock /= *post_div;\n\n\treturn req_clock;\n}\n\n \nvoid radeon_legacy_set_engine_clock(struct radeon_device *rdev,\n\t\t\t\t    uint32_t eng_clock)\n{\n\tuint32_t tmp;\n\tint fb_div, post_div;\n\n\t \n\n\teng_clock = calc_eng_mem_clock(rdev, eng_clock, &fb_div, &post_div);\n\n\ttmp = RREG32_PLL(RADEON_CLK_PIN_CNTL);\n\ttmp &= ~RADEON_DONT_USE_XTALIN;\n\tWREG32_PLL(RADEON_CLK_PIN_CNTL, tmp);\n\n\ttmp = RREG32_PLL(RADEON_SCLK_CNTL);\n\ttmp &= ~RADEON_SCLK_SRC_SEL_MASK;\n\tWREG32_PLL(RADEON_SCLK_CNTL, tmp);\n\n\tudelay(10);\n\n\ttmp = RREG32_PLL(RADEON_SPLL_CNTL);\n\ttmp |= RADEON_SPLL_SLEEP;\n\tWREG32_PLL(RADEON_SPLL_CNTL, tmp);\n\n\tudelay(2);\n\n\ttmp = RREG32_PLL(RADEON_SPLL_CNTL);\n\ttmp |= RADEON_SPLL_RESET;\n\tWREG32_PLL(RADEON_SPLL_CNTL, tmp);\n\n\tudelay(200);\n\n\ttmp = RREG32_PLL(RADEON_M_SPLL_REF_FB_DIV);\n\ttmp &= ~(RADEON_SPLL_FB_DIV_MASK << RADEON_SPLL_FB_DIV_SHIFT);\n\ttmp |= (fb_div & RADEON_SPLL_FB_DIV_MASK) << RADEON_SPLL_FB_DIV_SHIFT;\n\tWREG32_PLL(RADEON_M_SPLL_REF_FB_DIV, tmp);\n\n\t \n\ttmp = RREG32_PLL(RADEON_SPLL_CNTL);\n\ttmp &= ~RADEON_SPLL_PVG_MASK;\n\tif ((eng_clock * post_div) >= 90000)\n\t\ttmp |= (0x7 << RADEON_SPLL_PVG_SHIFT);\n\telse\n\t\ttmp |= (0x4 << RADEON_SPLL_PVG_SHIFT);\n\tWREG32_PLL(RADEON_SPLL_CNTL, tmp);\n\n\ttmp = RREG32_PLL(RADEON_SPLL_CNTL);\n\ttmp &= ~RADEON_SPLL_SLEEP;\n\tWREG32_PLL(RADEON_SPLL_CNTL, tmp);\n\n\tudelay(2);\n\n\ttmp = RREG32_PLL(RADEON_SPLL_CNTL);\n\ttmp &= ~RADEON_SPLL_RESET;\n\tWREG32_PLL(RADEON_SPLL_CNTL, tmp);\n\n\tudelay(200);\n\n\ttmp = RREG32_PLL(RADEON_SCLK_CNTL);\n\ttmp &= ~RADEON_SCLK_SRC_SEL_MASK;\n\tswitch (post_div) {\n\tcase 1:\n\tdefault:\n\t\ttmp |= 1;\n\t\tbreak;\n\tcase 2:\n\t\ttmp |= 2;\n\t\tbreak;\n\tcase 4:\n\t\ttmp |= 3;\n\t\tbreak;\n\tcase 8:\n\t\ttmp |= 4;\n\t\tbreak;\n\t}\n\tWREG32_PLL(RADEON_SCLK_CNTL, tmp);\n\n\tudelay(20);\n\n\ttmp = RREG32_PLL(RADEON_CLK_PIN_CNTL);\n\ttmp |= RADEON_DONT_USE_XTALIN;\n\tWREG32_PLL(RADEON_CLK_PIN_CNTL, tmp);\n\n\tudelay(10);\n}\n\nvoid radeon_legacy_set_clock_gating(struct radeon_device *rdev, int enable)\n{\n\tuint32_t tmp;\n\n\tif (enable) {\n\t\tif (rdev->flags & RADEON_SINGLE_CRTC) {\n\t\t\ttmp = RREG32_PLL(RADEON_SCLK_CNTL);\n\t\t\tif ((RREG32(RADEON_CONFIG_CNTL) &\n\t\t\t     RADEON_CFG_ATI_REV_ID_MASK) >\n\t\t\t    RADEON_CFG_ATI_REV_A13) {\n\t\t\t\ttmp &=\n\t\t\t\t    ~(RADEON_SCLK_FORCE_CP |\n\t\t\t\t      RADEON_SCLK_FORCE_RB);\n\t\t\t}\n\t\t\ttmp &=\n\t\t\t    ~(RADEON_SCLK_FORCE_HDP | RADEON_SCLK_FORCE_DISP1 |\n\t\t\t      RADEON_SCLK_FORCE_TOP | RADEON_SCLK_FORCE_SE |\n\t\t\t      RADEON_SCLK_FORCE_IDCT | RADEON_SCLK_FORCE_RE |\n\t\t\t      RADEON_SCLK_FORCE_PB | RADEON_SCLK_FORCE_TAM |\n\t\t\t      RADEON_SCLK_FORCE_TDM);\n\t\t\tWREG32_PLL(RADEON_SCLK_CNTL, tmp);\n\t\t} else if (ASIC_IS_R300(rdev)) {\n\t\t\tif ((rdev->family == CHIP_RS400) ||\n\t\t\t    (rdev->family == CHIP_RS480)) {\n\t\t\t\ttmp = RREG32_PLL(RADEON_SCLK_CNTL);\n\t\t\t\ttmp &=\n\t\t\t\t    ~(RADEON_SCLK_FORCE_DISP2 |\n\t\t\t\t      RADEON_SCLK_FORCE_CP |\n\t\t\t\t      RADEON_SCLK_FORCE_HDP |\n\t\t\t\t      RADEON_SCLK_FORCE_DISP1 |\n\t\t\t\t      RADEON_SCLK_FORCE_TOP |\n\t\t\t\t      RADEON_SCLK_FORCE_E2 | R300_SCLK_FORCE_VAP\n\t\t\t\t      | RADEON_SCLK_FORCE_IDCT |\n\t\t\t\t      RADEON_SCLK_FORCE_VIP | R300_SCLK_FORCE_SR\n\t\t\t\t      | R300_SCLK_FORCE_PX | R300_SCLK_FORCE_TX\n\t\t\t\t      | R300_SCLK_FORCE_US |\n\t\t\t\t      RADEON_SCLK_FORCE_TV_SCLK |\n\t\t\t\t      R300_SCLK_FORCE_SU |\n\t\t\t\t      RADEON_SCLK_FORCE_OV0);\n\t\t\t\ttmp |= RADEON_DYN_STOP_LAT_MASK;\n\t\t\t\ttmp |=\n\t\t\t\t    RADEON_SCLK_FORCE_TOP |\n\t\t\t\t    RADEON_SCLK_FORCE_VIP;\n\t\t\t\tWREG32_PLL(RADEON_SCLK_CNTL, tmp);\n\n\t\t\t\ttmp = RREG32_PLL(RADEON_SCLK_MORE_CNTL);\n\t\t\t\ttmp &= ~RADEON_SCLK_MORE_FORCEON;\n\t\t\t\ttmp |= RADEON_SCLK_MORE_MAX_DYN_STOP_LAT;\n\t\t\t\tWREG32_PLL(RADEON_SCLK_MORE_CNTL, tmp);\n\n\t\t\t\ttmp = RREG32_PLL(RADEON_VCLK_ECP_CNTL);\n\t\t\t\ttmp |= (RADEON_PIXCLK_ALWAYS_ONb |\n\t\t\t\t\tRADEON_PIXCLK_DAC_ALWAYS_ONb);\n\t\t\t\tWREG32_PLL(RADEON_VCLK_ECP_CNTL, tmp);\n\n\t\t\t\ttmp = RREG32_PLL(RADEON_PIXCLKS_CNTL);\n\t\t\t\ttmp |= (RADEON_PIX2CLK_ALWAYS_ONb |\n\t\t\t\t\tRADEON_PIX2CLK_DAC_ALWAYS_ONb |\n\t\t\t\t\tRADEON_DISP_TVOUT_PIXCLK_TV_ALWAYS_ONb |\n\t\t\t\t\tR300_DVOCLK_ALWAYS_ONb |\n\t\t\t\t\tRADEON_PIXCLK_BLEND_ALWAYS_ONb |\n\t\t\t\t\tRADEON_PIXCLK_GV_ALWAYS_ONb |\n\t\t\t\t\tR300_PIXCLK_DVO_ALWAYS_ONb |\n\t\t\t\t\tRADEON_PIXCLK_LVDS_ALWAYS_ONb |\n\t\t\t\t\tRADEON_PIXCLK_TMDS_ALWAYS_ONb |\n\t\t\t\t\tR300_PIXCLK_TRANS_ALWAYS_ONb |\n\t\t\t\t\tR300_PIXCLK_TVO_ALWAYS_ONb |\n\t\t\t\t\tR300_P2G2CLK_ALWAYS_ONb |\n\t\t\t\t\tR300_P2G2CLK_DAC_ALWAYS_ONb);\n\t\t\t\tWREG32_PLL(RADEON_PIXCLKS_CNTL, tmp);\n\t\t\t} else if (rdev->family >= CHIP_RV350) {\n\t\t\t\ttmp = RREG32_PLL(R300_SCLK_CNTL2);\n\t\t\t\ttmp &= ~(R300_SCLK_FORCE_TCL |\n\t\t\t\t\t R300_SCLK_FORCE_GA |\n\t\t\t\t\t R300_SCLK_FORCE_CBA);\n\t\t\t\ttmp |= (R300_SCLK_TCL_MAX_DYN_STOP_LAT |\n\t\t\t\t\tR300_SCLK_GA_MAX_DYN_STOP_LAT |\n\t\t\t\t\tR300_SCLK_CBA_MAX_DYN_STOP_LAT);\n\t\t\t\tWREG32_PLL(R300_SCLK_CNTL2, tmp);\n\n\t\t\t\ttmp = RREG32_PLL(RADEON_SCLK_CNTL);\n\t\t\t\ttmp &=\n\t\t\t\t    ~(RADEON_SCLK_FORCE_DISP2 |\n\t\t\t\t      RADEON_SCLK_FORCE_CP |\n\t\t\t\t      RADEON_SCLK_FORCE_HDP |\n\t\t\t\t      RADEON_SCLK_FORCE_DISP1 |\n\t\t\t\t      RADEON_SCLK_FORCE_TOP |\n\t\t\t\t      RADEON_SCLK_FORCE_E2 | R300_SCLK_FORCE_VAP\n\t\t\t\t      | RADEON_SCLK_FORCE_IDCT |\n\t\t\t\t      RADEON_SCLK_FORCE_VIP | R300_SCLK_FORCE_SR\n\t\t\t\t      | R300_SCLK_FORCE_PX | R300_SCLK_FORCE_TX\n\t\t\t\t      | R300_SCLK_FORCE_US |\n\t\t\t\t      RADEON_SCLK_FORCE_TV_SCLK |\n\t\t\t\t      R300_SCLK_FORCE_SU |\n\t\t\t\t      RADEON_SCLK_FORCE_OV0);\n\t\t\t\ttmp |= RADEON_DYN_STOP_LAT_MASK;\n\t\t\t\tWREG32_PLL(RADEON_SCLK_CNTL, tmp);\n\n\t\t\t\ttmp = RREG32_PLL(RADEON_SCLK_MORE_CNTL);\n\t\t\t\ttmp &= ~RADEON_SCLK_MORE_FORCEON;\n\t\t\t\ttmp |= RADEON_SCLK_MORE_MAX_DYN_STOP_LAT;\n\t\t\t\tWREG32_PLL(RADEON_SCLK_MORE_CNTL, tmp);\n\n\t\t\t\ttmp = RREG32_PLL(RADEON_VCLK_ECP_CNTL);\n\t\t\t\ttmp |= (RADEON_PIXCLK_ALWAYS_ONb |\n\t\t\t\t\tRADEON_PIXCLK_DAC_ALWAYS_ONb);\n\t\t\t\tWREG32_PLL(RADEON_VCLK_ECP_CNTL, tmp);\n\n\t\t\t\ttmp = RREG32_PLL(RADEON_PIXCLKS_CNTL);\n\t\t\t\ttmp |= (RADEON_PIX2CLK_ALWAYS_ONb |\n\t\t\t\t\tRADEON_PIX2CLK_DAC_ALWAYS_ONb |\n\t\t\t\t\tRADEON_DISP_TVOUT_PIXCLK_TV_ALWAYS_ONb |\n\t\t\t\t\tR300_DVOCLK_ALWAYS_ONb |\n\t\t\t\t\tRADEON_PIXCLK_BLEND_ALWAYS_ONb |\n\t\t\t\t\tRADEON_PIXCLK_GV_ALWAYS_ONb |\n\t\t\t\t\tR300_PIXCLK_DVO_ALWAYS_ONb |\n\t\t\t\t\tRADEON_PIXCLK_LVDS_ALWAYS_ONb |\n\t\t\t\t\tRADEON_PIXCLK_TMDS_ALWAYS_ONb |\n\t\t\t\t\tR300_PIXCLK_TRANS_ALWAYS_ONb |\n\t\t\t\t\tR300_PIXCLK_TVO_ALWAYS_ONb |\n\t\t\t\t\tR300_P2G2CLK_ALWAYS_ONb |\n\t\t\t\t\tR300_P2G2CLK_DAC_ALWAYS_ONb);\n\t\t\t\tWREG32_PLL(RADEON_PIXCLKS_CNTL, tmp);\n\n\t\t\t\ttmp = RREG32_PLL(RADEON_MCLK_MISC);\n\t\t\t\ttmp |= (RADEON_MC_MCLK_DYN_ENABLE |\n\t\t\t\t\tRADEON_IO_MCLK_DYN_ENABLE);\n\t\t\t\tWREG32_PLL(RADEON_MCLK_MISC, tmp);\n\n\t\t\t\ttmp = RREG32_PLL(RADEON_MCLK_CNTL);\n\t\t\t\ttmp |= (RADEON_FORCEON_MCLKA |\n\t\t\t\t\tRADEON_FORCEON_MCLKB);\n\n\t\t\t\ttmp &= ~(RADEON_FORCEON_YCLKA |\n\t\t\t\t\t RADEON_FORCEON_YCLKB |\n\t\t\t\t\t RADEON_FORCEON_MC);\n\n\t\t\t\t \n\t\t\t\tif ((tmp & R300_DISABLE_MC_MCLKA) &&\n\t\t\t\t    (tmp & R300_DISABLE_MC_MCLKB)) {\n\t\t\t\t\t \n\t\t\t\t\ttmp = RREG32_PLL(RADEON_MCLK_CNTL);\n\t\t\t\t\tif (rdev->mc.vram_width == 64) {\n\t\t\t\t\t\tif (RREG32(RADEON_MEM_CNTL) &\n\t\t\t\t\t\t    R300_MEM_USE_CD_CH_ONLY)\n\t\t\t\t\t\t\ttmp &=\n\t\t\t\t\t\t\t    ~R300_DISABLE_MC_MCLKB;\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\ttmp &=\n\t\t\t\t\t\t\t    ~R300_DISABLE_MC_MCLKA;\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttmp &= ~(R300_DISABLE_MC_MCLKA |\n\t\t\t\t\t\t\t R300_DISABLE_MC_MCLKB);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tWREG32_PLL(RADEON_MCLK_CNTL, tmp);\n\t\t\t} else {\n\t\t\t\ttmp = RREG32_PLL(RADEON_SCLK_CNTL);\n\t\t\t\ttmp &= ~(R300_SCLK_FORCE_VAP);\n\t\t\t\ttmp |= RADEON_SCLK_FORCE_CP;\n\t\t\t\tWREG32_PLL(RADEON_SCLK_CNTL, tmp);\n\t\t\t\tmdelay(15);\n\n\t\t\t\ttmp = RREG32_PLL(R300_SCLK_CNTL2);\n\t\t\t\ttmp &= ~(R300_SCLK_FORCE_TCL |\n\t\t\t\t\t R300_SCLK_FORCE_GA |\n\t\t\t\t\t R300_SCLK_FORCE_CBA);\n\t\t\t\tWREG32_PLL(R300_SCLK_CNTL2, tmp);\n\t\t\t}\n\t\t} else {\n\t\t\ttmp = RREG32_PLL(RADEON_CLK_PWRMGT_CNTL);\n\n\t\t\ttmp &= ~(RADEON_ACTIVE_HILO_LAT_MASK |\n\t\t\t\t RADEON_DISP_DYN_STOP_LAT_MASK |\n\t\t\t\t RADEON_DYN_STOP_MODE_MASK);\n\n\t\t\ttmp |= (RADEON_ENGIN_DYNCLK_MODE |\n\t\t\t\t(0x01 << RADEON_ACTIVE_HILO_LAT_SHIFT));\n\t\t\tWREG32_PLL(RADEON_CLK_PWRMGT_CNTL, tmp);\n\t\t\tmdelay(15);\n\n\t\t\ttmp = RREG32_PLL(RADEON_CLK_PIN_CNTL);\n\t\t\ttmp |= RADEON_SCLK_DYN_START_CNTL;\n\t\t\tWREG32_PLL(RADEON_CLK_PIN_CNTL, tmp);\n\t\t\tmdelay(15);\n\n\t\t\t \n\t\t\ttmp = RREG32_PLL(RADEON_SCLK_CNTL);\n\t\t\t \n\t\t\ttmp &= ~RADEON_SCLK_FORCEON_MASK;\n\n\t\t\t \n\t\t\tif (((rdev->family == CHIP_RV250) &&\n\t\t\t     ((RREG32(RADEON_CONFIG_CNTL) &\n\t\t\t       RADEON_CFG_ATI_REV_ID_MASK) <\n\t\t\t      RADEON_CFG_ATI_REV_A13))\n\t\t\t    || ((rdev->family == CHIP_RV100)\n\t\t\t\t&&\n\t\t\t\t((RREG32(RADEON_CONFIG_CNTL) &\n\t\t\t\t  RADEON_CFG_ATI_REV_ID_MASK) <=\n\t\t\t\t RADEON_CFG_ATI_REV_A13))) {\n\t\t\t\ttmp |= RADEON_SCLK_FORCE_CP;\n\t\t\t\ttmp |= RADEON_SCLK_FORCE_VIP;\n\t\t\t}\n\n\t\t\tWREG32_PLL(RADEON_SCLK_CNTL, tmp);\n\n\t\t\tif ((rdev->family == CHIP_RV200) ||\n\t\t\t    (rdev->family == CHIP_RV250) ||\n\t\t\t    (rdev->family == CHIP_RV280)) {\n\t\t\t\ttmp = RREG32_PLL(RADEON_SCLK_MORE_CNTL);\n\t\t\t\ttmp &= ~RADEON_SCLK_MORE_FORCEON;\n\n\t\t\t\t \n\t\t\t\tif (((rdev->family == CHIP_RV200) ||\n\t\t\t\t     (rdev->family == CHIP_RV250)) &&\n\t\t\t\t    ((RREG32(RADEON_CONFIG_CNTL) &\n\t\t\t\t      RADEON_CFG_ATI_REV_ID_MASK) <\n\t\t\t\t     RADEON_CFG_ATI_REV_A13)) {\n\t\t\t\t\ttmp |= RADEON_SCLK_MORE_FORCEON;\n\t\t\t\t}\n\t\t\t\tWREG32_PLL(RADEON_SCLK_MORE_CNTL, tmp);\n\t\t\t\tmdelay(15);\n\t\t\t}\n\n\t\t\t \n\t\t\tif (((rdev->family == CHIP_RV200) ||\n\t\t\t     (rdev->family == CHIP_RV250)) &&\n\t\t\t    ((RREG32(RADEON_CONFIG_CNTL) &\n\t\t\t      RADEON_CFG_ATI_REV_ID_MASK) <\n\t\t\t     RADEON_CFG_ATI_REV_A13)) {\n\t\t\t\ttmp = RREG32_PLL(RADEON_PLL_PWRMGT_CNTL);\n\t\t\t\ttmp |= RADEON_TCL_BYPASS_DISABLE;\n\t\t\t\tWREG32_PLL(RADEON_PLL_PWRMGT_CNTL, tmp);\n\t\t\t}\n\t\t\tmdelay(15);\n\n\t\t\t \n\t\t\ttmp = RREG32_PLL(RADEON_PIXCLKS_CNTL);\n\t\t\ttmp |= (RADEON_PIX2CLK_ALWAYS_ONb |\n\t\t\t\tRADEON_PIX2CLK_DAC_ALWAYS_ONb |\n\t\t\t\tRADEON_PIXCLK_BLEND_ALWAYS_ONb |\n\t\t\t\tRADEON_PIXCLK_GV_ALWAYS_ONb |\n\t\t\t\tRADEON_PIXCLK_DIG_TMDS_ALWAYS_ONb |\n\t\t\t\tRADEON_PIXCLK_LVDS_ALWAYS_ONb |\n\t\t\t\tRADEON_PIXCLK_TMDS_ALWAYS_ONb);\n\n\t\t\tWREG32_PLL(RADEON_PIXCLKS_CNTL, tmp);\n\t\t\tmdelay(15);\n\n\t\t\ttmp = RREG32_PLL(RADEON_VCLK_ECP_CNTL);\n\t\t\ttmp |= (RADEON_PIXCLK_ALWAYS_ONb |\n\t\t\t\tRADEON_PIXCLK_DAC_ALWAYS_ONb);\n\n\t\t\tWREG32_PLL(RADEON_VCLK_ECP_CNTL, tmp);\n\t\t\tmdelay(15);\n\t\t}\n\t} else {\n\t\t \n\t\tif (rdev->flags & RADEON_SINGLE_CRTC) {\n\t\t\ttmp = RREG32_PLL(RADEON_SCLK_CNTL);\n\t\t\ttmp |= (RADEON_SCLK_FORCE_CP | RADEON_SCLK_FORCE_HDP |\n\t\t\t\tRADEON_SCLK_FORCE_DISP1 | RADEON_SCLK_FORCE_TOP\n\t\t\t\t| RADEON_SCLK_FORCE_E2 | RADEON_SCLK_FORCE_SE |\n\t\t\t\tRADEON_SCLK_FORCE_IDCT | RADEON_SCLK_FORCE_VIP |\n\t\t\t\tRADEON_SCLK_FORCE_RE | RADEON_SCLK_FORCE_PB |\n\t\t\t\tRADEON_SCLK_FORCE_TAM | RADEON_SCLK_FORCE_TDM |\n\t\t\t\tRADEON_SCLK_FORCE_RB);\n\t\t\tWREG32_PLL(RADEON_SCLK_CNTL, tmp);\n\t\t} else if ((rdev->family == CHIP_RS400) ||\n\t\t\t   (rdev->family == CHIP_RS480)) {\n\t\t\ttmp = RREG32_PLL(RADEON_SCLK_CNTL);\n\t\t\ttmp |= (RADEON_SCLK_FORCE_DISP2 | RADEON_SCLK_FORCE_CP |\n\t\t\t\tRADEON_SCLK_FORCE_HDP | RADEON_SCLK_FORCE_DISP1\n\t\t\t\t| RADEON_SCLK_FORCE_TOP | RADEON_SCLK_FORCE_E2 |\n\t\t\t\tR300_SCLK_FORCE_VAP | RADEON_SCLK_FORCE_IDCT |\n\t\t\t\tRADEON_SCLK_FORCE_VIP | R300_SCLK_FORCE_SR |\n\t\t\t\tR300_SCLK_FORCE_PX | R300_SCLK_FORCE_TX |\n\t\t\t\tR300_SCLK_FORCE_US | RADEON_SCLK_FORCE_TV_SCLK |\n\t\t\t\tR300_SCLK_FORCE_SU | RADEON_SCLK_FORCE_OV0);\n\t\t\tWREG32_PLL(RADEON_SCLK_CNTL, tmp);\n\n\t\t\ttmp = RREG32_PLL(RADEON_SCLK_MORE_CNTL);\n\t\t\ttmp |= RADEON_SCLK_MORE_FORCEON;\n\t\t\tWREG32_PLL(RADEON_SCLK_MORE_CNTL, tmp);\n\n\t\t\ttmp = RREG32_PLL(RADEON_VCLK_ECP_CNTL);\n\t\t\ttmp &= ~(RADEON_PIXCLK_ALWAYS_ONb |\n\t\t\t\t RADEON_PIXCLK_DAC_ALWAYS_ONb |\n\t\t\t\t R300_DISP_DAC_PIXCLK_DAC_BLANK_OFF);\n\t\t\tWREG32_PLL(RADEON_VCLK_ECP_CNTL, tmp);\n\n\t\t\ttmp = RREG32_PLL(RADEON_PIXCLKS_CNTL);\n\t\t\ttmp &= ~(RADEON_PIX2CLK_ALWAYS_ONb |\n\t\t\t\t RADEON_PIX2CLK_DAC_ALWAYS_ONb |\n\t\t\t\t RADEON_DISP_TVOUT_PIXCLK_TV_ALWAYS_ONb |\n\t\t\t\t R300_DVOCLK_ALWAYS_ONb |\n\t\t\t\t RADEON_PIXCLK_BLEND_ALWAYS_ONb |\n\t\t\t\t RADEON_PIXCLK_GV_ALWAYS_ONb |\n\t\t\t\t R300_PIXCLK_DVO_ALWAYS_ONb |\n\t\t\t\t RADEON_PIXCLK_LVDS_ALWAYS_ONb |\n\t\t\t\t RADEON_PIXCLK_TMDS_ALWAYS_ONb |\n\t\t\t\t R300_PIXCLK_TRANS_ALWAYS_ONb |\n\t\t\t\t R300_PIXCLK_TVO_ALWAYS_ONb |\n\t\t\t\t R300_P2G2CLK_ALWAYS_ONb |\n\t\t\t\t R300_P2G2CLK_DAC_ALWAYS_ONb |\n\t\t\t\t R300_DISP_DAC_PIXCLK_DAC2_BLANK_OFF);\n\t\t\tWREG32_PLL(RADEON_PIXCLKS_CNTL, tmp);\n\t\t} else if (rdev->family >= CHIP_RV350) {\n\t\t\t \n\t\t\ttmp = RREG32_PLL(R300_SCLK_CNTL2);\n\t\t\ttmp |= (R300_SCLK_FORCE_TCL |\n\t\t\t\tR300_SCLK_FORCE_GA | R300_SCLK_FORCE_CBA);\n\t\t\tWREG32_PLL(R300_SCLK_CNTL2, tmp);\n\n\t\t\ttmp = RREG32_PLL(RADEON_SCLK_CNTL);\n\t\t\ttmp |= (RADEON_SCLK_FORCE_DISP2 | RADEON_SCLK_FORCE_CP |\n\t\t\t\tRADEON_SCLK_FORCE_HDP | RADEON_SCLK_FORCE_DISP1\n\t\t\t\t| RADEON_SCLK_FORCE_TOP | RADEON_SCLK_FORCE_E2 |\n\t\t\t\tR300_SCLK_FORCE_VAP | RADEON_SCLK_FORCE_IDCT |\n\t\t\t\tRADEON_SCLK_FORCE_VIP | R300_SCLK_FORCE_SR |\n\t\t\t\tR300_SCLK_FORCE_PX | R300_SCLK_FORCE_TX |\n\t\t\t\tR300_SCLK_FORCE_US | RADEON_SCLK_FORCE_TV_SCLK |\n\t\t\t\tR300_SCLK_FORCE_SU | RADEON_SCLK_FORCE_OV0);\n\t\t\tWREG32_PLL(RADEON_SCLK_CNTL, tmp);\n\n\t\t\ttmp = RREG32_PLL(RADEON_SCLK_MORE_CNTL);\n\t\t\ttmp |= RADEON_SCLK_MORE_FORCEON;\n\t\t\tWREG32_PLL(RADEON_SCLK_MORE_CNTL, tmp);\n\n\t\t\ttmp = RREG32_PLL(RADEON_MCLK_CNTL);\n\t\t\ttmp |= (RADEON_FORCEON_MCLKA |\n\t\t\t\tRADEON_FORCEON_MCLKB |\n\t\t\t\tRADEON_FORCEON_YCLKA |\n\t\t\t\tRADEON_FORCEON_YCLKB | RADEON_FORCEON_MC);\n\t\t\tWREG32_PLL(RADEON_MCLK_CNTL, tmp);\n\n\t\t\ttmp = RREG32_PLL(RADEON_VCLK_ECP_CNTL);\n\t\t\ttmp &= ~(RADEON_PIXCLK_ALWAYS_ONb |\n\t\t\t\t RADEON_PIXCLK_DAC_ALWAYS_ONb |\n\t\t\t\t R300_DISP_DAC_PIXCLK_DAC_BLANK_OFF);\n\t\t\tWREG32_PLL(RADEON_VCLK_ECP_CNTL, tmp);\n\n\t\t\ttmp = RREG32_PLL(RADEON_PIXCLKS_CNTL);\n\t\t\ttmp &= ~(RADEON_PIX2CLK_ALWAYS_ONb |\n\t\t\t\t RADEON_PIX2CLK_DAC_ALWAYS_ONb |\n\t\t\t\t RADEON_DISP_TVOUT_PIXCLK_TV_ALWAYS_ONb |\n\t\t\t\t R300_DVOCLK_ALWAYS_ONb |\n\t\t\t\t RADEON_PIXCLK_BLEND_ALWAYS_ONb |\n\t\t\t\t RADEON_PIXCLK_GV_ALWAYS_ONb |\n\t\t\t\t R300_PIXCLK_DVO_ALWAYS_ONb |\n\t\t\t\t RADEON_PIXCLK_LVDS_ALWAYS_ONb |\n\t\t\t\t RADEON_PIXCLK_TMDS_ALWAYS_ONb |\n\t\t\t\t R300_PIXCLK_TRANS_ALWAYS_ONb |\n\t\t\t\t R300_PIXCLK_TVO_ALWAYS_ONb |\n\t\t\t\t R300_P2G2CLK_ALWAYS_ONb |\n\t\t\t\t R300_P2G2CLK_DAC_ALWAYS_ONb |\n\t\t\t\t R300_DISP_DAC_PIXCLK_DAC2_BLANK_OFF);\n\t\t\tWREG32_PLL(RADEON_PIXCLKS_CNTL, tmp);\n\t\t} else {\n\t\t\ttmp = RREG32_PLL(RADEON_SCLK_CNTL);\n\t\t\ttmp |= (RADEON_SCLK_FORCE_CP | RADEON_SCLK_FORCE_E2);\n\t\t\ttmp |= RADEON_SCLK_FORCE_SE;\n\n\t\t\tif (rdev->flags & RADEON_SINGLE_CRTC) {\n\t\t\t\ttmp |= (RADEON_SCLK_FORCE_RB |\n\t\t\t\t\tRADEON_SCLK_FORCE_TDM |\n\t\t\t\t\tRADEON_SCLK_FORCE_TAM |\n\t\t\t\t\tRADEON_SCLK_FORCE_PB |\n\t\t\t\t\tRADEON_SCLK_FORCE_RE |\n\t\t\t\t\tRADEON_SCLK_FORCE_VIP |\n\t\t\t\t\tRADEON_SCLK_FORCE_IDCT |\n\t\t\t\t\tRADEON_SCLK_FORCE_TOP |\n\t\t\t\t\tRADEON_SCLK_FORCE_DISP1 |\n\t\t\t\t\tRADEON_SCLK_FORCE_DISP2 |\n\t\t\t\t\tRADEON_SCLK_FORCE_HDP);\n\t\t\t} else if ((rdev->family == CHIP_R300) ||\n\t\t\t\t   (rdev->family == CHIP_R350)) {\n\t\t\t\ttmp |= (RADEON_SCLK_FORCE_HDP |\n\t\t\t\t\tRADEON_SCLK_FORCE_DISP1 |\n\t\t\t\t\tRADEON_SCLK_FORCE_DISP2 |\n\t\t\t\t\tRADEON_SCLK_FORCE_TOP |\n\t\t\t\t\tRADEON_SCLK_FORCE_IDCT |\n\t\t\t\t\tRADEON_SCLK_FORCE_VIP);\n\t\t\t}\n\t\t\tWREG32_PLL(RADEON_SCLK_CNTL, tmp);\n\n\t\t\tmdelay(16);\n\n\t\t\tif ((rdev->family == CHIP_R300) ||\n\t\t\t    (rdev->family == CHIP_R350)) {\n\t\t\t\ttmp = RREG32_PLL(R300_SCLK_CNTL2);\n\t\t\t\ttmp |= (R300_SCLK_FORCE_TCL |\n\t\t\t\t\tR300_SCLK_FORCE_GA |\n\t\t\t\t\tR300_SCLK_FORCE_CBA);\n\t\t\t\tWREG32_PLL(R300_SCLK_CNTL2, tmp);\n\t\t\t\tmdelay(16);\n\t\t\t}\n\n\t\t\tif (rdev->flags & RADEON_IS_IGP) {\n\t\t\t\ttmp = RREG32_PLL(RADEON_MCLK_CNTL);\n\t\t\t\ttmp &= ~(RADEON_FORCEON_MCLKA |\n\t\t\t\t\t RADEON_FORCEON_YCLKA);\n\t\t\t\tWREG32_PLL(RADEON_MCLK_CNTL, tmp);\n\t\t\t\tmdelay(16);\n\t\t\t}\n\n\t\t\tif ((rdev->family == CHIP_RV200) ||\n\t\t\t    (rdev->family == CHIP_RV250) ||\n\t\t\t    (rdev->family == CHIP_RV280)) {\n\t\t\t\ttmp = RREG32_PLL(RADEON_SCLK_MORE_CNTL);\n\t\t\t\ttmp |= RADEON_SCLK_MORE_FORCEON;\n\t\t\t\tWREG32_PLL(RADEON_SCLK_MORE_CNTL, tmp);\n\t\t\t\tmdelay(16);\n\t\t\t}\n\n\t\t\ttmp = RREG32_PLL(RADEON_PIXCLKS_CNTL);\n\t\t\ttmp &= ~(RADEON_PIX2CLK_ALWAYS_ONb |\n\t\t\t\t RADEON_PIX2CLK_DAC_ALWAYS_ONb |\n\t\t\t\t RADEON_PIXCLK_BLEND_ALWAYS_ONb |\n\t\t\t\t RADEON_PIXCLK_GV_ALWAYS_ONb |\n\t\t\t\t RADEON_PIXCLK_DIG_TMDS_ALWAYS_ONb |\n\t\t\t\t RADEON_PIXCLK_LVDS_ALWAYS_ONb |\n\t\t\t\t RADEON_PIXCLK_TMDS_ALWAYS_ONb);\n\n\t\t\tWREG32_PLL(RADEON_PIXCLKS_CNTL, tmp);\n\t\t\tmdelay(16);\n\n\t\t\ttmp = RREG32_PLL(RADEON_VCLK_ECP_CNTL);\n\t\t\ttmp &= ~(RADEON_PIXCLK_ALWAYS_ONb |\n\t\t\t\t RADEON_PIXCLK_DAC_ALWAYS_ONb);\n\t\t\tWREG32_PLL(RADEON_VCLK_ECP_CNTL, tmp);\n\t\t}\n\t}\n}\n\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}