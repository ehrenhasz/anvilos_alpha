{
  "module_name": "sislands_smc.h",
  "hash_id": "6fc65404a3d25db661b5f6d424b4b52ba3643d772230e4c9375ccca11c683515",
  "original_prompt": "Ingested from linux-6.6.14/drivers/gpu/drm/radeon/sislands_smc.h",
  "human_readable_source": " \n#ifndef PP_SISLANDS_SMC_H\n#define PP_SISLANDS_SMC_H\n\n#include \"ppsmc.h\"\n\n#pragma pack(push, 1)\n\n#define SISLANDS_MAX_SMC_PERFORMANCE_LEVELS_PER_SWSTATE 16\n\nstruct PP_SIslands_Dpm2PerfLevel\n{\n    uint8_t MaxPS;\n    uint8_t TgtAct;\n    uint8_t MaxPS_StepInc;\n    uint8_t MaxPS_StepDec;\n    uint8_t PSSamplingTime;\n    uint8_t NearTDPDec;\n    uint8_t AboveSafeInc;\n    uint8_t BelowSafeInc;\n    uint8_t PSDeltaLimit;\n    uint8_t PSDeltaWin;\n    uint16_t PwrEfficiencyRatio;\n    uint8_t Reserved[4];\n};\n\ntypedef struct PP_SIslands_Dpm2PerfLevel PP_SIslands_Dpm2PerfLevel;\n\nstruct PP_SIslands_DPM2Status\n{\n    uint32_t    dpm2Flags;\n    uint8_t     CurrPSkip;\n    uint8_t     CurrPSkipPowerShift;\n    uint8_t     CurrPSkipTDP;\n    uint8_t     CurrPSkipOCP;\n    uint8_t     MaxSPLLIndex;\n    uint8_t     MinSPLLIndex;\n    uint8_t     CurrSPLLIndex;\n    uint8_t     InfSweepMode;\n    uint8_t     InfSweepDir;\n    uint8_t     TDPexceeded;\n    uint8_t     reserved;\n    uint8_t     SwitchDownThreshold;\n    uint32_t    SwitchDownCounter;\n    uint32_t    SysScalingFactor;\n};\n\ntypedef struct PP_SIslands_DPM2Status PP_SIslands_DPM2Status;\n\nstruct PP_SIslands_DPM2Parameters\n{\n    uint32_t    TDPLimit;\n    uint32_t    NearTDPLimit;\n    uint32_t    SafePowerLimit;\n    uint32_t    PowerBoostLimit;\n    uint32_t    MinLimitDelta;\n};\ntypedef struct PP_SIslands_DPM2Parameters PP_SIslands_DPM2Parameters;\n\nstruct PP_SIslands_PAPMStatus\n{\n    uint32_t    EstimatedDGPU_T;\n    uint32_t    EstimatedDGPU_P;\n    uint32_t    EstimatedAPU_T;\n    uint32_t    EstimatedAPU_P;\n    uint8_t     dGPU_T_Limit_Exceeded;\n    uint8_t     reserved[3];\n};\ntypedef struct PP_SIslands_PAPMStatus PP_SIslands_PAPMStatus;\n\nstruct PP_SIslands_PAPMParameters {\n    uint32_t    NearTDPLimitTherm;\n    uint32_t    NearTDPLimitPAPM;\n    uint32_t    PlatformPowerLimit;\n    uint32_t    dGPU_T_Limit;\n    uint32_t    dGPU_T_Warning;\n    uint32_t    dGPU_T_Hysteresis;\n};\ntypedef struct PP_SIslands_PAPMParameters PP_SIslands_PAPMParameters;\n\nstruct SISLANDS_SMC_SCLK_VALUE {\n    uint32_t    vCG_SPLL_FUNC_CNTL;\n    uint32_t    vCG_SPLL_FUNC_CNTL_2;\n    uint32_t    vCG_SPLL_FUNC_CNTL_3;\n    uint32_t    vCG_SPLL_FUNC_CNTL_4;\n    uint32_t    vCG_SPLL_SPREAD_SPECTRUM;\n    uint32_t    vCG_SPLL_SPREAD_SPECTRUM_2;\n    uint32_t    sclk_value;\n};\n\ntypedef struct SISLANDS_SMC_SCLK_VALUE SISLANDS_SMC_SCLK_VALUE;\n\nstruct SISLANDS_SMC_MCLK_VALUE {\n    uint32_t    vMPLL_FUNC_CNTL;\n    uint32_t    vMPLL_FUNC_CNTL_1;\n    uint32_t    vMPLL_FUNC_CNTL_2;\n    uint32_t    vMPLL_AD_FUNC_CNTL;\n    uint32_t    vMPLL_DQ_FUNC_CNTL;\n    uint32_t    vMCLK_PWRMGT_CNTL;\n    uint32_t    vDLL_CNTL;\n    uint32_t    vMPLL_SS;\n    uint32_t    vMPLL_SS2;\n    uint32_t    mclk_value;\n};\n\ntypedef struct SISLANDS_SMC_MCLK_VALUE SISLANDS_SMC_MCLK_VALUE;\n\nstruct SISLANDS_SMC_VOLTAGE_VALUE {\n    uint16_t    value;\n    uint8_t     index;\n    uint8_t     phase_settings;\n};\n\ntypedef struct SISLANDS_SMC_VOLTAGE_VALUE SISLANDS_SMC_VOLTAGE_VALUE;\n\nstruct SISLANDS_SMC_HW_PERFORMANCE_LEVEL {\n    uint8_t                     ACIndex;\n    uint8_t                     displayWatermark;\n    uint8_t                     gen2PCIE;\n    uint8_t                     UVDWatermark;\n    uint8_t                     VCEWatermark;\n    uint8_t                     strobeMode;\n    uint8_t                     mcFlags;\n    uint8_t                     padding;\n    uint32_t                    aT;\n    uint32_t                    bSP;\n    SISLANDS_SMC_SCLK_VALUE     sclk;\n    SISLANDS_SMC_MCLK_VALUE     mclk;\n    SISLANDS_SMC_VOLTAGE_VALUE  vddc;\n    SISLANDS_SMC_VOLTAGE_VALUE  mvdd;\n    SISLANDS_SMC_VOLTAGE_VALUE  vddci;\n    SISLANDS_SMC_VOLTAGE_VALUE  std_vddc;\n    uint8_t                     hysteresisUp;\n    uint8_t                     hysteresisDown;\n    uint8_t                     stateFlags;\n    uint8_t                     arbRefreshState;\n    uint32_t                    SQPowerThrottle;\n    uint32_t                    SQPowerThrottle_2;\n    uint32_t                    MaxPoweredUpCU;\n    SISLANDS_SMC_VOLTAGE_VALUE  high_temp_vddc;\n    SISLANDS_SMC_VOLTAGE_VALUE  low_temp_vddc;\n    uint32_t                    reserved[2];\n    PP_SIslands_Dpm2PerfLevel   dpm2;\n};\n\n#define SISLANDS_SMC_STROBE_RATIO    0x0F\n#define SISLANDS_SMC_STROBE_ENABLE   0x10\n\n#define SISLANDS_SMC_MC_EDC_RD_FLAG  0x01\n#define SISLANDS_SMC_MC_EDC_WR_FLAG  0x02\n#define SISLANDS_SMC_MC_RTT_ENABLE   0x04\n#define SISLANDS_SMC_MC_STUTTER_EN   0x08\n#define SISLANDS_SMC_MC_PG_EN        0x10\n\ntypedef struct SISLANDS_SMC_HW_PERFORMANCE_LEVEL SISLANDS_SMC_HW_PERFORMANCE_LEVEL;\n\nstruct SISLANDS_SMC_SWSTATE {\n\tuint8_t                             flags;\n\tuint8_t                             levelCount;\n\tuint8_t                             padding2;\n\tuint8_t                             padding3;\n\tSISLANDS_SMC_HW_PERFORMANCE_LEVEL   levels[];\n};\n\ntypedef struct SISLANDS_SMC_SWSTATE SISLANDS_SMC_SWSTATE;\n\nstruct SISLANDS_SMC_SWSTATE_SINGLE {\n\tuint8_t                             flags;\n\tuint8_t                             levelCount;\n\tuint8_t                             padding2;\n\tuint8_t                             padding3;\n\tSISLANDS_SMC_HW_PERFORMANCE_LEVEL   level;\n};\n\n#define SISLANDS_SMC_VOLTAGEMASK_VDDC  0\n#define SISLANDS_SMC_VOLTAGEMASK_MVDD  1\n#define SISLANDS_SMC_VOLTAGEMASK_VDDCI 2\n#define SISLANDS_SMC_VOLTAGEMASK_VDDC_PHASE_SHEDDING 3\n#define SISLANDS_SMC_VOLTAGEMASK_MAX   4\n\nstruct SISLANDS_SMC_VOLTAGEMASKTABLE {\n    uint32_t lowMask[SISLANDS_SMC_VOLTAGEMASK_MAX];\n};\n\ntypedef struct SISLANDS_SMC_VOLTAGEMASKTABLE SISLANDS_SMC_VOLTAGEMASKTABLE;\n\n#define SISLANDS_MAX_NO_VREG_STEPS 32\n\nstruct SISLANDS_SMC_STATETABLE {\n\tuint8_t\t\t\t\t\tthermalProtectType;\n\tuint8_t\t\t\t\t\tsystemFlags;\n\tuint8_t\t\t\t\t\tmaxVDDCIndexInPPTable;\n\tuint8_t\t\t\t\t\textraFlags;\n\tuint32_t\t\t\t\tlowSMIO[SISLANDS_MAX_NO_VREG_STEPS];\n\tSISLANDS_SMC_VOLTAGEMASKTABLE\t\tvoltageMaskTable;\n\tSISLANDS_SMC_VOLTAGEMASKTABLE\t\tphaseMaskTable;\n\tPP_SIslands_DPM2Parameters\t\tdpm2Params;\n\tstruct SISLANDS_SMC_SWSTATE_SINGLE\tinitialState;\n\tstruct SISLANDS_SMC_SWSTATE_SINGLE      ACPIState;\n\tstruct SISLANDS_SMC_SWSTATE_SINGLE      ULVState;\n\tSISLANDS_SMC_SWSTATE\t\t\tdriverState;\n\tSISLANDS_SMC_HW_PERFORMANCE_LEVEL\tdpmLevels[SISLANDS_MAX_SMC_PERFORMANCE_LEVELS_PER_SWSTATE];\n};\n\ntypedef struct SISLANDS_SMC_STATETABLE SISLANDS_SMC_STATETABLE;\n\n#define SI_SMC_SOFT_REGISTER_mclk_chg_timeout         0x0\n#define SI_SMC_SOFT_REGISTER_delay_vreg               0xC\n#define SI_SMC_SOFT_REGISTER_delay_acpi               0x28\n#define SI_SMC_SOFT_REGISTER_seq_index                0x5C\n#define SI_SMC_SOFT_REGISTER_mvdd_chg_time            0x60\n#define SI_SMC_SOFT_REGISTER_mclk_switch_lim          0x70\n#define SI_SMC_SOFT_REGISTER_watermark_threshold      0x78\n#define SI_SMC_SOFT_REGISTER_phase_shedding_delay     0x88\n#define SI_SMC_SOFT_REGISTER_ulv_volt_change_delay    0x8C\n#define SI_SMC_SOFT_REGISTER_mc_block_delay           0x98\n#define SI_SMC_SOFT_REGISTER_ticks_per_us             0xA8\n#define SI_SMC_SOFT_REGISTER_crtc_index               0xC4\n#define SI_SMC_SOFT_REGISTER_mclk_change_block_cp_min 0xC8\n#define SI_SMC_SOFT_REGISTER_mclk_change_block_cp_max 0xCC\n#define SI_SMC_SOFT_REGISTER_non_ulv_pcie_link_width  0xF4\n#define SI_SMC_SOFT_REGISTER_tdr_is_about_to_happen   0xFC\n#define SI_SMC_SOFT_REGISTER_vr_hot_gpio              0x100\n#define SI_SMC_SOFT_REGISTER_svi_rework_plat_type     0x118\n#define SI_SMC_SOFT_REGISTER_svi_rework_gpio_id_svd   0x11c\n#define SI_SMC_SOFT_REGISTER_svi_rework_gpio_id_svc   0x120\n\nstruct PP_SIslands_FanTable {\n\tuint8_t  fdo_mode;\n\tuint8_t  padding;\n\tint16_t  temp_min;\n\tint16_t  temp_med;\n\tint16_t  temp_max;\n\tint16_t  slope1;\n\tint16_t  slope2;\n\tint16_t  fdo_min;\n\tint16_t  hys_up;\n\tint16_t  hys_down;\n\tint16_t  hys_slope;\n\tint16_t  temp_resp_lim;\n\tint16_t  temp_curr;\n\tint16_t  slope_curr;\n\tint16_t  pwm_curr;\n\tuint32_t refresh_period;\n\tint16_t  fdo_max;\n\tuint8_t  temp_src;\n\tint8_t  padding2;\n};\n\ntypedef struct PP_SIslands_FanTable PP_SIslands_FanTable;\n\n#define SMC_SISLANDS_LKGE_LUT_NUM_OF_TEMP_ENTRIES 16\n#define SMC_SISLANDS_LKGE_LUT_NUM_OF_VOLT_ENTRIES 32\n\n#define SMC_SISLANDS_SCALE_I  7\n#define SMC_SISLANDS_SCALE_R 12\n\nstruct PP_SIslands_CacConfig {\n    uint16_t   cac_lkge_lut[SMC_SISLANDS_LKGE_LUT_NUM_OF_TEMP_ENTRIES][SMC_SISLANDS_LKGE_LUT_NUM_OF_VOLT_ENTRIES];\n    uint32_t   lkge_lut_V0;\n    uint32_t   lkge_lut_Vstep;\n    uint32_t   WinTime;\n    uint32_t   R_LL;\n    uint32_t   calculation_repeats;\n    uint32_t   l2numWin_TDP;\n    uint32_t   dc_cac;\n    uint8_t    lts_truncate_n;\n    uint8_t    SHIFT_N;\n    uint8_t    log2_PG_LKG_SCALE;\n    uint8_t    cac_temp;\n    uint32_t   lkge_lut_T0;\n    uint32_t   lkge_lut_Tstep;\n};\n\ntypedef struct PP_SIslands_CacConfig PP_SIslands_CacConfig;\n\n#define SMC_SISLANDS_MC_REGISTER_ARRAY_SIZE 16\n#define SMC_SISLANDS_MC_REGISTER_ARRAY_SET_COUNT 20\n\nstruct SMC_SIslands_MCRegisterAddress {\n    uint16_t s0;\n    uint16_t s1;\n};\n\ntypedef struct SMC_SIslands_MCRegisterAddress SMC_SIslands_MCRegisterAddress;\n\nstruct SMC_SIslands_MCRegisterSet {\n    uint32_t value[SMC_SISLANDS_MC_REGISTER_ARRAY_SIZE];\n};\n\ntypedef struct SMC_SIslands_MCRegisterSet SMC_SIslands_MCRegisterSet;\n\nstruct SMC_SIslands_MCRegisters {\n    uint8_t                             last;\n    uint8_t                             reserved[3];\n    SMC_SIslands_MCRegisterAddress      address[SMC_SISLANDS_MC_REGISTER_ARRAY_SIZE];\n    SMC_SIslands_MCRegisterSet          data[SMC_SISLANDS_MC_REGISTER_ARRAY_SET_COUNT];\n};\n\ntypedef struct SMC_SIslands_MCRegisters SMC_SIslands_MCRegisters;\n\nstruct SMC_SIslands_MCArbDramTimingRegisterSet {\n    uint32_t mc_arb_dram_timing;\n    uint32_t mc_arb_dram_timing2;\n    uint8_t  mc_arb_rfsh_rate;\n    uint8_t  mc_arb_burst_time;\n    uint8_t  padding[2];\n};\n\ntypedef struct SMC_SIslands_MCArbDramTimingRegisterSet SMC_SIslands_MCArbDramTimingRegisterSet;\n\nstruct SMC_SIslands_MCArbDramTimingRegisters {\n    uint8_t                                     arb_current;\n    uint8_t                                     reserved[3];\n    SMC_SIslands_MCArbDramTimingRegisterSet     data[16];\n};\n\ntypedef struct SMC_SIslands_MCArbDramTimingRegisters SMC_SIslands_MCArbDramTimingRegisters;\n\nstruct SMC_SISLANDS_SPLL_DIV_TABLE {\n    uint32_t    freq[256];\n    uint32_t    ss[256];\n};\n\n#define SMC_SISLANDS_SPLL_DIV_TABLE_FBDIV_MASK  0x01ffffff\n#define SMC_SISLANDS_SPLL_DIV_TABLE_FBDIV_SHIFT 0\n#define SMC_SISLANDS_SPLL_DIV_TABLE_PDIV_MASK   0xfe000000\n#define SMC_SISLANDS_SPLL_DIV_TABLE_PDIV_SHIFT  25\n#define SMC_SISLANDS_SPLL_DIV_TABLE_CLKV_MASK   0x000fffff\n#define SMC_SISLANDS_SPLL_DIV_TABLE_CLKV_SHIFT  0\n#define SMC_SISLANDS_SPLL_DIV_TABLE_CLKS_MASK   0xfff00000\n#define SMC_SISLANDS_SPLL_DIV_TABLE_CLKS_SHIFT  20\n\ntypedef struct SMC_SISLANDS_SPLL_DIV_TABLE SMC_SISLANDS_SPLL_DIV_TABLE;\n\n#define SMC_SISLANDS_DTE_MAX_FILTER_STAGES 5\n\n#define SMC_SISLANDS_DTE_MAX_TEMPERATURE_DEPENDENT_ARRAY_SIZE 16\n\nstruct Smc_SIslands_DTE_Configuration {\n    uint32_t tau[SMC_SISLANDS_DTE_MAX_FILTER_STAGES];\n    uint32_t R[SMC_SISLANDS_DTE_MAX_FILTER_STAGES];\n    uint32_t K;\n    uint32_t T0;\n    uint32_t MaxT;\n    uint8_t  WindowSize;\n    uint8_t  Tdep_count;\n    uint8_t  temp_select;\n    uint8_t  DTE_mode;\n    uint8_t  T_limits[SMC_SISLANDS_DTE_MAX_TEMPERATURE_DEPENDENT_ARRAY_SIZE];\n    uint32_t Tdep_tau[SMC_SISLANDS_DTE_MAX_TEMPERATURE_DEPENDENT_ARRAY_SIZE];\n    uint32_t Tdep_R[SMC_SISLANDS_DTE_MAX_TEMPERATURE_DEPENDENT_ARRAY_SIZE];\n    uint32_t Tthreshold;\n};\n\ntypedef struct Smc_SIslands_DTE_Configuration Smc_SIslands_DTE_Configuration;\n\n#define SMC_SISLANDS_DTE_STATUS_FLAG_DTE_ON 1\n\n#define SISLANDS_SMC_FIRMWARE_HEADER_LOCATION 0x10000\n\n#define SISLANDS_SMC_FIRMWARE_HEADER_version                   0x0\n#define SISLANDS_SMC_FIRMWARE_HEADER_flags                     0x4\n#define SISLANDS_SMC_FIRMWARE_HEADER_softRegisters             0xC\n#define SISLANDS_SMC_FIRMWARE_HEADER_stateTable                0x10\n#define SISLANDS_SMC_FIRMWARE_HEADER_fanTable                  0x14\n#define SISLANDS_SMC_FIRMWARE_HEADER_CacConfigTable            0x18\n#define SISLANDS_SMC_FIRMWARE_HEADER_mcRegisterTable           0x24\n#define SISLANDS_SMC_FIRMWARE_HEADER_mcArbDramAutoRefreshTable 0x30\n#define SISLANDS_SMC_FIRMWARE_HEADER_spllTable                 0x38\n#define SISLANDS_SMC_FIRMWARE_HEADER_DteConfiguration          0x40\n#define SISLANDS_SMC_FIRMWARE_HEADER_PAPMParameters            0x48\n\n#pragma pack(pop)\n\nint si_copy_bytes_to_smc(struct radeon_device *rdev,\n\t\t\t u32 smc_start_address,\n\t\t\t const u8 *src, u32 byte_count, u32 limit);\nvoid si_start_smc(struct radeon_device *rdev);\nvoid si_reset_smc(struct radeon_device *rdev);\nint si_program_jump_on_start(struct radeon_device *rdev);\nvoid si_stop_smc_clock(struct radeon_device *rdev);\nvoid si_start_smc_clock(struct radeon_device *rdev);\nbool si_is_smc_running(struct radeon_device *rdev);\nPPSMC_Result si_send_msg_to_smc(struct radeon_device *rdev, PPSMC_Msg msg);\nPPSMC_Result si_wait_for_smc_inactive(struct radeon_device *rdev);\nint si_load_smc_ucode(struct radeon_device *rdev, u32 limit);\nint si_read_smc_sram_dword(struct radeon_device *rdev, u32 smc_address,\n\t\t\t   u32 *value, u32 limit);\nint si_write_smc_sram_dword(struct radeon_device *rdev, u32 smc_address,\n\t\t\t    u32 value, u32 limit);\n\n#endif\n\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}