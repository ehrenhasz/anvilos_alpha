{
  "module_name": "hdmi.h",
  "hash_id": "ed2c818923c54b0502587876d95a05fda5bd7f0047c71674a8016d5ed2d3dd62",
  "original_prompt": "Ingested from linux-6.6.14/drivers/gpu/drm/msm/hdmi/hdmi.h",
  "human_readable_source": " \n \n\n#ifndef __HDMI_CONNECTOR_H__\n#define __HDMI_CONNECTOR_H__\n\n#include <linux/i2c.h>\n#include <linux/clk.h>\n#include <linux/platform_device.h>\n#include <linux/regulator/consumer.h>\n#include <linux/gpio/consumer.h>\n#include <linux/hdmi.h>\n\n#include <drm/drm_bridge.h>\n\n#include \"msm_drv.h\"\n#include \"hdmi.xml.h\"\n\nstruct hdmi_phy;\nstruct hdmi_platform_config;\n\nstruct hdmi_audio {\n\tbool enabled;\n\tstruct hdmi_audio_infoframe infoframe;\n\tint rate;\n};\n\nstruct hdmi_hdcp_ctrl;\n\nstruct hdmi {\n\tstruct drm_device *dev;\n\tstruct platform_device *pdev;\n\tstruct platform_device *audio_pdev;\n\n\tconst struct hdmi_platform_config *config;\n\n\t \n\tstruct hdmi_audio audio;\n\n\t \n\tbool power_on;\n\tunsigned long int pixclock;\n\n\tvoid __iomem *mmio;\n\tvoid __iomem *qfprom_mmio;\n\tphys_addr_t mmio_phy_addr;\n\n\tstruct regulator_bulk_data *hpd_regs;\n\tstruct regulator_bulk_data *pwr_regs;\n\tstruct clk **hpd_clks;\n\tstruct clk **pwr_clks;\n\n\tstruct gpio_desc *hpd_gpiod;\n\n\tstruct hdmi_phy *phy;\n\tstruct device *phy_dev;\n\n\tstruct i2c_adapter *i2c;\n\tstruct drm_connector *connector;\n\tstruct drm_bridge *bridge;\n\n\tstruct drm_bridge *next_bridge;\n\n\t \n\tstruct drm_encoder *encoder;\n\n\tbool hdmi_mode;                \n\n\tint irq;\n\tstruct workqueue_struct *workq;\n\n\tstruct hdmi_hdcp_ctrl *hdcp_ctrl;\n\n\t \n\tspinlock_t reg_lock;\n};\n\n \nstruct hdmi_platform_config {\n\t \n\tconst char **hpd_reg_names;\n\tint hpd_reg_cnt;\n\n\t \n\tconst char **pwr_reg_names;\n\tint pwr_reg_cnt;\n\n\t \n\tconst char **hpd_clk_names;\n\tconst long unsigned *hpd_freq;\n\tint hpd_clk_cnt;\n\n\t \n\tconst char **pwr_clk_names;\n\tint pwr_clk_cnt;\n};\n\nstruct hdmi_bridge {\n\tstruct drm_bridge base;\n\tstruct hdmi *hdmi;\n\tstruct work_struct hpd_work;\n};\n#define to_hdmi_bridge(x) container_of(x, struct hdmi_bridge, base)\n\nvoid msm_hdmi_set_mode(struct hdmi *hdmi, bool power_on);\n\nstatic inline void hdmi_write(struct hdmi *hdmi, u32 reg, u32 data)\n{\n\tmsm_writel(data, hdmi->mmio + reg);\n}\n\nstatic inline u32 hdmi_read(struct hdmi *hdmi, u32 reg)\n{\n\treturn msm_readl(hdmi->mmio + reg);\n}\n\nstatic inline u32 hdmi_qfprom_read(struct hdmi *hdmi, u32 reg)\n{\n\treturn msm_readl(hdmi->qfprom_mmio + reg);\n}\n\n \n\nenum hdmi_phy_type {\n\tMSM_HDMI_PHY_8x60,\n\tMSM_HDMI_PHY_8960,\n\tMSM_HDMI_PHY_8x74,\n\tMSM_HDMI_PHY_8996,\n\tMSM_HDMI_PHY_MAX,\n};\n\nstruct hdmi_phy_cfg {\n\tenum hdmi_phy_type type;\n\tvoid (*powerup)(struct hdmi_phy *phy, unsigned long int pixclock);\n\tvoid (*powerdown)(struct hdmi_phy *phy);\n\tconst char * const *reg_names;\n\tint num_regs;\n\tconst char * const *clk_names;\n\tint num_clks;\n};\n\nextern const struct hdmi_phy_cfg msm_hdmi_phy_8x60_cfg;\nextern const struct hdmi_phy_cfg msm_hdmi_phy_8960_cfg;\nextern const struct hdmi_phy_cfg msm_hdmi_phy_8x74_cfg;\nextern const struct hdmi_phy_cfg msm_hdmi_phy_8996_cfg;\n\nstruct hdmi_phy {\n\tstruct platform_device *pdev;\n\tvoid __iomem *mmio;\n\tstruct hdmi_phy_cfg *cfg;\n\tconst struct hdmi_phy_funcs *funcs;\n\tstruct regulator_bulk_data *regs;\n\tstruct clk **clks;\n};\n\nstatic inline void hdmi_phy_write(struct hdmi_phy *phy, u32 reg, u32 data)\n{\n\tmsm_writel(data, phy->mmio + reg);\n}\n\nstatic inline u32 hdmi_phy_read(struct hdmi_phy *phy, u32 reg)\n{\n\treturn msm_readl(phy->mmio + reg);\n}\n\nint msm_hdmi_phy_resource_enable(struct hdmi_phy *phy);\nvoid msm_hdmi_phy_resource_disable(struct hdmi_phy *phy);\nvoid msm_hdmi_phy_powerup(struct hdmi_phy *phy, unsigned long int pixclock);\nvoid msm_hdmi_phy_powerdown(struct hdmi_phy *phy);\nvoid __init msm_hdmi_phy_driver_register(void);\nvoid __exit msm_hdmi_phy_driver_unregister(void);\n\n#ifdef CONFIG_COMMON_CLK\nint msm_hdmi_pll_8960_init(struct platform_device *pdev);\nint msm_hdmi_pll_8996_init(struct platform_device *pdev);\n#else\nstatic inline int msm_hdmi_pll_8960_init(struct platform_device *pdev)\n{\n\treturn -ENODEV;\n}\n\nstatic inline int msm_hdmi_pll_8996_init(struct platform_device *pdev)\n{\n\treturn -ENODEV;\n}\n#endif\n\n \n \n#define\tMSM_HDMI_AUDIO_CHANNEL_2\t0\n#define\tMSM_HDMI_AUDIO_CHANNEL_4\t1\n#define\tMSM_HDMI_AUDIO_CHANNEL_6\t2\n#define\tMSM_HDMI_AUDIO_CHANNEL_8\t3\n\n#define\tHDMI_SAMPLE_RATE_32KHZ\t\t0\n#define\tHDMI_SAMPLE_RATE_44_1KHZ\t1\n#define\tHDMI_SAMPLE_RATE_48KHZ\t\t2\n#define\tHDMI_SAMPLE_RATE_88_2KHZ\t3\n#define\tHDMI_SAMPLE_RATE_96KHZ\t\t4\n#define\tHDMI_SAMPLE_RATE_176_4KHZ\t5\n#define\tHDMI_SAMPLE_RATE_192KHZ\t\t6\n\nint msm_hdmi_audio_update(struct hdmi *hdmi);\nint msm_hdmi_audio_info_setup(struct hdmi *hdmi, bool enabled,\n\tuint32_t num_of_channels, uint32_t channel_allocation,\n\tuint32_t level_shift, bool down_mix);\nvoid msm_hdmi_audio_set_sample_rate(struct hdmi *hdmi, int rate);\n\n\n \n\nstruct drm_bridge *msm_hdmi_bridge_init(struct hdmi *hdmi);\nvoid msm_hdmi_bridge_destroy(struct drm_bridge *bridge);\n\nvoid msm_hdmi_hpd_irq(struct drm_bridge *bridge);\nenum drm_connector_status msm_hdmi_bridge_detect(\n\t\tstruct drm_bridge *bridge);\nint msm_hdmi_hpd_enable(struct drm_bridge *bridge);\nvoid msm_hdmi_hpd_disable(struct hdmi_bridge *hdmi_bridge);\n\n \n\nvoid msm_hdmi_i2c_irq(struct i2c_adapter *i2c);\nvoid msm_hdmi_i2c_destroy(struct i2c_adapter *i2c);\nstruct i2c_adapter *msm_hdmi_i2c_init(struct hdmi *hdmi);\n\n \n#ifdef CONFIG_DRM_MSM_HDMI_HDCP\nstruct hdmi_hdcp_ctrl *msm_hdmi_hdcp_init(struct hdmi *hdmi);\nvoid msm_hdmi_hdcp_destroy(struct hdmi *hdmi);\nvoid msm_hdmi_hdcp_on(struct hdmi_hdcp_ctrl *hdcp_ctrl);\nvoid msm_hdmi_hdcp_off(struct hdmi_hdcp_ctrl *hdcp_ctrl);\nvoid msm_hdmi_hdcp_irq(struct hdmi_hdcp_ctrl *hdcp_ctrl);\n#else\nstatic inline struct hdmi_hdcp_ctrl *msm_hdmi_hdcp_init(struct hdmi *hdmi)\n{\n\treturn ERR_PTR(-ENXIO);\n}\nstatic inline void msm_hdmi_hdcp_destroy(struct hdmi *hdmi) {}\nstatic inline void msm_hdmi_hdcp_on(struct hdmi_hdcp_ctrl *hdcp_ctrl) {}\nstatic inline void msm_hdmi_hdcp_off(struct hdmi_hdcp_ctrl *hdcp_ctrl) {}\nstatic inline void msm_hdmi_hdcp_irq(struct hdmi_hdcp_ctrl *hdcp_ctrl) {}\n#endif\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}