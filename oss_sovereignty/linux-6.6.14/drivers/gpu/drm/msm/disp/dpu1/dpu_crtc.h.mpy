{
  "module_name": "dpu_crtc.h",
  "hash_id": "a4a18d33666bc711f51aa7c921b2772cf1cf9459a6263383afb790f351c56749",
  "original_prompt": "Ingested from linux-6.6.14/drivers/gpu/drm/msm/disp/dpu1/dpu_crtc.h",
  "human_readable_source": " \n \n\n#ifndef _DPU_CRTC_H_\n#define _DPU_CRTC_H_\n\n#include <linux/kthread.h>\n#include <drm/drm_crtc.h>\n#include \"dpu_kms.h\"\n#include \"dpu_core_perf.h\"\n\n#define DPU_CRTC_NAME_SIZE\t12\n\n \n#define DPU_CRTC_FRAME_EVENT_SIZE\t4\n\n \nenum dpu_crtc_client_type {\n\tRT_CLIENT,\n\tNRT_CLIENT,\n};\n\n \nenum dpu_crtc_smmu_state {\n\tATTACHED = 0,\n\tDETACHED,\n\tATTACH_ALL_REQ,\n\tDETACH_ALL_REQ,\n};\n\n \nenum dpu_crtc_smmu_state_transition_type {\n\tNONE,\n\tPRE_COMMIT,\n\tPOST_COMMIT\n};\n\n \nstruct dpu_crtc_smmu_state_data {\n\tuint32_t state;\n\tuint32_t transition_type;\n\tuint32_t transition_error;\n};\n\n \nenum dpu_crtc_crc_source {\n\tDPU_CRTC_CRC_SOURCE_NONE = 0,\n\tDPU_CRTC_CRC_SOURCE_LAYER_MIXER,\n\tDPU_CRTC_CRC_SOURCE_ENCODER,\n\tDPU_CRTC_CRC_SOURCE_MAX,\n\tDPU_CRTC_CRC_SOURCE_INVALID = -1\n};\n\n \nstruct dpu_crtc_mixer {\n\tstruct dpu_hw_mixer *hw_lm;\n\tstruct dpu_hw_ctl *lm_ctl;\n\tstruct dpu_hw_dspp *hw_dspp;\n\tu32 mixer_op_mode;\n};\n\n \nstruct dpu_crtc_frame_event {\n\tstruct kthread_work work;\n\tstruct drm_crtc *crtc;\n\tstruct list_head list;\n\tktime_t ts;\n\tu32 event;\n};\n\n \n#define DPU_CRTC_MAX_EVENT_COUNT\t16\n\n \nstruct dpu_crtc {\n\tstruct drm_crtc base;\n\tchar name[DPU_CRTC_NAME_SIZE];\n\n\tstruct drm_pending_vblank_event *event;\n\tu32 vsync_count;\n\n\tu32 vblank_cb_count;\n\tu64 play_count;\n\tktime_t vblank_cb_time;\n\tbool enabled;\n\n\tstruct list_head feature_list;\n\tstruct list_head active_list;\n\tstruct list_head dirty_list;\n\tstruct list_head ad_dirty;\n\tstruct list_head ad_active;\n\n\tatomic_t frame_pending;\n\tstruct dpu_crtc_frame_event frame_events[DPU_CRTC_FRAME_EVENT_SIZE];\n\tstruct list_head frame_event_list;\n\tspinlock_t spin_lock;\n\tstruct completion frame_done_comp;\n\n\t \n\tspinlock_t event_lock;\n\n\tstruct dpu_core_perf_params cur_perf;\n\n\tstruct dpu_crtc_smmu_state_data smmu_state;\n};\n\n#define to_dpu_crtc(x) container_of(x, struct dpu_crtc, base)\n\n \nstruct dpu_crtc_state {\n\tstruct drm_crtc_state base;\n\n\tbool bw_control;\n\tbool bw_split_vote;\n\tstruct drm_rect lm_bounds[CRTC_DUAL_MIXERS];\n\n\tuint64_t input_fence_timeout_ns;\n\n\tstruct dpu_core_perf_params new_perf;\n\n\t \n\tu32 num_mixers;\n\tstruct dpu_crtc_mixer mixers[CRTC_DUAL_MIXERS];\n\n\tu32 num_ctls;\n\tstruct dpu_hw_ctl *hw_ctls[CRTC_DUAL_MIXERS];\n\n\tenum dpu_crtc_crc_source crc_source;\n\tint crc_frame_skip_count;\n};\n\n#define to_dpu_crtc_state(x) \\\n\tcontainer_of(x, struct dpu_crtc_state, base)\n\n \nstatic inline int dpu_crtc_frame_pending(struct drm_crtc *crtc)\n{\n\treturn crtc ? atomic_read(&to_dpu_crtc(crtc)->frame_pending) : -EINVAL;\n}\n\n \nint dpu_crtc_vblank(struct drm_crtc *crtc, bool en);\n\n \nvoid dpu_crtc_vblank_callback(struct drm_crtc *crtc);\n\n \nvoid dpu_crtc_commit_kickoff(struct drm_crtc *crtc);\n\n \nvoid dpu_crtc_complete_commit(struct drm_crtc *crtc);\n\n \nstruct drm_crtc *dpu_crtc_init(struct drm_device *dev, struct drm_plane *plane,\n\t\t\t       struct drm_plane *cursor);\n\n \nint dpu_crtc_register_custom_event(struct dpu_kms *kms,\n\t\tstruct drm_crtc *crtc_drm, u32 event, bool en);\n\n \nenum dpu_intf_mode dpu_crtc_get_intf_mode(struct drm_crtc *crtc);\n\n \nstatic inline enum dpu_crtc_client_type dpu_crtc_get_client_type(\n\t\t\t\t\t\tstruct drm_crtc *crtc)\n{\n\treturn crtc && crtc->state ? RT_CLIENT : NRT_CLIENT;\n}\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}