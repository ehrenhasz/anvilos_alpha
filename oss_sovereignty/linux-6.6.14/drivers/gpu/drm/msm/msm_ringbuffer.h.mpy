{
  "module_name": "msm_ringbuffer.h",
  "hash_id": "be23e8dba04b63f312edf1ff19759c42c56fca791f8c2af7a7f4a51f143b1b80",
  "original_prompt": "Ingested from linux-6.6.14/drivers/gpu/drm/msm/msm_ringbuffer.h",
  "human_readable_source": " \n \n\n#ifndef __MSM_RINGBUFFER_H__\n#define __MSM_RINGBUFFER_H__\n\n#include \"drm/gpu_scheduler.h\"\n#include \"msm_drv.h\"\n\n#define rbmemptr(ring, member)  \\\n\t((ring)->memptrs_iova + offsetof(struct msm_rbmemptrs, member))\n\n#define rbmemptr_stats(ring, index, member) \\\n\t(rbmemptr((ring), stats) + \\\n\t ((index) * sizeof(struct msm_gpu_submit_stats)) + \\\n\t offsetof(struct msm_gpu_submit_stats, member))\n\nstruct msm_gpu_submit_stats {\n\tu64 cpcycles_start;\n\tu64 cpcycles_end;\n\tu64 alwayson_start;\n\tu64 alwayson_end;\n};\n\n#define MSM_GPU_SUBMIT_STATS_COUNT 64\n\nstruct msm_rbmemptrs {\n\tvolatile uint32_t rptr;\n\tvolatile uint32_t fence;\n\n\tvolatile struct msm_gpu_submit_stats stats[MSM_GPU_SUBMIT_STATS_COUNT];\n\tvolatile u64 ttbr0;\n};\n\nstruct msm_cp_state {\n\tuint64_t ib1_base, ib2_base;\n\tuint32_t ib1_rem, ib2_rem;\n};\n\nstruct msm_ringbuffer {\n\tstruct msm_gpu *gpu;\n\tint id;\n\tstruct drm_gem_object *bo;\n\tuint32_t *start, *end, *cur, *next;\n\n\t \n\tstruct drm_gpu_scheduler sched;\n\n\t \n\tstruct list_head submits;\n\tspinlock_t submit_lock;\n\n\tuint64_t iova;\n\tuint32_t hangcheck_fence;\n\tstruct msm_rbmemptrs *memptrs;\n\tuint64_t memptrs_iova;\n\tstruct msm_fence_context *fctx;\n\n\t \n\tint hangcheck_progress_retries;\n\n\t \n\tstruct msm_cp_state last_cp_state;\n\n\t \n\tspinlock_t preempt_lock;\n};\n\nstruct msm_ringbuffer *msm_ringbuffer_new(struct msm_gpu *gpu, int id,\n\t\tvoid *memptrs, uint64_t memptrs_iova);\nvoid msm_ringbuffer_destroy(struct msm_ringbuffer *ring);\n\n \n\nstatic inline void\nOUT_RING(struct msm_ringbuffer *ring, uint32_t data)\n{\n\t \n\tif (ring->next == ring->end)\n\t\tring->next = ring->start;\n\t*(ring->next++) = data;\n}\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}