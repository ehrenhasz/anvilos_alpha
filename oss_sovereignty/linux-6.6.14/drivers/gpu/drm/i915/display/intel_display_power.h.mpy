{
  "module_name": "intel_display_power.h",
  "hash_id": "7f9d6c96bc389900b114ac7cd9fa25cba1bdc971955a934943e6e909fbd9545c",
  "original_prompt": "Ingested from linux-6.6.14/drivers/gpu/drm/i915/display/intel_display_power.h",
  "human_readable_source": " \n \n\n#ifndef __INTEL_DISPLAY_POWER_H__\n#define __INTEL_DISPLAY_POWER_H__\n\n#include <linux/mutex.h>\n#include <linux/workqueue.h>\n\n#include \"intel_wakeref.h\"\n\nenum aux_ch;\nenum port;\nstruct drm_i915_private;\nstruct i915_power_well;\nstruct intel_encoder;\nstruct seq_file;\n\n \nenum intel_display_power_domain {\n\tPOWER_DOMAIN_DISPLAY_CORE,\n\tPOWER_DOMAIN_PIPE_A,\n\tPOWER_DOMAIN_PIPE_B,\n\tPOWER_DOMAIN_PIPE_C,\n\tPOWER_DOMAIN_PIPE_D,\n\tPOWER_DOMAIN_PIPE_PANEL_FITTER_A,\n\tPOWER_DOMAIN_PIPE_PANEL_FITTER_B,\n\tPOWER_DOMAIN_PIPE_PANEL_FITTER_C,\n\tPOWER_DOMAIN_PIPE_PANEL_FITTER_D,\n\tPOWER_DOMAIN_TRANSCODER_A,\n\tPOWER_DOMAIN_TRANSCODER_B,\n\tPOWER_DOMAIN_TRANSCODER_C,\n\tPOWER_DOMAIN_TRANSCODER_D,\n\tPOWER_DOMAIN_TRANSCODER_EDP,\n\tPOWER_DOMAIN_TRANSCODER_DSI_A,\n\tPOWER_DOMAIN_TRANSCODER_DSI_C,\n\n\t \n\tPOWER_DOMAIN_TRANSCODER_VDSC_PW2,\n\n\tPOWER_DOMAIN_PORT_DDI_LANES_A,\n\tPOWER_DOMAIN_PORT_DDI_LANES_B,\n\tPOWER_DOMAIN_PORT_DDI_LANES_C,\n\tPOWER_DOMAIN_PORT_DDI_LANES_D,\n\tPOWER_DOMAIN_PORT_DDI_LANES_E,\n\tPOWER_DOMAIN_PORT_DDI_LANES_F,\n\n\tPOWER_DOMAIN_PORT_DDI_LANES_TC1,\n\tPOWER_DOMAIN_PORT_DDI_LANES_TC2,\n\tPOWER_DOMAIN_PORT_DDI_LANES_TC3,\n\tPOWER_DOMAIN_PORT_DDI_LANES_TC4,\n\tPOWER_DOMAIN_PORT_DDI_LANES_TC5,\n\tPOWER_DOMAIN_PORT_DDI_LANES_TC6,\n\n\tPOWER_DOMAIN_PORT_DDI_IO_A,\n\tPOWER_DOMAIN_PORT_DDI_IO_B,\n\tPOWER_DOMAIN_PORT_DDI_IO_C,\n\tPOWER_DOMAIN_PORT_DDI_IO_D,\n\tPOWER_DOMAIN_PORT_DDI_IO_E,\n\tPOWER_DOMAIN_PORT_DDI_IO_F,\n\n\tPOWER_DOMAIN_PORT_DDI_IO_TC1,\n\tPOWER_DOMAIN_PORT_DDI_IO_TC2,\n\tPOWER_DOMAIN_PORT_DDI_IO_TC3,\n\tPOWER_DOMAIN_PORT_DDI_IO_TC4,\n\tPOWER_DOMAIN_PORT_DDI_IO_TC5,\n\tPOWER_DOMAIN_PORT_DDI_IO_TC6,\n\n\tPOWER_DOMAIN_PORT_DSI,\n\tPOWER_DOMAIN_PORT_CRT,\n\tPOWER_DOMAIN_PORT_OTHER,\n\tPOWER_DOMAIN_VGA,\n\tPOWER_DOMAIN_AUDIO_MMIO,\n\tPOWER_DOMAIN_AUDIO_PLAYBACK,\n\n\tPOWER_DOMAIN_AUX_IO_A,\n\tPOWER_DOMAIN_AUX_IO_B,\n\tPOWER_DOMAIN_AUX_IO_C,\n\tPOWER_DOMAIN_AUX_IO_D,\n\tPOWER_DOMAIN_AUX_IO_E,\n\tPOWER_DOMAIN_AUX_IO_F,\n\n\tPOWER_DOMAIN_AUX_A,\n\tPOWER_DOMAIN_AUX_B,\n\tPOWER_DOMAIN_AUX_C,\n\tPOWER_DOMAIN_AUX_D,\n\tPOWER_DOMAIN_AUX_E,\n\tPOWER_DOMAIN_AUX_F,\n\n\tPOWER_DOMAIN_AUX_USBC1,\n\tPOWER_DOMAIN_AUX_USBC2,\n\tPOWER_DOMAIN_AUX_USBC3,\n\tPOWER_DOMAIN_AUX_USBC4,\n\tPOWER_DOMAIN_AUX_USBC5,\n\tPOWER_DOMAIN_AUX_USBC6,\n\n\tPOWER_DOMAIN_AUX_TBT1,\n\tPOWER_DOMAIN_AUX_TBT2,\n\tPOWER_DOMAIN_AUX_TBT3,\n\tPOWER_DOMAIN_AUX_TBT4,\n\tPOWER_DOMAIN_AUX_TBT5,\n\tPOWER_DOMAIN_AUX_TBT6,\n\n\tPOWER_DOMAIN_GMBUS,\n\tPOWER_DOMAIN_MODESET,\n\tPOWER_DOMAIN_GT_IRQ,\n\tPOWER_DOMAIN_DC_OFF,\n\tPOWER_DOMAIN_TC_COLD_OFF,\n\tPOWER_DOMAIN_INIT,\n\n\tPOWER_DOMAIN_NUM,\n\tPOWER_DOMAIN_INVALID = POWER_DOMAIN_NUM,\n};\n\n#define POWER_DOMAIN_PIPE(pipe) ((pipe) + POWER_DOMAIN_PIPE_A)\n#define POWER_DOMAIN_PIPE_PANEL_FITTER(pipe) \\\n\t\t((pipe) + POWER_DOMAIN_PIPE_PANEL_FITTER_A)\n#define POWER_DOMAIN_TRANSCODER(tran) \\\n\t((tran) == TRANSCODER_EDP ? POWER_DOMAIN_TRANSCODER_EDP : \\\n\t (tran) + POWER_DOMAIN_TRANSCODER_A)\n\nstruct intel_power_domain_mask {\n\tDECLARE_BITMAP(bits, POWER_DOMAIN_NUM);\n};\n\nstruct i915_power_domains {\n\t \n\tbool initializing;\n\tbool display_core_suspended;\n\tint power_well_count;\n\n\tu32 dc_state;\n\tu32 target_dc_state;\n\tu32 allowed_dc_mask;\n\n\tintel_wakeref_t init_wakeref;\n\tintel_wakeref_t disable_wakeref;\n\n\tstruct mutex lock;\n\tint domain_use_count[POWER_DOMAIN_NUM];\n\n\tstruct delayed_work async_put_work;\n\tintel_wakeref_t async_put_wakeref;\n\tstruct intel_power_domain_mask async_put_domains[2];\n\tint async_put_next_delay;\n\n\tstruct i915_power_well *power_wells;\n};\n\nstruct intel_display_power_domain_set {\n\tstruct intel_power_domain_mask mask;\n#ifdef CONFIG_DRM_I915_DEBUG_RUNTIME_PM\n\tintel_wakeref_t wakerefs[POWER_DOMAIN_NUM];\n#endif\n};\n\n#define for_each_power_domain(__domain, __mask)\t\t\t\t\\\n\tfor ((__domain) = 0; (__domain) < POWER_DOMAIN_NUM; (__domain)++)\t\\\n\t\tfor_each_if(test_bit((__domain), (__mask)->bits))\n\nint intel_power_domains_init(struct drm_i915_private *dev_priv);\nvoid intel_power_domains_cleanup(struct drm_i915_private *dev_priv);\nvoid intel_power_domains_init_hw(struct drm_i915_private *dev_priv, bool resume);\nvoid intel_power_domains_driver_remove(struct drm_i915_private *dev_priv);\nvoid intel_power_domains_enable(struct drm_i915_private *dev_priv);\nvoid intel_power_domains_disable(struct drm_i915_private *dev_priv);\nvoid intel_power_domains_suspend(struct drm_i915_private *dev_priv, bool s2idle);\nvoid intel_power_domains_resume(struct drm_i915_private *dev_priv);\nvoid intel_power_domains_sanitize_state(struct drm_i915_private *dev_priv);\n\nvoid intel_display_power_suspend_late(struct drm_i915_private *i915);\nvoid intel_display_power_resume_early(struct drm_i915_private *i915);\nvoid intel_display_power_suspend(struct drm_i915_private *i915);\nvoid intel_display_power_resume(struct drm_i915_private *i915);\nvoid intel_display_power_set_target_dc_state(struct drm_i915_private *dev_priv,\n\t\t\t\t\t     u32 state);\n\nconst char *\nintel_display_power_domain_str(enum intel_display_power_domain domain);\n\nbool intel_display_power_is_enabled(struct drm_i915_private *dev_priv,\n\t\t\t\t    enum intel_display_power_domain domain);\nbool __intel_display_power_is_enabled(struct drm_i915_private *dev_priv,\n\t\t\t\t      enum intel_display_power_domain domain);\nintel_wakeref_t intel_display_power_get(struct drm_i915_private *dev_priv,\n\t\t\t\t\tenum intel_display_power_domain domain);\nintel_wakeref_t\nintel_display_power_get_if_enabled(struct drm_i915_private *dev_priv,\n\t\t\t\t   enum intel_display_power_domain domain);\nvoid __intel_display_power_put_async(struct drm_i915_private *i915,\n\t\t\t\t     enum intel_display_power_domain domain,\n\t\t\t\t     intel_wakeref_t wakeref,\n\t\t\t\t     int delay_ms);\nvoid intel_display_power_flush_work(struct drm_i915_private *i915);\n#if IS_ENABLED(CONFIG_DRM_I915_DEBUG_RUNTIME_PM)\nvoid intel_display_power_put(struct drm_i915_private *dev_priv,\n\t\t\t     enum intel_display_power_domain domain,\n\t\t\t     intel_wakeref_t wakeref);\nstatic inline void\nintel_display_power_put_async(struct drm_i915_private *i915,\n\t\t\t      enum intel_display_power_domain domain,\n\t\t\t      intel_wakeref_t wakeref)\n{\n\t__intel_display_power_put_async(i915, domain, wakeref, -1);\n}\n\nstatic inline void\nintel_display_power_put_async_delay(struct drm_i915_private *i915,\n\t\t\t\t    enum intel_display_power_domain domain,\n\t\t\t\t    intel_wakeref_t wakeref,\n\t\t\t\t    int delay_ms)\n{\n\t__intel_display_power_put_async(i915, domain, wakeref, delay_ms);\n}\n#else\nvoid intel_display_power_put_unchecked(struct drm_i915_private *dev_priv,\n\t\t\t\t       enum intel_display_power_domain domain);\n\nstatic inline void\nintel_display_power_put(struct drm_i915_private *i915,\n\t\t\tenum intel_display_power_domain domain,\n\t\t\tintel_wakeref_t wakeref)\n{\n\tintel_display_power_put_unchecked(i915, domain);\n}\n\nstatic inline void\nintel_display_power_put_async(struct drm_i915_private *i915,\n\t\t\t      enum intel_display_power_domain domain,\n\t\t\t      intel_wakeref_t wakeref)\n{\n\t__intel_display_power_put_async(i915, domain, -1, -1);\n}\n\nstatic inline void\nintel_display_power_put_async_delay(struct drm_i915_private *i915,\n\t\t\t\t    enum intel_display_power_domain domain,\n\t\t\t\t    intel_wakeref_t wakeref,\n\t\t\t\t    int delay_ms)\n{\n\t__intel_display_power_put_async(i915, domain, -1, delay_ms);\n}\n#endif\n\nvoid\nintel_display_power_get_in_set(struct drm_i915_private *i915,\n\t\t\t       struct intel_display_power_domain_set *power_domain_set,\n\t\t\t       enum intel_display_power_domain domain);\n\nbool\nintel_display_power_get_in_set_if_enabled(struct drm_i915_private *i915,\n\t\t\t\t\t  struct intel_display_power_domain_set *power_domain_set,\n\t\t\t\t\t  enum intel_display_power_domain domain);\n\nvoid\nintel_display_power_put_mask_in_set(struct drm_i915_private *i915,\n\t\t\t\t    struct intel_display_power_domain_set *power_domain_set,\n\t\t\t\t    struct intel_power_domain_mask *mask);\n\nstatic inline void\nintel_display_power_put_all_in_set(struct drm_i915_private *i915,\n\t\t\t\t   struct intel_display_power_domain_set *power_domain_set)\n{\n\tintel_display_power_put_mask_in_set(i915, power_domain_set, &power_domain_set->mask);\n}\n\nvoid intel_display_power_debug(struct drm_i915_private *i915, struct seq_file *m);\n\nenum intel_display_power_domain\nintel_display_power_ddi_lanes_domain(struct drm_i915_private *i915, enum port port);\nenum intel_display_power_domain\nintel_display_power_ddi_io_domain(struct drm_i915_private *i915, enum port port);\nenum intel_display_power_domain\nintel_display_power_aux_io_domain(struct drm_i915_private *i915, enum aux_ch aux_ch);\nenum intel_display_power_domain\nintel_display_power_legacy_aux_domain(struct drm_i915_private *i915, enum aux_ch aux_ch);\nenum intel_display_power_domain\nintel_display_power_tbt_aux_domain(struct drm_i915_private *i915, enum aux_ch aux_ch);\n\n \nenum dbuf_slice {\n\tDBUF_S1,\n\tDBUF_S2,\n\tDBUF_S3,\n\tDBUF_S4,\n\tI915_MAX_DBUF_SLICES\n};\n\nvoid gen9_dbuf_slices_update(struct drm_i915_private *dev_priv,\n\t\t\t     u8 req_slices);\n\n#define with_intel_display_power(i915, domain, wf) \\\n\tfor ((wf) = intel_display_power_get((i915), (domain)); (wf); \\\n\t     intel_display_power_put_async((i915), (domain), (wf)), (wf) = 0)\n\n#define with_intel_display_power_if_enabled(i915, domain, wf) \\\n\tfor ((wf) = intel_display_power_get_if_enabled((i915), (domain)); (wf); \\\n\t     intel_display_power_put_async((i915), (domain), (wf)), (wf) = 0)\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}