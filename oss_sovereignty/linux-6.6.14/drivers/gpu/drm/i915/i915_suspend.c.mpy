{
  "module_name": "i915_suspend.c",
  "hash_id": "b632cd7d2f32f0b5fc47b4e5f6377bbbc1b6497c8dcdecaac2c0355e27a617e4",
  "original_prompt": "Ingested from linux-6.6.14/drivers/gpu/drm/i915/i915_suspend.c",
  "human_readable_source": " \n\n#include \"display/intel_de.h\"\n#include \"display/intel_gmbus.h\"\n#include \"display/intel_vga.h\"\n\n#include \"i915_drv.h\"\n#include \"i915_reg.h\"\n#include \"i915_suspend.h\"\n#include \"intel_pci_config.h\"\n\nstatic void intel_save_swf(struct drm_i915_private *dev_priv)\n{\n\tint i;\n\n\t \n\tif (GRAPHICS_VER(dev_priv) == 2 && IS_MOBILE(dev_priv)) {\n\t\tfor (i = 0; i < 7; i++) {\n\t\t\tdev_priv->regfile.saveSWF0[i] = intel_de_read(dev_priv, SWF0(i));\n\t\t\tdev_priv->regfile.saveSWF1[i] = intel_de_read(dev_priv, SWF1(i));\n\t\t}\n\t\tfor (i = 0; i < 3; i++)\n\t\t\tdev_priv->regfile.saveSWF3[i] = intel_de_read(dev_priv, SWF3(i));\n\t} else if (GRAPHICS_VER(dev_priv) == 2) {\n\t\tfor (i = 0; i < 7; i++)\n\t\t\tdev_priv->regfile.saveSWF1[i] = intel_de_read(dev_priv, SWF1(i));\n\t} else if (HAS_GMCH(dev_priv)) {\n\t\tfor (i = 0; i < 16; i++) {\n\t\t\tdev_priv->regfile.saveSWF0[i] = intel_de_read(dev_priv, SWF0(i));\n\t\t\tdev_priv->regfile.saveSWF1[i] = intel_de_read(dev_priv, SWF1(i));\n\t\t}\n\t\tfor (i = 0; i < 3; i++)\n\t\t\tdev_priv->regfile.saveSWF3[i] = intel_de_read(dev_priv, SWF3(i));\n\t}\n}\n\nstatic void intel_restore_swf(struct drm_i915_private *dev_priv)\n{\n\tint i;\n\n\t \n\tif (GRAPHICS_VER(dev_priv) == 2 && IS_MOBILE(dev_priv)) {\n\t\tfor (i = 0; i < 7; i++) {\n\t\t\tintel_de_write(dev_priv, SWF0(i), dev_priv->regfile.saveSWF0[i]);\n\t\t\tintel_de_write(dev_priv, SWF1(i), dev_priv->regfile.saveSWF1[i]);\n\t\t}\n\t\tfor (i = 0; i < 3; i++)\n\t\t\tintel_de_write(dev_priv, SWF3(i), dev_priv->regfile.saveSWF3[i]);\n\t} else if (GRAPHICS_VER(dev_priv) == 2) {\n\t\tfor (i = 0; i < 7; i++)\n\t\t\tintel_de_write(dev_priv, SWF1(i), dev_priv->regfile.saveSWF1[i]);\n\t} else if (HAS_GMCH(dev_priv)) {\n\t\tfor (i = 0; i < 16; i++) {\n\t\t\tintel_de_write(dev_priv, SWF0(i), dev_priv->regfile.saveSWF0[i]);\n\t\t\tintel_de_write(dev_priv, SWF1(i), dev_priv->regfile.saveSWF1[i]);\n\t\t}\n\t\tfor (i = 0; i < 3; i++)\n\t\t\tintel_de_write(dev_priv, SWF3(i), dev_priv->regfile.saveSWF3[i]);\n\t}\n}\n\nvoid i915_save_display(struct drm_i915_private *dev_priv)\n{\n\tstruct pci_dev *pdev = to_pci_dev(dev_priv->drm.dev);\n\n\tif (!HAS_DISPLAY(dev_priv))\n\t\treturn;\n\n\t \n\tif (GRAPHICS_VER(dev_priv) <= 4)\n\t\tdev_priv->regfile.saveDSPARB = intel_de_read(dev_priv, DSPARB);\n\n\tif (GRAPHICS_VER(dev_priv) == 4)\n\t\tpci_read_config_word(pdev, GCDGMBUS,\n\t\t\t\t     &dev_priv->regfile.saveGCDGMBUS);\n\n\tintel_save_swf(dev_priv);\n}\n\nvoid i915_restore_display(struct drm_i915_private *dev_priv)\n{\n\tstruct pci_dev *pdev = to_pci_dev(dev_priv->drm.dev);\n\n\tif (!HAS_DISPLAY(dev_priv))\n\t\treturn;\n\n\tintel_restore_swf(dev_priv);\n\n\tif (GRAPHICS_VER(dev_priv) == 4)\n\t\tpci_write_config_word(pdev, GCDGMBUS,\n\t\t\t\t      dev_priv->regfile.saveGCDGMBUS);\n\n\t \n\tif (GRAPHICS_VER(dev_priv) <= 4)\n\t\tintel_de_write(dev_priv, DSPARB, dev_priv->regfile.saveDSPARB);\n\n\tintel_vga_redisable(dev_priv);\n\n\tintel_gmbus_reset(dev_priv);\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}