{
  "module_name": "i915_gem_object_types.h",
  "hash_id": "8bd028f337c2bd85dd097a5b2a0be57d5a7612bd622cc900b9230b7eafde9bbb",
  "original_prompt": "Ingested from linux-6.6.14/drivers/gpu/drm/i915/gem/i915_gem_object_types.h",
  "human_readable_source": " \n\n#ifndef __I915_GEM_OBJECT_TYPES_H__\n#define __I915_GEM_OBJECT_TYPES_H__\n\n#include <linux/mmu_notifier.h>\n\n#include <drm/drm_gem.h>\n#include <drm/ttm/ttm_bo.h>\n#include <uapi/drm/i915_drm.h>\n\n#include \"i915_active.h\"\n#include \"i915_selftest.h\"\n#include \"i915_vma_resource.h\"\n\n#include \"gt/intel_gt_defines.h\"\n\nstruct drm_i915_gem_object;\nstruct intel_fronbuffer;\nstruct intel_memory_region;\n\n \nstruct i915_lut_handle {\n\tstruct list_head obj_link;\n\tstruct i915_gem_context *ctx;\n\tu32 handle;\n};\n\nstruct drm_i915_gem_object_ops {\n\tunsigned int flags;\n#define I915_GEM_OBJECT_IS_SHRINKABLE\t\t\tBIT(1)\n \n#define I915_GEM_OBJECT_SELF_MANAGED_SHRINK_LIST\tBIT(2)\n#define I915_GEM_OBJECT_IS_PROXY\t\t\tBIT(3)\n#define I915_GEM_OBJECT_NO_MMAP\t\t\t\tBIT(4)\n\n\t \n\tint (*get_pages)(struct drm_i915_gem_object *obj);\n\tvoid (*put_pages)(struct drm_i915_gem_object *obj,\n\t\t\t  struct sg_table *pages);\n\tint (*truncate)(struct drm_i915_gem_object *obj);\n\t \n#define I915_GEM_OBJECT_SHRINK_WRITEBACK   BIT(0)\n#define I915_GEM_OBJECT_SHRINK_NO_GPU_WAIT BIT(1)\n\tint (*shrink)(struct drm_i915_gem_object *obj, unsigned int flags);\n\n\tint (*pread)(struct drm_i915_gem_object *obj,\n\t\t     const struct drm_i915_gem_pread *arg);\n\tint (*pwrite)(struct drm_i915_gem_object *obj,\n\t\t      const struct drm_i915_gem_pwrite *arg);\n\tu64 (*mmap_offset)(struct drm_i915_gem_object *obj);\n\tvoid (*unmap_virtual)(struct drm_i915_gem_object *obj);\n\n\tint (*dmabuf_export)(struct drm_i915_gem_object *obj);\n\n\t \n\tvoid (*adjust_lru)(struct drm_i915_gem_object *obj);\n\n\t \n\tvoid (*delayed_free)(struct drm_i915_gem_object *obj);\n\n\t \n\tint (*migrate)(struct drm_i915_gem_object *obj,\n\t\t       struct intel_memory_region *mr,\n\t\t       unsigned int flags);\n\n\tvoid (*release)(struct drm_i915_gem_object *obj);\n\n\tconst struct vm_operations_struct *mmap_ops;\n\tconst char *name;  \n};\n\n \nenum i915_cache_level {\n\t \n\tI915_CACHE_NONE = 0,\n\t \n\tI915_CACHE_LLC,\n\t \n\tI915_CACHE_L3_LLC,\n\t \n\tI915_CACHE_WT,\n\t \n\tI915_MAX_CACHE_LEVEL,\n};\n\nenum i915_map_type {\n\tI915_MAP_WB = 0,\n\tI915_MAP_WC,\n#define I915_MAP_OVERRIDE BIT(31)\n\tI915_MAP_FORCE_WB = I915_MAP_WB | I915_MAP_OVERRIDE,\n\tI915_MAP_FORCE_WC = I915_MAP_WC | I915_MAP_OVERRIDE,\n};\n\nenum i915_mmap_type {\n\tI915_MMAP_TYPE_GTT = 0,\n\tI915_MMAP_TYPE_WC,\n\tI915_MMAP_TYPE_WB,\n\tI915_MMAP_TYPE_UC,\n\tI915_MMAP_TYPE_FIXED,\n};\n\nstruct i915_mmap_offset {\n\tstruct drm_vma_offset_node vma_node;\n\tstruct drm_i915_gem_object *obj;\n\tenum i915_mmap_type mmap_type;\n\n\tstruct rb_node offset;\n};\n\nstruct i915_gem_object_page_iter {\n\tstruct scatterlist *sg_pos;\n\tunsigned int sg_idx;  \n\n\tstruct radix_tree_root radix;\n\tstruct mutex lock;  \n};\n\nstruct drm_i915_gem_object {\n\t \n\tunion {\n\t\tstruct drm_gem_object base;\n\t\tstruct ttm_buffer_object __do_not_access;\n\t};\n\n\tconst struct drm_i915_gem_object_ops *ops;\n\n\tstruct {\n\t\t \n\t\tspinlock_t lock;\n\n\t\t \n\t\tstruct list_head list;\n\n\t\t \n\t\tstruct rb_root tree;\n\t} vma;\n\n\t \n\tstruct list_head lut_list;\n\tspinlock_t lut_lock;  \n\n\t \n\tstruct list_head obj_link;\n\t \n\tstruct i915_address_space *shares_resv_from;\n\n\tunion {\n\t\tstruct rcu_head rcu;\n\t\tstruct llist_node freed;\n\t};\n\n\t \n\tunsigned int userfault_count;\n\tstruct list_head userfault_link;\n\n\tstruct {\n\t\tspinlock_t lock;  \n\t\tstruct rb_root offsets;\n\t} mmo;\n\n\tI915_SELFTEST_DECLARE(struct list_head st_link);\n\n\tunsigned long flags;\n#define I915_BO_ALLOC_CONTIGUOUS  BIT(0)\n#define I915_BO_ALLOC_VOLATILE    BIT(1)\n#define I915_BO_ALLOC_CPU_CLEAR   BIT(2)\n#define I915_BO_ALLOC_USER        BIT(3)\n \n#define I915_BO_ALLOC_PM_VOLATILE BIT(4)\n \n#define I915_BO_ALLOC_PM_EARLY    BIT(5)\n \n#define I915_BO_ALLOC_GPU_ONLY\t  BIT(6)\n#define I915_BO_ALLOC_CCS_AUX\t  BIT(7)\n \n#define I915_BO_PREALLOC\t  BIT(8)\n#define I915_BO_ALLOC_FLAGS (I915_BO_ALLOC_CONTIGUOUS | \\\n\t\t\t     I915_BO_ALLOC_VOLATILE | \\\n\t\t\t     I915_BO_ALLOC_CPU_CLEAR | \\\n\t\t\t     I915_BO_ALLOC_USER | \\\n\t\t\t     I915_BO_ALLOC_PM_VOLATILE | \\\n\t\t\t     I915_BO_ALLOC_PM_EARLY | \\\n\t\t\t     I915_BO_ALLOC_GPU_ONLY | \\\n\t\t\t     I915_BO_ALLOC_CCS_AUX | \\\n\t\t\t     I915_BO_PREALLOC)\n#define I915_BO_READONLY          BIT(9)\n#define I915_TILING_QUIRK_BIT     10  \n#define I915_BO_PROTECTED         BIT(11)\n\t \n\tunsigned int mem_flags;\n#define I915_BO_FLAG_STRUCT_PAGE BIT(0)  \n#define I915_BO_FLAG_IOMEM       BIT(1)  \n\t \n\tunsigned int pat_index:6;\n\t \n\tunsigned int pat_set_by_user:1;\n\t \n#define I915_BO_CACHE_COHERENT_FOR_READ BIT(0)\n#define I915_BO_CACHE_COHERENT_FOR_WRITE BIT(1)\n\tunsigned int cache_coherent:2;\n\n\t \n\tunsigned int cache_dirty:1;\n\n\t \n\tunsigned int is_dpt:1;\n\n\t \n\tu16 read_domains;\n\n\t \n\tu16 write_domain;\n\n\tstruct intel_frontbuffer __rcu *frontbuffer;\n\n\t \n\tunsigned int tiling_and_stride;\n#define FENCE_MINIMUM_STRIDE 128  \n#define TILING_MASK (FENCE_MINIMUM_STRIDE - 1)\n#define STRIDE_MASK (~TILING_MASK)\n\n\tstruct {\n\t\t \n\t\tatomic_t pages_pin_count;\n\n\t\t \n\t\tatomic_t shrink_pin;\n\n\t\t \n\t\tbool ttm_shrinkable;\n\n\t\t \n\t\tbool unknown_state;\n\n\t\t \n\t\tstruct intel_memory_region **placements;\n\t\tint n_placements;\n\n\t\t \n\t\tstruct intel_memory_region *region;\n\n\t\t \n\t\tstruct ttm_resource *res;\n\n\t\t \n\t\tstruct list_head region_link;\n\n\t\tstruct i915_refct_sgt *rsgt;\n\t\tstruct sg_table *pages;\n\t\tvoid *mapping;\n\n\t\tstruct i915_page_sizes page_sizes;\n\n\t\tI915_SELFTEST_DECLARE(unsigned int page_mask);\n\n\t\tstruct i915_gem_object_page_iter get_page;\n\t\tstruct i915_gem_object_page_iter get_dma_page;\n\n\t\t \n\t\tstruct list_head link;\n\n\t\t \n\t\tunsigned int madv:2;\n\n\t\t \n\t\tbool dirty:1;\n\n\t\tu32 tlb[I915_MAX_GT];\n\t} mm;\n\n\tstruct {\n\t\tstruct i915_refct_sgt *cached_io_rsgt;\n\t\tstruct i915_gem_object_page_iter get_io_page;\n\t\tstruct drm_i915_gem_object *backup;\n\t\tbool created:1;\n\t} ttm;\n\n\t \n\tu32 pxp_key_instance;\n\n\t \n\tunsigned long *bit_17;\n\n\tunion {\n#ifdef CONFIG_MMU_NOTIFIER\n\t\tstruct i915_gem_userptr {\n\t\t\tuintptr_t ptr;\n\t\t\tunsigned long notifier_seq;\n\n\t\t\tstruct mmu_interval_notifier notifier;\n\t\t\tstruct page **pvec;\n\t\t\tint page_ref;\n\t\t} userptr;\n#endif\n\n\t\tstruct drm_mm_node *stolen;\n\n\t\tresource_size_t bo_offset;\n\n\t\tunsigned long scratch;\n\t\tu64 encode;\n\n\t\tvoid *gvt_info;\n\t};\n};\n\n#define intel_bo_to_drm_bo(bo) (&(bo)->base)\n#define intel_bo_to_i915(bo) to_i915(intel_bo_to_drm_bo(bo)->dev)\n\nstatic inline struct drm_i915_gem_object *\nto_intel_bo(struct drm_gem_object *gem)\n{\n\t \n\tBUILD_BUG_ON(offsetof(struct drm_i915_gem_object, base));\n\n\treturn container_of(gem, struct drm_i915_gem_object, base);\n}\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}