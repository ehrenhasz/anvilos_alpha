{
  "module_name": "intel_memory_region.h",
  "hash_id": "221827499a610bebee61088bcea6a68d184e74594b1fde3d0ae3f203dabed6b1",
  "original_prompt": "Ingested from linux-6.6.14/drivers/gpu/drm/i915/intel_memory_region.h",
  "human_readable_source": " \n \n\n#ifndef __INTEL_MEMORY_REGION_H__\n#define __INTEL_MEMORY_REGION_H__\n\n#include <linux/ioport.h>\n#include <linux/mutex.h>\n#include <linux/io-mapping.h>\n#include <drm/drm_mm.h>\n#include <uapi/drm/i915_drm.h>\n\nstruct drm_i915_private;\nstruct drm_i915_gem_object;\nstruct drm_printer;\nstruct intel_memory_region;\nstruct sg_table;\nstruct ttm_resource;\n\nenum intel_memory_type {\n\tINTEL_MEMORY_SYSTEM = I915_MEMORY_CLASS_SYSTEM,\n\tINTEL_MEMORY_LOCAL = I915_MEMORY_CLASS_DEVICE,\n\tINTEL_MEMORY_STOLEN_SYSTEM,\n\tINTEL_MEMORY_STOLEN_LOCAL,\n\tINTEL_MEMORY_MOCK,\n};\n\nenum intel_region_id {\n\tINTEL_REGION_SMEM = 0,\n\tINTEL_REGION_LMEM_0,\n\tINTEL_REGION_LMEM_1,\n\tINTEL_REGION_LMEM_2,\n\tINTEL_REGION_LMEM_3,\n\tINTEL_REGION_STOLEN_SMEM,\n\tINTEL_REGION_STOLEN_LMEM,\n\tINTEL_REGION_UNKNOWN,  \n};\n\n#define REGION_SMEM     BIT(INTEL_REGION_SMEM)\n#define REGION_LMEM     BIT(INTEL_REGION_LMEM_0)\n#define REGION_STOLEN_SMEM   BIT(INTEL_REGION_STOLEN_SMEM)\n#define REGION_STOLEN_LMEM   BIT(INTEL_REGION_STOLEN_LMEM)\n\n#define I915_ALLOC_CONTIGUOUS     BIT(0)\n\n#define for_each_memory_region(mr, i915, id) \\\n\tfor (id = 0; id < ARRAY_SIZE((i915)->mm.regions); id++) \\\n\t\tfor_each_if((mr) = (i915)->mm.regions[id])\n\nstruct intel_memory_region_ops {\n\tunsigned int flags;\n\n\tint (*init)(struct intel_memory_region *mem);\n\tint (*release)(struct intel_memory_region *mem);\n\n\tint (*init_object)(struct intel_memory_region *mem,\n\t\t\t   struct drm_i915_gem_object *obj,\n\t\t\t   resource_size_t offset,\n\t\t\t   resource_size_t size,\n\t\t\t   resource_size_t page_size,\n\t\t\t   unsigned int flags);\n};\n\nstruct intel_memory_region {\n\tstruct drm_i915_private *i915;\n\n\tconst struct intel_memory_region_ops *ops;\n\n\tstruct io_mapping iomap;\n\tstruct resource region;\n\n\tresource_size_t io_start;\n\tresource_size_t io_size;\n\tresource_size_t min_page_size;\n\tresource_size_t total;\n\n\tu16 type;\n\tu16 instance;\n\tenum intel_region_id id;\n\tchar name[16];\n\tbool private;  \n\n\tstruct {\n\t\tstruct mutex lock;  \n\t\tstruct list_head list;\n\t} objects;\n\n\tbool is_range_manager;\n\n\tvoid *region_private;\n};\n\nstruct intel_memory_region *\nintel_memory_region_lookup(struct drm_i915_private *i915,\n\t\t\t   u16 class, u16 instance);\n\nstruct intel_memory_region *\nintel_memory_region_create(struct drm_i915_private *i915,\n\t\t\t   resource_size_t start,\n\t\t\t   resource_size_t size,\n\t\t\t   resource_size_t min_page_size,\n\t\t\t   resource_size_t io_start,\n\t\t\t   resource_size_t io_size,\n\t\t\t   u16 type,\n\t\t\t   u16 instance,\n\t\t\t   const struct intel_memory_region_ops *ops);\n\nvoid intel_memory_region_destroy(struct intel_memory_region *mem);\n\nint intel_memory_regions_hw_probe(struct drm_i915_private *i915);\nvoid intel_memory_regions_driver_release(struct drm_i915_private *i915);\nstruct intel_memory_region *\nintel_memory_region_by_type(struct drm_i915_private *i915,\n\t\t\t    enum intel_memory_type mem_type);\n\n__printf(2, 3) void\nintel_memory_region_set_name(struct intel_memory_region *mem,\n\t\t\t     const char *fmt, ...);\n\nint intel_memory_region_reserve(struct intel_memory_region *mem,\n\t\t\t\tresource_size_t offset,\n\t\t\t\tresource_size_t size);\n\nvoid intel_memory_region_debug(struct intel_memory_region *mr,\n\t\t\t       struct drm_printer *printer);\n\nvoid intel_memory_region_avail(struct intel_memory_region *mr,\n\t\t\t       u64 *avail, u64 *visible_avail);\n\nstruct intel_memory_region *\ni915_gem_ttm_system_setup(struct drm_i915_private *i915,\n\t\t\t  u16 type, u16 instance);\nstruct intel_memory_region *\ni915_gem_shmem_setup(struct drm_i915_private *i915,\n\t\t     u16 type, u16 instance);\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}