{
  "module_name": "selftest_llc.c",
  "hash_id": "e464cba1c411fcefb8922329df454bb7598104d1b3349f1b8c6a98fb3f496b1b",
  "original_prompt": "Ingested from linux-6.6.14/drivers/gpu/drm/i915/gt/selftest_llc.c",
  "human_readable_source": "\n \n\n#include \"selftest_llc.h\"\n#include \"intel_rps.h\"\n\nstatic int gen6_verify_ring_freq(struct intel_llc *llc)\n{\n\tstruct drm_i915_private *i915 = llc_to_gt(llc)->i915;\n\tstruct ia_constants consts;\n\tintel_wakeref_t wakeref;\n\tunsigned int gpu_freq;\n\tint err = 0;\n\n\twakeref = intel_runtime_pm_get(llc_to_gt(llc)->uncore->rpm);\n\n\tif (!get_ia_constants(llc, &consts))\n\t\tgoto out_rpm;\n\n\tfor (gpu_freq = consts.min_gpu_freq;\n\t     gpu_freq <= consts.max_gpu_freq;\n\t     gpu_freq++) {\n\t\tstruct intel_rps *rps = &llc_to_gt(llc)->rps;\n\n\t\tunsigned int ia_freq, ring_freq, found;\n\t\tu32 val;\n\n\t\tcalc_ia_freq(llc, gpu_freq, &consts, &ia_freq, &ring_freq);\n\n\t\tval = gpu_freq;\n\t\tif (snb_pcode_read(llc_to_gt(llc)->uncore, GEN6_PCODE_READ_MIN_FREQ_TABLE,\n\t\t\t\t   &val, NULL)) {\n\t\t\tpr_err(\"Failed to read freq table[%d], range [%d, %d]\\n\",\n\t\t\t       gpu_freq, consts.min_gpu_freq, consts.max_gpu_freq);\n\t\t\terr = -ENXIO;\n\t\t\tbreak;\n\t\t}\n\n\t\tfound = (val >> 0) & 0xff;\n\t\tif (found != ia_freq) {\n\t\t\tpr_err(\"Min freq table(%d/[%d, %d]):%dMHz did not match expected CPU freq, found %d, expected %d\\n\",\n\t\t\t       gpu_freq, consts.min_gpu_freq, consts.max_gpu_freq,\n\t\t\t       intel_gpu_freq(rps, gpu_freq * (GRAPHICS_VER(i915) >= 9 ? GEN9_FREQ_SCALER : 1)),\n\t\t\t       found, ia_freq);\n\t\t\terr = -EINVAL;\n\t\t\tbreak;\n\t\t}\n\n\t\tfound = (val >> 8) & 0xff;\n\t\tif (found != ring_freq) {\n\t\t\tpr_err(\"Min freq table(%d/[%d, %d]):%dMHz did not match expected ring freq, found %d, expected %d\\n\",\n\t\t\t       gpu_freq, consts.min_gpu_freq, consts.max_gpu_freq,\n\t\t\t       intel_gpu_freq(rps, gpu_freq * (GRAPHICS_VER(i915) >= 9 ? GEN9_FREQ_SCALER : 1)),\n\t\t\t       found, ring_freq);\n\t\t\terr = -EINVAL;\n\t\t\tbreak;\n\t\t}\n\t}\n\nout_rpm:\n\tintel_runtime_pm_put(llc_to_gt(llc)->uncore->rpm, wakeref);\n\treturn err;\n}\n\nint st_llc_verify(struct intel_llc *llc)\n{\n\treturn gen6_verify_ring_freq(llc);\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}