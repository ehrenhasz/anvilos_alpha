{
  "module_name": "intel_lrc.h",
  "hash_id": "4788a9f644a0e90dec6f85b76d61f0f37e108f8599a59e94ef718574c14ef2c7",
  "original_prompt": "Ingested from linux-6.6.14/drivers/gpu/drm/i915/gt/intel_lrc.h",
  "human_readable_source": " \n \n\n#ifndef __INTEL_LRC_H__\n#define __INTEL_LRC_H__\n\n#include \"i915_priolist_types.h\"\n\n#include <linux/bitfield.h>\n#include <linux/types.h>\n\n#include \"intel_context.h\"\n\nstruct drm_i915_gem_object;\nstruct i915_gem_ww_ctx;\nstruct intel_engine_cs;\nstruct intel_ring;\nstruct kref;\n\n \n#define LRC_PPHWSP_PN\t(0)\n#define LRC_PPHWSP_SZ\t(1)\n \n#define LRC_STATE_PN\t(LRC_PPHWSP_PN + LRC_PPHWSP_SZ)\n#define LRC_STATE_OFFSET (LRC_STATE_PN * PAGE_SIZE)\n\n \n#define LRC_PPHWSP_SCRATCH\t\t0x34\n#define LRC_PPHWSP_SCRATCH_ADDR\t\t(LRC_PPHWSP_SCRATCH * sizeof(u32))\n\nvoid lrc_init_wa_ctx(struct intel_engine_cs *engine);\nvoid lrc_fini_wa_ctx(struct intel_engine_cs *engine);\n\nint lrc_alloc(struct intel_context *ce,\n\t      struct intel_engine_cs *engine);\nvoid lrc_reset(struct intel_context *ce);\nvoid lrc_fini(struct intel_context *ce);\nvoid lrc_destroy(struct kref *kref);\n\nint\nlrc_pre_pin(struct intel_context *ce,\n\t    struct intel_engine_cs *engine,\n\t    struct i915_gem_ww_ctx *ww,\n\t    void **vaddr);\nint\nlrc_pin(struct intel_context *ce,\n\tstruct intel_engine_cs *engine,\n\tvoid *vaddr);\nvoid lrc_unpin(struct intel_context *ce);\nvoid lrc_post_unpin(struct intel_context *ce);\n\nvoid lrc_init_state(struct intel_context *ce,\n\t\t    struct intel_engine_cs *engine,\n\t\t    void *state);\n\nvoid lrc_init_regs(const struct intel_context *ce,\n\t\t   const struct intel_engine_cs *engine,\n\t\t   bool clear);\nvoid lrc_reset_regs(const struct intel_context *ce,\n\t\t    const struct intel_engine_cs *engine);\n\nu32 lrc_update_regs(const struct intel_context *ce,\n\t\t    const struct intel_engine_cs *engine,\n\t\t    u32 head);\nvoid lrc_update_offsets(struct intel_context *ce,\n\t\t\tstruct intel_engine_cs *engine);\n\nvoid lrc_check_regs(const struct intel_context *ce,\n\t\t    const struct intel_engine_cs *engine,\n\t\t    const char *when);\n\nvoid lrc_update_runtime(struct intel_context *ce);\n\nenum {\n\tINTEL_ADVANCED_CONTEXT = 0,\n\tINTEL_LEGACY_32B_CONTEXT,\n\tINTEL_ADVANCED_AD_CONTEXT,\n\tINTEL_LEGACY_64B_CONTEXT\n};\n\nenum {\n\tFAULT_AND_HANG = 0,\n\tFAULT_AND_HALT,  \n\tFAULT_AND_STREAM,\n\tFAULT_AND_CONTINUE  \n};\n\n#define CTX_GTT_ADDRESS_MASK\t\t\tGENMASK(31, 12)\n#define GEN8_CTX_VALID\t\t\t\t(1 << 0)\n#define GEN8_CTX_FORCE_PD_RESTORE\t\t(1 << 1)\n#define GEN8_CTX_FORCE_RESTORE\t\t\t(1 << 2)\n#define GEN8_CTX_L3LLC_COHERENT\t\t\t(1 << 5)\n#define GEN8_CTX_PRIVILEGE\t\t\t(1 << 8)\n#define GEN8_CTX_ADDRESSING_MODE_SHIFT\t\t3\n#define GEN12_CTX_PRIORITY_MASK\t\t\tGENMASK(10, 9)\n#define GEN12_CTX_PRIORITY_HIGH\t\t\tFIELD_PREP(GEN12_CTX_PRIORITY_MASK, 2)\n#define GEN12_CTX_PRIORITY_NORMAL\t\tFIELD_PREP(GEN12_CTX_PRIORITY_MASK, 1)\n#define GEN12_CTX_PRIORITY_LOW\t\t\tFIELD_PREP(GEN12_CTX_PRIORITY_MASK, 0)\n#define GEN8_CTX_ID_SHIFT\t\t\t32\n#define GEN8_CTX_ID_WIDTH\t\t\t21\n#define GEN11_SW_CTX_ID_SHIFT\t\t\t37\n#define GEN11_SW_CTX_ID_WIDTH\t\t\t11\n#define GEN11_ENGINE_CLASS_SHIFT\t\t61\n#define GEN11_ENGINE_CLASS_WIDTH\t\t3\n#define GEN11_ENGINE_INSTANCE_SHIFT\t\t48\n#define GEN11_ENGINE_INSTANCE_WIDTH\t\t6\n#define XEHP_SW_CTX_ID_SHIFT\t\t\t39\n#define XEHP_SW_CTX_ID_WIDTH\t\t\t16\n#define XEHP_SW_COUNTER_SHIFT\t\t\t58\n#define XEHP_SW_COUNTER_WIDTH\t\t\t6\n#define GEN12_GUC_SW_CTX_ID_SHIFT\t\t39\n#define GEN12_GUC_SW_CTX_ID_WIDTH\t\t16\n\nstatic inline void lrc_runtime_start(struct intel_context *ce)\n{\n\tstruct intel_context_stats *stats = &ce->stats;\n\n\tif (intel_context_is_barrier(ce))\n\t\treturn;\n\n\tif (stats->active)\n\t\treturn;\n\n\tWRITE_ONCE(stats->active, intel_context_clock());\n}\n\nstatic inline void lrc_runtime_stop(struct intel_context *ce)\n{\n\tstruct intel_context_stats *stats = &ce->stats;\n\n\tif (!stats->active)\n\t\treturn;\n\n\tlrc_update_runtime(ce);\n\tWRITE_ONCE(stats->active, 0);\n}\n\n#define DG2_PREDICATE_RESULT_WA (PAGE_SIZE - sizeof(u64))\n#define DG2_PREDICATE_RESULT_BB (2048)\n\nu32 lrc_indirect_bb(const struct intel_context *ce);\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}