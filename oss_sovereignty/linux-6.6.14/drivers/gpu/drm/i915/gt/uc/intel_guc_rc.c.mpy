{
  "module_name": "intel_guc_rc.c",
  "hash_id": "75c2bae963f692e7cc3f0ff922c54a1f11ce77b14c4c8a4843414818272830de",
  "original_prompt": "Ingested from linux-6.6.14/drivers/gpu/drm/i915/gt/uc/intel_guc_rc.c",
  "human_readable_source": "\n \n\n#include <linux/string_helpers.h>\n\n#include \"intel_guc_rc.h\"\n#include \"intel_guc_print.h\"\n#include \"gt/intel_gt.h\"\n#include \"i915_drv.h\"\n\nstatic bool __guc_rc_supported(struct intel_guc *guc)\n{\n\t \n\treturn guc->submission_supported &&\n\t\tGRAPHICS_VER(guc_to_gt(guc)->i915) >= 12;\n}\n\nstatic bool __guc_rc_selected(struct intel_guc *guc)\n{\n\tif (!intel_guc_rc_is_supported(guc))\n\t\treturn false;\n\n\treturn guc->submission_selected;\n}\n\nvoid intel_guc_rc_init_early(struct intel_guc *guc)\n{\n\tguc->rc_supported = __guc_rc_supported(guc);\n\tguc->rc_selected = __guc_rc_selected(guc);\n}\n\nstatic int guc_action_control_gucrc(struct intel_guc *guc, bool enable)\n{\n\tu32 rc_mode = enable ? INTEL_GUCRC_FIRMWARE_CONTROL :\n\t\t\t\tINTEL_GUCRC_HOST_CONTROL;\n\tu32 action[] = {\n\t\tINTEL_GUC_ACTION_SETUP_PC_GUCRC,\n\t\trc_mode\n\t};\n\tint ret;\n\n\tret = intel_guc_send(guc, action, ARRAY_SIZE(action));\n\tret = ret > 0 ? -EPROTO : ret;\n\n\treturn ret;\n}\n\nstatic int __guc_rc_control(struct intel_guc *guc, bool enable)\n{\n\tstruct intel_gt *gt = guc_to_gt(guc);\n\tint ret;\n\n\tif (!intel_uc_uses_guc_rc(&gt->uc))\n\t\treturn -EOPNOTSUPP;\n\n\tif (!intel_guc_is_ready(guc))\n\t\treturn -EINVAL;\n\n\tret = guc_action_control_gucrc(guc, enable);\n\tif (ret) {\n\t\tguc_probe_error(guc, \"Failed to %s RC (%pe)\\n\",\n\t\t\t\tstr_enable_disable(enable), ERR_PTR(ret));\n\t\treturn ret;\n\t}\n\n\tguc_info(guc, \"RC %s\\n\", str_enabled_disabled(enable));\n\n\treturn 0;\n}\n\nint intel_guc_rc_enable(struct intel_guc *guc)\n{\n\treturn __guc_rc_control(guc, true);\n}\n\nint intel_guc_rc_disable(struct intel_guc *guc)\n{\n\treturn __guc_rc_control(guc, false);\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}