{
  "module_name": "intel_uc_fw.h",
  "hash_id": "7c89c2845dfe56e93eaa907e7553242122b8ef12eb6274a80642f37d7ba09175",
  "original_prompt": "Ingested from linux-6.6.14/drivers/gpu/drm/i915/gt/uc/intel_uc_fw.h",
  "human_readable_source": " \n \n\n#ifndef _INTEL_UC_FW_H_\n#define _INTEL_UC_FW_H_\n\n#include <linux/sizes.h>\n#include <linux/types.h>\n#include \"intel_uc_fw_abi.h\"\n#include \"intel_device_info.h\"\n#include \"i915_gem.h\"\n#include \"i915_vma.h\"\n\nstruct drm_printer;\nstruct drm_i915_private;\nstruct intel_gt;\n\n \n#define INTEL_UC_FIRMWARE_URL \"https://git.kernel.org/pub/scm/linux/kernel/git/firmware/linux-firmware.git/tree/i915\"\n\n \n\nenum intel_uc_fw_status {\n\tINTEL_UC_FIRMWARE_NOT_SUPPORTED = -1,  \n\tINTEL_UC_FIRMWARE_UNINITIALIZED = 0,  \n\tINTEL_UC_FIRMWARE_DISABLED,  \n\tINTEL_UC_FIRMWARE_SELECTED,  \n\tINTEL_UC_FIRMWARE_MISSING,  \n\tINTEL_UC_FIRMWARE_ERROR,  \n\tINTEL_UC_FIRMWARE_AVAILABLE,  \n\tINTEL_UC_FIRMWARE_INIT_FAIL,  \n\tINTEL_UC_FIRMWARE_LOADABLE,  \n\tINTEL_UC_FIRMWARE_LOAD_FAIL,  \n\tINTEL_UC_FIRMWARE_TRANSFERRED,  \n\tINTEL_UC_FIRMWARE_RUNNING  \n};\n\nenum intel_uc_fw_type {\n\tINTEL_UC_FW_TYPE_GUC = 0,\n\tINTEL_UC_FW_TYPE_HUC,\n\tINTEL_UC_FW_TYPE_GSC,\n};\n#define INTEL_UC_FW_NUM_TYPES 3\n\nstruct intel_uc_fw_ver {\n\tu32 major;\n\tu32 minor;\n\tu32 patch;\n\tu32 build;\n};\n\n \nstruct intel_uc_fw_file {\n\tconst char *path;\n\tstruct intel_uc_fw_ver ver;\n};\n\n \nstruct intel_uc_fw {\n\tenum intel_uc_fw_type type;\n\tunion {\n\t\tconst enum intel_uc_fw_status status;\n\t\tenum intel_uc_fw_status __status;  \n\t};\n\tstruct intel_uc_fw_file file_wanted;\n\tstruct intel_uc_fw_file file_selected;\n\tbool user_overridden;\n\tsize_t size;\n\tstruct drm_i915_gem_object *obj;\n\n\t \n\tbool needs_ggtt_mapping;\n\n\t \n\tstruct i915_vma_resource vma_res;\n\tstruct i915_vma *rsa_data;\n\n\tu32 rsa_size;\n\tu32 ucode_size;\n\tu32 private_data_size;\n\n\tu32 dma_start_offset;\n\n\tbool has_gsc_headers;\n};\n\n \n#define INTEL_UC_RSVD_GGTT_PER_FW SZ_2M\n\n#ifdef CONFIG_DRM_I915_DEBUG_GUC\nvoid intel_uc_fw_change_status(struct intel_uc_fw *uc_fw,\n\t\t\t       enum intel_uc_fw_status status);\n#else\nstatic inline void intel_uc_fw_change_status(struct intel_uc_fw *uc_fw,\n\t\t\t\t\t     enum intel_uc_fw_status status)\n{\n\tuc_fw->__status = status;\n}\n#endif\n\nstatic inline\nconst char *intel_uc_fw_status_repr(enum intel_uc_fw_status status)\n{\n\tswitch (status) {\n\tcase INTEL_UC_FIRMWARE_NOT_SUPPORTED:\n\t\treturn \"N/A\";\n\tcase INTEL_UC_FIRMWARE_UNINITIALIZED:\n\t\treturn \"UNINITIALIZED\";\n\tcase INTEL_UC_FIRMWARE_DISABLED:\n\t\treturn \"DISABLED\";\n\tcase INTEL_UC_FIRMWARE_SELECTED:\n\t\treturn \"SELECTED\";\n\tcase INTEL_UC_FIRMWARE_MISSING:\n\t\treturn \"MISSING\";\n\tcase INTEL_UC_FIRMWARE_ERROR:\n\t\treturn \"ERROR\";\n\tcase INTEL_UC_FIRMWARE_AVAILABLE:\n\t\treturn \"AVAILABLE\";\n\tcase INTEL_UC_FIRMWARE_INIT_FAIL:\n\t\treturn \"INIT FAIL\";\n\tcase INTEL_UC_FIRMWARE_LOADABLE:\n\t\treturn \"LOADABLE\";\n\tcase INTEL_UC_FIRMWARE_LOAD_FAIL:\n\t\treturn \"LOAD FAIL\";\n\tcase INTEL_UC_FIRMWARE_TRANSFERRED:\n\t\treturn \"TRANSFERRED\";\n\tcase INTEL_UC_FIRMWARE_RUNNING:\n\t\treturn \"RUNNING\";\n\t}\n\treturn \"<invalid>\";\n}\n\nstatic inline int intel_uc_fw_status_to_error(enum intel_uc_fw_status status)\n{\n\tswitch (status) {\n\tcase INTEL_UC_FIRMWARE_NOT_SUPPORTED:\n\t\treturn -ENODEV;\n\tcase INTEL_UC_FIRMWARE_UNINITIALIZED:\n\t\treturn -EACCES;\n\tcase INTEL_UC_FIRMWARE_DISABLED:\n\t\treturn -EPERM;\n\tcase INTEL_UC_FIRMWARE_MISSING:\n\t\treturn -ENOENT;\n\tcase INTEL_UC_FIRMWARE_ERROR:\n\t\treturn -ENOEXEC;\n\tcase INTEL_UC_FIRMWARE_INIT_FAIL:\n\tcase INTEL_UC_FIRMWARE_LOAD_FAIL:\n\t\treturn -EIO;\n\tcase INTEL_UC_FIRMWARE_SELECTED:\n\t\treturn -ESTALE;\n\tcase INTEL_UC_FIRMWARE_AVAILABLE:\n\tcase INTEL_UC_FIRMWARE_LOADABLE:\n\tcase INTEL_UC_FIRMWARE_TRANSFERRED:\n\tcase INTEL_UC_FIRMWARE_RUNNING:\n\t\treturn 0;\n\t}\n\treturn -EINVAL;\n}\n\nstatic inline const char *intel_uc_fw_type_repr(enum intel_uc_fw_type type)\n{\n\tswitch (type) {\n\tcase INTEL_UC_FW_TYPE_GUC:\n\t\treturn \"GuC\";\n\tcase INTEL_UC_FW_TYPE_HUC:\n\t\treturn \"HuC\";\n\tcase INTEL_UC_FW_TYPE_GSC:\n\t\treturn \"GSC\";\n\t}\n\treturn \"uC\";\n}\n\nstatic inline enum intel_uc_fw_status\n__intel_uc_fw_status(struct intel_uc_fw *uc_fw)\n{\n\t \n\tGEM_BUG_ON(uc_fw->status == INTEL_UC_FIRMWARE_UNINITIALIZED);\n\treturn uc_fw->status;\n}\n\nstatic inline bool intel_uc_fw_is_supported(struct intel_uc_fw *uc_fw)\n{\n\treturn __intel_uc_fw_status(uc_fw) != INTEL_UC_FIRMWARE_NOT_SUPPORTED;\n}\n\nstatic inline bool intel_uc_fw_is_enabled(struct intel_uc_fw *uc_fw)\n{\n\treturn __intel_uc_fw_status(uc_fw) > INTEL_UC_FIRMWARE_DISABLED;\n}\n\nstatic inline bool intel_uc_fw_is_available(struct intel_uc_fw *uc_fw)\n{\n\treturn __intel_uc_fw_status(uc_fw) >= INTEL_UC_FIRMWARE_AVAILABLE;\n}\n\nstatic inline bool intel_uc_fw_is_loadable(struct intel_uc_fw *uc_fw)\n{\n\treturn __intel_uc_fw_status(uc_fw) >= INTEL_UC_FIRMWARE_LOADABLE;\n}\n\nstatic inline bool intel_uc_fw_is_loaded(struct intel_uc_fw *uc_fw)\n{\n\treturn __intel_uc_fw_status(uc_fw) >= INTEL_UC_FIRMWARE_TRANSFERRED;\n}\n\nstatic inline bool intel_uc_fw_is_running(struct intel_uc_fw *uc_fw)\n{\n\treturn __intel_uc_fw_status(uc_fw) == INTEL_UC_FIRMWARE_RUNNING;\n}\n\nstatic inline bool intel_uc_fw_is_overridden(const struct intel_uc_fw *uc_fw)\n{\n\treturn uc_fw->user_overridden;\n}\n\nstatic inline void intel_uc_fw_sanitize(struct intel_uc_fw *uc_fw)\n{\n\tif (intel_uc_fw_is_loaded(uc_fw))\n\t\tintel_uc_fw_change_status(uc_fw, INTEL_UC_FIRMWARE_LOADABLE);\n}\n\nstatic inline u32 __intel_uc_fw_get_upload_size(struct intel_uc_fw *uc_fw)\n{\n\treturn sizeof(struct uc_css_header) + uc_fw->ucode_size;\n}\n\n \nstatic inline u32 intel_uc_fw_get_upload_size(struct intel_uc_fw *uc_fw)\n{\n\tif (!intel_uc_fw_is_available(uc_fw))\n\t\treturn 0;\n\n\treturn __intel_uc_fw_get_upload_size(uc_fw);\n}\n\nvoid intel_uc_fw_version_from_gsc_manifest(struct intel_uc_fw_ver *ver,\n\t\t\t\t\t   const void *data);\nint intel_uc_check_file_version(struct intel_uc_fw *uc_fw, bool *old_ver);\nvoid intel_uc_fw_init_early(struct intel_uc_fw *uc_fw,\n\t\t\t    enum intel_uc_fw_type type,\n\t\t\t    bool needs_ggtt_mapping);\nint intel_uc_fw_fetch(struct intel_uc_fw *uc_fw);\nvoid intel_uc_fw_cleanup_fetch(struct intel_uc_fw *uc_fw);\nint intel_uc_fw_upload(struct intel_uc_fw *uc_fw, u32 offset, u32 dma_flags);\nint intel_uc_fw_init(struct intel_uc_fw *uc_fw);\nvoid intel_uc_fw_fini(struct intel_uc_fw *uc_fw);\nvoid intel_uc_fw_resume_mapping(struct intel_uc_fw *uc_fw);\nsize_t intel_uc_fw_copy_rsa(struct intel_uc_fw *uc_fw, void *dst, u32 max_len);\nint intel_uc_fw_mark_load_failed(struct intel_uc_fw *uc_fw, int err);\nvoid intel_uc_fw_dump(const struct intel_uc_fw *uc_fw, struct drm_printer *p);\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}