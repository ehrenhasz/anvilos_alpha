{
  "module_name": "intel_guc_debugfs.c",
  "hash_id": "5d626262c3ddebabfef1c0cbad0fb3d03a4c83e6ec85dc7e8e0a504ed10b68ef",
  "original_prompt": "Ingested from linux-6.6.14/drivers/gpu/drm/i915/gt/uc/intel_guc_debugfs.c",
  "human_readable_source": "\n \n\n#include <drm/drm_print.h>\n\n#include \"gt/intel_gt_debugfs.h\"\n#include \"gt/uc/intel_guc_ads.h\"\n#include \"gt/uc/intel_guc_ct.h\"\n#include \"gt/uc/intel_guc_slpc.h\"\n#include \"gt/uc/intel_guc_submission.h\"\n#include \"intel_guc.h\"\n#include \"intel_guc_debugfs.h\"\n#include \"intel_guc_log_debugfs.h\"\n\nstatic int guc_info_show(struct seq_file *m, void *data)\n{\n\tstruct intel_guc *guc = m->private;\n\tstruct drm_printer p = drm_seq_file_printer(m);\n\n\tif (!intel_guc_is_supported(guc))\n\t\treturn -ENODEV;\n\n\tintel_guc_load_status(guc, &p);\n\tdrm_puts(&p, \"\\n\");\n\tintel_guc_log_info(&guc->log, &p);\n\n\tif (!intel_guc_submission_is_used(guc))\n\t\treturn 0;\n\n\tintel_guc_ct_print_info(&guc->ct, &p);\n\tintel_guc_submission_print_info(guc, &p);\n\tintel_guc_ads_print_policy_info(guc, &p);\n\n\treturn 0;\n}\nDEFINE_INTEL_GT_DEBUGFS_ATTRIBUTE(guc_info);\n\nstatic int guc_registered_contexts_show(struct seq_file *m, void *data)\n{\n\tstruct intel_guc *guc = m->private;\n\tstruct drm_printer p = drm_seq_file_printer(m);\n\n\tif (!intel_guc_submission_is_used(guc))\n\t\treturn -ENODEV;\n\n\tintel_guc_submission_print_context_info(guc, &p);\n\n\treturn 0;\n}\nDEFINE_INTEL_GT_DEBUGFS_ATTRIBUTE(guc_registered_contexts);\n\nstatic int guc_slpc_info_show(struct seq_file *m, void *unused)\n{\n\tstruct intel_guc *guc = m->private;\n\tstruct intel_guc_slpc *slpc = &guc->slpc;\n\tstruct drm_printer p = drm_seq_file_printer(m);\n\n\tif (!intel_guc_slpc_is_used(guc))\n\t\treturn -ENODEV;\n\n\treturn intel_guc_slpc_print_info(slpc, &p);\n}\nDEFINE_INTEL_GT_DEBUGFS_ATTRIBUTE(guc_slpc_info);\n\nstatic bool intel_eval_slpc_support(void *data)\n{\n\tstruct intel_guc *guc = (struct intel_guc *)data;\n\n\treturn intel_guc_slpc_is_used(guc);\n}\n\nstatic int guc_sched_disable_delay_ms_get(void *data, u64 *val)\n{\n\tstruct intel_guc *guc = data;\n\n\tif (!intel_guc_submission_is_used(guc))\n\t\treturn -ENODEV;\n\n\t*val = (u64)guc->submission_state.sched_disable_delay_ms;\n\n\treturn 0;\n}\n\nstatic int guc_sched_disable_delay_ms_set(void *data, u64 val)\n{\n\tstruct intel_guc *guc = data;\n\n\tif (!intel_guc_submission_is_used(guc))\n\t\treturn -ENODEV;\n\n\t \n\tguc->submission_state.sched_disable_delay_ms = min_t(u64, val, 60000);\n\n\treturn 0;\n}\nDEFINE_SIMPLE_ATTRIBUTE(guc_sched_disable_delay_ms_fops,\n\t\t\tguc_sched_disable_delay_ms_get,\n\t\t\tguc_sched_disable_delay_ms_set, \"%lld\\n\");\n\nstatic int guc_sched_disable_gucid_threshold_get(void *data, u64 *val)\n{\n\tstruct intel_guc *guc = data;\n\n\tif (!intel_guc_submission_is_used(guc))\n\t\treturn -ENODEV;\n\n\t*val = guc->submission_state.sched_disable_gucid_threshold;\n\treturn 0;\n}\n\nstatic int guc_sched_disable_gucid_threshold_set(void *data, u64 val)\n{\n\tstruct intel_guc *guc = data;\n\n\tif (!intel_guc_submission_is_used(guc))\n\t\treturn -ENODEV;\n\n\tif (val > intel_guc_sched_disable_gucid_threshold_max(guc))\n\t\tguc->submission_state.sched_disable_gucid_threshold =\n\t\t\tintel_guc_sched_disable_gucid_threshold_max(guc);\n\telse\n\t\tguc->submission_state.sched_disable_gucid_threshold = val;\n\n\treturn 0;\n}\nDEFINE_SIMPLE_ATTRIBUTE(guc_sched_disable_gucid_threshold_fops,\n\t\t\tguc_sched_disable_gucid_threshold_get,\n\t\t\tguc_sched_disable_gucid_threshold_set, \"%lld\\n\");\n\nvoid intel_guc_debugfs_register(struct intel_guc *guc, struct dentry *root)\n{\n\tstatic const struct intel_gt_debugfs_file files[] = {\n\t\t{ \"guc_info\", &guc_info_fops, NULL },\n\t\t{ \"guc_registered_contexts\", &guc_registered_contexts_fops, NULL },\n\t\t{ \"guc_slpc_info\", &guc_slpc_info_fops, &intel_eval_slpc_support},\n\t\t{ \"guc_sched_disable_delay_ms\", &guc_sched_disable_delay_ms_fops, NULL },\n\t\t{ \"guc_sched_disable_gucid_threshold\", &guc_sched_disable_gucid_threshold_fops,\n\t\t   NULL },\n\t};\n\n\tif (!intel_guc_is_supported(guc))\n\t\treturn;\n\n\tintel_gt_debugfs_register_files(root, files, ARRAY_SIZE(files), guc);\n\tintel_guc_log_debugfs_register(&guc->log, root);\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}