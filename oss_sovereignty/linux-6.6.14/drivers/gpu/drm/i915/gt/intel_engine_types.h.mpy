{
  "module_name": "intel_engine_types.h",
  "hash_id": "0f65610e094bdd1be546a03c75c6443deef5db3c0514175cca72586bfc5f7985",
  "original_prompt": "Ingested from linux-6.6.14/drivers/gpu/drm/i915/gt/intel_engine_types.h",
  "human_readable_source": " \n \n\n#ifndef __INTEL_ENGINE_TYPES__\n#define __INTEL_ENGINE_TYPES__\n\n#include <linux/average.h>\n#include <linux/hashtable.h>\n#include <linux/irq_work.h>\n#include <linux/kref.h>\n#include <linux/list.h>\n#include <linux/llist.h>\n#include <linux/rbtree.h>\n#include <linux/timer.h>\n#include <linux/types.h>\n#include <linux/workqueue.h>\n\n#include \"i915_gem.h\"\n#include \"i915_pmu.h\"\n#include \"i915_priolist_types.h\"\n#include \"i915_selftest.h\"\n#include \"intel_sseu.h\"\n#include \"intel_timeline_types.h\"\n#include \"intel_uncore.h\"\n#include \"intel_wakeref.h\"\n#include \"intel_workarounds_types.h\"\n\n \n#define RENDER_CLASS\t\t0\n#define VIDEO_DECODE_CLASS\t1\n#define VIDEO_ENHANCEMENT_CLASS\t2\n#define COPY_ENGINE_CLASS\t3\n#define OTHER_CLASS\t\t4\n#define COMPUTE_CLASS\t\t5\n#define MAX_ENGINE_CLASS\t5\n#define MAX_ENGINE_INSTANCE\t8\n\n#define I915_MAX_SLICES\t3\n#define I915_MAX_SUBSLICES 8\n\n#define I915_CMD_HASH_ORDER 9\n\nstruct dma_fence;\nstruct drm_i915_gem_object;\nstruct drm_i915_reg_table;\nstruct i915_gem_context;\nstruct i915_request;\nstruct i915_sched_attr;\nstruct i915_sched_engine;\nstruct intel_gt;\nstruct intel_ring;\nstruct intel_uncore;\nstruct intel_breadcrumbs;\nstruct intel_engine_cs;\nstruct i915_perf_group;\n\ntypedef u32 intel_engine_mask_t;\n#define ALL_ENGINES ((intel_engine_mask_t)~0ul)\n#define VIRTUAL_ENGINES BIT(BITS_PER_TYPE(intel_engine_mask_t) - 1)\n\nstruct intel_hw_status_page {\n\tstruct list_head timelines;\n\tstruct i915_vma *vma;\n\tu32 *addr;\n};\n\nstruct intel_instdone {\n\tu32 instdone;\n\t \n\tu32 slice_common;\n\tu32 slice_common_extra[2];\n\tu32 sampler[GEN_MAX_GSLICES][I915_MAX_SUBSLICES];\n\tu32 row[GEN_MAX_GSLICES][I915_MAX_SUBSLICES];\n\n\t \n\tu32 geom_svg[GEN_MAX_GSLICES][I915_MAX_SUBSLICES];\n};\n\n \nstruct i915_ctx_workarounds {\n\tstruct i915_wa_ctx_bb {\n\t\tu32 offset;\n\t\tu32 size;\n\t} indirect_ctx, per_ctx;\n\tstruct i915_vma *vma;\n};\n\n#define I915_MAX_VCS\t8\n#define I915_MAX_VECS\t4\n#define I915_MAX_SFC\t(I915_MAX_VCS / 2)\n#define I915_MAX_CCS\t4\n#define I915_MAX_RCS\t1\n#define I915_MAX_BCS\t9\n\n \nenum intel_engine_id {\n\tRCS0 = 0,\n\tBCS0,\n\tBCS1,\n\tBCS2,\n\tBCS3,\n\tBCS4,\n\tBCS5,\n\tBCS6,\n\tBCS7,\n\tBCS8,\n#define _BCS(n) (BCS0 + (n))\n\tVCS0,\n\tVCS1,\n\tVCS2,\n\tVCS3,\n\tVCS4,\n\tVCS5,\n\tVCS6,\n\tVCS7,\n#define _VCS(n) (VCS0 + (n))\n\tVECS0,\n\tVECS1,\n\tVECS2,\n\tVECS3,\n#define _VECS(n) (VECS0 + (n))\n\tCCS0,\n\tCCS1,\n\tCCS2,\n\tCCS3,\n#define _CCS(n) (CCS0 + (n))\n\tGSC0,\n\tI915_NUM_ENGINES\n#define INVALID_ENGINE ((enum intel_engine_id)-1)\n};\n\n \nDECLARE_EWMA(_engine_latency, 6, 4)\n\nstruct st_preempt_hang {\n\tstruct completion completion;\n\tunsigned int count;\n};\n\n \nstruct intel_engine_execlists {\n\t \n\tstruct timer_list timer;\n\n\t \n\tstruct timer_list preempt;\n\n\t \n\tconst struct i915_request *preempt_target;\n\n\t \n\tu32 ccid;\n\n\t \n\tu32 yield;\n\n\t \n\tu32 error_interrupt;\n#define ERROR_CSB\tBIT(31)\n#define ERROR_PREEMPT\tBIT(30)\n\n\t \n\tu32 reset_ccid;\n\n\t \n\tu32 __iomem *submit_reg;\n\n\t \n\tu32 __iomem *ctrl_reg;\n\n#define EXECLIST_MAX_PORTS 2\n\t \n\tstruct i915_request * const *active;\n\t \n\tstruct i915_request *inflight[EXECLIST_MAX_PORTS + 1  ];\n\t \n\tstruct i915_request *pending[EXECLIST_MAX_PORTS + 1];\n\n\t \n\tunsigned int port_mask;\n\n\t \n\tstruct rb_root_cached virtual;\n\n\t \n\tu32 *csb_write;\n\n\t \n\tu64 *csb_status;\n\n\t \n\tu8 csb_size;\n\n\t \n\tu8 csb_head;\n\n\t \n\tI915_SELFTEST_DECLARE(struct st_preempt_hang preempt_hang;)\n};\n\n#define INTEL_ENGINE_CS_MAX_NAME 8\n\nstruct intel_engine_execlists_stats {\n\t \n\tunsigned int active;\n\n\t \n\tseqcount_t lock;\n\n\t \n\tktime_t total;\n\n\t \n\tktime_t start;\n};\n\nstruct intel_engine_guc_stats {\n\t \n\tbool running;\n\n\t \n\tu32 prev_total;\n\n\t \n\tu64 total_gt_clks;\n\n\t \n\tu64 start_gt_clk;\n};\n\nunion intel_engine_tlb_inv_reg {\n\ti915_reg_t\treg;\n\ti915_mcr_reg_t\tmcr_reg;\n};\n\nstruct intel_engine_tlb_inv {\n\tbool mcr;\n\tunion intel_engine_tlb_inv_reg reg;\n\tu32 request;\n\tu32 done;\n};\n\nstruct intel_engine_cs {\n\tstruct drm_i915_private *i915;\n\tstruct intel_gt *gt;\n\tstruct intel_uncore *uncore;\n\tchar name[INTEL_ENGINE_CS_MAX_NAME];\n\n\tenum intel_engine_id id;\n\tenum intel_engine_id legacy_idx;\n\n\tunsigned int guc_id;\n\n\tintel_engine_mask_t mask;\n\tu32 reset_domain;\n\t \n\tintel_engine_mask_t logical_mask;\n\n\tu8 class;\n\tu8 instance;\n\n\tu16 uabi_class;\n\tu16 uabi_instance;\n\n\tu32 uabi_capabilities;\n\tu32 context_size;\n\tu32 mmio_base;\n\n\tstruct intel_engine_tlb_inv tlb_inv;\n\n\t \n\tenum forcewake_domains fw_domain;\n\tunsigned int fw_active;\n\n\tunsigned long context_tag;\n\n\tstruct rb_node uabi_node;\n\n\tstruct intel_sseu sseu;\n\n\tstruct i915_sched_engine *sched_engine;\n\n\t \n\tstruct i915_request *request_pool;\n\n\tstruct intel_context *hung_ce;\n\n\tstruct llist_head barrier_tasks;\n\n\tstruct intel_context *kernel_context;  \n\n\t \n\tstruct list_head pinned_contexts_list;\n\n\tintel_engine_mask_t saturated;  \n\n\tstruct {\n\t\tstruct delayed_work work;\n\t\tstruct i915_request *systole;\n\t\tunsigned long blocked;\n\t} heartbeat;\n\n\tunsigned long serial;\n\n\tunsigned long wakeref_serial;\n\tstruct intel_wakeref wakeref;\n\tstruct file *default_state;\n\n\tstruct {\n\t\tstruct intel_ring *ring;\n\t\tstruct intel_timeline *timeline;\n\t} legacy;\n\n\t \n\tstruct ewma__engine_latency latency;\n\n\t \n\tstruct intel_breadcrumbs *breadcrumbs;\n\n\tstruct intel_engine_pmu {\n\t\t \n\t\tu32 enable;\n\t\t \n\t\tunsigned int enable_count[I915_ENGINE_SAMPLE_COUNT];\n\t\t \n\t\tstruct i915_pmu_sample sample[I915_ENGINE_SAMPLE_COUNT];\n\t} pmu;\n\n\tstruct intel_hw_status_page status_page;\n\tstruct i915_ctx_workarounds wa_ctx;\n\tstruct i915_wa_list ctx_wa_list;\n\tstruct i915_wa_list wa_list;\n\tstruct i915_wa_list whitelist;\n\n\tu32             irq_keep_mask;  \n\tu32\t\tirq_enable_mask;  \n\tvoid\t\t(*irq_enable)(struct intel_engine_cs *engine);\n\tvoid\t\t(*irq_disable)(struct intel_engine_cs *engine);\n\tvoid\t\t(*irq_handler)(struct intel_engine_cs *engine, u16 iir);\n\n\tvoid\t\t(*sanitize)(struct intel_engine_cs *engine);\n\tint\t\t(*resume)(struct intel_engine_cs *engine);\n\n\tstruct {\n\t\tvoid (*prepare)(struct intel_engine_cs *engine);\n\n\t\tvoid (*rewind)(struct intel_engine_cs *engine, bool stalled);\n\t\tvoid (*cancel)(struct intel_engine_cs *engine);\n\n\t\tvoid (*finish)(struct intel_engine_cs *engine);\n\t} reset;\n\n\tvoid\t\t(*park)(struct intel_engine_cs *engine);\n\tvoid\t\t(*unpark)(struct intel_engine_cs *engine);\n\n\tvoid\t\t(*bump_serial)(struct intel_engine_cs *engine);\n\n\tvoid\t\t(*set_default_submission)(struct intel_engine_cs *engine);\n\n\tconst struct intel_context_ops *cops;\n\n\tint\t\t(*request_alloc)(struct i915_request *rq);\n\n\tint\t\t(*emit_flush)(struct i915_request *request, u32 mode);\n#define EMIT_INVALIDATE\tBIT(0)\n#define EMIT_FLUSH\tBIT(1)\n#define EMIT_BARRIER\t(EMIT_INVALIDATE | EMIT_FLUSH)\n\tint\t\t(*emit_bb_start)(struct i915_request *rq,\n\t\t\t\t\t u64 offset, u32 length,\n\t\t\t\t\t unsigned int dispatch_flags);\n#define I915_DISPATCH_SECURE BIT(0)\n#define I915_DISPATCH_PINNED BIT(1)\n\tint\t\t (*emit_init_breadcrumb)(struct i915_request *rq);\n\tu32\t\t*(*emit_fini_breadcrumb)(struct i915_request *rq,\n\t\t\t\t\t\t u32 *cs);\n\tunsigned int\temit_fini_breadcrumb_dw;\n\n\t \n\tvoid\t\t(*submit_request)(struct i915_request *rq);\n\n\tvoid\t\t(*release)(struct intel_engine_cs *engine);\n\n\t \n\tvoid\t\t(*add_active_request)(struct i915_request *rq);\n\tvoid\t\t(*remove_active_request)(struct i915_request *rq);\n\n\t \n\tktime_t\t\t(*busyness)(struct intel_engine_cs *engine,\n\t\t\t\t    ktime_t *now);\n\n\tstruct intel_engine_execlists execlists;\n\n\t \n\tstruct intel_timeline *retire;\n\tstruct work_struct retire_work;\n\n\t \n\tstruct atomic_notifier_head context_status_notifier;\n\n#define I915_ENGINE_USING_CMD_PARSER BIT(0)\n#define I915_ENGINE_SUPPORTS_STATS   BIT(1)\n#define I915_ENGINE_HAS_PREEMPTION   BIT(2)\n#define I915_ENGINE_HAS_SEMAPHORES   BIT(3)\n#define I915_ENGINE_HAS_TIMESLICES   BIT(4)\n#define I915_ENGINE_IS_VIRTUAL       BIT(5)\n#define I915_ENGINE_HAS_RELATIVE_MMIO BIT(6)\n#define I915_ENGINE_REQUIRES_CMD_PARSER BIT(7)\n#define I915_ENGINE_WANT_FORCED_PREEMPTION BIT(8)\n#define I915_ENGINE_HAS_RCS_REG_STATE  BIT(9)\n#define I915_ENGINE_HAS_EU_PRIORITY    BIT(10)\n#define I915_ENGINE_FIRST_RENDER_COMPUTE BIT(11)\n#define I915_ENGINE_USES_WA_HOLD_CCS_SWITCHOUT BIT(12)\n\tunsigned int flags;\n\n\t \n\tDECLARE_HASHTABLE(cmd_hash, I915_CMD_HASH_ORDER);\n\n\t \n\tconst struct drm_i915_reg_table *reg_tables;\n\tint reg_table_count;\n\n\t \n\tu32 (*get_cmd_length_mask)(u32 cmd_header);\n\n\tstruct {\n\t\tunion {\n\t\t\tstruct intel_engine_execlists_stats execlists;\n\t\t\tstruct intel_engine_guc_stats guc;\n\t\t};\n\n\t\t \n\t\tktime_t rps;\n\t} stats;\n\n\tstruct {\n\t\tunsigned long heartbeat_interval_ms;\n\t\tunsigned long max_busywait_duration_ns;\n\t\tunsigned long preempt_timeout_ms;\n\t\tunsigned long stop_timeout_ms;\n\t\tunsigned long timeslice_duration_ms;\n\t} props, defaults;\n\n\tI915_SELFTEST_DECLARE(struct fault_attr reset_timeout);\n\n\t \n\tstruct i915_perf_group *oa_group;\n};\n\nstatic inline bool\nintel_engine_using_cmd_parser(const struct intel_engine_cs *engine)\n{\n\treturn engine->flags & I915_ENGINE_USING_CMD_PARSER;\n}\n\nstatic inline bool\nintel_engine_requires_cmd_parser(const struct intel_engine_cs *engine)\n{\n\treturn engine->flags & I915_ENGINE_REQUIRES_CMD_PARSER;\n}\n\nstatic inline bool\nintel_engine_supports_stats(const struct intel_engine_cs *engine)\n{\n\treturn engine->flags & I915_ENGINE_SUPPORTS_STATS;\n}\n\nstatic inline bool\nintel_engine_has_preemption(const struct intel_engine_cs *engine)\n{\n\treturn engine->flags & I915_ENGINE_HAS_PREEMPTION;\n}\n\nstatic inline bool\nintel_engine_has_semaphores(const struct intel_engine_cs *engine)\n{\n\treturn engine->flags & I915_ENGINE_HAS_SEMAPHORES;\n}\n\nstatic inline bool\nintel_engine_has_timeslices(const struct intel_engine_cs *engine)\n{\n\tif (!CONFIG_DRM_I915_TIMESLICE_DURATION)\n\t\treturn false;\n\n\treturn engine->flags & I915_ENGINE_HAS_TIMESLICES;\n}\n\nstatic inline bool\nintel_engine_is_virtual(const struct intel_engine_cs *engine)\n{\n\treturn engine->flags & I915_ENGINE_IS_VIRTUAL;\n}\n\nstatic inline bool\nintel_engine_has_relative_mmio(const struct intel_engine_cs * const engine)\n{\n\treturn engine->flags & I915_ENGINE_HAS_RELATIVE_MMIO;\n}\n\n \nstatic inline bool\nintel_engine_uses_wa_hold_ccs_switchout(struct intel_engine_cs *engine)\n{\n\treturn engine->flags & I915_ENGINE_USES_WA_HOLD_CCS_SWITCHOUT;\n}\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}