{
  "module_name": "intel_gt_sysfs.c",
  "hash_id": "a7d840592b7f2b63e5614c1535174a7b0408c830ead5fb00557370e78c8df956",
  "original_prompt": "Ingested from linux-6.6.14/drivers/gpu/drm/i915/gt/intel_gt_sysfs.c",
  "human_readable_source": "\n \n\n#include <drm/drm_device.h>\n#include <linux/device.h>\n#include <linux/kobject.h>\n#include <linux/printk.h>\n#include <linux/sysfs.h>\n\n#include \"i915_drv.h\"\n#include \"i915_sysfs.h\"\n#include \"intel_gt.h\"\n#include \"intel_gt_print.h\"\n#include \"intel_gt_sysfs.h\"\n#include \"intel_gt_sysfs_pm.h\"\n#include \"intel_gt_types.h\"\n#include \"intel_rc6.h\"\n\nbool is_object_gt(struct kobject *kobj)\n{\n\treturn !strncmp(kobj->name, \"gt\", 2);\n}\n\nstruct intel_gt *intel_gt_sysfs_get_drvdata(struct kobject *kobj,\n\t\t\t\t\t    const char *name)\n{\n\t \n\tif (!is_object_gt(kobj)) {\n\t\tstruct device *dev = kobj_to_dev(kobj);\n\t\tstruct drm_i915_private *i915 = kdev_minor_to_i915(dev);\n\n\t\treturn to_gt(i915);\n\t}\n\n\treturn kobj_to_gt(kobj);\n}\n\nstatic struct kobject *gt_get_parent_obj(struct intel_gt *gt)\n{\n\treturn &gt->i915->drm.primary->kdev->kobj;\n}\n\nstatic ssize_t id_show(struct kobject *kobj,\n\t\t       struct kobj_attribute *attr,\n\t\t       char *buf)\n{\n\tstruct intel_gt *gt = intel_gt_sysfs_get_drvdata(kobj, attr->attr.name);\n\n\treturn sysfs_emit(buf, \"%u\\n\", gt->info.id);\n}\nstatic struct kobj_attribute attr_id = __ATTR_RO(id);\n\nstatic struct attribute *id_attrs[] = {\n\t&attr_id.attr,\n\tNULL,\n};\nATTRIBUTE_GROUPS(id);\n\n \nstatic void kobj_gt_release(struct kobject *kobj)\n{\n}\n\nstatic const struct kobj_type kobj_gt_type = {\n\t.release = kobj_gt_release,\n\t.sysfs_ops = &kobj_sysfs_ops,\n\t.default_groups = id_groups,\n};\n\nvoid intel_gt_sysfs_register(struct intel_gt *gt)\n{\n\t \n\tif (gt_is_root(gt))\n\t\tintel_gt_sysfs_pm_init(gt, gt_get_parent_obj(gt));\n\n\t \n\tif (kobject_init_and_add(&gt->sysfs_gt, &kobj_gt_type,\n\t\t\t\t gt->i915->sysfs_gt, \"gt%d\", gt->info.id))\n\t\tgoto exit_fail;\n\n\tgt->sysfs_defaults = kobject_create_and_add(\".defaults\", &gt->sysfs_gt);\n\tif (!gt->sysfs_defaults)\n\t\tgoto exit_fail;\n\n\tintel_gt_sysfs_pm_init(gt, &gt->sysfs_gt);\n\n\treturn;\n\nexit_fail:\n\tkobject_put(&gt->sysfs_gt);\n\tgt_warn(gt, \"failed to initialize sysfs root\\n\");\n}\n\nvoid intel_gt_sysfs_unregister(struct intel_gt *gt)\n{\n\tkobject_put(gt->sysfs_defaults);\n\tkobject_put(&gt->sysfs_gt);\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}