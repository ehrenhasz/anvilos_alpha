{
  "module_name": "mes_api_def.h",
  "hash_id": "c5ad810f3e40328664549384c94be9856bf2e2fd36e6be1a5fcdbca2f9f40dfd",
  "original_prompt": "Ingested from linux-6.6.14/drivers/gpu/drm/amd/include/mes_api_def.h",
  "human_readable_source": " \n\n#ifndef __MES_API_DEF_H__\n#define __MES_API_DEF_H__\n\n#pragma pack(push, 4)\n\n#define MES_API_VERSION 1\n\n \nenum { API_FRAME_SIZE_IN_DWORDS = 64 };\n\n \nenum { API_NUMBER_OF_COMMAND_MAX = 32 };\n\nenum MES_API_TYPE {\n\tMES_API_TYPE_SCHEDULER = 1,\n\tMES_API_TYPE_MAX\n};\n\nenum MES_SCH_API_OPCODE {\n\tMES_SCH_API_SET_HW_RSRC\t\t\t= 0,\n\tMES_SCH_API_SET_SCHEDULING_CONFIG\t= 1,  \n\tMES_SCH_API_ADD_QUEUE\t\t\t= 2,\n\tMES_SCH_API_REMOVE_QUEUE\t\t= 3,\n\tMES_SCH_API_PERFORM_YIELD\t\t= 4,\n\tMES_SCH_API_SET_GANG_PRIORITY_LEVEL\t= 5,\n\tMES_SCH_API_SUSPEND\t\t\t= 6,\n\tMES_SCH_API_RESUME\t\t\t= 7,\n\tMES_SCH_API_RESET\t\t\t= 8,\n\tMES_SCH_API_SET_LOG_BUFFER\t\t= 9,\n\tMES_SCH_API_CHANGE_GANG_PRORITY\t\t= 10,\n\tMES_SCH_API_QUERY_SCHEDULER_STATUS\t= 11,\n\tMES_SCH_API_PROGRAM_GDS\t\t\t= 12,\n\tMES_SCH_API_SET_DEBUG_VMID\t\t= 13,\n\tMES_SCH_API_MISC\t\t\t= 14,\n\tMES_SCH_API_UPDATE_ROOT_PAGE_TABLE      = 15,\n\tMES_SCH_API_AMD_LOG                     = 16,\n\tMES_SCH_API_MAX\t\t\t\t= 0xFF\n};\n\nunion MES_API_HEADER {\n\tstruct {\n\t\tuint32_t type\t\t: 4;  \n\t\tuint32_t opcode\t\t: 8;\n\t\tuint32_t dwsize\t\t: 8;  \n\t\tuint32_t reserved\t: 12;\n\t};\n\n\tuint32_t\tu32All;\n};\n\nenum MES_AMD_PRIORITY_LEVEL {\n\tAMD_PRIORITY_LEVEL_LOW\t\t= 0,\n\tAMD_PRIORITY_LEVEL_NORMAL\t= 1,\n\tAMD_PRIORITY_LEVEL_MEDIUM\t= 2,\n\tAMD_PRIORITY_LEVEL_HIGH\t\t= 3,\n\tAMD_PRIORITY_LEVEL_REALTIME\t= 4,\n\tAMD_PRIORITY_NUM_LEVELS\n};\n\nenum MES_QUEUE_TYPE {\n\tMES_QUEUE_TYPE_GFX,\n\tMES_QUEUE_TYPE_COMPUTE,\n\tMES_QUEUE_TYPE_SDMA,\n\tMES_QUEUE_TYPE_MAX,\n};\n\nstruct MES_API_STATUS {\n\tuint64_t\tapi_completion_fence_addr;\n\tuint64_t\tapi_completion_fence_value;\n};\n\nenum { MAX_COMPUTE_PIPES = 8 };\nenum { MAX_GFX_PIPES = 2 };\nenum { MAX_SDMA_PIPES = 2 };\n\nenum { MAX_COMPUTE_HQD_PER_PIPE = 8 };\nenum { MAX_GFX_HQD_PER_PIPE = 8 };\nenum { MAX_SDMA_HQD_PER_PIPE = 10 };\n\nenum { MAX_QUEUES_IN_A_GANG = 8 };\n\nenum VM_HUB_TYPE {\n\tVM_HUB_TYPE_GC = 0,\n\tVM_HUB_TYPE_MM = 1,\n\tVM_HUB_TYPE_MAX,\n};\n\nenum { VMID_INVALID = 0xffff };\n\nenum { MAX_VMID_GCHUB = 16 };\nenum { MAX_VMID_MMHUB = 16 };\n\nenum MES_LOG_OPERATION {\n\tMES_LOG_OPERATION_CONTEXT_STATE_CHANGE = 0,\n\tMES_LOG_OPERATION_QUEUE_NEW_WORK = 1,\n\tMES_LOG_OPERATION_QUEUE_UNWAIT_SYNC_OBJECT = 2,\n\tMES_LOG_OPERATION_QUEUE_NO_MORE_WORK = 3,\n\tMES_LOG_OPERATION_QUEUE_WAIT_SYNC_OBJECT = 4,\n\tMES_LOG_OPERATION_QUEUE_INVALID = 0xF,\n};\n\nenum MES_LOG_CONTEXT_STATE {\n\tMES_LOG_CONTEXT_STATE_IDLE\t\t= 0,\n\tMES_LOG_CONTEXT_STATE_RUNNING\t\t= 1,\n\tMES_LOG_CONTEXT_STATE_READY\t\t= 2,\n\tMES_LOG_CONTEXT_STATE_READY_STANDBY\t= 3,\n\tMES_LOG_CONTEXT_STATE_INVALID           = 0xF,\n};\n\nstruct MES_LOG_CONTEXT_STATE_CHANGE {\n\tvoid\t\t\t\t*h_context;\n\tenum MES_LOG_CONTEXT_STATE\tnew_context_state;\n};\n\nstruct MES_LOG_QUEUE_NEW_WORK {\n\tuint64_t                   h_queue;\n\tuint64_t                   reserved;\n};\n\nstruct MES_LOG_QUEUE_UNWAIT_SYNC_OBJECT {\n\tuint64_t                   h_queue;\n\tuint64_t                   h_sync_object;\n};\n\nstruct MES_LOG_QUEUE_NO_MORE_WORK {\n\tuint64_t                   h_queue;\n\tuint64_t                   reserved;\n};\n\nstruct MES_LOG_QUEUE_WAIT_SYNC_OBJECT {\n\tuint64_t                   h_queue;\n\tuint64_t                   h_sync_object;\n};\n\nstruct MES_LOG_ENTRY_HEADER {\n\tuint32_t\tfirst_free_entry_index;\n\tuint32_t\twraparound_count;\n\tuint64_t\tnumber_of_entries;\n\tuint64_t\treserved[2];\n};\n\nstruct MES_LOG_ENTRY_DATA {\n\tuint64_t\tgpu_time_stamp;\n\tuint32_t\toperation_type;  \n\tuint32_t\treserved_operation_type_bits;\n\tunion {\n\t\tstruct MES_LOG_CONTEXT_STATE_CHANGE     context_state_change;\n\t\tstruct MES_LOG_QUEUE_NEW_WORK           queue_new_work;\n\t\tstruct MES_LOG_QUEUE_UNWAIT_SYNC_OBJECT queue_unwait_sync_object;\n\t\tstruct MES_LOG_QUEUE_NO_MORE_WORK       queue_no_more_work;\n\t\tstruct MES_LOG_QUEUE_WAIT_SYNC_OBJECT   queue_wait_sync_object;\n\t\tuint64_t                                all[2];\n\t};\n};\n\nstruct MES_LOG_BUFFER {\n\tstruct MES_LOG_ENTRY_HEADER\theader;\n\tstruct MES_LOG_ENTRY_DATA\tentries[1];\n};\n\nenum MES_SWIP_TO_HWIP_DEF {\n\tMES_MAX_HWIP_SEGMENT = 6,\n};\n\nunion MESAPI_SET_HW_RESOURCES {\n\tstruct {\n\t\tunion MES_API_HEADER\theader;\n\t\tuint32_t\t\tvmid_mask_mmhub;\n\t\tuint32_t\t\tvmid_mask_gfxhub;\n\t\tuint32_t\t\tgds_size;\n\t\tuint32_t\t\tpaging_vmid;\n\t\tuint32_t\t\tcompute_hqd_mask[MAX_COMPUTE_PIPES];\n\t\tuint32_t\t\tgfx_hqd_mask[MAX_GFX_PIPES];\n\t\tuint32_t\t\tsdma_hqd_mask[MAX_SDMA_PIPES];\n\t\tuint32_t\t\taggregated_doorbells[AMD_PRIORITY_NUM_LEVELS];\n\t\tuint64_t\t\tg_sch_ctx_gpu_mc_ptr;\n\t\tuint64_t\t\tquery_status_fence_gpu_mc_ptr;\n\t\tuint32_t\t\tgc_base[MES_MAX_HWIP_SEGMENT];\n\t\tuint32_t\t\tmmhub_base[MES_MAX_HWIP_SEGMENT];\n\t\tuint32_t\t\tosssys_base[MES_MAX_HWIP_SEGMENT];\n\t\tstruct MES_API_STATUS\tapi_status;\n\t\tunion {\n\t\t\tstruct {\n\t\t\t\tuint32_t disable_reset\t: 1;\n\t\t\t\tuint32_t use_different_vmid_compute : 1;\n\t\t\t\tuint32_t disable_mes_log   : 1;\n\t\t\t\tuint32_t apply_mmhub_pgvm_invalidate_ack_loss_wa : 1;\n\t\t\t\tuint32_t apply_grbm_remote_register_dummy_read_wa : 1;\n\t\t\t\tuint32_t second_gfx_pipe_enabled : 1;\n\t\t\t\tuint32_t enable_level_process_quantum_check : 1;\n\t\t\t\tuint32_t apply_cwsr_program_all_vmid_sq_shader_tba_registers_wa : 1;\n\t\t\t\tuint32_t enable_mqd_active_poll : 1;\n\t\t\t\tuint32_t disable_timer_int : 1;\n\t\t\t\tuint32_t reserved\t: 22;\n\t\t\t};\n\t\t\tuint32_t\tuint32_t_all;\n\t\t};\n\t};\n\n\tuint32_t\tmax_dwords_in_api[API_FRAME_SIZE_IN_DWORDS];\n};\n\nunion MESAPI__ADD_QUEUE {\n\tstruct {\n\t\tunion MES_API_HEADER\t\theader;\n\t\tuint32_t\t\t\tprocess_id;\n\t\tuint64_t\t\t\tpage_table_base_addr;\n\t\tuint64_t\t\t\tprocess_va_start;\n\t\tuint64_t\t\t\tprocess_va_end;\n\t\tuint64_t\t\t\tprocess_quantum;\n\t\tuint64_t\t\t\tprocess_context_addr;\n\t\tuint64_t\t\t\tgang_quantum;\n\t\tuint64_t\t\t\tgang_context_addr;\n\t\tuint32_t\t\t\tinprocess_gang_priority;\n\t\tenum MES_AMD_PRIORITY_LEVEL\tgang_global_priority_level;\n\t\tuint32_t\t\t\tdoorbell_offset;\n\t\tuint64_t\t\t\tmqd_addr;\n\t\tuint64_t\t\t\twptr_addr;\n\t\tuint64_t                        h_context;\n\t\tuint64_t                        h_queue;\n\t\tenum MES_QUEUE_TYPE\t\tqueue_type;\n\t\tuint32_t\t\t\tgds_base;\n\t\tuint32_t\t\t\tgds_size;\n\t\tuint32_t\t\t\tgws_base;\n\t\tuint32_t\t\t\tgws_size;\n\t\tuint32_t\t\t\toa_mask;\n\t\tuint64_t                        trap_handler_addr;\n\t\tuint32_t                        vm_context_cntl;\n\n\t\tstruct {\n\t\t\tuint32_t paging\t\t\t: 1;\n\t\t\tuint32_t debug_vmid\t\t: 4;\n\t\t\tuint32_t program_gds\t\t: 1;\n\t\t\tuint32_t is_gang_suspended\t: 1;\n\t\t\tuint32_t is_tmz_queue\t\t: 1;\n\t\t\tuint32_t map_kiq_utility_queue  : 1;\n\t\t\tuint32_t reserved\t\t: 23;\n\t\t};\n\t\tstruct MES_API_STATUS\t\tapi_status;\n\t};\n\n\tuint32_t\tmax_dwords_in_api[API_FRAME_SIZE_IN_DWORDS];\n};\n\nunion MESAPI__REMOVE_QUEUE {\n\tstruct {\n\t\tunion MES_API_HEADER\theader;\n\t\tuint32_t\t\tdoorbell_offset;\n\t\tuint64_t\t\tgang_context_addr;\n\n\t\tstruct {\n\t\t\tuint32_t unmap_legacy_gfx_queue   : 1;\n\t\t\tuint32_t unmap_kiq_utility_queue  : 1;\n\t\t\tuint32_t preempt_legacy_gfx_queue : 1;\n\t\t\tuint32_t reserved                 : 29;\n\t\t};\n\t\tstruct MES_API_STATUS\t    api_status;\n\n\t\tuint32_t                    pipe_id;\n\t\tuint32_t                    queue_id;\n\n\t\tuint64_t                    tf_addr;\n\t\tuint32_t                    tf_data;\n\t};\n\n\tuint32_t\tmax_dwords_in_api[API_FRAME_SIZE_IN_DWORDS];\n};\n\nunion MESAPI__SET_SCHEDULING_CONFIG {\n\tstruct {\n\t\tunion MES_API_HEADER\theader;\n\t\t \n\t\tuint64_t\t\tgrace_period_other_levels[AMD_PRIORITY_NUM_LEVELS];\n\t\t \n\t\tuint64_t\t\tprocess_quantum_for_level[AMD_PRIORITY_NUM_LEVELS];\n\t\t \n\t\tuint64_t\t\tprocess_grace_period_same_level[AMD_PRIORITY_NUM_LEVELS];\n\t\t \n\t\tuint32_t\t\tnormal_yield_percent;\n\t\tstruct MES_API_STATUS\tapi_status;\n\t};\n\n\tuint32_t\tmax_dwords_in_api[API_FRAME_SIZE_IN_DWORDS];\n};\n\nunion MESAPI__PERFORM_YIELD {\n\tstruct {\n\t\tunion MES_API_HEADER\theader;\n\t\tuint32_t\t\tdummy;\n\t\tstruct MES_API_STATUS\tapi_status;\n\t};\n\n\tuint32_t\tmax_dwords_in_api[API_FRAME_SIZE_IN_DWORDS];\n};\n\nunion MESAPI__CHANGE_GANG_PRIORITY_LEVEL {\n\tstruct {\n\t\tunion MES_API_HEADER\t\theader;\n\t\tuint32_t\t\t\tinprocess_gang_priority;\n\t\tenum MES_AMD_PRIORITY_LEVEL\tgang_global_priority_level;\n\t\tuint64_t\t\t\tgang_quantum;\n\t\tuint64_t\t\t\tgang_context_addr;\n\t\tstruct MES_API_STATUS\t\tapi_status;\n\t};\n\n\tuint32_t\tmax_dwords_in_api[API_FRAME_SIZE_IN_DWORDS];\n};\n\nunion MESAPI__SUSPEND {\n\tstruct {\n\t\tunion MES_API_HEADER\theader;\n\t\t \n\t\tstruct {\n\t\t\tuint32_t suspend_all_gangs\t: 1;\n\t\t\tuint32_t reserved\t\t: 31;\n\t\t};\n\t\t \n\t\tuint64_t\t\tgang_context_addr;\n\n\t\tuint64_t\t\tsuspend_fence_addr;\n\t\tuint32_t\t\tsuspend_fence_value;\n\n\t\tstruct MES_API_STATUS\tapi_status;\n\t};\n\n\tuint32_t\tmax_dwords_in_api[API_FRAME_SIZE_IN_DWORDS];\n};\n\nunion MESAPI__RESUME {\n\tstruct {\n\t\tunion MES_API_HEADER\theader;\n\t\t \n\t\tstruct {\n\t\t\tuint32_t resume_all_gangs\t: 1;\n\t\t\tuint32_t reserved\t\t: 31;\n\t\t};\n\t\t \n\t\tuint64_t\t\tgang_context_addr;\n\n\t\tstruct MES_API_STATUS\tapi_status;\n\t};\n\n\tuint32_t\tmax_dwords_in_api[API_FRAME_SIZE_IN_DWORDS];\n};\n\nunion MESAPI__RESET {\n\tstruct {\n\t\tunion MES_API_HEADER\t\theader;\n\n\t\tstruct {\n\t\t\t \n\t\t\tuint32_t                reset_queue_only : 1;\n\t\t\t \n\t\t\tuint32_t                hang_detect_then_reset : 1;\n\t\t\t \n\t\t\tuint32_t                hang_detect_only : 1;\n\t\t\t \n\t\t\tuint32_t                reset_legacy_gfx : 1;\n\t\t\tuint32_t                reserved : 28;\n\t\t};\n\n\t\tuint64_t\t\t\tgang_context_addr;\n\n\t\t \n\t\tuint32_t\t\t\tdoorbell_offset;\n\n\t\t \n\t\tuint64_t\t\t\tdoorbell_offset_addr;\n\t\tenum MES_QUEUE_TYPE\t\tqueue_type;\n\n\t\t \n\t\tuint32_t\t\t\tpipe_id_lp;\n\t\tuint32_t\t\t\tqueue_id_lp;\n\t\tuint32_t\t\t\tvmid_id_lp;\n\t\tuint64_t\t\t\tmqd_mc_addr_lp;\n\t\tuint32_t\t\t\tdoorbell_offset_lp;\n\t\tuint64_t\t\t\twptr_addr_lp;\n\n\t\tuint32_t\t\t\tpipe_id_hp;\n\t\tuint32_t\t\t\tqueue_id_hp;\n\t\tuint32_t\t\t\tvmid_id_hp;\n\t\tuint64_t\t\t\tmqd_mc_addr_hp;\n\t\tuint32_t\t\t\tdoorbell_offset_hp;\n\t\tuint64_t\t\t\twptr_addr_hp;\n\n\t\tstruct MES_API_STATUS\t\tapi_status;\n\t};\n\n\tuint32_t\tmax_dwords_in_api[API_FRAME_SIZE_IN_DWORDS];\n};\n\nunion MESAPI__SET_LOGGING_BUFFER {\n\tstruct {\n\t\tunion MES_API_HEADER\theader;\n\t\t \n\t\tenum MES_QUEUE_TYPE\tlog_type;\n\t\t \n\t\tuint64_t\t\tlogging_buffer_addr;\n\t\t \n\t\tuint32_t\t\tnumber_of_entries;\n\t\t \n\t\tuint32_t\t\tinterrupt_entry;\n\n\t\tstruct MES_API_STATUS\tapi_status;\n\t};\n\n\tuint32_t\tmax_dwords_in_api[API_FRAME_SIZE_IN_DWORDS];\n};\n\nunion MESAPI__QUERY_MES_STATUS {\n\tstruct {\n\t\tunion MES_API_HEADER\theader;\n\t\tbool\t\t\tmes_healthy;  \n\t\tstruct MES_API_STATUS\tapi_status;\n\t};\n\n\tuint32_t\tmax_dwords_in_api[API_FRAME_SIZE_IN_DWORDS];\n};\n\nunion MESAPI__PROGRAM_GDS {\n\tstruct {\n\t\tunion MES_API_HEADER\theader;\n\t\tuint64_t\t\tprocess_context_addr;\n\t\tuint32_t\t\tgds_base;\n\t\tuint32_t\t\tgds_size;\n\t\tuint32_t\t\tgws_base;\n\t\tuint32_t\t\tgws_size;\n\t\tuint32_t\t\toa_mask;\n\t\tstruct MES_API_STATUS\tapi_status;\n\t};\n\n\tuint32_t\tmax_dwords_in_api[API_FRAME_SIZE_IN_DWORDS];\n};\n\nunion MESAPI__SET_DEBUG_VMID {\n\tstruct {\n\t\tunion MES_API_HEADER\theader;\n\t\tstruct MES_API_STATUS\tapi_status;\n\t\tunion {\n\t\t\tstruct {\n\t\t\t\tuint32_t use_gds\t: 1;\n\t\t\t\tuint32_t reserved\t: 31;\n\t\t\t} flags;\n\t\t\tuint32_t\tu32All;\n\t\t};\n\t\tuint32_t\t\treserved;\n\t\tuint32_t\t\tdebug_vmid;\n\t\tuint64_t\t\tprocess_context_addr;\n\t\tuint64_t\t\tpage_table_base_addr;\n\t\tuint64_t\t\tprocess_va_start;\n\t\tuint64_t\t\tprocess_va_end;\n\t\tuint32_t\t\tgds_base;\n\t\tuint32_t\t\tgds_size;\n\t\tuint32_t\t\tgws_base;\n\t\tuint32_t\t\tgws_size;\n\t\tuint32_t\t\toa_mask;\n\t};\n\n\tuint32_t\tmax_dwords_in_api[API_FRAME_SIZE_IN_DWORDS];\n};\n\nenum MESAPI_MISC_OPCODE {\n\tMESAPI_MISC__MODIFY_REG,\n\tMESAPI_MISC__INV_GART,\n\tMESAPI_MISC__QUERY_STATUS,\n\tMESAPI_MISC__MAX,\n};\n\nenum MODIFY_REG_SUBCODE {\n\tMODIFY_REG__OVERWRITE,\n\tMODIFY_REG__RMW_OR,\n\tMODIFY_REG__RMW_AND,\n\tMODIFY_REG__MAX,\n};\n\nenum { MISC_DATA_MAX_SIZE_IN_DWORDS = 20 };\n\nstruct MODIFY_REG {\n\tenum MODIFY_REG_SUBCODE   subcode;\n\tuint32_t                  reg_offset;\n\tuint32_t                  reg_value;\n};\n\nstruct INV_GART {\n\tuint64_t                  inv_range_va_start;\n\tuint64_t                  inv_range_size;\n};\n\nstruct QUERY_STATUS {\n\tuint32_t context_id;\n};\n\nunion MESAPI__MISC {\n\tstruct {\n\t\tunion MES_API_HEADER\theader;\n\t\tenum MESAPI_MISC_OPCODE\topcode;\n\t\tstruct MES_API_STATUS\tapi_status;\n\n\t\tunion {\n\t\t\tstruct\t\tMODIFY_REG modify_reg;\n\t\t\tstruct\t\tINV_GART inv_gart;\n\t\t\tstruct\t\tQUERY_STATUS query_status;\n\t\t\tuint32_t\tdata[MISC_DATA_MAX_SIZE_IN_DWORDS];\n\t\t};\n\t};\n\n\tuint32_t\tmax_dwords_in_api[API_FRAME_SIZE_IN_DWORDS];\n};\n\nunion MESAPI__UPDATE_ROOT_PAGE_TABLE {\n\tstruct {\n\t\tunion MES_API_HEADER        header;\n\t\tuint64_t                    page_table_base_addr;\n\t\tuint64_t                    process_context_addr;\n\t\tstruct MES_API_STATUS       api_status;\n\t};\n\n\tuint32_t max_dwords_in_api[API_FRAME_SIZE_IN_DWORDS];\n};\n\nunion MESAPI_AMD_LOG {\n\tstruct {\n\t\tunion MES_API_HEADER        header;\n\t\tuint64_t                    p_buffer_memory;\n\t\tuint64_t                    p_buffer_size_used;\n\t\tstruct MES_API_STATUS       api_status;\n\t};\n\n\tuint32_t max_dwords_in_api[API_FRAME_SIZE_IN_DWORDS];\n};\n\n#pragma pack(pop)\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}