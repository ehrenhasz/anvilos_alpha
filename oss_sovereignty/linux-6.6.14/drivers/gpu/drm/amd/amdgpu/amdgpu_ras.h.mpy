{
  "module_name": "amdgpu_ras.h",
  "hash_id": "c1e40530065f0fa513c4a27024511236a36ce5d4dc32142dcbd0a57e02512409",
  "original_prompt": "Ingested from linux-6.6.14/drivers/gpu/drm/amd/amdgpu/amdgpu_ras.h",
  "human_readable_source": " \n#ifndef _AMDGPU_RAS_H\n#define _AMDGPU_RAS_H\n\n#include <linux/debugfs.h>\n#include <linux/list.h>\n#include \"ta_ras_if.h\"\n#include \"amdgpu_ras_eeprom.h\"\n\nstruct amdgpu_iv_entry;\n\n#define AMDGPU_RAS_FLAG_INIT_BY_VBIOS\t\t(0x1 << 0)\n \n#define AMDGPU_RAS_INST_MASK 0xfffff000\n#define AMDGPU_RAS_INST_SHIFT 0xc\n\nenum amdgpu_ras_block {\n\tAMDGPU_RAS_BLOCK__UMC = 0,\n\tAMDGPU_RAS_BLOCK__SDMA,\n\tAMDGPU_RAS_BLOCK__GFX,\n\tAMDGPU_RAS_BLOCK__MMHUB,\n\tAMDGPU_RAS_BLOCK__ATHUB,\n\tAMDGPU_RAS_BLOCK__PCIE_BIF,\n\tAMDGPU_RAS_BLOCK__HDP,\n\tAMDGPU_RAS_BLOCK__XGMI_WAFL,\n\tAMDGPU_RAS_BLOCK__DF,\n\tAMDGPU_RAS_BLOCK__SMN,\n\tAMDGPU_RAS_BLOCK__SEM,\n\tAMDGPU_RAS_BLOCK__MP0,\n\tAMDGPU_RAS_BLOCK__MP1,\n\tAMDGPU_RAS_BLOCK__FUSE,\n\tAMDGPU_RAS_BLOCK__MCA,\n\tAMDGPU_RAS_BLOCK__VCN,\n\tAMDGPU_RAS_BLOCK__JPEG,\n\n\tAMDGPU_RAS_BLOCK__LAST\n};\n\nenum amdgpu_ras_mca_block {\n\tAMDGPU_RAS_MCA_BLOCK__MP0 = 0,\n\tAMDGPU_RAS_MCA_BLOCK__MP1,\n\tAMDGPU_RAS_MCA_BLOCK__MPIO,\n\tAMDGPU_RAS_MCA_BLOCK__IOHC,\n\n\tAMDGPU_RAS_MCA_BLOCK__LAST\n};\n\n#define AMDGPU_RAS_BLOCK_COUNT\tAMDGPU_RAS_BLOCK__LAST\n#define AMDGPU_RAS_MCA_BLOCK_COUNT\tAMDGPU_RAS_MCA_BLOCK__LAST\n#define AMDGPU_RAS_BLOCK_MASK\t((1ULL << AMDGPU_RAS_BLOCK_COUNT) - 1)\n\nenum amdgpu_ras_gfx_subblock {\n\t \n\tAMDGPU_RAS_BLOCK__GFX_CPC_INDEX_START = 0,\n\tAMDGPU_RAS_BLOCK__GFX_CPC_SCRATCH =\n\t\tAMDGPU_RAS_BLOCK__GFX_CPC_INDEX_START,\n\tAMDGPU_RAS_BLOCK__GFX_CPC_UCODE,\n\tAMDGPU_RAS_BLOCK__GFX_DC_STATE_ME1,\n\tAMDGPU_RAS_BLOCK__GFX_DC_CSINVOC_ME1,\n\tAMDGPU_RAS_BLOCK__GFX_DC_RESTORE_ME1,\n\tAMDGPU_RAS_BLOCK__GFX_DC_STATE_ME2,\n\tAMDGPU_RAS_BLOCK__GFX_DC_CSINVOC_ME2,\n\tAMDGPU_RAS_BLOCK__GFX_DC_RESTORE_ME2,\n\tAMDGPU_RAS_BLOCK__GFX_CPC_INDEX_END =\n\t\tAMDGPU_RAS_BLOCK__GFX_DC_RESTORE_ME2,\n\t \n\tAMDGPU_RAS_BLOCK__GFX_CPF_INDEX_START,\n\tAMDGPU_RAS_BLOCK__GFX_CPF_ROQ_ME2 =\n\t\tAMDGPU_RAS_BLOCK__GFX_CPF_INDEX_START,\n\tAMDGPU_RAS_BLOCK__GFX_CPF_ROQ_ME1,\n\tAMDGPU_RAS_BLOCK__GFX_CPF_TAG,\n\tAMDGPU_RAS_BLOCK__GFX_CPF_INDEX_END = AMDGPU_RAS_BLOCK__GFX_CPF_TAG,\n\t \n\tAMDGPU_RAS_BLOCK__GFX_CPG_INDEX_START,\n\tAMDGPU_RAS_BLOCK__GFX_CPG_DMA_ROQ =\n\t\tAMDGPU_RAS_BLOCK__GFX_CPG_INDEX_START,\n\tAMDGPU_RAS_BLOCK__GFX_CPG_DMA_TAG,\n\tAMDGPU_RAS_BLOCK__GFX_CPG_TAG,\n\tAMDGPU_RAS_BLOCK__GFX_CPG_INDEX_END = AMDGPU_RAS_BLOCK__GFX_CPG_TAG,\n\t \n\tAMDGPU_RAS_BLOCK__GFX_GDS_INDEX_START,\n\tAMDGPU_RAS_BLOCK__GFX_GDS_MEM = AMDGPU_RAS_BLOCK__GFX_GDS_INDEX_START,\n\tAMDGPU_RAS_BLOCK__GFX_GDS_INPUT_QUEUE,\n\tAMDGPU_RAS_BLOCK__GFX_GDS_OA_PHY_CMD_RAM_MEM,\n\tAMDGPU_RAS_BLOCK__GFX_GDS_OA_PHY_DATA_RAM_MEM,\n\tAMDGPU_RAS_BLOCK__GFX_GDS_OA_PIPE_MEM,\n\tAMDGPU_RAS_BLOCK__GFX_GDS_INDEX_END =\n\t\tAMDGPU_RAS_BLOCK__GFX_GDS_OA_PIPE_MEM,\n\t \n\tAMDGPU_RAS_BLOCK__GFX_SPI_SR_MEM,\n\t \n\tAMDGPU_RAS_BLOCK__GFX_SQ_INDEX_START,\n\tAMDGPU_RAS_BLOCK__GFX_SQ_SGPR = AMDGPU_RAS_BLOCK__GFX_SQ_INDEX_START,\n\tAMDGPU_RAS_BLOCK__GFX_SQ_LDS_D,\n\tAMDGPU_RAS_BLOCK__GFX_SQ_LDS_I,\n\tAMDGPU_RAS_BLOCK__GFX_SQ_VGPR,\n\tAMDGPU_RAS_BLOCK__GFX_SQ_INDEX_END = AMDGPU_RAS_BLOCK__GFX_SQ_VGPR,\n\t \n\tAMDGPU_RAS_BLOCK__GFX_SQC_INDEX_START,\n\t \n\tAMDGPU_RAS_BLOCK__GFX_SQC_INDEX0_START =\n\t\tAMDGPU_RAS_BLOCK__GFX_SQC_INDEX_START,\n\tAMDGPU_RAS_BLOCK__GFX_SQC_INST_UTCL1_LFIFO =\n\t\tAMDGPU_RAS_BLOCK__GFX_SQC_INDEX0_START,\n\tAMDGPU_RAS_BLOCK__GFX_SQC_DATA_CU0_WRITE_DATA_BUF,\n\tAMDGPU_RAS_BLOCK__GFX_SQC_DATA_CU0_UTCL1_LFIFO,\n\tAMDGPU_RAS_BLOCK__GFX_SQC_DATA_CU1_WRITE_DATA_BUF,\n\tAMDGPU_RAS_BLOCK__GFX_SQC_DATA_CU1_UTCL1_LFIFO,\n\tAMDGPU_RAS_BLOCK__GFX_SQC_DATA_CU2_WRITE_DATA_BUF,\n\tAMDGPU_RAS_BLOCK__GFX_SQC_DATA_CU2_UTCL1_LFIFO,\n\tAMDGPU_RAS_BLOCK__GFX_SQC_INDEX0_END =\n\t\tAMDGPU_RAS_BLOCK__GFX_SQC_DATA_CU2_UTCL1_LFIFO,\n\t \n\tAMDGPU_RAS_BLOCK__GFX_SQC_INDEX1_START,\n\tAMDGPU_RAS_BLOCK__GFX_SQC_INST_BANKA_TAG_RAM =\n\t\tAMDGPU_RAS_BLOCK__GFX_SQC_INDEX1_START,\n\tAMDGPU_RAS_BLOCK__GFX_SQC_INST_BANKA_UTCL1_MISS_FIFO,\n\tAMDGPU_RAS_BLOCK__GFX_SQC_INST_BANKA_MISS_FIFO,\n\tAMDGPU_RAS_BLOCK__GFX_SQC_INST_BANKA_BANK_RAM,\n\tAMDGPU_RAS_BLOCK__GFX_SQC_DATA_BANKA_TAG_RAM,\n\tAMDGPU_RAS_BLOCK__GFX_SQC_DATA_BANKA_HIT_FIFO,\n\tAMDGPU_RAS_BLOCK__GFX_SQC_DATA_BANKA_MISS_FIFO,\n\tAMDGPU_RAS_BLOCK__GFX_SQC_DATA_BANKA_DIRTY_BIT_RAM,\n\tAMDGPU_RAS_BLOCK__GFX_SQC_DATA_BANKA_BANK_RAM,\n\tAMDGPU_RAS_BLOCK__GFX_SQC_INDEX1_END =\n\t\tAMDGPU_RAS_BLOCK__GFX_SQC_DATA_BANKA_BANK_RAM,\n\t \n\tAMDGPU_RAS_BLOCK__GFX_SQC_INDEX2_START,\n\tAMDGPU_RAS_BLOCK__GFX_SQC_INST_BANKB_TAG_RAM =\n\t\tAMDGPU_RAS_BLOCK__GFX_SQC_INDEX2_START,\n\tAMDGPU_RAS_BLOCK__GFX_SQC_INST_BANKB_UTCL1_MISS_FIFO,\n\tAMDGPU_RAS_BLOCK__GFX_SQC_INST_BANKB_MISS_FIFO,\n\tAMDGPU_RAS_BLOCK__GFX_SQC_INST_BANKB_BANK_RAM,\n\tAMDGPU_RAS_BLOCK__GFX_SQC_DATA_BANKB_TAG_RAM,\n\tAMDGPU_RAS_BLOCK__GFX_SQC_DATA_BANKB_HIT_FIFO,\n\tAMDGPU_RAS_BLOCK__GFX_SQC_DATA_BANKB_MISS_FIFO,\n\tAMDGPU_RAS_BLOCK__GFX_SQC_DATA_BANKB_DIRTY_BIT_RAM,\n\tAMDGPU_RAS_BLOCK__GFX_SQC_DATA_BANKB_BANK_RAM,\n\tAMDGPU_RAS_BLOCK__GFX_SQC_INDEX2_END =\n\t\tAMDGPU_RAS_BLOCK__GFX_SQC_DATA_BANKB_BANK_RAM,\n\tAMDGPU_RAS_BLOCK__GFX_SQC_INDEX_END =\n\t\tAMDGPU_RAS_BLOCK__GFX_SQC_INDEX2_END,\n\t \n\tAMDGPU_RAS_BLOCK__GFX_TA_INDEX_START,\n\tAMDGPU_RAS_BLOCK__GFX_TA_FS_DFIFO =\n\t\tAMDGPU_RAS_BLOCK__GFX_TA_INDEX_START,\n\tAMDGPU_RAS_BLOCK__GFX_TA_FS_AFIFO,\n\tAMDGPU_RAS_BLOCK__GFX_TA_FL_LFIFO,\n\tAMDGPU_RAS_BLOCK__GFX_TA_FX_LFIFO,\n\tAMDGPU_RAS_BLOCK__GFX_TA_FS_CFIFO,\n\tAMDGPU_RAS_BLOCK__GFX_TA_INDEX_END = AMDGPU_RAS_BLOCK__GFX_TA_FS_CFIFO,\n\t \n\tAMDGPU_RAS_BLOCK__GFX_TCA_INDEX_START,\n\tAMDGPU_RAS_BLOCK__GFX_TCA_HOLE_FIFO =\n\t\tAMDGPU_RAS_BLOCK__GFX_TCA_INDEX_START,\n\tAMDGPU_RAS_BLOCK__GFX_TCA_REQ_FIFO,\n\tAMDGPU_RAS_BLOCK__GFX_TCA_INDEX_END =\n\t\tAMDGPU_RAS_BLOCK__GFX_TCA_REQ_FIFO,\n\t \n\tAMDGPU_RAS_BLOCK__GFX_TCC_INDEX_START,\n\t \n\tAMDGPU_RAS_BLOCK__GFX_TCC_INDEX0_START =\n\t\tAMDGPU_RAS_BLOCK__GFX_TCC_INDEX_START,\n\tAMDGPU_RAS_BLOCK__GFX_TCC_CACHE_DATA =\n\t\tAMDGPU_RAS_BLOCK__GFX_TCC_INDEX0_START,\n\tAMDGPU_RAS_BLOCK__GFX_TCC_CACHE_DATA_BANK_0_1,\n\tAMDGPU_RAS_BLOCK__GFX_TCC_CACHE_DATA_BANK_1_0,\n\tAMDGPU_RAS_BLOCK__GFX_TCC_CACHE_DATA_BANK_1_1,\n\tAMDGPU_RAS_BLOCK__GFX_TCC_CACHE_DIRTY_BANK_0,\n\tAMDGPU_RAS_BLOCK__GFX_TCC_CACHE_DIRTY_BANK_1,\n\tAMDGPU_RAS_BLOCK__GFX_TCC_HIGH_RATE_TAG,\n\tAMDGPU_RAS_BLOCK__GFX_TCC_LOW_RATE_TAG,\n\tAMDGPU_RAS_BLOCK__GFX_TCC_INDEX0_END =\n\t\tAMDGPU_RAS_BLOCK__GFX_TCC_LOW_RATE_TAG,\n\t \n\tAMDGPU_RAS_BLOCK__GFX_TCC_INDEX1_START,\n\tAMDGPU_RAS_BLOCK__GFX_TCC_IN_USE_DEC =\n\t\tAMDGPU_RAS_BLOCK__GFX_TCC_INDEX1_START,\n\tAMDGPU_RAS_BLOCK__GFX_TCC_IN_USE_TRANSFER,\n\tAMDGPU_RAS_BLOCK__GFX_TCC_INDEX1_END =\n\t\tAMDGPU_RAS_BLOCK__GFX_TCC_IN_USE_TRANSFER,\n\t \n\tAMDGPU_RAS_BLOCK__GFX_TCC_INDEX2_START,\n\tAMDGPU_RAS_BLOCK__GFX_TCC_RETURN_DATA =\n\t\tAMDGPU_RAS_BLOCK__GFX_TCC_INDEX2_START,\n\tAMDGPU_RAS_BLOCK__GFX_TCC_RETURN_CONTROL,\n\tAMDGPU_RAS_BLOCK__GFX_TCC_UC_ATOMIC_FIFO,\n\tAMDGPU_RAS_BLOCK__GFX_TCC_WRITE_RETURN,\n\tAMDGPU_RAS_BLOCK__GFX_TCC_WRITE_CACHE_READ,\n\tAMDGPU_RAS_BLOCK__GFX_TCC_SRC_FIFO,\n\tAMDGPU_RAS_BLOCK__GFX_TCC_SRC_FIFO_NEXT_RAM,\n\tAMDGPU_RAS_BLOCK__GFX_TCC_CACHE_TAG_PROBE_FIFO,\n\tAMDGPU_RAS_BLOCK__GFX_TCC_INDEX2_END =\n\t\tAMDGPU_RAS_BLOCK__GFX_TCC_CACHE_TAG_PROBE_FIFO,\n\t \n\tAMDGPU_RAS_BLOCK__GFX_TCC_INDEX3_START,\n\tAMDGPU_RAS_BLOCK__GFX_TCC_LATENCY_FIFO =\n\t\tAMDGPU_RAS_BLOCK__GFX_TCC_INDEX3_START,\n\tAMDGPU_RAS_BLOCK__GFX_TCC_LATENCY_FIFO_NEXT_RAM,\n\tAMDGPU_RAS_BLOCK__GFX_TCC_INDEX3_END =\n\t\tAMDGPU_RAS_BLOCK__GFX_TCC_LATENCY_FIFO_NEXT_RAM,\n\t \n\tAMDGPU_RAS_BLOCK__GFX_TCC_INDEX4_START,\n\tAMDGPU_RAS_BLOCK__GFX_TCC_WRRET_TAG_WRITE_RETURN =\n\t\tAMDGPU_RAS_BLOCK__GFX_TCC_INDEX4_START,\n\tAMDGPU_RAS_BLOCK__GFX_TCC_ATOMIC_RETURN_BUFFER,\n\tAMDGPU_RAS_BLOCK__GFX_TCC_INDEX4_END =\n\t\tAMDGPU_RAS_BLOCK__GFX_TCC_ATOMIC_RETURN_BUFFER,\n\tAMDGPU_RAS_BLOCK__GFX_TCC_INDEX_END =\n\t\tAMDGPU_RAS_BLOCK__GFX_TCC_INDEX4_END,\n\t \n\tAMDGPU_RAS_BLOCK__GFX_TCI_WRITE_RAM,\n\t \n\tAMDGPU_RAS_BLOCK__GFX_TCP_INDEX_START,\n\tAMDGPU_RAS_BLOCK__GFX_TCP_CACHE_RAM =\n\t\tAMDGPU_RAS_BLOCK__GFX_TCP_INDEX_START,\n\tAMDGPU_RAS_BLOCK__GFX_TCP_LFIFO_RAM,\n\tAMDGPU_RAS_BLOCK__GFX_TCP_CMD_FIFO,\n\tAMDGPU_RAS_BLOCK__GFX_TCP_VM_FIFO,\n\tAMDGPU_RAS_BLOCK__GFX_TCP_DB_RAM,\n\tAMDGPU_RAS_BLOCK__GFX_TCP_UTCL1_LFIFO0,\n\tAMDGPU_RAS_BLOCK__GFX_TCP_UTCL1_LFIFO1,\n\tAMDGPU_RAS_BLOCK__GFX_TCP_INDEX_END =\n\t\tAMDGPU_RAS_BLOCK__GFX_TCP_UTCL1_LFIFO1,\n\t \n\tAMDGPU_RAS_BLOCK__GFX_TD_INDEX_START,\n\tAMDGPU_RAS_BLOCK__GFX_TD_SS_FIFO_LO =\n\t\tAMDGPU_RAS_BLOCK__GFX_TD_INDEX_START,\n\tAMDGPU_RAS_BLOCK__GFX_TD_SS_FIFO_HI,\n\tAMDGPU_RAS_BLOCK__GFX_TD_CS_FIFO,\n\tAMDGPU_RAS_BLOCK__GFX_TD_INDEX_END = AMDGPU_RAS_BLOCK__GFX_TD_CS_FIFO,\n\t \n\tAMDGPU_RAS_BLOCK__GFX_EA_INDEX_START,\n\t \n\tAMDGPU_RAS_BLOCK__GFX_EA_INDEX0_START =\n\t\tAMDGPU_RAS_BLOCK__GFX_EA_INDEX_START,\n\tAMDGPU_RAS_BLOCK__GFX_EA_DRAMRD_CMDMEM =\n\t\tAMDGPU_RAS_BLOCK__GFX_EA_INDEX0_START,\n\tAMDGPU_RAS_BLOCK__GFX_EA_DRAMWR_CMDMEM,\n\tAMDGPU_RAS_BLOCK__GFX_EA_DRAMWR_DATAMEM,\n\tAMDGPU_RAS_BLOCK__GFX_EA_RRET_TAGMEM,\n\tAMDGPU_RAS_BLOCK__GFX_EA_WRET_TAGMEM,\n\tAMDGPU_RAS_BLOCK__GFX_EA_GMIRD_CMDMEM,\n\tAMDGPU_RAS_BLOCK__GFX_EA_GMIWR_CMDMEM,\n\tAMDGPU_RAS_BLOCK__GFX_EA_GMIWR_DATAMEM,\n\tAMDGPU_RAS_BLOCK__GFX_EA_INDEX0_END =\n\t\tAMDGPU_RAS_BLOCK__GFX_EA_GMIWR_DATAMEM,\n\t \n\tAMDGPU_RAS_BLOCK__GFX_EA_INDEX1_START,\n\tAMDGPU_RAS_BLOCK__GFX_EA_DRAMRD_PAGEMEM =\n\t\tAMDGPU_RAS_BLOCK__GFX_EA_INDEX1_START,\n\tAMDGPU_RAS_BLOCK__GFX_EA_DRAMWR_PAGEMEM,\n\tAMDGPU_RAS_BLOCK__GFX_EA_IORD_CMDMEM,\n\tAMDGPU_RAS_BLOCK__GFX_EA_IOWR_CMDMEM,\n\tAMDGPU_RAS_BLOCK__GFX_EA_IOWR_DATAMEM,\n\tAMDGPU_RAS_BLOCK__GFX_EA_GMIRD_PAGEMEM,\n\tAMDGPU_RAS_BLOCK__GFX_EA_GMIWR_PAGEMEM,\n\tAMDGPU_RAS_BLOCK__GFX_EA_INDEX1_END =\n\t\tAMDGPU_RAS_BLOCK__GFX_EA_GMIWR_PAGEMEM,\n\t \n\tAMDGPU_RAS_BLOCK__GFX_EA_INDEX2_START,\n\tAMDGPU_RAS_BLOCK__GFX_EA_MAM_D0MEM =\n\t\tAMDGPU_RAS_BLOCK__GFX_EA_INDEX2_START,\n\tAMDGPU_RAS_BLOCK__GFX_EA_MAM_D1MEM,\n\tAMDGPU_RAS_BLOCK__GFX_EA_MAM_D2MEM,\n\tAMDGPU_RAS_BLOCK__GFX_EA_MAM_D3MEM,\n\tAMDGPU_RAS_BLOCK__GFX_EA_INDEX2_END =\n\t\tAMDGPU_RAS_BLOCK__GFX_EA_MAM_D3MEM,\n\tAMDGPU_RAS_BLOCK__GFX_EA_INDEX_END =\n\t\tAMDGPU_RAS_BLOCK__GFX_EA_INDEX2_END,\n\t \n\tAMDGPU_RAS_BLOCK__UTC_VML2_BANK_CACHE,\n\t \n\tAMDGPU_RAS_BLOCK__UTC_VML2_WALKER,\n\t \n\tAMDGPU_RAS_BLOCK__UTC_ATCL2_CACHE_2M_BANK,\n\t \n\tAMDGPU_RAS_BLOCK__UTC_ATCL2_CACHE_4K_BANK,\n\tAMDGPU_RAS_BLOCK__GFX_MAX\n};\n\nenum amdgpu_ras_error_type {\n\tAMDGPU_RAS_ERROR__NONE\t\t\t\t\t\t\t= 0,\n\tAMDGPU_RAS_ERROR__PARITY\t\t\t\t\t\t= 1,\n\tAMDGPU_RAS_ERROR__SINGLE_CORRECTABLE\t\t\t\t\t= 2,\n\tAMDGPU_RAS_ERROR__MULTI_UNCORRECTABLE\t\t\t\t\t= 4,\n\tAMDGPU_RAS_ERROR__POISON\t\t\t\t\t\t= 8,\n};\n\nenum amdgpu_ras_ret {\n\tAMDGPU_RAS_SUCCESS = 0,\n\tAMDGPU_RAS_FAIL,\n\tAMDGPU_RAS_UE,\n\tAMDGPU_RAS_CE,\n\tAMDGPU_RAS_PT,\n};\n\n \n#define ERR_STATUS_LO__ERR_STATUS_VALID_FLAG__SHIFT\t0x0\n#define ERR_STATUS_LO__ERR_STATUS_VALID_FLAG_MASK\t0x00000001L\n#define ERR_STATUS_LO__MEMORY_ID__SHIFT\t\t\t0x18\n#define ERR_STATUS_LO__MEMORY_ID_MASK\t\t\t0xFF000000L\n#define ERR_STATUS_HI__ERR_INFO_VALID_FLAG__SHIFT\t0x2\n#define ERR_STATUS_HI__ERR_INFO_VALID_FLAG_MASK\t\t0x00000004L\n#define ERR_STATUS__ERR_CNT__SHIFT\t\t\t0x17\n#define ERR_STATUS__ERR_CNT_MASK\t\t\t0x03800000L\n\n#define AMDGPU_RAS_REG_ENTRY(ip, inst, reg_lo, reg_hi) \\\n\tip##_HWIP, inst, reg_lo##_BASE_IDX, reg_lo, reg_hi##_BASE_IDX, reg_hi\n\n#define AMDGPU_RAS_REG_ENTRY_OFFSET(hwip, ip_inst, segment, reg) \\\n\t(adev->reg_offset[hwip][ip_inst][segment] + (reg))\n\n#define AMDGPU_RAS_ERR_INFO_VALID\t(1 << 0)\n#define AMDGPU_RAS_ERR_STATUS_VALID\t(1 << 1)\n#define AMDGPU_RAS_ERR_ADDRESS_VALID\t(1 << 2)\n\n#define AMDGPU_RAS_GPU_RESET_MODE2_RESET  (0x1 << 0)\n#define AMDGPU_RAS_GPU_RESET_MODE1_RESET  (0x1 << 1)\n\nstruct amdgpu_ras_err_status_reg_entry {\n\tuint32_t hwip;\n\tuint32_t ip_inst;\n\tuint32_t seg_lo;\n\tuint32_t reg_lo;\n\tuint32_t seg_hi;\n\tuint32_t reg_hi;\n\tuint32_t reg_inst;\n\tuint32_t flags;\n\tconst char *block_name;\n};\n\nstruct amdgpu_ras_memory_id_entry {\n\tuint32_t memory_id;\n\tconst char *name;\n};\n\nstruct ras_common_if {\n\tenum amdgpu_ras_block block;\n\tenum amdgpu_ras_error_type type;\n\tuint32_t sub_block_index;\n\tchar name[32];\n};\n\n#define MAX_UMC_CHANNEL_NUM 32\n\nstruct ecc_info_per_ch {\n\tuint16_t ce_count_lo_chip;\n\tuint16_t ce_count_hi_chip;\n\tuint64_t mca_umc_status;\n\tuint64_t mca_umc_addr;\n\tuint64_t mca_ceumc_addr;\n};\n\nstruct umc_ecc_info {\n\tstruct ecc_info_per_ch ecc[MAX_UMC_CHANNEL_NUM];\n\n\t \n\tint record_ce_addr_supported;\n};\n\nstruct amdgpu_ras {\n\t \n\t \n\tuint32_t features;\n\tstruct list_head head;\n\t \n\tstruct device_attribute features_attr;\n\tstruct bin_attribute badpages_attr;\n\tstruct dentry *de_ras_eeprom_table;\n\t \n\tstruct ras_manager *objs;\n\n\t \n\tstruct work_struct recovery_work;\n\tatomic_t in_recovery;\n\tstruct amdgpu_device *adev;\n\t \n\tstruct ras_err_handler_data *eh_data;\n\tstruct mutex recovery_lock;\n\n\tuint32_t flags;\n\tbool reboot;\n\tstruct amdgpu_ras_eeprom_control eeprom_control;\n\n\tbool error_query_ready;\n\n\t \n\tuint32_t bad_page_cnt_threshold;\n\n\t \n\tbool disable_ras_err_cnt_harvest;\n\n\t \n\tbool poison_supported;\n\n\t \n\tstruct delayed_work ras_counte_delay_work;\n\tatomic_t ras_ue_count;\n\tatomic_t ras_ce_count;\n\n\t \n\tstruct umc_ecc_info umc_ecc;\n\n\t \n\tbool update_channel_flag;\n\n\t \n\tuint32_t  gpu_reset_flags;\n};\n\nstruct ras_fs_data {\n\tchar sysfs_name[32];\n\tchar debugfs_name[32];\n};\n\nstruct ras_err_data {\n\tunsigned long ue_count;\n\tunsigned long ce_count;\n\tunsigned long err_addr_cnt;\n\tstruct eeprom_table_record *err_addr;\n};\n\nstruct ras_err_handler_data {\n\t \n\tstruct eeprom_table_record *bps;\n\t \n\tint count;\n\t \n\tint space_left;\n};\n\ntypedef int (*ras_ih_cb)(struct amdgpu_device *adev,\n\t\tvoid *err_data,\n\t\tstruct amdgpu_iv_entry *entry);\n\nstruct ras_ih_data {\n\t \n\tstruct work_struct ih_work;\n\tint inuse;\n\t \n\tras_ih_cb cb;\n\t \n\tunsigned char *ring;\n\tunsigned int ring_size;\n\tunsigned int element_size;\n\tunsigned int aligned_element_size;\n\tunsigned int rptr;\n\tunsigned int wptr;\n};\n\nstruct ras_manager {\n\tstruct ras_common_if head;\n\t \n\tint use;\n\t \n\tstruct list_head node;\n\t \n\tstruct amdgpu_device *adev;\n\t \n\tstruct device_attribute sysfs_attr;\n\tint attr_inuse;\n\n\t \n\tstruct ras_fs_data fs_data;\n\n\t \n\tstruct ras_ih_data ih_data;\n\n\tstruct ras_err_data err_data;\n};\n\nstruct ras_badpage {\n\tunsigned int bp;\n\tunsigned int size;\n\tunsigned int flags;\n};\n\n \nstruct ras_fs_if {\n\tstruct ras_common_if head;\n\tconst char* sysfs_name;\n\tchar debugfs_name[32];\n};\n\nstruct ras_query_if {\n\tstruct ras_common_if head;\n\tunsigned long ue_count;\n\tunsigned long ce_count;\n};\n\nstruct ras_inject_if {\n\tstruct ras_common_if head;\n\tuint64_t address;\n\tuint64_t value;\n\tuint32_t instance_mask;\n};\n\nstruct ras_cure_if {\n\tstruct ras_common_if head;\n\tuint64_t address;\n};\n\nstruct ras_ih_if {\n\tstruct ras_common_if head;\n\tras_ih_cb cb;\n};\n\nstruct ras_dispatch_if {\n\tstruct ras_common_if head;\n\tstruct amdgpu_iv_entry *entry;\n};\n\nstruct ras_debug_if {\n\tunion {\n\t\tstruct ras_common_if head;\n\t\tstruct ras_inject_if inject;\n\t};\n\tint op;\n};\n\nstruct amdgpu_ras_block_object {\n\tstruct ras_common_if  ras_comm;\n\n\tint (*ras_block_match)(struct amdgpu_ras_block_object *block_obj,\n\t\t\t\tenum amdgpu_ras_block block, uint32_t sub_block_index);\n\tint (*ras_late_init)(struct amdgpu_device *adev, struct ras_common_if *ras_block);\n\tvoid (*ras_fini)(struct amdgpu_device *adev, struct ras_common_if *ras_block);\n\tras_ih_cb ras_cb;\n\tconst struct amdgpu_ras_block_hw_ops *hw_ops;\n};\n\nstruct amdgpu_ras_block_hw_ops {\n\tint  (*ras_error_inject)(struct amdgpu_device *adev,\n\t\t\tvoid *inject_if, uint32_t instance_mask);\n\tvoid (*query_ras_error_count)(struct amdgpu_device *adev, void *ras_error_status);\n\tvoid (*query_ras_error_status)(struct amdgpu_device *adev);\n\tvoid (*query_ras_error_address)(struct amdgpu_device *adev, void *ras_error_status);\n\tvoid (*reset_ras_error_count)(struct amdgpu_device *adev);\n\tvoid (*reset_ras_error_status)(struct amdgpu_device *adev);\n\tbool (*query_poison_status)(struct amdgpu_device *adev);\n\tbool (*handle_poison_consumption)(struct amdgpu_device *adev);\n};\n\n \n\n\nint amdgpu_ras_recovery_init(struct amdgpu_device *adev);\n\nvoid amdgpu_ras_resume(struct amdgpu_device *adev);\nvoid amdgpu_ras_suspend(struct amdgpu_device *adev);\n\nint amdgpu_ras_query_error_count(struct amdgpu_device *adev,\n\t\t\t\t unsigned long *ce_count,\n\t\t\t\t unsigned long *ue_count,\n\t\t\t\t struct ras_query_if *query_info);\n\n \nint amdgpu_ras_add_bad_pages(struct amdgpu_device *adev,\n\t\tstruct eeprom_table_record *bps, int pages);\n\nint amdgpu_ras_save_bad_pages(struct amdgpu_device *adev,\n\t\tunsigned long *new_cnt);\n\nstatic inline enum ta_ras_block\namdgpu_ras_block_to_ta(enum amdgpu_ras_block block) {\n\tswitch (block) {\n\tcase AMDGPU_RAS_BLOCK__UMC:\n\t\treturn TA_RAS_BLOCK__UMC;\n\tcase AMDGPU_RAS_BLOCK__SDMA:\n\t\treturn TA_RAS_BLOCK__SDMA;\n\tcase AMDGPU_RAS_BLOCK__GFX:\n\t\treturn TA_RAS_BLOCK__GFX;\n\tcase AMDGPU_RAS_BLOCK__MMHUB:\n\t\treturn TA_RAS_BLOCK__MMHUB;\n\tcase AMDGPU_RAS_BLOCK__ATHUB:\n\t\treturn TA_RAS_BLOCK__ATHUB;\n\tcase AMDGPU_RAS_BLOCK__PCIE_BIF:\n\t\treturn TA_RAS_BLOCK__PCIE_BIF;\n\tcase AMDGPU_RAS_BLOCK__HDP:\n\t\treturn TA_RAS_BLOCK__HDP;\n\tcase AMDGPU_RAS_BLOCK__XGMI_WAFL:\n\t\treturn TA_RAS_BLOCK__XGMI_WAFL;\n\tcase AMDGPU_RAS_BLOCK__DF:\n\t\treturn TA_RAS_BLOCK__DF;\n\tcase AMDGPU_RAS_BLOCK__SMN:\n\t\treturn TA_RAS_BLOCK__SMN;\n\tcase AMDGPU_RAS_BLOCK__SEM:\n\t\treturn TA_RAS_BLOCK__SEM;\n\tcase AMDGPU_RAS_BLOCK__MP0:\n\t\treturn TA_RAS_BLOCK__MP0;\n\tcase AMDGPU_RAS_BLOCK__MP1:\n\t\treturn TA_RAS_BLOCK__MP1;\n\tcase AMDGPU_RAS_BLOCK__FUSE:\n\t\treturn TA_RAS_BLOCK__FUSE;\n\tcase AMDGPU_RAS_BLOCK__MCA:\n\t\treturn TA_RAS_BLOCK__MCA;\n\tcase AMDGPU_RAS_BLOCK__VCN:\n\t\treturn TA_RAS_BLOCK__VCN;\n\tcase AMDGPU_RAS_BLOCK__JPEG:\n\t\treturn TA_RAS_BLOCK__JPEG;\n\tdefault:\n\t\tWARN_ONCE(1, \"RAS ERROR: unexpected block id %d\\n\", block);\n\t\treturn TA_RAS_BLOCK__UMC;\n\t}\n}\n\nstatic inline enum ta_ras_error_type\namdgpu_ras_error_to_ta(enum amdgpu_ras_error_type error) {\n\tswitch (error) {\n\tcase AMDGPU_RAS_ERROR__NONE:\n\t\treturn TA_RAS_ERROR__NONE;\n\tcase AMDGPU_RAS_ERROR__PARITY:\n\t\treturn TA_RAS_ERROR__PARITY;\n\tcase AMDGPU_RAS_ERROR__SINGLE_CORRECTABLE:\n\t\treturn TA_RAS_ERROR__SINGLE_CORRECTABLE;\n\tcase AMDGPU_RAS_ERROR__MULTI_UNCORRECTABLE:\n\t\treturn TA_RAS_ERROR__MULTI_UNCORRECTABLE;\n\tcase AMDGPU_RAS_ERROR__POISON:\n\t\treturn TA_RAS_ERROR__POISON;\n\tdefault:\n\t\tWARN_ONCE(1, \"RAS ERROR: unexpected error type %d\\n\", error);\n\t\treturn TA_RAS_ERROR__NONE;\n\t}\n}\n\n \nint amdgpu_ras_init(struct amdgpu_device *adev);\nint amdgpu_ras_late_init(struct amdgpu_device *adev);\nint amdgpu_ras_fini(struct amdgpu_device *adev);\nint amdgpu_ras_pre_fini(struct amdgpu_device *adev);\n\nint amdgpu_ras_block_late_init(struct amdgpu_device *adev,\n\t\t\tstruct ras_common_if *ras_block);\n\nvoid amdgpu_ras_block_late_fini(struct amdgpu_device *adev,\n\t\t\t  struct ras_common_if *ras_block);\n\nint amdgpu_ras_feature_enable(struct amdgpu_device *adev,\n\t\tstruct ras_common_if *head, bool enable);\n\nint amdgpu_ras_feature_enable_on_boot(struct amdgpu_device *adev,\n\t\tstruct ras_common_if *head, bool enable);\n\nint amdgpu_ras_sysfs_create(struct amdgpu_device *adev,\n\t\tstruct ras_common_if *head);\n\nint amdgpu_ras_sysfs_remove(struct amdgpu_device *adev,\n\t\tstruct ras_common_if *head);\n\nvoid amdgpu_ras_debugfs_create_all(struct amdgpu_device *adev);\n\nint amdgpu_ras_query_error_status(struct amdgpu_device *adev,\n\t\tstruct ras_query_if *info);\n\nint amdgpu_ras_reset_error_status(struct amdgpu_device *adev,\n\t\tenum amdgpu_ras_block block);\n\nint amdgpu_ras_error_inject(struct amdgpu_device *adev,\n\t\tstruct ras_inject_if *info);\n\nint amdgpu_ras_interrupt_add_handler(struct amdgpu_device *adev,\n\t\tstruct ras_common_if *head);\n\nint amdgpu_ras_interrupt_remove_handler(struct amdgpu_device *adev,\n\t\tstruct ras_common_if *head);\n\nint amdgpu_ras_interrupt_dispatch(struct amdgpu_device *adev,\n\t\tstruct ras_dispatch_if *info);\n\nstruct ras_manager *amdgpu_ras_find_obj(struct amdgpu_device *adev,\n\t\tstruct ras_common_if *head);\n\nextern atomic_t amdgpu_ras_in_intr;\n\nstatic inline bool amdgpu_ras_intr_triggered(void)\n{\n\treturn !!atomic_read(&amdgpu_ras_in_intr);\n}\n\nstatic inline void amdgpu_ras_intr_cleared(void)\n{\n\tatomic_set(&amdgpu_ras_in_intr, 0);\n}\n\nvoid amdgpu_ras_global_ras_isr(struct amdgpu_device *adev);\n\nvoid amdgpu_ras_set_error_query_ready(struct amdgpu_device *adev, bool ready);\n\nbool amdgpu_ras_need_emergency_restart(struct amdgpu_device *adev);\n\nvoid amdgpu_release_ras_context(struct amdgpu_device *adev);\n\nint amdgpu_persistent_edc_harvesting_supported(struct amdgpu_device *adev);\n\nconst char *get_ras_block_str(struct ras_common_if *ras_block);\n\nbool amdgpu_ras_is_poison_mode_supported(struct amdgpu_device *adev);\n\nint amdgpu_ras_is_supported(struct amdgpu_device *adev, unsigned int block);\n\nint amdgpu_ras_reset_gpu(struct amdgpu_device *adev);\n\nstruct amdgpu_ras* amdgpu_ras_get_context(struct amdgpu_device *adev);\n\nint amdgpu_ras_set_context(struct amdgpu_device *adev, struct amdgpu_ras *ras_con);\n\nint amdgpu_ras_register_ras_block(struct amdgpu_device *adev,\n\t\t\t\tstruct amdgpu_ras_block_object *ras_block_obj);\nvoid amdgpu_ras_interrupt_fatal_error_handler(struct amdgpu_device *adev);\nvoid amdgpu_ras_get_error_type_name(uint32_t err_type, char *err_type_name);\nbool amdgpu_ras_inst_get_memory_id_field(struct amdgpu_device *adev,\n\t\t\t\t\t const struct amdgpu_ras_err_status_reg_entry *reg_entry,\n\t\t\t\t\t uint32_t instance,\n\t\t\t\t\t uint32_t *memory_id);\nbool amdgpu_ras_inst_get_err_cnt_field(struct amdgpu_device *adev,\n\t\t\t\t       const struct amdgpu_ras_err_status_reg_entry *reg_entry,\n\t\t\t\t       uint32_t instance,\n\t\t\t\t       unsigned long *err_cnt);\nvoid amdgpu_ras_inst_query_ras_error_count(struct amdgpu_device *adev,\n\t\t\t\t\t   const struct amdgpu_ras_err_status_reg_entry *reg_list,\n\t\t\t\t\t   uint32_t reg_list_size,\n\t\t\t\t\t   const struct amdgpu_ras_memory_id_entry *mem_list,\n\t\t\t\t\t   uint32_t mem_list_size,\n\t\t\t\t\t   uint32_t instance,\n\t\t\t\t\t   uint32_t err_type,\n\t\t\t\t\t   unsigned long *err_count);\nvoid amdgpu_ras_inst_reset_ras_error_count(struct amdgpu_device *adev,\n\t\t\t\t\t   const struct amdgpu_ras_err_status_reg_entry *reg_list,\n\t\t\t\t\t   uint32_t reg_list_size,\n\t\t\t\t\t   uint32_t instance);\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}