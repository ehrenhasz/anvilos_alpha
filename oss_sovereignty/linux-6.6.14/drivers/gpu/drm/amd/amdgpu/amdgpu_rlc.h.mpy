{
  "module_name": "amdgpu_rlc.h",
  "hash_id": "483405374a78677577dd6a46ffffb20a69d0aceac4923287717f82f437e44b31",
  "original_prompt": "Ingested from linux-6.6.14/drivers/gpu/drm/amd/amdgpu/amdgpu_rlc.h",
  "human_readable_source": " \n\n#ifndef __AMDGPU_RLC_H__\n#define __AMDGPU_RLC_H__\n\n#include \"clearstate_defs.h\"\n\n#define AMDGPU_MAX_RLC_INSTANCES\t8\n\n \ntypedef enum _FIRMWARE_ID_ {\n\tFIRMWARE_ID_INVALID\t\t\t\t\t= 0,\n\tFIRMWARE_ID_RLC_G_UCODE\t\t\t\t\t= 1,\n\tFIRMWARE_ID_RLC_TOC\t\t\t\t\t= 2,\n\tFIRMWARE_ID_RLCG_SCRATCH                                = 3,\n\tFIRMWARE_ID_RLC_SRM_ARAM                                = 4,\n\tFIRMWARE_ID_RLC_SRM_INDEX_ADDR                          = 5,\n\tFIRMWARE_ID_RLC_SRM_INDEX_DATA                          = 6,\n\tFIRMWARE_ID_RLC_P_UCODE                                 = 7,\n\tFIRMWARE_ID_RLC_V_UCODE                                 = 8,\n\tFIRMWARE_ID_RLX6_UCODE                                  = 9,\n\tFIRMWARE_ID_RLX6_DRAM_BOOT                              = 10,\n\tFIRMWARE_ID_GLOBAL_TAP_DELAYS                           = 11,\n\tFIRMWARE_ID_SE0_TAP_DELAYS                              = 12,\n\tFIRMWARE_ID_SE1_TAP_DELAYS                              = 13,\n\tFIRMWARE_ID_GLOBAL_SE0_SE1_SKEW_DELAYS                  = 14,\n\tFIRMWARE_ID_SDMA0_UCODE                                 = 15,\n\tFIRMWARE_ID_SDMA0_JT                                    = 16,\n\tFIRMWARE_ID_SDMA1_UCODE                                 = 17,\n\tFIRMWARE_ID_SDMA1_JT                                    = 18,\n\tFIRMWARE_ID_CP_CE                                       = 19,\n\tFIRMWARE_ID_CP_PFP                                      = 20,\n\tFIRMWARE_ID_CP_ME                                       = 21,\n\tFIRMWARE_ID_CP_MEC                                      = 22,\n\tFIRMWARE_ID_CP_MES                                      = 23,\n\tFIRMWARE_ID_MES_STACK                                   = 24,\n\tFIRMWARE_ID_RLC_SRM_DRAM_SR                             = 25,\n\tFIRMWARE_ID_RLCG_SCRATCH_SR                             = 26,\n\tFIRMWARE_ID_RLCP_SCRATCH_SR                             = 27,\n\tFIRMWARE_ID_RLCV_SCRATCH_SR                             = 28,\n\tFIRMWARE_ID_RLX6_DRAM_SR                                = 29,\n\tFIRMWARE_ID_SDMA0_PG_CONTEXT                            = 30,\n\tFIRMWARE_ID_SDMA1_PG_CONTEXT                            = 31,\n\tFIRMWARE_ID_GLOBAL_MUX_SELECT_RAM                       = 32,\n\tFIRMWARE_ID_SE0_MUX_SELECT_RAM                          = 33,\n\tFIRMWARE_ID_SE1_MUX_SELECT_RAM                          = 34,\n\tFIRMWARE_ID_ACCUM_CTRL_RAM                              = 35,\n\tFIRMWARE_ID_RLCP_CAM                                    = 36,\n\tFIRMWARE_ID_RLC_SPP_CAM_EXT                             = 37,\n\tFIRMWARE_ID_MAX                                         = 38,\n} FIRMWARE_ID;\n\ntypedef enum _SOC21_FIRMWARE_ID_ {\n    SOC21_FIRMWARE_ID_INVALID                     = 0,\n    SOC21_FIRMWARE_ID_RLC_G_UCODE                 = 1,\n    SOC21_FIRMWARE_ID_RLC_TOC                     = 2,\n    SOC21_FIRMWARE_ID_RLCG_SCRATCH                = 3,\n    SOC21_FIRMWARE_ID_RLC_SRM_ARAM                = 4,\n    SOC21_FIRMWARE_ID_RLC_P_UCODE                 = 5,\n    SOC21_FIRMWARE_ID_RLC_V_UCODE                 = 6,\n    SOC21_FIRMWARE_ID_RLX6_UCODE                  = 7,\n    SOC21_FIRMWARE_ID_RLX6_UCODE_CORE1            = 8,\n    SOC21_FIRMWARE_ID_RLX6_DRAM_BOOT              = 9,\n    SOC21_FIRMWARE_ID_RLX6_DRAM_BOOT_CORE1        = 10,\n    SOC21_FIRMWARE_ID_SDMA_UCODE_TH0              = 11,\n    SOC21_FIRMWARE_ID_SDMA_UCODE_TH1              = 12,\n    SOC21_FIRMWARE_ID_CP_PFP                      = 13,\n    SOC21_FIRMWARE_ID_CP_ME                       = 14,\n    SOC21_FIRMWARE_ID_CP_MEC                      = 15,\n    SOC21_FIRMWARE_ID_RS64_MES_P0                 = 16,\n    SOC21_FIRMWARE_ID_RS64_MES_P1                 = 17,\n    SOC21_FIRMWARE_ID_RS64_PFP                    = 18,\n    SOC21_FIRMWARE_ID_RS64_ME                     = 19,\n    SOC21_FIRMWARE_ID_RS64_MEC                    = 20,\n    SOC21_FIRMWARE_ID_RS64_MES_P0_STACK           = 21,\n    SOC21_FIRMWARE_ID_RS64_MES_P1_STACK           = 22,\n    SOC21_FIRMWARE_ID_RS64_PFP_P0_STACK           = 23,\n    SOC21_FIRMWARE_ID_RS64_PFP_P1_STACK           = 24,\n    SOC21_FIRMWARE_ID_RS64_ME_P0_STACK            = 25,\n    SOC21_FIRMWARE_ID_RS64_ME_P1_STACK            = 26,\n    SOC21_FIRMWARE_ID_RS64_MEC_P0_STACK           = 27,\n    SOC21_FIRMWARE_ID_RS64_MEC_P1_STACK           = 28,\n    SOC21_FIRMWARE_ID_RS64_MEC_P2_STACK           = 29,\n    SOC21_FIRMWARE_ID_RS64_MEC_P3_STACK           = 30,\n    SOC21_FIRMWARE_ID_RLC_SRM_DRAM_SR             = 31,\n    SOC21_FIRMWARE_ID_RLCG_SCRATCH_SR             = 32,\n    SOC21_FIRMWARE_ID_RLCP_SCRATCH_SR             = 33,\n    SOC21_FIRMWARE_ID_RLCV_SCRATCH_SR             = 34,\n    SOC21_FIRMWARE_ID_RLX6_DRAM_SR                = 35,\n    SOC21_FIRMWARE_ID_RLX6_DRAM_SR_CORE1          = 36,\n    SOC21_FIRMWARE_ID_MAX                         = 37\n} SOC21_FIRMWARE_ID;\n\ntypedef struct _RLC_TABLE_OF_CONTENT {\n\tunion {\n\t\tunsigned int\tDW0;\n\t\tstruct {\n\t\t\tunsigned int\toffset\t\t: 25;\n\t\t\tunsigned int\tid\t\t: 7;\n\t\t};\n\t};\n\n\tunion {\n\t\tunsigned int\tDW1;\n\t\tstruct {\n\t\t\tunsigned int\tload_at_boot\t\t: 1;\n\t\t\tunsigned int\tload_at_vddgfx\t\t: 1;\n\t\t\tunsigned int\tload_at_reset\t\t: 1;\n\t\t\tunsigned int\tmemory_destination\t: 2;\n\t\t\tunsigned int\tvfflr_image_code\t: 4;\n\t\t\tunsigned int\tload_mode_direct\t: 1;\n\t\t\tunsigned int\tsave_for_vddgfx\t\t: 1;\n\t\t\tunsigned int\tsave_for_vfflr\t\t: 1;\n\t\t\tunsigned int\treserved\t\t: 1;\n\t\t\tunsigned int\tsigned_source\t\t: 1;\n\t\t\tunsigned int\tsize\t\t\t: 18;\n\t\t};\n\t};\n\n\tunion {\n\t\tunsigned int\tDW2;\n\t\tstruct {\n\t\t\tunsigned int\tindirect_addr_reg\t: 16;\n\t\t\tunsigned int\tindex\t\t\t: 16;\n\t\t};\n\t};\n\n\tunion {\n\t\tunsigned int\tDW3;\n\t\tstruct {\n\t\t\tunsigned int\tindirect_data_reg\t: 16;\n\t\t\tunsigned int\tindirect_start_offset\t: 16;\n\t\t};\n\t};\n} RLC_TABLE_OF_CONTENT;\n\n#define RLC_TOC_MAX_SIZE\t\t64\n\nstruct amdgpu_rlc_funcs {\n\tbool (*is_rlc_enabled)(struct amdgpu_device *adev);\n\tvoid (*set_safe_mode)(struct amdgpu_device *adev, int xcc_id);\n\tvoid (*unset_safe_mode)(struct amdgpu_device *adev, int xcc_id);\n\tint  (*init)(struct amdgpu_device *adev);\n\tu32  (*get_csb_size)(struct amdgpu_device *adev);\n\tvoid (*get_csb_buffer)(struct amdgpu_device *adev, volatile u32 *buffer);\n\tint  (*get_cp_table_num)(struct amdgpu_device *adev);\n\tint  (*resume)(struct amdgpu_device *adev);\n\tvoid (*stop)(struct amdgpu_device *adev);\n\tvoid (*reset)(struct amdgpu_device *adev);\n\tvoid (*start)(struct amdgpu_device *adev);\n\tvoid (*update_spm_vmid)(struct amdgpu_device *adev, unsigned vmid);\n\tbool (*is_rlcg_access_range)(struct amdgpu_device *adev, uint32_t reg);\n};\n\nstruct amdgpu_rlcg_reg_access_ctrl {\n\tuint32_t scratch_reg0;\n\tuint32_t scratch_reg1;\n\tuint32_t scratch_reg2;\n\tuint32_t scratch_reg3;\n\tuint32_t grbm_cntl;\n\tuint32_t grbm_idx;\n\tuint32_t spare_int;\n};\n\nstruct amdgpu_rlc {\n\t \n\tstruct amdgpu_bo        *save_restore_obj;\n\tuint64_t                save_restore_gpu_addr;\n\tvolatile uint32_t       *sr_ptr;\n\tconst u32               *reg_list;\n\tu32                     reg_list_size;\n\t \n\tstruct amdgpu_bo        *clear_state_obj;\n\tuint64_t                clear_state_gpu_addr;\n\tvolatile uint32_t       *cs_ptr;\n\tconst struct cs_section_def   *cs_data;\n\tu32                     clear_state_size;\n\t \n\tstruct amdgpu_bo        *cp_table_obj;\n\tuint64_t                cp_table_gpu_addr;\n\tvolatile uint32_t       *cp_table_ptr;\n\tu32                     cp_table_size;\n\n\t \n\tbool in_safe_mode[AMDGPU_MAX_RLC_INSTANCES];\n\tconst struct amdgpu_rlc_funcs *funcs;\n\n\t \n\tu32 save_and_restore_offset;\n\tu32 clear_state_descriptor_offset;\n\tu32 avail_scratch_ram_locations;\n\tu32 reg_restore_list_size;\n\tu32 reg_list_format_start;\n\tu32 reg_list_format_separate_start;\n\tu32 starting_offsets_start;\n\tu32 reg_list_format_size_bytes;\n\tu32 reg_list_size_bytes;\n\tu32 reg_list_format_direct_reg_list_length;\n\tu32 save_restore_list_cntl_size_bytes;\n\tu32 save_restore_list_gpm_size_bytes;\n\tu32 save_restore_list_srm_size_bytes;\n\tu32 rlc_iram_ucode_size_bytes;\n\tu32 rlc_dram_ucode_size_bytes;\n\tu32 rlcp_ucode_size_bytes;\n\tu32 rlcv_ucode_size_bytes;\n\tu32 global_tap_delays_ucode_size_bytes;\n\tu32 se0_tap_delays_ucode_size_bytes;\n\tu32 se1_tap_delays_ucode_size_bytes;\n\tu32 se2_tap_delays_ucode_size_bytes;\n\tu32 se3_tap_delays_ucode_size_bytes;\n\n\tu32 *register_list_format;\n\tu32 *register_restore;\n\tu8 *save_restore_list_cntl;\n\tu8 *save_restore_list_gpm;\n\tu8 *save_restore_list_srm;\n\tu8 *rlc_iram_ucode;\n\tu8 *rlc_dram_ucode;\n\tu8 *rlcp_ucode;\n\tu8 *rlcv_ucode;\n\tu8 *global_tap_delays_ucode;\n\tu8 *se0_tap_delays_ucode;\n\tu8 *se1_tap_delays_ucode;\n\tu8 *se2_tap_delays_ucode;\n\tu8 *se3_tap_delays_ucode;\n\n\tbool is_rlc_v2_1;\n\n\t \n\tstruct amdgpu_bo\t*rlc_autoload_bo;\n\tu64\t\t\trlc_autoload_gpu_addr;\n\tvoid\t\t\t*rlc_autoload_ptr;\n\n\t \n\tstruct amdgpu_bo\t*rlc_toc_bo;\n\tuint64_t\t\trlc_toc_gpu_addr;\n\tvoid\t\t\t*rlc_toc_buf;\n\n\tbool rlcg_reg_access_supported;\n\t \n\tstruct amdgpu_rlcg_reg_access_ctrl reg_access_ctrl[AMDGPU_MAX_RLC_INSTANCES];\n};\n\nvoid amdgpu_gfx_rlc_enter_safe_mode(struct amdgpu_device *adev, int xcc_id);\nvoid amdgpu_gfx_rlc_exit_safe_mode(struct amdgpu_device *adev, int xcc_id);\nint amdgpu_gfx_rlc_init_sr(struct amdgpu_device *adev, u32 dws);\nint amdgpu_gfx_rlc_init_csb(struct amdgpu_device *adev);\nint amdgpu_gfx_rlc_init_cpt(struct amdgpu_device *adev);\nvoid amdgpu_gfx_rlc_setup_cp_table(struct amdgpu_device *adev);\nvoid amdgpu_gfx_rlc_fini(struct amdgpu_device *adev);\nint amdgpu_gfx_rlc_init_microcode(struct amdgpu_device *adev,\n\t\t\t\t  uint16_t version_major,\n\t\t\t\t  uint16_t version_minor);\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}