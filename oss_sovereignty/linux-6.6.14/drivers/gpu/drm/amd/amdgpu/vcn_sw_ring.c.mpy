{
  "module_name": "vcn_sw_ring.c",
  "hash_id": "96fd7fb70a4751aec3a8b48208f18818a1ee9e90e1e6e464b07b80e5f0d7caa4",
  "original_prompt": "Ingested from linux-6.6.14/drivers/gpu/drm/amd/amdgpu/vcn_sw_ring.c",
  "human_readable_source": " \n\n#include \"amdgpu.h\"\n#include \"vcn_sw_ring.h\"\n\nvoid vcn_dec_sw_ring_emit_fence(struct amdgpu_ring *ring, u64 addr,\n\tu64 seq, uint32_t flags)\n{\n\tWARN_ON(flags & AMDGPU_FENCE_FLAG_64BIT);\n\n\tamdgpu_ring_write(ring, VCN_DEC_SW_CMD_FENCE);\n\tamdgpu_ring_write(ring, addr);\n\tamdgpu_ring_write(ring, upper_32_bits(addr));\n\tamdgpu_ring_write(ring, seq);\n\tamdgpu_ring_write(ring, VCN_DEC_SW_CMD_TRAP);\n}\n\nvoid vcn_dec_sw_ring_insert_end(struct amdgpu_ring *ring)\n{\n\tamdgpu_ring_write(ring, VCN_DEC_SW_CMD_END);\n}\n\nvoid vcn_dec_sw_ring_emit_ib(struct amdgpu_ring *ring, struct amdgpu_job *job,\n\tstruct amdgpu_ib *ib, uint32_t flags)\n{\n\tuint32_t vmid = AMDGPU_JOB_GET_VMID(job);\n\n\tamdgpu_ring_write(ring, VCN_DEC_SW_CMD_IB);\n\tamdgpu_ring_write(ring, vmid);\n\tamdgpu_ring_write(ring, lower_32_bits(ib->gpu_addr));\n\tamdgpu_ring_write(ring, upper_32_bits(ib->gpu_addr));\n\tamdgpu_ring_write(ring, ib->length_dw);\n}\n\nvoid vcn_dec_sw_ring_emit_reg_wait(struct amdgpu_ring *ring, uint32_t reg,\n\tuint32_t val, uint32_t mask)\n{\n\tamdgpu_ring_write(ring, VCN_DEC_SW_CMD_REG_WAIT);\n\tamdgpu_ring_write(ring, reg << 2);\n\tamdgpu_ring_write(ring, mask);\n\tamdgpu_ring_write(ring, val);\n}\n\nvoid vcn_dec_sw_ring_emit_vm_flush(struct amdgpu_ring *ring,\n\tuint32_t vmid, uint64_t pd_addr)\n{\n\tstruct amdgpu_vmhub *hub = &ring->adev->vmhub[ring->vm_hub];\n\tuint32_t data0, data1, mask;\n\n\tpd_addr = amdgpu_gmc_emit_flush_gpu_tlb(ring, vmid, pd_addr);\n\n\t \n\tdata0 = hub->ctx0_ptb_addr_lo32 + vmid * hub->ctx_addr_distance;\n\tdata1 = lower_32_bits(pd_addr);\n\tmask = 0xffffffff;\n\tvcn_dec_sw_ring_emit_reg_wait(ring, data0, data1, mask);\n}\n\nvoid vcn_dec_sw_ring_emit_wreg(struct amdgpu_ring *ring, uint32_t reg,\n\tuint32_t val)\n{\n\tamdgpu_ring_write(ring, VCN_DEC_SW_CMD_REG_WRITE);\n\tamdgpu_ring_write(ring,\treg << 2);\n\tamdgpu_ring_write(ring, val);\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}