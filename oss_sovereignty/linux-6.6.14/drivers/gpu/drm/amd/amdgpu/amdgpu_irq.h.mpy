{
  "module_name": "amdgpu_irq.h",
  "hash_id": "fbf6bf34b887b59b20b7e7f278402b94f68bf8c051db41b5cec38151494c8a3d",
  "original_prompt": "Ingested from linux-6.6.14/drivers/gpu/drm/amd/amdgpu/amdgpu_irq.h",
  "human_readable_source": " \n\n#ifndef __AMDGPU_IRQ_H__\n#define __AMDGPU_IRQ_H__\n\n#include <linux/irqdomain.h>\n#include \"soc15_ih_clientid.h\"\n#include \"amdgpu_ih.h\"\n\n#define AMDGPU_MAX_IRQ_SRC_ID\t\t0x100\n#define AMDGPU_MAX_IRQ_CLIENT_ID\t0x100\n\n#define AMDGPU_IRQ_CLIENTID_LEGACY\t0\n#define AMDGPU_IRQ_CLIENTID_MAX\t\tSOC15_IH_CLIENTID_MAX\n\n#define AMDGPU_IRQ_SRC_DATA_MAX_SIZE_DW\t4\n\nstruct amdgpu_device;\n\nenum amdgpu_interrupt_state {\n\tAMDGPU_IRQ_STATE_DISABLE,\n\tAMDGPU_IRQ_STATE_ENABLE,\n};\n\nstruct amdgpu_iv_entry {\n\tstruct amdgpu_ih_ring *ih;\n\tunsigned client_id;\n\tunsigned src_id;\n\tunsigned ring_id;\n\tunsigned vmid;\n\tunsigned vmid_src;\n\tuint64_t timestamp;\n\tunsigned timestamp_src;\n\tunsigned pasid;\n\tunsigned node_id;\n\tunsigned src_data[AMDGPU_IRQ_SRC_DATA_MAX_SIZE_DW];\n\tconst uint32_t *iv_entry;\n};\n\nstruct amdgpu_irq_src {\n\tunsigned\t\t\t\tnum_types;\n\tatomic_t\t\t\t\t*enabled_types;\n\tconst struct amdgpu_irq_src_funcs\t*funcs;\n};\n\nstruct amdgpu_irq_client {\n\tstruct amdgpu_irq_src **sources;\n};\n\n \nstruct amdgpu_irq_src_funcs {\n\tint (*set)(struct amdgpu_device *adev, struct amdgpu_irq_src *source,\n\t\t   unsigned type, enum amdgpu_interrupt_state state);\n\n\tint (*process)(struct amdgpu_device *adev,\n\t\t       struct amdgpu_irq_src *source,\n\t\t       struct amdgpu_iv_entry *entry);\n};\n\nstruct amdgpu_irq {\n\tbool\t\t\t\tinstalled;\n\tunsigned int\t\t\tirq;\n\tspinlock_t\t\t\tlock;\n\t \n\tstruct amdgpu_irq_client\tclient[AMDGPU_IRQ_CLIENTID_MAX];\n\n\t \n\tbool\t\t\t\tmsi_enabled;  \n\n\t \n\tstruct amdgpu_ih_ring\t\tih, ih1, ih2, ih_soft;\n\tconst struct amdgpu_ih_funcs    *ih_funcs;\n\tstruct work_struct\t\tih1_work, ih2_work, ih_soft_work;\n\tstruct amdgpu_irq_src\t\tself_irq;\n\n\t \n\tstruct irq_domain\t\t*domain;  \n\tunsigned\t\t\tvirq[AMDGPU_MAX_IRQ_SRC_ID];\n\tuint32_t                        srbm_soft_reset;\n\tu32                             retry_cam_doorbell_index;\n\tbool                            retry_cam_enabled;\n};\n\nenum interrupt_node_id_per_aid {\n\tAID0_NODEID = 0,\n\tXCD0_NODEID = 1,\n\tXCD1_NODEID = 2,\n\tAID1_NODEID = 4,\n\tXCD2_NODEID = 5,\n\tXCD3_NODEID = 6,\n\tAID2_NODEID = 8,\n\tXCD4_NODEID = 9,\n\tXCD5_NODEID = 10,\n\tAID3_NODEID = 12,\n\tXCD6_NODEID = 13,\n\tXCD7_NODEID = 14,\n\tNODEID_MAX,\n};\n\nextern const int node_id_to_phys_map[NODEID_MAX];\n\nvoid amdgpu_irq_disable_all(struct amdgpu_device *adev);\n\nint amdgpu_irq_init(struct amdgpu_device *adev);\nvoid amdgpu_irq_fini_sw(struct amdgpu_device *adev);\nvoid amdgpu_irq_fini_hw(struct amdgpu_device *adev);\nint amdgpu_irq_add_id(struct amdgpu_device *adev,\n\t\t      unsigned client_id, unsigned src_id,\n\t\t      struct amdgpu_irq_src *source);\nvoid amdgpu_irq_dispatch(struct amdgpu_device *adev,\n\t\t\t struct amdgpu_ih_ring *ih);\nvoid amdgpu_irq_delegate(struct amdgpu_device *adev,\n\t\t\t struct amdgpu_iv_entry *entry,\n\t\t\t unsigned int num_dw);\nint amdgpu_irq_update(struct amdgpu_device *adev, struct amdgpu_irq_src *src,\n\t\t      unsigned type);\nint amdgpu_irq_get(struct amdgpu_device *adev, struct amdgpu_irq_src *src,\n\t\t   unsigned type);\nint amdgpu_irq_put(struct amdgpu_device *adev, struct amdgpu_irq_src *src,\n\t\t   unsigned type);\nbool amdgpu_irq_enabled(struct amdgpu_device *adev, struct amdgpu_irq_src *src,\n\t\t\tunsigned type);\nvoid amdgpu_irq_gpu_reset_resume_helper(struct amdgpu_device *adev);\n\nint amdgpu_irq_add_domain(struct amdgpu_device *adev);\nvoid amdgpu_irq_remove_domain(struct amdgpu_device *adev);\nunsigned amdgpu_irq_create_mapping(struct amdgpu_device *adev, unsigned src_id);\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}