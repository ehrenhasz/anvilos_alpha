{
  "module_name": "amdgpu_ih.h",
  "hash_id": "9f6ea7d9ac906c0adff65d2ccccf90933ff96f49dd1cd6abddd02e5ec4a8f82e",
  "original_prompt": "Ingested from linux-6.6.14/drivers/gpu/drm/amd/amdgpu/amdgpu_ih.h",
  "human_readable_source": " \n\n#ifndef __AMDGPU_IH_H__\n#define __AMDGPU_IH_H__\n\n \n#define AMDGPU_IH_MAX_NUM_IVS\t32\n\n#define IH_RING_SIZE\t(256 * 1024)\n#define IH_SW_RING_SIZE\t(16 * 1024)\t \n\nstruct amdgpu_device;\nstruct amdgpu_iv_entry;\n\nstruct amdgpu_ih_regs {\n\tuint32_t ih_rb_base;\n\tuint32_t ih_rb_base_hi;\n\tuint32_t ih_rb_cntl;\n\tuint32_t ih_rb_wptr;\n\tuint32_t ih_rb_rptr;\n\tuint32_t ih_doorbell_rptr;\n\tuint32_t ih_rb_wptr_addr_lo;\n\tuint32_t ih_rb_wptr_addr_hi;\n\tuint32_t psp_reg_id;\n};\n\n \nstruct amdgpu_ih_ring {\n\tunsigned\t\tring_size;\n\tuint32_t\t\tptr_mask;\n\tu32\t\t\tdoorbell_index;\n\tbool\t\t\tuse_doorbell;\n\tbool\t\t\tuse_bus_addr;\n\n\tstruct amdgpu_bo\t*ring_obj;\n\tvolatile uint32_t\t*ring;\n\tuint64_t\t\tgpu_addr;\n\n\tuint64_t\t\twptr_addr;\n\tvolatile uint32_t\t*wptr_cpu;\n\n\tuint64_t\t\trptr_addr;\n\tvolatile uint32_t\t*rptr_cpu;\n\n\tbool                    enabled;\n\tunsigned\t\trptr;\n\tstruct amdgpu_ih_regs\tih_regs;\n\n\t \n\twait_queue_head_t wait_process;\n\tuint64_t\t\tprocessed_timestamp;\n};\n\n \n#define amdgpu_ih_ts_after(t1, t2) \\\n\t\t(((int64_t)((t2) << 16) - (int64_t)((t1) << 16)) > 0LL)\n\n \nstruct amdgpu_ih_funcs {\n\t \n\tu32 (*get_wptr)(struct amdgpu_device *adev, struct amdgpu_ih_ring *ih);\n\tvoid (*decode_iv)(struct amdgpu_device *adev, struct amdgpu_ih_ring *ih,\n\t\t\t  struct amdgpu_iv_entry *entry);\n\tuint64_t (*decode_iv_ts)(struct amdgpu_ih_ring *ih, u32 rptr,\n\t\t\t\t signed int offset);\n\tvoid (*set_rptr)(struct amdgpu_device *adev, struct amdgpu_ih_ring *ih);\n};\n\n#define amdgpu_ih_get_wptr(adev, ih) (adev)->irq.ih_funcs->get_wptr((adev), (ih))\n#define amdgpu_ih_decode_iv(adev, iv) \\\n\t(adev)->irq.ih_funcs->decode_iv((adev), (ih), (iv))\n#define amdgpu_ih_decode_iv_ts(adev, ih, rptr, offset) \\\n\t(WARN_ON_ONCE(!(adev)->irq.ih_funcs->decode_iv_ts) ? 0 : \\\n\t(adev)->irq.ih_funcs->decode_iv_ts((ih), (rptr), (offset)))\n#define amdgpu_ih_set_rptr(adev, ih) (adev)->irq.ih_funcs->set_rptr((adev), (ih))\n\nint amdgpu_ih_ring_init(struct amdgpu_device *adev, struct amdgpu_ih_ring *ih,\n\t\t\tunsigned ring_size, bool use_bus_addr);\nvoid amdgpu_ih_ring_fini(struct amdgpu_device *adev, struct amdgpu_ih_ring *ih);\nvoid amdgpu_ih_ring_write(struct amdgpu_device *adev, struct amdgpu_ih_ring *ih,\n\t\t\t  const uint32_t *iv, unsigned int num_dw);\nint amdgpu_ih_wait_on_checkpoint_process_ts(struct amdgpu_device *adev,\n\t\t\t\t\t    struct amdgpu_ih_ring *ih);\nint amdgpu_ih_process(struct amdgpu_device *adev, struct amdgpu_ih_ring *ih);\nvoid amdgpu_ih_decode_iv_helper(struct amdgpu_device *adev,\n\t\t\t\tstruct amdgpu_ih_ring *ih,\n\t\t\t\tstruct amdgpu_iv_entry *entry);\nuint64_t amdgpu_ih_decode_iv_ts_helper(struct amdgpu_ih_ring *ih, u32 rptr,\n\t\t\t\t       signed int offset);\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}