{
  "module_name": "amdgpu_vf_error.c",
  "hash_id": "654bb325e4ac2965666653c5d18985466300ae03fc3d1293e497af1b4ca9f726",
  "original_prompt": "Ingested from linux-6.6.14/drivers/gpu/drm/amd/amdgpu/amdgpu_vf_error.c",
  "human_readable_source": " \n\n#include \"amdgpu.h\"\n#include \"amdgpu_vf_error.h\"\n#include \"mxgpu_ai.h\"\n\nvoid amdgpu_vf_error_put(struct amdgpu_device *adev,\n\t\t\t uint16_t sub_error_code,\n\t\t\t uint16_t error_flags,\n\t\t\t uint64_t error_data)\n{\n\tint index;\n\tuint16_t error_code;\n\n\tif (!amdgpu_sriov_vf(adev))\n\t\treturn;\n\n\terror_code = AMDGIM_ERROR_CODE(AMDGIM_ERROR_CATEGORY_VF, sub_error_code);\n\n\tmutex_lock(&adev->virt.vf_errors.lock);\n\tindex = adev->virt.vf_errors.write_count % AMDGPU_VF_ERROR_ENTRY_SIZE;\n\tadev->virt.vf_errors.code [index] = error_code;\n\tadev->virt.vf_errors.flags [index] = error_flags;\n\tadev->virt.vf_errors.data [index] = error_data;\n\tadev->virt.vf_errors.write_count ++;\n\tmutex_unlock(&adev->virt.vf_errors.lock);\n}\n\n\nvoid amdgpu_vf_error_trans_all(struct amdgpu_device *adev)\n{\n\t \n\tu32 data1, data2, data3;\n\tint index;\n\n\tif ((NULL == adev) || (!amdgpu_sriov_vf(adev)) ||\n\t    (!adev->virt.ops) || (!adev->virt.ops->trans_msg)) {\n\t\treturn;\n\t}\n \n\n\tmutex_lock(&adev->virt.vf_errors.lock);\n\t \n\tif (adev->virt.vf_errors.write_count - adev->virt.vf_errors.read_count > AMDGPU_VF_ERROR_ENTRY_SIZE) {\n\t\tadev->virt.vf_errors.read_count = adev->virt.vf_errors.write_count - AMDGPU_VF_ERROR_ENTRY_SIZE;\n\t}\n\n\twhile (adev->virt.vf_errors.read_count < adev->virt.vf_errors.write_count) {\n\t\tindex =adev->virt.vf_errors.read_count % AMDGPU_VF_ERROR_ENTRY_SIZE;\n\t\tdata1 = AMDGIM_ERROR_CODE_FLAGS_TO_MAILBOX(adev->virt.vf_errors.code[index],\n\t\t\t\t\t\t\t   adev->virt.vf_errors.flags[index]);\n\t\tdata2 = adev->virt.vf_errors.data[index] & 0xFFFFFFFF;\n\t\tdata3 = (adev->virt.vf_errors.data[index] >> 32) & 0xFFFFFFFF;\n\n\t\tadev->virt.ops->trans_msg(adev, IDH_LOG_VF_ERROR, data1, data2, data3);\n\t\tadev->virt.vf_errors.read_count ++;\n\t}\n\tmutex_unlock(&adev->virt.vf_errors.lock);\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}