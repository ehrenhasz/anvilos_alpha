{
  "module_name": "athub_v3_0.c",
  "hash_id": "8ab1baa447c8d935678c4d648e0e156a9b6fbb85f92c5c17401e5ed056b410c1",
  "original_prompt": "Ingested from linux-6.6.14/drivers/gpu/drm/amd/amdgpu/athub_v3_0.c",
  "human_readable_source": " \n\n#include \"amdgpu.h\"\n#include \"athub_v3_0.h\"\n#include \"athub/athub_3_0_0_offset.h\"\n#include \"athub/athub_3_0_0_sh_mask.h\"\n#include \"navi10_enum.h\"\n#include \"soc15_common.h\"\n\n#define regATHUB_MISC_CNTL_V3_0_1\t\t\t0x00d7\n#define regATHUB_MISC_CNTL_V3_0_1_BASE_IDX\t\t0\n\n\nstatic uint32_t athub_v3_0_get_cg_cntl(struct amdgpu_device *adev)\n{\n\tuint32_t data;\n\n\tswitch (adev->ip_versions[ATHUB_HWIP][0]) {\n\tcase IP_VERSION(3, 0, 1):\n\t\tdata = RREG32_SOC15(ATHUB, 0, regATHUB_MISC_CNTL_V3_0_1);\n\t\tbreak;\n\tdefault:\n\t\tdata = RREG32_SOC15(ATHUB, 0, regATHUB_MISC_CNTL);\n\t\tbreak;\n\t}\n\treturn data;\n}\n\nstatic void athub_v3_0_set_cg_cntl(struct amdgpu_device *adev, uint32_t data)\n{\n\tswitch (adev->ip_versions[ATHUB_HWIP][0]) {\n\tcase IP_VERSION(3, 0, 1):\n\t\tWREG32_SOC15(ATHUB, 0, regATHUB_MISC_CNTL_V3_0_1, data);\n\t\tbreak;\n\tdefault:\n\t\tWREG32_SOC15(ATHUB, 0, regATHUB_MISC_CNTL, data);\n\t\tbreak;\n\t}\n}\n\nstatic void\nathub_v3_0_update_medium_grain_clock_gating(struct amdgpu_device *adev,\n\t\t\t\t\t    bool enable)\n{\n\tuint32_t def, data;\n\n\tdef = data = athub_v3_0_get_cg_cntl(adev);\n\n\tif (enable && (adev->cg_flags & AMD_CG_SUPPORT_ATHUB_MGCG))\n\t\tdata |= ATHUB_MISC_CNTL__CG_ENABLE_MASK;\n\telse\n\t\tdata &= ~ATHUB_MISC_CNTL__CG_ENABLE_MASK;\n\n\tif (def != data)\n\t\tathub_v3_0_set_cg_cntl(adev, data);\n}\n\nstatic void\nathub_v3_0_update_medium_grain_light_sleep(struct amdgpu_device *adev,\n\t\t\t\t\t   bool enable)\n{\n\tuint32_t def, data;\n\n\tdef = data = athub_v3_0_get_cg_cntl(adev);\n\n\tif (enable && (adev->cg_flags & AMD_CG_SUPPORT_ATHUB_LS))\n\t\tdata |= ATHUB_MISC_CNTL__CG_MEM_LS_ENABLE_MASK;\n\telse\n\t\tdata &= ~ATHUB_MISC_CNTL__CG_MEM_LS_ENABLE_MASK;\n\n\tif (def != data)\n\t\tathub_v3_0_set_cg_cntl(adev, data);\n}\n\nint athub_v3_0_set_clockgating(struct amdgpu_device *adev,\n\t\t\t       enum amd_clockgating_state state)\n{\n\tif (amdgpu_sriov_vf(adev))\n\t\treturn 0;\n\n\tswitch (adev->ip_versions[ATHUB_HWIP][0]) {\n\tcase IP_VERSION(3, 0, 0):\n\tcase IP_VERSION(3, 0, 1):\n\tcase IP_VERSION(3, 0, 2):\n\t\tathub_v3_0_update_medium_grain_clock_gating(adev,\n\t\t\t\tstate == AMD_CG_STATE_GATE);\n\t\tathub_v3_0_update_medium_grain_light_sleep(adev,\n\t\t\t\tstate == AMD_CG_STATE_GATE);\n\t\tbreak;\n\tdefault:\n\t\tbreak;\n\t}\n\n\treturn 0;\n}\n\nvoid athub_v3_0_get_clockgating(struct amdgpu_device *adev, u64 *flags)\n{\n\tint data;\n\n\t \n\tdata = athub_v3_0_get_cg_cntl(adev);\n\tif (data & ATHUB_MISC_CNTL__CG_ENABLE_MASK)\n\t\t*flags |= AMD_CG_SUPPORT_ATHUB_MGCG;\n\n\t \n\tif (data & ATHUB_MISC_CNTL__CG_MEM_LS_ENABLE_MASK)\n\t\t*flags |= AMD_CG_SUPPORT_ATHUB_LS;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}