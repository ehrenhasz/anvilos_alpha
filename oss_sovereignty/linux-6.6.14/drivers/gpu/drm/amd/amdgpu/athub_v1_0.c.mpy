{
  "module_name": "athub_v1_0.c",
  "hash_id": "54bad399737e310d1bc92e2fa9f3d2edae7f35d14cbac6462c21d136ff7c6a37",
  "original_prompt": "Ingested from linux-6.6.14/drivers/gpu/drm/amd/amdgpu/athub_v1_0.c",
  "human_readable_source": " \n#include \"amdgpu.h\"\n#include \"athub_v1_0.h\"\n\n#include \"athub/athub_1_0_offset.h\"\n#include \"athub/athub_1_0_sh_mask.h\"\n#include \"vega10_enum.h\"\n\n#include \"soc15_common.h\"\n\nstatic void athub_update_medium_grain_clock_gating(struct amdgpu_device *adev,\n\t\t\t\t\t\t   bool enable)\n{\n\tuint32_t def, data;\n\n\tdef = data = RREG32_SOC15(ATHUB, 0, mmATHUB_MISC_CNTL);\n\n\tif (enable && (adev->cg_flags & AMD_CG_SUPPORT_MC_MGCG))\n\t\tdata |= ATHUB_MISC_CNTL__CG_ENABLE_MASK;\n\telse\n\t\tdata &= ~ATHUB_MISC_CNTL__CG_ENABLE_MASK;\n\n\tif (def != data)\n\t\tWREG32_SOC15(ATHUB, 0, mmATHUB_MISC_CNTL, data);\n}\n\nstatic void athub_update_medium_grain_light_sleep(struct amdgpu_device *adev,\n\t\t\t\t\t\t  bool enable)\n{\n\tuint32_t def, data;\n\n\tdef = data = RREG32_SOC15(ATHUB, 0, mmATHUB_MISC_CNTL);\n\n\tif (enable && (adev->cg_flags & AMD_CG_SUPPORT_MC_LS) &&\n\t    (adev->cg_flags & AMD_CG_SUPPORT_HDP_LS))\n\t\tdata |= ATHUB_MISC_CNTL__CG_MEM_LS_ENABLE_MASK;\n\telse\n\t\tdata &= ~ATHUB_MISC_CNTL__CG_MEM_LS_ENABLE_MASK;\n\n\tif(def != data)\n\t\tWREG32_SOC15(ATHUB, 0, mmATHUB_MISC_CNTL, data);\n}\n\nint athub_v1_0_set_clockgating(struct amdgpu_device *adev,\n\t\t\t       enum amd_clockgating_state state)\n{\n\tif (amdgpu_sriov_vf(adev))\n\t\treturn 0;\n\n\tswitch (adev->ip_versions[ATHUB_HWIP][0]) {\n\tcase IP_VERSION(9, 0, 0):\n\tcase IP_VERSION(9, 1, 0):\n\tcase IP_VERSION(9, 2, 0):\n\tcase IP_VERSION(9, 3, 0):\n\tcase IP_VERSION(9, 4, 0):\n\tcase IP_VERSION(1, 5, 0):\n\t\tathub_update_medium_grain_clock_gating(adev,\n\t\t\t\tstate == AMD_CG_STATE_GATE);\n\t\tathub_update_medium_grain_light_sleep(adev,\n\t\t\t\tstate == AMD_CG_STATE_GATE);\n\t\tbreak;\n\tdefault:\n\t\tbreak;\n\t}\n\n\treturn 0;\n}\n\nvoid athub_v1_0_get_clockgating(struct amdgpu_device *adev, u64 *flags)\n{\n\tint data;\n\n\tif (amdgpu_sriov_vf(adev))\n\t\t*flags = 0;\n\n\t \n\tdata = RREG32_SOC15(ATHUB, 0, mmATHUB_MISC_CNTL);\n\tif (data & ATHUB_MISC_CNTL__CG_ENABLE_MASK)\n\t\t*flags |= AMD_CG_SUPPORT_ATHUB_MGCG;\n\n\t \n\tif (data & ATHUB_MISC_CNTL__CG_MEM_LS_ENABLE_MASK)\n\t\t*flags |= AMD_CG_SUPPORT_ATHUB_LS;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}