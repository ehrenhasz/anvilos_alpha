{
  "module_name": "kfd_mqd_manager.h",
  "hash_id": "a9b4b1580e87c6f7a0da300e2fa68d065c976754508eb8abbcbeb85dc2bbd862",
  "original_prompt": "Ingested from linux-6.6.14/drivers/gpu/drm/amd/amdkfd/kfd_mqd_manager.h",
  "human_readable_source": " \n \n\n#ifndef KFD_MQD_MANAGER_H_\n#define KFD_MQD_MANAGER_H_\n\n#include \"kfd_priv.h\"\n\n#define KFD_MAX_NUM_SE 8\n#define KFD_MAX_NUM_SH_PER_SE 2\n\n \nextern int pipe_priority_map[];\nstruct mqd_manager {\n\tstruct kfd_mem_obj*\t(*allocate_mqd)(struct kfd_node *kfd,\n\t\tstruct queue_properties *q);\n\n\tvoid\t(*init_mqd)(struct mqd_manager *mm, void **mqd,\n\t\t\tstruct kfd_mem_obj *mqd_mem_obj, uint64_t *gart_addr,\n\t\t\tstruct queue_properties *q);\n\n\tint\t(*load_mqd)(struct mqd_manager *mm, void *mqd,\n\t\t\t\tuint32_t pipe_id, uint32_t queue_id,\n\t\t\t\tstruct queue_properties *p,\n\t\t\t\tstruct mm_struct *mms);\n\n\tvoid\t(*update_mqd)(struct mqd_manager *mm, void *mqd,\n\t\t\t\tstruct queue_properties *q,\n\t\t\t\tstruct mqd_update_info *minfo);\n\n\tint\t(*destroy_mqd)(struct mqd_manager *mm, void *mqd,\n\t\t\t\tenum kfd_preempt_type type,\n\t\t\t\tunsigned int timeout, uint32_t pipe_id,\n\t\t\t\tuint32_t queue_id);\n\n\tvoid\t(*free_mqd)(struct mqd_manager *mm, void *mqd,\n\t\t\t\tstruct kfd_mem_obj *mqd_mem_obj);\n\n\tbool\t(*is_occupied)(struct mqd_manager *mm, void *mqd,\n\t\t\t\tuint64_t queue_address,\tuint32_t pipe_id,\n\t\t\t\tuint32_t queue_id);\n\n\tint\t(*get_wave_state)(struct mqd_manager *mm, void *mqd,\n\t\t\t\t  struct queue_properties *q,\n\t\t\t\t  void __user *ctl_stack,\n\t\t\t\t  u32 *ctl_stack_used_size,\n\t\t\t\t  u32 *save_area_used_size);\n\n\tvoid\t(*get_checkpoint_info)(struct mqd_manager *mm, void *mqd, uint32_t *ctl_stack_size);\n\n\tvoid\t(*checkpoint_mqd)(struct mqd_manager *mm,\n\t\t\t\t  void *mqd,\n\t\t\t\t  void *mqd_dst,\n\t\t\t\t  void *ctl_stack_dst);\n\n\tvoid\t(*restore_mqd)(struct mqd_manager *mm, void **mqd,\n\t\t\t\tstruct kfd_mem_obj *mqd_mem_obj, uint64_t *gart_addr,\n\t\t\t\tstruct queue_properties *p,\n\t\t\t\tconst void *mqd_src,\n\t\t\t\tconst void *ctl_stack_src,\n\t\t\t\tconst u32 ctl_stack_size);\n\n#if defined(CONFIG_DEBUG_FS)\n\tint\t(*debugfs_show_mqd)(struct seq_file *m, void *data);\n#endif\n\tuint32_t (*read_doorbell_id)(void *mqd);\n\tuint64_t (*mqd_stride)(struct mqd_manager *mm,\n\t\t\t\tstruct queue_properties *p);\n\n\tstruct mutex\tmqd_mutex;\n\tstruct kfd_node\t*dev;\n\tuint32_t mqd_size;\n};\n\nstruct kfd_mem_obj *allocate_hiq_mqd(struct kfd_node *dev,\n\t\t\t\tstruct queue_properties *q);\n\nstruct kfd_mem_obj *allocate_sdma_mqd(struct kfd_node *dev,\n\t\t\t\t\tstruct queue_properties *q);\nvoid free_mqd_hiq_sdma(struct mqd_manager *mm, void *mqd,\n\t\t\t\tstruct kfd_mem_obj *mqd_mem_obj);\n\nvoid mqd_symmetrically_map_cu_mask(struct mqd_manager *mm,\n\t\tconst uint32_t *cu_mask, uint32_t cu_mask_count,\n\t\tuint32_t *se_mask, uint32_t inst);\n\nint kfd_hiq_load_mqd_kiq(struct mqd_manager *mm, void *mqd,\n\t\tuint32_t pipe_id, uint32_t queue_id,\n\t\tstruct queue_properties *p, struct mm_struct *mms);\n\nint kfd_destroy_mqd_cp(struct mqd_manager *mm, void *mqd,\n\t\tenum kfd_preempt_type type, unsigned int timeout,\n\t\tuint32_t pipe_id, uint32_t queue_id);\n\nvoid kfd_free_mqd_cp(struct mqd_manager *mm, void *mqd,\n\t\tstruct kfd_mem_obj *mqd_mem_obj);\n\nbool kfd_is_occupied_cp(struct mqd_manager *mm, void *mqd,\n\t\t uint64_t queue_address, uint32_t pipe_id,\n\t\t uint32_t queue_id);\n\nint kfd_load_mqd_sdma(struct mqd_manager *mm, void *mqd,\n\t\tuint32_t pipe_id, uint32_t queue_id,\n\t\tstruct queue_properties *p, struct mm_struct *mms);\n\nint kfd_destroy_mqd_sdma(struct mqd_manager *mm, void *mqd,\n\t\tenum kfd_preempt_type type, unsigned int timeout,\n\t\tuint32_t pipe_id, uint32_t queue_id);\n\nbool kfd_is_occupied_sdma(struct mqd_manager *mm, void *mqd,\n\t\tuint64_t queue_address, uint32_t pipe_id,\n\t\tuint32_t queue_id);\n\nvoid kfd_get_hiq_xcc_mqd(struct kfd_node *dev,\n\t\tstruct kfd_mem_obj *mqd_mem_obj, uint32_t virtual_xcc_id);\n\nuint64_t kfd_hiq_mqd_stride(struct kfd_node *dev);\nuint64_t kfd_mqd_stride(struct mqd_manager *mm,\n\t\t\tstruct queue_properties *q);\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}