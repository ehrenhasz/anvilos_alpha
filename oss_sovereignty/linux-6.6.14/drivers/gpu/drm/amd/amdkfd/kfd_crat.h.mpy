{
  "module_name": "kfd_crat.h",
  "hash_id": "98194abf11b5f84aa1194695b4c06194751223166cc2f1ab281e32982bcf58cd",
  "original_prompt": "Ingested from linux-6.6.14/drivers/gpu/drm/amd/amdkfd/kfd_crat.h",
  "human_readable_source": " \n \n\n#ifndef KFD_CRAT_H_INCLUDED\n#define KFD_CRAT_H_INCLUDED\n\n#include <linux/types.h>\n\n#pragma pack(1)\n\n \n\n#define CRAT_SIGNATURE\t\"CRAT\"\n\n \n\n#define CRAT_OEMID_LENGTH\t6\n#define CRAT_OEMTABLEID_LENGTH\t8\n#define CRAT_RESERVED_LENGTH\t6\n\n#define CRAT_OEMID_64BIT_MASK ((1ULL << (CRAT_OEMID_LENGTH * 8)) - 1)\n\n \n#define COMPUTE_UNIT_CPU\t(1 << 0)   \n#define COMPUTE_UNIT_GPU\t(1 << 1)   \n\nstruct crat_header {\n\tuint32_t\tsignature;\n\tuint32_t\tlength;\n\tuint8_t\t\trevision;\n\tuint8_t\t\tchecksum;\n\tuint8_t\t\toem_id[CRAT_OEMID_LENGTH];\n\tuint8_t\t\toem_table_id[CRAT_OEMTABLEID_LENGTH];\n\tuint32_t\toem_revision;\n\tuint32_t\tcreator_id;\n\tuint32_t\tcreator_revision;\n\tuint32_t\ttotal_entries;\n\tuint16_t\tnum_domains;\n\tuint8_t\t\treserved[CRAT_RESERVED_LENGTH];\n};\n\n \n\n \n#define CRAT_SUBTYPE_COMPUTEUNIT_AFFINITY\t0\n#define CRAT_SUBTYPE_MEMORY_AFFINITY\t\t1\n#define CRAT_SUBTYPE_CACHE_AFFINITY\t\t2\n#define CRAT_SUBTYPE_TLB_AFFINITY\t\t3\n#define CRAT_SUBTYPE_CCOMPUTE_AFFINITY\t\t4\n#define CRAT_SUBTYPE_IOLINK_AFFINITY\t\t5\n#define CRAT_SUBTYPE_MAX\t\t\t6\n\n \n#define CRAT_SIBLINGMAP_SIZE\t32\n\n \n#define CRAT_CU_FLAGS_ENABLED\t\t0x00000001\n#define CRAT_CU_FLAGS_HOT_PLUGGABLE\t0x00000002\n#define CRAT_CU_FLAGS_CPU_PRESENT\t0x00000004\n#define CRAT_CU_FLAGS_GPU_PRESENT\t0x00000008\n#define CRAT_CU_FLAGS_IOMMU_PRESENT\t0x00000010\n#define CRAT_CU_FLAGS_RESERVED\t\t0xffffffe0\n\n#define CRAT_COMPUTEUNIT_RESERVED_LENGTH 4\n\nstruct crat_subtype_computeunit {\n\tuint8_t\t\ttype;\n\tuint8_t\t\tlength;\n\tuint16_t\treserved;\n\tuint32_t\tflags;\n\tuint32_t\tproximity_domain;\n\tuint32_t\tprocessor_id_low;\n\tuint16_t\tnum_cpu_cores;\n\tuint16_t\tnum_simd_cores;\n\tuint16_t\tmax_waves_simd;\n\tuint16_t\tio_count;\n\tuint16_t\thsa_capability;\n\tuint16_t\tlds_size_in_kb;\n\tuint8_t\t\twave_front_size;\n\tuint8_t\t\tnum_banks;\n\tuint16_t\tmicro_engine_id;\n\tuint8_t\t\tarray_count;\n\tuint8_t\t\tnum_cu_per_array;\n\tuint8_t\t\tnum_simd_per_cu;\n\tuint8_t\t\tmax_slots_scatch_cu;\n\tuint8_t\t\treserved2[CRAT_COMPUTEUNIT_RESERVED_LENGTH];\n};\n\n \n#define CRAT_MEM_FLAGS_ENABLED\t\t0x00000001\n#define CRAT_MEM_FLAGS_HOT_PLUGGABLE\t0x00000002\n#define CRAT_MEM_FLAGS_NON_VOLATILE\t0x00000004\n#define CRAT_MEM_FLAGS_RESERVED\t\t0xfffffff8\n\n#define CRAT_MEMORY_RESERVED_LENGTH 8\n\nstruct crat_subtype_memory {\n\tuint8_t\t\ttype;\n\tuint8_t\t\tlength;\n\tuint16_t\treserved;\n\tuint32_t\tflags;\n\tuint32_t\tproximity_domain;\n\tuint32_t\tbase_addr_low;\n\tuint32_t\tbase_addr_high;\n\tuint32_t\tlength_low;\n\tuint32_t\tlength_high;\n\tuint32_t\twidth;\n\tuint8_t\t\tvisibility_type;  \n\tuint8_t\t\treserved2[CRAT_MEMORY_RESERVED_LENGTH - 1];\n};\n\n \n#define CRAT_CACHE_FLAGS_ENABLED\t0x00000001\n#define CRAT_CACHE_FLAGS_DATA_CACHE\t0x00000002\n#define CRAT_CACHE_FLAGS_INST_CACHE\t0x00000004\n#define CRAT_CACHE_FLAGS_CPU_CACHE\t0x00000008\n#define CRAT_CACHE_FLAGS_SIMD_CACHE\t0x00000010\n#define CRAT_CACHE_FLAGS_RESERVED\t0xffffffe0\n\n#define CRAT_CACHE_RESERVED_LENGTH 8\n\nstruct crat_subtype_cache {\n\tuint8_t\t\ttype;\n\tuint8_t\t\tlength;\n\tuint16_t\treserved;\n\tuint32_t\tflags;\n\tuint32_t\tprocessor_id_low;\n\tuint8_t\t\tsibling_map[CRAT_SIBLINGMAP_SIZE];\n\tuint32_t\tcache_size;\n\tuint8_t\t\tcache_level;\n\tuint8_t\t\tlines_per_tag;\n\tuint16_t\tcache_line_size;\n\tuint8_t\t\tassociativity;\n\tuint8_t\t\tcache_properties;\n\tuint16_t\tcache_latency;\n\tuint8_t\t\treserved2[CRAT_CACHE_RESERVED_LENGTH];\n};\n\n \n#define CRAT_TLB_FLAGS_ENABLED\t0x00000001\n#define CRAT_TLB_FLAGS_DATA_TLB\t0x00000002\n#define CRAT_TLB_FLAGS_INST_TLB\t0x00000004\n#define CRAT_TLB_FLAGS_CPU_TLB\t0x00000008\n#define CRAT_TLB_FLAGS_SIMD_TLB\t0x00000010\n#define CRAT_TLB_FLAGS_RESERVED\t0xffffffe0\n\n#define CRAT_TLB_RESERVED_LENGTH 4\n\nstruct crat_subtype_tlb {\n\tuint8_t\t\ttype;\n\tuint8_t\t\tlength;\n\tuint16_t\treserved;\n\tuint32_t\tflags;\n\tuint32_t\tprocessor_id_low;\n\tuint8_t\t\tsibling_map[CRAT_SIBLINGMAP_SIZE];\n\tuint32_t\ttlb_level;\n\tuint8_t\t\tdata_tlb_associativity_2mb;\n\tuint8_t\t\tdata_tlb_size_2mb;\n\tuint8_t\t\tinstruction_tlb_associativity_2mb;\n\tuint8_t\t\tinstruction_tlb_size_2mb;\n\tuint8_t\t\tdata_tlb_associativity_4k;\n\tuint8_t\t\tdata_tlb_size_4k;\n\tuint8_t\t\tinstruction_tlb_associativity_4k;\n\tuint8_t\t\tinstruction_tlb_size_4k;\n\tuint8_t\t\tdata_tlb_associativity_1gb;\n\tuint8_t\t\tdata_tlb_size_1gb;\n\tuint8_t\t\tinstruction_tlb_associativity_1gb;\n\tuint8_t\t\tinstruction_tlb_size_1gb;\n\tuint8_t\t\treserved2[CRAT_TLB_RESERVED_LENGTH];\n};\n\n \n#define CRAT_CCOMPUTE_FLAGS_ENABLED\t0x00000001\n#define CRAT_CCOMPUTE_FLAGS_RESERVED\t0xfffffffe\n\n#define CRAT_CCOMPUTE_RESERVED_LENGTH 16\n\nstruct crat_subtype_ccompute {\n\tuint8_t\t\ttype;\n\tuint8_t\t\tlength;\n\tuint16_t\treserved;\n\tuint32_t\tflags;\n\tuint32_t\tprocessor_id_low;\n\tuint8_t\t\tsibling_map[CRAT_SIBLINGMAP_SIZE];\n\tuint32_t\tapu_size;\n\tuint8_t\t\treserved2[CRAT_CCOMPUTE_RESERVED_LENGTH];\n};\n\n \n#define CRAT_IOLINK_FLAGS_ENABLED\t\t(1 << 0)\n#define CRAT_IOLINK_FLAGS_NON_COHERENT\t\t(1 << 1)\n#define CRAT_IOLINK_FLAGS_NO_ATOMICS_32_BIT\t(1 << 2)\n#define CRAT_IOLINK_FLAGS_NO_ATOMICS_64_BIT\t(1 << 3)\n#define CRAT_IOLINK_FLAGS_NO_PEER_TO_PEER_DMA\t(1 << 4)\n#define CRAT_IOLINK_FLAGS_BI_DIRECTIONAL\t(1 << 31)\n#define CRAT_IOLINK_FLAGS_RESERVED_MASK\t\t0x7fffffe0\n\n \n#define CRAT_IOLINK_TYPE_UNDEFINED\t0\n#define CRAT_IOLINK_TYPE_HYPERTRANSPORT\t1\n#define CRAT_IOLINK_TYPE_PCIEXPRESS\t2\n#define CRAT_IOLINK_TYPE_AMBA\t\t3\n#define CRAT_IOLINK_TYPE_MIPI\t\t4\n#define CRAT_IOLINK_TYPE_QPI_1_1\t5\n#define CRAT_IOLINK_TYPE_RESERVED1\t6\n#define CRAT_IOLINK_TYPE_RESERVED2\t7\n#define CRAT_IOLINK_TYPE_RAPID_IO\t8\n#define CRAT_IOLINK_TYPE_INFINIBAND\t9\n#define CRAT_IOLINK_TYPE_RESERVED3\t10\n#define CRAT_IOLINK_TYPE_XGMI\t\t11\n#define CRAT_IOLINK_TYPE_XGOP\t\t12\n#define CRAT_IOLINK_TYPE_GZ\t\t13\n#define CRAT_IOLINK_TYPE_ETHERNET_RDMA\t14\n#define CRAT_IOLINK_TYPE_RDMA_OTHER\t15\n#define CRAT_IOLINK_TYPE_OTHER\t\t16\n#define CRAT_IOLINK_TYPE_MAX\t\t255\n\n#define CRAT_IOLINK_RESERVED_LENGTH\t24\n\nstruct crat_subtype_iolink {\n\tuint8_t\t\ttype;\n\tuint8_t\t\tlength;\n\tuint16_t\treserved;\n\tuint32_t\tflags;\n\tuint32_t\tproximity_domain_from;\n\tuint32_t\tproximity_domain_to;\n\tuint8_t\t\tio_interface_type;\n\tuint8_t\t\tversion_major;\n\tuint16_t\tversion_minor;\n\tuint32_t\tminimum_latency;\n\tuint32_t\tmaximum_latency;\n\tuint32_t\tminimum_bandwidth_mbs;\n\tuint32_t\tmaximum_bandwidth_mbs;\n\tuint32_t\trecommended_transfer_size;\n\tuint8_t\t\treserved2[CRAT_IOLINK_RESERVED_LENGTH - 1];\n\tuint8_t\t\tweight_xgmi;\n};\n\n \n\n#define CRAT_SUBTYPE_FLAGS_ENABLED 0x00000001\n\nstruct crat_subtype_generic {\n\tuint8_t\t\ttype;\n\tuint8_t\t\tlength;\n\tuint16_t\treserved;\n\tuint32_t\tflags;\n};\n\n#pragma pack()\n\nstruct kfd_node;\n\n \nstruct kfd_gpu_cache_info {\n\tuint32_t\tcache_size;\n\tuint32_t\tcache_level;\n\tuint32_t\tflags;\n\t \n\tuint32_t\tnum_cu_shared;\n};\nint kfd_get_gpu_cache_info(struct kfd_node *kdev, struct kfd_gpu_cache_info **pcache_info);\n\nvoid kfd_destroy_crat_image(void *crat_image);\nint kfd_parse_crat_table(void *crat_image, struct list_head *device_list,\n\t\t\t uint32_t proximity_domain);\nint kfd_create_crat_image_virtual(void **crat_image, size_t *size,\n\t\t\t\t  int flags, struct kfd_node *kdev,\n\t\t\t\t  uint32_t proximity_domain);\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}