{
  "module_name": "link_hwss_dpia.c",
  "hash_id": "86f8396dabb81b479107e20a49ad2e20403ac2e1f90f9487ff8457705e0166d5",
  "original_prompt": "Ingested from linux-6.6.14/drivers/gpu/drm/amd/display/dc/link/hwss/link_hwss_dpia.c",
  "human_readable_source": " \n#include \"link_hwss_dpia.h\"\n#include \"core_types.h\"\n#include \"link_hwss_dio.h\"\n#include \"link_enc_cfg.h\"\n\n#define DC_LOGGER_INIT(logger)\n\nstatic void update_dpia_stream_allocation_table(struct dc_link *link,\n\t\tconst struct link_resource *link_res,\n\t\tconst struct link_mst_stream_allocation_table *table)\n{\n\tstruct link_encoder *link_enc = link_enc_cfg_get_link_enc(link);\n\tstatic enum dc_status status;\n\tuint8_t mst_alloc_slots = 0, prev_mst_slots_in_use = 0xFF;\n\tint i;\n\tDC_LOGGER_INIT(link->ctx->logger);\n\n\tfor (i = 0; i < table->stream_count; i++)\n\t\tmst_alloc_slots += table->stream_allocations[i].slot_count;\n\n\tstatus = dc_process_dmub_set_mst_slots(link->dc, link->link_index,\n\t\t\tmst_alloc_slots, &prev_mst_slots_in_use);\n\tASSERT(status == DC_OK);\n\tDC_LOG_MST(\"dpia : status[%d]: alloc_slots[%d]: used_slots[%d]\\n\",\n\t\t\tstatus, mst_alloc_slots, prev_mst_slots_in_use);\n\n\tASSERT(link_enc);\n\tlink_enc->funcs->update_mst_stream_allocation_table(link_enc, table);\n}\n\nstatic const struct link_hwss dpia_link_hwss = {\n\t.setup_stream_encoder = setup_dio_stream_encoder,\n\t.reset_stream_encoder = reset_dio_stream_encoder,\n\t.setup_stream_attribute = setup_dio_stream_attribute,\n\t.disable_link_output = disable_dio_link_output,\n\t.setup_audio_output = setup_dio_audio_output,\n\t.enable_audio_packet = enable_dio_audio_packet,\n\t.disable_audio_packet = disable_dio_audio_packet,\n\t.ext = {\n\t\t.set_throttled_vcp_size = set_dio_throttled_vcp_size,\n\t\t.enable_dp_link_output = enable_dio_dp_link_output,\n\t\t.set_dp_link_test_pattern = set_dio_dp_link_test_pattern,\n\t\t.set_dp_lane_settings = set_dio_dp_lane_settings,\n\t\t.update_stream_allocation_table = update_dpia_stream_allocation_table,\n\t},\n};\n\nbool can_use_dpia_link_hwss(const struct dc_link *link,\n\t\tconst struct link_resource *link_res)\n{\n\treturn link->is_dig_mapping_flexible &&\n\t\t\tlink->dc->res_pool->funcs->link_encs_assign;\n}\n\nconst struct link_hwss *get_dpia_link_hwss(void)\n{\n\treturn &dpia_link_hwss;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}