{
  "module_name": "hw_sequencer.h",
  "hash_id": "62319c0379f8e6aaf6888e785806b2a6aae53d8a05ef72a9e7eaf8dfd0c3daff",
  "original_prompt": "Ingested from linux-6.6.14/drivers/gpu/drm/amd/display/dc/inc/hw_sequencer.h",
  "human_readable_source": " \n\n#ifndef __DC_HW_SEQUENCER_H__\n#define __DC_HW_SEQUENCER_H__\n#include \"dc_types.h\"\n#include \"clock_source.h\"\n#include \"inc/hw/timing_generator.h\"\n#include \"inc/hw/opp.h\"\n#include \"inc/hw/link_encoder.h\"\n#include \"core_status.h\"\n\nstruct pipe_ctx;\nstruct dc_state;\nstruct dc_stream_status;\nstruct dc_writeback_info;\nstruct dchub_init_data;\nstruct dc_static_screen_params;\nstruct resource_pool;\nstruct dc_phy_addr_space_config;\nstruct dc_virtual_addr_space_config;\nstruct dpp;\nstruct dce_hwseq;\nstruct link_resource;\nstruct dc_dmub_cmd;\n\nstruct subvp_pipe_control_lock_fast_params {\n\tstruct dc *dc;\n\tbool lock;\n\tstruct pipe_ctx *pipe_ctx;\n};\n\nstruct pipe_control_lock_params {\n\tstruct dc *dc;\n\tstruct pipe_ctx *pipe_ctx;\n\tbool lock;\n};\n\nstruct set_flip_control_gsl_params {\n\tstruct pipe_ctx *pipe_ctx;\n\tbool flip_immediate;\n};\n\nstruct program_triplebuffer_params {\n\tconst struct dc *dc;\n\tstruct pipe_ctx *pipe_ctx;\n\tbool enableTripleBuffer;\n};\n\nstruct update_plane_addr_params {\n\tstruct dc *dc;\n\tstruct pipe_ctx *pipe_ctx;\n};\n\nstruct set_input_transfer_func_params {\n\tstruct dc *dc;\n\tstruct pipe_ctx *pipe_ctx;\n\tstruct dc_plane_state *plane_state;\n};\n\nstruct program_gamut_remap_params {\n\tstruct pipe_ctx *pipe_ctx;\n};\n\nstruct program_manual_trigger_params {\n\tstruct pipe_ctx *pipe_ctx;\n};\n\nstruct send_dmcub_cmd_params {\n\tstruct dc_context *ctx;\n\tunion dmub_rb_cmd *cmd;\n\tenum dm_dmub_wait_type wait_type;\n};\n\nstruct setup_dpp_params {\n\tstruct pipe_ctx *pipe_ctx;\n};\n\nstruct program_bias_and_scale_params {\n\tstruct pipe_ctx *pipe_ctx;\n};\n\nstruct set_output_transfer_func_params {\n\tstruct dc *dc;\n\tstruct pipe_ctx *pipe_ctx;\n\tconst struct dc_stream_state *stream;\n};\n\nstruct update_visual_confirm_params {\n\tstruct dc *dc;\n\tstruct pipe_ctx *pipe_ctx;\n\tint mpcc_id;\n};\n\nstruct power_on_mpc_mem_pwr_params {\n\tstruct mpc *mpc;\n\tint mpcc_id;\n\tbool power_on;\n};\n\nstruct set_output_csc_params {\n\tstruct mpc *mpc;\n\tint opp_id;\n\tconst uint16_t *regval;\n\tenum mpc_output_csc_mode ocsc_mode;\n};\n\nstruct set_ocsc_default_params {\n\tstruct mpc *mpc;\n\tint opp_id;\n\tenum dc_color_space color_space;\n\tenum mpc_output_csc_mode ocsc_mode;\n};\n\nunion block_sequence_params {\n\tstruct update_plane_addr_params update_plane_addr_params;\n\tstruct subvp_pipe_control_lock_fast_params subvp_pipe_control_lock_fast_params;\n\tstruct pipe_control_lock_params pipe_control_lock_params;\n\tstruct set_flip_control_gsl_params set_flip_control_gsl_params;\n\tstruct program_triplebuffer_params program_triplebuffer_params;\n\tstruct set_input_transfer_func_params set_input_transfer_func_params;\n\tstruct program_gamut_remap_params program_gamut_remap_params;\n\tstruct program_manual_trigger_params program_manual_trigger_params;\n\tstruct send_dmcub_cmd_params send_dmcub_cmd_params;\n\tstruct setup_dpp_params setup_dpp_params;\n\tstruct program_bias_and_scale_params program_bias_and_scale_params;\n\tstruct set_output_transfer_func_params set_output_transfer_func_params;\n\tstruct update_visual_confirm_params update_visual_confirm_params;\n\tstruct power_on_mpc_mem_pwr_params power_on_mpc_mem_pwr_params;\n\tstruct set_output_csc_params set_output_csc_params;\n\tstruct set_ocsc_default_params set_ocsc_default_params;\n};\n\nenum block_sequence_func {\n\tDMUB_SUBVP_PIPE_CONTROL_LOCK_FAST = 0,\n\tOPTC_PIPE_CONTROL_LOCK,\n\tHUBP_SET_FLIP_CONTROL_GSL,\n\tHUBP_PROGRAM_TRIPLEBUFFER,\n\tHUBP_UPDATE_PLANE_ADDR,\n\tDPP_SET_INPUT_TRANSFER_FUNC,\n\tDPP_PROGRAM_GAMUT_REMAP,\n\tOPTC_PROGRAM_MANUAL_TRIGGER,\n\tDMUB_SEND_DMCUB_CMD,\n\tDPP_SETUP_DPP,\n\tDPP_PROGRAM_BIAS_AND_SCALE,\n\tDPP_SET_OUTPUT_TRANSFER_FUNC,\n\tMPC_UPDATE_VISUAL_CONFIRM,\n\tMPC_POWER_ON_MPC_MEM_PWR,\n\tMPC_SET_OUTPUT_CSC,\n\tMPC_SET_OCSC_DEFAULT,\n};\n\nstruct block_sequence {\n\tunion block_sequence_params params;\n\tenum block_sequence_func func;\n};\n\nstruct hw_sequencer_funcs {\n\tvoid (*hardware_release)(struct dc *dc);\n\t \n\tvoid (*edp_power_control)(struct dc_link *link, bool enable);\n\tvoid (*edp_wait_for_hpd_ready)(struct dc_link *link, bool power_up);\n\tvoid (*edp_wait_for_T12)(struct dc_link *link);\n\n\t \n\tvoid (*init_hw)(struct dc *dc);\n\tvoid (*power_down_on_boot)(struct dc *dc);\n\tvoid (*enable_accelerated_mode)(struct dc *dc,\n\t\t\tstruct dc_state *context);\n\tenum dc_status (*apply_ctx_to_hw)(struct dc *dc,\n\t\t\tstruct dc_state *context);\n\tvoid (*disable_plane)(struct dc *dc, struct pipe_ctx *pipe_ctx);\n\tvoid (*disable_pixel_data)(struct dc *dc, struct pipe_ctx *pipe_ctx, bool blank);\n\tvoid (*apply_ctx_for_surface)(struct dc *dc,\n\t\t\tconst struct dc_stream_state *stream,\n\t\t\tint num_planes, struct dc_state *context);\n\tvoid (*program_front_end_for_ctx)(struct dc *dc,\n\t\t\tstruct dc_state *context);\n\tvoid (*wait_for_pending_cleared)(struct dc *dc,\n\t\t\tstruct dc_state *context);\n\tvoid (*post_unlock_program_front_end)(struct dc *dc,\n\t\t\tstruct dc_state *context);\n\tvoid (*update_plane_addr)(const struct dc *dc,\n\t\t\tstruct pipe_ctx *pipe_ctx);\n\tvoid (*update_dchub)(struct dce_hwseq *hws,\n\t\t\tstruct dchub_init_data *dh_data);\n\tvoid (*wait_for_mpcc_disconnect)(struct dc *dc,\n\t\t\tstruct resource_pool *res_pool,\n\t\t\tstruct pipe_ctx *pipe_ctx);\n\tvoid (*edp_backlight_control)(\n\t\t\tstruct dc_link *link,\n\t\t\tbool enable);\n\tvoid (*program_triplebuffer)(const struct dc *dc,\n\t\tstruct pipe_ctx *pipe_ctx, bool enableTripleBuffer);\n\tvoid (*update_pending_status)(struct pipe_ctx *pipe_ctx);\n\tvoid (*power_down)(struct dc *dc);\n\tvoid (*update_dsc_pg)(struct dc *dc, struct dc_state *context, bool safe_to_disable);\n\n\t \n\tvoid (*pipe_control_lock)(struct dc *dc,\n\t\t\tstruct pipe_ctx *pipe, bool lock);\n\tvoid (*interdependent_update_lock)(struct dc *dc,\n\t\t\tstruct dc_state *context, bool lock);\n\tvoid (*set_flip_control_gsl)(struct pipe_ctx *pipe_ctx,\n\t\t\tbool flip_immediate);\n\tvoid (*cursor_lock)(struct dc *dc, struct pipe_ctx *pipe, bool lock);\n\n\t \n\tvoid (*get_position)(struct pipe_ctx **pipe_ctx, int num_pipes,\n\t\t\tstruct crtc_position *position);\n\tint (*get_vupdate_offset_from_vsync)(struct pipe_ctx *pipe_ctx);\n\tvoid (*calc_vupdate_position)(\n\t\t\tstruct dc *dc,\n\t\t\tstruct pipe_ctx *pipe_ctx,\n\t\t\tuint32_t *start_line,\n\t\t\tuint32_t *end_line);\n\tvoid (*enable_per_frame_crtc_position_reset)(struct dc *dc,\n\t\t\tint group_size, struct pipe_ctx *grouped_pipes[]);\n\tvoid (*enable_timing_synchronization)(struct dc *dc,\n\t\t\tint group_index, int group_size,\n\t\t\tstruct pipe_ctx *grouped_pipes[]);\n\tvoid (*enable_vblanks_synchronization)(struct dc *dc,\n\t\t\tint group_index, int group_size,\n\t\t\tstruct pipe_ctx *grouped_pipes[]);\n\tvoid (*setup_periodic_interrupt)(struct dc *dc,\n\t\t\tstruct pipe_ctx *pipe_ctx);\n\tvoid (*set_drr)(struct pipe_ctx **pipe_ctx, int num_pipes,\n\t\t\tstruct dc_crtc_timing_adjust adjust);\n\tvoid (*set_static_screen_control)(struct pipe_ctx **pipe_ctx,\n\t\t\tint num_pipes,\n\t\t\tconst struct dc_static_screen_params *events);\n#ifndef TRIM_FSFT\n\tbool (*optimize_timing_for_fsft)(struct dc *dc,\n\t\t\tstruct dc_crtc_timing *timing,\n\t\t\tunsigned int max_input_rate_in_khz);\n#endif\n\n\t \n\tvoid (*enable_stream)(struct pipe_ctx *pipe_ctx);\n\tvoid (*disable_stream)(struct pipe_ctx *pipe_ctx);\n\tvoid (*blank_stream)(struct pipe_ctx *pipe_ctx);\n\tvoid (*unblank_stream)(struct pipe_ctx *pipe_ctx,\n\t\t\tstruct dc_link_settings *link_settings);\n\n\t \n\tvoid (*prepare_bandwidth)(struct dc *dc, struct dc_state *context);\n\tbool (*update_bandwidth)(struct dc *dc, struct dc_state *context);\n\tvoid (*optimize_bandwidth)(struct dc *dc, struct dc_state *context);\n\n\t \n\tvoid (*set_avmute)(struct pipe_ctx *pipe_ctx, bool enable);\n\tvoid (*send_immediate_sdp_message)(\n\t\t\tstruct pipe_ctx *pipe_ctx,\n\t\t\tconst uint8_t *custom_sdp_message,\n\t\t\tunsigned int sdp_message_size);\n\tvoid (*update_info_frame)(struct pipe_ctx *pipe_ctx);\n\tvoid (*set_dmdata_attributes)(struct pipe_ctx *pipe);\n\tvoid (*program_dmdata_engine)(struct pipe_ctx *pipe_ctx);\n\tbool (*dmdata_status_done)(struct pipe_ctx *pipe_ctx);\n\n\t \n\tvoid (*set_cursor_position)(struct pipe_ctx *pipe);\n\tvoid (*set_cursor_attribute)(struct pipe_ctx *pipe);\n\tvoid (*set_cursor_sdr_white_level)(struct pipe_ctx *pipe);\n\n\t \n\tvoid (*program_gamut_remap)(struct pipe_ctx *pipe_ctx);\n\tvoid (*program_output_csc)(struct dc *dc, struct pipe_ctx *pipe_ctx,\n\t\t\tenum dc_color_space colorspace,\n\t\t\tuint16_t *matrix, int opp_id);\n\n\t \n\tint (*init_sys_ctx)(struct dce_hwseq *hws,\n\t\t\tstruct dc *dc,\n\t\t\tstruct dc_phy_addr_space_config *pa_config);\n\tvoid (*init_vm_ctx)(struct dce_hwseq *hws,\n\t\t\tstruct dc *dc,\n\t\t\tstruct dc_virtual_addr_space_config *va_config,\n\t\t\tint vmid);\n\n\t \n\tvoid (*update_writeback)(struct dc *dc,\n\t\t\tstruct dc_writeback_info *wb_info,\n\t\t\tstruct dc_state *context);\n\tvoid (*enable_writeback)(struct dc *dc,\n\t\t\tstruct dc_writeback_info *wb_info,\n\t\t\tstruct dc_state *context);\n\tvoid (*disable_writeback)(struct dc *dc,\n\t\t\tunsigned int dwb_pipe_inst);\n\n\tbool (*mmhubbub_warmup)(struct dc *dc,\n\t\t\tunsigned int num_dwb,\n\t\t\tstruct dc_writeback_info *wb_info);\n\n\t \n\tenum dc_status (*set_clock)(struct dc *dc,\n\t\t\tenum dc_clock_type clock_type,\n\t\t\tuint32_t clk_khz, uint32_t stepping);\n\tvoid (*get_clock)(struct dc *dc, enum dc_clock_type clock_type,\n\t\t\tstruct dc_clock_config *clock_cfg);\n\tvoid (*optimize_pwr_state)(const struct dc *dc,\n\t\t\tstruct dc_state *context);\n\tvoid (*exit_optimized_pwr_state)(const struct dc *dc,\n\t\t\tstruct dc_state *context);\n\n\t \n\tvoid (*enable_audio_stream)(struct pipe_ctx *pipe_ctx);\n\tvoid (*disable_audio_stream)(struct pipe_ctx *pipe_ctx);\n\n\t \n\tvoid (*setup_stereo)(struct pipe_ctx *pipe_ctx, struct dc *dc);\n\n\t \n\tvoid (*log_hw_state)(struct dc *dc, struct dc_log_buffer_ctx *log_ctx);\n\tvoid (*get_hw_state)(struct dc *dc, char *pBuf,\n\t\t\tunsigned int bufSize, unsigned int mask);\n\tvoid (*clear_status_bits)(struct dc *dc, unsigned int mask);\n\n\tbool (*set_backlight_level)(struct pipe_ctx *pipe_ctx,\n\t\t\tuint32_t backlight_pwm_u16_16,\n\t\t\tuint32_t frame_ramp);\n\n\tvoid (*set_abm_immediate_disable)(struct pipe_ctx *pipe_ctx);\n\n\tvoid (*set_pipe)(struct pipe_ctx *pipe_ctx);\n\n\tvoid (*enable_dp_link_output)(struct dc_link *link,\n\t\t\tconst struct link_resource *link_res,\n\t\t\tenum signal_type signal,\n\t\t\tenum clock_source_id clock_source,\n\t\t\tconst struct dc_link_settings *link_settings);\n\tvoid (*enable_tmds_link_output)(struct dc_link *link,\n\t\t\tconst struct link_resource *link_res,\n\t\t\tenum signal_type signal,\n\t\t\tenum clock_source_id clock_source,\n\t\t\tenum dc_color_depth color_depth,\n\t\t\tuint32_t pixel_clock);\n\tvoid (*enable_lvds_link_output)(struct dc_link *link,\n\t\t\tconst struct link_resource *link_res,\n\t\t\tenum clock_source_id clock_source,\n\t\t\tuint32_t pixel_clock);\n\tvoid (*disable_link_output)(struct dc_link *link,\n\t\t\tconst struct link_resource *link_res,\n\t\t\tenum signal_type signal);\n\n\tvoid (*get_dcc_en_bits)(struct dc *dc, int *dcc_en_bits);\n\n\t \n\tbool (*apply_idle_power_optimizations)(struct dc *dc, bool enable);\n\n\tbool (*does_plane_fit_in_mall)(struct dc *dc, struct dc_plane_state *plane,\n\t\t\tstruct dc_cursor_attributes *cursor_attr);\n\n\tbool (*is_abm_supported)(struct dc *dc,\n\t\t\tstruct dc_state *context, struct dc_stream_state *stream);\n\n\tvoid (*set_disp_pattern_generator)(const struct dc *dc,\n\t\t\tstruct pipe_ctx *pipe_ctx,\n\t\t\tenum controller_dp_test_pattern test_pattern,\n\t\t\tenum controller_dp_color_space color_space,\n\t\t\tenum dc_color_depth color_depth,\n\t\t\tconst struct tg_color *solid_color,\n\t\t\tint width, int height, int offset);\n\n\tvoid (*subvp_pipe_control_lock_fast)(union block_sequence_params *params);\n\tvoid (*z10_restore)(const struct dc *dc);\n\tvoid (*z10_save_init)(struct dc *dc);\n\n\tvoid (*blank_phantom)(struct dc *dc,\n\t\t\tstruct timing_generator *tg,\n\t\t\tint width,\n\t\t\tint height);\n\n\tvoid (*update_visual_confirm_color)(struct dc *dc,\n\t\t\tstruct pipe_ctx *pipe_ctx,\n\t\t\tint mpcc_id);\n\n\tvoid (*update_phantom_vp_position)(struct dc *dc,\n\t\t\tstruct dc_state *context,\n\t\t\tstruct pipe_ctx *phantom_pipe);\n\tvoid (*apply_update_flags_for_phantom)(struct pipe_ctx *phantom_pipe);\n\tbool (*is_pipe_topology_transition_seamless)(struct dc *dc,\n\t\t\tconst struct dc_state *cur_ctx,\n\t\t\tconst struct dc_state *new_ctx);\n\n\tvoid (*commit_subvp_config)(struct dc *dc, struct dc_state *context);\n\tvoid (*enable_phantom_streams)(struct dc *dc, struct dc_state *context);\n\tvoid (*subvp_pipe_control_lock)(struct dc *dc,\n\t\t\tstruct dc_state *context,\n\t\t\tbool lock,\n\t\t\tbool should_lock_all_pipes,\n\t\t\tstruct pipe_ctx *top_pipe_to_program,\n\t\t\tbool subvp_prev_use);\n\n};\n\nvoid color_space_to_black_color(\n\tconst struct dc *dc,\n\tenum dc_color_space colorspace,\n\tstruct tg_color *black_color);\n\nbool hwss_wait_for_blank_complete(\n\t\tstruct timing_generator *tg);\n\nconst uint16_t *find_color_matrix(\n\t\tenum dc_color_space color_space,\n\t\tuint32_t *array_size);\n\nvoid get_surface_visual_confirm_color(\n\t\tconst struct pipe_ctx *pipe_ctx,\n\t\tstruct tg_color *color);\n\nvoid get_subvp_visual_confirm_color(\n\tstruct dc *dc,\n\tstruct dc_state *context,\n\tstruct pipe_ctx *pipe_ctx,\n\tstruct tg_color *color);\n\nvoid get_hdr_visual_confirm_color(\n\t\tstruct pipe_ctx *pipe_ctx,\n\t\tstruct tg_color *color);\nvoid get_mpctree_visual_confirm_color(\n\t\tstruct pipe_ctx *pipe_ctx,\n\t\tstruct tg_color *color);\nvoid get_surface_tile_visual_confirm_color(\n\t\tstruct pipe_ctx *pipe_ctx,\n\t\tstruct tg_color *color);\n\nvoid get_mclk_switch_visual_confirm_color(\n\t\tstruct dc *dc,\n\t\tstruct dc_state *context,\n\t\tstruct pipe_ctx *pipe_ctx,\n\t\tstruct tg_color *color);\n\nvoid hwss_execute_sequence(struct dc *dc,\n\t\tstruct block_sequence block_sequence[],\n\t\tint num_steps);\n\nvoid hwss_build_fast_sequence(struct dc *dc,\n\t\tstruct dc_dmub_cmd *dc_dmub_cmd,\n\t\tunsigned int dmub_cmd_count,\n\t\tstruct block_sequence block_sequence[],\n\t\tint *num_steps,\n\t\tstruct pipe_ctx *pipe_ctx);\n\nvoid hwss_send_dmcub_cmd(union block_sequence_params *params);\n\nvoid hwss_program_manual_trigger(union block_sequence_params *params);\n\nvoid hwss_setup_dpp(union block_sequence_params *params);\n\nvoid hwss_program_bias_and_scale(union block_sequence_params *params);\n\nvoid hwss_power_on_mpc_mem_pwr(union block_sequence_params *params);\n\nvoid hwss_set_output_csc(union block_sequence_params *params);\n\nvoid hwss_set_ocsc_default(union block_sequence_params *params);\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}