{
  "module_name": "dcn30_hubp.c",
  "hash_id": "ad8b62768a5bf505674e795c9fa503ba78dc943e7e462050778dc7294be586d2",
  "original_prompt": "Ingested from linux-6.6.14/drivers/gpu/drm/amd/display/dc/dcn30/dcn30_hubp.c",
  "human_readable_source": " \n\n#include \"dcn30_hubp.h\"\n\n#include \"dm_services.h\"\n#include \"dce_calcs.h\"\n#include \"reg_helper.h\"\n#include \"basics/conversion.h\"\n#include \"dcn20/dcn20_hubp.h\"\n#include \"dcn21/dcn21_hubp.h\"\n\n#define REG(reg)\\\n\thubp2->hubp_regs->reg\n\n#define CTX \\\n\thubp2->base.ctx\n\n#undef FN\n#define FN(reg_name, field_name) \\\n\thubp2->hubp_shift->field_name, hubp2->hubp_mask->field_name\n\nvoid hubp3_set_vm_system_aperture_settings(struct hubp *hubp,\n\t\tstruct vm_system_aperture_param *apt)\n{\n\tstruct dcn20_hubp *hubp2 = TO_DCN20_HUBP(hubp);\n\n\tPHYSICAL_ADDRESS_LOC mc_vm_apt_low;\n\tPHYSICAL_ADDRESS_LOC mc_vm_apt_high;\n\n\t\n\tmc_vm_apt_low.quad_part = apt->sys_low.quad_part >> 18;\n\tmc_vm_apt_high.quad_part = apt->sys_high.quad_part >> 18;\n\n\tREG_SET(DCN_VM_SYSTEM_APERTURE_LOW_ADDR, 0,\n\t\t\tMC_VM_SYSTEM_APERTURE_LOW_ADDR, mc_vm_apt_low.quad_part);\n\n\tREG_SET(DCN_VM_SYSTEM_APERTURE_HIGH_ADDR, 0,\n\t\t\tMC_VM_SYSTEM_APERTURE_HIGH_ADDR, mc_vm_apt_high.quad_part);\n\n\tREG_SET_2(DCN_VM_MX_L1_TLB_CNTL, 0,\n\t\t\tENABLE_L1_TLB, 1,\n\t\t\tSYSTEM_ACCESS_MODE, 0x3);\n}\n\nbool hubp3_program_surface_flip_and_addr(\n\tstruct hubp *hubp,\n\tconst struct dc_plane_address *address,\n\tbool flip_immediate)\n{\n\tstruct dcn20_hubp *hubp2 = TO_DCN20_HUBP(hubp);\n\n\t\n\tREG_UPDATE(DCSURF_FLIP_CONTROL,\n\t\t\tSURFACE_FLIP_TYPE, flip_immediate);\n\n\t\n\tif (flip_immediate == 0)\n\t\tREG_UPDATE(VMID_SETTINGS_0,\n\t\t\tVMID, address->vmid);\n\n\tif (address->type == PLN_ADDR_TYPE_GRPH_STEREO) {\n\t\tREG_UPDATE(DCSURF_FLIP_CONTROL, SURFACE_FLIP_MODE_FOR_STEREOSYNC, 0);\n\t\tREG_UPDATE(DCSURF_FLIP_CONTROL, SURFACE_FLIP_IN_STEREOSYNC, 0x1);\n\n\t} else {\n\t\t\n\t\tREG_UPDATE(DCSURF_FLIP_CONTROL, SURFACE_FLIP_MODE_FOR_STEREOSYNC, 0x0);\n\t\tREG_UPDATE(DCSURF_FLIP_CONTROL, SURFACE_FLIP_IN_STEREOSYNC, 0x0);\n\t}\n\n\t \n\tswitch (address->type) {\n\tcase PLN_ADDR_TYPE_GRAPHICS:\n\t\t \n\n\t\tif (address->grph.addr.quad_part == 0)\n\t\t\tbreak;\n\n\t\tREG_UPDATE_2(DCSURF_SURFACE_CONTROL,\n\t\t\t\tPRIMARY_SURFACE_TMZ, address->tmz_surface,\n\t\t\t\tPRIMARY_META_SURFACE_TMZ, address->tmz_surface);\n\n\t\tif (address->grph.meta_addr.quad_part != 0) {\n\t\t\tREG_SET(DCSURF_PRIMARY_META_SURFACE_ADDRESS_HIGH, 0,\n\t\t\t\t\tPRIMARY_META_SURFACE_ADDRESS_HIGH,\n\t\t\t\t\taddress->grph.meta_addr.high_part);\n\n\t\t\tREG_SET(DCSURF_PRIMARY_META_SURFACE_ADDRESS, 0,\n\t\t\t\t\tPRIMARY_META_SURFACE_ADDRESS,\n\t\t\t\t\taddress->grph.meta_addr.low_part);\n\t\t}\n\n\t\tREG_SET(DCSURF_PRIMARY_SURFACE_ADDRESS_HIGH, 0,\n\t\t\t\tPRIMARY_SURFACE_ADDRESS_HIGH,\n\t\t\t\taddress->grph.addr.high_part);\n\n\t\tREG_SET(DCSURF_PRIMARY_SURFACE_ADDRESS, 0,\n\t\t\t\tPRIMARY_SURFACE_ADDRESS,\n\t\t\t\taddress->grph.addr.low_part);\n\t\tbreak;\n\tcase PLN_ADDR_TYPE_VIDEO_PROGRESSIVE:\n\t\tif (address->video_progressive.luma_addr.quad_part == 0\n\t\t\t\t|| address->video_progressive.chroma_addr.quad_part == 0)\n\t\t\tbreak;\n\n\t\tREG_UPDATE_4(DCSURF_SURFACE_CONTROL,\n\t\t\t\tPRIMARY_SURFACE_TMZ, address->tmz_surface,\n\t\t\t\tPRIMARY_SURFACE_TMZ_C, address->tmz_surface,\n\t\t\t\tPRIMARY_META_SURFACE_TMZ, address->tmz_surface,\n\t\t\t\tPRIMARY_META_SURFACE_TMZ_C, address->tmz_surface);\n\n\t\tif (address->video_progressive.luma_meta_addr.quad_part != 0) {\n\t\t\tREG_SET(DCSURF_PRIMARY_META_SURFACE_ADDRESS_HIGH_C, 0,\n\t\t\t\t\tPRIMARY_META_SURFACE_ADDRESS_HIGH_C,\n\t\t\t\t\taddress->video_progressive.chroma_meta_addr.high_part);\n\n\t\t\tREG_SET(DCSURF_PRIMARY_META_SURFACE_ADDRESS_C, 0,\n\t\t\t\t\tPRIMARY_META_SURFACE_ADDRESS_C,\n\t\t\t\t\taddress->video_progressive.chroma_meta_addr.low_part);\n\n\t\t\tREG_SET(DCSURF_PRIMARY_META_SURFACE_ADDRESS_HIGH, 0,\n\t\t\t\t\tPRIMARY_META_SURFACE_ADDRESS_HIGH,\n\t\t\t\t\taddress->video_progressive.luma_meta_addr.high_part);\n\n\t\t\tREG_SET(DCSURF_PRIMARY_META_SURFACE_ADDRESS, 0,\n\t\t\t\t\tPRIMARY_META_SURFACE_ADDRESS,\n\t\t\t\t\taddress->video_progressive.luma_meta_addr.low_part);\n\t\t}\n\n\t\tREG_SET(DCSURF_PRIMARY_SURFACE_ADDRESS_HIGH_C, 0,\n\t\t\t\tPRIMARY_SURFACE_ADDRESS_HIGH_C,\n\t\t\t\taddress->video_progressive.chroma_addr.high_part);\n\n\t\tREG_SET(DCSURF_PRIMARY_SURFACE_ADDRESS_C, 0,\n\t\t\t\tPRIMARY_SURFACE_ADDRESS_C,\n\t\t\t\taddress->video_progressive.chroma_addr.low_part);\n\n\t\tREG_SET(DCSURF_PRIMARY_SURFACE_ADDRESS_HIGH, 0,\n\t\t\t\tPRIMARY_SURFACE_ADDRESS_HIGH,\n\t\t\t\taddress->video_progressive.luma_addr.high_part);\n\n\t\tREG_SET(DCSURF_PRIMARY_SURFACE_ADDRESS, 0,\n\t\t\t\tPRIMARY_SURFACE_ADDRESS,\n\t\t\t\taddress->video_progressive.luma_addr.low_part);\n\t\tbreak;\n\tcase PLN_ADDR_TYPE_GRPH_STEREO:\n\t\tif (address->grph_stereo.left_addr.quad_part == 0)\n\t\t\tbreak;\n\t\tif (address->grph_stereo.right_addr.quad_part == 0)\n\t\t\tbreak;\n\n\t\tREG_UPDATE_8(DCSURF_SURFACE_CONTROL,\n\t\t\t\tPRIMARY_SURFACE_TMZ, address->tmz_surface,\n\t\t\t\tPRIMARY_SURFACE_TMZ_C, address->tmz_surface,\n\t\t\t\tPRIMARY_META_SURFACE_TMZ, address->tmz_surface,\n\t\t\t\tPRIMARY_META_SURFACE_TMZ_C, address->tmz_surface,\n\t\t\t\tSECONDARY_SURFACE_TMZ, address->tmz_surface,\n\t\t\t\tSECONDARY_SURFACE_TMZ_C, address->tmz_surface,\n\t\t\t\tSECONDARY_META_SURFACE_TMZ, address->tmz_surface,\n\t\t\t\tSECONDARY_META_SURFACE_TMZ_C, address->tmz_surface);\n\n\t\tif (address->grph_stereo.right_meta_addr.quad_part != 0) {\n\n\t\t\tREG_SET(DCSURF_SECONDARY_META_SURFACE_ADDRESS_HIGH_C, 0,\n\t\t\t\tSECONDARY_META_SURFACE_ADDRESS_HIGH_C,\n\t\t\t\taddress->grph_stereo.right_alpha_meta_addr.high_part);\n\n\t\t\tREG_SET(DCSURF_SECONDARY_META_SURFACE_ADDRESS_C, 0,\n\t\t\t\tSECONDARY_META_SURFACE_ADDRESS_C,\n\t\t\t\taddress->grph_stereo.right_alpha_meta_addr.low_part);\n\n\t\t\tREG_SET(DCSURF_SECONDARY_META_SURFACE_ADDRESS_HIGH, 0,\n\t\t\t\t\tSECONDARY_META_SURFACE_ADDRESS_HIGH,\n\t\t\t\t\taddress->grph_stereo.right_meta_addr.high_part);\n\n\t\t\tREG_SET(DCSURF_SECONDARY_META_SURFACE_ADDRESS, 0,\n\t\t\t\t\tSECONDARY_META_SURFACE_ADDRESS,\n\t\t\t\t\taddress->grph_stereo.right_meta_addr.low_part);\n\t\t}\n\t\tif (address->grph_stereo.left_meta_addr.quad_part != 0) {\n\n\t\t\tREG_SET(DCSURF_PRIMARY_META_SURFACE_ADDRESS_HIGH_C, 0,\n\t\t\t\tPRIMARY_META_SURFACE_ADDRESS_HIGH_C,\n\t\t\t\taddress->grph_stereo.left_alpha_meta_addr.high_part);\n\n\t\t\tREG_SET(DCSURF_PRIMARY_META_SURFACE_ADDRESS_C, 0,\n\t\t\t\tPRIMARY_META_SURFACE_ADDRESS_C,\n\t\t\t\taddress->grph_stereo.left_alpha_meta_addr.low_part);\n\n\t\t\tREG_SET(DCSURF_PRIMARY_META_SURFACE_ADDRESS_HIGH, 0,\n\t\t\t\t\tPRIMARY_META_SURFACE_ADDRESS_HIGH,\n\t\t\t\t\taddress->grph_stereo.left_meta_addr.high_part);\n\n\t\t\tREG_SET(DCSURF_PRIMARY_META_SURFACE_ADDRESS, 0,\n\t\t\t\t\tPRIMARY_META_SURFACE_ADDRESS,\n\t\t\t\t\taddress->grph_stereo.left_meta_addr.low_part);\n\t\t}\n\n\t\tREG_SET(DCSURF_SECONDARY_SURFACE_ADDRESS_HIGH_C, 0,\n\t\t\t\tSECONDARY_SURFACE_ADDRESS_HIGH_C,\n\t\t\t\taddress->grph_stereo.right_alpha_addr.high_part);\n\n\t\tREG_SET(DCSURF_SECONDARY_SURFACE_ADDRESS_C, 0,\n\t\t\t\tSECONDARY_SURFACE_ADDRESS_C,\n\t\t\t\taddress->grph_stereo.right_alpha_addr.low_part);\n\n\t\tREG_SET(DCSURF_SECONDARY_SURFACE_ADDRESS_HIGH, 0,\n\t\t\t\tSECONDARY_SURFACE_ADDRESS_HIGH,\n\t\t\t\taddress->grph_stereo.right_addr.high_part);\n\n\t\tREG_SET(DCSURF_SECONDARY_SURFACE_ADDRESS, 0,\n\t\t\t\tSECONDARY_SURFACE_ADDRESS,\n\t\t\t\taddress->grph_stereo.right_addr.low_part);\n\n\t\tREG_SET(DCSURF_PRIMARY_SURFACE_ADDRESS_HIGH_C, 0,\n\t\t\t\tPRIMARY_SURFACE_ADDRESS_HIGH_C,\n\t\t\t\taddress->grph_stereo.left_alpha_addr.high_part);\n\n\t\tREG_SET(DCSURF_PRIMARY_SURFACE_ADDRESS_C, 0,\n\t\t\t\tPRIMARY_SURFACE_ADDRESS_C,\n\t\t\t\taddress->grph_stereo.left_alpha_addr.low_part);\n\n\t\tREG_SET(DCSURF_PRIMARY_SURFACE_ADDRESS_HIGH, 0,\n\t\t\t\tPRIMARY_SURFACE_ADDRESS_HIGH,\n\t\t\t\taddress->grph_stereo.left_addr.high_part);\n\n\t\tREG_SET(DCSURF_PRIMARY_SURFACE_ADDRESS, 0,\n\t\t\t\tPRIMARY_SURFACE_ADDRESS,\n\t\t\t\taddress->grph_stereo.left_addr.low_part);\n\t\tbreak;\n\tcase PLN_ADDR_TYPE_RGBEA:\n\t\tif (address->rgbea.addr.quad_part == 0\n\t\t\t\t|| address->rgbea.alpha_addr.quad_part == 0)\n\t\t\tbreak;\n\n\t\tREG_UPDATE_4(DCSURF_SURFACE_CONTROL,\n\t\t\t\tPRIMARY_SURFACE_TMZ, address->tmz_surface,\n\t\t\t\tPRIMARY_SURFACE_TMZ_C, address->tmz_surface,\n\t\t\t\tPRIMARY_META_SURFACE_TMZ, address->tmz_surface,\n\t\t\t\tPRIMARY_META_SURFACE_TMZ_C, address->tmz_surface);\n\n\t\tif (address->rgbea.meta_addr.quad_part != 0) {\n\n\t\t\tREG_SET(DCSURF_PRIMARY_META_SURFACE_ADDRESS_HIGH_C, 0,\n\t\t\t\t\tPRIMARY_META_SURFACE_ADDRESS_HIGH_C,\n\t\t\t\t\taddress->rgbea.alpha_meta_addr.high_part);\n\n\t\t\tREG_SET(DCSURF_PRIMARY_META_SURFACE_ADDRESS_C, 0,\n\t\t\t\t\tPRIMARY_META_SURFACE_ADDRESS_C,\n\t\t\t\t\taddress->rgbea.alpha_meta_addr.low_part);\n\n\t\t\tREG_SET(DCSURF_PRIMARY_META_SURFACE_ADDRESS_HIGH, 0,\n\t\t\t\t\tPRIMARY_META_SURFACE_ADDRESS_HIGH,\n\t\t\t\t\taddress->rgbea.meta_addr.high_part);\n\n\t\t\tREG_SET(DCSURF_PRIMARY_META_SURFACE_ADDRESS, 0,\n\t\t\t\t\tPRIMARY_META_SURFACE_ADDRESS,\n\t\t\t\t\taddress->rgbea.meta_addr.low_part);\n\t\t}\n\n\t\tREG_SET(DCSURF_PRIMARY_SURFACE_ADDRESS_HIGH_C, 0,\n\t\t\t\tPRIMARY_SURFACE_ADDRESS_HIGH_C,\n\t\t\t\taddress->rgbea.alpha_addr.high_part);\n\n\t\tREG_SET(DCSURF_PRIMARY_SURFACE_ADDRESS_C, 0,\n\t\t\t\tPRIMARY_SURFACE_ADDRESS_C,\n\t\t\t\taddress->rgbea.alpha_addr.low_part);\n\n\t\tREG_SET(DCSURF_PRIMARY_SURFACE_ADDRESS_HIGH, 0,\n\t\t\t\tPRIMARY_SURFACE_ADDRESS_HIGH,\n\t\t\t\taddress->rgbea.addr.high_part);\n\n\t\tREG_SET(DCSURF_PRIMARY_SURFACE_ADDRESS, 0,\n\t\t\t\tPRIMARY_SURFACE_ADDRESS,\n\t\t\t\taddress->rgbea.addr.low_part);\n\t\tbreak;\n\tdefault:\n\t\tBREAK_TO_DEBUGGER();\n\t\tbreak;\n\t}\n\n\thubp->request_address = *address;\n\n\treturn true;\n}\n\nstatic void hubp3_program_tiling(\n\tstruct dcn20_hubp *hubp2,\n\tconst union dc_tiling_info *info,\n\tconst enum surface_pixel_format pixel_format)\n{\n\tREG_UPDATE_4(DCSURF_ADDR_CONFIG,\n\t\tNUM_PIPES, log_2(info->gfx9.num_pipes),\n\t\tPIPE_INTERLEAVE, info->gfx9.pipe_interleave,\n\t\tMAX_COMPRESSED_FRAGS, log_2(info->gfx9.max_compressed_frags),\n\t\tNUM_PKRS, log_2(info->gfx9.num_pkrs));\n\n\tREG_UPDATE_3(DCSURF_TILING_CONFIG,\n\t\t\tSW_MODE, info->gfx9.swizzle,\n\t\t\tMETA_LINEAR, info->gfx9.meta_linear,\n\t\t\tPIPE_ALIGNED, info->gfx9.pipe_aligned);\n\n}\n\nvoid hubp3_dcc_control(struct hubp *hubp, bool enable,\n\t\tenum hubp_ind_block_size blk_size)\n{\n\tuint32_t dcc_en = enable ? 1 : 0;\n\tstruct dcn20_hubp *hubp2 = TO_DCN20_HUBP(hubp);\n\n\tREG_UPDATE_4(DCSURF_SURFACE_CONTROL,\n\t\t\tPRIMARY_SURFACE_DCC_EN, dcc_en,\n\t\t\tPRIMARY_SURFACE_DCC_IND_BLK, blk_size,\n\t\t\tSECONDARY_SURFACE_DCC_EN, dcc_en,\n\t\t\tSECONDARY_SURFACE_DCC_IND_BLK, blk_size);\n}\n\nvoid hubp3_dcc_control_sienna_cichlid(struct hubp *hubp,\n\t\tstruct dc_plane_dcc_param *dcc)\n{\n\tstruct dcn20_hubp *hubp2 = TO_DCN20_HUBP(hubp);\n\n\tREG_UPDATE_6(DCSURF_SURFACE_CONTROL,\n\t\tPRIMARY_SURFACE_DCC_EN, dcc->enable,\n\t\tPRIMARY_SURFACE_DCC_IND_BLK, dcc->dcc_ind_blk,\n\t\tPRIMARY_SURFACE_DCC_IND_BLK_C, dcc->dcc_ind_blk_c,\n\t\tSECONDARY_SURFACE_DCC_EN, dcc->enable,\n\t\tSECONDARY_SURFACE_DCC_IND_BLK, dcc->dcc_ind_blk,\n\t\tSECONDARY_SURFACE_DCC_IND_BLK_C, dcc->dcc_ind_blk_c);\n}\n\nvoid hubp3_dmdata_set_attributes(\n\t\tstruct hubp *hubp,\n\t\tconst struct dc_dmdata_attributes *attr)\n{\n\tstruct dcn20_hubp *hubp2 = TO_DCN20_HUBP(hubp);\n\n\t \n\tREG_UPDATE(DMDATA_CNTL,\n\t\t\tDMDATA_MODE, 1);\n\n\t \n\tREG_UPDATE(DCSURF_FLIP_CONTROL, SURFACE_UPDATE_LOCK, 1);\n\n\t \n\tREG_UPDATE(DMDATA_CNTL,\n\t\t\tDMDATA_UPDATED, 0);\n\tREG_UPDATE_3(DMDATA_CNTL,\n\t\t\tDMDATA_UPDATED, 1,\n\t\t\tDMDATA_REPEAT, attr->dmdata_repeat,\n\t\t\tDMDATA_SIZE, attr->dmdata_size);\n\n\t \n\tREG_WRITE(DMDATA_ADDRESS_LOW, attr->address.low_part);\n\tREG_UPDATE(DMDATA_ADDRESS_HIGH,\n\t\t\tDMDATA_ADDRESS_HIGH, attr->address.high_part);\n\n\tREG_UPDATE(DCSURF_FLIP_CONTROL, SURFACE_UPDATE_LOCK, 0);\n\n}\n\n\nvoid hubp3_program_surface_config(\n\tstruct hubp *hubp,\n\tenum surface_pixel_format format,\n\tunion dc_tiling_info *tiling_info,\n\tstruct plane_size *plane_size,\n\tenum dc_rotation_angle rotation,\n\tstruct dc_plane_dcc_param *dcc,\n\tbool horizontal_mirror,\n\tunsigned int compat_level)\n{\n\tstruct dcn20_hubp *hubp2 = TO_DCN20_HUBP(hubp);\n\n\thubp3_dcc_control_sienna_cichlid(hubp, dcc);\n\thubp3_program_tiling(hubp2, tiling_info, format);\n\thubp2_program_size(hubp, format, plane_size, dcc);\n\thubp2_program_rotation(hubp, rotation, horizontal_mirror);\n\thubp2_program_pixel_format(hubp, format);\n}\n\nstatic void hubp3_program_deadline(\n\t\tstruct hubp *hubp,\n\t\tstruct _vcs_dpi_display_dlg_regs_st *dlg_attr,\n\t\tstruct _vcs_dpi_display_ttu_regs_st *ttu_attr)\n{\n\tstruct dcn20_hubp *hubp2 = TO_DCN20_HUBP(hubp);\n\n\thubp2_program_deadline(hubp, dlg_attr, ttu_attr);\n\tREG_UPDATE(DCN_DMDATA_VM_CNTL,\n\t\t\tREFCYC_PER_VM_DMDATA, dlg_attr->refcyc_per_vm_dmdata);\n}\n\nvoid hubp3_read_state(struct hubp *hubp)\n{\n\tstruct dcn20_hubp *hubp2 = TO_DCN20_HUBP(hubp);\n\tstruct dcn_hubp_state *s = &hubp2->state;\n\tstruct _vcs_dpi_display_rq_regs_st *rq_regs = &s->rq_regs;\n\n\thubp2_read_state_common(hubp);\n\n\tREG_GET_7(DCHUBP_REQ_SIZE_CONFIG,\n\t\tCHUNK_SIZE, &rq_regs->rq_regs_l.chunk_size,\n\t\tMIN_CHUNK_SIZE, &rq_regs->rq_regs_l.min_chunk_size,\n\t\tMETA_CHUNK_SIZE, &rq_regs->rq_regs_l.meta_chunk_size,\n\t\tMIN_META_CHUNK_SIZE, &rq_regs->rq_regs_l.min_meta_chunk_size,\n\t\tDPTE_GROUP_SIZE, &rq_regs->rq_regs_l.dpte_group_size,\n\t\tSWATH_HEIGHT, &rq_regs->rq_regs_l.swath_height,\n\t\tPTE_ROW_HEIGHT_LINEAR, &rq_regs->rq_regs_l.pte_row_height_linear);\n\n\tREG_GET_7(DCHUBP_REQ_SIZE_CONFIG_C,\n\t\tCHUNK_SIZE_C, &rq_regs->rq_regs_c.chunk_size,\n\t\tMIN_CHUNK_SIZE_C, &rq_regs->rq_regs_c.min_chunk_size,\n\t\tMETA_CHUNK_SIZE_C, &rq_regs->rq_regs_c.meta_chunk_size,\n\t\tMIN_META_CHUNK_SIZE_C, &rq_regs->rq_regs_c.min_meta_chunk_size,\n\t\tDPTE_GROUP_SIZE_C, &rq_regs->rq_regs_c.dpte_group_size,\n\t\tSWATH_HEIGHT_C, &rq_regs->rq_regs_c.swath_height,\n\t\tPTE_ROW_HEIGHT_LINEAR_C, &rq_regs->rq_regs_c.pte_row_height_linear);\n\n\tif (REG(UCLK_PSTATE_FORCE))\n\t\ts->uclk_pstate_force = REG_READ(UCLK_PSTATE_FORCE);\n\n\tif (REG(DCHUBP_CNTL))\n\t\ts->hubp_cntl = REG_READ(DCHUBP_CNTL);\n\n}\n\nvoid hubp3_setup(\n\t\tstruct hubp *hubp,\n\t\tstruct _vcs_dpi_display_dlg_regs_st *dlg_attr,\n\t\tstruct _vcs_dpi_display_ttu_regs_st *ttu_attr,\n\t\tstruct _vcs_dpi_display_rq_regs_st *rq_regs,\n\t\tstruct _vcs_dpi_display_pipe_dest_params_st *pipe_dest)\n{\n\t \n\thubp2_vready_at_or_After_vsync(hubp, pipe_dest);\n\thubp21_program_requestor(hubp, rq_regs);\n\thubp3_program_deadline(hubp, dlg_attr, ttu_attr);\n}\n\nvoid hubp3_init(struct hubp *hubp)\n{\n\t\n\t\n\n\tstruct dcn20_hubp *hubp2 = TO_DCN20_HUBP(hubp);\n\t\n\tREG_WRITE(HUBPREQ_DEBUG, 1 << 26);\n}\n\nstatic struct hubp_funcs dcn30_hubp_funcs = {\n\t.hubp_enable_tripleBuffer = hubp2_enable_triplebuffer,\n\t.hubp_is_triplebuffer_enabled = hubp2_is_triplebuffer_enabled,\n\t.hubp_program_surface_flip_and_addr = hubp3_program_surface_flip_and_addr,\n\t.hubp_program_surface_config = hubp3_program_surface_config,\n\t.hubp_is_flip_pending = hubp2_is_flip_pending,\n\t.hubp_setup = hubp3_setup,\n\t.hubp_setup_interdependent = hubp2_setup_interdependent,\n\t.hubp_set_vm_system_aperture_settings = hubp3_set_vm_system_aperture_settings,\n\t.set_blank = hubp2_set_blank,\n\t.set_blank_regs = hubp2_set_blank_regs,\n\t.dcc_control = hubp3_dcc_control,\n\t.mem_program_viewport = min_set_viewport,\n\t.set_cursor_attributes\t= hubp2_cursor_set_attributes,\n\t.set_cursor_position\t= hubp2_cursor_set_position,\n\t.hubp_clk_cntl = hubp2_clk_cntl,\n\t.hubp_vtg_sel = hubp2_vtg_sel,\n\t.dmdata_set_attributes = hubp3_dmdata_set_attributes,\n\t.dmdata_load = hubp2_dmdata_load,\n\t.dmdata_status_done = hubp2_dmdata_status_done,\n\t.hubp_read_state = hubp3_read_state,\n\t.hubp_clear_underflow = hubp2_clear_underflow,\n\t.hubp_set_flip_control_surface_gsl = hubp2_set_flip_control_surface_gsl,\n\t.hubp_init = hubp3_init,\n\t.hubp_in_blank = hubp1_in_blank,\n\t.hubp_soft_reset = hubp1_soft_reset,\n\t.hubp_set_flip_int = hubp1_set_flip_int,\n};\n\nbool hubp3_construct(\n\tstruct dcn20_hubp *hubp2,\n\tstruct dc_context *ctx,\n\tuint32_t inst,\n\tconst struct dcn_hubp2_registers *hubp_regs,\n\tconst struct dcn_hubp2_shift *hubp_shift,\n\tconst struct dcn_hubp2_mask *hubp_mask)\n{\n\thubp2->base.funcs = &dcn30_hubp_funcs;\n\thubp2->base.ctx = ctx;\n\thubp2->hubp_regs = hubp_regs;\n\thubp2->hubp_shift = hubp_shift;\n\thubp2->hubp_mask = hubp_mask;\n\thubp2->base.inst = inst;\n\thubp2->base.opp_id = OPP_ID_INVALID;\n\thubp2->base.mpcc_id = 0xf;\n\n\treturn true;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}