{
  "module_name": "dce_aux.h",
  "hash_id": "db86a02305deac12b6abe9e3ef68236e60af523bf592fb547ddc66cfde12f3e5",
  "original_prompt": "Ingested from linux-6.6.14/drivers/gpu/drm/amd/display/dc/dce/dce_aux.h",
  "human_readable_source": " \n\n#ifndef __DAL_AUX_ENGINE_DCE110_H__\n#define __DAL_AUX_ENGINE_DCE110_H__\n\n#include \"gpio_service_interface.h\"\n#include \"inc/hw/aux_engine.h\"\n\nenum aux_return_code_type;\n\n#define AUX_COMMON_REG_LIST0(id)\\\n\tSRI(AUX_CONTROL, DP_AUX, id), \\\n\tSRI(AUX_ARB_CONTROL, DP_AUX, id), \\\n\tSRI(AUX_SW_DATA, DP_AUX, id), \\\n\tSRI(AUX_SW_CONTROL, DP_AUX, id), \\\n\tSRI(AUX_INTERRUPT_CONTROL, DP_AUX, id), \\\n\tSRI(AUX_DPHY_RX_CONTROL1, DP_AUX, id), \\\n\tSRI(AUX_SW_STATUS, DP_AUX, id)\n\n#define AUX_COMMON_REG_LIST(id)\\\n\tSRI(AUX_CONTROL, DP_AUX, id), \\\n\tSRI(AUX_ARB_CONTROL, DP_AUX, id), \\\n\tSRI(AUX_SW_DATA, DP_AUX, id), \\\n\tSRI(AUX_SW_CONTROL, DP_AUX, id), \\\n\tSRI(AUX_INTERRUPT_CONTROL, DP_AUX, id), \\\n\tSRI(AUX_SW_STATUS, DP_AUX, id), \\\n\tSR(AUXN_IMPCAL), \\\n\tSR(AUXP_IMPCAL)\n\nstruct dce110_aux_registers {\n\tuint32_t AUX_CONTROL;\n\tuint32_t AUX_ARB_CONTROL;\n\tuint32_t AUX_SW_DATA;\n\tuint32_t AUX_SW_CONTROL;\n\tuint32_t AUX_INTERRUPT_CONTROL;\n\tuint32_t AUX_DPHY_RX_CONTROL1;\n\tuint32_t AUX_SW_STATUS;\n\tuint32_t AUXN_IMPCAL;\n\tuint32_t AUXP_IMPCAL;\n\n\tuint32_t AUX_RESET_MASK;\n};\n\n#define DCE_AUX_REG_FIELD_LIST(type)\\\n\ttype AUX_EN;\\\n\ttype AUX_RESET;\\\n\ttype AUX_RESET_DONE;\\\n\ttype AUX_REG_RW_CNTL_STATUS;\\\n\ttype AUX_SW_USE_AUX_REG_REQ;\\\n\ttype AUX_SW_DONE_USING_AUX_REG;\\\n\ttype AUX_SW_AUTOINCREMENT_DISABLE;\\\n\ttype AUX_SW_DATA_RW;\\\n\ttype AUX_SW_INDEX;\\\n\ttype AUX_SW_GO;\\\n\ttype AUX_SW_DATA;\\\n\ttype AUX_SW_REPLY_BYTE_COUNT;\\\n\ttype AUX_SW_DONE;\\\n\ttype AUX_SW_DONE_ACK;\\\n\ttype AUXN_IMPCAL_ENABLE;\\\n\ttype AUXP_IMPCAL_ENABLE;\\\n\ttype AUXN_IMPCAL_OVERRIDE_ENABLE;\\\n\ttype AUXP_IMPCAL_OVERRIDE_ENABLE;\\\n\ttype AUX_RX_TIMEOUT_LEN;\\\n\ttype AUX_RX_TIMEOUT_LEN_MUL;\\\n\ttype AUXN_CALOUT_ERROR_AK;\\\n\ttype AUXP_CALOUT_ERROR_AK;\\\n\ttype AUX_SW_START_DELAY;\\\n\ttype AUX_SW_WR_BYTES\n\n#define DCE10_AUX_MASK_SH_LIST(mask_sh)\\\n\tAUX_SF(AUX_CONTROL, AUX_EN, mask_sh),\\\n\tAUX_SF(AUX_ARB_CONTROL, AUX_REG_RW_CNTL_STATUS, mask_sh),\\\n\tAUX_SF(AUX_ARB_CONTROL, AUX_SW_USE_AUX_REG_REQ, mask_sh),\\\n\tAUX_SF(AUX_ARB_CONTROL, AUX_SW_DONE_USING_AUX_REG, mask_sh),\\\n\tAUX_SF(AUX_SW_CONTROL, AUX_SW_START_DELAY, mask_sh),\\\n\tAUX_SF(AUX_SW_CONTROL, AUX_SW_WR_BYTES, mask_sh),\\\n\tAUX_SF(AUX_SW_CONTROL, AUX_SW_GO, mask_sh),\\\n\tAUX_SF(AUX_SW_DATA, AUX_SW_AUTOINCREMENT_DISABLE, mask_sh),\\\n\tAUX_SF(AUX_SW_DATA, AUX_SW_DATA_RW, mask_sh),\\\n\tAUX_SF(AUX_SW_DATA, AUX_SW_INDEX, mask_sh),\\\n\tAUX_SF(AUX_SW_DATA, AUX_SW_DATA, mask_sh),\\\n\tAUX_SF(AUX_SW_STATUS, AUX_SW_REPLY_BYTE_COUNT, mask_sh),\\\n\tAUX_SF(AUX_SW_STATUS, AUX_SW_DONE, mask_sh),\\\n\tAUX_SF(AUX_INTERRUPT_CONTROL, AUX_SW_DONE_ACK, mask_sh),\\\n\tAUX_SF(AUXN_IMPCAL, AUXN_CALOUT_ERROR_AK, mask_sh),\\\n\tAUX_SF(AUXP_IMPCAL, AUXP_CALOUT_ERROR_AK, mask_sh),\\\n\tAUX_SF(AUXN_IMPCAL, AUXN_IMPCAL_ENABLE, mask_sh),\\\n\tAUX_SF(AUXP_IMPCAL, AUXP_IMPCAL_ENABLE, mask_sh),\\\n\tAUX_SF(AUXP_IMPCAL, AUXP_IMPCAL_OVERRIDE_ENABLE, mask_sh),\\\n\tAUX_SF(AUXN_IMPCAL, AUXN_IMPCAL_OVERRIDE_ENABLE, mask_sh)\n\n#define DCE_AUX_MASK_SH_LIST(mask_sh)\\\n\tAUX_SF(AUX_CONTROL, AUX_EN, mask_sh),\\\n\tAUX_SF(AUX_CONTROL, AUX_RESET, mask_sh),\\\n\tAUX_SF(AUX_CONTROL, AUX_RESET_DONE, mask_sh),\\\n\tAUX_SF(AUX_ARB_CONTROL, AUX_REG_RW_CNTL_STATUS, mask_sh),\\\n\tAUX_SF(AUX_ARB_CONTROL, AUX_SW_USE_AUX_REG_REQ, mask_sh),\\\n\tAUX_SF(AUX_ARB_CONTROL, AUX_SW_DONE_USING_AUX_REG, mask_sh),\\\n\tAUX_SF(AUX_SW_CONTROL, AUX_SW_START_DELAY, mask_sh),\\\n\tAUX_SF(AUX_SW_CONTROL, AUX_SW_WR_BYTES, mask_sh),\\\n\tAUX_SF(AUX_SW_CONTROL, AUX_SW_GO, mask_sh),\\\n\tAUX_SF(AUX_SW_DATA, AUX_SW_AUTOINCREMENT_DISABLE, mask_sh),\\\n\tAUX_SF(AUX_SW_DATA, AUX_SW_DATA_RW, mask_sh),\\\n\tAUX_SF(AUX_SW_DATA, AUX_SW_INDEX, mask_sh),\\\n\tAUX_SF(AUX_SW_DATA, AUX_SW_DATA, mask_sh),\\\n\tAUX_SF(AUX_SW_STATUS, AUX_SW_REPLY_BYTE_COUNT, mask_sh),\\\n\tAUX_SF(AUX_SW_STATUS, AUX_SW_DONE, mask_sh),\\\n\tAUX_SF(AUX_INTERRUPT_CONTROL, AUX_SW_DONE_ACK, mask_sh),\\\n\tAUX_SF(AUXN_IMPCAL, AUXN_CALOUT_ERROR_AK, mask_sh),\\\n\tAUX_SF(AUXP_IMPCAL, AUXP_CALOUT_ERROR_AK, mask_sh),\\\n\tAUX_SF(AUXN_IMPCAL, AUXN_IMPCAL_ENABLE, mask_sh),\\\n\tAUX_SF(AUXP_IMPCAL, AUXP_IMPCAL_ENABLE, mask_sh),\\\n\tAUX_SF(AUXP_IMPCAL, AUXP_IMPCAL_OVERRIDE_ENABLE, mask_sh),\\\n\tAUX_SF(AUXN_IMPCAL, AUXN_IMPCAL_OVERRIDE_ENABLE, mask_sh)\n\n#define DCE12_AUX_MASK_SH_LIST(mask_sh)\\\n\tAUX_SF(DP_AUX0_AUX_CONTROL, AUX_EN, mask_sh),\\\n\tAUX_SF(DP_AUX0_AUX_CONTROL, AUX_RESET, mask_sh),\\\n\tAUX_SF(DP_AUX0_AUX_CONTROL, AUX_RESET_DONE, mask_sh),\\\n\tAUX_SF(DP_AUX0_AUX_ARB_CONTROL, AUX_REG_RW_CNTL_STATUS, mask_sh),\\\n\tAUX_SF(DP_AUX0_AUX_ARB_CONTROL, AUX_SW_USE_AUX_REG_REQ, mask_sh),\\\n\tAUX_SF(DP_AUX0_AUX_ARB_CONTROL, AUX_SW_DONE_USING_AUX_REG, mask_sh),\\\n\tAUX_SF(DP_AUX0_AUX_SW_CONTROL, AUX_SW_START_DELAY, mask_sh),\\\n\tAUX_SF(DP_AUX0_AUX_SW_CONTROL, AUX_SW_WR_BYTES, mask_sh),\\\n\tAUX_SF(DP_AUX0_AUX_SW_CONTROL, AUX_SW_GO, mask_sh),\\\n\tAUX_SF(DP_AUX0_AUX_SW_DATA, AUX_SW_AUTOINCREMENT_DISABLE, mask_sh),\\\n\tAUX_SF(DP_AUX0_AUX_SW_DATA, AUX_SW_DATA_RW, mask_sh),\\\n\tAUX_SF(DP_AUX0_AUX_SW_DATA, AUX_SW_AUTOINCREMENT_DISABLE, mask_sh),\\\n\tAUX_SF(DP_AUX0_AUX_SW_DATA, AUX_SW_INDEX, mask_sh),\\\n\tAUX_SF(DP_AUX0_AUX_SW_DATA, AUX_SW_DATA, mask_sh),\\\n\tAUX_SF(DP_AUX0_AUX_SW_STATUS, AUX_SW_REPLY_BYTE_COUNT, mask_sh),\\\n\tAUX_SF(DP_AUX0_AUX_SW_STATUS, AUX_SW_DONE, mask_sh),\\\n\tAUX_SF(DP_AUX0_AUX_INTERRUPT_CONTROL, AUX_SW_DONE_ACK, mask_sh),\\\n\tAUX_SF(AUXN_IMPCAL, AUXN_CALOUT_ERROR_AK, mask_sh),\\\n\tAUX_SF(AUXP_IMPCAL, AUXP_CALOUT_ERROR_AK, mask_sh),\\\n\tAUX_SF(AUXN_IMPCAL, AUXN_IMPCAL_ENABLE, mask_sh),\\\n\tAUX_SF(AUXP_IMPCAL, AUXP_IMPCAL_ENABLE, mask_sh),\\\n\tAUX_SF(AUXP_IMPCAL, AUXP_IMPCAL_OVERRIDE_ENABLE, mask_sh),\\\n\tAUX_SF(AUXN_IMPCAL, AUXN_IMPCAL_OVERRIDE_ENABLE, mask_sh)\n\n \n#define DCN10_AUX_MASK_SH_LIST(mask_sh)\\\n\tAUX_SF(DP_AUX0_AUX_CONTROL, AUX_EN, mask_sh),\\\n\tAUX_SF(DP_AUX0_AUX_CONTROL, AUX_RESET, mask_sh),\\\n\tAUX_SF(DP_AUX0_AUX_CONTROL, AUX_RESET_DONE, mask_sh),\\\n\tAUX_SF(DP_AUX0_AUX_ARB_CONTROL, AUX_REG_RW_CNTL_STATUS, mask_sh),\\\n\tAUX_SF(DP_AUX0_AUX_ARB_CONTROL, AUX_SW_USE_AUX_REG_REQ, mask_sh),\\\n\tAUX_SF(DP_AUX0_AUX_ARB_CONTROL, AUX_SW_DONE_USING_AUX_REG, mask_sh),\\\n\tAUX_SF(DP_AUX0_AUX_SW_CONTROL, AUX_SW_START_DELAY, mask_sh),\\\n\tAUX_SF(DP_AUX0_AUX_SW_CONTROL, AUX_SW_WR_BYTES, mask_sh),\\\n\tAUX_SF(DP_AUX0_AUX_SW_CONTROL, AUX_SW_GO, mask_sh),\\\n\tAUX_SF(DP_AUX0_AUX_SW_DATA, AUX_SW_AUTOINCREMENT_DISABLE, mask_sh),\\\n\tAUX_SF(DP_AUX0_AUX_SW_DATA, AUX_SW_DATA_RW, mask_sh),\\\n\tAUX_SF(DP_AUX0_AUX_SW_DATA, AUX_SW_AUTOINCREMENT_DISABLE, mask_sh),\\\n\tAUX_SF(DP_AUX0_AUX_SW_DATA, AUX_SW_INDEX, mask_sh),\\\n\tAUX_SF(DP_AUX0_AUX_SW_DATA, AUX_SW_DATA, mask_sh),\\\n\tAUX_SF(DP_AUX0_AUX_SW_STATUS, AUX_SW_REPLY_BYTE_COUNT, mask_sh),\\\n\tAUX_SF(DP_AUX0_AUX_SW_STATUS, AUX_SW_DONE, mask_sh),\\\n\tAUX_SF(DP_AUX0_AUX_INTERRUPT_CONTROL, AUX_SW_DONE_ACK, mask_sh),\\\n\tAUX_SF(AUXN_IMPCAL, AUXN_CALOUT_ERROR_AK, mask_sh),\\\n\tAUX_SF(AUXP_IMPCAL, AUXP_CALOUT_ERROR_AK, mask_sh),\\\n\tAUX_SF(AUXN_IMPCAL, AUXN_IMPCAL_ENABLE, mask_sh),\\\n\tAUX_SF(AUXP_IMPCAL, AUXP_IMPCAL_ENABLE, mask_sh),\\\n\tAUX_SF(AUXP_IMPCAL, AUXP_IMPCAL_OVERRIDE_ENABLE, mask_sh),\\\n\tAUX_SF(AUXN_IMPCAL, AUXN_IMPCAL_OVERRIDE_ENABLE, mask_sh)\n\n \n#define DCN_AUX_MASK_SH_LIST(mask_sh)\\\n\tAUX_SF(DP_AUX0_AUX_CONTROL, AUX_EN, mask_sh),\\\n\tAUX_SF(DP_AUX0_AUX_CONTROL, AUX_RESET, mask_sh),\\\n\tAUX_SF(DP_AUX0_AUX_CONTROL, AUX_RESET_DONE, mask_sh),\\\n\tAUX_SF(DP_AUX0_AUX_ARB_CONTROL, AUX_REG_RW_CNTL_STATUS, mask_sh),\\\n\tAUX_SF(DP_AUX0_AUX_ARB_CONTROL, AUX_SW_USE_AUX_REG_REQ, mask_sh),\\\n\tAUX_SF(DP_AUX0_AUX_ARB_CONTROL, AUX_SW_DONE_USING_AUX_REG, mask_sh),\\\n\tAUX_SF(DP_AUX0_AUX_SW_CONTROL, AUX_SW_START_DELAY, mask_sh),\\\n\tAUX_SF(DP_AUX0_AUX_SW_CONTROL, AUX_SW_WR_BYTES, mask_sh),\\\n\tAUX_SF(DP_AUX0_AUX_SW_CONTROL, AUX_SW_GO, mask_sh),\\\n\tAUX_SF(DP_AUX0_AUX_SW_DATA, AUX_SW_AUTOINCREMENT_DISABLE, mask_sh),\\\n\tAUX_SF(DP_AUX0_AUX_SW_DATA, AUX_SW_DATA_RW, mask_sh),\\\n\tAUX_SF(DP_AUX0_AUX_SW_DATA, AUX_SW_AUTOINCREMENT_DISABLE, mask_sh),\\\n\tAUX_SF(DP_AUX0_AUX_SW_DATA, AUX_SW_INDEX, mask_sh),\\\n\tAUX_SF(DP_AUX0_AUX_SW_DATA, AUX_SW_DATA, mask_sh),\\\n\tAUX_SF(DP_AUX0_AUX_SW_STATUS, AUX_SW_REPLY_BYTE_COUNT, mask_sh),\\\n\tAUX_SF(DP_AUX0_AUX_SW_STATUS, AUX_SW_DONE, mask_sh),\\\n\tAUX_SF(DP_AUX0_AUX_INTERRUPT_CONTROL, AUX_SW_DONE_ACK, mask_sh),\\\n\tAUX_SF(DP_AUX0_AUX_DPHY_RX_CONTROL1, AUX_RX_TIMEOUT_LEN, mask_sh),\\\n\tAUX_SF(DP_AUX0_AUX_DPHY_RX_CONTROL1, AUX_RX_TIMEOUT_LEN_MUL, mask_sh)\n\n#define AUX_SF(reg_name, field_name, post_fix)\\\n\t.field_name = reg_name ## __ ## field_name ## post_fix\n\nenum {\t \n\tAUX_TIMEOUT_PERIOD = 400,\n\n\t \n\tSW_AUX_TIMEOUT_PERIOD_MULTIPLIER = 6\n};\n\nstruct dce_aux {\n\tuint32_t inst;\n\tstruct ddc *ddc;\n\tstruct dc_context *ctx;\n\t \n\tuint32_t delay;\n\tuint32_t max_defer_write_retry;\n\n\tbool acquire_reset;\n\tstruct dce_aux_funcs *funcs;\n};\n\nstruct dce110_aux_registers_mask {\n\tDCE_AUX_REG_FIELD_LIST(uint32_t);\n};\n\nstruct dce110_aux_registers_shift {\n\tDCE_AUX_REG_FIELD_LIST(uint8_t);\n};\n\n\nstruct aux_engine_dce110 {\n\tstruct dce_aux base;\n\tconst struct dce110_aux_registers *regs;\n\tconst struct dce110_aux_registers_mask *mask;\n\tconst struct dce110_aux_registers_shift *shift;\n\tstruct {\n\t\tuint32_t aux_control;\n\t\tuint32_t aux_arb_control;\n\t\tuint32_t aux_sw_data;\n\t\tuint32_t aux_sw_control;\n\t\tuint32_t aux_interrupt_control;\n\t\tuint32_t aux_dphy_rx_control1;\n\t\tuint32_t aux_dphy_rx_control0;\n\t\tuint32_t aux_sw_status;\n\t} addr;\n\tuint32_t polling_timeout_period;\n};\n\nstruct aux_engine_dce110_init_data {\n\tuint32_t engine_id;\n\tuint32_t timeout_period;\n\tstruct dc_context *ctx;\n\tconst struct dce110_aux_registers *regs;\n};\n\nstruct dce_aux *dce110_aux_engine_construct(struct aux_engine_dce110 *aux_engine110,\n\t\tstruct dc_context *ctx,\n\t\tuint32_t inst,\n\t\tuint32_t timeout_period,\n\t\tconst struct dce110_aux_registers *regs,\n\n\t\tconst struct dce110_aux_registers_mask *mask,\n\t\tconst struct dce110_aux_registers_shift *shift,\n\t\tbool is_ext_aux_timeout_configurable);\n\nvoid dce110_engine_destroy(struct dce_aux **engine);\n\nbool dce110_aux_engine_acquire(\n\tstruct dce_aux *aux_engine,\n\tstruct ddc *ddc);\n\nint dce_aux_transfer_raw(struct ddc_service *ddc,\n\t\tstruct aux_payload *cmd,\n\t\tenum aux_return_code_type *operation_result);\n\nint dce_aux_transfer_dmub_raw(struct ddc_service *ddc,\n\t\tstruct aux_payload *payload,\n\t\tenum aux_return_code_type *operation_result);\nbool dce_aux_transfer_with_retries(struct ddc_service *ddc,\n\t\tstruct aux_payload *cmd);\n\nstruct dce_aux_funcs {\n\tuint32_t (*configure_timeout)\n\t\t(struct ddc_service *ddc,\n\t\t uint32_t timeout);\n\tvoid (*destroy)\n\t\t(struct aux_engine **ptr);\n};\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}