{
  "module_name": "command_table_helper.c",
  "hash_id": "aa649ca2ab198b53f2c1dfcc2e5d249cb8b0636ddc1b06a839f53bacb3becd96",
  "original_prompt": "Ingested from linux-6.6.14/drivers/gpu/drm/amd/display/dc/bios/command_table_helper.c",
  "human_readable_source": " \n\n#include \"dm_services.h\"\n\n#include \"atom.h\"\n\n#include \"include/bios_parser_types.h\"\n\n#include \"command_table_helper.h\"\n\nbool dal_bios_parser_init_cmd_tbl_helper(\n\tconst struct command_table_helper **h,\n\tenum dce_version dce)\n{\n\tswitch (dce) {\n#if defined(CONFIG_DRM_AMD_DC_SI)\n\tcase DCE_VERSION_6_0:\n\tcase DCE_VERSION_6_1:\n\tcase DCE_VERSION_6_4:\n\t\t*h = dal_cmd_tbl_helper_dce60_get_table();\n\t\treturn true;\n#endif\n\n\tcase DCE_VERSION_8_0:\n\tcase DCE_VERSION_8_1:\n\tcase DCE_VERSION_8_3:\n\t\t*h = dal_cmd_tbl_helper_dce80_get_table();\n\t\treturn true;\n\n\tcase DCE_VERSION_10_0:\n\t\t*h = dal_cmd_tbl_helper_dce110_get_table();\n\t\treturn true;\n\n\tcase DCE_VERSION_11_0:\n\t\t*h = dal_cmd_tbl_helper_dce110_get_table();\n\t\treturn true;\n\n\tcase DCE_VERSION_11_2:\n\tcase DCE_VERSION_11_22:\n\t\t*h = dal_cmd_tbl_helper_dce112_get_table();\n\t\treturn true;\n\n\tdefault:\n\t\t \n\t\tBREAK_TO_DEBUGGER();\n\t\treturn false;\n\t}\n}\n\n \n\nbool dal_cmd_table_helper_controller_id_to_atom(\n\tenum controller_id id,\n\tuint8_t *atom_id)\n{\n\tif (atom_id == NULL) {\n\t\tBREAK_TO_DEBUGGER();\n\t\treturn false;\n\t}\n\n\tswitch (id) {\n\tcase CONTROLLER_ID_D0:\n\t\t*atom_id = ATOM_CRTC1;\n\t\treturn true;\n\tcase CONTROLLER_ID_D1:\n\t\t*atom_id = ATOM_CRTC2;\n\t\treturn true;\n\tcase CONTROLLER_ID_D2:\n\t\t*atom_id = ATOM_CRTC3;\n\t\treturn true;\n\tcase CONTROLLER_ID_D3:\n\t\t*atom_id = ATOM_CRTC4;\n\t\treturn true;\n\tcase CONTROLLER_ID_D4:\n\t\t*atom_id = ATOM_CRTC5;\n\t\treturn true;\n\tcase CONTROLLER_ID_D5:\n\t\t*atom_id = ATOM_CRTC6;\n\t\treturn true;\n\tcase CONTROLLER_ID_UNDERLAY0:\n\t\t*atom_id = ATOM_UNDERLAY_PIPE0;\n\t\treturn true;\n\tcase CONTROLLER_ID_UNDEFINED:\n\t\t*atom_id = ATOM_CRTC_INVALID;\n\t\treturn true;\n\tdefault:\n\t\t \n\t\tBREAK_TO_DEBUGGER();\n\t\treturn false;\n\t}\n}\n\n \nuint8_t dal_cmd_table_helper_transmitter_bp_to_atom(\n\tenum transmitter t)\n{\n\tswitch (t) {\n\tcase TRANSMITTER_UNIPHY_A:\n\tcase TRANSMITTER_UNIPHY_B:\n\tcase TRANSMITTER_TRAVIS_LCD:\n\t\treturn 0;\n\tcase TRANSMITTER_UNIPHY_C:\n\tcase TRANSMITTER_UNIPHY_D:\n\t\treturn 1;\n\tcase TRANSMITTER_UNIPHY_E:\n\tcase TRANSMITTER_UNIPHY_F:\n\t\treturn 2;\n\tdefault:\n\t\t \n\t\tBREAK_TO_DEBUGGER();\n\t\treturn 0;\n\t}\n}\n\nuint32_t dal_cmd_table_helper_encoder_mode_bp_to_atom(\n\tenum signal_type s,\n\tbool enable_dp_audio)\n{\n\tswitch (s) {\n\tcase SIGNAL_TYPE_DVI_SINGLE_LINK:\n\tcase SIGNAL_TYPE_DVI_DUAL_LINK:\n\t\treturn ATOM_ENCODER_MODE_DVI;\n\tcase SIGNAL_TYPE_HDMI_TYPE_A:\n\t\treturn ATOM_ENCODER_MODE_HDMI;\n\tcase SIGNAL_TYPE_LVDS:\n\t\treturn ATOM_ENCODER_MODE_LVDS;\n\tcase SIGNAL_TYPE_EDP:\n\tcase SIGNAL_TYPE_DISPLAY_PORT_MST:\n\tcase SIGNAL_TYPE_DISPLAY_PORT:\n\tcase SIGNAL_TYPE_VIRTUAL:\n\t\tif (enable_dp_audio)\n\t\t\treturn ATOM_ENCODER_MODE_DP_AUDIO;\n\t\telse\n\t\t\treturn ATOM_ENCODER_MODE_DP;\n\tcase SIGNAL_TYPE_RGB:\n\t\treturn ATOM_ENCODER_MODE_CRT;\n\tdefault:\n\t\treturn ATOM_ENCODER_MODE_CRT;\n\t}\n}\n\nvoid dal_cmd_table_helper_assign_control_parameter(\n\tconst struct command_table_helper *h,\n\tstruct bp_encoder_control *control,\n\tDIG_ENCODER_CONTROL_PARAMETERS_V2 *ctrl_param)\n{\n\t \n\tif ((control->transmitter == TRANSMITTER_UNIPHY_B) ||\n\t\t(control->transmitter == TRANSMITTER_UNIPHY_D) ||\n\t\t(control->transmitter == TRANSMITTER_UNIPHY_F)) {\n\t\t \n\t\tctrl_param->acConfig.ucLinkSel = 1;\n\t}\n\n\t \n\tctrl_param->acConfig.ucTransmitterSel =\n\t\t(uint8_t)(h->transmitter_bp_to_atom(control->transmitter));\n\n\t \n\tctrl_param->ucAction = h->encoder_action_to_atom(control->action);\n\tctrl_param->usPixelClock = cpu_to_le16((uint16_t)(control->pixel_clock / 10));\n\tctrl_param->ucEncoderMode =\n\t\t(uint8_t)(h->encoder_mode_bp_to_atom(\n\t\t\tcontrol->signal, control->enable_dp_audio));\n\tctrl_param->ucLaneNum = (uint8_t)(control->lanes_number);\n}\n\nbool dal_cmd_table_helper_clock_source_id_to_ref_clk_src(\n\tenum clock_source_id id,\n\tuint32_t *ref_clk_src_id)\n{\n\tif (ref_clk_src_id == NULL) {\n\t\tBREAK_TO_DEBUGGER();\n\t\treturn false;\n\t}\n\n\tswitch (id) {\n\tcase CLOCK_SOURCE_ID_PLL1:\n\t\t*ref_clk_src_id = ENCODER_REFCLK_SRC_P1PLL;\n\t\treturn true;\n\tcase CLOCK_SOURCE_ID_PLL2:\n\t\t*ref_clk_src_id = ENCODER_REFCLK_SRC_P2PLL;\n\t\treturn true;\n\tcase CLOCK_SOURCE_ID_DCPLL:\n\t\t*ref_clk_src_id = ENCODER_REFCLK_SRC_DCPLL;\n\t\treturn true;\n\tcase CLOCK_SOURCE_ID_EXTERNAL:\n\t\t*ref_clk_src_id = ENCODER_REFCLK_SRC_EXTCLK;\n\t\treturn true;\n\tcase CLOCK_SOURCE_ID_UNDEFINED:\n\t\t*ref_clk_src_id = ENCODER_REFCLK_SRC_INVALID;\n\t\treturn true;\n\tdefault:\n\t\t \n\t\tBREAK_TO_DEBUGGER();\n\t\treturn false;\n\t}\n}\n\nuint8_t dal_cmd_table_helper_encoder_id_to_atom(\n\tenum encoder_id id)\n{\n\tswitch (id) {\n\tcase ENCODER_ID_INTERNAL_LVDS:\n\t\treturn ENCODER_OBJECT_ID_INTERNAL_LVDS;\n\tcase ENCODER_ID_INTERNAL_TMDS1:\n\t\treturn ENCODER_OBJECT_ID_INTERNAL_TMDS1;\n\tcase ENCODER_ID_INTERNAL_TMDS2:\n\t\treturn ENCODER_OBJECT_ID_INTERNAL_TMDS2;\n\tcase ENCODER_ID_INTERNAL_DAC1:\n\t\treturn ENCODER_OBJECT_ID_INTERNAL_DAC1;\n\tcase ENCODER_ID_INTERNAL_DAC2:\n\t\treturn ENCODER_OBJECT_ID_INTERNAL_DAC2;\n\tcase ENCODER_ID_INTERNAL_LVTM1:\n\t\treturn ENCODER_OBJECT_ID_INTERNAL_LVTM1;\n\tcase ENCODER_ID_INTERNAL_HDMI:\n\t\treturn ENCODER_OBJECT_ID_HDMI_INTERNAL;\n\tcase ENCODER_ID_EXTERNAL_TRAVIS:\n\t\treturn ENCODER_OBJECT_ID_TRAVIS;\n\tcase ENCODER_ID_EXTERNAL_NUTMEG:\n\t\treturn ENCODER_OBJECT_ID_NUTMEG;\n\tcase ENCODER_ID_INTERNAL_KLDSCP_TMDS1:\n\t\treturn ENCODER_OBJECT_ID_INTERNAL_KLDSCP_TMDS1;\n\tcase ENCODER_ID_INTERNAL_KLDSCP_DAC1:\n\t\treturn ENCODER_OBJECT_ID_INTERNAL_KLDSCP_DAC1;\n\tcase ENCODER_ID_INTERNAL_KLDSCP_DAC2:\n\t\treturn ENCODER_OBJECT_ID_INTERNAL_KLDSCP_DAC2;\n\tcase ENCODER_ID_EXTERNAL_MVPU_FPGA:\n\t\treturn ENCODER_OBJECT_ID_MVPU_FPGA;\n\tcase ENCODER_ID_INTERNAL_DDI:\n\t\treturn ENCODER_OBJECT_ID_INTERNAL_DDI;\n\tcase ENCODER_ID_INTERNAL_UNIPHY:\n\t\treturn ENCODER_OBJECT_ID_INTERNAL_UNIPHY;\n\tcase ENCODER_ID_INTERNAL_KLDSCP_LVTMA:\n\t\treturn ENCODER_OBJECT_ID_INTERNAL_KLDSCP_LVTMA;\n\tcase ENCODER_ID_INTERNAL_UNIPHY1:\n\t\treturn ENCODER_OBJECT_ID_INTERNAL_UNIPHY1;\n\tcase ENCODER_ID_INTERNAL_UNIPHY2:\n\t\treturn ENCODER_OBJECT_ID_INTERNAL_UNIPHY2;\n\tcase ENCODER_ID_INTERNAL_UNIPHY3:\n\t\treturn ENCODER_OBJECT_ID_INTERNAL_UNIPHY3;\n\tcase ENCODER_ID_INTERNAL_WIRELESS:\n\t\treturn ENCODER_OBJECT_ID_INTERNAL_VCE;\n\tcase ENCODER_ID_UNKNOWN:\n\t\treturn ENCODER_OBJECT_ID_NONE;\n\tdefault:\n\t\t \n\t\tBREAK_TO_DEBUGGER();\n\t\treturn ENCODER_OBJECT_ID_NONE;\n\t}\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}