{
  "module_name": "dcn20_hubp.c",
  "hash_id": "92a14db525cd19a40b8f32211bc02682be440bc3b39caa31c6363e3b4aa53a30",
  "original_prompt": "Ingested from linux-6.6.14/drivers/gpu/drm/amd/display/dc/dcn20/dcn20_hubp.c",
  "human_readable_source": " \n\n#include \"dcn20_hubp.h\"\n\n#include \"dm_services.h\"\n#include \"dce_calcs.h\"\n#include \"reg_helper.h\"\n#include \"basics/conversion.h\"\n\n#define DC_LOGGER_INIT(logger)\n\n#define REG(reg)\\\n\thubp2->hubp_regs->reg\n\n#define CTX \\\n\thubp2->base.ctx\n\n#undef FN\n#define FN(reg_name, field_name) \\\n\thubp2->hubp_shift->field_name, hubp2->hubp_mask->field_name\n\nvoid hubp2_set_vm_system_aperture_settings(struct hubp *hubp,\n\t\tstruct vm_system_aperture_param *apt)\n{\n\tstruct dcn20_hubp *hubp2 = TO_DCN20_HUBP(hubp);\n\n\tPHYSICAL_ADDRESS_LOC mc_vm_apt_default;\n\tPHYSICAL_ADDRESS_LOC mc_vm_apt_low;\n\tPHYSICAL_ADDRESS_LOC mc_vm_apt_high;\n\n\t\n\tmc_vm_apt_default.quad_part = apt->sys_default.quad_part >> 12;\n\n\t\n\tmc_vm_apt_low.quad_part = apt->sys_low.quad_part >> 18;\n\tmc_vm_apt_high.quad_part = apt->sys_high.quad_part >> 18;\n\n\tREG_UPDATE_2(DCN_VM_SYSTEM_APERTURE_DEFAULT_ADDR_MSB,\n\t\tDCN_VM_SYSTEM_APERTURE_DEFAULT_SYSTEM, 1,  \n\t\tDCN_VM_SYSTEM_APERTURE_DEFAULT_ADDR_MSB, mc_vm_apt_default.high_part);\n\n\tREG_SET(DCN_VM_SYSTEM_APERTURE_DEFAULT_ADDR_LSB, 0,\n\t\t\tDCN_VM_SYSTEM_APERTURE_DEFAULT_ADDR_LSB, mc_vm_apt_default.low_part);\n\n\tREG_SET(DCN_VM_SYSTEM_APERTURE_LOW_ADDR, 0,\n\t\t\tMC_VM_SYSTEM_APERTURE_LOW_ADDR, mc_vm_apt_low.quad_part);\n\n\tREG_SET(DCN_VM_SYSTEM_APERTURE_HIGH_ADDR, 0,\n\t\t\tMC_VM_SYSTEM_APERTURE_HIGH_ADDR, mc_vm_apt_high.quad_part);\n\n\tREG_SET_2(DCN_VM_MX_L1_TLB_CNTL, 0,\n\t\t\tENABLE_L1_TLB, 1,\n\t\t\tSYSTEM_ACCESS_MODE, 0x3);\n}\n\nvoid hubp2_program_deadline(\n\t\tstruct hubp *hubp,\n\t\tstruct _vcs_dpi_display_dlg_regs_st *dlg_attr,\n\t\tstruct _vcs_dpi_display_ttu_regs_st *ttu_attr)\n{\n\tstruct dcn20_hubp *hubp2 = TO_DCN20_HUBP(hubp);\n\n\t \n\tREG_SET_2(BLANK_OFFSET_0, 0,\n\t\tREFCYC_H_BLANK_END, dlg_attr->refcyc_h_blank_end,\n\t\tDLG_V_BLANK_END, dlg_attr->dlg_vblank_end);\n\n\tREG_SET(BLANK_OFFSET_1, 0,\n\t\tMIN_DST_Y_NEXT_START, dlg_attr->min_dst_y_next_start);\n\n\tREG_SET(DST_DIMENSIONS, 0,\n\t\tREFCYC_PER_HTOTAL, dlg_attr->refcyc_per_htotal);\n\n\tREG_SET_2(DST_AFTER_SCALER, 0,\n\t\tREFCYC_X_AFTER_SCALER, dlg_attr->refcyc_x_after_scaler,\n\t\tDST_Y_AFTER_SCALER, dlg_attr->dst_y_after_scaler);\n\n\tREG_SET(REF_FREQ_TO_PIX_FREQ, 0,\n\t\tREF_FREQ_TO_PIX_FREQ, dlg_attr->ref_freq_to_pix_freq);\n\n\t \n\tREG_SET(VBLANK_PARAMETERS_1, 0,\n\t\tREFCYC_PER_PTE_GROUP_VBLANK_L, dlg_attr->refcyc_per_pte_group_vblank_l);\n\n\tif (REG(NOM_PARAMETERS_0))\n\t\tREG_SET(NOM_PARAMETERS_0, 0,\n\t\t\tDST_Y_PER_PTE_ROW_NOM_L, dlg_attr->dst_y_per_pte_row_nom_l);\n\n\tif (REG(NOM_PARAMETERS_1))\n\t\tREG_SET(NOM_PARAMETERS_1, 0,\n\t\t\tREFCYC_PER_PTE_GROUP_NOM_L, dlg_attr->refcyc_per_pte_group_nom_l);\n\n\tREG_SET(NOM_PARAMETERS_4, 0,\n\t\tDST_Y_PER_META_ROW_NOM_L, dlg_attr->dst_y_per_meta_row_nom_l);\n\n\tREG_SET(NOM_PARAMETERS_5, 0,\n\t\tREFCYC_PER_META_CHUNK_NOM_L, dlg_attr->refcyc_per_meta_chunk_nom_l);\n\n\tREG_SET_2(PER_LINE_DELIVERY, 0,\n\t\tREFCYC_PER_LINE_DELIVERY_L, dlg_attr->refcyc_per_line_delivery_l,\n\t\tREFCYC_PER_LINE_DELIVERY_C, dlg_attr->refcyc_per_line_delivery_c);\n\n\tREG_SET(VBLANK_PARAMETERS_2, 0,\n\t\tREFCYC_PER_PTE_GROUP_VBLANK_C, dlg_attr->refcyc_per_pte_group_vblank_c);\n\n\tif (REG(NOM_PARAMETERS_2))\n\t\tREG_SET(NOM_PARAMETERS_2, 0,\n\t\t\tDST_Y_PER_PTE_ROW_NOM_C, dlg_attr->dst_y_per_pte_row_nom_c);\n\n\tif (REG(NOM_PARAMETERS_3))\n\t\tREG_SET(NOM_PARAMETERS_3, 0,\n\t\t\tREFCYC_PER_PTE_GROUP_NOM_C, dlg_attr->refcyc_per_pte_group_nom_c);\n\n\tREG_SET(NOM_PARAMETERS_6, 0,\n\t\tDST_Y_PER_META_ROW_NOM_C, dlg_attr->dst_y_per_meta_row_nom_c);\n\n\tREG_SET(NOM_PARAMETERS_7, 0,\n\t\tREFCYC_PER_META_CHUNK_NOM_C, dlg_attr->refcyc_per_meta_chunk_nom_c);\n\n\t \n\tREG_SET_2(DCN_TTU_QOS_WM, 0,\n\t\tQoS_LEVEL_LOW_WM, ttu_attr->qos_level_low_wm,\n\t\tQoS_LEVEL_HIGH_WM, ttu_attr->qos_level_high_wm);\n\n\t \n\t \n\n\tREG_SET_3(DCN_SURF0_TTU_CNTL0, 0,\n\t\tREFCYC_PER_REQ_DELIVERY, ttu_attr->refcyc_per_req_delivery_l,\n\t\tQoS_LEVEL_FIXED, ttu_attr->qos_level_fixed_l,\n\t\tQoS_RAMP_DISABLE, ttu_attr->qos_ramp_disable_l);\n\n\tREG_SET_3(DCN_SURF1_TTU_CNTL0, 0,\n\t\tREFCYC_PER_REQ_DELIVERY, ttu_attr->refcyc_per_req_delivery_c,\n\t\tQoS_LEVEL_FIXED, ttu_attr->qos_level_fixed_c,\n\t\tQoS_RAMP_DISABLE, ttu_attr->qos_ramp_disable_c);\n\n\tREG_SET_3(DCN_CUR0_TTU_CNTL0, 0,\n\t\tREFCYC_PER_REQ_DELIVERY, ttu_attr->refcyc_per_req_delivery_cur0,\n\t\tQoS_LEVEL_FIXED, ttu_attr->qos_level_fixed_cur0,\n\t\tQoS_RAMP_DISABLE, ttu_attr->qos_ramp_disable_cur0);\n\n\tREG_SET(FLIP_PARAMETERS_1, 0,\n\t\tREFCYC_PER_PTE_GROUP_FLIP_L, dlg_attr->refcyc_per_pte_group_flip_l);\n}\n\nvoid hubp2_vready_at_or_After_vsync(struct hubp *hubp,\n\t\tstruct _vcs_dpi_display_pipe_dest_params_st *pipe_dest)\n{\n\tuint32_t value = 0;\n\tstruct dcn20_hubp *hubp2 = TO_DCN20_HUBP(hubp);\n\t \n\tREG_WRITE(HUBPREQ_DEBUG_DB, 1 << 8);\n\t \n\tif (pipe_dest->htotal != 0) {\n\t\tif ((pipe_dest->vstartup_start - (pipe_dest->vready_offset+pipe_dest->vupdate_width\n\t\t\t+ pipe_dest->vupdate_offset) / pipe_dest->htotal) <= pipe_dest->vblank_end) {\n\t\t\tvalue = 1;\n\t\t} else\n\t\t\tvalue = 0;\n\t}\n\n\tREG_UPDATE(DCHUBP_CNTL, HUBP_VREADY_AT_OR_AFTER_VSYNC, value);\n}\n\nstatic void hubp2_program_requestor(struct hubp *hubp,\n\t\t\t\t    struct _vcs_dpi_display_rq_regs_st *rq_regs)\n{\n\tstruct dcn20_hubp *hubp2 = TO_DCN20_HUBP(hubp);\n\n\tREG_UPDATE(HUBPRET_CONTROL,\n\t\t\tDET_BUF_PLANE1_BASE_ADDRESS, rq_regs->plane1_base_address);\n\tREG_SET_4(DCN_EXPANSION_MODE, 0,\n\t\t\tDRQ_EXPANSION_MODE, rq_regs->drq_expansion_mode,\n\t\t\tPRQ_EXPANSION_MODE, rq_regs->prq_expansion_mode,\n\t\t\tMRQ_EXPANSION_MODE, rq_regs->mrq_expansion_mode,\n\t\t\tCRQ_EXPANSION_MODE, rq_regs->crq_expansion_mode);\n\tREG_SET_8(DCHUBP_REQ_SIZE_CONFIG, 0,\n\t\tCHUNK_SIZE, rq_regs->rq_regs_l.chunk_size,\n\t\tMIN_CHUNK_SIZE, rq_regs->rq_regs_l.min_chunk_size,\n\t\tMETA_CHUNK_SIZE, rq_regs->rq_regs_l.meta_chunk_size,\n\t\tMIN_META_CHUNK_SIZE, rq_regs->rq_regs_l.min_meta_chunk_size,\n\t\tDPTE_GROUP_SIZE, rq_regs->rq_regs_l.dpte_group_size,\n\t\tMPTE_GROUP_SIZE, rq_regs->rq_regs_l.mpte_group_size,\n\t\tSWATH_HEIGHT, rq_regs->rq_regs_l.swath_height,\n\t\tPTE_ROW_HEIGHT_LINEAR, rq_regs->rq_regs_l.pte_row_height_linear);\n\tREG_SET_8(DCHUBP_REQ_SIZE_CONFIG_C, 0,\n\t\tCHUNK_SIZE_C, rq_regs->rq_regs_c.chunk_size,\n\t\tMIN_CHUNK_SIZE_C, rq_regs->rq_regs_c.min_chunk_size,\n\t\tMETA_CHUNK_SIZE_C, rq_regs->rq_regs_c.meta_chunk_size,\n\t\tMIN_META_CHUNK_SIZE_C, rq_regs->rq_regs_c.min_meta_chunk_size,\n\t\tDPTE_GROUP_SIZE_C, rq_regs->rq_regs_c.dpte_group_size,\n\t\tMPTE_GROUP_SIZE_C, rq_regs->rq_regs_c.mpte_group_size,\n\t\tSWATH_HEIGHT_C, rq_regs->rq_regs_c.swath_height,\n\t\tPTE_ROW_HEIGHT_LINEAR_C, rq_regs->rq_regs_c.pte_row_height_linear);\n}\n\nstatic void hubp2_setup(\n\t\tstruct hubp *hubp,\n\t\tstruct _vcs_dpi_display_dlg_regs_st *dlg_attr,\n\t\tstruct _vcs_dpi_display_ttu_regs_st *ttu_attr,\n\t\tstruct _vcs_dpi_display_rq_regs_st *rq_regs,\n\t\tstruct _vcs_dpi_display_pipe_dest_params_st *pipe_dest)\n{\n\t \n\n\thubp2_vready_at_or_After_vsync(hubp, pipe_dest);\n\thubp2_program_requestor(hubp, rq_regs);\n\thubp2_program_deadline(hubp, dlg_attr, ttu_attr);\n\n}\n\nvoid hubp2_setup_interdependent(\n\t\tstruct hubp *hubp,\n\t\tstruct _vcs_dpi_display_dlg_regs_st *dlg_attr,\n\t\tstruct _vcs_dpi_display_ttu_regs_st *ttu_attr)\n{\n\tstruct dcn20_hubp *hubp2 = TO_DCN20_HUBP(hubp);\n\n\tREG_SET_2(PREFETCH_SETTINGS, 0,\n\t\t\tDST_Y_PREFETCH, dlg_attr->dst_y_prefetch,\n\t\t\tVRATIO_PREFETCH, dlg_attr->vratio_prefetch);\n\n\tREG_SET(PREFETCH_SETTINGS_C, 0,\n\t\t\tVRATIO_PREFETCH_C, dlg_attr->vratio_prefetch_c);\n\n\tREG_SET_2(VBLANK_PARAMETERS_0, 0,\n\t\tDST_Y_PER_VM_VBLANK, dlg_attr->dst_y_per_vm_vblank,\n\t\tDST_Y_PER_ROW_VBLANK, dlg_attr->dst_y_per_row_vblank);\n\n\tREG_SET_2(FLIP_PARAMETERS_0, 0,\n\t\tDST_Y_PER_VM_FLIP, dlg_attr->dst_y_per_vm_flip,\n\t\tDST_Y_PER_ROW_FLIP, dlg_attr->dst_y_per_row_flip);\n\n\tREG_SET(VBLANK_PARAMETERS_3, 0,\n\t\tREFCYC_PER_META_CHUNK_VBLANK_L, dlg_attr->refcyc_per_meta_chunk_vblank_l);\n\n\tREG_SET(VBLANK_PARAMETERS_4, 0,\n\t\tREFCYC_PER_META_CHUNK_VBLANK_C, dlg_attr->refcyc_per_meta_chunk_vblank_c);\n\n\tREG_SET(FLIP_PARAMETERS_2, 0,\n\t\tREFCYC_PER_META_CHUNK_FLIP_L, dlg_attr->refcyc_per_meta_chunk_flip_l);\n\n\tREG_SET_2(PER_LINE_DELIVERY_PRE, 0,\n\t\tREFCYC_PER_LINE_DELIVERY_PRE_L, dlg_attr->refcyc_per_line_delivery_pre_l,\n\t\tREFCYC_PER_LINE_DELIVERY_PRE_C, dlg_attr->refcyc_per_line_delivery_pre_c);\n\n\tREG_SET(DCN_SURF0_TTU_CNTL1, 0,\n\t\tREFCYC_PER_REQ_DELIVERY_PRE,\n\t\tttu_attr->refcyc_per_req_delivery_pre_l);\n\tREG_SET(DCN_SURF1_TTU_CNTL1, 0,\n\t\tREFCYC_PER_REQ_DELIVERY_PRE,\n\t\tttu_attr->refcyc_per_req_delivery_pre_c);\n\tREG_SET(DCN_CUR0_TTU_CNTL1, 0,\n\t\tREFCYC_PER_REQ_DELIVERY_PRE, ttu_attr->refcyc_per_req_delivery_pre_cur0);\n\tREG_SET(DCN_CUR1_TTU_CNTL1, 0,\n\t\tREFCYC_PER_REQ_DELIVERY_PRE, ttu_attr->refcyc_per_req_delivery_pre_cur1);\n\n\tREG_SET_2(DCN_GLOBAL_TTU_CNTL, 0,\n\t\tMIN_TTU_VBLANK, ttu_attr->min_ttu_vblank,\n\t\tQoS_LEVEL_FLIP, ttu_attr->qos_level_flip);\n}\n\n \nstatic void hubp2_program_tiling(\n\tstruct dcn20_hubp *hubp2,\n\tconst union dc_tiling_info *info,\n\tconst enum surface_pixel_format pixel_format)\n{\n\tREG_UPDATE_3(DCSURF_ADDR_CONFIG,\n\t\t\tNUM_PIPES, log_2(info->gfx9.num_pipes),\n\t\t\tPIPE_INTERLEAVE, info->gfx9.pipe_interleave,\n\t\t\tMAX_COMPRESSED_FRAGS, log_2(info->gfx9.max_compressed_frags));\n\n\tREG_UPDATE_4(DCSURF_TILING_CONFIG,\n\t\t\tSW_MODE, info->gfx9.swizzle,\n\t\t\tMETA_LINEAR, 0,\n\t\t\tRB_ALIGNED, 0,\n\t\t\tPIPE_ALIGNED, 0);\n}\n\nvoid hubp2_program_size(\n\tstruct hubp *hubp,\n\tenum surface_pixel_format format,\n\tconst struct plane_size *plane_size,\n\tstruct dc_plane_dcc_param *dcc)\n{\n\tstruct dcn20_hubp *hubp2 = TO_DCN20_HUBP(hubp);\n\tuint32_t pitch, meta_pitch, pitch_c, meta_pitch_c;\n\tbool use_pitch_c = false;\n\n\t \n\tuse_pitch_c = format >= SURFACE_PIXEL_FORMAT_VIDEO_BEGIN\n\t\t&& format < SURFACE_PIXEL_FORMAT_SUBSAMPLE_END;\n\tuse_pitch_c = use_pitch_c\n\t\t|| (format == SURFACE_PIXEL_FORMAT_GRPH_RGBE_ALPHA);\n\tif (use_pitch_c) {\n\t\tASSERT(plane_size->chroma_pitch != 0);\n\t\t \n\n\t\tpitch = plane_size->surface_pitch - 1;\n\t\tmeta_pitch = dcc->meta_pitch - 1;\n\t\tpitch_c = plane_size->chroma_pitch - 1;\n\t\tmeta_pitch_c = dcc->meta_pitch_c - 1;\n\t} else {\n\t\tpitch = plane_size->surface_pitch - 1;\n\t\tmeta_pitch = dcc->meta_pitch - 1;\n\t\tpitch_c = 0;\n\t\tmeta_pitch_c = 0;\n\t}\n\n\tif (!dcc->enable) {\n\t\tmeta_pitch = 0;\n\t\tmeta_pitch_c = 0;\n\t}\n\n\tREG_UPDATE_2(DCSURF_SURFACE_PITCH,\n\t\t\tPITCH, pitch, META_PITCH, meta_pitch);\n\n\tuse_pitch_c = format >= SURFACE_PIXEL_FORMAT_VIDEO_BEGIN;\n\tuse_pitch_c = use_pitch_c\n\t\t|| (format == SURFACE_PIXEL_FORMAT_GRPH_RGBE_ALPHA);\n\tif (use_pitch_c)\n\t\tREG_UPDATE_2(DCSURF_SURFACE_PITCH_C,\n\t\t\tPITCH_C, pitch_c, META_PITCH_C, meta_pitch_c);\n}\n\nvoid hubp2_program_rotation(\n\tstruct hubp *hubp,\n\tenum dc_rotation_angle rotation,\n\tbool horizontal_mirror)\n{\n\tstruct dcn20_hubp *hubp2 = TO_DCN20_HUBP(hubp);\n\tuint32_t mirror;\n\n\n\tif (horizontal_mirror)\n\t\tmirror = 1;\n\telse\n\t\tmirror = 0;\n\n\t \n\tif (rotation == ROTATION_ANGLE_0)\n\t\tREG_UPDATE_2(DCSURF_SURFACE_CONFIG,\n\t\t\t\tROTATION_ANGLE, 0,\n\t\t\t\tH_MIRROR_EN, mirror);\n\telse if (rotation == ROTATION_ANGLE_90)\n\t\tREG_UPDATE_2(DCSURF_SURFACE_CONFIG,\n\t\t\t\tROTATION_ANGLE, 1,\n\t\t\t\tH_MIRROR_EN, mirror);\n\telse if (rotation == ROTATION_ANGLE_180)\n\t\tREG_UPDATE_2(DCSURF_SURFACE_CONFIG,\n\t\t\t\tROTATION_ANGLE, 2,\n\t\t\t\tH_MIRROR_EN, mirror);\n\telse if (rotation == ROTATION_ANGLE_270)\n\t\tREG_UPDATE_2(DCSURF_SURFACE_CONFIG,\n\t\t\t\tROTATION_ANGLE, 3,\n\t\t\t\tH_MIRROR_EN, mirror);\n}\n\nvoid hubp2_dcc_control(struct hubp *hubp, bool enable,\n\t\tenum hubp_ind_block_size independent_64b_blks)\n{\n\tuint32_t dcc_en = enable ? 1 : 0;\n\tuint32_t dcc_ind_64b_blk = independent_64b_blks ? 1 : 0;\n\tstruct dcn20_hubp *hubp2 = TO_DCN20_HUBP(hubp);\n\n\tREG_UPDATE_4(DCSURF_SURFACE_CONTROL,\n\t\t\tPRIMARY_SURFACE_DCC_EN, dcc_en,\n\t\t\tPRIMARY_SURFACE_DCC_IND_64B_BLK, dcc_ind_64b_blk,\n\t\t\tSECONDARY_SURFACE_DCC_EN, dcc_en,\n\t\t\tSECONDARY_SURFACE_DCC_IND_64B_BLK, dcc_ind_64b_blk);\n}\n\nvoid hubp2_program_pixel_format(\n\tstruct hubp *hubp,\n\tenum surface_pixel_format format)\n{\n\tstruct dcn20_hubp *hubp2 = TO_DCN20_HUBP(hubp);\n\tuint32_t red_bar = 3;\n\tuint32_t blue_bar = 2;\n\n\t \n\tif (format == SURFACE_PIXEL_FORMAT_GRPH_ABGR8888\n\t\t\t|| format == SURFACE_PIXEL_FORMAT_GRPH_ABGR2101010\n\t\t\t|| format == SURFACE_PIXEL_FORMAT_GRPH_ABGR2101010_XR_BIAS\n\t\t\t|| format == SURFACE_PIXEL_FORMAT_GRPH_ABGR16161616\n\t\t\t|| format == SURFACE_PIXEL_FORMAT_GRPH_ABGR16161616F) {\n\t\tred_bar = 2;\n\t\tblue_bar = 3;\n\t}\n\n\tREG_UPDATE_2(HUBPRET_CONTROL,\n\t\t\tCROSSBAR_SRC_CB_B, blue_bar,\n\t\t\tCROSSBAR_SRC_CR_R, red_bar);\n\n\t \n\n\tswitch (format)\t{\n\tcase SURFACE_PIXEL_FORMAT_GRPH_ARGB1555:\n\t\tREG_UPDATE(DCSURF_SURFACE_CONFIG,\n\t\t\t\tSURFACE_PIXEL_FORMAT, 1);\n\t\tbreak;\n\tcase SURFACE_PIXEL_FORMAT_GRPH_RGB565:\n\t\tREG_UPDATE(DCSURF_SURFACE_CONFIG,\n\t\t\t\tSURFACE_PIXEL_FORMAT, 3);\n\t\tbreak;\n\tcase SURFACE_PIXEL_FORMAT_GRPH_ARGB8888:\n\tcase SURFACE_PIXEL_FORMAT_GRPH_ABGR8888:\n\t\tREG_UPDATE(DCSURF_SURFACE_CONFIG,\n\t\t\t\tSURFACE_PIXEL_FORMAT, 8);\n\t\tbreak;\n\tcase SURFACE_PIXEL_FORMAT_GRPH_ARGB2101010:\n\tcase SURFACE_PIXEL_FORMAT_GRPH_ABGR2101010:\n\tcase SURFACE_PIXEL_FORMAT_GRPH_ABGR2101010_XR_BIAS:\n\t\tREG_UPDATE(DCSURF_SURFACE_CONFIG,\n\t\t\t\tSURFACE_PIXEL_FORMAT, 10);\n\t\tbreak;\n\tcase SURFACE_PIXEL_FORMAT_GRPH_ARGB16161616:\n\tcase SURFACE_PIXEL_FORMAT_GRPH_ABGR16161616:  \n\t\tREG_UPDATE(DCSURF_SURFACE_CONFIG,\n\t\t\t\tSURFACE_PIXEL_FORMAT, 26);  \n\t\tbreak;\n\tcase SURFACE_PIXEL_FORMAT_GRPH_ARGB16161616F:\n\tcase SURFACE_PIXEL_FORMAT_GRPH_ABGR16161616F: \n\t\tREG_UPDATE(DCSURF_SURFACE_CONFIG,\n\t\t\t\tSURFACE_PIXEL_FORMAT, 24);\n\t\tbreak;\n\n\tcase SURFACE_PIXEL_FORMAT_VIDEO_420_YCbCr:\n\t\tREG_UPDATE(DCSURF_SURFACE_CONFIG,\n\t\t\t\tSURFACE_PIXEL_FORMAT, 65);\n\t\tbreak;\n\tcase SURFACE_PIXEL_FORMAT_VIDEO_420_YCrCb:\n\t\tREG_UPDATE(DCSURF_SURFACE_CONFIG,\n\t\t\t\tSURFACE_PIXEL_FORMAT, 64);\n\t\tbreak;\n\tcase SURFACE_PIXEL_FORMAT_VIDEO_420_10bpc_YCbCr:\n\t\tREG_UPDATE(DCSURF_SURFACE_CONFIG,\n\t\t\t\tSURFACE_PIXEL_FORMAT, 67);\n\t\tbreak;\n\tcase SURFACE_PIXEL_FORMAT_VIDEO_420_10bpc_YCrCb:\n\t\tREG_UPDATE(DCSURF_SURFACE_CONFIG,\n\t\t\t\tSURFACE_PIXEL_FORMAT, 66);\n\t\tbreak;\n\tcase SURFACE_PIXEL_FORMAT_VIDEO_AYCrCb8888:\n\t\tREG_UPDATE(DCSURF_SURFACE_CONFIG,\n\t\t\t\tSURFACE_PIXEL_FORMAT, 12);\n\t\tbreak;\n\tcase SURFACE_PIXEL_FORMAT_GRPH_RGB111110_FIX:\n\t\tREG_UPDATE(DCSURF_SURFACE_CONFIG,\n\t\t\t\tSURFACE_PIXEL_FORMAT, 112);\n\t\tbreak;\n\tcase SURFACE_PIXEL_FORMAT_GRPH_BGR101111_FIX:\n\t\tREG_UPDATE(DCSURF_SURFACE_CONFIG,\n\t\t\t\tSURFACE_PIXEL_FORMAT, 113);\n\t\tbreak;\n\tcase SURFACE_PIXEL_FORMAT_VIDEO_ACrYCb2101010:\n\t\tREG_UPDATE(DCSURF_SURFACE_CONFIG,\n\t\t\t\tSURFACE_PIXEL_FORMAT, 114);\n\t\tbreak;\n\tcase SURFACE_PIXEL_FORMAT_GRPH_RGB111110_FLOAT:\n\t\tREG_UPDATE(DCSURF_SURFACE_CONFIG,\n\t\t\t\tSURFACE_PIXEL_FORMAT, 118);\n\t\tbreak;\n\tcase SURFACE_PIXEL_FORMAT_GRPH_BGR101111_FLOAT:\n\t\tREG_UPDATE(DCSURF_SURFACE_CONFIG,\n\t\t\t\tSURFACE_PIXEL_FORMAT, 119);\n\t\tbreak;\n\tcase SURFACE_PIXEL_FORMAT_GRPH_RGBE:\n\t\tREG_UPDATE_2(DCSURF_SURFACE_CONFIG,\n\t\t\t\tSURFACE_PIXEL_FORMAT, 116,\n\t\t\t\tALPHA_PLANE_EN, 0);\n\t\tbreak;\n\tcase SURFACE_PIXEL_FORMAT_GRPH_RGBE_ALPHA:\n\t\tREG_UPDATE_2(DCSURF_SURFACE_CONFIG,\n\t\t\t\tSURFACE_PIXEL_FORMAT, 116,\n\t\t\t\tALPHA_PLANE_EN, 1);\n\t\tbreak;\n\tdefault:\n\t\tBREAK_TO_DEBUGGER();\n\t\tbreak;\n\t}\n\n\t \n}\n\nvoid hubp2_program_surface_config(\n\tstruct hubp *hubp,\n\tenum surface_pixel_format format,\n\tunion dc_tiling_info *tiling_info,\n\tstruct plane_size *plane_size,\n\tenum dc_rotation_angle rotation,\n\tstruct dc_plane_dcc_param *dcc,\n\tbool horizontal_mirror,\n\tunsigned int compat_level)\n{\n\tstruct dcn20_hubp *hubp2 = TO_DCN20_HUBP(hubp);\n\n\thubp2_dcc_control(hubp, dcc->enable, dcc->independent_64b_blks);\n\thubp2_program_tiling(hubp2, tiling_info, format);\n\thubp2_program_size(hubp, format, plane_size, dcc);\n\thubp2_program_rotation(hubp, rotation, horizontal_mirror);\n\thubp2_program_pixel_format(hubp, format);\n}\n\nenum cursor_lines_per_chunk hubp2_get_lines_per_chunk(\n\tunsigned int cursor_width,\n\tenum dc_cursor_color_format cursor_mode)\n{\n\tenum cursor_lines_per_chunk line_per_chunk = CURSOR_LINE_PER_CHUNK_16;\n\n\tif (cursor_mode == CURSOR_MODE_MONO)\n\t\tline_per_chunk = CURSOR_LINE_PER_CHUNK_16;\n\telse if (cursor_mode == CURSOR_MODE_COLOR_1BIT_AND ||\n\t\t cursor_mode == CURSOR_MODE_COLOR_PRE_MULTIPLIED_ALPHA ||\n\t\t cursor_mode == CURSOR_MODE_COLOR_UN_PRE_MULTIPLIED_ALPHA) {\n\t\tif (cursor_width >= 1   && cursor_width <= 32)\n\t\t\tline_per_chunk = CURSOR_LINE_PER_CHUNK_16;\n\t\telse if (cursor_width >= 33  && cursor_width <= 64)\n\t\t\tline_per_chunk = CURSOR_LINE_PER_CHUNK_8;\n\t\telse if (cursor_width >= 65  && cursor_width <= 128)\n\t\t\tline_per_chunk = CURSOR_LINE_PER_CHUNK_4;\n\t\telse if (cursor_width >= 129 && cursor_width <= 256)\n\t\t\tline_per_chunk = CURSOR_LINE_PER_CHUNK_2;\n\t} else if (cursor_mode == CURSOR_MODE_COLOR_64BIT_FP_PRE_MULTIPLIED ||\n\t\t   cursor_mode == CURSOR_MODE_COLOR_64BIT_FP_UN_PRE_MULTIPLIED) {\n\t\tif (cursor_width >= 1   && cursor_width <= 16)\n\t\t\tline_per_chunk = CURSOR_LINE_PER_CHUNK_16;\n\t\telse if (cursor_width >= 17  && cursor_width <= 32)\n\t\t\tline_per_chunk = CURSOR_LINE_PER_CHUNK_8;\n\t\telse if (cursor_width >= 33  && cursor_width <= 64)\n\t\t\tline_per_chunk = CURSOR_LINE_PER_CHUNK_4;\n\t\telse if (cursor_width >= 65 && cursor_width <= 128)\n\t\t\tline_per_chunk = CURSOR_LINE_PER_CHUNK_2;\n\t\telse if (cursor_width >= 129 && cursor_width <= 256)\n\t\t\tline_per_chunk = CURSOR_LINE_PER_CHUNK_1;\n\t}\n\n\treturn line_per_chunk;\n}\n\nvoid hubp2_cursor_set_attributes(\n\t\tstruct hubp *hubp,\n\t\tconst struct dc_cursor_attributes *attr)\n{\n\tstruct dcn20_hubp *hubp2 = TO_DCN20_HUBP(hubp);\n\tenum cursor_pitch hw_pitch = hubp1_get_cursor_pitch(attr->pitch);\n\tenum cursor_lines_per_chunk lpc = hubp2_get_lines_per_chunk(\n\t\t\tattr->width, attr->color_format);\n\n\thubp->curs_attr = *attr;\n\n\tREG_UPDATE(CURSOR_SURFACE_ADDRESS_HIGH,\n\t\t\tCURSOR_SURFACE_ADDRESS_HIGH, attr->address.high_part);\n\tREG_UPDATE(CURSOR_SURFACE_ADDRESS,\n\t\t\tCURSOR_SURFACE_ADDRESS, attr->address.low_part);\n\n\tREG_UPDATE_2(CURSOR_SIZE,\n\t\t\tCURSOR_WIDTH, attr->width,\n\t\t\tCURSOR_HEIGHT, attr->height);\n\n\tREG_UPDATE_4(CURSOR_CONTROL,\n\t\t\tCURSOR_MODE, attr->color_format,\n\t\t\tCURSOR_2X_MAGNIFY, attr->attribute_flags.bits.ENABLE_MAGNIFICATION,\n\t\t\tCURSOR_PITCH, hw_pitch,\n\t\t\tCURSOR_LINES_PER_CHUNK, lpc);\n\n\tREG_SET_2(CURSOR_SETTINGS, 0,\n\t\t\t \n\t\t\tCURSOR0_DST_Y_OFFSET, 0,\n\t\t\t  \n\t\t\tCURSOR0_CHUNK_HDL_ADJUST, 3);\n\n\thubp->att.SURFACE_ADDR_HIGH  = attr->address.high_part;\n\thubp->att.SURFACE_ADDR       = attr->address.low_part;\n\thubp->att.size.bits.width    = attr->width;\n\thubp->att.size.bits.height   = attr->height;\n\thubp->att.cur_ctl.bits.mode  = attr->color_format;\n\n\thubp->cur_rect.w = attr->width;\n\thubp->cur_rect.h = attr->height;\n\n\thubp->att.cur_ctl.bits.pitch = hw_pitch;\n\thubp->att.cur_ctl.bits.line_per_chunk = lpc;\n\thubp->att.cur_ctl.bits.cur_2x_magnify = attr->attribute_flags.bits.ENABLE_MAGNIFICATION;\n\thubp->att.settings.bits.dst_y_offset  = 0;\n\thubp->att.settings.bits.chunk_hdl_adjust = 3;\n}\n\nvoid hubp2_dmdata_set_attributes(\n\t\tstruct hubp *hubp,\n\t\tconst struct dc_dmdata_attributes *attr)\n{\n\tstruct dcn20_hubp *hubp2 = TO_DCN20_HUBP(hubp);\n\n\tif (attr->dmdata_mode == DMDATA_HW_MODE) {\n\t\t \n\t\tREG_UPDATE(DMDATA_CNTL,\n\t\t\t\tDMDATA_MODE, 1);\n\n\t\t \n\t\tREG_UPDATE(DCSURF_FLIP_CONTROL, SURFACE_UPDATE_LOCK, 1);\n\n\t\t \n\t\tREG_UPDATE(DMDATA_CNTL,\n\t\t\t\tDMDATA_UPDATED, 0);\n\t\tREG_UPDATE_3(DMDATA_CNTL,\n\t\t\t\tDMDATA_UPDATED, 1,\n\t\t\t\tDMDATA_REPEAT, attr->dmdata_repeat,\n\t\t\t\tDMDATA_SIZE, attr->dmdata_size);\n\n\t\t \n\t\tREG_WRITE(DMDATA_ADDRESS_LOW, attr->address.low_part);\n\t\tREG_UPDATE(DMDATA_ADDRESS_HIGH,\n\t\t\t\tDMDATA_ADDRESS_HIGH, attr->address.high_part);\n\n\t\tREG_UPDATE(DCSURF_FLIP_CONTROL, SURFACE_UPDATE_LOCK, 0);\n\n\t} else {\n\t\t \n\t\tREG_SET(DMDATA_CNTL, 0,\n\t\t\t\tDMDATA_MODE, 0);\n\t\t \n\t\tREG_UPDATE(DMDATA_SW_CNTL,\n\t\t\t\tDMDATA_SW_UPDATED, 0);\n\t\tREG_UPDATE_3(DMDATA_SW_CNTL,\n\t\t\t\tDMDATA_SW_UPDATED, 1,\n\t\t\t\tDMDATA_SW_REPEAT, attr->dmdata_repeat,\n\t\t\t\tDMDATA_SW_SIZE, attr->dmdata_size);\n\t\t \n\t\thubp2_dmdata_load(hubp, attr->dmdata_size, attr->dmdata_sw_data);\n\t}\n\n\t \n\tREG_SET_3(DMDATA_QOS_CNTL, 0,\n\t\t\tDMDATA_QOS_MODE, attr->dmdata_qos_mode,\n\t\t\tDMDATA_QOS_LEVEL, attr->dmdata_qos_level,\n\t\t\tDMDATA_DL_DELTA, attr->dmdata_dl_delta);\n}\n\nvoid hubp2_dmdata_load(\n\t\tstruct hubp *hubp,\n\t\tuint32_t dmdata_sw_size,\n\t\tconst uint32_t *dmdata_sw_data)\n{\n\tint i;\n\tstruct dcn20_hubp *hubp2 = TO_DCN20_HUBP(hubp);\n\n\t \n\tfor (i = 0; i < dmdata_sw_size / 4; i++)\n\t\tREG_WRITE(DMDATA_SW_DATA, dmdata_sw_data[i]);\n}\n\nbool hubp2_dmdata_status_done(struct hubp *hubp)\n{\n\tuint32_t status;\n\tstruct dcn20_hubp *hubp2 = TO_DCN20_HUBP(hubp);\n\n\tREG_GET(DMDATA_STATUS, DMDATA_DONE, &status);\n\treturn (status == 1);\n}\n\nbool hubp2_program_surface_flip_and_addr(\n\tstruct hubp *hubp,\n\tconst struct dc_plane_address *address,\n\tbool flip_immediate)\n{\n\tstruct dcn20_hubp *hubp2 = TO_DCN20_HUBP(hubp);\n\n\t \n\tREG_UPDATE(DCSURF_FLIP_CONTROL,\n\t\t\tSURFACE_FLIP_TYPE, flip_immediate);\n\n\t \n\tREG_UPDATE(VMID_SETTINGS_0,\n\t\t\tVMID, address->vmid);\n\n\n\t \n\tswitch (address->type) {\n\tcase PLN_ADDR_TYPE_GRAPHICS:\n\t\t \n\n\t\tif (address->grph.addr.quad_part == 0)\n\t\t\tbreak;\n\n\t\tREG_UPDATE_2(DCSURF_SURFACE_CONTROL,\n\t\t\t\tPRIMARY_SURFACE_TMZ, address->tmz_surface,\n\t\t\t\tPRIMARY_META_SURFACE_TMZ, address->tmz_surface);\n\n\t\tif (address->grph.meta_addr.quad_part != 0) {\n\t\t\tREG_SET(DCSURF_PRIMARY_META_SURFACE_ADDRESS_HIGH, 0,\n\t\t\t\t\tPRIMARY_META_SURFACE_ADDRESS_HIGH,\n\t\t\t\t\taddress->grph.meta_addr.high_part);\n\n\t\t\tREG_SET(DCSURF_PRIMARY_META_SURFACE_ADDRESS, 0,\n\t\t\t\t\tPRIMARY_META_SURFACE_ADDRESS,\n\t\t\t\t\taddress->grph.meta_addr.low_part);\n\t\t}\n\n\t\tREG_SET(DCSURF_PRIMARY_SURFACE_ADDRESS_HIGH, 0,\n\t\t\t\tPRIMARY_SURFACE_ADDRESS_HIGH,\n\t\t\t\taddress->grph.addr.high_part);\n\n\t\tREG_SET(DCSURF_PRIMARY_SURFACE_ADDRESS, 0,\n\t\t\t\tPRIMARY_SURFACE_ADDRESS,\n\t\t\t\taddress->grph.addr.low_part);\n\t\tbreak;\n\tcase PLN_ADDR_TYPE_VIDEO_PROGRESSIVE:\n\t\tif (address->video_progressive.luma_addr.quad_part == 0\n\t\t\t\t|| address->video_progressive.chroma_addr.quad_part == 0)\n\t\t\tbreak;\n\n\t\tREG_UPDATE_4(DCSURF_SURFACE_CONTROL,\n\t\t\t\tPRIMARY_SURFACE_TMZ, address->tmz_surface,\n\t\t\t\tPRIMARY_SURFACE_TMZ_C, address->tmz_surface,\n\t\t\t\tPRIMARY_META_SURFACE_TMZ, address->tmz_surface,\n\t\t\t\tPRIMARY_META_SURFACE_TMZ_C, address->tmz_surface);\n\n\t\tif (address->video_progressive.luma_meta_addr.quad_part != 0) {\n\t\t\tREG_SET(DCSURF_PRIMARY_META_SURFACE_ADDRESS_HIGH_C, 0,\n\t\t\t\t\tPRIMARY_META_SURFACE_ADDRESS_HIGH_C,\n\t\t\t\t\taddress->video_progressive.chroma_meta_addr.high_part);\n\n\t\t\tREG_SET(DCSURF_PRIMARY_META_SURFACE_ADDRESS_C, 0,\n\t\t\t\t\tPRIMARY_META_SURFACE_ADDRESS_C,\n\t\t\t\t\taddress->video_progressive.chroma_meta_addr.low_part);\n\n\t\t\tREG_SET(DCSURF_PRIMARY_META_SURFACE_ADDRESS_HIGH, 0,\n\t\t\t\t\tPRIMARY_META_SURFACE_ADDRESS_HIGH,\n\t\t\t\t\taddress->video_progressive.luma_meta_addr.high_part);\n\n\t\t\tREG_SET(DCSURF_PRIMARY_META_SURFACE_ADDRESS, 0,\n\t\t\t\t\tPRIMARY_META_SURFACE_ADDRESS,\n\t\t\t\t\taddress->video_progressive.luma_meta_addr.low_part);\n\t\t}\n\n\t\tREG_SET(DCSURF_PRIMARY_SURFACE_ADDRESS_HIGH_C, 0,\n\t\t\t\tPRIMARY_SURFACE_ADDRESS_HIGH_C,\n\t\t\t\taddress->video_progressive.chroma_addr.high_part);\n\n\t\tREG_SET(DCSURF_PRIMARY_SURFACE_ADDRESS_C, 0,\n\t\t\t\tPRIMARY_SURFACE_ADDRESS_C,\n\t\t\t\taddress->video_progressive.chroma_addr.low_part);\n\n\t\tREG_SET(DCSURF_PRIMARY_SURFACE_ADDRESS_HIGH, 0,\n\t\t\t\tPRIMARY_SURFACE_ADDRESS_HIGH,\n\t\t\t\taddress->video_progressive.luma_addr.high_part);\n\n\t\tREG_SET(DCSURF_PRIMARY_SURFACE_ADDRESS, 0,\n\t\t\t\tPRIMARY_SURFACE_ADDRESS,\n\t\t\t\taddress->video_progressive.luma_addr.low_part);\n\t\tbreak;\n\tcase PLN_ADDR_TYPE_GRPH_STEREO:\n\t\tif (address->grph_stereo.left_addr.quad_part == 0)\n\t\t\tbreak;\n\t\tif (address->grph_stereo.right_addr.quad_part == 0)\n\t\t\tbreak;\n\n\t\tREG_UPDATE_8(DCSURF_SURFACE_CONTROL,\n\t\t\t\tPRIMARY_SURFACE_TMZ, address->tmz_surface,\n\t\t\t\tPRIMARY_SURFACE_TMZ_C, address->tmz_surface,\n\t\t\t\tPRIMARY_META_SURFACE_TMZ, address->tmz_surface,\n\t\t\t\tPRIMARY_META_SURFACE_TMZ_C, address->tmz_surface,\n\t\t\t\tSECONDARY_SURFACE_TMZ, address->tmz_surface,\n\t\t\t\tSECONDARY_SURFACE_TMZ_C, address->tmz_surface,\n\t\t\t\tSECONDARY_META_SURFACE_TMZ, address->tmz_surface,\n\t\t\t\tSECONDARY_META_SURFACE_TMZ_C, address->tmz_surface);\n\n\t\tif (address->grph_stereo.right_meta_addr.quad_part != 0) {\n\n\t\t\tREG_SET(DCSURF_SECONDARY_META_SURFACE_ADDRESS_HIGH, 0,\n\t\t\t\t\tSECONDARY_META_SURFACE_ADDRESS_HIGH,\n\t\t\t\t\taddress->grph_stereo.right_meta_addr.high_part);\n\n\t\t\tREG_SET(DCSURF_SECONDARY_META_SURFACE_ADDRESS, 0,\n\t\t\t\t\tSECONDARY_META_SURFACE_ADDRESS,\n\t\t\t\t\taddress->grph_stereo.right_meta_addr.low_part);\n\t\t}\n\t\tif (address->grph_stereo.left_meta_addr.quad_part != 0) {\n\n\t\t\tREG_SET(DCSURF_PRIMARY_META_SURFACE_ADDRESS_HIGH, 0,\n\t\t\t\t\tPRIMARY_META_SURFACE_ADDRESS_HIGH,\n\t\t\t\t\taddress->grph_stereo.left_meta_addr.high_part);\n\n\t\t\tREG_SET(DCSURF_PRIMARY_META_SURFACE_ADDRESS, 0,\n\t\t\t\t\tPRIMARY_META_SURFACE_ADDRESS,\n\t\t\t\t\taddress->grph_stereo.left_meta_addr.low_part);\n\t\t}\n\n\t\tREG_SET(DCSURF_SECONDARY_SURFACE_ADDRESS_HIGH, 0,\n\t\t\t\tSECONDARY_SURFACE_ADDRESS_HIGH,\n\t\t\t\taddress->grph_stereo.right_addr.high_part);\n\n\t\tREG_SET(DCSURF_SECONDARY_SURFACE_ADDRESS, 0,\n\t\t\t\tSECONDARY_SURFACE_ADDRESS,\n\t\t\t\taddress->grph_stereo.right_addr.low_part);\n\n\t\tREG_SET(DCSURF_PRIMARY_SURFACE_ADDRESS_HIGH, 0,\n\t\t\t\tPRIMARY_SURFACE_ADDRESS_HIGH,\n\t\t\t\taddress->grph_stereo.left_addr.high_part);\n\n\t\tREG_SET(DCSURF_PRIMARY_SURFACE_ADDRESS, 0,\n\t\t\t\tPRIMARY_SURFACE_ADDRESS,\n\t\t\t\taddress->grph_stereo.left_addr.low_part);\n\t\tbreak;\n\tdefault:\n\t\tBREAK_TO_DEBUGGER();\n\t\tbreak;\n\t}\n\n\thubp->request_address = *address;\n\n\treturn true;\n}\n\nvoid hubp2_enable_triplebuffer(\n\tstruct hubp *hubp,\n\tbool enable)\n{\n\tstruct dcn20_hubp *hubp2 = TO_DCN20_HUBP(hubp);\n\tuint32_t triple_buffer_en = 0;\n\tbool tri_buffer_en;\n\n\tREG_GET(DCSURF_FLIP_CONTROL2, SURFACE_TRIPLE_BUFFER_ENABLE, &triple_buffer_en);\n\ttri_buffer_en = (triple_buffer_en == 1);\n\tif (tri_buffer_en != enable) {\n\t\tREG_UPDATE(DCSURF_FLIP_CONTROL2,\n\t\t\tSURFACE_TRIPLE_BUFFER_ENABLE, enable ? DC_TRIPLEBUFFER_ENABLE : DC_TRIPLEBUFFER_DISABLE);\n\t}\n}\n\nbool hubp2_is_triplebuffer_enabled(\n\tstruct hubp *hubp)\n{\n\tstruct dcn20_hubp *hubp2 = TO_DCN20_HUBP(hubp);\n\tuint32_t triple_buffer_en = 0;\n\n\tREG_GET(DCSURF_FLIP_CONTROL2, SURFACE_TRIPLE_BUFFER_ENABLE, &triple_buffer_en);\n\n\treturn (bool)triple_buffer_en;\n}\n\nvoid hubp2_set_flip_control_surface_gsl(struct hubp *hubp, bool enable)\n{\n\tstruct dcn20_hubp *hubp2 = TO_DCN20_HUBP(hubp);\n\n\tREG_UPDATE(DCSURF_FLIP_CONTROL2, SURFACE_GSL_ENABLE, enable ? 1 : 0);\n}\n\nbool hubp2_is_flip_pending(struct hubp *hubp)\n{\n\tuint32_t flip_pending = 0;\n\tstruct dcn20_hubp *hubp2 = TO_DCN20_HUBP(hubp);\n\tstruct dc_plane_address earliest_inuse_address;\n\n\tif (hubp && hubp->power_gated)\n\t\treturn false;\n\n\tREG_GET(DCSURF_FLIP_CONTROL,\n\t\t\tSURFACE_FLIP_PENDING, &flip_pending);\n\n\tREG_GET(DCSURF_SURFACE_EARLIEST_INUSE,\n\t\t\tSURFACE_EARLIEST_INUSE_ADDRESS, &earliest_inuse_address.grph.addr.low_part);\n\n\tREG_GET(DCSURF_SURFACE_EARLIEST_INUSE_HIGH,\n\t\t\tSURFACE_EARLIEST_INUSE_ADDRESS_HIGH, &earliest_inuse_address.grph.addr.high_part);\n\n\tif (flip_pending)\n\t\treturn true;\n\n\tif (earliest_inuse_address.grph.addr.quad_part != hubp->request_address.grph.addr.quad_part)\n\t\treturn true;\n\n\treturn false;\n}\n\nvoid hubp2_set_blank(struct hubp *hubp, bool blank)\n{\n\thubp2_set_blank_regs(hubp, blank);\n\n\tif (blank) {\n\t\thubp->mpcc_id = 0xf;\n\t\thubp->opp_id = OPP_ID_INVALID;\n\t}\n}\n\nvoid hubp2_set_blank_regs(struct hubp *hubp, bool blank)\n{\n\tstruct dcn20_hubp *hubp2 = TO_DCN20_HUBP(hubp);\n\tuint32_t blank_en = blank ? 1 : 0;\n\n\tif (blank) {\n\t\tuint32_t reg_val = REG_READ(DCHUBP_CNTL);\n\n\t\tif (reg_val) {\n\t\t\t \n\t\t\tREG_WAIT(DCHUBP_CNTL,\n\t\t\t\t\tHUBP_NO_OUTSTANDING_REQ, 1,\n\t\t\t\t\t1, 100000);\n\t\t}\n\t}\n\n\tREG_UPDATE_2(DCHUBP_CNTL,\n\t\t\tHUBP_BLANK_EN, blank_en,\n\t\t\tHUBP_TTU_DISABLE, 0);\n}\n\nvoid hubp2_cursor_set_position(\n\t\tstruct hubp *hubp,\n\t\tconst struct dc_cursor_position *pos,\n\t\tconst struct dc_cursor_mi_param *param)\n{\n\tstruct dcn20_hubp *hubp2 = TO_DCN20_HUBP(hubp);\n\tint x_pos = pos->x - param->viewport.x;\n\tint y_pos = pos->y - param->viewport.y;\n\tint x_hotspot = pos->x_hotspot;\n\tint y_hotspot = pos->y_hotspot;\n\tint src_x_offset = x_pos - pos->x_hotspot;\n\tint src_y_offset = y_pos - pos->y_hotspot;\n\tint cursor_height = (int)hubp->curs_attr.height;\n\tint cursor_width = (int)hubp->curs_attr.width;\n\tuint32_t dst_x_offset;\n\tuint32_t cur_en = pos->enable ? 1 : 0;\n\n\thubp->curs_pos = *pos;\n\n\t \n\tif (hubp->curs_attr.address.quad_part == 0)\n\t\treturn;\n\n\t \n\tif (param->rotation == ROTATION_ANGLE_90 || param->rotation == ROTATION_ANGLE_270) {\n\t\tswap(cursor_height, cursor_width);\n\t\tswap(x_hotspot, y_hotspot);\n\n\t\tif (param->rotation == ROTATION_ANGLE_90) {\n\t\t\t \n\t\t\tsrc_x_offset = x_pos - (cursor_width - x_hotspot);\n\t\t\tsrc_y_offset = y_pos - y_hotspot;\n\t\t} else if (param->rotation == ROTATION_ANGLE_270) {\n\t\t\t \n\t\t\tsrc_x_offset = x_pos - x_hotspot;\n\t\t\tsrc_y_offset = y_pos - (cursor_height - y_hotspot);\n\t\t}\n\t} else if (param->rotation == ROTATION_ANGLE_180) {\n\t\t \n\t\tif (!param->mirror)\n\t\t\tsrc_x_offset = x_pos - (cursor_width - x_hotspot);\n\n\t\tsrc_y_offset = y_pos - (cursor_height - y_hotspot);\n\t}\n\n\tdst_x_offset = (src_x_offset >= 0) ? src_x_offset : 0;\n\tdst_x_offset *= param->ref_clk_khz;\n\tdst_x_offset /= param->pixel_clk_khz;\n\n\tASSERT(param->h_scale_ratio.value);\n\n\tif (param->h_scale_ratio.value)\n\t\tdst_x_offset = dc_fixpt_floor(dc_fixpt_div(\n\t\t\t\tdc_fixpt_from_int(dst_x_offset),\n\t\t\t\tparam->h_scale_ratio));\n\n\tif (src_x_offset >= (int)param->viewport.width)\n\t\tcur_en = 0;   \n\n\tif (src_x_offset + cursor_width <= 0)\n\t\tcur_en = 0;   \n\n\tif (src_y_offset >= (int)param->viewport.height)\n\t\tcur_en = 0;   \n\n\tif (src_y_offset + cursor_height <= 0)\n\t\tcur_en = 0;   \n\n\tif (cur_en && REG_READ(CURSOR_SURFACE_ADDRESS) == 0)\n\t\thubp->funcs->set_cursor_attributes(hubp, &hubp->curs_attr);\n\n\tREG_UPDATE(CURSOR_CONTROL,\n\t\t\tCURSOR_ENABLE, cur_en);\n\n\tREG_SET_2(CURSOR_POSITION, 0,\n\t\t\tCURSOR_X_POSITION, pos->x,\n\t\t\tCURSOR_Y_POSITION, pos->y);\n\n\tREG_SET_2(CURSOR_HOT_SPOT, 0,\n\t\t\tCURSOR_HOT_SPOT_X, pos->x_hotspot,\n\t\t\tCURSOR_HOT_SPOT_Y, pos->y_hotspot);\n\n\tREG_SET(CURSOR_DST_OFFSET, 0,\n\t\t\tCURSOR_DST_X_OFFSET, dst_x_offset);\n\t \n\t \n\thubp->pos.cur_ctl.bits.cur_enable = cur_en;\n\thubp->pos.position.bits.x_pos = pos->x;\n\thubp->pos.position.bits.y_pos = pos->y;\n\thubp->pos.hot_spot.bits.x_hot = pos->x_hotspot;\n\thubp->pos.hot_spot.bits.y_hot = pos->y_hotspot;\n\thubp->pos.dst_offset.bits.dst_x_offset = dst_x_offset;\n\t \n\tif (src_x_offset < 0)\n\t\tsrc_x_offset = 0;\n\tif (src_y_offset < 0)\n\t\tsrc_y_offset = 0;\n\t \n\tif (param->stream->link->psr_settings.psr_version >= DC_PSR_VERSION_SU_1 &&\n\t    param->rotation != ROTATION_ANGLE_0) {\n\t\thubp->cur_rect.x = 0;\n\t\thubp->cur_rect.y = 0;\n\t\thubp->cur_rect.w = param->stream->timing.h_addressable;\n\t\thubp->cur_rect.h = param->stream->timing.v_addressable;\n\t} else {\n\t\thubp->cur_rect.x = src_x_offset + param->viewport.x;\n\t\thubp->cur_rect.y = src_y_offset + param->viewport.y;\n\t}\n}\n\nvoid hubp2_clk_cntl(struct hubp *hubp, bool enable)\n{\n\tstruct dcn20_hubp *hubp2 = TO_DCN20_HUBP(hubp);\n\tuint32_t clk_enable = enable ? 1 : 0;\n\n\tREG_UPDATE(HUBP_CLK_CNTL, HUBP_CLOCK_ENABLE, clk_enable);\n}\n\nvoid hubp2_vtg_sel(struct hubp *hubp, uint32_t otg_inst)\n{\n\tstruct dcn20_hubp *hubp2 = TO_DCN20_HUBP(hubp);\n\n\tREG_UPDATE(DCHUBP_CNTL, HUBP_VTG_SEL, otg_inst);\n}\n\nvoid hubp2_clear_underflow(struct hubp *hubp)\n{\n\tstruct dcn20_hubp *hubp2 = TO_DCN20_HUBP(hubp);\n\n\tREG_UPDATE(DCHUBP_CNTL, HUBP_UNDERFLOW_CLEAR, 1);\n}\n\nvoid hubp2_read_state_common(struct hubp *hubp)\n{\n\tstruct dcn20_hubp *hubp2 = TO_DCN20_HUBP(hubp);\n\tstruct dcn_hubp_state *s = &hubp2->state;\n\tstruct _vcs_dpi_display_dlg_regs_st *dlg_attr = &s->dlg_attr;\n\tstruct _vcs_dpi_display_ttu_regs_st *ttu_attr = &s->ttu_attr;\n\tstruct _vcs_dpi_display_rq_regs_st *rq_regs = &s->rq_regs;\n\n\t \n\tREG_GET(HUBPRET_CONTROL,\n\t\t\tDET_BUF_PLANE1_BASE_ADDRESS, &rq_regs->plane1_base_address);\n\tREG_GET_4(DCN_EXPANSION_MODE,\n\t\t\tDRQ_EXPANSION_MODE, &rq_regs->drq_expansion_mode,\n\t\t\tPRQ_EXPANSION_MODE, &rq_regs->prq_expansion_mode,\n\t\t\tMRQ_EXPANSION_MODE, &rq_regs->mrq_expansion_mode,\n\t\t\tCRQ_EXPANSION_MODE, &rq_regs->crq_expansion_mode);\n\n\tREG_GET(DCN_VM_SYSTEM_APERTURE_HIGH_ADDR,\n\t\t\tMC_VM_SYSTEM_APERTURE_HIGH_ADDR, &rq_regs->aperture_high_addr);\n\n\tREG_GET(DCN_VM_SYSTEM_APERTURE_LOW_ADDR,\n\t\t\tMC_VM_SYSTEM_APERTURE_LOW_ADDR, &rq_regs->aperture_low_addr);\n\n\t \n\tREG_GET_2(BLANK_OFFSET_0,\n\t\tREFCYC_H_BLANK_END, &dlg_attr->refcyc_h_blank_end,\n\t\tDLG_V_BLANK_END, &dlg_attr->dlg_vblank_end);\n\n\tREG_GET(BLANK_OFFSET_1,\n\t\tMIN_DST_Y_NEXT_START, &dlg_attr->min_dst_y_next_start);\n\n\tREG_GET(DST_DIMENSIONS,\n\t\tREFCYC_PER_HTOTAL, &dlg_attr->refcyc_per_htotal);\n\n\tREG_GET_2(DST_AFTER_SCALER,\n\t\tREFCYC_X_AFTER_SCALER, &dlg_attr->refcyc_x_after_scaler,\n\t\tDST_Y_AFTER_SCALER, &dlg_attr->dst_y_after_scaler);\n\n\tif (REG(PREFETCH_SETTINS))\n\t\tREG_GET_2(PREFETCH_SETTINS,\n\t\t\tDST_Y_PREFETCH, &dlg_attr->dst_y_prefetch,\n\t\t\tVRATIO_PREFETCH, &dlg_attr->vratio_prefetch);\n\telse\n\t\tREG_GET_2(PREFETCH_SETTINGS,\n\t\t\tDST_Y_PREFETCH, &dlg_attr->dst_y_prefetch,\n\t\t\tVRATIO_PREFETCH, &dlg_attr->vratio_prefetch);\n\n\tREG_GET_2(VBLANK_PARAMETERS_0,\n\t\tDST_Y_PER_VM_VBLANK, &dlg_attr->dst_y_per_vm_vblank,\n\t\tDST_Y_PER_ROW_VBLANK, &dlg_attr->dst_y_per_row_vblank);\n\n\tREG_GET(REF_FREQ_TO_PIX_FREQ,\n\t\tREF_FREQ_TO_PIX_FREQ, &dlg_attr->ref_freq_to_pix_freq);\n\n\t \n\tREG_GET(VBLANK_PARAMETERS_1,\n\t\tREFCYC_PER_PTE_GROUP_VBLANK_L, &dlg_attr->refcyc_per_pte_group_vblank_l);\n\n\tREG_GET(VBLANK_PARAMETERS_3,\n\t\tREFCYC_PER_META_CHUNK_VBLANK_L, &dlg_attr->refcyc_per_meta_chunk_vblank_l);\n\n\tif (REG(NOM_PARAMETERS_0))\n\t\tREG_GET(NOM_PARAMETERS_0,\n\t\t\tDST_Y_PER_PTE_ROW_NOM_L, &dlg_attr->dst_y_per_pte_row_nom_l);\n\n\tif (REG(NOM_PARAMETERS_1))\n\t\tREG_GET(NOM_PARAMETERS_1,\n\t\t\tREFCYC_PER_PTE_GROUP_NOM_L, &dlg_attr->refcyc_per_pte_group_nom_l);\n\n\tREG_GET(NOM_PARAMETERS_4,\n\t\tDST_Y_PER_META_ROW_NOM_L, &dlg_attr->dst_y_per_meta_row_nom_l);\n\n\tREG_GET(NOM_PARAMETERS_5,\n\t\tREFCYC_PER_META_CHUNK_NOM_L, &dlg_attr->refcyc_per_meta_chunk_nom_l);\n\n\tREG_GET_2(PER_LINE_DELIVERY_PRE,\n\t\tREFCYC_PER_LINE_DELIVERY_PRE_L, &dlg_attr->refcyc_per_line_delivery_pre_l,\n\t\tREFCYC_PER_LINE_DELIVERY_PRE_C, &dlg_attr->refcyc_per_line_delivery_pre_c);\n\n\tREG_GET_2(PER_LINE_DELIVERY,\n\t\tREFCYC_PER_LINE_DELIVERY_L, &dlg_attr->refcyc_per_line_delivery_l,\n\t\tREFCYC_PER_LINE_DELIVERY_C, &dlg_attr->refcyc_per_line_delivery_c);\n\n\tif (REG(PREFETCH_SETTINS_C))\n\t\tREG_GET(PREFETCH_SETTINS_C,\n\t\t\tVRATIO_PREFETCH_C, &dlg_attr->vratio_prefetch_c);\n\telse\n\t\tREG_GET(PREFETCH_SETTINGS_C,\n\t\t\tVRATIO_PREFETCH_C, &dlg_attr->vratio_prefetch_c);\n\n\tREG_GET(VBLANK_PARAMETERS_2,\n\t\tREFCYC_PER_PTE_GROUP_VBLANK_C, &dlg_attr->refcyc_per_pte_group_vblank_c);\n\n\tREG_GET(VBLANK_PARAMETERS_4,\n\t\tREFCYC_PER_META_CHUNK_VBLANK_C, &dlg_attr->refcyc_per_meta_chunk_vblank_c);\n\n\tif (REG(NOM_PARAMETERS_2))\n\t\tREG_GET(NOM_PARAMETERS_2,\n\t\t\tDST_Y_PER_PTE_ROW_NOM_C, &dlg_attr->dst_y_per_pte_row_nom_c);\n\n\tif (REG(NOM_PARAMETERS_3))\n\t\tREG_GET(NOM_PARAMETERS_3,\n\t\t\tREFCYC_PER_PTE_GROUP_NOM_C, &dlg_attr->refcyc_per_pte_group_nom_c);\n\n\tREG_GET(NOM_PARAMETERS_6,\n\t\tDST_Y_PER_META_ROW_NOM_C, &dlg_attr->dst_y_per_meta_row_nom_c);\n\n\tREG_GET(NOM_PARAMETERS_7,\n\t\tREFCYC_PER_META_CHUNK_NOM_C, &dlg_attr->refcyc_per_meta_chunk_nom_c);\n\n\t \n\tREG_GET_2(DCN_TTU_QOS_WM,\n\t\tQoS_LEVEL_LOW_WM, &ttu_attr->qos_level_low_wm,\n\t\tQoS_LEVEL_HIGH_WM, &ttu_attr->qos_level_high_wm);\n\n\tREG_GET_2(DCN_GLOBAL_TTU_CNTL,\n\t\tMIN_TTU_VBLANK, &ttu_attr->min_ttu_vblank,\n\t\tQoS_LEVEL_FLIP, &ttu_attr->qos_level_flip);\n\n\t \n\t \n\n\tREG_GET_3(DCN_SURF0_TTU_CNTL0,\n\t\tREFCYC_PER_REQ_DELIVERY, &ttu_attr->refcyc_per_req_delivery_l,\n\t\tQoS_LEVEL_FIXED, &ttu_attr->qos_level_fixed_l,\n\t\tQoS_RAMP_DISABLE, &ttu_attr->qos_ramp_disable_l);\n\n\tREG_GET(DCN_SURF0_TTU_CNTL1,\n\t\tREFCYC_PER_REQ_DELIVERY_PRE,\n\t\t&ttu_attr->refcyc_per_req_delivery_pre_l);\n\n\tREG_GET_3(DCN_SURF1_TTU_CNTL0,\n\t\tREFCYC_PER_REQ_DELIVERY, &ttu_attr->refcyc_per_req_delivery_c,\n\t\tQoS_LEVEL_FIXED, &ttu_attr->qos_level_fixed_c,\n\t\tQoS_RAMP_DISABLE, &ttu_attr->qos_ramp_disable_c);\n\n\tREG_GET(DCN_SURF1_TTU_CNTL1,\n\t\tREFCYC_PER_REQ_DELIVERY_PRE,\n\t\t&ttu_attr->refcyc_per_req_delivery_pre_c);\n\n\t \n\tREG_GET(DCSURF_SURFACE_CONFIG,\n\t\t\tSURFACE_PIXEL_FORMAT, &s->pixel_format);\n\n\tREG_GET(DCSURF_SURFACE_EARLIEST_INUSE_HIGH,\n\t\t\tSURFACE_EARLIEST_INUSE_ADDRESS_HIGH, &s->inuse_addr_hi);\n\n\tREG_GET(DCSURF_SURFACE_EARLIEST_INUSE,\n\t\t\tSURFACE_EARLIEST_INUSE_ADDRESS, &s->inuse_addr_lo);\n\n\tREG_GET_2(DCSURF_PRI_VIEWPORT_DIMENSION,\n\t\t\tPRI_VIEWPORT_WIDTH, &s->viewport_width,\n\t\t\tPRI_VIEWPORT_HEIGHT, &s->viewport_height);\n\n\tREG_GET_2(DCSURF_SURFACE_CONFIG,\n\t\t\tROTATION_ANGLE, &s->rotation_angle,\n\t\t\tH_MIRROR_EN, &s->h_mirror_en);\n\n\tREG_GET(DCSURF_TILING_CONFIG,\n\t\t\tSW_MODE, &s->sw_mode);\n\n\tREG_GET(DCSURF_SURFACE_CONTROL,\n\t\t\tPRIMARY_SURFACE_DCC_EN, &s->dcc_en);\n\n\tREG_GET_3(DCHUBP_CNTL,\n\t\t\tHUBP_BLANK_EN, &s->blank_en,\n\t\t\tHUBP_TTU_DISABLE, &s->ttu_disable,\n\t\t\tHUBP_UNDERFLOW_STATUS, &s->underflow_status);\n\n\tREG_GET(HUBP_CLK_CNTL,\n\t\t\tHUBP_CLOCK_ENABLE, &s->clock_en);\n\n\tREG_GET(DCN_GLOBAL_TTU_CNTL,\n\t\t\tMIN_TTU_VBLANK, &s->min_ttu_vblank);\n\n\tREG_GET_2(DCN_TTU_QOS_WM,\n\t\t\tQoS_LEVEL_LOW_WM, &s->qos_level_low_wm,\n\t\t\tQoS_LEVEL_HIGH_WM, &s->qos_level_high_wm);\n\n\tREG_GET(DCSURF_PRIMARY_SURFACE_ADDRESS,\n\t\t\tPRIMARY_SURFACE_ADDRESS, &s->primary_surface_addr_lo);\n\n\tREG_GET(DCSURF_PRIMARY_SURFACE_ADDRESS_HIGH,\n\t\t\tPRIMARY_SURFACE_ADDRESS, &s->primary_surface_addr_hi);\n\n\tREG_GET(DCSURF_PRIMARY_META_SURFACE_ADDRESS,\n\t\t\tPRIMARY_META_SURFACE_ADDRESS, &s->primary_meta_addr_lo);\n\n\tREG_GET(DCSURF_PRIMARY_META_SURFACE_ADDRESS_HIGH,\n\t\t\tPRIMARY_META_SURFACE_ADDRESS, &s->primary_meta_addr_hi);\n}\n\nvoid hubp2_read_state(struct hubp *hubp)\n{\n\tstruct dcn20_hubp *hubp2 = TO_DCN20_HUBP(hubp);\n\tstruct dcn_hubp_state *s = &hubp2->state;\n\tstruct _vcs_dpi_display_rq_regs_st *rq_regs = &s->rq_regs;\n\n\thubp2_read_state_common(hubp);\n\n\tREG_GET_8(DCHUBP_REQ_SIZE_CONFIG,\n\t\tCHUNK_SIZE, &rq_regs->rq_regs_l.chunk_size,\n\t\tMIN_CHUNK_SIZE, &rq_regs->rq_regs_l.min_chunk_size,\n\t\tMETA_CHUNK_SIZE, &rq_regs->rq_regs_l.meta_chunk_size,\n\t\tMIN_META_CHUNK_SIZE, &rq_regs->rq_regs_l.min_meta_chunk_size,\n\t\tDPTE_GROUP_SIZE, &rq_regs->rq_regs_l.dpte_group_size,\n\t\tMPTE_GROUP_SIZE, &rq_regs->rq_regs_l.mpte_group_size,\n\t\tSWATH_HEIGHT, &rq_regs->rq_regs_l.swath_height,\n\t\tPTE_ROW_HEIGHT_LINEAR, &rq_regs->rq_regs_l.pte_row_height_linear);\n\n\tREG_GET_8(DCHUBP_REQ_SIZE_CONFIG_C,\n\t\tCHUNK_SIZE_C, &rq_regs->rq_regs_c.chunk_size,\n\t\tMIN_CHUNK_SIZE_C, &rq_regs->rq_regs_c.min_chunk_size,\n\t\tMETA_CHUNK_SIZE_C, &rq_regs->rq_regs_c.meta_chunk_size,\n\t\tMIN_META_CHUNK_SIZE_C, &rq_regs->rq_regs_c.min_meta_chunk_size,\n\t\tDPTE_GROUP_SIZE_C, &rq_regs->rq_regs_c.dpte_group_size,\n\t\tMPTE_GROUP_SIZE_C, &rq_regs->rq_regs_c.mpte_group_size,\n\t\tSWATH_HEIGHT_C, &rq_regs->rq_regs_c.swath_height,\n\t\tPTE_ROW_HEIGHT_LINEAR_C, &rq_regs->rq_regs_c.pte_row_height_linear);\n\n}\n\nstatic void hubp2_validate_dml_output(struct hubp *hubp,\n\t\tstruct dc_context *ctx,\n\t\tstruct _vcs_dpi_display_rq_regs_st *dml_rq_regs,\n\t\tstruct _vcs_dpi_display_dlg_regs_st *dml_dlg_attr,\n\t\tstruct _vcs_dpi_display_ttu_regs_st *dml_ttu_attr)\n{\n\tstruct dcn20_hubp *hubp2 = TO_DCN20_HUBP(hubp);\n\tstruct _vcs_dpi_display_rq_regs_st rq_regs = {0};\n\tstruct _vcs_dpi_display_dlg_regs_st dlg_attr = {0};\n\tstruct _vcs_dpi_display_ttu_regs_st ttu_attr = {0};\n\tDC_LOGGER_INIT(ctx->logger);\n\tDC_LOG_DEBUG(\"DML Validation | Running Validation\");\n\n\t \n\tREG_GET(HUBPRET_CONTROL,\n\t\tDET_BUF_PLANE1_BASE_ADDRESS, &rq_regs.plane1_base_address);\n\tREG_GET_4(DCN_EXPANSION_MODE,\n\t\tDRQ_EXPANSION_MODE, &rq_regs.drq_expansion_mode,\n\t\tPRQ_EXPANSION_MODE, &rq_regs.prq_expansion_mode,\n\t\tMRQ_EXPANSION_MODE, &rq_regs.mrq_expansion_mode,\n\t\tCRQ_EXPANSION_MODE, &rq_regs.crq_expansion_mode);\n\tREG_GET_8(DCHUBP_REQ_SIZE_CONFIG,\n\t\tCHUNK_SIZE, &rq_regs.rq_regs_l.chunk_size,\n\t\tMIN_CHUNK_SIZE, &rq_regs.rq_regs_l.min_chunk_size,\n\t\tMETA_CHUNK_SIZE, &rq_regs.rq_regs_l.meta_chunk_size,\n\t\tMIN_META_CHUNK_SIZE, &rq_regs.rq_regs_l.min_meta_chunk_size,\n\t\tDPTE_GROUP_SIZE, &rq_regs.rq_regs_l.dpte_group_size,\n\t\tMPTE_GROUP_SIZE, &rq_regs.rq_regs_l.mpte_group_size,\n\t\tSWATH_HEIGHT, &rq_regs.rq_regs_l.swath_height,\n\t\tPTE_ROW_HEIGHT_LINEAR, &rq_regs.rq_regs_l.pte_row_height_linear);\n\tREG_GET_8(DCHUBP_REQ_SIZE_CONFIG_C,\n\t\tCHUNK_SIZE_C, &rq_regs.rq_regs_c.chunk_size,\n\t\tMIN_CHUNK_SIZE_C, &rq_regs.rq_regs_c.min_chunk_size,\n\t\tMETA_CHUNK_SIZE_C, &rq_regs.rq_regs_c.meta_chunk_size,\n\t\tMIN_META_CHUNK_SIZE_C, &rq_regs.rq_regs_c.min_meta_chunk_size,\n\t\tDPTE_GROUP_SIZE_C, &rq_regs.rq_regs_c.dpte_group_size,\n\t\tMPTE_GROUP_SIZE_C, &rq_regs.rq_regs_c.mpte_group_size,\n\t\tSWATH_HEIGHT_C, &rq_regs.rq_regs_c.swath_height,\n\t\tPTE_ROW_HEIGHT_LINEAR_C, &rq_regs.rq_regs_c.pte_row_height_linear);\n\n\tif (rq_regs.plane1_base_address != dml_rq_regs->plane1_base_address)\n\t\tDC_LOG_DEBUG(\"DML Validation | HUBPRET_CONTROL:DET_BUF_PLANE1_BASE_ADDRESS - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_rq_regs->plane1_base_address, rq_regs.plane1_base_address);\n\tif (rq_regs.drq_expansion_mode != dml_rq_regs->drq_expansion_mode)\n\t\tDC_LOG_DEBUG(\"DML Validation | DCN_EXPANSION_MODE:DRQ_EXPANSION_MODE - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_rq_regs->drq_expansion_mode, rq_regs.drq_expansion_mode);\n\tif (rq_regs.prq_expansion_mode != dml_rq_regs->prq_expansion_mode)\n\t\tDC_LOG_DEBUG(\"DML Validation | DCN_EXPANSION_MODE:MRQ_EXPANSION_MODE - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_rq_regs->prq_expansion_mode, rq_regs.prq_expansion_mode);\n\tif (rq_regs.mrq_expansion_mode != dml_rq_regs->mrq_expansion_mode)\n\t\tDC_LOG_DEBUG(\"DML Validation | DCN_EXPANSION_MODE:DET_BUF_PLANE1_BASE_ADDRESS - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_rq_regs->mrq_expansion_mode, rq_regs.mrq_expansion_mode);\n\tif (rq_regs.crq_expansion_mode != dml_rq_regs->crq_expansion_mode)\n\t\tDC_LOG_DEBUG(\"DML Validation | DCN_EXPANSION_MODE:CRQ_EXPANSION_MODE - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_rq_regs->crq_expansion_mode, rq_regs.crq_expansion_mode);\n\n\tif (rq_regs.rq_regs_l.chunk_size != dml_rq_regs->rq_regs_l.chunk_size)\n\t\tDC_LOG_DEBUG(\"DML Validation | DCHUBP_REQ_SIZE_CONFIG_C:CHUNK_SIZE - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_rq_regs->rq_regs_l.chunk_size, rq_regs.rq_regs_l.chunk_size);\n\tif (rq_regs.rq_regs_l.min_chunk_size != dml_rq_regs->rq_regs_l.min_chunk_size)\n\t\tDC_LOG_DEBUG(\"DML Validation | DCHUBP_REQ_SIZE_CONFIG_C:MIN_CHUNK_SIZE - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_rq_regs->rq_regs_l.min_chunk_size, rq_regs.rq_regs_l.min_chunk_size);\n\tif (rq_regs.rq_regs_l.meta_chunk_size != dml_rq_regs->rq_regs_l.meta_chunk_size)\n\t\tDC_LOG_DEBUG(\"DML Validation | DCHUBP_REQ_SIZE_CONFIG_C:META_CHUNK_SIZE - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_rq_regs->rq_regs_l.meta_chunk_size, rq_regs.rq_regs_l.meta_chunk_size);\n\tif (rq_regs.rq_regs_l.min_meta_chunk_size != dml_rq_regs->rq_regs_l.min_meta_chunk_size)\n\t\tDC_LOG_DEBUG(\"DML Validation | DCHUBP_REQ_SIZE_CONFIG_C:MIN_META_CHUNK_SIZE - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_rq_regs->rq_regs_l.min_meta_chunk_size, rq_regs.rq_regs_l.min_meta_chunk_size);\n\tif (rq_regs.rq_regs_l.dpte_group_size != dml_rq_regs->rq_regs_l.dpte_group_size)\n\t\tDC_LOG_DEBUG(\"DML Validation | DCHUBP_REQ_SIZE_CONFIG_C:DPTE_GROUP_SIZE - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_rq_regs->rq_regs_l.dpte_group_size, rq_regs.rq_regs_l.dpte_group_size);\n\tif (rq_regs.rq_regs_l.mpte_group_size != dml_rq_regs->rq_regs_l.mpte_group_size)\n\t\tDC_LOG_DEBUG(\"DML Validation | DCHUBP_REQ_SIZE_CONFIG_C:MPTE_GROUP_SIZE - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_rq_regs->rq_regs_l.mpte_group_size, rq_regs.rq_regs_l.mpte_group_size);\n\tif (rq_regs.rq_regs_l.swath_height != dml_rq_regs->rq_regs_l.swath_height)\n\t\tDC_LOG_DEBUG(\"DML Validation | DCHUBP_REQ_SIZE_CONFIG_C:SWATH_HEIGHT - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_rq_regs->rq_regs_l.swath_height, rq_regs.rq_regs_l.swath_height);\n\tif (rq_regs.rq_regs_l.pte_row_height_linear != dml_rq_regs->rq_regs_l.pte_row_height_linear)\n\t\tDC_LOG_DEBUG(\"DML Validation | DCHUBP_REQ_SIZE_CONFIG_C:PTE_ROW_HEIGHT_LINEAR - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_rq_regs->rq_regs_l.pte_row_height_linear, rq_regs.rq_regs_l.pte_row_height_linear);\n\n\tif (rq_regs.rq_regs_c.chunk_size != dml_rq_regs->rq_regs_c.chunk_size)\n\t\tDC_LOG_DEBUG(\"DML Validation | DCHUBP_REQ_SIZE_CONFIG:CHUNK_SIZE_C - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_rq_regs->rq_regs_c.chunk_size, rq_regs.rq_regs_c.chunk_size);\n\tif (rq_regs.rq_regs_c.min_chunk_size != dml_rq_regs->rq_regs_c.min_chunk_size)\n\t\tDC_LOG_DEBUG(\"DML Validation | DCHUBP_REQ_SIZE_CONFIG:MIN_CHUNK_SIZE_C - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_rq_regs->rq_regs_c.min_chunk_size, rq_regs.rq_regs_c.min_chunk_size);\n\tif (rq_regs.rq_regs_c.meta_chunk_size != dml_rq_regs->rq_regs_c.meta_chunk_size)\n\t\tDC_LOG_DEBUG(\"DML Validation | DCHUBP_REQ_SIZE_CONFIG:META_CHUNK_SIZE_C - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_rq_regs->rq_regs_c.meta_chunk_size, rq_regs.rq_regs_c.meta_chunk_size);\n\tif (rq_regs.rq_regs_c.min_meta_chunk_size != dml_rq_regs->rq_regs_c.min_meta_chunk_size)\n\t\tDC_LOG_DEBUG(\"DML Validation | DCHUBP_REQ_SIZE_CONFIG:MIN_META_CHUNK_SIZE_C - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_rq_regs->rq_regs_c.min_meta_chunk_size, rq_regs.rq_regs_c.min_meta_chunk_size);\n\tif (rq_regs.rq_regs_c.dpte_group_size != dml_rq_regs->rq_regs_c.dpte_group_size)\n\t\tDC_LOG_DEBUG(\"DML Validation | DCHUBP_REQ_SIZE_CONFIG:DPTE_GROUP_SIZE_C - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_rq_regs->rq_regs_c.dpte_group_size, rq_regs.rq_regs_c.dpte_group_size);\n\tif (rq_regs.rq_regs_c.mpte_group_size != dml_rq_regs->rq_regs_c.mpte_group_size)\n\t\tDC_LOG_DEBUG(\"DML Validation | DCHUBP_REQ_SIZE_CONFIG:MPTE_GROUP_SIZE_C - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_rq_regs->rq_regs_c.mpte_group_size, rq_regs.rq_regs_c.mpte_group_size);\n\tif (rq_regs.rq_regs_c.swath_height != dml_rq_regs->rq_regs_c.swath_height)\n\t\tDC_LOG_DEBUG(\"DML Validation | DCHUBP_REQ_SIZE_CONFIG:SWATH_HEIGHT_C - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_rq_regs->rq_regs_c.swath_height, rq_regs.rq_regs_c.swath_height);\n\tif (rq_regs.rq_regs_c.pte_row_height_linear != dml_rq_regs->rq_regs_c.pte_row_height_linear)\n\t\tDC_LOG_DEBUG(\"DML Validation | DCHUBP_REQ_SIZE_CONFIG:PTE_ROW_HEIGHT_LINEAR_C - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_rq_regs->rq_regs_c.pte_row_height_linear, rq_regs.rq_regs_c.pte_row_height_linear);\n\n\t \n\tREG_GET_2(BLANK_OFFSET_0,\n\t\tREFCYC_H_BLANK_END, &dlg_attr.refcyc_h_blank_end,\n\t\tDLG_V_BLANK_END, &dlg_attr.dlg_vblank_end);\n\tREG_GET(BLANK_OFFSET_1,\n\t\tMIN_DST_Y_NEXT_START, &dlg_attr.min_dst_y_next_start);\n\tREG_GET(DST_DIMENSIONS,\n\t\tREFCYC_PER_HTOTAL, &dlg_attr.refcyc_per_htotal);\n\tREG_GET_2(DST_AFTER_SCALER,\n\t\tREFCYC_X_AFTER_SCALER, &dlg_attr.refcyc_x_after_scaler,\n\t\tDST_Y_AFTER_SCALER, &dlg_attr.dst_y_after_scaler);\n\tREG_GET(REF_FREQ_TO_PIX_FREQ,\n\t\tREF_FREQ_TO_PIX_FREQ, &dlg_attr.ref_freq_to_pix_freq);\n\n\tif (dlg_attr.refcyc_h_blank_end != dml_dlg_attr->refcyc_h_blank_end)\n\t\tDC_LOG_DEBUG(\"DML Validation | BLANK_OFFSET_0:REFCYC_H_BLANK_END - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_dlg_attr->refcyc_h_blank_end, dlg_attr.refcyc_h_blank_end);\n\tif (dlg_attr.dlg_vblank_end != dml_dlg_attr->dlg_vblank_end)\n\t\tDC_LOG_DEBUG(\"DML Validation | BLANK_OFFSET_0:DLG_V_BLANK_END - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_dlg_attr->dlg_vblank_end, dlg_attr.dlg_vblank_end);\n\tif (dlg_attr.min_dst_y_next_start != dml_dlg_attr->min_dst_y_next_start)\n\t\tDC_LOG_DEBUG(\"DML Validation | BLANK_OFFSET_1:MIN_DST_Y_NEXT_START - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_dlg_attr->min_dst_y_next_start, dlg_attr.min_dst_y_next_start);\n\tif (dlg_attr.refcyc_per_htotal != dml_dlg_attr->refcyc_per_htotal)\n\t\tDC_LOG_DEBUG(\"DML Validation | DST_DIMENSIONS:REFCYC_PER_HTOTAL - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_dlg_attr->refcyc_per_htotal, dlg_attr.refcyc_per_htotal);\n\tif (dlg_attr.refcyc_x_after_scaler != dml_dlg_attr->refcyc_x_after_scaler)\n\t\tDC_LOG_DEBUG(\"DML Validation | DST_AFTER_SCALER:REFCYC_X_AFTER_SCALER - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_dlg_attr->refcyc_x_after_scaler, dlg_attr.refcyc_x_after_scaler);\n\tif (dlg_attr.dst_y_after_scaler != dml_dlg_attr->dst_y_after_scaler)\n\t\tDC_LOG_DEBUG(\"DML Validation | DST_AFTER_SCALER:DST_Y_AFTER_SCALER - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_dlg_attr->dst_y_after_scaler, dlg_attr.dst_y_after_scaler);\n\tif (dlg_attr.ref_freq_to_pix_freq != dml_dlg_attr->ref_freq_to_pix_freq)\n\t\tDC_LOG_DEBUG(\"DML Validation | REF_FREQ_TO_PIX_FREQ:REF_FREQ_TO_PIX_FREQ - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_dlg_attr->ref_freq_to_pix_freq, dlg_attr.ref_freq_to_pix_freq);\n\n\t \n\tREG_GET(VBLANK_PARAMETERS_1,\n\t\tREFCYC_PER_PTE_GROUP_VBLANK_L, &dlg_attr.refcyc_per_pte_group_vblank_l);\n\tif (REG(NOM_PARAMETERS_0))\n\t\tREG_GET(NOM_PARAMETERS_0,\n\t\t\tDST_Y_PER_PTE_ROW_NOM_L, &dlg_attr.dst_y_per_pte_row_nom_l);\n\tif (REG(NOM_PARAMETERS_1))\n\t\tREG_GET(NOM_PARAMETERS_1,\n\t\t\tREFCYC_PER_PTE_GROUP_NOM_L, &dlg_attr.refcyc_per_pte_group_nom_l);\n\tREG_GET(NOM_PARAMETERS_4,\n\t\tDST_Y_PER_META_ROW_NOM_L, &dlg_attr.dst_y_per_meta_row_nom_l);\n\tREG_GET(NOM_PARAMETERS_5,\n\t\tREFCYC_PER_META_CHUNK_NOM_L, &dlg_attr.refcyc_per_meta_chunk_nom_l);\n\tREG_GET_2(PER_LINE_DELIVERY,\n\t\tREFCYC_PER_LINE_DELIVERY_L, &dlg_attr.refcyc_per_line_delivery_l,\n\t\tREFCYC_PER_LINE_DELIVERY_C, &dlg_attr.refcyc_per_line_delivery_c);\n\tREG_GET_2(PER_LINE_DELIVERY_PRE,\n\t\tREFCYC_PER_LINE_DELIVERY_PRE_L, &dlg_attr.refcyc_per_line_delivery_pre_l,\n\t\tREFCYC_PER_LINE_DELIVERY_PRE_C, &dlg_attr.refcyc_per_line_delivery_pre_c);\n\tREG_GET(VBLANK_PARAMETERS_2,\n\t\tREFCYC_PER_PTE_GROUP_VBLANK_C, &dlg_attr.refcyc_per_pte_group_vblank_c);\n\tif (REG(NOM_PARAMETERS_2))\n\t\tREG_GET(NOM_PARAMETERS_2,\n\t\t\tDST_Y_PER_PTE_ROW_NOM_C, &dlg_attr.dst_y_per_pte_row_nom_c);\n\tif (REG(NOM_PARAMETERS_3))\n\t\tREG_GET(NOM_PARAMETERS_3,\n\t\t\tREFCYC_PER_PTE_GROUP_NOM_C, &dlg_attr.refcyc_per_pte_group_nom_c);\n\tREG_GET(NOM_PARAMETERS_6,\n\t\tDST_Y_PER_META_ROW_NOM_C, &dlg_attr.dst_y_per_meta_row_nom_c);\n\tREG_GET(NOM_PARAMETERS_7,\n\t\tREFCYC_PER_META_CHUNK_NOM_C, &dlg_attr.refcyc_per_meta_chunk_nom_c);\n\tREG_GET(VBLANK_PARAMETERS_3,\n\t\t\tREFCYC_PER_META_CHUNK_VBLANK_L, &dlg_attr.refcyc_per_meta_chunk_vblank_l);\n\tREG_GET(VBLANK_PARAMETERS_4,\n\t\t\tREFCYC_PER_META_CHUNK_VBLANK_C, &dlg_attr.refcyc_per_meta_chunk_vblank_c);\n\n\tif (dlg_attr.refcyc_per_pte_group_vblank_l != dml_dlg_attr->refcyc_per_pte_group_vblank_l)\n\t\tDC_LOG_DEBUG(\"DML Validation | VBLANK_PARAMETERS_1:REFCYC_PER_PTE_GROUP_VBLANK_L - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_dlg_attr->refcyc_per_pte_group_vblank_l, dlg_attr.refcyc_per_pte_group_vblank_l);\n\tif (dlg_attr.dst_y_per_pte_row_nom_l != dml_dlg_attr->dst_y_per_pte_row_nom_l)\n\t\tDC_LOG_DEBUG(\"DML Validation | NOM_PARAMETERS_0:DST_Y_PER_PTE_ROW_NOM_L - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_dlg_attr->dst_y_per_pte_row_nom_l, dlg_attr.dst_y_per_pte_row_nom_l);\n\tif (dlg_attr.refcyc_per_pte_group_nom_l != dml_dlg_attr->refcyc_per_pte_group_nom_l)\n\t\tDC_LOG_DEBUG(\"DML Validation | NOM_PARAMETERS_1:REFCYC_PER_PTE_GROUP_NOM_L - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_dlg_attr->refcyc_per_pte_group_nom_l, dlg_attr.refcyc_per_pte_group_nom_l);\n\tif (dlg_attr.dst_y_per_meta_row_nom_l != dml_dlg_attr->dst_y_per_meta_row_nom_l)\n\t\tDC_LOG_DEBUG(\"DML Validation | NOM_PARAMETERS_4:DST_Y_PER_META_ROW_NOM_L - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_dlg_attr->dst_y_per_meta_row_nom_l, dlg_attr.dst_y_per_meta_row_nom_l);\n\tif (dlg_attr.refcyc_per_meta_chunk_nom_l != dml_dlg_attr->refcyc_per_meta_chunk_nom_l)\n\t\tDC_LOG_DEBUG(\"DML Validation | NOM_PARAMETERS_5:REFCYC_PER_META_CHUNK_NOM_L - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_dlg_attr->refcyc_per_meta_chunk_nom_l, dlg_attr.refcyc_per_meta_chunk_nom_l);\n\tif (dlg_attr.refcyc_per_line_delivery_l != dml_dlg_attr->refcyc_per_line_delivery_l)\n\t\tDC_LOG_DEBUG(\"DML Validation | PER_LINE_DELIVERY:REFCYC_PER_LINE_DELIVERY_L - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_dlg_attr->refcyc_per_line_delivery_l, dlg_attr.refcyc_per_line_delivery_l);\n\tif (dlg_attr.refcyc_per_line_delivery_c != dml_dlg_attr->refcyc_per_line_delivery_c)\n\t\tDC_LOG_DEBUG(\"DML Validation | PER_LINE_DELIVERY:REFCYC_PER_LINE_DELIVERY_C - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_dlg_attr->refcyc_per_line_delivery_c, dlg_attr.refcyc_per_line_delivery_c);\n\tif (dlg_attr.refcyc_per_pte_group_vblank_c != dml_dlg_attr->refcyc_per_pte_group_vblank_c)\n\t\tDC_LOG_DEBUG(\"DML Validation | VBLANK_PARAMETERS_2:REFCYC_PER_PTE_GROUP_VBLANK_C - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_dlg_attr->refcyc_per_pte_group_vblank_c, dlg_attr.refcyc_per_pte_group_vblank_c);\n\tif (dlg_attr.dst_y_per_pte_row_nom_c != dml_dlg_attr->dst_y_per_pte_row_nom_c)\n\t\tDC_LOG_DEBUG(\"DML Validation | NOM_PARAMETERS_2:DST_Y_PER_PTE_ROW_NOM_C - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_dlg_attr->dst_y_per_pte_row_nom_c, dlg_attr.dst_y_per_pte_row_nom_c);\n\tif (dlg_attr.refcyc_per_pte_group_nom_c != dml_dlg_attr->refcyc_per_pte_group_nom_c)\n\t\tDC_LOG_DEBUG(\"DML Validation | NOM_PARAMETERS_3:REFCYC_PER_PTE_GROUP_NOM_C - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_dlg_attr->refcyc_per_pte_group_nom_c, dlg_attr.refcyc_per_pte_group_nom_c);\n\tif (dlg_attr.dst_y_per_meta_row_nom_c != dml_dlg_attr->dst_y_per_meta_row_nom_c)\n\t\tDC_LOG_DEBUG(\"DML Validation | NOM_PARAMETERS_6:DST_Y_PER_META_ROW_NOM_C - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_dlg_attr->dst_y_per_meta_row_nom_c, dlg_attr.dst_y_per_meta_row_nom_c);\n\tif (dlg_attr.refcyc_per_meta_chunk_nom_c != dml_dlg_attr->refcyc_per_meta_chunk_nom_c)\n\t\tDC_LOG_DEBUG(\"DML Validation | NOM_PARAMETERS_7:REFCYC_PER_META_CHUNK_NOM_C - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_dlg_attr->refcyc_per_meta_chunk_nom_c, dlg_attr.refcyc_per_meta_chunk_nom_c);\n\tif (dlg_attr.refcyc_per_line_delivery_pre_l != dml_dlg_attr->refcyc_per_line_delivery_pre_l)\n\t\tDC_LOG_DEBUG(\"DML Validation | PER_LINE_DELIVERY_PRE:REFCYC_PER_LINE_DELIVERY_PRE_L - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_dlg_attr->refcyc_per_line_delivery_pre_l, dlg_attr.refcyc_per_line_delivery_pre_l);\n\tif (dlg_attr.refcyc_per_line_delivery_pre_c != dml_dlg_attr->refcyc_per_line_delivery_pre_c)\n\t\tDC_LOG_DEBUG(\"DML Validation | PER_LINE_DELIVERY_PRE:REFCYC_PER_LINE_DELIVERY_PRE_C - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_dlg_attr->refcyc_per_line_delivery_pre_c, dlg_attr.refcyc_per_line_delivery_pre_c);\n\tif (dlg_attr.refcyc_per_meta_chunk_vblank_l != dml_dlg_attr->refcyc_per_meta_chunk_vblank_l)\n\t\tDC_LOG_DEBUG(\"DML Validation | VBLANK_PARAMETERS_3:REFCYC_PER_META_CHUNK_VBLANK_L - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_dlg_attr->refcyc_per_meta_chunk_vblank_l, dlg_attr.refcyc_per_meta_chunk_vblank_l);\n\tif (dlg_attr.refcyc_per_meta_chunk_vblank_c != dml_dlg_attr->refcyc_per_meta_chunk_vblank_c)\n\t\tDC_LOG_DEBUG(\"DML Validation | VBLANK_PARAMETERS_4:REFCYC_PER_META_CHUNK_VBLANK_C - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_dlg_attr->refcyc_per_meta_chunk_vblank_c, dlg_attr.refcyc_per_meta_chunk_vblank_c);\n\n\t \n\tREG_GET_2(DCN_TTU_QOS_WM,\n\t\tQoS_LEVEL_LOW_WM, &ttu_attr.qos_level_low_wm,\n\t\tQoS_LEVEL_HIGH_WM, &ttu_attr.qos_level_high_wm);\n\n\tif (ttu_attr.qos_level_low_wm != dml_ttu_attr->qos_level_low_wm)\n\t\tDC_LOG_DEBUG(\"DML Validation | DCN_TTU_QOS_WM:QoS_LEVEL_LOW_WM - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_ttu_attr->qos_level_low_wm, ttu_attr.qos_level_low_wm);\n\tif (ttu_attr.qos_level_high_wm != dml_ttu_attr->qos_level_high_wm)\n\t\tDC_LOG_DEBUG(\"DML Validation | DCN_TTU_QOS_WM:QoS_LEVEL_HIGH_WM - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_ttu_attr->qos_level_high_wm, ttu_attr.qos_level_high_wm);\n\n\t \n\t \n\tREG_GET_3(DCN_SURF0_TTU_CNTL0,\n\t\tREFCYC_PER_REQ_DELIVERY, &ttu_attr.refcyc_per_req_delivery_l,\n\t\tQoS_LEVEL_FIXED, &ttu_attr.qos_level_fixed_l,\n\t\tQoS_RAMP_DISABLE, &ttu_attr.qos_ramp_disable_l);\n\tREG_GET_3(DCN_SURF1_TTU_CNTL0,\n\t\tREFCYC_PER_REQ_DELIVERY, &ttu_attr.refcyc_per_req_delivery_c,\n\t\tQoS_LEVEL_FIXED, &ttu_attr.qos_level_fixed_c,\n\t\tQoS_RAMP_DISABLE, &ttu_attr.qos_ramp_disable_c);\n\tREG_GET_3(DCN_CUR0_TTU_CNTL0,\n\t\tREFCYC_PER_REQ_DELIVERY, &ttu_attr.refcyc_per_req_delivery_cur0,\n\t\tQoS_LEVEL_FIXED, &ttu_attr.qos_level_fixed_cur0,\n\t\tQoS_RAMP_DISABLE, &ttu_attr.qos_ramp_disable_cur0);\n\tREG_GET(FLIP_PARAMETERS_1,\n\t\tREFCYC_PER_PTE_GROUP_FLIP_L, &dlg_attr.refcyc_per_pte_group_flip_l);\n\tREG_GET(DCN_CUR0_TTU_CNTL1,\n\t\t\tREFCYC_PER_REQ_DELIVERY_PRE, &ttu_attr.refcyc_per_req_delivery_pre_cur0);\n\tREG_GET(DCN_CUR1_TTU_CNTL1,\n\t\t\tREFCYC_PER_REQ_DELIVERY_PRE, &ttu_attr.refcyc_per_req_delivery_pre_cur1);\n\tREG_GET(DCN_SURF0_TTU_CNTL1,\n\t\t\tREFCYC_PER_REQ_DELIVERY_PRE, &ttu_attr.refcyc_per_req_delivery_pre_l);\n\tREG_GET(DCN_SURF1_TTU_CNTL1,\n\t\t\tREFCYC_PER_REQ_DELIVERY_PRE, &ttu_attr.refcyc_per_req_delivery_pre_c);\n\n\tif (ttu_attr.refcyc_per_req_delivery_l != dml_ttu_attr->refcyc_per_req_delivery_l)\n\t\tDC_LOG_DEBUG(\"DML Validation | DCN_SURF0_TTU_CNTL0:REFCYC_PER_REQ_DELIVERY - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_ttu_attr->refcyc_per_req_delivery_l, ttu_attr.refcyc_per_req_delivery_l);\n\tif (ttu_attr.qos_level_fixed_l != dml_ttu_attr->qos_level_fixed_l)\n\t\tDC_LOG_DEBUG(\"DML Validation | DCN_SURF0_TTU_CNTL0:QoS_LEVEL_FIXED - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_ttu_attr->qos_level_fixed_l, ttu_attr.qos_level_fixed_l);\n\tif (ttu_attr.qos_ramp_disable_l != dml_ttu_attr->qos_ramp_disable_l)\n\t\tDC_LOG_DEBUG(\"DML Validation | DCN_SURF0_TTU_CNTL0:QoS_RAMP_DISABLE - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_ttu_attr->qos_ramp_disable_l, ttu_attr.qos_ramp_disable_l);\n\tif (ttu_attr.refcyc_per_req_delivery_c != dml_ttu_attr->refcyc_per_req_delivery_c)\n\t\tDC_LOG_DEBUG(\"DML Validation | DCN_SURF1_TTU_CNTL0:REFCYC_PER_REQ_DELIVERY - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_ttu_attr->refcyc_per_req_delivery_c, ttu_attr.refcyc_per_req_delivery_c);\n\tif (ttu_attr.qos_level_fixed_c != dml_ttu_attr->qos_level_fixed_c)\n\t\tDC_LOG_DEBUG(\"DML Validation | DCN_SURF1_TTU_CNTL0:QoS_LEVEL_FIXED - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_ttu_attr->qos_level_fixed_c, ttu_attr.qos_level_fixed_c);\n\tif (ttu_attr.qos_ramp_disable_c != dml_ttu_attr->qos_ramp_disable_c)\n\t\tDC_LOG_DEBUG(\"DML Validation | DCN_SURF1_TTU_CNTL0:QoS_RAMP_DISABLE - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_ttu_attr->qos_ramp_disable_c, ttu_attr.qos_ramp_disable_c);\n\tif (ttu_attr.refcyc_per_req_delivery_cur0 != dml_ttu_attr->refcyc_per_req_delivery_cur0)\n\t\tDC_LOG_DEBUG(\"DML Validation | DCN_CUR0_TTU_CNTL0:REFCYC_PER_REQ_DELIVERY - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_ttu_attr->refcyc_per_req_delivery_cur0, ttu_attr.refcyc_per_req_delivery_cur0);\n\tif (ttu_attr.qos_level_fixed_cur0 != dml_ttu_attr->qos_level_fixed_cur0)\n\t\tDC_LOG_DEBUG(\"DML Validation | DCN_CUR0_TTU_CNTL0:QoS_LEVEL_FIXED - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_ttu_attr->qos_level_fixed_cur0, ttu_attr.qos_level_fixed_cur0);\n\tif (ttu_attr.qos_ramp_disable_cur0 != dml_ttu_attr->qos_ramp_disable_cur0)\n\t\tDC_LOG_DEBUG(\"DML Validation | DCN_CUR0_TTU_CNTL0:QoS_RAMP_DISABLE - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_ttu_attr->qos_ramp_disable_cur0, ttu_attr.qos_ramp_disable_cur0);\n\tif (dlg_attr.refcyc_per_pte_group_flip_l != dml_dlg_attr->refcyc_per_pte_group_flip_l)\n\t\tDC_LOG_DEBUG(\"DML Validation | FLIP_PARAMETERS_1:REFCYC_PER_PTE_GROUP_FLIP_L - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_dlg_attr->refcyc_per_pte_group_flip_l, dlg_attr.refcyc_per_pte_group_flip_l);\n\tif (ttu_attr.refcyc_per_req_delivery_pre_cur0 != dml_ttu_attr->refcyc_per_req_delivery_pre_cur0)\n\t\tDC_LOG_DEBUG(\"DML Validation | DCN_CUR0_TTU_CNTL1:REFCYC_PER_REQ_DELIVERY_PRE - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_ttu_attr->refcyc_per_req_delivery_pre_cur0, ttu_attr.refcyc_per_req_delivery_pre_cur0);\n\tif (ttu_attr.refcyc_per_req_delivery_pre_cur1 != dml_ttu_attr->refcyc_per_req_delivery_pre_cur1)\n\t\tDC_LOG_DEBUG(\"DML Validation | DCN_CUR1_TTU_CNTL1:REFCYC_PER_REQ_DELIVERY_PRE - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_ttu_attr->refcyc_per_req_delivery_pre_cur1, ttu_attr.refcyc_per_req_delivery_pre_cur1);\n\tif (ttu_attr.refcyc_per_req_delivery_pre_l != dml_ttu_attr->refcyc_per_req_delivery_pre_l)\n\t\tDC_LOG_DEBUG(\"DML Validation | DCN_SURF0_TTU_CNTL1:REFCYC_PER_REQ_DELIVERY_PRE - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_ttu_attr->refcyc_per_req_delivery_pre_l, ttu_attr.refcyc_per_req_delivery_pre_l);\n\tif (ttu_attr.refcyc_per_req_delivery_pre_c != dml_ttu_attr->refcyc_per_req_delivery_pre_c)\n\t\tDC_LOG_DEBUG(\"DML Validation | DCN_SURF1_TTU_CNTL1:REFCYC_PER_REQ_DELIVERY_PRE - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_ttu_attr->refcyc_per_req_delivery_pre_c, ttu_attr.refcyc_per_req_delivery_pre_c);\n}\n\nstatic struct hubp_funcs dcn20_hubp_funcs = {\n\t.hubp_enable_tripleBuffer = hubp2_enable_triplebuffer,\n\t.hubp_is_triplebuffer_enabled = hubp2_is_triplebuffer_enabled,\n\t.hubp_program_surface_flip_and_addr = hubp2_program_surface_flip_and_addr,\n\t.hubp_program_surface_config = hubp2_program_surface_config,\n\t.hubp_is_flip_pending = hubp2_is_flip_pending,\n\t.hubp_setup = hubp2_setup,\n\t.hubp_setup_interdependent = hubp2_setup_interdependent,\n\t.hubp_set_vm_system_aperture_settings = hubp2_set_vm_system_aperture_settings,\n\t.set_blank = hubp2_set_blank,\n\t.set_blank_regs = hubp2_set_blank_regs,\n\t.dcc_control = hubp2_dcc_control,\n\t.mem_program_viewport = min_set_viewport,\n\t.set_cursor_attributes\t= hubp2_cursor_set_attributes,\n\t.set_cursor_position\t= hubp2_cursor_set_position,\n\t.hubp_clk_cntl = hubp2_clk_cntl,\n\t.hubp_vtg_sel = hubp2_vtg_sel,\n\t.dmdata_set_attributes = hubp2_dmdata_set_attributes,\n\t.dmdata_load = hubp2_dmdata_load,\n\t.dmdata_status_done = hubp2_dmdata_status_done,\n\t.hubp_read_state = hubp2_read_state,\n\t.hubp_clear_underflow = hubp2_clear_underflow,\n\t.hubp_set_flip_control_surface_gsl = hubp2_set_flip_control_surface_gsl,\n\t.hubp_init = hubp1_init,\n\t.validate_dml_output = hubp2_validate_dml_output,\n\t.hubp_in_blank = hubp1_in_blank,\n\t.hubp_soft_reset = hubp1_soft_reset,\n\t.hubp_set_flip_int = hubp1_set_flip_int,\n};\n\n\nbool hubp2_construct(\n\tstruct dcn20_hubp *hubp2,\n\tstruct dc_context *ctx,\n\tuint32_t inst,\n\tconst struct dcn_hubp2_registers *hubp_regs,\n\tconst struct dcn_hubp2_shift *hubp_shift,\n\tconst struct dcn_hubp2_mask *hubp_mask)\n{\n\thubp2->base.funcs = &dcn20_hubp_funcs;\n\thubp2->base.ctx = ctx;\n\thubp2->hubp_regs = hubp_regs;\n\thubp2->hubp_shift = hubp_shift;\n\thubp2->hubp_mask = hubp_mask;\n\thubp2->base.inst = inst;\n\thubp2->base.opp_id = OPP_ID_INVALID;\n\thubp2->base.mpcc_id = 0xf;\n\n\treturn true;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}