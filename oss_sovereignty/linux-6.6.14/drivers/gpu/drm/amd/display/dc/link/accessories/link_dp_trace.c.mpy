{
  "module_name": "link_dp_trace.c",
  "hash_id": "f2d03db858797d1a843728e02c47c5e2cd330dcaca317399fb491bb55c0d8a13",
  "original_prompt": "Ingested from linux-6.6.14/drivers/gpu/drm/amd/display/dc/link/accessories/link_dp_trace.c",
  "human_readable_source": " \n#include \"link_dp_trace.h\"\n#include \"link/protocols/link_dpcd.h\"\n#include \"link.h\"\n\nvoid dp_trace_init(struct dc_link *link)\n{\n\tmemset(&link->dp_trace, 0, sizeof(link->dp_trace));\n\tlink->dp_trace.is_initialized = true;\n}\n\nvoid dp_trace_reset(struct dc_link *link)\n{\n\tmemset(&link->dp_trace, 0, sizeof(link->dp_trace));\n}\n\nbool dp_trace_is_initialized(struct dc_link *link)\n{\n\treturn link->dp_trace.is_initialized;\n}\n\nvoid dp_trace_detect_lt_init(struct dc_link *link)\n{\n\tmemset(&link->dp_trace.detect_lt_trace, 0, sizeof(link->dp_trace.detect_lt_trace));\n}\n\nvoid dp_trace_commit_lt_init(struct dc_link *link)\n{\n\tmemset(&link->dp_trace.commit_lt_trace, 0, sizeof(link->dp_trace.commit_lt_trace));\n}\n\nvoid dp_trace_link_loss_increment(struct dc_link *link)\n{\n\tlink->dp_trace.link_loss_count++;\n}\n\nvoid dp_trace_lt_fail_count_update(struct dc_link *link,\n\t\tunsigned int fail_count,\n\t\tbool in_detection)\n{\n\tif (in_detection)\n\t\tlink->dp_trace.detect_lt_trace.counts.fail = fail_count;\n\telse\n\t\tlink->dp_trace.commit_lt_trace.counts.fail = fail_count;\n}\n\nvoid dp_trace_lt_total_count_increment(struct dc_link *link,\n\t\tbool in_detection)\n{\n\tif (in_detection)\n\t\tlink->dp_trace.detect_lt_trace.counts.total++;\n\telse\n\t\tlink->dp_trace.commit_lt_trace.counts.total++;\n}\n\nvoid dp_trace_set_is_logged_flag(struct dc_link *link,\n\t\tbool in_detection,\n\t\tbool is_logged)\n{\n\tif (in_detection)\n\t\tlink->dp_trace.detect_lt_trace.is_logged = is_logged;\n\telse\n\t\tlink->dp_trace.commit_lt_trace.is_logged = is_logged;\n}\n\nbool dp_trace_is_logged(struct dc_link *link, bool in_detection)\n{\n\tif (in_detection)\n\t\treturn link->dp_trace.detect_lt_trace.is_logged;\n\telse\n\t\treturn link->dp_trace.commit_lt_trace.is_logged;\n}\n\nvoid dp_trace_lt_result_update(struct dc_link *link,\n\t\tenum link_training_result result,\n\t\tbool in_detection)\n{\n\tif (in_detection)\n\t\tlink->dp_trace.detect_lt_trace.result = result;\n\telse\n\t\tlink->dp_trace.commit_lt_trace.result = result;\n}\n\nvoid dp_trace_set_lt_start_timestamp(struct dc_link *link,\n\t\tbool in_detection)\n{\n\tif (in_detection)\n\t\tlink->dp_trace.detect_lt_trace.timestamps.start = dm_get_timestamp(link->dc->ctx);\n\telse\n\t\tlink->dp_trace.commit_lt_trace.timestamps.start = dm_get_timestamp(link->dc->ctx);\n}\n\nvoid dp_trace_set_lt_end_timestamp(struct dc_link *link,\n\t\tbool in_detection)\n{\n\tif (in_detection)\n\t\tlink->dp_trace.detect_lt_trace.timestamps.end = dm_get_timestamp(link->dc->ctx);\n\telse\n\t\tlink->dp_trace.commit_lt_trace.timestamps.end = dm_get_timestamp(link->dc->ctx);\n}\n\nunsigned long long dp_trace_get_lt_end_timestamp(struct dc_link *link,\n\t\tbool in_detection)\n{\n\tif (in_detection)\n\t\treturn link->dp_trace.detect_lt_trace.timestamps.end;\n\telse\n\t\treturn link->dp_trace.commit_lt_trace.timestamps.end;\n}\n\nconst struct dp_trace_lt_counts *dp_trace_get_lt_counts(struct dc_link *link,\n\t\tbool in_detection)\n{\n\tif (in_detection)\n\t\treturn &link->dp_trace.detect_lt_trace.counts;\n\telse\n\t\treturn &link->dp_trace.commit_lt_trace.counts;\n}\n\nunsigned int dp_trace_get_link_loss_count(struct dc_link *link)\n{\n\treturn link->dp_trace.link_loss_count;\n}\n\nvoid dp_trace_set_edp_power_timestamp(struct dc_link *link,\n\t\tbool power_up)\n{\n\tif (!power_up)\n\t\t \n\t\tlink->dp_trace.edp_trace_power_timestamps.poweroff = dm_get_timestamp(link->dc->ctx);\n\telse\n\t\tlink->dp_trace.edp_trace_power_timestamps.poweron = dm_get_timestamp(link->dc->ctx);\n}\n\nuint64_t dp_trace_get_edp_poweron_timestamp(struct dc_link *link)\n{\n\treturn link->dp_trace.edp_trace_power_timestamps.poweron;\n}\n\nuint64_t dp_trace_get_edp_poweroff_timestamp(struct dc_link *link)\n{\n\treturn link->dp_trace.edp_trace_power_timestamps.poweroff;\n}\n\nvoid dp_trace_source_sequence(struct dc_link *link, uint8_t dp_test_mode)\n{\n\tif (link != NULL && link->dc->debug.enable_driver_sequence_debug)\n\t\tcore_link_write_dpcd(link, DP_SOURCE_SEQUENCE,\n\t\t\t\t\t&dp_test_mode, sizeof(dp_test_mode));\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}