{
  "module_name": "hw_factory_dce80.c",
  "hash_id": "7531d6f9800ea1fb563f19036d4b9a679488e8e2689da01a2d2427fc69665088",
  "original_prompt": "Ingested from linux-6.6.14/drivers/gpu/drm/amd/display/dc/gpio/dce80/hw_factory_dce80.c",
  "human_readable_source": " \n\n#include \"dm_services.h\"\n#include \"include/gpio_types.h\"\n#include \"../hw_factory.h\"\n\n#include \"hw_factory_dce80.h\"\n\n#include \"../hw_gpio.h\"\n#include \"../hw_ddc.h\"\n#include \"../hw_hpd.h\"\n#include \"../hw_generic.h\"\n\n#include \"dce/dce_8_0_d.h\"\n#include \"dce/dce_8_0_sh_mask.h\"\n\n\n#define REG(reg_name)\\\n\t\tmm ## reg_name\n\n#include \"reg_helper.h\"\n#include \"../hpd_regs.h\"\n\n#define HPD_REG_LIST_DCE8(id) \\\n\tHPD_GPIO_REG_LIST(id), \\\n\t.int_status = mmDC_HPD ## id ## _INT_STATUS,\\\n\t.toggle_filt_cntl = mmDC_HPD ## id ## _TOGGLE_FILT_CNTL\n\n#define HPD_MASK_SH_LIST_DCE8(mask_sh) \\\n\t\t.DC_HPD_SENSE_DELAYED = DC_HPD1_INT_STATUS__DC_HPD1_SENSE_DELAYED ## mask_sh,\\\n\t\t.DC_HPD_SENSE = DC_HPD1_INT_STATUS__DC_HPD1_SENSE ## mask_sh,\\\n\t\t.DC_HPD_CONNECT_INT_DELAY = DC_HPD1_TOGGLE_FILT_CNTL__DC_HPD1_CONNECT_INT_DELAY ## mask_sh,\\\n\t\t.DC_HPD_DISCONNECT_INT_DELAY = DC_HPD1_TOGGLE_FILT_CNTL__DC_HPD1_DISCONNECT_INT_DELAY ## mask_sh\n\n#define hpd_regs(id) \\\n{\\\n\tHPD_REG_LIST_DCE8(id)\\\n}\n\nstatic const struct hpd_registers hpd_regs[] = {\n\thpd_regs(1),\n\thpd_regs(2),\n\thpd_regs(3),\n\thpd_regs(4),\n\thpd_regs(5),\n\thpd_regs(6)\n};\n\nstatic const struct hpd_sh_mask hpd_shift = {\n\t\tHPD_MASK_SH_LIST_DCE8(__SHIFT)\n};\n\nstatic const struct hpd_sh_mask hpd_mask = {\n\t\tHPD_MASK_SH_LIST_DCE8(_MASK)\n};\n\n#include \"../ddc_regs.h\"\n\n  \n#define SF_DDC(reg_name, field_name, post_fix)\\\n\t.field_name = reg_name ## __ ## field_name ## post_fix\n\nstatic const struct ddc_registers ddc_data_regs[] = {\n\tddc_data_regs(1),\n\tddc_data_regs(2),\n\tddc_data_regs(3),\n\tddc_data_regs(4),\n\tddc_data_regs(5),\n\tddc_data_regs(6),\n\tddc_vga_data_regs,\n\tddc_i2c_data_regs\n};\n\nstatic const struct ddc_registers ddc_clk_regs[] = {\n\tddc_clk_regs(1),\n\tddc_clk_regs(2),\n\tddc_clk_regs(3),\n\tddc_clk_regs(4),\n\tddc_clk_regs(5),\n\tddc_clk_regs(6),\n\tddc_vga_clk_regs,\n\tddc_i2c_clk_regs\n};\n\nstatic const struct ddc_sh_mask ddc_shift = {\n\t\tDDC_MASK_SH_LIST(__SHIFT)\n};\n\nstatic const struct ddc_sh_mask ddc_mask = {\n\t\tDDC_MASK_SH_LIST(_MASK)\n};\n\nstatic void define_ddc_registers(\n\t\tstruct hw_gpio_pin *pin,\n\t\tuint32_t en)\n{\n\tstruct hw_ddc *ddc = HW_DDC_FROM_BASE(pin);\n\n\tswitch (pin->id) {\n\tcase GPIO_ID_DDC_DATA:\n\t\tddc->regs = &ddc_data_regs[en];\n\t\tddc->base.regs = &ddc_data_regs[en].gpio;\n\t\tbreak;\n\tcase GPIO_ID_DDC_CLOCK:\n\t\tddc->regs = &ddc_clk_regs[en];\n\t\tddc->base.regs = &ddc_clk_regs[en].gpio;\n\t\tbreak;\n\tdefault:\n\t\tASSERT_CRITICAL(false);\n\t\treturn;\n\t}\n\n\tddc->shifts = &ddc_shift;\n\tddc->masks = &ddc_mask;\n\n}\n\nstatic void define_hpd_registers(struct hw_gpio_pin *pin, uint32_t en)\n{\n\tstruct hw_hpd *hpd = HW_HPD_FROM_BASE(pin);\n\n\thpd->regs = &hpd_regs[en];\n\thpd->shifts = &hpd_shift;\n\thpd->masks = &hpd_mask;\n\thpd->base.regs = &hpd_regs[en].gpio;\n}\n\nstatic const struct hw_factory_funcs funcs = {\n\t.init_ddc_data = dal_hw_ddc_init,\n\t.init_generic = NULL,\n\t.init_hpd = dal_hw_hpd_init,\n\t.get_ddc_pin = dal_hw_ddc_get_pin,\n\t.get_hpd_pin = dal_hw_hpd_get_pin,\n\t.get_generic_pin = NULL,\n\t.define_hpd_registers = define_hpd_registers,\n\t.define_ddc_registers = define_ddc_registers\n};\n\nvoid dal_hw_factory_dce80_init(\n\tstruct hw_factory *factory)\n{\n\tfactory->number_of_pins[GPIO_ID_DDC_DATA] = 8;\n\tfactory->number_of_pins[GPIO_ID_DDC_CLOCK] = 8;\n\tfactory->number_of_pins[GPIO_ID_GENERIC] = 7;\n\tfactory->number_of_pins[GPIO_ID_HPD] = 6;\n\tfactory->number_of_pins[GPIO_ID_GPIO_PAD] = 31;\n\tfactory->number_of_pins[GPIO_ID_VIP_PAD] = 0;\n\tfactory->number_of_pins[GPIO_ID_SYNC] = 2;\n\tfactory->number_of_pins[GPIO_ID_GSL] = 4;\n\n\tfactory->funcs = &funcs;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}