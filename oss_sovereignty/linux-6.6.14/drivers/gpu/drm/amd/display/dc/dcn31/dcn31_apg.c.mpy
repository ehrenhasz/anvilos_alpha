{
  "module_name": "dcn31_apg.c",
  "hash_id": "eed51c97329fa878d1d09e20f6185f942d0a2084ceccee119bb48e1d590690b1",
  "original_prompt": "Ingested from linux-6.6.14/drivers/gpu/drm/amd/display/dc/dcn31/dcn31_apg.c",
  "human_readable_source": " \n\n\n#include \"dc_bios_types.h\"\n#include \"hw_shared.h\"\n#include \"dcn31_apg.h\"\n#include \"reg_helper.h\"\n\n#define DC_LOGGER \\\n\t\tapg31->base.ctx->logger\n\n#define REG(reg)\\\n\t(apg31->regs->reg)\n\n#undef FN\n#define FN(reg_name, field_name) \\\n\tapg31->apg_shift->field_name, apg31->apg_mask->field_name\n\n\n#define CTX \\\n\tapg31->base.ctx\n\n\nstatic void apg31_enable(\n\tstruct apg *apg)\n{\n\tstruct dcn31_apg *apg31 = DCN31_APG_FROM_APG(apg);\n\n\t \n\tREG_UPDATE(APG_CONTROL, APG_RESET, 1);\n\tREG_WAIT(APG_CONTROL,\n\t\t\tAPG_RESET_DONE, 1,\n\t\t\t1, 10);\n\tREG_UPDATE(APG_CONTROL, APG_RESET, 0);\n\tREG_WAIT(APG_CONTROL,\n\t\t\tAPG_RESET_DONE, 0,\n\t\t\t1, 10);\n\n\t \n\tREG_UPDATE(APG_CONTROL2, APG_ENABLE, 1);\n}\n\nstatic void apg31_disable(\n\tstruct apg *apg)\n{\n\tstruct dcn31_apg *apg31 = DCN31_APG_FROM_APG(apg);\n\n\t \n\tREG_UPDATE(APG_CONTROL2, APG_ENABLE, 0);\n}\n\nstatic void apg31_se_audio_setup(\n\tstruct apg *apg,\n\tunsigned int az_inst,\n\tstruct audio_info *audio_info)\n{\n\tstruct dcn31_apg *apg31 = DCN31_APG_FROM_APG(apg);\n\n\tASSERT(audio_info);\n\t \n\tif (audio_info == NULL)\n\t\treturn;\n\n\t \n\tREG_UPDATE(APG_CONTROL2, APG_DP_AUDIO_STREAM_ID, 0);\n\n\t \n\tREG_UPDATE(APG_DBG_GEN_CONTROL, APG_DBG_AUDIO_CHANNEL_ENABLE, 0xFF);\n\n\t \n\tREG_UPDATE(APG_MEM_PWR, APG_MEM_PWR_FORCE, 0);\n}\n\nstatic struct apg_funcs dcn31_apg_funcs = {\n\t.se_audio_setup\t\t\t= apg31_se_audio_setup,\n\t.enable_apg\t\t\t= apg31_enable,\n\t.disable_apg\t\t\t= apg31_disable,\n};\n\nvoid apg31_construct(struct dcn31_apg *apg31,\n\tstruct dc_context *ctx,\n\tuint32_t inst,\n\tconst struct dcn31_apg_registers *apg_regs,\n\tconst struct dcn31_apg_shift *apg_shift,\n\tconst struct dcn31_apg_mask *apg_mask)\n{\n\tapg31->base.ctx = ctx;\n\n\tapg31->base.inst = inst;\n\tapg31->base.funcs = &dcn31_apg_funcs;\n\n\tapg31->regs = apg_regs;\n\tapg31->apg_shift = apg_shift;\n\tapg31->apg_mask = apg_mask;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}