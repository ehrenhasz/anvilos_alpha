{
  "module_name": "dcn21_hubp.c",
  "hash_id": "cf05403b3c4475a162a8bf46917ceaf2107e2214b53fb654e3cd4ecab30c3afb",
  "original_prompt": "Ingested from linux-6.6.14/drivers/gpu/drm/amd/display/dc/dcn21/dcn21_hubp.c",
  "human_readable_source": " \n\n#include \"dcn10/dcn10_hubp.h\"\n#include \"dcn21_hubp.h\"\n\n#include \"dm_services.h\"\n#include \"reg_helper.h\"\n\n#include \"dc_dmub_srv.h\"\n\n#define DC_LOGGER_INIT(logger)\n\n#define REG(reg)\\\n\thubp21->hubp_regs->reg\n\n#define CTX \\\n\thubp21->base.ctx\n\n#undef FN\n#define FN(reg_name, field_name) \\\n\thubp21->hubp_shift->field_name, hubp21->hubp_mask->field_name\n\n \nvoid apply_DEDCN21_142_wa_for_hostvm_deadline(\n\t\tstruct hubp *hubp,\n\t\tstruct _vcs_dpi_display_dlg_regs_st *dlg_attr)\n{\n\tstruct dcn21_hubp *hubp21 = TO_DCN21_HUBP(hubp);\n\tuint32_t refcyc_per_vm_group_vblank;\n\tuint32_t refcyc_per_vm_req_vblank;\n\tuint32_t refcyc_per_vm_group_flip;\n\tuint32_t refcyc_per_vm_req_flip;\n\tconst uint32_t uninitialized_hw_default = 0;\n\n\tREG_GET(VBLANK_PARAMETERS_5,\n\t\t\tREFCYC_PER_VM_GROUP_VBLANK, &refcyc_per_vm_group_vblank);\n\n\tif (refcyc_per_vm_group_vblank == uninitialized_hw_default ||\n\t\t\trefcyc_per_vm_group_vblank > dlg_attr->refcyc_per_vm_group_vblank)\n\t\tREG_SET(VBLANK_PARAMETERS_5, 0,\n\t\t\t\tREFCYC_PER_VM_GROUP_VBLANK, dlg_attr->refcyc_per_vm_group_vblank);\n\n\tREG_GET(VBLANK_PARAMETERS_6,\n\t\t\tREFCYC_PER_VM_REQ_VBLANK, &refcyc_per_vm_req_vblank);\n\n\tif (refcyc_per_vm_req_vblank == uninitialized_hw_default ||\n\t\t\trefcyc_per_vm_req_vblank > dlg_attr->refcyc_per_vm_req_vblank)\n\t\tREG_SET(VBLANK_PARAMETERS_6, 0,\n\t\t\t\tREFCYC_PER_VM_REQ_VBLANK, dlg_attr->refcyc_per_vm_req_vblank);\n\n\tREG_GET(FLIP_PARAMETERS_3,\n\t\t\tREFCYC_PER_VM_GROUP_FLIP, &refcyc_per_vm_group_flip);\n\n\tif (refcyc_per_vm_group_flip == uninitialized_hw_default ||\n\t\t\trefcyc_per_vm_group_flip > dlg_attr->refcyc_per_vm_group_flip)\n\t\tREG_SET(FLIP_PARAMETERS_3, 0,\n\t\t\t\tREFCYC_PER_VM_GROUP_FLIP, dlg_attr->refcyc_per_vm_group_flip);\n\n\tREG_GET(FLIP_PARAMETERS_4,\n\t\t\tREFCYC_PER_VM_REQ_FLIP, &refcyc_per_vm_req_flip);\n\n\tif (refcyc_per_vm_req_flip == uninitialized_hw_default ||\n\t\t\trefcyc_per_vm_req_flip > dlg_attr->refcyc_per_vm_req_flip)\n\t\tREG_SET(FLIP_PARAMETERS_4, 0,\n\t\t\t\t\tREFCYC_PER_VM_REQ_FLIP, dlg_attr->refcyc_per_vm_req_flip);\n\n\tREG_SET(FLIP_PARAMETERS_5, 0,\n\t\t\tREFCYC_PER_PTE_GROUP_FLIP_C, dlg_attr->refcyc_per_pte_group_flip_c);\n\n\tREG_SET(FLIP_PARAMETERS_6, 0,\n\t\t\tREFCYC_PER_META_CHUNK_FLIP_C, dlg_attr->refcyc_per_meta_chunk_flip_c);\n}\n\nvoid hubp21_program_deadline(\n\t\tstruct hubp *hubp,\n\t\tstruct _vcs_dpi_display_dlg_regs_st *dlg_attr,\n\t\tstruct _vcs_dpi_display_ttu_regs_st *ttu_attr)\n{\n\thubp2_program_deadline(hubp, dlg_attr, ttu_attr);\n\n\tapply_DEDCN21_142_wa_for_hostvm_deadline(hubp, dlg_attr);\n}\n\nvoid hubp21_program_requestor(\n\t\tstruct hubp *hubp,\n\t\tstruct _vcs_dpi_display_rq_regs_st *rq_regs)\n{\n\tstruct dcn21_hubp *hubp21 = TO_DCN21_HUBP(hubp);\n\n\tREG_UPDATE(HUBPRET_CONTROL,\n\t\t\tDET_BUF_PLANE1_BASE_ADDRESS, rq_regs->plane1_base_address);\n\tREG_SET_4(DCN_EXPANSION_MODE, 0,\n\t\t\tDRQ_EXPANSION_MODE, rq_regs->drq_expansion_mode,\n\t\t\tPRQ_EXPANSION_MODE, rq_regs->prq_expansion_mode,\n\t\t\tMRQ_EXPANSION_MODE, rq_regs->mrq_expansion_mode,\n\t\t\tCRQ_EXPANSION_MODE, rq_regs->crq_expansion_mode);\n\tREG_SET_8(DCHUBP_REQ_SIZE_CONFIG, 0,\n\t\tCHUNK_SIZE, rq_regs->rq_regs_l.chunk_size,\n\t\tMIN_CHUNK_SIZE, rq_regs->rq_regs_l.min_chunk_size,\n\t\tMETA_CHUNK_SIZE, rq_regs->rq_regs_l.meta_chunk_size,\n\t\tMIN_META_CHUNK_SIZE, rq_regs->rq_regs_l.min_meta_chunk_size,\n\t\tDPTE_GROUP_SIZE, rq_regs->rq_regs_l.dpte_group_size,\n\t\tVM_GROUP_SIZE, rq_regs->rq_regs_l.mpte_group_size,\n\t\tSWATH_HEIGHT, rq_regs->rq_regs_l.swath_height,\n\t\tPTE_ROW_HEIGHT_LINEAR, rq_regs->rq_regs_l.pte_row_height_linear);\n\tREG_SET_7(DCHUBP_REQ_SIZE_CONFIG_C, 0,\n\t\tCHUNK_SIZE_C, rq_regs->rq_regs_c.chunk_size,\n\t\tMIN_CHUNK_SIZE_C, rq_regs->rq_regs_c.min_chunk_size,\n\t\tMETA_CHUNK_SIZE_C, rq_regs->rq_regs_c.meta_chunk_size,\n\t\tMIN_META_CHUNK_SIZE_C, rq_regs->rq_regs_c.min_meta_chunk_size,\n\t\tDPTE_GROUP_SIZE_C, rq_regs->rq_regs_c.dpte_group_size,\n\t\tSWATH_HEIGHT_C, rq_regs->rq_regs_c.swath_height,\n\t\tPTE_ROW_HEIGHT_LINEAR_C, rq_regs->rq_regs_c.pte_row_height_linear);\n}\n\nstatic void hubp21_setup(\n\t\tstruct hubp *hubp,\n\t\tstruct _vcs_dpi_display_dlg_regs_st *dlg_attr,\n\t\tstruct _vcs_dpi_display_ttu_regs_st *ttu_attr,\n\t\tstruct _vcs_dpi_display_rq_regs_st *rq_regs,\n\t\tstruct _vcs_dpi_display_pipe_dest_params_st *pipe_dest)\n{\n\t \n\n\thubp2_vready_at_or_After_vsync(hubp, pipe_dest);\n\thubp21_program_requestor(hubp, rq_regs);\n\thubp21_program_deadline(hubp, dlg_attr, ttu_attr);\n\n}\n\nstatic void hubp21_set_viewport(\n\tstruct hubp *hubp,\n\tconst struct rect *viewport,\n\tconst struct rect *viewport_c)\n{\n\tstruct dcn21_hubp *hubp21 = TO_DCN21_HUBP(hubp);\n\n\tREG_SET_2(DCSURF_PRI_VIEWPORT_DIMENSION, 0,\n\t\t  PRI_VIEWPORT_WIDTH, viewport->width,\n\t\t  PRI_VIEWPORT_HEIGHT, viewport->height);\n\n\tREG_SET_2(DCSURF_PRI_VIEWPORT_START, 0,\n\t\t  PRI_VIEWPORT_X_START, viewport->x,\n\t\t  PRI_VIEWPORT_Y_START, viewport->y);\n\n\t \n\tREG_SET_2(DCSURF_SEC_VIEWPORT_DIMENSION, 0,\n\t\t  SEC_VIEWPORT_WIDTH, viewport->width,\n\t\t  SEC_VIEWPORT_HEIGHT, viewport->height);\n\n\tREG_SET_2(DCSURF_SEC_VIEWPORT_START, 0,\n\t\t  SEC_VIEWPORT_X_START, viewport->x,\n\t\t  SEC_VIEWPORT_Y_START, viewport->y);\n\n\t \n\tREG_SET_2(DCSURF_PRI_VIEWPORT_DIMENSION_C, 0,\n\t\t  PRI_VIEWPORT_WIDTH_C, viewport_c->width,\n\t\t  PRI_VIEWPORT_HEIGHT_C, viewport_c->height);\n\n\tREG_SET_2(DCSURF_PRI_VIEWPORT_START_C, 0,\n\t\t  PRI_VIEWPORT_X_START_C, viewport_c->x,\n\t\t  PRI_VIEWPORT_Y_START_C, viewport_c->y);\n\n\tREG_SET_2(DCSURF_SEC_VIEWPORT_DIMENSION_C, 0,\n\t\t  SEC_VIEWPORT_WIDTH_C, viewport_c->width,\n\t\t  SEC_VIEWPORT_HEIGHT_C, viewport_c->height);\n\n\tREG_SET_2(DCSURF_SEC_VIEWPORT_START_C, 0,\n\t\t  SEC_VIEWPORT_X_START_C, viewport_c->x,\n\t\t  SEC_VIEWPORT_Y_START_C, viewport_c->y);\n}\n\nstatic void hubp21_set_vm_system_aperture_settings(struct hubp *hubp,\n\t\t\t\t\t\t   struct vm_system_aperture_param *apt)\n{\n\tstruct dcn21_hubp *hubp21 = TO_DCN21_HUBP(hubp);\n\n\tPHYSICAL_ADDRESS_LOC mc_vm_apt_low;\n\tPHYSICAL_ADDRESS_LOC mc_vm_apt_high;\n\n\t\n\tmc_vm_apt_low.quad_part = apt->sys_low.quad_part >> 18;\n\tmc_vm_apt_high.quad_part = apt->sys_high.quad_part >> 18;\n\n\tREG_SET(DCN_VM_SYSTEM_APERTURE_LOW_ADDR, 0,\n\t\t\tMC_VM_SYSTEM_APERTURE_LOW_ADDR, mc_vm_apt_low.quad_part);\n\n\tREG_SET(DCN_VM_SYSTEM_APERTURE_HIGH_ADDR, 0,\n\t\t\tMC_VM_SYSTEM_APERTURE_HIGH_ADDR, mc_vm_apt_high.quad_part);\n\n\tREG_SET_2(DCN_VM_MX_L1_TLB_CNTL, 0,\n\t\t\tENABLE_L1_TLB, 1,\n\t\t\tSYSTEM_ACCESS_MODE, 0x3);\n}\n\nstatic void hubp21_validate_dml_output(struct hubp *hubp,\n\t\tstruct dc_context *ctx,\n\t\tstruct _vcs_dpi_display_rq_regs_st *dml_rq_regs,\n\t\tstruct _vcs_dpi_display_dlg_regs_st *dml_dlg_attr,\n\t\tstruct _vcs_dpi_display_ttu_regs_st *dml_ttu_attr)\n{\n\tstruct dcn21_hubp *hubp21 = TO_DCN21_HUBP(hubp);\n\tstruct _vcs_dpi_display_rq_regs_st rq_regs = {0};\n\tstruct _vcs_dpi_display_dlg_regs_st dlg_attr = {0};\n\tstruct _vcs_dpi_display_ttu_regs_st ttu_attr = {0};\n\tDC_LOGGER_INIT(ctx->logger);\n\tDC_LOG_DEBUG(\"DML Validation | Running Validation\");\n\n\t \n\tREG_GET(HUBPRET_CONTROL,\n\t\tDET_BUF_PLANE1_BASE_ADDRESS, &rq_regs.plane1_base_address);\n\tREG_GET_4(DCN_EXPANSION_MODE,\n\t\tDRQ_EXPANSION_MODE, &rq_regs.drq_expansion_mode,\n\t\tPRQ_EXPANSION_MODE, &rq_regs.prq_expansion_mode,\n\t\tMRQ_EXPANSION_MODE, &rq_regs.mrq_expansion_mode,\n\t\tCRQ_EXPANSION_MODE, &rq_regs.crq_expansion_mode);\n\tREG_GET_8(DCHUBP_REQ_SIZE_CONFIG,\n\t\tCHUNK_SIZE, &rq_regs.rq_regs_l.chunk_size,\n\t\tMIN_CHUNK_SIZE, &rq_regs.rq_regs_l.min_chunk_size,\n\t\tMETA_CHUNK_SIZE, &rq_regs.rq_regs_l.meta_chunk_size,\n\t\tMIN_META_CHUNK_SIZE, &rq_regs.rq_regs_l.min_meta_chunk_size,\n\t\tDPTE_GROUP_SIZE, &rq_regs.rq_regs_l.dpte_group_size,\n\t\tVM_GROUP_SIZE, &rq_regs.rq_regs_l.mpte_group_size,\n\t\tSWATH_HEIGHT, &rq_regs.rq_regs_l.swath_height,\n\t\tPTE_ROW_HEIGHT_LINEAR, &rq_regs.rq_regs_l.pte_row_height_linear);\n\tREG_GET_7(DCHUBP_REQ_SIZE_CONFIG_C,\n\t\tCHUNK_SIZE_C, &rq_regs.rq_regs_c.chunk_size,\n\t\tMIN_CHUNK_SIZE_C, &rq_regs.rq_regs_c.min_chunk_size,\n\t\tMETA_CHUNK_SIZE_C, &rq_regs.rq_regs_c.meta_chunk_size,\n\t\tMIN_META_CHUNK_SIZE_C, &rq_regs.rq_regs_c.min_meta_chunk_size,\n\t\tDPTE_GROUP_SIZE_C, &rq_regs.rq_regs_c.dpte_group_size,\n\t\tSWATH_HEIGHT_C, &rq_regs.rq_regs_c.swath_height,\n\t\tPTE_ROW_HEIGHT_LINEAR_C, &rq_regs.rq_regs_c.pte_row_height_linear);\n\n\tif (rq_regs.plane1_base_address != dml_rq_regs->plane1_base_address)\n\t\tDC_LOG_DEBUG(\"DML Validation | HUBPRET_CONTROL:DET_BUF_PLANE1_BASE_ADDRESS - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_rq_regs->plane1_base_address, rq_regs.plane1_base_address);\n\tif (rq_regs.drq_expansion_mode != dml_rq_regs->drq_expansion_mode)\n\t\tDC_LOG_DEBUG(\"DML Validation | DCN_EXPANSION_MODE:DRQ_EXPANSION_MODE - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_rq_regs->drq_expansion_mode, rq_regs.drq_expansion_mode);\n\tif (rq_regs.prq_expansion_mode != dml_rq_regs->prq_expansion_mode)\n\t\tDC_LOG_DEBUG(\"DML Validation | DCN_EXPANSION_MODE:MRQ_EXPANSION_MODE - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_rq_regs->prq_expansion_mode, rq_regs.prq_expansion_mode);\n\tif (rq_regs.mrq_expansion_mode != dml_rq_regs->mrq_expansion_mode)\n\t\tDC_LOG_DEBUG(\"DML Validation | DCN_EXPANSION_MODE:DET_BUF_PLANE1_BASE_ADDRESS - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_rq_regs->mrq_expansion_mode, rq_regs.mrq_expansion_mode);\n\tif (rq_regs.crq_expansion_mode != dml_rq_regs->crq_expansion_mode)\n\t\tDC_LOG_DEBUG(\"DML Validation | DCN_EXPANSION_MODE:CRQ_EXPANSION_MODE - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_rq_regs->crq_expansion_mode, rq_regs.crq_expansion_mode);\n\n\tif (rq_regs.rq_regs_l.chunk_size != dml_rq_regs->rq_regs_l.chunk_size)\n\t\tDC_LOG_DEBUG(\"DML Validation | DCHUBP_REQ_SIZE_CONFIG_C:CHUNK_SIZE - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_rq_regs->rq_regs_l.chunk_size, rq_regs.rq_regs_l.chunk_size);\n\tif (rq_regs.rq_regs_l.min_chunk_size != dml_rq_regs->rq_regs_l.min_chunk_size)\n\t\tDC_LOG_DEBUG(\"DML Validation | DCHUBP_REQ_SIZE_CONFIG_C:MIN_CHUNK_SIZE - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_rq_regs->rq_regs_l.min_chunk_size, rq_regs.rq_regs_l.min_chunk_size);\n\tif (rq_regs.rq_regs_l.meta_chunk_size != dml_rq_regs->rq_regs_l.meta_chunk_size)\n\t\tDC_LOG_DEBUG(\"DML Validation | DCHUBP_REQ_SIZE_CONFIG_C:META_CHUNK_SIZE - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_rq_regs->rq_regs_l.meta_chunk_size, rq_regs.rq_regs_l.meta_chunk_size);\n\tif (rq_regs.rq_regs_l.min_meta_chunk_size != dml_rq_regs->rq_regs_l.min_meta_chunk_size)\n\t\tDC_LOG_DEBUG(\"DML Validation | DCHUBP_REQ_SIZE_CONFIG_C:MIN_META_CHUNK_SIZE - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_rq_regs->rq_regs_l.min_meta_chunk_size, rq_regs.rq_regs_l.min_meta_chunk_size);\n\tif (rq_regs.rq_regs_l.dpte_group_size != dml_rq_regs->rq_regs_l.dpte_group_size)\n\t\tDC_LOG_DEBUG(\"DML Validation | DCHUBP_REQ_SIZE_CONFIG_C:DPTE_GROUP_SIZE - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_rq_regs->rq_regs_l.dpte_group_size, rq_regs.rq_regs_l.dpte_group_size);\n\tif (rq_regs.rq_regs_l.mpte_group_size != dml_rq_regs->rq_regs_l.mpte_group_size)\n\t\tDC_LOG_DEBUG(\"DML Validation | DCHUBP_REQ_SIZE_CONFIG_C:VM_GROUP_SIZE - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_rq_regs->rq_regs_l.mpte_group_size, rq_regs.rq_regs_l.mpte_group_size);\n\tif (rq_regs.rq_regs_l.swath_height != dml_rq_regs->rq_regs_l.swath_height)\n\t\tDC_LOG_DEBUG(\"DML Validation | DCHUBP_REQ_SIZE_CONFIG_C:SWATH_HEIGHT - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_rq_regs->rq_regs_l.swath_height, rq_regs.rq_regs_l.swath_height);\n\tif (rq_regs.rq_regs_l.pte_row_height_linear != dml_rq_regs->rq_regs_l.pte_row_height_linear)\n\t\tDC_LOG_DEBUG(\"DML Validation | DCHUBP_REQ_SIZE_CONFIG_C:PTE_ROW_HEIGHT_LINEAR - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_rq_regs->rq_regs_l.pte_row_height_linear, rq_regs.rq_regs_l.pte_row_height_linear);\n\n\tif (rq_regs.rq_regs_c.chunk_size != dml_rq_regs->rq_regs_c.chunk_size)\n\t\tDC_LOG_DEBUG(\"DML Validation | DCHUBP_REQ_SIZE_CONFIG:CHUNK_SIZE_C - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_rq_regs->rq_regs_c.chunk_size, rq_regs.rq_regs_c.chunk_size);\n\tif (rq_regs.rq_regs_c.min_chunk_size != dml_rq_regs->rq_regs_c.min_chunk_size)\n\t\tDC_LOG_DEBUG(\"DML Validation | DCHUBP_REQ_SIZE_CONFIG:MIN_CHUNK_SIZE_C - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_rq_regs->rq_regs_c.min_chunk_size, rq_regs.rq_regs_c.min_chunk_size);\n\tif (rq_regs.rq_regs_c.meta_chunk_size != dml_rq_regs->rq_regs_c.meta_chunk_size)\n\t\tDC_LOG_DEBUG(\"DML Validation | DCHUBP_REQ_SIZE_CONFIG:META_CHUNK_SIZE_C - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_rq_regs->rq_regs_c.meta_chunk_size, rq_regs.rq_regs_c.meta_chunk_size);\n\tif (rq_regs.rq_regs_c.min_meta_chunk_size != dml_rq_regs->rq_regs_c.min_meta_chunk_size)\n\t\tDC_LOG_DEBUG(\"DML Validation | DCHUBP_REQ_SIZE_CONFIG:MIN_META_CHUNK_SIZE_C - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_rq_regs->rq_regs_c.min_meta_chunk_size, rq_regs.rq_regs_c.min_meta_chunk_size);\n\tif (rq_regs.rq_regs_c.dpte_group_size != dml_rq_regs->rq_regs_c.dpte_group_size)\n\t\tDC_LOG_DEBUG(\"DML Validation | DCHUBP_REQ_SIZE_CONFIG:DPTE_GROUP_SIZE_C - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_rq_regs->rq_regs_c.dpte_group_size, rq_regs.rq_regs_c.dpte_group_size);\n\tif (rq_regs.rq_regs_c.swath_height != dml_rq_regs->rq_regs_c.swath_height)\n\t\tDC_LOG_DEBUG(\"DML Validation | DCHUBP_REQ_SIZE_CONFIG:SWATH_HEIGHT_C - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_rq_regs->rq_regs_c.swath_height, rq_regs.rq_regs_c.swath_height);\n\tif (rq_regs.rq_regs_c.pte_row_height_linear != dml_rq_regs->rq_regs_c.pte_row_height_linear)\n\t\tDC_LOG_DEBUG(\"DML Validation | DCHUBP_REQ_SIZE_CONFIG:PTE_ROW_HEIGHT_LINEAR_C - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_rq_regs->rq_regs_c.pte_row_height_linear, rq_regs.rq_regs_c.pte_row_height_linear);\n\n\n\t \n\tREG_GET_2(BLANK_OFFSET_0,\n\t\tREFCYC_H_BLANK_END, &dlg_attr.refcyc_h_blank_end,\n\t\tDLG_V_BLANK_END, &dlg_attr.dlg_vblank_end);\n\tREG_GET(BLANK_OFFSET_1,\n\t\tMIN_DST_Y_NEXT_START, &dlg_attr.min_dst_y_next_start);\n\tREG_GET(DST_DIMENSIONS,\n\t\tREFCYC_PER_HTOTAL, &dlg_attr.refcyc_per_htotal);\n\tREG_GET_2(DST_AFTER_SCALER,\n\t\tREFCYC_X_AFTER_SCALER, &dlg_attr.refcyc_x_after_scaler,\n\t\tDST_Y_AFTER_SCALER, &dlg_attr.dst_y_after_scaler);\n\tREG_GET(REF_FREQ_TO_PIX_FREQ,\n\t\tREF_FREQ_TO_PIX_FREQ, &dlg_attr.ref_freq_to_pix_freq);\n\n\tif (dlg_attr.refcyc_h_blank_end != dml_dlg_attr->refcyc_h_blank_end)\n\t\tDC_LOG_DEBUG(\"DML Validation | BLANK_OFFSET_0:REFCYC_H_BLANK_END - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_dlg_attr->refcyc_h_blank_end, dlg_attr.refcyc_h_blank_end);\n\tif (dlg_attr.dlg_vblank_end != dml_dlg_attr->dlg_vblank_end)\n\t\tDC_LOG_DEBUG(\"DML Validation | BLANK_OFFSET_0:DLG_V_BLANK_END - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_dlg_attr->dlg_vblank_end, dlg_attr.dlg_vblank_end);\n\tif (dlg_attr.min_dst_y_next_start != dml_dlg_attr->min_dst_y_next_start)\n\t\tDC_LOG_DEBUG(\"DML Validation | BLANK_OFFSET_1:MIN_DST_Y_NEXT_START - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_dlg_attr->min_dst_y_next_start, dlg_attr.min_dst_y_next_start);\n\tif (dlg_attr.refcyc_per_htotal != dml_dlg_attr->refcyc_per_htotal)\n\t\tDC_LOG_DEBUG(\"DML Validation | DST_DIMENSIONS:REFCYC_PER_HTOTAL - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_dlg_attr->refcyc_per_htotal, dlg_attr.refcyc_per_htotal);\n\tif (dlg_attr.refcyc_x_after_scaler != dml_dlg_attr->refcyc_x_after_scaler)\n\t\tDC_LOG_DEBUG(\"DML Validation | DST_AFTER_SCALER:REFCYC_X_AFTER_SCALER - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_dlg_attr->refcyc_x_after_scaler, dlg_attr.refcyc_x_after_scaler);\n\tif (dlg_attr.dst_y_after_scaler != dml_dlg_attr->dst_y_after_scaler)\n\t\tDC_LOG_DEBUG(\"DML Validation | DST_AFTER_SCALER:DST_Y_AFTER_SCALER - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_dlg_attr->dst_y_after_scaler, dlg_attr.dst_y_after_scaler);\n\tif (dlg_attr.ref_freq_to_pix_freq != dml_dlg_attr->ref_freq_to_pix_freq)\n\t\tDC_LOG_DEBUG(\"DML Validation | REF_FREQ_TO_PIX_FREQ:REF_FREQ_TO_PIX_FREQ - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_dlg_attr->ref_freq_to_pix_freq, dlg_attr.ref_freq_to_pix_freq);\n\n\t \n\tREG_GET(VBLANK_PARAMETERS_1,\n\t\tREFCYC_PER_PTE_GROUP_VBLANK_L, &dlg_attr.refcyc_per_pte_group_vblank_l);\n\tif (REG(NOM_PARAMETERS_0))\n\t\tREG_GET(NOM_PARAMETERS_0,\n\t\t\tDST_Y_PER_PTE_ROW_NOM_L, &dlg_attr.dst_y_per_pte_row_nom_l);\n\tif (REG(NOM_PARAMETERS_1))\n\t\tREG_GET(NOM_PARAMETERS_1,\n\t\t\tREFCYC_PER_PTE_GROUP_NOM_L, &dlg_attr.refcyc_per_pte_group_nom_l);\n\tREG_GET(NOM_PARAMETERS_4,\n\t\tDST_Y_PER_META_ROW_NOM_L, &dlg_attr.dst_y_per_meta_row_nom_l);\n\tREG_GET(NOM_PARAMETERS_5,\n\t\tREFCYC_PER_META_CHUNK_NOM_L, &dlg_attr.refcyc_per_meta_chunk_nom_l);\n\tREG_GET_2(PER_LINE_DELIVERY,\n\t\tREFCYC_PER_LINE_DELIVERY_L, &dlg_attr.refcyc_per_line_delivery_l,\n\t\tREFCYC_PER_LINE_DELIVERY_C, &dlg_attr.refcyc_per_line_delivery_c);\n\tREG_GET_2(PER_LINE_DELIVERY_PRE,\n\t\tREFCYC_PER_LINE_DELIVERY_PRE_L, &dlg_attr.refcyc_per_line_delivery_pre_l,\n\t\tREFCYC_PER_LINE_DELIVERY_PRE_C, &dlg_attr.refcyc_per_line_delivery_pre_c);\n\tREG_GET(VBLANK_PARAMETERS_2,\n\t\tREFCYC_PER_PTE_GROUP_VBLANK_C, &dlg_attr.refcyc_per_pte_group_vblank_c);\n\tif (REG(NOM_PARAMETERS_2))\n\t\tREG_GET(NOM_PARAMETERS_2,\n\t\t\tDST_Y_PER_PTE_ROW_NOM_C, &dlg_attr.dst_y_per_pte_row_nom_c);\n\tif (REG(NOM_PARAMETERS_3))\n\t\tREG_GET(NOM_PARAMETERS_3,\n\t\t\tREFCYC_PER_PTE_GROUP_NOM_C, &dlg_attr.refcyc_per_pte_group_nom_c);\n\tREG_GET(NOM_PARAMETERS_6,\n\t\tDST_Y_PER_META_ROW_NOM_C, &dlg_attr.dst_y_per_meta_row_nom_c);\n\tREG_GET(NOM_PARAMETERS_7,\n\t\tREFCYC_PER_META_CHUNK_NOM_C, &dlg_attr.refcyc_per_meta_chunk_nom_c);\n\tREG_GET(VBLANK_PARAMETERS_3,\n\t\t\tREFCYC_PER_META_CHUNK_VBLANK_L, &dlg_attr.refcyc_per_meta_chunk_vblank_l);\n\tREG_GET(VBLANK_PARAMETERS_4,\n\t\t\tREFCYC_PER_META_CHUNK_VBLANK_C, &dlg_attr.refcyc_per_meta_chunk_vblank_c);\n\n\tif (dlg_attr.refcyc_per_pte_group_vblank_l != dml_dlg_attr->refcyc_per_pte_group_vblank_l)\n\t\tDC_LOG_DEBUG(\"DML Validation | VBLANK_PARAMETERS_1:REFCYC_PER_PTE_GROUP_VBLANK_L - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_dlg_attr->refcyc_per_pte_group_vblank_l, dlg_attr.refcyc_per_pte_group_vblank_l);\n\tif (dlg_attr.dst_y_per_pte_row_nom_l != dml_dlg_attr->dst_y_per_pte_row_nom_l)\n\t\tDC_LOG_DEBUG(\"DML Validation | NOM_PARAMETERS_0:DST_Y_PER_PTE_ROW_NOM_L - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_dlg_attr->dst_y_per_pte_row_nom_l, dlg_attr.dst_y_per_pte_row_nom_l);\n\tif (dlg_attr.refcyc_per_pte_group_nom_l != dml_dlg_attr->refcyc_per_pte_group_nom_l)\n\t\tDC_LOG_DEBUG(\"DML Validation | NOM_PARAMETERS_1:REFCYC_PER_PTE_GROUP_NOM_L - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_dlg_attr->refcyc_per_pte_group_nom_l, dlg_attr.refcyc_per_pte_group_nom_l);\n\tif (dlg_attr.dst_y_per_meta_row_nom_l != dml_dlg_attr->dst_y_per_meta_row_nom_l)\n\t\tDC_LOG_DEBUG(\"DML Validation | NOM_PARAMETERS_4:DST_Y_PER_META_ROW_NOM_L - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_dlg_attr->dst_y_per_meta_row_nom_l, dlg_attr.dst_y_per_meta_row_nom_l);\n\tif (dlg_attr.refcyc_per_meta_chunk_nom_l != dml_dlg_attr->refcyc_per_meta_chunk_nom_l)\n\t\tDC_LOG_DEBUG(\"DML Validation | NOM_PARAMETERS_5:REFCYC_PER_META_CHUNK_NOM_L - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_dlg_attr->refcyc_per_meta_chunk_nom_l, dlg_attr.refcyc_per_meta_chunk_nom_l);\n\tif (dlg_attr.refcyc_per_line_delivery_l != dml_dlg_attr->refcyc_per_line_delivery_l)\n\t\tDC_LOG_DEBUG(\"DML Validation | PER_LINE_DELIVERY:REFCYC_PER_LINE_DELIVERY_L - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_dlg_attr->refcyc_per_line_delivery_l, dlg_attr.refcyc_per_line_delivery_l);\n\tif (dlg_attr.refcyc_per_line_delivery_c != dml_dlg_attr->refcyc_per_line_delivery_c)\n\t\tDC_LOG_DEBUG(\"DML Validation | PER_LINE_DELIVERY:REFCYC_PER_LINE_DELIVERY_C - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_dlg_attr->refcyc_per_line_delivery_c, dlg_attr.refcyc_per_line_delivery_c);\n\tif (dlg_attr.refcyc_per_pte_group_vblank_c != dml_dlg_attr->refcyc_per_pte_group_vblank_c)\n\t\tDC_LOG_DEBUG(\"DML Validation | VBLANK_PARAMETERS_2:REFCYC_PER_PTE_GROUP_VBLANK_C - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_dlg_attr->refcyc_per_pte_group_vblank_c, dlg_attr.refcyc_per_pte_group_vblank_c);\n\tif (dlg_attr.dst_y_per_pte_row_nom_c != dml_dlg_attr->dst_y_per_pte_row_nom_c)\n\t\tDC_LOG_DEBUG(\"DML Validation | NOM_PARAMETERS_2:DST_Y_PER_PTE_ROW_NOM_C - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_dlg_attr->dst_y_per_pte_row_nom_c, dlg_attr.dst_y_per_pte_row_nom_c);\n\tif (dlg_attr.refcyc_per_pte_group_nom_c != dml_dlg_attr->refcyc_per_pte_group_nom_c)\n\t\tDC_LOG_DEBUG(\"DML Validation | NOM_PARAMETERS_3:REFCYC_PER_PTE_GROUP_NOM_C - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_dlg_attr->refcyc_per_pte_group_nom_c, dlg_attr.refcyc_per_pte_group_nom_c);\n\tif (dlg_attr.dst_y_per_meta_row_nom_c != dml_dlg_attr->dst_y_per_meta_row_nom_c)\n\t\tDC_LOG_DEBUG(\"DML Validation | NOM_PARAMETERS_6:DST_Y_PER_META_ROW_NOM_C - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_dlg_attr->dst_y_per_meta_row_nom_c, dlg_attr.dst_y_per_meta_row_nom_c);\n\tif (dlg_attr.refcyc_per_meta_chunk_nom_c != dml_dlg_attr->refcyc_per_meta_chunk_nom_c)\n\t\tDC_LOG_DEBUG(\"DML Validation | NOM_PARAMETERS_7:REFCYC_PER_META_CHUNK_NOM_C - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_dlg_attr->refcyc_per_meta_chunk_nom_c, dlg_attr.refcyc_per_meta_chunk_nom_c);\n\tif (dlg_attr.refcyc_per_line_delivery_pre_l != dml_dlg_attr->refcyc_per_line_delivery_pre_l)\n\t\tDC_LOG_DEBUG(\"DML Validation | PER_LINE_DELIVERY_PRE:REFCYC_PER_LINE_DELIVERY_PRE_L - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_dlg_attr->refcyc_per_line_delivery_pre_l, dlg_attr.refcyc_per_line_delivery_pre_l);\n\tif (dlg_attr.refcyc_per_line_delivery_pre_c != dml_dlg_attr->refcyc_per_line_delivery_pre_c)\n\t\tDC_LOG_DEBUG(\"DML Validation | PER_LINE_DELIVERY_PRE:REFCYC_PER_LINE_DELIVERY_PRE_C - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_dlg_attr->refcyc_per_line_delivery_pre_c, dlg_attr.refcyc_per_line_delivery_pre_c);\n\tif (dlg_attr.refcyc_per_meta_chunk_vblank_l != dml_dlg_attr->refcyc_per_meta_chunk_vblank_l)\n\t\tDC_LOG_DEBUG(\"DML Validation | VBLANK_PARAMETERS_3:REFCYC_PER_META_CHUNK_VBLANK_L - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_dlg_attr->refcyc_per_meta_chunk_vblank_l, dlg_attr.refcyc_per_meta_chunk_vblank_l);\n\tif (dlg_attr.refcyc_per_meta_chunk_vblank_c != dml_dlg_attr->refcyc_per_meta_chunk_vblank_c)\n\t\tDC_LOG_DEBUG(\"DML Validation | VBLANK_PARAMETERS_4:REFCYC_PER_META_CHUNK_VBLANK_C - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_dlg_attr->refcyc_per_meta_chunk_vblank_c, dlg_attr.refcyc_per_meta_chunk_vblank_c);\n\n\t \n\tREG_GET_2(DCN_TTU_QOS_WM,\n\t\tQoS_LEVEL_LOW_WM, &ttu_attr.qos_level_low_wm,\n\t\tQoS_LEVEL_HIGH_WM, &ttu_attr.qos_level_high_wm);\n\n\tif (ttu_attr.qos_level_low_wm != dml_ttu_attr->qos_level_low_wm)\n\t\tDC_LOG_DEBUG(\"DML Validation | DCN_TTU_QOS_WM:QoS_LEVEL_LOW_WM - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_ttu_attr->qos_level_low_wm, ttu_attr.qos_level_low_wm);\n\tif (ttu_attr.qos_level_high_wm != dml_ttu_attr->qos_level_high_wm)\n\t\tDC_LOG_DEBUG(\"DML Validation | DCN_TTU_QOS_WM:QoS_LEVEL_HIGH_WM - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_ttu_attr->qos_level_high_wm, ttu_attr.qos_level_high_wm);\n\n\t \n\t \n\tREG_GET_3(DCN_SURF0_TTU_CNTL0,\n\t\tREFCYC_PER_REQ_DELIVERY, &ttu_attr.refcyc_per_req_delivery_l,\n\t\tQoS_LEVEL_FIXED, &ttu_attr.qos_level_fixed_l,\n\t\tQoS_RAMP_DISABLE, &ttu_attr.qos_ramp_disable_l);\n\tREG_GET_3(DCN_SURF1_TTU_CNTL0,\n\t\tREFCYC_PER_REQ_DELIVERY, &ttu_attr.refcyc_per_req_delivery_c,\n\t\tQoS_LEVEL_FIXED, &ttu_attr.qos_level_fixed_c,\n\t\tQoS_RAMP_DISABLE, &ttu_attr.qos_ramp_disable_c);\n\tREG_GET_3(DCN_CUR0_TTU_CNTL0,\n\t\tREFCYC_PER_REQ_DELIVERY, &ttu_attr.refcyc_per_req_delivery_cur0,\n\t\tQoS_LEVEL_FIXED, &ttu_attr.qos_level_fixed_cur0,\n\t\tQoS_RAMP_DISABLE, &ttu_attr.qos_ramp_disable_cur0);\n\tREG_GET(FLIP_PARAMETERS_1,\n\t\tREFCYC_PER_PTE_GROUP_FLIP_L, &dlg_attr.refcyc_per_pte_group_flip_l);\n\tREG_GET(DCN_CUR0_TTU_CNTL1,\n\t\t\tREFCYC_PER_REQ_DELIVERY_PRE, &ttu_attr.refcyc_per_req_delivery_pre_cur0);\n\tREG_GET(DCN_CUR1_TTU_CNTL1,\n\t\t\tREFCYC_PER_REQ_DELIVERY_PRE, &ttu_attr.refcyc_per_req_delivery_pre_cur1);\n\tREG_GET(DCN_SURF0_TTU_CNTL1,\n\t\t\tREFCYC_PER_REQ_DELIVERY_PRE, &ttu_attr.refcyc_per_req_delivery_pre_l);\n\tREG_GET(DCN_SURF1_TTU_CNTL1,\n\t\t\tREFCYC_PER_REQ_DELIVERY_PRE, &ttu_attr.refcyc_per_req_delivery_pre_c);\n\n\tif (ttu_attr.refcyc_per_req_delivery_l != dml_ttu_attr->refcyc_per_req_delivery_l)\n\t\tDC_LOG_DEBUG(\"DML Validation | DCN_SURF0_TTU_CNTL0:REFCYC_PER_REQ_DELIVERY - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_ttu_attr->refcyc_per_req_delivery_l, ttu_attr.refcyc_per_req_delivery_l);\n\tif (ttu_attr.qos_level_fixed_l != dml_ttu_attr->qos_level_fixed_l)\n\t\tDC_LOG_DEBUG(\"DML Validation | DCN_SURF0_TTU_CNTL0:QoS_LEVEL_FIXED - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_ttu_attr->qos_level_fixed_l, ttu_attr.qos_level_fixed_l);\n\tif (ttu_attr.qos_ramp_disable_l != dml_ttu_attr->qos_ramp_disable_l)\n\t\tDC_LOG_DEBUG(\"DML Validation | DCN_SURF0_TTU_CNTL0:QoS_RAMP_DISABLE - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_ttu_attr->qos_ramp_disable_l, ttu_attr.qos_ramp_disable_l);\n\tif (ttu_attr.refcyc_per_req_delivery_c != dml_ttu_attr->refcyc_per_req_delivery_c)\n\t\tDC_LOG_DEBUG(\"DML Validation | DCN_SURF1_TTU_CNTL0:REFCYC_PER_REQ_DELIVERY - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_ttu_attr->refcyc_per_req_delivery_c, ttu_attr.refcyc_per_req_delivery_c);\n\tif (ttu_attr.qos_level_fixed_c != dml_ttu_attr->qos_level_fixed_c)\n\t\tDC_LOG_DEBUG(\"DML Validation | DCN_SURF1_TTU_CNTL0:QoS_LEVEL_FIXED - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_ttu_attr->qos_level_fixed_c, ttu_attr.qos_level_fixed_c);\n\tif (ttu_attr.qos_ramp_disable_c != dml_ttu_attr->qos_ramp_disable_c)\n\t\tDC_LOG_DEBUG(\"DML Validation | DCN_SURF1_TTU_CNTL0:QoS_RAMP_DISABLE - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_ttu_attr->qos_ramp_disable_c, ttu_attr.qos_ramp_disable_c);\n\tif (ttu_attr.refcyc_per_req_delivery_cur0 != dml_ttu_attr->refcyc_per_req_delivery_cur0)\n\t\tDC_LOG_DEBUG(\"DML Validation | DCN_CUR0_TTU_CNTL0:REFCYC_PER_REQ_DELIVERY - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_ttu_attr->refcyc_per_req_delivery_cur0, ttu_attr.refcyc_per_req_delivery_cur0);\n\tif (ttu_attr.qos_level_fixed_cur0 != dml_ttu_attr->qos_level_fixed_cur0)\n\t\tDC_LOG_DEBUG(\"DML Validation | DCN_CUR0_TTU_CNTL0:QoS_LEVEL_FIXED - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_ttu_attr->qos_level_fixed_cur0, ttu_attr.qos_level_fixed_cur0);\n\tif (ttu_attr.qos_ramp_disable_cur0 != dml_ttu_attr->qos_ramp_disable_cur0)\n\t\tDC_LOG_DEBUG(\"DML Validation | DCN_CUR0_TTU_CNTL0:QoS_RAMP_DISABLE - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_ttu_attr->qos_ramp_disable_cur0, ttu_attr.qos_ramp_disable_cur0);\n\tif (dlg_attr.refcyc_per_pte_group_flip_l != dml_dlg_attr->refcyc_per_pte_group_flip_l)\n\t\tDC_LOG_DEBUG(\"DML Validation | FLIP_PARAMETERS_1:REFCYC_PER_PTE_GROUP_FLIP_L - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_dlg_attr->refcyc_per_pte_group_flip_l, dlg_attr.refcyc_per_pte_group_flip_l);\n\tif (ttu_attr.refcyc_per_req_delivery_pre_cur0 != dml_ttu_attr->refcyc_per_req_delivery_pre_cur0)\n\t\tDC_LOG_DEBUG(\"DML Validation | DCN_CUR0_TTU_CNTL1:REFCYC_PER_REQ_DELIVERY_PRE - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_ttu_attr->refcyc_per_req_delivery_pre_cur0, ttu_attr.refcyc_per_req_delivery_pre_cur0);\n\tif (ttu_attr.refcyc_per_req_delivery_pre_cur1 != dml_ttu_attr->refcyc_per_req_delivery_pre_cur1)\n\t\tDC_LOG_DEBUG(\"DML Validation | DCN_CUR1_TTU_CNTL1:REFCYC_PER_REQ_DELIVERY_PRE - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_ttu_attr->refcyc_per_req_delivery_pre_cur1, ttu_attr.refcyc_per_req_delivery_pre_cur1);\n\tif (ttu_attr.refcyc_per_req_delivery_pre_l != dml_ttu_attr->refcyc_per_req_delivery_pre_l)\n\t\tDC_LOG_DEBUG(\"DML Validation | DCN_SURF0_TTU_CNTL1:REFCYC_PER_REQ_DELIVERY_PRE - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_ttu_attr->refcyc_per_req_delivery_pre_l, ttu_attr.refcyc_per_req_delivery_pre_l);\n\tif (ttu_attr.refcyc_per_req_delivery_pre_c != dml_ttu_attr->refcyc_per_req_delivery_pre_c)\n\t\tDC_LOG_DEBUG(\"DML Validation | DCN_SURF1_TTU_CNTL1:REFCYC_PER_REQ_DELIVERY_PRE - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_ttu_attr->refcyc_per_req_delivery_pre_c, ttu_attr.refcyc_per_req_delivery_pre_c);\n\n\t \n\tREG_GET(VBLANK_PARAMETERS_5,\n\t\tREFCYC_PER_VM_GROUP_VBLANK, &dlg_attr.refcyc_per_vm_group_vblank);\n\tREG_GET(VBLANK_PARAMETERS_6,\n\t\tREFCYC_PER_VM_REQ_VBLANK, &dlg_attr.refcyc_per_vm_req_vblank);\n\tREG_GET(FLIP_PARAMETERS_3,\n\t\tREFCYC_PER_VM_GROUP_FLIP, &dlg_attr.refcyc_per_vm_group_flip);\n\tREG_GET(FLIP_PARAMETERS_4,\n\t\tREFCYC_PER_VM_REQ_FLIP, &dlg_attr.refcyc_per_vm_req_flip);\n\tREG_GET(FLIP_PARAMETERS_5,\n\t\tREFCYC_PER_PTE_GROUP_FLIP_C, &dlg_attr.refcyc_per_pte_group_flip_c);\n\tREG_GET(FLIP_PARAMETERS_6,\n\t\tREFCYC_PER_META_CHUNK_FLIP_C, &dlg_attr.refcyc_per_meta_chunk_flip_c);\n\tREG_GET(FLIP_PARAMETERS_2,\n\t\tREFCYC_PER_META_CHUNK_FLIP_L, &dlg_attr.refcyc_per_meta_chunk_flip_l);\n\n\tif (dlg_attr.refcyc_per_vm_group_vblank != dml_dlg_attr->refcyc_per_vm_group_vblank)\n\t\tDC_LOG_DEBUG(\"DML Validation | VBLANK_PARAMETERS_5:REFCYC_PER_VM_GROUP_VBLANK - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_dlg_attr->refcyc_per_vm_group_vblank, dlg_attr.refcyc_per_vm_group_vblank);\n\tif (dlg_attr.refcyc_per_vm_req_vblank != dml_dlg_attr->refcyc_per_vm_req_vblank)\n\t\tDC_LOG_DEBUG(\"DML Validation | VBLANK_PARAMETERS_6:REFCYC_PER_VM_REQ_VBLANK - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_dlg_attr->refcyc_per_vm_req_vblank, dlg_attr.refcyc_per_vm_req_vblank);\n\tif (dlg_attr.refcyc_per_vm_group_flip != dml_dlg_attr->refcyc_per_vm_group_flip)\n\t\tDC_LOG_DEBUG(\"DML Validation | FLIP_PARAMETERS_3:REFCYC_PER_VM_GROUP_FLIP - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_dlg_attr->refcyc_per_vm_group_flip, dlg_attr.refcyc_per_vm_group_flip);\n\tif (dlg_attr.refcyc_per_vm_req_flip != dml_dlg_attr->refcyc_per_vm_req_flip)\n\t\tDC_LOG_DEBUG(\"DML Validation | FLIP_PARAMETERS_4:REFCYC_PER_VM_REQ_FLIP - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_dlg_attr->refcyc_per_vm_req_flip, dlg_attr.refcyc_per_vm_req_flip);\n\tif (dlg_attr.refcyc_per_pte_group_flip_c != dml_dlg_attr->refcyc_per_pte_group_flip_c)\n\t\tDC_LOG_DEBUG(\"DML Validation | FLIP_PARAMETERS_5:REFCYC_PER_PTE_GROUP_FLIP_C - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_dlg_attr->refcyc_per_pte_group_flip_c, dlg_attr.refcyc_per_pte_group_flip_c);\n\tif (dlg_attr.refcyc_per_meta_chunk_flip_c != dml_dlg_attr->refcyc_per_meta_chunk_flip_c)\n\t\tDC_LOG_DEBUG(\"DML Validation | FLIP_PARAMETERS_6:REFCYC_PER_META_CHUNK_FLIP_C - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_dlg_attr->refcyc_per_meta_chunk_flip_c, dlg_attr.refcyc_per_meta_chunk_flip_c);\n\tif (dlg_attr.refcyc_per_meta_chunk_flip_l != dml_dlg_attr->refcyc_per_meta_chunk_flip_l)\n\t\tDC_LOG_DEBUG(\"DML Validation | FLIP_PARAMETERS_2:REFCYC_PER_META_CHUNK_FLIP_L - Expected: %u  Actual: %u\\n\",\n\t\t\t\tdml_dlg_attr->refcyc_per_meta_chunk_flip_l, dlg_attr.refcyc_per_meta_chunk_flip_l);\n}\n\nstatic void program_surface_flip_and_addr(struct hubp *hubp, struct surface_flip_registers *flip_regs)\n{\n\tstruct dcn21_hubp *hubp21 = TO_DCN21_HUBP(hubp);\n\n\tREG_UPDATE_3(DCSURF_FLIP_CONTROL,\n\t\t\t\t\tSURFACE_FLIP_TYPE, flip_regs->immediate,\n\t\t\t\t\tSURFACE_FLIP_MODE_FOR_STEREOSYNC, flip_regs->grph_stereo,\n\t\t\t\t\tSURFACE_FLIP_IN_STEREOSYNC, flip_regs->grph_stereo);\n\n\tREG_UPDATE(VMID_SETTINGS_0,\n\t\t\t\tVMID, flip_regs->vmid);\n\n\tREG_UPDATE_8(DCSURF_SURFACE_CONTROL,\n\t\t\tPRIMARY_SURFACE_TMZ, flip_regs->tmz_surface,\n\t\t\tPRIMARY_SURFACE_TMZ_C, flip_regs->tmz_surface,\n\t\t\tPRIMARY_META_SURFACE_TMZ, flip_regs->tmz_surface,\n\t\t\tPRIMARY_META_SURFACE_TMZ_C, flip_regs->tmz_surface,\n\t\t\tSECONDARY_SURFACE_TMZ, flip_regs->tmz_surface,\n\t\t\tSECONDARY_SURFACE_TMZ_C, flip_regs->tmz_surface,\n\t\t\tSECONDARY_META_SURFACE_TMZ, flip_regs->tmz_surface,\n\t\t\tSECONDARY_META_SURFACE_TMZ_C, flip_regs->tmz_surface);\n\n\tREG_SET(DCSURF_PRIMARY_META_SURFACE_ADDRESS_HIGH_C, 0,\n\t\t\tPRIMARY_META_SURFACE_ADDRESS_HIGH_C,\n\t\t\tflip_regs->DCSURF_PRIMARY_META_SURFACE_ADDRESS_HIGH_C);\n\n\tREG_SET(DCSURF_PRIMARY_META_SURFACE_ADDRESS_C, 0,\n\t\t\tPRIMARY_META_SURFACE_ADDRESS_C,\n\t\t\tflip_regs->DCSURF_PRIMARY_META_SURFACE_ADDRESS_C);\n\n\tREG_SET(DCSURF_PRIMARY_META_SURFACE_ADDRESS_HIGH, 0,\n\t\t\tPRIMARY_META_SURFACE_ADDRESS_HIGH,\n\t\t\tflip_regs->DCSURF_PRIMARY_META_SURFACE_ADDRESS_HIGH);\n\n\tREG_SET(DCSURF_PRIMARY_META_SURFACE_ADDRESS, 0,\n\t\t\tPRIMARY_META_SURFACE_ADDRESS,\n\t\t\tflip_regs->DCSURF_PRIMARY_META_SURFACE_ADDRESS);\n\n\tREG_SET(DCSURF_SECONDARY_META_SURFACE_ADDRESS_HIGH, 0,\n\t\t\tSECONDARY_META_SURFACE_ADDRESS_HIGH,\n\t\t\tflip_regs->DCSURF_SECONDARY_META_SURFACE_ADDRESS_HIGH);\n\n\tREG_SET(DCSURF_SECONDARY_META_SURFACE_ADDRESS, 0,\n\t\t\tSECONDARY_META_SURFACE_ADDRESS,\n\t\t\tflip_regs->DCSURF_SECONDARY_META_SURFACE_ADDRESS);\n\n\n\tREG_SET(DCSURF_SECONDARY_SURFACE_ADDRESS_HIGH, 0,\n\t\t\tSECONDARY_SURFACE_ADDRESS_HIGH,\n\t\t\tflip_regs->DCSURF_SECONDARY_SURFACE_ADDRESS_HIGH);\n\n\tREG_SET(DCSURF_SECONDARY_SURFACE_ADDRESS, 0,\n\t\t\tSECONDARY_SURFACE_ADDRESS,\n\t\t\tflip_regs->DCSURF_SECONDARY_SURFACE_ADDRESS);\n\n\n\tREG_SET(DCSURF_PRIMARY_SURFACE_ADDRESS_HIGH_C, 0,\n\t\t\tPRIMARY_SURFACE_ADDRESS_HIGH_C,\n\t\t\tflip_regs->DCSURF_PRIMARY_SURFACE_ADDRESS_HIGH_C);\n\n\tREG_SET(DCSURF_PRIMARY_SURFACE_ADDRESS_C, 0,\n\t\t\tPRIMARY_SURFACE_ADDRESS_C,\n\t\t\tflip_regs->DCSURF_PRIMARY_SURFACE_ADDRESS_C);\n\n\tREG_SET(DCSURF_PRIMARY_SURFACE_ADDRESS_HIGH, 0,\n\t\t\tPRIMARY_SURFACE_ADDRESS_HIGH,\n\t\t\tflip_regs->DCSURF_PRIMARY_SURFACE_ADDRESS_HIGH);\n\n\tREG_SET(DCSURF_PRIMARY_SURFACE_ADDRESS, 0,\n\t\t\tPRIMARY_SURFACE_ADDRESS,\n\t\t\tflip_regs->DCSURF_PRIMARY_SURFACE_ADDRESS);\n}\n\nstatic void dmcub_PLAT_54186_wa(struct hubp *hubp,\n\t\t\t\tstruct surface_flip_registers *flip_regs)\n{\n\tstruct dcn21_hubp *hubp21 = TO_DCN21_HUBP(hubp);\n\tunion dmub_rb_cmd cmd;\n\n\tmemset(&cmd, 0, sizeof(cmd));\n\n\tcmd.PLAT_54186_wa.header.type = DMUB_CMD__PLAT_54186_WA;\n\tcmd.PLAT_54186_wa.header.payload_bytes = sizeof(cmd.PLAT_54186_wa.flip);\n\tcmd.PLAT_54186_wa.flip.DCSURF_PRIMARY_SURFACE_ADDRESS =\n\t\tflip_regs->DCSURF_PRIMARY_SURFACE_ADDRESS;\n\tcmd.PLAT_54186_wa.flip.DCSURF_PRIMARY_SURFACE_ADDRESS_C =\n\t\tflip_regs->DCSURF_PRIMARY_SURFACE_ADDRESS_C;\n\tcmd.PLAT_54186_wa.flip.DCSURF_PRIMARY_SURFACE_ADDRESS_HIGH =\n\t\tflip_regs->DCSURF_PRIMARY_SURFACE_ADDRESS_HIGH;\n\tcmd.PLAT_54186_wa.flip.DCSURF_PRIMARY_SURFACE_ADDRESS_HIGH_C =\n\t\tflip_regs->DCSURF_PRIMARY_SURFACE_ADDRESS_HIGH_C;\n\tcmd.PLAT_54186_wa.flip.flip_params.grph_stereo = flip_regs->grph_stereo;\n\tcmd.PLAT_54186_wa.flip.flip_params.hubp_inst = hubp->inst;\n\tcmd.PLAT_54186_wa.flip.flip_params.immediate = flip_regs->immediate;\n\tcmd.PLAT_54186_wa.flip.flip_params.tmz_surface = flip_regs->tmz_surface;\n\tcmd.PLAT_54186_wa.flip.flip_params.vmid = flip_regs->vmid;\n\n\tPERF_TRACE();  \n\tdm_execute_dmub_cmd(hubp->ctx, &cmd, DM_DMUB_WAIT_TYPE_WAIT);\n\tPERF_TRACE();  \n}\n\nstatic bool hubp21_program_surface_flip_and_addr(\n\t\tstruct hubp *hubp,\n\t\tconst struct dc_plane_address *address,\n\t\tbool flip_immediate)\n{\n\tstruct surface_flip_registers flip_regs = { 0 };\n\n\tflip_regs.vmid = address->vmid;\n\n\tswitch (address->type) {\n\tcase PLN_ADDR_TYPE_GRAPHICS:\n\t\tif (address->grph.addr.quad_part == 0) {\n\t\t\tBREAK_TO_DEBUGGER();\n\t\t\tbreak;\n\t\t}\n\n\t\tif (address->grph.meta_addr.quad_part != 0) {\n\t\t\tflip_regs.DCSURF_PRIMARY_META_SURFACE_ADDRESS =\n\t\t\t\t\taddress->grph.meta_addr.low_part;\n\t\t\tflip_regs.DCSURF_PRIMARY_META_SURFACE_ADDRESS_HIGH =\n\t\t\t\t\taddress->grph.meta_addr.high_part;\n\t\t}\n\n\t\tflip_regs.DCSURF_PRIMARY_SURFACE_ADDRESS =\n\t\t\t\taddress->grph.addr.low_part;\n\t\tflip_regs.DCSURF_PRIMARY_SURFACE_ADDRESS_HIGH =\n\t\t\t\taddress->grph.addr.high_part;\n\t\tbreak;\n\tcase PLN_ADDR_TYPE_VIDEO_PROGRESSIVE:\n\t\tif (address->video_progressive.luma_addr.quad_part == 0\n\t\t\t\t|| address->video_progressive.chroma_addr.quad_part == 0)\n\t\t\tbreak;\n\n\t\tif (address->video_progressive.luma_meta_addr.quad_part != 0) {\n\t\t\tflip_regs.DCSURF_PRIMARY_META_SURFACE_ADDRESS =\n\t\t\t\t\taddress->video_progressive.luma_meta_addr.low_part;\n\t\t\tflip_regs.DCSURF_PRIMARY_META_SURFACE_ADDRESS_HIGH =\n\t\t\t\t\taddress->video_progressive.luma_meta_addr.high_part;\n\n\t\t\tflip_regs.DCSURF_PRIMARY_META_SURFACE_ADDRESS_C =\n\t\t\t\t\taddress->video_progressive.chroma_meta_addr.low_part;\n\t\t\tflip_regs.DCSURF_PRIMARY_META_SURFACE_ADDRESS_HIGH_C =\n\t\t\t\t\taddress->video_progressive.chroma_meta_addr.high_part;\n\t\t}\n\n\t\tflip_regs.DCSURF_PRIMARY_SURFACE_ADDRESS =\n\t\t\t\taddress->video_progressive.luma_addr.low_part;\n\t\tflip_regs.DCSURF_PRIMARY_SURFACE_ADDRESS_HIGH =\n\t\t\t\taddress->video_progressive.luma_addr.high_part;\n\n\t\tflip_regs.DCSURF_PRIMARY_SURFACE_ADDRESS_C =\n\t\t\t\taddress->video_progressive.chroma_addr.low_part;\n\n\t\tflip_regs.DCSURF_PRIMARY_SURFACE_ADDRESS_HIGH_C =\n\t\t\t\taddress->video_progressive.chroma_addr.high_part;\n\n\t\tbreak;\n\tcase PLN_ADDR_TYPE_GRPH_STEREO:\n\t\tif (address->grph_stereo.left_addr.quad_part == 0)\n\t\t\tbreak;\n\t\tif (address->grph_stereo.right_addr.quad_part == 0)\n\t\t\tbreak;\n\n\t\tflip_regs.grph_stereo = true;\n\n\t\tif (address->grph_stereo.right_meta_addr.quad_part != 0) {\n\t\t\tflip_regs.DCSURF_SECONDARY_META_SURFACE_ADDRESS =\n\t\t\t\t\taddress->grph_stereo.right_meta_addr.low_part;\n\t\t\tflip_regs.DCSURF_SECONDARY_META_SURFACE_ADDRESS_HIGH =\n\t\t\t\t\taddress->grph_stereo.right_meta_addr.high_part;\n\t\t}\n\n\t\tif (address->grph_stereo.left_meta_addr.quad_part != 0) {\n\t\t\tflip_regs.DCSURF_PRIMARY_META_SURFACE_ADDRESS =\n\t\t\t\t\taddress->grph_stereo.left_meta_addr.low_part;\n\t\t\tflip_regs.DCSURF_PRIMARY_META_SURFACE_ADDRESS_HIGH =\n\t\t\t\t\taddress->grph_stereo.left_meta_addr.high_part;\n\t\t}\n\n\t\tflip_regs.DCSURF_PRIMARY_SURFACE_ADDRESS =\n\t\t\t\taddress->grph_stereo.left_addr.low_part;\n\t\tflip_regs.DCSURF_PRIMARY_SURFACE_ADDRESS_HIGH =\n\t\t\t\taddress->grph_stereo.left_addr.high_part;\n\n\t\tflip_regs.DCSURF_SECONDARY_SURFACE_ADDRESS =\n\t\t\t\taddress->grph_stereo.right_addr.low_part;\n\t\tflip_regs.DCSURF_SECONDARY_SURFACE_ADDRESS_HIGH =\n\t\t\t\taddress->grph_stereo.right_addr.high_part;\n\n\t\tbreak;\n\tdefault:\n\t\tBREAK_TO_DEBUGGER();\n\t\tbreak;\n\t}\n\n\tflip_regs.tmz_surface = address->tmz_surface;\n\tflip_regs.immediate = flip_immediate;\n\n\tif (hubp->ctx->dc->debug.enable_dmcub_surface_flip && address->type == PLN_ADDR_TYPE_VIDEO_PROGRESSIVE)\n\t\tdmcub_PLAT_54186_wa(hubp, &flip_regs);\n\telse\n\t\tprogram_surface_flip_and_addr(hubp, &flip_regs);\n\n\thubp->request_address = *address;\n\n\treturn true;\n}\n\nstatic void hubp21_init(struct hubp *hubp)\n{\n\t\n\t\n\n\tstruct dcn21_hubp *hubp21 = TO_DCN21_HUBP(hubp);\n\t\n\tREG_WRITE(HUBPREQ_DEBUG, 1 << 26);\n}\nstatic struct hubp_funcs dcn21_hubp_funcs = {\n\t.hubp_enable_tripleBuffer = hubp2_enable_triplebuffer,\n\t.hubp_is_triplebuffer_enabled = hubp2_is_triplebuffer_enabled,\n\t.hubp_program_surface_flip_and_addr = hubp21_program_surface_flip_and_addr,\n\t.hubp_program_surface_config = hubp1_program_surface_config,\n\t.hubp_is_flip_pending = hubp1_is_flip_pending,\n\t.hubp_setup = hubp21_setup,\n\t.hubp_setup_interdependent = hubp2_setup_interdependent,\n\t.hubp_set_vm_system_aperture_settings = hubp21_set_vm_system_aperture_settings,\n\t.set_blank = hubp1_set_blank,\n\t.dcc_control = hubp1_dcc_control,\n\t.mem_program_viewport = hubp21_set_viewport,\n\t.set_cursor_attributes\t= hubp2_cursor_set_attributes,\n\t.set_cursor_position\t= hubp1_cursor_set_position,\n\t.hubp_clk_cntl = hubp1_clk_cntl,\n\t.hubp_vtg_sel = hubp1_vtg_sel,\n\t.dmdata_set_attributes = hubp2_dmdata_set_attributes,\n\t.dmdata_load = hubp2_dmdata_load,\n\t.dmdata_status_done = hubp2_dmdata_status_done,\n\t.hubp_read_state = hubp2_read_state,\n\t.hubp_clear_underflow = hubp1_clear_underflow,\n\t.hubp_set_flip_control_surface_gsl = hubp2_set_flip_control_surface_gsl,\n\t.hubp_init = hubp21_init,\n\t.validate_dml_output = hubp21_validate_dml_output,\n\t.hubp_set_flip_int = hubp1_set_flip_int,\n};\n\nbool hubp21_construct(\n\tstruct dcn21_hubp *hubp21,\n\tstruct dc_context *ctx,\n\tuint32_t inst,\n\tconst struct dcn_hubp2_registers *hubp_regs,\n\tconst struct dcn_hubp2_shift *hubp_shift,\n\tconst struct dcn_hubp2_mask *hubp_mask)\n{\n\thubp21->base.funcs = &dcn21_hubp_funcs;\n\thubp21->base.ctx = ctx;\n\thubp21->hubp_regs = hubp_regs;\n\thubp21->hubp_shift = hubp_shift;\n\thubp21->hubp_mask = hubp_mask;\n\thubp21->base.inst = inst;\n\thubp21->base.opp_id = OPP_ID_INVALID;\n\thubp21->base.mpcc_id = 0xf;\n\n\treturn true;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}