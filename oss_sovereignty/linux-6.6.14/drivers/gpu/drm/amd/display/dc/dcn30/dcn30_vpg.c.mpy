{
  "module_name": "dcn30_vpg.c",
  "hash_id": "c70a3494914bf85ef3b5226cdcc5059e9a682ec32179b7f76d2165129db4fb16",
  "original_prompt": "Ingested from linux-6.6.14/drivers/gpu/drm/amd/display/dc/dcn30/dcn30_vpg.c",
  "human_readable_source": " \n\n\n#include \"dc_bios_types.h\"\n#include \"dcn30_vpg.h\"\n#include \"reg_helper.h\"\n\n#define DC_LOGGER \\\n\t\tvpg3->base.ctx->logger\n\n#define REG(reg)\\\n\t(vpg3->regs->reg)\n\n#undef FN\n#define FN(reg_name, field_name) \\\n\tvpg3->vpg_shift->field_name, vpg3->vpg_mask->field_name\n\n\n#define CTX \\\n\tvpg3->base.ctx\n\n\nvoid vpg3_update_generic_info_packet(\n\tstruct vpg *vpg,\n\tuint32_t packet_index,\n\tconst struct dc_info_packet *info_packet,\n\tbool immediate_update)\n{\n\tstruct dcn30_vpg *vpg3 = DCN30_VPG_FROM_VPG(vpg);\n\tuint32_t i;\n\n\t \n\tuint32_t max_retries = 50;\n\n\tif (packet_index > 14)\n\t\tASSERT(0);\n\n\t \n\t \n\n\t \n\t \n\tREG_WAIT(VPG_GENERIC_STATUS, VPG_GENERIC_CONFLICT_OCCURED,\n\t\t\t0, 10, max_retries);\n\n\t \n\tREG_UPDATE(VPG_GENERIC_STATUS, VPG_GENERIC_CONFLICT_CLR, 1);\n\n\t \n\tREG_UPDATE(VPG_GENERIC_PACKET_ACCESS_CTRL,\n\t\t\tVPG_GENERIC_DATA_INDEX, packet_index*9);\n\n\t \n\tREG_SET_4(VPG_GENERIC_PACKET_DATA, 0,\n\t\t\tVPG_GENERIC_DATA_BYTE0, info_packet->hb0,\n\t\t\tVPG_GENERIC_DATA_BYTE1, info_packet->hb1,\n\t\t\tVPG_GENERIC_DATA_BYTE2, info_packet->hb2,\n\t\t\tVPG_GENERIC_DATA_BYTE3, info_packet->hb3);\n\n\t \n\t{\n\t\tconst uint32_t *content =\n\t\t\t(const uint32_t *) &info_packet->sb[0];\n\n\t\tfor (i = 0; i < 8; i++) {\n\t\t\tREG_WRITE(VPG_GENERIC_PACKET_DATA, *content++);\n\t\t}\n\t}\n\n\t \n\tif (immediate_update) {\n\t\tswitch (packet_index) {\n\t\tcase 0:\n\t\t\tREG_UPDATE(VPG_GSP_IMMEDIATE_UPDATE_CTRL,\n\t\t\t\t\tVPG_GENERIC0_IMMEDIATE_UPDATE, 1);\n\t\t\tbreak;\n\t\tcase 1:\n\t\t\tREG_UPDATE(VPG_GSP_IMMEDIATE_UPDATE_CTRL,\n\t\t\t\t\tVPG_GENERIC1_IMMEDIATE_UPDATE, 1);\n\t\t\tbreak;\n\t\tcase 2:\n\t\t\tREG_UPDATE(VPG_GSP_IMMEDIATE_UPDATE_CTRL,\n\t\t\t\t\tVPG_GENERIC2_IMMEDIATE_UPDATE, 1);\n\t\t\tbreak;\n\t\tcase 3:\n\t\t\tREG_UPDATE(VPG_GSP_IMMEDIATE_UPDATE_CTRL,\n\t\t\t\t\tVPG_GENERIC3_IMMEDIATE_UPDATE, 1);\n\t\t\tbreak;\n\t\tcase 4:\n\t\t\tREG_UPDATE(VPG_GSP_IMMEDIATE_UPDATE_CTRL,\n\t\t\t\t\tVPG_GENERIC4_IMMEDIATE_UPDATE, 1);\n\t\t\tbreak;\n\t\tcase 5:\n\t\t\tREG_UPDATE(VPG_GSP_IMMEDIATE_UPDATE_CTRL,\n\t\t\t\t\tVPG_GENERIC5_IMMEDIATE_UPDATE, 1);\n\t\t\tbreak;\n\t\tcase 6:\n\t\t\tREG_UPDATE(VPG_GSP_IMMEDIATE_UPDATE_CTRL,\n\t\t\t\t\tVPG_GENERIC6_IMMEDIATE_UPDATE, 1);\n\t\t\tbreak;\n\t\tcase 7:\n\t\t\tREG_UPDATE(VPG_GSP_IMMEDIATE_UPDATE_CTRL,\n\t\t\t\t\tVPG_GENERIC7_IMMEDIATE_UPDATE, 1);\n\t\t\tbreak;\n\t\tcase 8:\n\t\t\tREG_UPDATE(VPG_GSP_IMMEDIATE_UPDATE_CTRL,\n\t\t\t\t\tVPG_GENERIC8_IMMEDIATE_UPDATE, 1);\n\t\t\tbreak;\n\t\tcase 9:\n\t\t\tREG_UPDATE(VPG_GSP_IMMEDIATE_UPDATE_CTRL,\n\t\t\t\t\tVPG_GENERIC9_IMMEDIATE_UPDATE, 1);\n\t\t\tbreak;\n\t\tcase 10:\n\t\t\tREG_UPDATE(VPG_GSP_IMMEDIATE_UPDATE_CTRL,\n\t\t\t\t\tVPG_GENERIC10_IMMEDIATE_UPDATE, 1);\n\t\t\tbreak;\n\t\tcase 11:\n\t\t\tREG_UPDATE(VPG_GSP_IMMEDIATE_UPDATE_CTRL,\n\t\t\t\t\tVPG_GENERIC11_IMMEDIATE_UPDATE, 1);\n\t\t\tbreak;\n\t\tcase 12:\n\t\t\tREG_UPDATE(VPG_GSP_IMMEDIATE_UPDATE_CTRL,\n\t\t\t\t\tVPG_GENERIC12_IMMEDIATE_UPDATE, 1);\n\t\t\tbreak;\n\t\tcase 13:\n\t\t\tREG_UPDATE(VPG_GSP_IMMEDIATE_UPDATE_CTRL,\n\t\t\t\t\tVPG_GENERIC13_IMMEDIATE_UPDATE, 1);\n\t\t\tbreak;\n\t\tcase 14:\n\t\t\tREG_UPDATE(VPG_GSP_IMMEDIATE_UPDATE_CTRL,\n\t\t\t\t\tVPG_GENERIC14_IMMEDIATE_UPDATE, 1);\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tbreak;\n\t\t}\n\t} else {\n\t\tswitch (packet_index) {\n\t\tcase 0:\n\t\t\tREG_UPDATE(VPG_GSP_FRAME_UPDATE_CTRL,\n\t\t\t\t\tVPG_GENERIC0_FRAME_UPDATE, 1);\n\t\t\tbreak;\n\t\tcase 1:\n\t\t\tREG_UPDATE(VPG_GSP_FRAME_UPDATE_CTRL,\n\t\t\t\t\tVPG_GENERIC1_FRAME_UPDATE, 1);\n\t\t\tbreak;\n\t\tcase 2:\n\t\t\tREG_UPDATE(VPG_GSP_FRAME_UPDATE_CTRL,\n\t\t\t\t\tVPG_GENERIC2_FRAME_UPDATE, 1);\n\t\t\tbreak;\n\t\tcase 3:\n\t\t\tREG_UPDATE(VPG_GSP_FRAME_UPDATE_CTRL,\n\t\t\t\t\tVPG_GENERIC3_FRAME_UPDATE, 1);\n\t\t\tbreak;\n\t\tcase 4:\n\t\t\tREG_UPDATE(VPG_GSP_FRAME_UPDATE_CTRL,\n\t\t\t\t\tVPG_GENERIC4_FRAME_UPDATE, 1);\n\t\t\tbreak;\n\t\tcase 5:\n\t\t\tREG_UPDATE(VPG_GSP_FRAME_UPDATE_CTRL,\n\t\t\t\t\tVPG_GENERIC5_FRAME_UPDATE, 1);\n\t\t\tbreak;\n\t\tcase 6:\n\t\t\tREG_UPDATE(VPG_GSP_FRAME_UPDATE_CTRL,\n\t\t\t\t\tVPG_GENERIC6_FRAME_UPDATE, 1);\n\t\t\tbreak;\n\t\tcase 7:\n\t\t\tREG_UPDATE(VPG_GSP_FRAME_UPDATE_CTRL,\n\t\t\t\t\tVPG_GENERIC7_FRAME_UPDATE, 1);\n\t\t\tbreak;\n\t\tcase 8:\n\t\t\tREG_UPDATE(VPG_GSP_FRAME_UPDATE_CTRL,\n\t\t\t\t\tVPG_GENERIC8_FRAME_UPDATE, 1);\n\t\t\tbreak;\n\t\tcase 9:\n\t\t\tREG_UPDATE(VPG_GSP_FRAME_UPDATE_CTRL,\n\t\t\t\t\tVPG_GENERIC9_FRAME_UPDATE, 1);\n\t\t\tbreak;\n\t\tcase 10:\n\t\t\tREG_UPDATE(VPG_GSP_FRAME_UPDATE_CTRL,\n\t\t\t\t\tVPG_GENERIC10_FRAME_UPDATE, 1);\n\t\t\tbreak;\n\t\tcase 11:\n\t\t\tREG_UPDATE(VPG_GSP_FRAME_UPDATE_CTRL,\n\t\t\t\t\tVPG_GENERIC11_FRAME_UPDATE, 1);\n\t\t\tbreak;\n\t\tcase 12:\n\t\t\tREG_UPDATE(VPG_GSP_FRAME_UPDATE_CTRL,\n\t\t\t\t\tVPG_GENERIC12_FRAME_UPDATE, 1);\n\t\t\tbreak;\n\t\tcase 13:\n\t\t\tREG_UPDATE(VPG_GSP_FRAME_UPDATE_CTRL,\n\t\t\t\t\tVPG_GENERIC13_FRAME_UPDATE, 1);\n\t\t\tbreak;\n\t\tcase 14:\n\t\t\tREG_UPDATE(VPG_GSP_FRAME_UPDATE_CTRL,\n\t\t\t\t\tVPG_GENERIC14_FRAME_UPDATE, 1);\n\t\t\tbreak;\n\n\t\tdefault:\n\t\t\tbreak;\n\t\t}\n\n\t}\n}\n\nstatic struct vpg_funcs dcn30_vpg_funcs = {\n\t.update_generic_info_packet\t= vpg3_update_generic_info_packet,\n};\n\nvoid vpg3_construct(struct dcn30_vpg *vpg3,\n\tstruct dc_context *ctx,\n\tuint32_t inst,\n\tconst struct dcn30_vpg_registers *vpg_regs,\n\tconst struct dcn30_vpg_shift *vpg_shift,\n\tconst struct dcn30_vpg_mask *vpg_mask)\n{\n\tvpg3->base.ctx = ctx;\n\n\tvpg3->base.inst = inst;\n\tvpg3->base.funcs = &dcn30_vpg_funcs;\n\n\tvpg3->regs = vpg_regs;\n\tvpg3->vpg_shift = vpg_shift;\n\tvpg3->vpg_mask = vpg_mask;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}