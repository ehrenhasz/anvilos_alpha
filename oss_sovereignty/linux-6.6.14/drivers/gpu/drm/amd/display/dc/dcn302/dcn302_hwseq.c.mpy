{
  "module_name": "dcn302_hwseq.c",
  "hash_id": "991e84a0e52c03b815c605718f43361654d6d48bceed1aa2c67ac10eee4e8969",
  "original_prompt": "Ingested from linux-6.6.14/drivers/gpu/drm/amd/display/dc/dcn302/dcn302_hwseq.c",
  "human_readable_source": " \n\n#include \"dcn302_hwseq.h\"\n\n#include \"dce/dce_hwseq.h\"\n\n#include \"reg_helper.h\"\n#include \"dc.h\"\n\n#define DC_LOGGER_INIT(logger)\n\n#define CTX \\\n\thws->ctx\n#define REG(reg)\\\n\thws->regs->reg\n\n#undef FN\n#define FN(reg_name, field_name) \\\n\thws->shifts->field_name, hws->masks->field_name\n\n\nvoid dcn302_dpp_pg_control(struct dce_hwseq *hws, unsigned int dpp_inst, bool power_on)\n{\n\tuint32_t power_gate = power_on ? 0 : 1;\n\tuint32_t pwr_status = power_on ? 0 : 2;\n\n\tif (hws->ctx->dc->debug.disable_dpp_power_gate)\n\t\treturn;\n\tif (REG(DOMAIN1_PG_CONFIG) == 0)\n\t\treturn;\n\n\tswitch (dpp_inst) {\n\tcase 0:  \n\t\tREG_UPDATE(DOMAIN1_PG_CONFIG,\n\t\t\t\tDOMAIN1_POWER_GATE, power_gate);\n\n\t\tREG_WAIT(DOMAIN1_PG_STATUS,\n\t\t\t\tDOMAIN1_PGFSM_PWR_STATUS, pwr_status,\n\t\t\t\t1, 1000);\n\t\tbreak;\n\tcase 1:  \n\t\tREG_UPDATE(DOMAIN3_PG_CONFIG,\n\t\t\t\tDOMAIN3_POWER_GATE, power_gate);\n\n\t\tREG_WAIT(DOMAIN3_PG_STATUS,\n\t\t\t\tDOMAIN3_PGFSM_PWR_STATUS, pwr_status,\n\t\t\t\t1, 1000);\n\t\tbreak;\n\tcase 2:  \n\t\tREG_UPDATE(DOMAIN5_PG_CONFIG,\n\t\t\t\tDOMAIN5_POWER_GATE, power_gate);\n\n\t\tREG_WAIT(DOMAIN5_PG_STATUS,\n\t\t\t\tDOMAIN5_PGFSM_PWR_STATUS, pwr_status,\n\t\t\t\t1, 1000);\n\t\tbreak;\n\tcase 3:  \n\t\tREG_UPDATE(DOMAIN7_PG_CONFIG,\n\t\t\t\tDOMAIN7_POWER_GATE, power_gate);\n\n\t\tREG_WAIT(DOMAIN7_PG_STATUS,\n\t\t\t\tDOMAIN7_PGFSM_PWR_STATUS, pwr_status,\n\t\t\t\t1, 1000);\n\t\tbreak;\n\tcase 4:  \n\t\tREG_UPDATE(DOMAIN9_PG_CONFIG,\n\t\t\t\tDOMAIN9_POWER_GATE, power_gate);\n\n\t\tREG_WAIT(DOMAIN9_PG_STATUS,\n\t\t\t\tDOMAIN9_PGFSM_PWR_STATUS, pwr_status,\n\t\t\t\t1, 1000);\n\t\tbreak;\n\tdefault:\n\t\tBREAK_TO_DEBUGGER();\n\t\tbreak;\n\t}\n}\n\nvoid dcn302_hubp_pg_control(struct dce_hwseq *hws, unsigned int hubp_inst, bool power_on)\n{\n\tuint32_t power_gate = power_on ? 0 : 1;\n\tuint32_t pwr_status = power_on ? 0 : 2;\n\n\tif (hws->ctx->dc->debug.disable_hubp_power_gate)\n\t\treturn;\n\tif (REG(DOMAIN0_PG_CONFIG) == 0)\n\t\treturn;\n\n\tswitch (hubp_inst) {\n\tcase 0:  \n\t\tREG_UPDATE(DOMAIN0_PG_CONFIG,\n\t\t\t\tDOMAIN0_POWER_GATE, power_gate);\n\n\t\tREG_WAIT(DOMAIN0_PG_STATUS,\n\t\t\t\tDOMAIN0_PGFSM_PWR_STATUS, pwr_status,\n\t\t\t\t1, 1000);\n\t\tbreak;\n\tcase 1:  \n\t\tREG_UPDATE(DOMAIN2_PG_CONFIG,\n\t\t\t\tDOMAIN2_POWER_GATE, power_gate);\n\n\t\tREG_WAIT(DOMAIN2_PG_STATUS,\n\t\t\t\tDOMAIN2_PGFSM_PWR_STATUS, pwr_status,\n\t\t\t\t1, 1000);\n\t\tbreak;\n\tcase 2:  \n\t\tREG_UPDATE(DOMAIN4_PG_CONFIG,\n\t\t\t\tDOMAIN4_POWER_GATE, power_gate);\n\n\t\tREG_WAIT(DOMAIN4_PG_STATUS,\n\t\t\t\tDOMAIN4_PGFSM_PWR_STATUS, pwr_status,\n\t\t\t\t1, 1000);\n\t\tbreak;\n\tcase 3:  \n\t\tREG_UPDATE(DOMAIN6_PG_CONFIG,\n\t\t\t\tDOMAIN6_POWER_GATE, power_gate);\n\n\t\tREG_WAIT(DOMAIN6_PG_STATUS,\n\t\t\t\tDOMAIN6_PGFSM_PWR_STATUS, pwr_status,\n\t\t\t\t1, 1000);\n\t\tbreak;\n\tcase 4:  \n\t\tREG_UPDATE(DOMAIN8_PG_CONFIG,\n\t\t\t\tDOMAIN8_POWER_GATE, power_gate);\n\n\t\tREG_WAIT(DOMAIN8_PG_STATUS,\n\t\t\t\tDOMAIN8_PGFSM_PWR_STATUS, pwr_status,\n\t\t\t\t1, 1000);\n\t\tbreak;\n\tdefault:\n\t\tBREAK_TO_DEBUGGER();\n\t\tbreak;\n\t}\n}\n\nvoid dcn302_dsc_pg_control(struct dce_hwseq *hws, unsigned int dsc_inst, bool power_on)\n{\n\tuint32_t power_gate = power_on ? 0 : 1;\n\tuint32_t pwr_status = power_on ? 0 : 2;\n\tuint32_t org_ip_request_cntl = 0;\n\n\tif (hws->ctx->dc->debug.disable_dsc_power_gate)\n\t\treturn;\n\n\tif (REG(DOMAIN16_PG_CONFIG) == 0)\n\t\treturn;\n\n\tREG_GET(DC_IP_REQUEST_CNTL, IP_REQUEST_EN, &org_ip_request_cntl);\n\tif (org_ip_request_cntl == 0)\n\t\tREG_SET(DC_IP_REQUEST_CNTL, 0, IP_REQUEST_EN, 1);\n\n\tswitch (dsc_inst) {\n\tcase 0:  \n\t\tREG_UPDATE(DOMAIN16_PG_CONFIG,\n\t\t\t\tDOMAIN16_POWER_GATE, power_gate);\n\n\t\tREG_WAIT(DOMAIN16_PG_STATUS,\n\t\t\t\tDOMAIN16_PGFSM_PWR_STATUS, pwr_status,\n\t\t\t\t1, 1000);\n\t\tbreak;\n\tcase 1:  \n\t\tREG_UPDATE(DOMAIN17_PG_CONFIG,\n\t\t\t\tDOMAIN17_POWER_GATE, power_gate);\n\n\t\tREG_WAIT(DOMAIN17_PG_STATUS,\n\t\t\t\tDOMAIN17_PGFSM_PWR_STATUS, pwr_status,\n\t\t\t\t1, 1000);\n\t\tbreak;\n\tcase 2:  \n\t\tREG_UPDATE(DOMAIN18_PG_CONFIG,\n\t\t\t\tDOMAIN18_POWER_GATE, power_gate);\n\n\t\tREG_WAIT(DOMAIN18_PG_STATUS,\n\t\t\t\tDOMAIN18_PGFSM_PWR_STATUS, pwr_status,\n\t\t\t\t1, 1000);\n\t\tbreak;\n\tcase 3:  \n\t\tREG_UPDATE(DOMAIN19_PG_CONFIG,\n\t\t\t\tDOMAIN19_POWER_GATE, power_gate);\n\n\t\tREG_WAIT(DOMAIN19_PG_STATUS,\n\t\t\t\tDOMAIN19_PGFSM_PWR_STATUS, pwr_status,\n\t\t\t\t1, 1000);\n\t\tbreak;\n\tcase 4:  \n\t\tREG_UPDATE(DOMAIN20_PG_CONFIG,\n\t\t\t\tDOMAIN20_POWER_GATE, power_gate);\n\n\t\tREG_WAIT(DOMAIN20_PG_STATUS,\n\t\t\t\tDOMAIN20_PGFSM_PWR_STATUS, pwr_status,\n\t\t\t\t1, 1000);\n\t\tbreak;\n\tdefault:\n\t\tBREAK_TO_DEBUGGER();\n\t\tbreak;\n\t}\n\n\tif (org_ip_request_cntl == 0)\n\t\tREG_SET(DC_IP_REQUEST_CNTL, 0, IP_REQUEST_EN, 0);\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}