{
  "module_name": "link_encoder.h",
  "hash_id": "8b98f77c1d1f77ef1375792c54fda06722c35ced39c26d18f013c211845c21c8",
  "original_prompt": "Ingested from linux-6.6.14/drivers/gpu/drm/amd/display/dc/inc/hw/link_encoder.h",
  "human_readable_source": " \n \n\n#ifndef LINK_ENCODER_H_\n#define LINK_ENCODER_H_\n\n#include \"grph_object_defs.h\"\n#include \"signal_types.h\"\n#include \"dc_types.h\"\n\nstruct dc_context;\nstruct encoder_set_dp_phy_pattern_param;\nstruct link_mst_stream_allocation_table;\nstruct dc_link_settings;\nstruct link_training_settings;\nstruct pipe_ctx;\n\nstruct encoder_init_data {\n\tenum channel_id channel;\n\tstruct graphics_object_id connector;\n\tenum hpd_source_id hpd_source;\n\t \n\tstruct graphics_object_id encoder;\n\tstruct dc_context *ctx;\n\tenum transmitter transmitter;\n};\n\nstruct encoder_feature_support {\n\tunion {\n\t\tstruct {\n\t\t\tuint32_t IS_HBR2_CAPABLE:1;\n\t\t\tuint32_t IS_HBR3_CAPABLE:1;\n\t\t\tuint32_t IS_TPS3_CAPABLE:1;\n\t\t\tuint32_t IS_TPS4_CAPABLE:1;\n\t\t\tuint32_t HDMI_6GB_EN:1;\n\t\t\tuint32_t IS_DP2_CAPABLE:1;\n\t\t\tuint32_t IS_UHBR10_CAPABLE:1;\n\t\t\tuint32_t IS_UHBR13_5_CAPABLE:1;\n\t\t\tuint32_t IS_UHBR20_CAPABLE:1;\n\t\t\tuint32_t DP_IS_USB_C:1;\n\t\t} bits;\n\t\tuint32_t raw;\n\t} flags;\n\n\tenum dc_color_depth max_hdmi_deep_color;\n\tunsigned int max_hdmi_pixel_clock;\n\tbool hdmi_ycbcr420_supported;\n\tbool dp_ycbcr420_supported;\n\tbool fec_supported;\n};\n\nstruct link_encoder {\n\tconst struct link_encoder_funcs *funcs;\n\tint32_t aux_channel_offset;\n\tstruct dc_context *ctx;\n\tstruct graphics_object_id id;\n\tstruct graphics_object_id connector;\n\tuint32_t output_signals;\n\tenum engine_id preferred_engine;\n\tstruct encoder_feature_support features;\n\tenum transmitter transmitter;\n\tenum hpd_source_id hpd_source;\n\tbool usbc_combo_phy;\n};\n\nstruct link_enc_state {\n\n\t\tuint32_t dphy_fec_en;\n\t\tuint32_t dphy_fec_ready_shadow;\n\t\tuint32_t dphy_fec_active_status;\n\t\tuint32_t dp_link_training_complete;\n\n};\n\nenum encoder_type_select {\n\tENCODER_TYPE_DIG = 0,\n\tENCODER_TYPE_HDMI_FRL = 1,\n\tENCODER_TYPE_DP_128B132B = 2\n};\n\nstruct link_encoder_funcs {\n\tvoid (*read_state)(\n\t\t\tstruct link_encoder *enc, struct link_enc_state *s);\n\tbool (*validate_output_with_stream)(\n\t\tstruct link_encoder *enc, const struct dc_stream_state *stream);\n\tvoid (*hw_init)(struct link_encoder *enc);\n\tvoid (*setup)(struct link_encoder *enc,\n\t\tenum signal_type signal);\n\tvoid (*enable_tmds_output)(struct link_encoder *enc,\n\t\tenum clock_source_id clock_source,\n\t\tenum dc_color_depth color_depth,\n\t\tenum signal_type signal,\n\t\tuint32_t pixel_clock);\n\tvoid (*enable_dp_output)(struct link_encoder *enc,\n\t\tconst struct dc_link_settings *link_settings,\n\t\tenum clock_source_id clock_source);\n\tvoid (*enable_dp_mst_output)(struct link_encoder *enc,\n\t\tconst struct dc_link_settings *link_settings,\n\t\tenum clock_source_id clock_source);\n\tvoid (*enable_lvds_output)(struct link_encoder *enc,\n\t\tenum clock_source_id clock_source,\n\t\tuint32_t pixel_clock);\n\tvoid (*disable_output)(struct link_encoder *link_enc,\n\t\tenum signal_type signal);\n\tvoid (*dp_set_lane_settings)(struct link_encoder *enc,\n\t\tconst struct dc_link_settings *link_settings,\n\t\tconst struct dc_lane_settings lane_settings[LANE_COUNT_DP_MAX]);\n\tvoid (*dp_set_phy_pattern)(struct link_encoder *enc,\n\t\tconst struct encoder_set_dp_phy_pattern_param *para);\n\tvoid (*update_mst_stream_allocation_table)(\n\t\tstruct link_encoder *enc,\n\t\tconst struct link_mst_stream_allocation_table *table);\n\tvoid (*psr_program_dp_dphy_fast_training)(struct link_encoder *enc,\n\t\t\tbool exit_link_training_required);\n\tvoid (*psr_program_secondary_packet)(struct link_encoder *enc,\n\t\t\t\tunsigned int sdp_transmit_line_num_deadline);\n\tvoid (*connect_dig_be_to_fe)(struct link_encoder *enc,\n\t\tenum engine_id engine,\n\t\tbool connect);\n\tvoid (*enable_hpd)(struct link_encoder *enc);\n\tvoid (*disable_hpd)(struct link_encoder *enc);\n\tbool (*is_dig_enabled)(struct link_encoder *enc);\n\tunsigned int (*get_dig_frontend)(struct link_encoder *enc);\n\tvoid (*destroy)(struct link_encoder **enc);\n\n\tvoid (*fec_set_enable)(struct link_encoder *enc,\n\t\tbool enable);\n\n\tvoid (*fec_set_ready)(struct link_encoder *enc,\n\t\tbool ready);\n\n\tbool (*fec_is_active)(struct link_encoder *enc);\n\tbool (*is_in_alt_mode) (struct link_encoder *enc);\n\n\tvoid (*get_max_link_cap)(struct link_encoder *enc,\n\t\tstruct dc_link_settings *link_settings);\n\n\tenum signal_type (*get_dig_mode)(\n\t\tstruct link_encoder *enc);\n\tvoid (*set_dio_phy_mux)(\n\t\tstruct link_encoder *enc,\n\t\tenum encoder_type_select sel,\n\t\tuint32_t hpo_inst);\n\tvoid (*set_dig_output_mode)(\n\t\t\tstruct link_encoder *enc, uint8_t pix_per_container);\n};\n\n \nstruct link_enc_assignment {\n\tbool valid;\n\tstruct display_endpoint_id ep_id;\n\tenum engine_id eng_id;\n\tstruct dc_stream_state *stream;\n};\n\nenum link_enc_cfg_mode {\n\tLINK_ENC_CFG_STEADY,  \n\tLINK_ENC_CFG_TRANSIENT  \n};\n\nenum dp2_link_mode {\n\tDP2_LINK_TRAINING_TPS1,\n\tDP2_LINK_TRAINING_TPS2,\n\tDP2_LINK_ACTIVE,\n\tDP2_TEST_PATTERN\n};\n\nenum dp2_phy_tp_select {\n\tDP_DPHY_TP_SELECT_TPS1,\n\tDP_DPHY_TP_SELECT_TPS2,\n\tDP_DPHY_TP_SELECT_PRBS,\n\tDP_DPHY_TP_SELECT_CUSTOM,\n\tDP_DPHY_TP_SELECT_SQUARE\n};\n\nenum dp2_phy_tp_prbs {\n\tDP_DPHY_TP_PRBS7,\n\tDP_DPHY_TP_PRBS9,\n\tDP_DPHY_TP_PRBS11,\n\tDP_DPHY_TP_PRBS15,\n\tDP_DPHY_TP_PRBS23,\n\tDP_DPHY_TP_PRBS31\n};\n\nstruct hpo_dp_link_enc_state {\n\tuint32_t   link_enc_enabled;\n\tuint32_t   link_mode;\n\tuint32_t   lane_count;\n\tuint32_t   slot_count[4];\n\tuint32_t   stream_src[4];\n\tuint32_t   vc_rate_x[4];\n\tuint32_t   vc_rate_y[4];\n};\n\nstruct hpo_dp_link_encoder {\n\tconst struct hpo_dp_link_encoder_funcs *funcs;\n\tstruct dc_context *ctx;\n\tint inst;\n\tenum engine_id preferred_engine;\n\tenum transmitter transmitter;\n\tenum hpd_source_id hpd_source;\n};\n\nstruct hpo_dp_link_encoder_funcs {\n\n\tvoid (*enable_link_phy)(struct hpo_dp_link_encoder *enc,\n\t\tconst struct dc_link_settings *link_settings,\n\t\tenum transmitter transmitter,\n\t\tenum hpd_source_id hpd_source);\n\n\tvoid (*disable_link_phy)(struct hpo_dp_link_encoder *link_enc,\n\t\tenum signal_type signal);\n\n\tvoid (*link_enable)(\n\t\t\tstruct hpo_dp_link_encoder *enc,\n\t\t\tenum dc_lane_count num_lanes);\n\n\tvoid (*link_disable)(\n\t\t\tstruct hpo_dp_link_encoder *enc);\n\n\tvoid (*set_link_test_pattern)(\n\t\t\tstruct hpo_dp_link_encoder *enc,\n\t\t\tstruct encoder_set_dp_phy_pattern_param *tp_params);\n\n\tvoid (*update_stream_allocation_table)(\n\t\t\tstruct hpo_dp_link_encoder *enc,\n\t\t\tconst struct link_mst_stream_allocation_table *table);\n\n\tvoid (*set_throttled_vcp_size)(\n\t\t\tstruct hpo_dp_link_encoder *enc,\n\t\t\tuint32_t stream_encoder_inst,\n\t\t\tstruct fixed31_32 avg_time_slots_per_mtp);\n\n\tbool (*is_in_alt_mode) (\n\t\t\tstruct hpo_dp_link_encoder *enc);\n\n\tvoid (*read_state)(\n\t\t\tstruct hpo_dp_link_encoder *enc,\n\t\t\tstruct hpo_dp_link_enc_state *state);\n\n\tvoid (*set_ffe)(\n\t\tstruct hpo_dp_link_encoder *enc,\n\t\tconst struct dc_link_settings *link_settings,\n\t\tuint8_t ffe_preset);\n};\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}