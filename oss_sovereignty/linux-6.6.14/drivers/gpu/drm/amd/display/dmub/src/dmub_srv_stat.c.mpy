{
  "module_name": "dmub_srv_stat.c",
  "hash_id": "f089358037de3bb7a95f0f6b9a954f2b41fe76b4c2f342b187ee78b298be0a37",
  "original_prompt": "Ingested from linux-6.6.14/drivers/gpu/drm/amd/display/dmub/src/dmub_srv_stat.c",
  "human_readable_source": " \n\n#include \"dmub/dmub_srv_stat.h\"\n#include \"dmub/inc/dmub_cmd.h\"\n\n \n\n \nenum dmub_status dmub_srv_stat_get_notification(struct dmub_srv *dmub,\n\t\t\t\t\t\tstruct dmub_notification *notify)\n{\n\t \n\tunion dmub_rb_out_cmd cmd = {0};\n\n\tif (!dmub->hw_init) {\n\t\tnotify->type = DMUB_NOTIFICATION_NO_DATA;\n\t\tnotify->pending_notification = false;\n\t\treturn DMUB_STATUS_INVALID;\n\t}\n\n\t \n\tdmub->outbox1_rb.wrpt = dmub->hw_funcs.get_outbox1_wptr(dmub);\n\n\tif (!dmub_rb_out_front(&dmub->outbox1_rb, &cmd)) {\n\t\tnotify->type = DMUB_NOTIFICATION_NO_DATA;\n\t\tnotify->pending_notification = false;\n\t\treturn DMUB_STATUS_OK;\n\t}\n\n\tswitch (cmd.cmd_common.header.type) {\n\tcase DMUB_OUT_CMD__DP_AUX_REPLY:\n\t\tnotify->type = DMUB_NOTIFICATION_AUX_REPLY;\n\t\tnotify->link_index = cmd.dp_aux_reply.control.instance;\n\t\tnotify->result = cmd.dp_aux_reply.control.result;\n\t\tdmub_memcpy((void *)&notify->aux_reply,\n\t\t\t(void *)&cmd.dp_aux_reply.reply_data, sizeof(struct aux_reply_data));\n\t\tbreak;\n\tcase DMUB_OUT_CMD__DP_HPD_NOTIFY:\n\t\tif (cmd.dp_hpd_notify.hpd_data.hpd_type == DP_HPD) {\n\t\t\tnotify->type = DMUB_NOTIFICATION_HPD;\n\t\t\tnotify->hpd_status = cmd.dp_hpd_notify.hpd_data.hpd_status;\n\t\t} else {\n\t\t\tnotify->type = DMUB_NOTIFICATION_HPD_IRQ;\n\t\t}\n\n\t\tnotify->link_index = cmd.dp_hpd_notify.hpd_data.instance;\n\t\tnotify->result = AUX_RET_SUCCESS;\n\t\tbreak;\n\tcase DMUB_OUT_CMD__SET_CONFIG_REPLY:\n\t\tnotify->type = DMUB_NOTIFICATION_SET_CONFIG_REPLY;\n\t\tnotify->link_index = cmd.set_config_reply.set_config_reply_control.instance;\n\t\tnotify->sc_status = cmd.set_config_reply.set_config_reply_control.status;\n\t\tbreak;\n\tcase DMUB_OUT_CMD__DPIA_NOTIFICATION:\n\t\tnotify->type = DMUB_NOTIFICATION_DPIA_NOTIFICATION;\n\t\tnotify->link_index = cmd.dpia_notification.payload.header.instance;\n\n\t\tif (cmd.dpia_notification.payload.header.type == DPIA_NOTIFY__BW_ALLOCATION) {\n\n\t\t\tnotify->dpia_notification.payload.data.dpia_bw_alloc.estimated_bw =\n\t\t\t\t\tcmd.dpia_notification.payload.data.dpia_bw_alloc.estimated_bw;\n\t\t\tnotify->dpia_notification.payload.data.dpia_bw_alloc.allocated_bw =\n\t\t\t\t\tcmd.dpia_notification.payload.data.dpia_bw_alloc.allocated_bw;\n\n\t\t\tif (cmd.dpia_notification.payload.data.dpia_bw_alloc.bits.bw_request_failed)\n\t\t\t\tnotify->result = DPIA_BW_REQ_FAILED;\n\t\t\telse if (cmd.dpia_notification.payload.data.dpia_bw_alloc.bits.bw_request_succeeded)\n\t\t\t\tnotify->result = DPIA_BW_REQ_SUCCESS;\n\t\t\telse if (cmd.dpia_notification.payload.data.dpia_bw_alloc.bits.est_bw_changed)\n\t\t\t\tnotify->result = DPIA_EST_BW_CHANGED;\n\t\t\telse if (cmd.dpia_notification.payload.data.dpia_bw_alloc.bits.bw_alloc_cap_changed)\n\t\t\t\tnotify->result = DPIA_BW_ALLOC_CAPS_CHANGED;\n\t\t}\n\t\tbreak;\n\tdefault:\n\t\tnotify->type = DMUB_NOTIFICATION_NO_DATA;\n\t\tbreak;\n\t}\n\n\t \n\tdmub_rb_pop_front(&dmub->outbox1_rb);\n\tdmub->hw_funcs.set_outbox1_rptr(dmub, dmub->outbox1_rb.rptr);\n\n\t \n\tif (dmub_rb_empty(&dmub->outbox1_rb))\n\t\tnotify->pending_notification = false;\n\telse\n\t\tnotify->pending_notification = true;\n\n\treturn DMUB_STATUS_OK;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}