{
  "module_name": "smu71.h",
  "hash_id": "87dcac93bb39836897afd784baad6389628cde386bf15e101f8d4764a2230c26",
  "original_prompt": "Ingested from linux-6.6.14/drivers/gpu/drm/amd/pm/powerplay/inc/smu71.h",
  "human_readable_source": " \n#ifndef SMU71_H\n#define SMU71_H\n\n#if !defined(SMC_MICROCODE)\n#pragma pack(push, 1)\n#endif\n\n#define SMU__NUM_PCIE_DPM_LEVELS 8\n#define SMU__NUM_SCLK_DPM_STATE 8\n#define SMU__NUM_MCLK_DPM_LEVELS 4\n#define SMU__VARIANT__ICELAND 1\n#define SMU__DGPU_ONLY 1\n#define SMU__DYNAMIC_MCARB_SETTINGS 1\n\nenum SID_OPTION {\n  SID_OPTION_HI,\n  SID_OPTION_LO,\n  SID_OPTION_COUNT\n};\n\ntypedef struct {\n  uint32_t high;\n  uint32_t low;\n} data_64_t;\n\ntypedef struct {\n  data_64_t high;\n  data_64_t low;\n} data_128_t;\n\n#define SMU7_CONTEXT_ID_SMC        1\n#define SMU7_CONTEXT_ID_VBIOS      2\n\n#define SMU71_MAX_LEVELS_VDDC            8\n#define SMU71_MAX_LEVELS_VDDCI           4\n#define SMU71_MAX_LEVELS_MVDD            4\n#define SMU71_MAX_LEVELS_VDDNB           8\n\n#define SMU71_MAX_LEVELS_GRAPHICS        SMU__NUM_SCLK_DPM_STATE\n#define SMU71_MAX_LEVELS_MEMORY          SMU__NUM_MCLK_DPM_LEVELS\n#define SMU71_MAX_LEVELS_GIO             SMU__NUM_LCLK_DPM_LEVELS\n#define SMU71_MAX_LEVELS_LINK            SMU__NUM_PCIE_DPM_LEVELS\n#define SMU71_MAX_ENTRIES_SMIO           32\n\n#define DPM_NO_LIMIT 0\n#define DPM_NO_UP 1\n#define DPM_GO_DOWN 2\n#define DPM_GO_UP 3\n\n#define SMU7_FIRST_DPM_GRAPHICS_LEVEL    0\n#define SMU7_FIRST_DPM_MEMORY_LEVEL      0\n\n#define GPIO_CLAMP_MODE_VRHOT      1\n#define GPIO_CLAMP_MODE_THERM      2\n#define GPIO_CLAMP_MODE_DC         4\n\n#define SCRATCH_B_TARG_PCIE_INDEX_SHIFT 0\n#define SCRATCH_B_TARG_PCIE_INDEX_MASK  (0x7<<SCRATCH_B_TARG_PCIE_INDEX_SHIFT)\n#define SCRATCH_B_CURR_PCIE_INDEX_SHIFT 3\n#define SCRATCH_B_CURR_PCIE_INDEX_MASK  (0x7<<SCRATCH_B_CURR_PCIE_INDEX_SHIFT)\n#define SCRATCH_B_TARG_UVD_INDEX_SHIFT  6\n#define SCRATCH_B_TARG_UVD_INDEX_MASK   (0x7<<SCRATCH_B_TARG_UVD_INDEX_SHIFT)\n#define SCRATCH_B_CURR_UVD_INDEX_SHIFT  9\n#define SCRATCH_B_CURR_UVD_INDEX_MASK   (0x7<<SCRATCH_B_CURR_UVD_INDEX_SHIFT)\n#define SCRATCH_B_TARG_VCE_INDEX_SHIFT  12\n#define SCRATCH_B_TARG_VCE_INDEX_MASK   (0x7<<SCRATCH_B_TARG_VCE_INDEX_SHIFT)\n#define SCRATCH_B_CURR_VCE_INDEX_SHIFT  15\n#define SCRATCH_B_CURR_VCE_INDEX_MASK   (0x7<<SCRATCH_B_CURR_VCE_INDEX_SHIFT)\n#define SCRATCH_B_TARG_ACP_INDEX_SHIFT  18\n#define SCRATCH_B_TARG_ACP_INDEX_MASK   (0x7<<SCRATCH_B_TARG_ACP_INDEX_SHIFT)\n#define SCRATCH_B_CURR_ACP_INDEX_SHIFT  21\n#define SCRATCH_B_CURR_ACP_INDEX_MASK   (0x7<<SCRATCH_B_CURR_ACP_INDEX_SHIFT)\n#define SCRATCH_B_TARG_SAMU_INDEX_SHIFT 24\n#define SCRATCH_B_TARG_SAMU_INDEX_MASK  (0x7<<SCRATCH_B_TARG_SAMU_INDEX_SHIFT)\n#define SCRATCH_B_CURR_SAMU_INDEX_SHIFT 27\n#define SCRATCH_B_CURR_SAMU_INDEX_MASK  (0x7<<SCRATCH_B_CURR_SAMU_INDEX_SHIFT)\n\n\n#if defined SMU__DGPU_ONLY\n#define SMU71_DTE_ITERATIONS 5\n#define SMU71_DTE_SOURCES 3\n#define SMU71_DTE_SINKS 1\n#define SMU71_NUM_CPU_TES 0\n#define SMU71_NUM_GPU_TES 1\n#define SMU71_NUM_NON_TES 2\n\n#endif\n\n#if defined SMU__FUSION_ONLY\n#define SMU7_DTE_ITERATIONS 5\n#define SMU7_DTE_SOURCES 5\n#define SMU7_DTE_SINKS 3\n#define SMU7_NUM_CPU_TES 2\n#define SMU7_NUM_GPU_TES 1\n#define SMU7_NUM_NON_TES 2\n\n#endif\n\nstruct SMU71_PIDController {\n    uint32_t Ki;\n    int32_t LFWindupUpperLim;\n    int32_t LFWindupLowerLim;\n    uint32_t StatePrecision;\n    uint32_t LfPrecision;\n    uint32_t LfOffset;\n    uint32_t MaxState;\n    uint32_t MaxLfFraction;\n    uint32_t StateShift;\n};\n\ntypedef struct SMU71_PIDController SMU71_PIDController;\n\nstruct SMU7_LocalDpmScoreboard {\n    uint32_t PercentageBusy;\n\n    int32_t  PIDError;\n    int32_t  PIDIntegral;\n    int32_t  PIDOutput;\n\n    uint32_t SigmaDeltaAccum;\n    uint32_t SigmaDeltaOutput;\n    uint32_t SigmaDeltaLevel;\n\n    uint32_t UtilizationSetpoint;\n\n    uint8_t  TdpClampMode;\n    uint8_t  TdcClampMode;\n    uint8_t  ThermClampMode;\n    uint8_t  VoltageBusy;\n\n    int8_t   CurrLevel;\n    int8_t   TargLevel;\n    uint8_t  LevelChangeInProgress;\n    uint8_t  UpHyst;\n\n    uint8_t  DownHyst;\n    uint8_t  VoltageDownHyst;\n    uint8_t  DpmEnable;\n    uint8_t  DpmRunning;\n\n    uint8_t  DpmForce;\n    uint8_t  DpmForceLevel;\n    uint8_t  DisplayWatermark;\n    uint8_t  McArbIndex;\n\n    uint32_t MinimumPerfSclk;\n\n    uint8_t  AcpiReq;\n    uint8_t  AcpiAck;\n    uint8_t  GfxClkSlow;\n    uint8_t  GpioClampMode;\n\n    uint8_t  FpsFilterWeight;\n    uint8_t  EnabledLevelsChange;\n    uint8_t  DteClampMode;\n    uint8_t  FpsClampMode;\n\n    uint16_t LevelResidencyCounters[SMU71_MAX_LEVELS_GRAPHICS];\n    uint16_t LevelSwitchCounters[SMU71_MAX_LEVELS_GRAPHICS];\n\n    void     (*TargetStateCalculator)(uint8_t);\n    void     (*SavedTargetStateCalculator)(uint8_t);\n\n    uint16_t AutoDpmInterval;\n    uint16_t AutoDpmRange;\n\n    uint8_t  FpsEnabled;\n    uint8_t  MaxPerfLevel;\n    uint8_t  AllowLowClkInterruptToHost;\n    uint8_t  FpsRunning;\n\n    uint32_t MaxAllowedFrequency;\n};\n\ntypedef struct SMU7_LocalDpmScoreboard SMU7_LocalDpmScoreboard;\n\n#define SMU7_MAX_VOLTAGE_CLIENTS 12\n\nstruct SMU7_VoltageScoreboard {\n    uint16_t CurrentVoltage;\n    uint16_t HighestVoltage;\n    uint16_t MaxVid;\n    uint8_t  HighestVidOffset;\n    uint8_t  CurrentVidOffset;\n#if defined (SMU__DGPU_ONLY)\n    uint8_t  CurrentPhases;\n    uint8_t  HighestPhases;\n#else\n    uint8_t  AvsOffset;\n    uint8_t  AvsOffsetApplied;\n#endif\n    uint8_t  ControllerBusy;\n    uint8_t  CurrentVid;\n    uint16_t RequestedVoltage[SMU7_MAX_VOLTAGE_CLIENTS];\n#if defined (SMU__DGPU_ONLY)\n    uint8_t  RequestedPhases[SMU7_MAX_VOLTAGE_CLIENTS];\n#endif\n    uint8_t  EnabledRequest[SMU7_MAX_VOLTAGE_CLIENTS];\n    uint8_t  TargetIndex;\n    uint8_t  Delay;\n    uint8_t  ControllerEnable;\n    uint8_t  ControllerRunning;\n    uint16_t CurrentStdVoltageHiSidd;\n    uint16_t CurrentStdVoltageLoSidd;\n#if defined (SMU__DGPU_ONLY)\n    uint16_t RequestedVddci;\n    uint16_t CurrentVddci;\n    uint16_t HighestVddci;\n    uint8_t  CurrentVddciVid;\n    uint8_t  TargetVddciIndex;\n#endif\n};\n\ntypedef struct SMU7_VoltageScoreboard SMU7_VoltageScoreboard;\n\n\n#define SMU7_MAX_PCIE_LINK_SPEEDS 3  \n\nstruct SMU7_PCIeLinkSpeedScoreboard\n{\n    uint8_t     DpmEnable;\n    uint8_t     DpmRunning;\n    uint8_t     DpmForce;\n    uint8_t     DpmForceLevel;\n\n    uint8_t     CurrentLinkSpeed;\n    uint8_t     EnabledLevelsChange;\n    uint16_t    AutoDpmInterval;\n\n    uint16_t    AutoDpmRange;\n    uint16_t    AutoDpmCount;\n\n    uint8_t     DpmMode;\n    uint8_t     AcpiReq;\n    uint8_t     AcpiAck;\n    uint8_t     CurrentLinkLevel;\n\n};\n\ntypedef struct SMU7_PCIeLinkSpeedScoreboard SMU7_PCIeLinkSpeedScoreboard;\n\n\n#define SMU7_LKGE_LUT_NUM_OF_TEMP_ENTRIES 16\n#define SMU7_LKGE_LUT_NUM_OF_VOLT_ENTRIES 16\n\n#define SMU7_SCALE_I  7\n#define SMU7_SCALE_R 12\n\nstruct SMU7_PowerScoreboard\n{\n    uint16_t   MinVoltage;\n    uint16_t   MaxVoltage;\n\n    uint32_t   AvgGpuPower;\n\n    uint16_t   VddcLeakagePower[SID_OPTION_COUNT];\n    uint16_t   VddcSclkConstantPower[SID_OPTION_COUNT];\n    uint16_t   VddcSclkDynamicPower[SID_OPTION_COUNT];\n    uint16_t   VddcNonSclkDynamicPower[SID_OPTION_COUNT];\n    uint16_t   VddcTotalPower[SID_OPTION_COUNT];\n    uint16_t   VddcTotalCurrent[SID_OPTION_COUNT];\n    uint16_t   VddcLoadVoltage[SID_OPTION_COUNT];\n    uint16_t   VddcNoLoadVoltage[SID_OPTION_COUNT];\n\n    uint16_t   DisplayPhyPower;\n    uint16_t   PciePhyPower;\n\n    uint16_t   VddciTotalPower;\n    uint16_t   Vddr1TotalPower;\n\n    uint32_t   RocPower;\n\n    uint32_t   last_power;\n    uint32_t   enableWinAvg;\n\n    uint32_t   lkg_acc;\n    uint16_t   VoltLkgeScaler;\n    uint16_t   TempLkgeScaler;\n\n    uint32_t   uvd_cac_dclk;\n    uint32_t   uvd_cac_vclk;\n    uint32_t   vce_cac_eclk;\n    uint32_t   samu_cac_samclk;\n    uint32_t   display_cac_dispclk;\n    uint32_t   acp_cac_aclk;\n    uint32_t   unb_cac;\n\n    uint32_t   WinTime;\n\n    uint16_t  GpuPwr_MAWt;\n    uint16_t  FilteredVddcTotalPower;\n\n    uint8_t   CalculationRepeats;\n    uint8_t   WaterfallUp;\n    uint8_t   WaterfallDown;\n    uint8_t   WaterfallLimit;\n};\n\ntypedef struct SMU7_PowerScoreboard SMU7_PowerScoreboard;\n\n\n\nstruct SMU7_ThermalScoreboard {\n   int16_t  GpuLimit;\n   int16_t  GpuHyst;\n   uint16_t CurrGnbTemp;\n   uint16_t FilteredGnbTemp;\n   uint8_t  ControllerEnable;\n   uint8_t  ControllerRunning;\n   uint8_t  WaterfallUp;\n   uint8_t  WaterfallDown;\n   uint8_t  WaterfallLimit;\n   uint8_t  padding[3];\n};\n\ntypedef struct SMU7_ThermalScoreboard SMU7_ThermalScoreboard;\n\n\n#define SMU7_SCLK_DPM_CONFIG_MASK                        0x01\n#define SMU7_VOLTAGE_CONTROLLER_CONFIG_MASK              0x02\n#define SMU7_THERMAL_CONTROLLER_CONFIG_MASK              0x04\n#define SMU7_MCLK_DPM_CONFIG_MASK                        0x08\n#define SMU7_UVD_DPM_CONFIG_MASK                         0x10\n#define SMU7_VCE_DPM_CONFIG_MASK                         0x20\n#define SMU7_ACP_DPM_CONFIG_MASK                         0x40\n#define SMU7_SAMU_DPM_CONFIG_MASK                        0x80\n#define SMU7_PCIEGEN_DPM_CONFIG_MASK                    0x100\n\n#define SMU7_ACP_MCLK_HANDSHAKE_DISABLE                  0x00000001\n#define SMU7_ACP_SCLK_HANDSHAKE_DISABLE                  0x00000002\n#define SMU7_UVD_MCLK_HANDSHAKE_DISABLE                  0x00000100\n#define SMU7_UVD_SCLK_HANDSHAKE_DISABLE                  0x00000200\n#define SMU7_VCE_MCLK_HANDSHAKE_DISABLE                  0x00010000\n#define SMU7_VCE_SCLK_HANDSHAKE_DISABLE                  0x00020000\n\n\nstruct SMU71_SoftRegisters {\n    uint32_t        RefClockFrequency;\n    uint32_t        PmTimerPeriod;\n    uint32_t        FeatureEnables;\n#if defined (SMU__DGPU_ONLY)\n    uint32_t        PreVBlankGap;\n    uint32_t        VBlankTimeout;\n    uint32_t        TrainTimeGap;\n    uint32_t        MvddSwitchTime;\n    uint32_t        LongestAcpiTrainTime;\n    uint32_t        AcpiDelay;\n    uint32_t        G5TrainTime;\n    uint32_t        DelayMpllPwron;\n    uint32_t        VoltageChangeTimeout;\n#endif\n    uint32_t        HandshakeDisables;\n\n    uint8_t         DisplayPhy1Config;\n    uint8_t         DisplayPhy2Config;\n    uint8_t         DisplayPhy3Config;\n    uint8_t         DisplayPhy4Config;\n\n    uint8_t         DisplayPhy5Config;\n    uint8_t         DisplayPhy6Config;\n    uint8_t         DisplayPhy7Config;\n    uint8_t         DisplayPhy8Config;\n\n    uint32_t        AverageGraphicsActivity;\n    uint32_t        AverageMemoryActivity;\n    uint32_t        AverageGioActivity;\n\n    uint8_t         SClkDpmEnabledLevels;\n    uint8_t         MClkDpmEnabledLevels;\n    uint8_t         LClkDpmEnabledLevels;\n    uint8_t         PCIeDpmEnabledLevels;\n\n    uint32_t        DRAM_LOG_ADDR_H;\n    uint32_t        DRAM_LOG_ADDR_L;\n    uint32_t        DRAM_LOG_PHY_ADDR_H;\n    uint32_t        DRAM_LOG_PHY_ADDR_L;\n    uint32_t        DRAM_LOG_BUFF_SIZE;\n    uint32_t        UlvEnterCount;\n    uint32_t        UlvTime;\n    uint32_t        UcodeLoadStatus;\n    uint8_t         DPMFreezeAndForced;\n    uint8_t         Activity_Weight;\n    uint8_t         Reserved8[2];\n    uint32_t        Reserved;\n};\n\ntypedef struct SMU71_SoftRegisters SMU71_SoftRegisters;\n\nstruct SMU71_Firmware_Header {\n    uint32_t Digest[5];\n    uint32_t Version;\n    uint32_t HeaderSize;\n    uint32_t Flags;\n    uint32_t EntryPoint;\n    uint32_t CodeSize;\n    uint32_t ImageSize;\n\n    uint32_t Rtos;\n    uint32_t SoftRegisters;\n    uint32_t DpmTable;\n    uint32_t FanTable;\n    uint32_t CacConfigTable;\n    uint32_t CacStatusTable;\n\n    uint32_t mcRegisterTable;\n\n    uint32_t mcArbDramTimingTable;\n\n    uint32_t PmFuseTable;\n    uint32_t Globals;\n    uint32_t UvdDpmTable;\n    uint32_t AcpDpmTable;\n    uint32_t VceDpmTable;\n    uint32_t SamuDpmTable;\n    uint32_t UlvSettings;\n    uint32_t Reserved[37];\n    uint32_t Signature;\n};\n\ntypedef struct SMU71_Firmware_Header SMU71_Firmware_Header;\n\nstruct SMU7_HystController_Data\n{\n    uint8_t waterfall_up;\n    uint8_t waterfall_down;\n    uint8_t pstate;\n    uint8_t clamp_mode;\n};\n\ntypedef struct SMU7_HystController_Data SMU7_HystController_Data;\n\n#define SMU71_FIRMWARE_HEADER_LOCATION 0x20000\n\nenum  DisplayConfig {\n    PowerDown = 1,\n    DP54x4,\n    DP54x2,\n    DP54x1,\n    DP27x4,\n    DP27x2,\n    DP27x1,\n    HDMI297,\n    HDMI162,\n    LVDS,\n    DP324x4,\n    DP324x2,\n    DP324x1\n};\n\n\n\n\n\n#if defined SMU__VARIANT__ICELAND\n  #define SX_BLOCK_COUNT 8\n  #define MC_BLOCK_COUNT 1\n  #define CPL_BLOCK_COUNT 29\n#endif\n\nstruct SMU7_Local_Cac {\n  uint8_t BlockId;\n  uint8_t SignalId;\n  uint8_t Threshold;\n  uint8_t Padding;\n};\n\ntypedef struct SMU7_Local_Cac SMU7_Local_Cac;\n\nstruct SMU7_Local_Cac_Table {\n  SMU7_Local_Cac SxLocalCac[SX_BLOCK_COUNT];\n  SMU7_Local_Cac CplLocalCac[CPL_BLOCK_COUNT];\n  SMU7_Local_Cac McLocalCac[MC_BLOCK_COUNT];\n};\n\ntypedef struct SMU7_Local_Cac_Table SMU7_Local_Cac_Table;\n\n#if !defined(SMC_MICROCODE)\n#pragma pack(pop)\n#endif\n\n#endif\n\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}