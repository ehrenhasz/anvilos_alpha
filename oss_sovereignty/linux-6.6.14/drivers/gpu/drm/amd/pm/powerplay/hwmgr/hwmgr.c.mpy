{
  "module_name": "hwmgr.c",
  "hash_id": "a8113ec3ff13c2e3ba6c744c3aa1ac92a2ef32fc7c75a30ba870756ac08dcc20",
  "original_prompt": "Ingested from linux-6.6.14/drivers/gpu/drm/amd/pm/powerplay/hwmgr/hwmgr.c",
  "human_readable_source": " \n\n#include \"pp_debug.h\"\n#include <linux/delay.h>\n#include <linux/kernel.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/pci.h>\n#include <drm/amdgpu_drm.h>\n#include \"power_state.h\"\n#include \"hwmgr.h\"\n#include \"ppsmc.h\"\n#include \"amd_acpi.h\"\n#include \"pp_psm.h\"\n#include \"vega10_hwmgr.h\"\n\nextern const struct pp_smumgr_func ci_smu_funcs;\nextern const struct pp_smumgr_func smu8_smu_funcs;\nextern const struct pp_smumgr_func iceland_smu_funcs;\nextern const struct pp_smumgr_func tonga_smu_funcs;\nextern const struct pp_smumgr_func fiji_smu_funcs;\nextern const struct pp_smumgr_func polaris10_smu_funcs;\nextern const struct pp_smumgr_func vegam_smu_funcs;\nextern const struct pp_smumgr_func vega10_smu_funcs;\nextern const struct pp_smumgr_func vega12_smu_funcs;\nextern const struct pp_smumgr_func smu10_smu_funcs;\nextern const struct pp_smumgr_func vega20_smu_funcs;\n\nextern int smu10_init_function_pointers(struct pp_hwmgr *hwmgr);\n\nstatic int polaris_set_asic_special_caps(struct pp_hwmgr *hwmgr);\nstatic void hwmgr_init_default_caps(struct pp_hwmgr *hwmgr);\nstatic int hwmgr_set_user_specify_caps(struct pp_hwmgr *hwmgr);\nstatic int fiji_set_asic_special_caps(struct pp_hwmgr *hwmgr);\nstatic int tonga_set_asic_special_caps(struct pp_hwmgr *hwmgr);\nstatic int topaz_set_asic_special_caps(struct pp_hwmgr *hwmgr);\nstatic int ci_set_asic_special_caps(struct pp_hwmgr *hwmgr);\n\n\nstatic void hwmgr_init_workload_prority(struct pp_hwmgr *hwmgr)\n{\n\thwmgr->workload_prority[PP_SMC_POWER_PROFILE_BOOTUP_DEFAULT] = 0;\n\thwmgr->workload_prority[PP_SMC_POWER_PROFILE_FULLSCREEN3D] = 1;\n\thwmgr->workload_prority[PP_SMC_POWER_PROFILE_POWERSAVING] = 2;\n\thwmgr->workload_prority[PP_SMC_POWER_PROFILE_VIDEO] = 3;\n\thwmgr->workload_prority[PP_SMC_POWER_PROFILE_VR] = 4;\n\thwmgr->workload_prority[PP_SMC_POWER_PROFILE_COMPUTE] = 5;\n\n\thwmgr->workload_setting[0] = PP_SMC_POWER_PROFILE_BOOTUP_DEFAULT;\n\thwmgr->workload_setting[1] = PP_SMC_POWER_PROFILE_FULLSCREEN3D;\n\thwmgr->workload_setting[2] = PP_SMC_POWER_PROFILE_POWERSAVING;\n\thwmgr->workload_setting[3] = PP_SMC_POWER_PROFILE_VIDEO;\n\thwmgr->workload_setting[4] = PP_SMC_POWER_PROFILE_VR;\n\thwmgr->workload_setting[5] = PP_SMC_POWER_PROFILE_COMPUTE;\n}\n\nint hwmgr_early_init(struct pp_hwmgr *hwmgr)\n{\n\tstruct amdgpu_device *adev;\n\n\tif (!hwmgr)\n\t\treturn -EINVAL;\n\n\thwmgr->usec_timeout = AMD_MAX_USEC_TIMEOUT;\n\thwmgr->pp_table_version = PP_TABLE_V1;\n\thwmgr->dpm_level = AMD_DPM_FORCED_LEVEL_AUTO;\n\thwmgr->request_dpm_level = AMD_DPM_FORCED_LEVEL_AUTO;\n\thwmgr_init_default_caps(hwmgr);\n\thwmgr_set_user_specify_caps(hwmgr);\n\thwmgr->fan_ctrl_is_in_default_mode = true;\n\thwmgr_init_workload_prority(hwmgr);\n\thwmgr->gfxoff_state_changed_by_workload = false;\n\n\tadev = hwmgr->adev;\n\n\tswitch (hwmgr->chip_family) {\n\tcase AMDGPU_FAMILY_CI:\n\t\tadev->pm.pp_feature &= ~PP_GFXOFF_MASK;\n\t\thwmgr->smumgr_funcs = &ci_smu_funcs;\n\t\tci_set_asic_special_caps(hwmgr);\n\t\thwmgr->feature_mask &= ~(PP_VBI_TIME_SUPPORT_MASK |\n\t\t\t\t\t PP_ENABLE_GFX_CG_THRU_SMU |\n\t\t\t\t\t PP_GFXOFF_MASK);\n\t\thwmgr->pp_table_version = PP_TABLE_V0;\n\t\thwmgr->od_enabled = false;\n\t\tsmu7_init_function_pointers(hwmgr);\n\t\tbreak;\n\tcase AMDGPU_FAMILY_CZ:\n\t\tadev->pm.pp_feature &= ~PP_GFXOFF_MASK;\n\t\thwmgr->od_enabled = false;\n\t\thwmgr->smumgr_funcs = &smu8_smu_funcs;\n\t\thwmgr->feature_mask &= ~PP_GFXOFF_MASK;\n\t\tsmu8_init_function_pointers(hwmgr);\n\t\tbreak;\n\tcase AMDGPU_FAMILY_VI:\n\t\tadev->pm.pp_feature &= ~PP_GFXOFF_MASK;\n\t\thwmgr->feature_mask &= ~PP_GFXOFF_MASK;\n\t\tswitch (hwmgr->chip_id) {\n\t\tcase CHIP_TOPAZ:\n\t\t\thwmgr->smumgr_funcs = &iceland_smu_funcs;\n\t\t\ttopaz_set_asic_special_caps(hwmgr);\n\t\t\thwmgr->feature_mask &= ~(PP_VBI_TIME_SUPPORT_MASK |\n\t\t\t\t\t\tPP_ENABLE_GFX_CG_THRU_SMU);\n\t\t\thwmgr->pp_table_version = PP_TABLE_V0;\n\t\t\thwmgr->od_enabled = false;\n\t\t\tbreak;\n\t\tcase CHIP_TONGA:\n\t\t\thwmgr->smumgr_funcs = &tonga_smu_funcs;\n\t\t\ttonga_set_asic_special_caps(hwmgr);\n\t\t\thwmgr->feature_mask &= ~PP_VBI_TIME_SUPPORT_MASK;\n\t\t\tbreak;\n\t\tcase CHIP_FIJI:\n\t\t\thwmgr->smumgr_funcs = &fiji_smu_funcs;\n\t\t\tfiji_set_asic_special_caps(hwmgr);\n\t\t\thwmgr->feature_mask &= ~(PP_VBI_TIME_SUPPORT_MASK |\n\t\t\t\t\t\tPP_ENABLE_GFX_CG_THRU_SMU);\n\t\t\tbreak;\n\t\tcase CHIP_POLARIS11:\n\t\tcase CHIP_POLARIS10:\n\t\tcase CHIP_POLARIS12:\n\t\t\thwmgr->smumgr_funcs = &polaris10_smu_funcs;\n\t\t\tpolaris_set_asic_special_caps(hwmgr);\n\t\t\thwmgr->feature_mask &= ~(PP_UVD_HANDSHAKE_MASK);\n\t\t\tbreak;\n\t\tcase CHIP_VEGAM:\n\t\t\thwmgr->smumgr_funcs = &vegam_smu_funcs;\n\t\t\tpolaris_set_asic_special_caps(hwmgr);\n\t\t\thwmgr->feature_mask &= ~(PP_UVD_HANDSHAKE_MASK);\n\t\t\tbreak;\n\t\tdefault:\n\t\t\treturn -EINVAL;\n\t\t}\n\t\tsmu7_init_function_pointers(hwmgr);\n\t\tbreak;\n\tcase AMDGPU_FAMILY_AI:\n\t\tswitch (hwmgr->chip_id) {\n\t\tcase CHIP_VEGA10:\n\t\t\tadev->pm.pp_feature &= ~PP_GFXOFF_MASK;\n\t\t\thwmgr->feature_mask &= ~PP_GFXOFF_MASK;\n\t\t\thwmgr->smumgr_funcs = &vega10_smu_funcs;\n\t\t\tvega10_hwmgr_init(hwmgr);\n\t\t\tbreak;\n\t\tcase CHIP_VEGA12:\n\t\t\thwmgr->smumgr_funcs = &vega12_smu_funcs;\n\t\t\tvega12_hwmgr_init(hwmgr);\n\t\t\tbreak;\n\t\tcase CHIP_VEGA20:\n\t\t\tadev->pm.pp_feature &= ~PP_GFXOFF_MASK;\n\t\t\thwmgr->feature_mask &= ~PP_GFXOFF_MASK;\n\t\t\thwmgr->smumgr_funcs = &vega20_smu_funcs;\n\t\t\tvega20_hwmgr_init(hwmgr);\n\t\t\tbreak;\n\t\tdefault:\n\t\t\treturn -EINVAL;\n\t\t}\n\t\tbreak;\n\tcase AMDGPU_FAMILY_RV:\n\t\tswitch (hwmgr->chip_id) {\n\t\tcase CHIP_RAVEN:\n\t\t\thwmgr->od_enabled = false;\n\t\t\thwmgr->smumgr_funcs = &smu10_smu_funcs;\n\t\t\tsmu10_init_function_pointers(hwmgr);\n\t\t\tbreak;\n\t\tdefault:\n\t\t\treturn -EINVAL;\n\t\t}\n\t\tbreak;\n\tdefault:\n\t\treturn -EINVAL;\n\t}\n\n\treturn 0;\n}\n\nint hwmgr_sw_init(struct pp_hwmgr *hwmgr)\n{\n\tif (!hwmgr || !hwmgr->smumgr_funcs || !hwmgr->smumgr_funcs->smu_init)\n\t\treturn -EINVAL;\n\n\tphm_register_irq_handlers(hwmgr);\n\tpr_info(\"hwmgr_sw_init smu backed is %s\\n\", hwmgr->smumgr_funcs->name);\n\n\treturn hwmgr->smumgr_funcs->smu_init(hwmgr);\n}\n\n\nint hwmgr_sw_fini(struct pp_hwmgr *hwmgr)\n{\n\tif (hwmgr && hwmgr->smumgr_funcs && hwmgr->smumgr_funcs->smu_fini)\n\t\thwmgr->smumgr_funcs->smu_fini(hwmgr);\n\n\treturn 0;\n}\n\nint hwmgr_hw_init(struct pp_hwmgr *hwmgr)\n{\n\tint ret = 0;\n\n\thwmgr->pp_one_vf = amdgpu_sriov_is_pp_one_vf((struct amdgpu_device *)hwmgr->adev);\n\thwmgr->pm_en = (amdgpu_dpm && (hwmgr->not_vf || hwmgr->pp_one_vf))\n\t\t\t? true : false;\n\tif (!hwmgr->pm_en)\n\t\treturn 0;\n\n\tif (!hwmgr->pptable_func ||\n\t    !hwmgr->pptable_func->pptable_init ||\n\t    !hwmgr->hwmgr_func->backend_init) {\n\t\thwmgr->pm_en = false;\n\t\tpr_info(\"dpm not supported \\n\");\n\t\treturn 0;\n\t}\n\n\tret = hwmgr->pptable_func->pptable_init(hwmgr);\n\tif (ret)\n\t\tgoto err;\n\n\t((struct amdgpu_device *)hwmgr->adev)->pm.no_fan =\n\t\t\t\thwmgr->thermal_controller.fanInfo.bNoFan;\n\n\tret = hwmgr->hwmgr_func->backend_init(hwmgr);\n\tif (ret)\n\t\tgoto err1;\n  \n\tif ((hwmgr->dyn_state.max_clock_voltage_on_dc.sclk == 0) ||\n\t\t\t(hwmgr->dyn_state.max_clock_voltage_on_dc.mclk == 0))\n\t\t\thwmgr->dyn_state.max_clock_voltage_on_dc =\n\t\t\t\t\thwmgr->dyn_state.max_clock_voltage_on_ac;\n\n\tret = psm_init_power_state_table(hwmgr);\n\tif (ret)\n\t\tgoto err2;\n\n\tret = phm_setup_asic(hwmgr);\n\tif (ret)\n\t\tgoto err2;\n\n\tret = phm_enable_dynamic_state_management(hwmgr);\n\tif (ret)\n\t\tgoto err2;\n\tret = phm_start_thermal_controller(hwmgr);\n\tret |= psm_set_performance_states(hwmgr);\n\tif (ret)\n\t\tgoto err2;\n\n\t((struct amdgpu_device *)hwmgr->adev)->pm.dpm_enabled = true;\n\n\treturn 0;\nerr2:\n\tif (hwmgr->hwmgr_func->backend_fini)\n\t\thwmgr->hwmgr_func->backend_fini(hwmgr);\nerr1:\n\tif (hwmgr->pptable_func->pptable_fini)\n\t\thwmgr->pptable_func->pptable_fini(hwmgr);\nerr:\n\treturn ret;\n}\n\nint hwmgr_hw_fini(struct pp_hwmgr *hwmgr)\n{\n\tif (!hwmgr || !hwmgr->pm_en || !hwmgr->not_vf)\n\t\treturn 0;\n\n\tphm_stop_thermal_controller(hwmgr);\n\tpsm_set_boot_states(hwmgr);\n\tpsm_adjust_power_state_dynamic(hwmgr, true, NULL);\n\tphm_disable_dynamic_state_management(hwmgr);\n\tphm_disable_clock_power_gatings(hwmgr);\n\n\tif (hwmgr->hwmgr_func->backend_fini)\n\t\thwmgr->hwmgr_func->backend_fini(hwmgr);\n\tif (hwmgr->pptable_func->pptable_fini)\n\t\thwmgr->pptable_func->pptable_fini(hwmgr);\n\treturn psm_fini_power_state_table(hwmgr);\n}\n\nint hwmgr_suspend(struct pp_hwmgr *hwmgr)\n{\n\tint ret = 0;\n\n\tif (!hwmgr || !hwmgr->pm_en || !hwmgr->not_vf)\n\t\treturn 0;\n\n\tphm_disable_smc_firmware_ctf(hwmgr);\n\tret = psm_set_boot_states(hwmgr);\n\tif (ret)\n\t\treturn ret;\n\tret = psm_adjust_power_state_dynamic(hwmgr, true, NULL);\n\tif (ret)\n\t\treturn ret;\n\tret = phm_power_down_asic(hwmgr);\n\n\treturn ret;\n}\n\nint hwmgr_resume(struct pp_hwmgr *hwmgr)\n{\n\tint ret = 0;\n\n\tif (!hwmgr)\n\t\treturn -EINVAL;\n\n\tif (!hwmgr->not_vf || !hwmgr->pm_en)\n\t\treturn 0;\n\n\tret = phm_setup_asic(hwmgr);\n\tif (ret)\n\t\treturn ret;\n\n\tret = phm_enable_dynamic_state_management(hwmgr);\n\tif (ret)\n\t\treturn ret;\n\tret = phm_start_thermal_controller(hwmgr);\n\tret |= psm_set_performance_states(hwmgr);\n\tif (ret)\n\t\treturn ret;\n\n\tret = psm_adjust_power_state_dynamic(hwmgr, false, NULL);\n\n\treturn ret;\n}\n\nstatic enum PP_StateUILabel power_state_convert(enum amd_pm_state_type  state)\n{\n\tswitch (state) {\n\tcase POWER_STATE_TYPE_BATTERY:\n\t\treturn PP_StateUILabel_Battery;\n\tcase POWER_STATE_TYPE_BALANCED:\n\t\treturn PP_StateUILabel_Balanced;\n\tcase POWER_STATE_TYPE_PERFORMANCE:\n\t\treturn PP_StateUILabel_Performance;\n\tdefault:\n\t\treturn PP_StateUILabel_None;\n\t}\n}\n\nint hwmgr_handle_task(struct pp_hwmgr *hwmgr, enum amd_pp_task task_id,\n\t\tenum amd_pm_state_type *user_state)\n{\n\tint ret = 0;\n\n\tif (hwmgr == NULL)\n\t\treturn -EINVAL;\n\n\tswitch (task_id) {\n\tcase AMD_PP_TASK_DISPLAY_CONFIG_CHANGE:\n\t\tif (!hwmgr->not_vf)\n\t\t\treturn ret;\n\t\tret = phm_pre_display_configuration_changed(hwmgr);\n\t\tif (ret)\n\t\t\treturn ret;\n\t\tret = phm_set_cpu_power_state(hwmgr);\n\t\tif (ret)\n\t\t\treturn ret;\n\t\tret = psm_set_performance_states(hwmgr);\n\t\tif (ret)\n\t\t\treturn ret;\n\t\tret = psm_adjust_power_state_dynamic(hwmgr, false, NULL);\n\t\tbreak;\n\tcase AMD_PP_TASK_ENABLE_USER_STATE:\n\t{\n\t\tenum PP_StateUILabel requested_ui_label;\n\t\tstruct pp_power_state *requested_ps = NULL;\n\n\t\tif (!hwmgr->not_vf)\n\t\t\treturn ret;\n\t\tif (user_state == NULL) {\n\t\t\tret = -EINVAL;\n\t\t\tbreak;\n\t\t}\n\n\t\trequested_ui_label = power_state_convert(*user_state);\n\t\tret = psm_set_user_performance_state(hwmgr, requested_ui_label, &requested_ps);\n\t\tif (ret)\n\t\t\treturn ret;\n\t\tret = psm_adjust_power_state_dynamic(hwmgr, true, requested_ps);\n\t\tbreak;\n\t}\n\tcase AMD_PP_TASK_COMPLETE_INIT:\n\tcase AMD_PP_TASK_READJUST_POWER_STATE:\n\t\tret = psm_adjust_power_state_dynamic(hwmgr, true, NULL);\n\t\tbreak;\n\tdefault:\n\t\tbreak;\n\t}\n\treturn ret;\n}\n\nvoid hwmgr_init_default_caps(struct pp_hwmgr *hwmgr)\n{\n\tphm_cap_unset(hwmgr->platform_descriptor.platformCaps, PHM_PlatformCaps_PCIEPerformanceRequest);\n\n\tphm_cap_set(hwmgr->platform_descriptor.platformCaps, PHM_PlatformCaps_UVDDPM);\n\tphm_cap_set(hwmgr->platform_descriptor.platformCaps, PHM_PlatformCaps_VCEDPM);\n\n#if defined(CONFIG_ACPI)\n\tif (amdgpu_acpi_is_pcie_performance_request_supported(hwmgr->adev))\n\t\tphm_cap_set(hwmgr->platform_descriptor.platformCaps, PHM_PlatformCaps_PCIEPerformanceRequest);\n#endif\n\n\tphm_cap_set(hwmgr->platform_descriptor.platformCaps,\n\t\tPHM_PlatformCaps_DynamicPatchPowerState);\n\n\tphm_cap_set(hwmgr->platform_descriptor.platformCaps,\n\t\tPHM_PlatformCaps_EnableSMU7ThermalManagement);\n\n\tphm_cap_set(hwmgr->platform_descriptor.platformCaps,\n\t\t\tPHM_PlatformCaps_DynamicPowerManagement);\n\n\tphm_cap_set(hwmgr->platform_descriptor.platformCaps,\n\t\t\t\t\tPHM_PlatformCaps_SMC);\n\n\tphm_cap_set(hwmgr->platform_descriptor.platformCaps,\n\t\t\t\t\tPHM_PlatformCaps_DynamicUVDState);\n\n\tphm_cap_set(hwmgr->platform_descriptor.platformCaps,\n\t\t\t\t\t\tPHM_PlatformCaps_FanSpeedInTableIsRPM);\n\treturn;\n}\n\nint hwmgr_set_user_specify_caps(struct pp_hwmgr *hwmgr)\n{\n\tif (hwmgr->feature_mask & PP_SCLK_DEEP_SLEEP_MASK)\n\t\tphm_cap_set(hwmgr->platform_descriptor.platformCaps,\n\t\t\tPHM_PlatformCaps_SclkDeepSleep);\n\telse\n\t\tphm_cap_unset(hwmgr->platform_descriptor.platformCaps,\n\t\t\tPHM_PlatformCaps_SclkDeepSleep);\n\n\tif (hwmgr->feature_mask & PP_POWER_CONTAINMENT_MASK) {\n\t\tphm_cap_set(hwmgr->platform_descriptor.platformCaps,\n\t\t\t    PHM_PlatformCaps_PowerContainment);\n\t\tphm_cap_set(hwmgr->platform_descriptor.platformCaps,\n\t\t\tPHM_PlatformCaps_CAC);\n\t} else {\n\t\tphm_cap_unset(hwmgr->platform_descriptor.platformCaps,\n\t\t\t    PHM_PlatformCaps_PowerContainment);\n\t\tphm_cap_unset(hwmgr->platform_descriptor.platformCaps,\n\t\t\tPHM_PlatformCaps_CAC);\n\t}\n\n\tif (hwmgr->feature_mask & PP_OVERDRIVE_MASK)\n\t\thwmgr->od_enabled = true;\n\n\treturn 0;\n}\n\nint polaris_set_asic_special_caps(struct pp_hwmgr *hwmgr)\n{\n\tphm_cap_set(hwmgr->platform_descriptor.platformCaps,\n\t\t\t\t\t\tPHM_PlatformCaps_EVV);\n\tphm_cap_set(hwmgr->platform_descriptor.platformCaps,\n\t\t\t\t\t\tPHM_PlatformCaps_SQRamping);\n\tphm_cap_set(hwmgr->platform_descriptor.platformCaps,\n\t\t\t\t\t\tPHM_PlatformCaps_RegulatorHot);\n\n\tphm_cap_set(hwmgr->platform_descriptor.platformCaps,\n\t\t\tPHM_PlatformCaps_MemorySpreadSpectrumSupport);\n\tphm_cap_set(hwmgr->platform_descriptor.platformCaps,\n\t\t\tPHM_PlatformCaps_EngineSpreadSpectrumSupport);\n\n\tphm_cap_set(hwmgr->platform_descriptor.platformCaps,\n\t\t\t\t\tPHM_PlatformCaps_AutomaticDCTransition);\n\n\tif (((hwmgr->chip_id == CHIP_POLARIS11) && !hwmgr->is_kicker) ||\n\t    (hwmgr->chip_id == CHIP_POLARIS12))\n\t\tphm_cap_set(hwmgr->platform_descriptor.platformCaps,\n\t\t\t\tPHM_PlatformCaps_SPLLShutdownSupport);\n\n\tif (hwmgr->chip_id != CHIP_POLARIS11) {\n\t\tphm_cap_set(hwmgr->platform_descriptor.platformCaps,\n\t\t\t\t\t\t\tPHM_PlatformCaps_DBRamping);\n\t\tphm_cap_set(hwmgr->platform_descriptor.platformCaps,\n\t\t\t\t\t\t\tPHM_PlatformCaps_TDRamping);\n\t\tphm_cap_set(hwmgr->platform_descriptor.platformCaps,\n\t\t\t\t\t\t\tPHM_PlatformCaps_TCPRamping);\n\t}\n\treturn 0;\n}\n\nint fiji_set_asic_special_caps(struct pp_hwmgr *hwmgr)\n{\n\tphm_cap_set(hwmgr->platform_descriptor.platformCaps,\n\t\t\t\t\t\tPHM_PlatformCaps_EVV);\n\tphm_cap_unset(hwmgr->platform_descriptor.platformCaps,\n\t\t\tPHM_PlatformCaps_SQRamping);\n\tphm_cap_unset(hwmgr->platform_descriptor.platformCaps,\n\t\t\tPHM_PlatformCaps_DBRamping);\n\tphm_cap_unset(hwmgr->platform_descriptor.platformCaps,\n\t\t\tPHM_PlatformCaps_TDRamping);\n\tphm_cap_unset(hwmgr->platform_descriptor.platformCaps,\n\t\t\tPHM_PlatformCaps_TCPRamping);\n\treturn 0;\n}\n\nint tonga_set_asic_special_caps(struct pp_hwmgr *hwmgr)\n{\n\tphm_cap_set(hwmgr->platform_descriptor.platformCaps,\n\t\t\t\t\t\tPHM_PlatformCaps_EVV);\n\tphm_cap_unset(hwmgr->platform_descriptor.platformCaps,\n\t\t\tPHM_PlatformCaps_SQRamping);\n\tphm_cap_unset(hwmgr->platform_descriptor.platformCaps,\n\t\t\tPHM_PlatformCaps_DBRamping);\n\tphm_cap_unset(hwmgr->platform_descriptor.platformCaps,\n\t\t\tPHM_PlatformCaps_TDRamping);\n\tphm_cap_unset(hwmgr->platform_descriptor.platformCaps,\n\t\t\tPHM_PlatformCaps_TCPRamping);\n\n\tphm_cap_unset(hwmgr->platform_descriptor.platformCaps,\n\t\t      PHM_PlatformCaps_UVDPowerGating);\n\tphm_cap_unset(hwmgr->platform_descriptor.platformCaps,\n\t\t      PHM_PlatformCaps_VCEPowerGating);\n\treturn 0;\n}\n\nint topaz_set_asic_special_caps(struct pp_hwmgr *hwmgr)\n{\n\tphm_cap_set(hwmgr->platform_descriptor.platformCaps,\n\t\t\t\t\t\tPHM_PlatformCaps_EVV);\n\tphm_cap_unset(hwmgr->platform_descriptor.platformCaps,\n\t\t\tPHM_PlatformCaps_SQRamping);\n\tphm_cap_unset(hwmgr->platform_descriptor.platformCaps,\n\t\t\tPHM_PlatformCaps_DBRamping);\n\tphm_cap_unset(hwmgr->platform_descriptor.platformCaps,\n\t\t\tPHM_PlatformCaps_TDRamping);\n\tphm_cap_unset(hwmgr->platform_descriptor.platformCaps,\n\t\t\tPHM_PlatformCaps_TCPRamping);\n\treturn 0;\n}\n\nint ci_set_asic_special_caps(struct pp_hwmgr *hwmgr)\n{\n\tphm_cap_unset(hwmgr->platform_descriptor.platformCaps,\n\t\t\tPHM_PlatformCaps_SQRamping);\n\tphm_cap_unset(hwmgr->platform_descriptor.platformCaps,\n\t\t\tPHM_PlatformCaps_DBRamping);\n\tphm_cap_unset(hwmgr->platform_descriptor.platformCaps,\n\t\t\tPHM_PlatformCaps_TDRamping);\n\tphm_cap_unset(hwmgr->platform_descriptor.platformCaps,\n\t\t\tPHM_PlatformCaps_TCPRamping);\n\tphm_cap_set(hwmgr->platform_descriptor.platformCaps,\n\t\t\tPHM_PlatformCaps_MemorySpreadSpectrumSupport);\n\tphm_cap_set(hwmgr->platform_descriptor.platformCaps,\n\t\t\tPHM_PlatformCaps_EngineSpreadSpectrumSupport);\n\treturn 0;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}