{
  "module_name": "drm_legacy.h",
  "hash_id": "1062a22392041acf9f79918583d35766d892ca23669dcc11c451c41b762c2766",
  "original_prompt": "Ingested from linux-6.6.14/drivers/gpu/drm/drm_legacy.h",
  "human_readable_source": "#ifndef __DRM_LEGACY_H__\n#define __DRM_LEGACY_H__\n\n \n\n \n#include <linux/list.h>\n\n#include <drm/drm.h>\n#include <drm/drm_device.h>\n#include <drm/drm_legacy.h>\n\nstruct agp_memory;\nstruct drm_buf_desc;\nstruct drm_device;\nstruct drm_file;\nstruct drm_hash_item;\nstruct drm_open_hash;\n\n \n\n#define drm_hash_entry(_ptr, _type, _member) container_of(_ptr, _type, _member)\n\n \n#if IS_ENABLED(CONFIG_DRM_LEGACY)\nint drm_ht_create(struct drm_open_hash *ht, unsigned int order);\nint drm_ht_insert_item(struct drm_open_hash *ht, struct drm_hash_item *item);\nint drm_ht_just_insert_please(struct drm_open_hash *ht, struct drm_hash_item *item,\n\t\t\t      unsigned long seed, int bits, int shift,\n\t\t\t      unsigned long add);\nint drm_ht_find_item(struct drm_open_hash *ht, unsigned long key, struct drm_hash_item **item);\n\nvoid drm_ht_verbose_list(struct drm_open_hash *ht, unsigned long key);\nint drm_ht_remove_key(struct drm_open_hash *ht, unsigned long key);\nint drm_ht_remove_item(struct drm_open_hash *ht, struct drm_hash_item *item);\nvoid drm_ht_remove(struct drm_open_hash *ht);\n#endif\n\n \n#define drm_ht_insert_item_rcu drm_ht_insert_item\n#define drm_ht_just_insert_please_rcu drm_ht_just_insert_please\n#define drm_ht_remove_key_rcu drm_ht_remove_key\n#define drm_ht_remove_item_rcu drm_ht_remove_item\n#define drm_ht_find_item_rcu drm_ht_find_item\n\n \n\n#define DRM_KERNEL_CONTEXT\t\t0\n#define DRM_RESERVED_CONTEXTS\t\t1\n\n#if IS_ENABLED(CONFIG_DRM_LEGACY)\nvoid drm_legacy_ctxbitmap_init(struct drm_device *dev);\nvoid drm_legacy_ctxbitmap_cleanup(struct drm_device *dev);\nvoid drm_legacy_ctxbitmap_flush(struct drm_device *dev, struct drm_file *file);\n#else\nstatic inline void drm_legacy_ctxbitmap_init(struct drm_device *dev) {}\nstatic inline void drm_legacy_ctxbitmap_cleanup(struct drm_device *dev) {}\nstatic inline void drm_legacy_ctxbitmap_flush(struct drm_device *dev, struct drm_file *file) {}\n#endif\n\nvoid drm_legacy_ctxbitmap_free(struct drm_device *dev, int ctx_handle);\n\n#if IS_ENABLED(CONFIG_DRM_LEGACY)\nint drm_legacy_resctx(struct drm_device *d, void *v, struct drm_file *f);\nint drm_legacy_addctx(struct drm_device *d, void *v, struct drm_file *f);\nint drm_legacy_getctx(struct drm_device *d, void *v, struct drm_file *f);\nint drm_legacy_switchctx(struct drm_device *d, void *v, struct drm_file *f);\nint drm_legacy_newctx(struct drm_device *d, void *v, struct drm_file *f);\nint drm_legacy_rmctx(struct drm_device *d, void *v, struct drm_file *f);\n\nint drm_legacy_setsareactx(struct drm_device *d, void *v, struct drm_file *f);\nint drm_legacy_getsareactx(struct drm_device *d, void *v, struct drm_file *f);\n#endif\n\n \n\n#define DRM_MAP_HASH_OFFSET 0x10000000\n\n#if IS_ENABLED(CONFIG_DRM_LEGACY)\nstatic inline int drm_legacy_create_map_hash(struct drm_device *dev)\n{\n\treturn drm_ht_create(&dev->map_hash, 12);\n}\n\nstatic inline void drm_legacy_remove_map_hash(struct drm_device *dev)\n{\n\tdrm_ht_remove(&dev->map_hash);\n}\n#else\nstatic inline int drm_legacy_create_map_hash(struct drm_device *dev)\n{\n\treturn 0;\n}\n\nstatic inline void drm_legacy_remove_map_hash(struct drm_device *dev) {}\n#endif\n\n\n#if IS_ENABLED(CONFIG_DRM_LEGACY)\nint drm_legacy_getmap_ioctl(struct drm_device *dev, void *data,\n\t\t\t    struct drm_file *file_priv);\nint drm_legacy_addmap_ioctl(struct drm_device *d, void *v, struct drm_file *f);\nint drm_legacy_rmmap_ioctl(struct drm_device *d, void *v, struct drm_file *f);\n\nint drm_legacy_addbufs(struct drm_device *d, void *v, struct drm_file *f);\nint drm_legacy_infobufs(struct drm_device *d, void *v, struct drm_file *f);\nint drm_legacy_markbufs(struct drm_device *d, void *v, struct drm_file *f);\nint drm_legacy_freebufs(struct drm_device *d, void *v, struct drm_file *f);\nint drm_legacy_mapbufs(struct drm_device *d, void *v, struct drm_file *f);\nint drm_legacy_dma_ioctl(struct drm_device *d, void *v, struct drm_file *f);\n#endif\n\nint __drm_legacy_infobufs(struct drm_device *, void *, int *,\n\t\t\t  int (*)(void *, int, struct drm_buf_entry *));\nint __drm_legacy_mapbufs(struct drm_device *, void *, int *,\n\t\t\t  void __user **,\n\t\t\t  int (*)(void *, int, unsigned long, struct drm_buf *),\n\t\t\t  struct drm_file *);\n\n#if IS_ENABLED(CONFIG_DRM_LEGACY)\nvoid drm_legacy_master_rmmaps(struct drm_device *dev,\n\t\t\t      struct drm_master *master);\nvoid drm_legacy_rmmaps(struct drm_device *dev);\n#else\nstatic inline void drm_legacy_master_rmmaps(struct drm_device *dev,\n\t\t\t\t\t    struct drm_master *master) {}\nstatic inline void drm_legacy_rmmaps(struct drm_device *dev) {}\n#endif\n\n#if IS_ENABLED(CONFIG_DRM_LEGACY)\nvoid drm_legacy_vma_flush(struct drm_device *d);\n#else\nstatic inline void drm_legacy_vma_flush(struct drm_device *d)\n{\n\t \n}\n#endif\n\n \n\nstruct drm_agp_mem {\n\tunsigned long handle;\n\tstruct agp_memory *memory;\n\tunsigned long bound;\n\tint pages;\n\tstruct list_head head;\n};\n\n \n#if IS_ENABLED(CONFIG_DRM_LEGACY) && IS_ENABLED(CONFIG_AGP)\nvoid drm_legacy_agp_clear(struct drm_device *dev);\n\nint drm_legacy_agp_acquire_ioctl(struct drm_device *dev, void *data,\n\t\t\t\t struct drm_file *file_priv);\nint drm_legacy_agp_release_ioctl(struct drm_device *dev, void *data,\n\t\t\t\t struct drm_file *file_priv);\nint drm_legacy_agp_enable_ioctl(struct drm_device *dev, void *data,\n\t\t\t\tstruct drm_file *file_priv);\nint drm_legacy_agp_info_ioctl(struct drm_device *dev, void *data,\n\t\t\t      struct drm_file *file_priv);\nint drm_legacy_agp_alloc_ioctl(struct drm_device *dev, void *data,\n\t\t\t       struct drm_file *file_priv);\nint drm_legacy_agp_free_ioctl(struct drm_device *dev, void *data,\n\t\t\t      struct drm_file *file_priv);\nint drm_legacy_agp_unbind_ioctl(struct drm_device *dev, void *data,\n\t\t\t\tstruct drm_file *file_priv);\nint drm_legacy_agp_bind_ioctl(struct drm_device *dev, void *data,\n\t\t\t      struct drm_file *file_priv);\n#else\nstatic inline void drm_legacy_agp_clear(struct drm_device *dev) {}\n#endif\n\n \n#if IS_ENABLED(CONFIG_DRM_LEGACY)\nint drm_legacy_lock(struct drm_device *d, void *v, struct drm_file *f);\nint drm_legacy_unlock(struct drm_device *d, void *v, struct drm_file *f);\nvoid drm_legacy_lock_release(struct drm_device *dev, struct file *filp);\n#else\nstatic inline void drm_legacy_lock_release(struct drm_device *dev, struct file *filp) {}\n#endif\n\n \n#if IS_ENABLED(CONFIG_DRM_LEGACY)\nint drm_legacy_dma_setup(struct drm_device *dev);\nvoid drm_legacy_dma_takedown(struct drm_device *dev);\n#else\nstatic inline int drm_legacy_dma_setup(struct drm_device *dev)\n{\n\treturn 0;\n}\n#endif\n\nvoid drm_legacy_free_buffer(struct drm_device *dev,\n\t\t\t    struct drm_buf * buf);\n#if IS_ENABLED(CONFIG_DRM_LEGACY)\nvoid drm_legacy_reclaim_buffers(struct drm_device *dev,\n\t\t\t\tstruct drm_file *filp);\n#else\nstatic inline void drm_legacy_reclaim_buffers(struct drm_device *dev,\n\t\t\t\t\t      struct drm_file *filp) {}\n#endif\n\n \n#if IS_ENABLED(CONFIG_DRM_LEGACY)\nvoid drm_legacy_sg_cleanup(struct drm_device *dev);\nint drm_legacy_sg_alloc(struct drm_device *dev, void *data,\n\t\t\tstruct drm_file *file_priv);\nint drm_legacy_sg_free(struct drm_device *dev, void *data,\n\t\t       struct drm_file *file_priv);\n#endif\n\n#if IS_ENABLED(CONFIG_DRM_LEGACY)\nvoid drm_legacy_init_members(struct drm_device *dev);\nvoid drm_legacy_destroy_members(struct drm_device *dev);\nvoid drm_legacy_dev_reinit(struct drm_device *dev);\nint drm_legacy_setup(struct drm_device * dev);\n#else\nstatic inline void drm_legacy_init_members(struct drm_device *dev) {}\nstatic inline void drm_legacy_destroy_members(struct drm_device *dev) {}\nstatic inline void drm_legacy_dev_reinit(struct drm_device *dev) {}\nstatic inline int drm_legacy_setup(struct drm_device * dev) { return 0; }\n#endif\n\n#if IS_ENABLED(CONFIG_DRM_LEGACY)\nvoid drm_legacy_lock_master_cleanup(struct drm_device *dev, struct drm_master *master);\n#else\nstatic inline void drm_legacy_lock_master_cleanup(struct drm_device *dev, struct drm_master *master) {}\n#endif\n\n#if IS_ENABLED(CONFIG_DRM_LEGACY)\nvoid drm_master_legacy_init(struct drm_master *master);\n#else\nstatic inline void drm_master_legacy_init(struct drm_master *master) {}\n#endif\n\n \n#if IS_ENABLED(CONFIG_DRM_LEGACY) && IS_ENABLED(CONFIG_PCI)\nint drm_legacy_irq_by_busid(struct drm_device *dev, void *data, struct drm_file *file_priv);\nvoid drm_legacy_pci_agp_destroy(struct drm_device *dev);\n#else\nstatic inline int drm_legacy_irq_by_busid(struct drm_device *dev, void *data,\n\t\t\t\t\t  struct drm_file *file_priv)\n{\n\treturn -EINVAL;\n}\n\nstatic inline void drm_legacy_pci_agp_destroy(struct drm_device *dev) {}\n#endif\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}