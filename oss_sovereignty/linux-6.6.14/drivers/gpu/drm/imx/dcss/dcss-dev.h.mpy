{
  "module_name": "dcss-dev.h",
  "hash_id": "b86d94aebc36628065d26bb99e6d2891f1d2f28adf23c627e171e0d3f0b2ad62",
  "original_prompt": "Ingested from linux-6.6.14/drivers/gpu/drm/imx/dcss/dcss-dev.h",
  "human_readable_source": " \n \n\n#ifndef __DCSS_PRV_H__\n#define __DCSS_PRV_H__\n\n#include <drm/drm_fourcc.h>\n#include <drm/drm_plane.h>\n#include <linux/io.h>\n#include <linux/pm.h>\n#include <video/videomode.h>\n\n#define SET\t\t\t0x04\n#define CLR\t\t\t0x08\n#define TGL\t\t\t0x0C\n\n#define dcss_writel(v, c)\twritel((v), (c))\n#define dcss_readl(c)\t\treadl(c)\n#define dcss_set(v, c)\t\twritel((v), (c) + SET)\n#define dcss_clr(v, c)\t\twritel((v), (c) + CLR)\n#define dcss_toggle(v, c)\twritel((v), (c) + TGL)\n\nstatic inline void dcss_update(u32 v, u32 m, void __iomem *c)\n{\n\twritel((readl(c) & ~(m)) | (v), (c));\n}\n\n#define DCSS_DBG_REG(reg)\t{.name = #reg, .ofs = reg}\n\nenum {\n\tDCSS_IMX8MQ = 0,\n};\n\nstruct dcss_type_data {\n\tconst char *name;\n\tu32 blkctl_ofs;\n\tu32 ctxld_ofs;\n\tu32 rdsrc_ofs;\n\tu32 wrscl_ofs;\n\tu32 dtg_ofs;\n\tu32 scaler_ofs;\n\tu32 ss_ofs;\n\tu32 dpr_ofs;\n\tu32 dtrc_ofs;\n\tu32 dec400d_ofs;\n\tu32 hdr10_ofs;\n};\n\nstruct dcss_debug_reg {\n\tchar *name;\n\tu32 ofs;\n};\n\nenum dcss_ctxld_ctx_type {\n\tCTX_DB,\n\tCTX_SB_HP,  \n\tCTX_SB_LP,  \n};\n\nstruct dcss_dev {\n\tstruct device *dev;\n\tconst struct dcss_type_data *devtype;\n\tstruct device_node *of_port;\n\n\tu32 start_addr;\n\n\tstruct dcss_blkctl *blkctl;\n\tstruct dcss_ctxld *ctxld;\n\tstruct dcss_dpr *dpr;\n\tstruct dcss_dtg *dtg;\n\tstruct dcss_ss *ss;\n\tstruct dcss_hdr10 *hdr10;\n\tstruct dcss_scaler *scaler;\n\tstruct dcss_dtrc *dtrc;\n\tstruct dcss_dec400d *dec400d;\n\tstruct dcss_wrscl *wrscl;\n\tstruct dcss_rdsrc *rdsrc;\n\n\tstruct clk *apb_clk;\n\tstruct clk *axi_clk;\n\tstruct clk *pix_clk;\n\tstruct clk *rtrm_clk;\n\tstruct clk *dtrc_clk;\n\tstruct clk *pll_src_clk;\n\tstruct clk *pll_phy_ref_clk;\n\n\tbool hdmi_output;\n\n\tvoid (*disable_callback)(void *data);\n\tstruct completion disable_completion;\n};\n\nstruct dcss_dev *dcss_drv_dev_to_dcss(struct device *dev);\nstruct drm_device *dcss_drv_dev_to_drm(struct device *dev);\nstruct dcss_dev *dcss_dev_create(struct device *dev, bool hdmi_output);\nvoid dcss_dev_destroy(struct dcss_dev *dcss);\nvoid dcss_enable_dtg_and_ss(struct dcss_dev *dcss);\nvoid dcss_disable_dtg_and_ss(struct dcss_dev *dcss);\n\nextern const struct dev_pm_ops dcss_dev_pm_ops;\n\n \nint dcss_blkctl_init(struct dcss_dev *dcss, unsigned long blkctl_base);\nvoid dcss_blkctl_cfg(struct dcss_blkctl *blkctl);\nvoid dcss_blkctl_exit(struct dcss_blkctl *blkctl);\n\n \nint dcss_ctxld_init(struct dcss_dev *dcss, unsigned long ctxld_base);\nvoid dcss_ctxld_exit(struct dcss_ctxld *ctxld);\nvoid dcss_ctxld_write(struct dcss_ctxld *ctxld, u32 ctx_id,\n\t\t      u32 val, u32 reg_idx);\nint dcss_ctxld_resume(struct dcss_ctxld *dcss_ctxld);\nint dcss_ctxld_suspend(struct dcss_ctxld *dcss_ctxld);\nvoid dcss_ctxld_write_irqsafe(struct dcss_ctxld *ctlxd, u32 ctx_id, u32 val,\n\t\t\t      u32 reg_ofs);\nvoid dcss_ctxld_kick(struct dcss_ctxld *ctxld);\nbool dcss_ctxld_is_flushed(struct dcss_ctxld *ctxld);\nint dcss_ctxld_enable(struct dcss_ctxld *ctxld);\nvoid dcss_ctxld_register_completion(struct dcss_ctxld *ctxld,\n\t\t\t\t    struct completion *dis_completion);\nvoid dcss_ctxld_assert_locked(struct dcss_ctxld *ctxld);\n\n \nint dcss_dpr_init(struct dcss_dev *dcss, unsigned long dpr_base);\nvoid dcss_dpr_exit(struct dcss_dpr *dpr);\nvoid dcss_dpr_write_sysctrl(struct dcss_dpr *dpr);\nvoid dcss_dpr_set_res(struct dcss_dpr *dpr, int ch_num, u32 xres, u32 yres);\nvoid dcss_dpr_addr_set(struct dcss_dpr *dpr, int ch_num, u32 luma_base_addr,\n\t\t       u32 chroma_base_addr, u16 pitch);\nvoid dcss_dpr_enable(struct dcss_dpr *dpr, int ch_num, bool en);\nvoid dcss_dpr_format_set(struct dcss_dpr *dpr, int ch_num,\n\t\t\t const struct drm_format_info *format, u64 modifier);\nvoid dcss_dpr_set_rotation(struct dcss_dpr *dpr, int ch_num, u32 rotation);\n\n \nint dcss_dtg_init(struct dcss_dev *dcss, unsigned long dtg_base);\nvoid dcss_dtg_exit(struct dcss_dtg *dtg);\nbool dcss_dtg_vblank_irq_valid(struct dcss_dtg *dtg);\nvoid dcss_dtg_vblank_irq_enable(struct dcss_dtg *dtg, bool en);\nvoid dcss_dtg_vblank_irq_clear(struct dcss_dtg *dtg);\nvoid dcss_dtg_sync_set(struct dcss_dtg *dtg, struct videomode *vm);\nvoid dcss_dtg_css_set(struct dcss_dtg *dtg);\nvoid dcss_dtg_enable(struct dcss_dtg *dtg);\nvoid dcss_dtg_shutoff(struct dcss_dtg *dtg);\nbool dcss_dtg_is_enabled(struct dcss_dtg *dtg);\nvoid dcss_dtg_ctxld_kick_irq_enable(struct dcss_dtg *dtg, bool en);\nbool dcss_dtg_global_alpha_changed(struct dcss_dtg *dtg, int ch_num, int alpha);\nvoid dcss_dtg_plane_alpha_set(struct dcss_dtg *dtg, int ch_num,\n\t\t\t      const struct drm_format_info *format, int alpha);\nvoid dcss_dtg_plane_pos_set(struct dcss_dtg *dtg, int ch_num,\n\t\t\t    int px, int py, int pw, int ph);\nvoid dcss_dtg_ch_enable(struct dcss_dtg *dtg, int ch_num, bool en);\n\n \nint dcss_ss_init(struct dcss_dev *dcss, unsigned long subsam_base);\nvoid dcss_ss_exit(struct dcss_ss *ss);\nvoid dcss_ss_enable(struct dcss_ss *ss);\nvoid dcss_ss_shutoff(struct dcss_ss *ss);\nvoid dcss_ss_subsam_set(struct dcss_ss *ss);\nvoid dcss_ss_sync_set(struct dcss_ss *ss, struct videomode *vm,\n\t\t      bool phsync, bool pvsync);\n\n \nint dcss_scaler_init(struct dcss_dev *dcss, unsigned long scaler_base);\nvoid dcss_scaler_exit(struct dcss_scaler *scl);\nvoid dcss_scaler_set_filter(struct dcss_scaler *scl, int ch_num,\n\t\t\t    enum drm_scaling_filter scaling_filter);\nvoid dcss_scaler_setup(struct dcss_scaler *scl, int ch_num,\n\t\t       const struct drm_format_info *format,\n\t\t       int src_xres, int src_yres, int dst_xres, int dst_yres,\n\t\t       u32 vrefresh_hz);\nvoid dcss_scaler_ch_enable(struct dcss_scaler *scl, int ch_num, bool en);\nint dcss_scaler_get_min_max_ratios(struct dcss_scaler *scl, int ch_num,\n\t\t\t\t   int *min, int *max);\nvoid dcss_scaler_write_sclctrl(struct dcss_scaler *scl);\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}