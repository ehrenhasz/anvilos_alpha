{
  "module_name": "etnaviv_drv.h",
  "hash_id": "a94f1ee7eef0d55f2c6fb99fb2a260387fb13a21184b10061b4f0f3f0476913e",
  "original_prompt": "Ingested from linux-6.6.14/drivers/gpu/drm/etnaviv/etnaviv_drv.h",
  "human_readable_source": " \n \n\n#ifndef __ETNAVIV_DRV_H__\n#define __ETNAVIV_DRV_H__\n\n#include <linux/io.h>\n#include <linux/list.h>\n#include <linux/mm_types.h>\n#include <linux/sizes.h>\n#include <linux/time64.h>\n#include <linux/types.h>\n#include <linux/xarray.h>\n\n#include <drm/drm_drv.h>\n#include <drm/drm_gem.h>\n#include <drm/etnaviv_drm.h>\n#include <drm/gpu_scheduler.h>\n\nstruct etnaviv_cmdbuf;\nstruct etnaviv_gpu;\nstruct etnaviv_mmu;\nstruct etnaviv_gem_object;\nstruct etnaviv_gem_submit;\nstruct etnaviv_iommu_global;\n\n#define ETNAVIV_SOFTPIN_START_ADDRESS\tSZ_4M  \n\nstruct etnaviv_file_private {\n\tint id;\n\tstruct etnaviv_iommu_context\t*mmu;\n\tstruct drm_sched_entity\t\tsched_entity[ETNA_MAX_PIPES];\n};\n\nstruct etnaviv_drm_private {\n\tint num_gpus;\n\tstruct etnaviv_gpu *gpu[ETNA_MAX_PIPES];\n\tgfp_t shm_gfp_mask;\n\n\tstruct etnaviv_cmdbuf_suballoc *cmdbuf_suballoc;\n\tstruct etnaviv_iommu_global *mmu_global;\n\n\tstruct xarray active_contexts;\n\tu32 next_context_id;\n\n\t \n\tstruct mutex gem_lock;\n\tstruct list_head gem_list;\n};\n\nint etnaviv_ioctl_gem_submit(struct drm_device *dev, void *data,\n\t\tstruct drm_file *file);\n\nint etnaviv_gem_mmap_offset(struct drm_gem_object *obj, u64 *offset);\nstruct sg_table *etnaviv_gem_prime_get_sg_table(struct drm_gem_object *obj);\nint etnaviv_gem_prime_vmap(struct drm_gem_object *obj, struct iosys_map *map);\nstruct drm_gem_object *etnaviv_gem_prime_import_sg_table(struct drm_device *dev,\n\tstruct dma_buf_attachment *attach, struct sg_table *sg);\nint etnaviv_gem_prime_pin(struct drm_gem_object *obj);\nvoid etnaviv_gem_prime_unpin(struct drm_gem_object *obj);\nvoid *etnaviv_gem_vmap(struct drm_gem_object *obj);\nint etnaviv_gem_cpu_prep(struct drm_gem_object *obj, u32 op,\n\t\tstruct drm_etnaviv_timespec *timeout);\nint etnaviv_gem_cpu_fini(struct drm_gem_object *obj);\nvoid etnaviv_gem_free_object(struct drm_gem_object *obj);\nint etnaviv_gem_new_handle(struct drm_device *dev, struct drm_file *file,\n\t\tu32 size, u32 flags, u32 *handle);\nint etnaviv_gem_new_userptr(struct drm_device *dev, struct drm_file *file,\n\tuintptr_t ptr, u32 size, u32 flags, u32 *handle);\nu16 etnaviv_buffer_init(struct etnaviv_gpu *gpu);\nu16 etnaviv_buffer_config_mmuv2(struct etnaviv_gpu *gpu, u32 mtlb_addr, u32 safe_addr);\nu16 etnaviv_buffer_config_pta(struct etnaviv_gpu *gpu, unsigned short id);\nvoid etnaviv_buffer_end(struct etnaviv_gpu *gpu);\nvoid etnaviv_sync_point_queue(struct etnaviv_gpu *gpu, unsigned int event);\nvoid etnaviv_buffer_queue(struct etnaviv_gpu *gpu, u32 exec_state,\n\tstruct etnaviv_iommu_context *mmu,\n\tunsigned int event, struct etnaviv_cmdbuf *cmdbuf);\nvoid etnaviv_validate_init(void);\nbool etnaviv_cmd_validate_one(struct etnaviv_gpu *gpu,\n\tu32 *stream, unsigned int size,\n\tstruct drm_etnaviv_gem_submit_reloc *relocs, unsigned int reloc_size);\n\n#ifdef CONFIG_DEBUG_FS\nvoid etnaviv_gem_describe_objects(struct etnaviv_drm_private *priv,\n\tstruct seq_file *m);\n#endif\n\n#define DBG(fmt, ...) DRM_DEBUG(fmt\"\\n\", ##__VA_ARGS__)\n#define VERB(fmt, ...) if (0) DRM_DEBUG(fmt\"\\n\", ##__VA_ARGS__)\n\n \nstatic inline size_t size_vstruct(size_t nelem, size_t elem_size, size_t base)\n{\n\tif (elem_size && nelem > (SIZE_MAX - base) / elem_size)\n\t\treturn 0;\n\treturn base + nelem * elem_size;\n}\n\n \nstatic inline unsigned long etnaviv_timeout_to_jiffies(\n\tconst struct drm_etnaviv_timespec *timeout)\n{\n\tstruct timespec64 ts, to = {\n\t\t.tv_sec = timeout->tv_sec,\n\t\t.tv_nsec = timeout->tv_nsec,\n\t};\n\n\tktime_get_ts64(&ts);\n\n\t \n\tif (timespec64_compare(&to, &ts) <= 0)\n\t\treturn 0;\n\n\tts = timespec64_sub(to, ts);\n\n\treturn timespec64_to_jiffies(&ts);\n}\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}