{
  "module_name": "etnaviv_gpu.h",
  "hash_id": "32a5bd17c6dece149e92c64aae3dde0188b181b3e9f1995c704b53264dd84e83",
  "original_prompt": "Ingested from linux-6.6.14/drivers/gpu/drm/etnaviv/etnaviv_gpu.h",
  "human_readable_source": " \n \n\n#ifndef __ETNAVIV_GPU_H__\n#define __ETNAVIV_GPU_H__\n\n#include \"etnaviv_cmdbuf.h\"\n#include \"etnaviv_gem.h\"\n#include \"etnaviv_mmu.h\"\n#include \"etnaviv_drv.h\"\n#include \"common.xml.h\"\n\nstruct etnaviv_gem_submit;\nstruct etnaviv_vram_mapping;\n\nstruct etnaviv_chip_identity {\n\tu32 model;\n\tu32 revision;\n\tu32 product_id;\n\tu32 customer_id;\n\tu32 eco_id;\n\n\t \n\tu32 features;\n\n\t \n\tu32 minor_features0;\n\tu32 minor_features1;\n\tu32 minor_features2;\n\tu32 minor_features3;\n\tu32 minor_features4;\n\tu32 minor_features5;\n\tu32 minor_features6;\n\tu32 minor_features7;\n\tu32 minor_features8;\n\tu32 minor_features9;\n\tu32 minor_features10;\n\tu32 minor_features11;\n\n\t \n\tu32 stream_count;\n\n\t \n\tu32 register_max;\n\n\t \n\tu32 thread_count;\n\n\t \n\tu32 shader_core_count;\n\n\t \n\tu32 nn_core_count;\n\n\t \n\tu32 vertex_cache_size;\n\n\t \n\tu32 vertex_output_buffer_size;\n\n\t \n\tu32 pixel_pipes;\n\n\t \n\tu32 instruction_count;\n\n\t \n\tu32 num_constants;\n\n\t \n\tu32 buffer_size;\n\n\t \n\tu8 varyings_count;\n};\n\nenum etnaviv_sec_mode {\n\tETNA_SEC_NONE = 0,\n\tETNA_SEC_KERNEL,\n\tETNA_SEC_TZ\n};\n\nstruct etnaviv_event {\n\tstruct dma_fence *fence;\n\tstruct etnaviv_gem_submit *submit;\n\n\tvoid (*sync_point)(struct etnaviv_gpu *gpu, struct etnaviv_event *event);\n};\n\nstruct etnaviv_cmdbuf_suballoc;\nstruct regulator;\nstruct clk;\n\n#define ETNA_NR_EVENTS 30\n\nenum etnaviv_gpu_state {\n\tETNA_GPU_STATE_UNKNOWN = 0,\n\tETNA_GPU_STATE_IDENTIFIED,\n\tETNA_GPU_STATE_RESET,\n\tETNA_GPU_STATE_INITIALIZED,\n\tETNA_GPU_STATE_RUNNING,\n\tETNA_GPU_STATE_FAULT,\n};\n\nstruct etnaviv_gpu {\n\tstruct drm_device *drm;\n\tstruct thermal_cooling_device *cooling;\n\tstruct device *dev;\n\tstruct mutex lock;\n\tstruct etnaviv_chip_identity identity;\n\tenum etnaviv_sec_mode sec_mode;\n\tstruct workqueue_struct *wq;\n\tstruct mutex sched_lock;\n\tstruct drm_gpu_scheduler sched;\n\tenum etnaviv_gpu_state state;\n\n\t \n\tstruct etnaviv_cmdbuf buffer;\n\tint exec_state;\n\n\t \n\tDECLARE_BITMAP(event_bitmap, ETNA_NR_EVENTS);\n\tstruct etnaviv_event event[ETNA_NR_EVENTS];\n\tstruct completion event_free;\n\tspinlock_t event_spinlock;\n\n\tu32 idle_mask;\n\n\t \n\tstruct xarray user_fences;\n\tu32 next_user_fence;\n\tu32 next_fence;\n\tu32 completed_fence;\n\twait_queue_head_t fence_event;\n\tu64 fence_context;\n\tspinlock_t fence_spinlock;\n\n\t \n\tstruct work_struct sync_point_work;\n\tint sync_point_event;\n\n\t \n\tu32 hangcheck_dma_addr;\n\tu32 hangcheck_fence;\n\n\tvoid __iomem *mmio;\n\tint irq;\n\n\tstruct etnaviv_iommu_context *mmu_context;\n\tunsigned int flush_seq;\n\n\t \n\tstruct clk *clk_bus;\n\tstruct clk *clk_reg;\n\tstruct clk *clk_core;\n\tstruct clk *clk_shader;\n\n\tunsigned int freq_scale;\n\tunsigned int fe_waitcycles;\n\tunsigned long base_rate_core;\n\tunsigned long base_rate_shader;\n};\n\nstatic inline void gpu_write(struct etnaviv_gpu *gpu, u32 reg, u32 data)\n{\n\twritel(data, gpu->mmio + reg);\n}\n\nstatic inline u32 gpu_read(struct etnaviv_gpu *gpu, u32 reg)\n{\n\treturn readl(gpu->mmio + reg);\n}\n\nstatic inline u32 gpu_fix_power_address(struct etnaviv_gpu *gpu, u32 reg)\n{\n\t \n\tif (gpu->identity.model == chipModel_GC300 &&\n\t    gpu->identity.revision < 0x2000)\n\t\treg += 0x100;\n\n\treturn reg;\n}\n\nstatic inline void gpu_write_power(struct etnaviv_gpu *gpu, u32 reg, u32 data)\n{\n\twritel(data, gpu->mmio + gpu_fix_power_address(gpu, reg));\n}\n\nstatic inline u32 gpu_read_power(struct etnaviv_gpu *gpu, u32 reg)\n{\n\treturn readl(gpu->mmio + gpu_fix_power_address(gpu, reg));\n}\n\nint etnaviv_gpu_get_param(struct etnaviv_gpu *gpu, u32 param, u64 *value);\n\nint etnaviv_gpu_init(struct etnaviv_gpu *gpu);\nbool etnaviv_fill_identity_from_hwdb(struct etnaviv_gpu *gpu);\n\n#ifdef CONFIG_DEBUG_FS\nint etnaviv_gpu_debugfs(struct etnaviv_gpu *gpu, struct seq_file *m);\n#endif\n\nvoid etnaviv_gpu_recover_hang(struct etnaviv_gem_submit *submit);\nvoid etnaviv_gpu_retire(struct etnaviv_gpu *gpu);\nint etnaviv_gpu_wait_fence_interruptible(struct etnaviv_gpu *gpu,\n\tu32 fence, struct drm_etnaviv_timespec *timeout);\nint etnaviv_gpu_wait_obj_inactive(struct etnaviv_gpu *gpu,\n\tstruct etnaviv_gem_object *etnaviv_obj,\n\tstruct drm_etnaviv_timespec *timeout);\nstruct dma_fence *etnaviv_gpu_submit(struct etnaviv_gem_submit *submit);\nint etnaviv_gpu_pm_get_sync(struct etnaviv_gpu *gpu);\nvoid etnaviv_gpu_pm_put(struct etnaviv_gpu *gpu);\nint etnaviv_gpu_wait_idle(struct etnaviv_gpu *gpu, unsigned int timeout_ms);\nvoid etnaviv_gpu_start_fe(struct etnaviv_gpu *gpu, u32 address, u16 prefetch);\n\nextern struct platform_driver etnaviv_gpu_driver;\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}