{
  "module_name": "push.h",
  "hash_id": "2f7b42ba1755c5f134447267c98ace51d3c0fa482c7a93620ce9c010e43fb4a9",
  "original_prompt": "Ingested from linux-6.6.14/drivers/gpu/drm/nouveau/include/nvif/push.h",
  "human_readable_source": " \n#ifndef __NVIF_PUSH_H__\n#define __NVIF_PUSH_H__\n#include <nvif/mem.h>\n#include <nvif/printf.h>\n\n#include <nvhw/drf.h>\n\nstruct nvif_push {\n\tint (*wait)(struct nvif_push *push, u32 size);\n\tvoid (*kick)(struct nvif_push *push);\n\n\tstruct nvif_mem mem;\n\n\tu32 *bgn;\n\tu32 *cur;\n\tu32 *seg;\n\tu32 *end;\n};\n\nstatic inline __must_check int\nPUSH_WAIT(struct nvif_push *push, u32 size)\n{\n\tif (push->cur + size >= push->end) {\n\t\tint ret = push->wait(push, size);\n\t\tif (ret)\n\t\t\treturn ret;\n\t}\n#ifdef CONFIG_NOUVEAU_DEBUG_PUSH\n\tpush->seg = push->cur + size;\n#endif\n\treturn 0;\n}\n\nstatic inline int\nPUSH_KICK(struct nvif_push *push)\n{\n\tpush->kick(push);\n\treturn 0;\n}\n\n#ifdef CONFIG_NOUVEAU_DEBUG_PUSH\n#define PUSH_PRINTF(p,f,a...) do {                              \\\n\tstruct nvif_push *_ppp = (p);                           \\\n\tu32 __o = _ppp->cur - (u32 *)_ppp->mem.object.map.ptr;  \\\n\tNVIF_DEBUG(&_ppp->mem.object, \"%08x: \"f, __o * 4, ##a); \\\n\t(void)__o;                                              \\\n} while(0)\n#define PUSH_ASSERT_ON(a,b) WARN((a), b)\n#else\n#define PUSH_PRINTF(p,f,a...)\n#define PUSH_ASSERT_ON(a, b)\n#endif\n\n#define PUSH_ASSERT(a,b) do {                                             \\\n\tstatic_assert(                                                    \\\n\t\t__builtin_choose_expr(__builtin_constant_p(a), (a), 1), b \\\n\t);                                                                \\\n\tPUSH_ASSERT_ON(!(a), b);                                          \\\n} while(0)\n\n#define PUSH_DATA__(p,d,f,a...) do {                       \\\n\tstruct nvif_push *_p = (p);                        \\\n\tu32 _d = (d);                                      \\\n\tPUSH_ASSERT(_p->cur < _p->seg, \"segment overrun\"); \\\n\tPUSH_ASSERT(_p->cur < _p->end, \"pushbuf overrun\"); \\\n\tPUSH_PRINTF(_p, \"%08x\"f, _d, ##a);                 \\\n\t*_p->cur++ = _d;                                   \\\n} while(0)\n\n#define PUSH_DATA_(X,p,m,i0,i1,d,s,f,a...) PUSH_DATA__((p), (d), \"-> \"#m f, ##a)\n#define PUSH_DATA(p,d) PUSH_DATA__((p), (d), \" data - %s\", __func__)\n\n\n#define PUSH_RSVD(p,d) do {          \\\n\tstruct nvif_push *__p = (p); \\\n\t__p->seg++;                  \\\n\t__p->end++;                  \\\n\td;                           \\\n} while(0)\n\n#ifdef CONFIG_NOUVEAU_DEBUG_PUSH\n#define PUSH_DATAp(X,p,m,i,o,d,s,f,a...) do {                                     \\\n\tstruct nvif_push *_pp = (p);                                              \\\n\tconst u32 *_dd = (d);                                                     \\\n\tu32 _s = (s), _i = (i?PUSH_##o##_INC);                                    \\\n\tif (_s--) {                                                               \\\n\t\tPUSH_DATA_(X, _pp, X##m, i0, i1, *_dd++, 1, \"+0x%x\", 0);          \\\n\t\twhile (_s--) {                                                    \\\n\t\t\tPUSH_DATA_(X, _pp, X##m, i0, i1, *_dd++, 1, \"+0x%x\", _i); \\\n\t\t\t_i += (0?PUSH_##o##_INC);                                 \\\n\t\t}                                                                 \\\n\t}                                                                         \\\n} while(0)\n#else\n#define PUSH_DATAp(X,p,m,i,o,d,s,f,a...) do {                    \\\n\tstruct nvif_push *_p = (p);                              \\\n\tu32 _s = (s);                                            \\\n\tPUSH_ASSERT(_p->cur + _s <= _p->seg, \"segment overrun\"); \\\n\tPUSH_ASSERT(_p->cur + _s <= _p->end, \"pushbuf overrun\"); \\\n\tmemcpy(_p->cur, (d), _s << 2);                           \\\n\t_p->cur += _s;                                           \\\n} while(0)\n#endif\n\n#define PUSH_1(X,f,ds,n,o,p,s,mA,dA) do {                             \\\n\tPUSH_##o##_HDR((p), s, mA, (ds)+(n));                         \\\n\tPUSH_##f(X, (p), X##mA, 1, o, (dA), ds, \"\");                  \\\n} while(0)\n#define PUSH_2(X,f,ds,n,o,p,s,mB,dB,mA,dA,a...) do {                  \\\n\tPUSH_ASSERT((mB) - (mA) == (1?PUSH_##o##_INC), \"mthd1\");      \\\n\tPUSH_1(X, DATA_, 1, (ds) + (n), o, (p), s, X##mA, (dA), ##a); \\\n\tPUSH_##f(X, (p), X##mB, 0, o, (dB), ds, \"\");                  \\\n} while(0)\n#define PUSH_3(X,f,ds,n,o,p,s,mB,dB,mA,dA,a...) do {                  \\\n\tPUSH_ASSERT((mB) - (mA) == (0?PUSH_##o##_INC), \"mthd2\");      \\\n\tPUSH_2(X, DATA_, 1, (ds) + (n), o, (p), s, X##mA, (dA), ##a); \\\n\tPUSH_##f(X, (p), X##mB, 0, o, (dB), ds, \"\");                  \\\n} while(0)\n#define PUSH_4(X,f,ds,n,o,p,s,mB,dB,mA,dA,a...) do {                  \\\n\tPUSH_ASSERT((mB) - (mA) == (0?PUSH_##o##_INC), \"mthd3\");      \\\n\tPUSH_3(X, DATA_, 1, (ds) + (n), o, (p), s, X##mA, (dA), ##a); \\\n\tPUSH_##f(X, (p), X##mB, 0, o, (dB), ds, \"\");                  \\\n} while(0)\n#define PUSH_5(X,f,ds,n,o,p,s,mB,dB,mA,dA,a...) do {                  \\\n\tPUSH_ASSERT((mB) - (mA) == (0?PUSH_##o##_INC), \"mthd4\");      \\\n\tPUSH_4(X, DATA_, 1, (ds) + (n), o, (p), s, X##mA, (dA), ##a); \\\n\tPUSH_##f(X, (p), X##mB, 0, o, (dB), ds, \"\");                  \\\n} while(0)\n#define PUSH_6(X,f,ds,n,o,p,s,mB,dB,mA,dA,a...) do {                  \\\n\tPUSH_ASSERT((mB) - (mA) == (0?PUSH_##o##_INC), \"mthd5\");      \\\n\tPUSH_5(X, DATA_, 1, (ds) + (n), o, (p), s, X##mA, (dA), ##a); \\\n\tPUSH_##f(X, (p), X##mB, 0, o, (dB), ds, \"\");                  \\\n} while(0)\n#define PUSH_7(X,f,ds,n,o,p,s,mB,dB,mA,dA,a...) do {                  \\\n\tPUSH_ASSERT((mB) - (mA) == (0?PUSH_##o##_INC), \"mthd6\");      \\\n\tPUSH_6(X, DATA_, 1, (ds) + (n), o, (p), s, X##mA, (dA), ##a); \\\n\tPUSH_##f(X, (p), X##mB, 0, o, (dB), ds, \"\");                  \\\n} while(0)\n#define PUSH_8(X,f,ds,n,o,p,s,mB,dB,mA,dA,a...) do {                  \\\n\tPUSH_ASSERT((mB) - (mA) == (0?PUSH_##o##_INC), \"mthd7\");      \\\n\tPUSH_7(X, DATA_, 1, (ds) + (n), o, (p), s, X##mA, (dA), ##a); \\\n\tPUSH_##f(X, (p), X##mB, 0, o, (dB), ds, \"\");                  \\\n} while(0)\n#define PUSH_9(X,f,ds,n,o,p,s,mB,dB,mA,dA,a...) do {                  \\\n\tPUSH_ASSERT((mB) - (mA) == (0?PUSH_##o##_INC), \"mthd8\");      \\\n\tPUSH_8(X, DATA_, 1, (ds) + (n), o, (p), s, X##mA, (dA), ##a); \\\n\tPUSH_##f(X, (p), X##mB, 0, o, (dB), ds, \"\");                  \\\n} while(0)\n#define PUSH_10(X,f,ds,n,o,p,s,mB,dB,mA,dA,a...) do {                 \\\n\tPUSH_ASSERT((mB) - (mA) == (0?PUSH_##o##_INC), \"mthd9\");      \\\n\tPUSH_9(X, DATA_, 1, (ds) + (n), o, (p), s, X##mA, (dA), ##a); \\\n\tPUSH_##f(X, (p), X##mB, 0, o, (dB), ds, \"\");                  \\\n} while(0)\n\n#define PUSH_1D(X,o,p,s,mA,dA)                         \\\n\tPUSH_1(X, DATA_, 1, 0, o, (p), s, X##mA, (dA))\n#define PUSH_2D(X,o,p,s,mA,dA,mB,dB)                   \\\n\tPUSH_2(X, DATA_, 1, 0, o, (p), s, X##mB, (dB), \\\n\t\t\t\t\t  X##mA, (dA))\n#define PUSH_3D(X,o,p,s,mA,dA,mB,dB,mC,dC)             \\\n\tPUSH_3(X, DATA_, 1, 0, o, (p), s, X##mC, (dC), \\\n\t\t\t\t\t  X##mB, (dB), \\\n\t\t\t\t\t  X##mA, (dA))\n#define PUSH_4D(X,o,p,s,mA,dA,mB,dB,mC,dC,mD,dD)       \\\n\tPUSH_4(X, DATA_, 1, 0, o, (p), s, X##mD, (dD), \\\n\t\t\t\t\t  X##mC, (dC), \\\n\t\t\t\t\t  X##mB, (dB), \\\n\t\t\t\t\t  X##mA, (dA))\n#define PUSH_5D(X,o,p,s,mA,dA,mB,dB,mC,dC,mD,dD,mE,dE) \\\n\tPUSH_5(X, DATA_, 1, 0, o, (p), s, X##mE, (dE), \\\n\t\t\t\t\t  X##mD, (dD), \\\n\t\t\t\t\t  X##mC, (dC), \\\n\t\t\t\t\t  X##mB, (dB), \\\n\t\t\t\t\t  X##mA, (dA))\n#define PUSH_6D(X,o,p,s,mA,dA,mB,dB,mC,dC,mD,dD,mE,dE,mF,dF) \\\n\tPUSH_6(X, DATA_, 1, 0, o, (p), s, X##mF, (dF),       \\\n\t\t\t\t\t  X##mE, (dE),       \\\n\t\t\t\t\t  X##mD, (dD),       \\\n\t\t\t\t\t  X##mC, (dC),       \\\n\t\t\t\t\t  X##mB, (dB),       \\\n\t\t\t\t\t  X##mA, (dA))\n#define PUSH_7D(X,o,p,s,mA,dA,mB,dB,mC,dC,mD,dD,mE,dE,mF,dF,mG,dG) \\\n\tPUSH_7(X, DATA_, 1, 0, o, (p), s, X##mG, (dG),             \\\n\t\t\t\t\t  X##mF, (dF),             \\\n\t\t\t\t\t  X##mE, (dE),             \\\n\t\t\t\t\t  X##mD, (dD),             \\\n\t\t\t\t\t  X##mC, (dC),             \\\n\t\t\t\t\t  X##mB, (dB),             \\\n\t\t\t\t\t  X##mA, (dA))\n#define PUSH_8D(X,o,p,s,mA,dA,mB,dB,mC,dC,mD,dD,mE,dE,mF,dF,mG,dG,mH,dH) \\\n\tPUSH_8(X, DATA_, 1, 0, o, (p), s, X##mH, (dH),                   \\\n\t\t\t\t\t  X##mG, (dG),                   \\\n\t\t\t\t\t  X##mF, (dF),                   \\\n\t\t\t\t\t  X##mE, (dE),                   \\\n\t\t\t\t\t  X##mD, (dD),                   \\\n\t\t\t\t\t  X##mC, (dC),                   \\\n\t\t\t\t\t  X##mB, (dB),                   \\\n\t\t\t\t\t  X##mA, (dA))\n#define PUSH_9D(X,o,p,s,mA,dA,mB,dB,mC,dC,mD,dD,mE,dE,mF,dF,mG,dG,mH,dH,mI,dI) \\\n\tPUSH_9(X, DATA_, 1, 0, o, (p), s, X##mI, (dI),                         \\\n\t\t\t\t\t  X##mH, (dH),                         \\\n\t\t\t\t\t  X##mG, (dG),                         \\\n\t\t\t\t\t  X##mF, (dF),                         \\\n\t\t\t\t\t  X##mE, (dE),                         \\\n\t\t\t\t\t  X##mD, (dD),                         \\\n\t\t\t\t\t  X##mC, (dC),                         \\\n\t\t\t\t\t  X##mB, (dB),                         \\\n\t\t\t\t\t  X##mA, (dA))\n#define PUSH_10D(X,o,p,s,mA,dA,mB,dB,mC,dC,mD,dD,mE,dE,mF,dF,mG,dG,mH,dH,mI,dI,mJ,dJ) \\\n\tPUSH_10(X, DATA_, 1, 0, o, (p), s, X##mJ, (dJ),                               \\\n\t\t\t\t\t   X##mI, (dI),                               \\\n\t\t\t\t\t   X##mH, (dH),                               \\\n\t\t\t\t\t   X##mG, (dG),                               \\\n\t\t\t\t\t   X##mF, (dF),                               \\\n\t\t\t\t\t   X##mE, (dE),                               \\\n\t\t\t\t\t   X##mD, (dD),                               \\\n\t\t\t\t\t   X##mC, (dC),                               \\\n\t\t\t\t\t   X##mB, (dB),                               \\\n\t\t\t\t\t   X##mA, (dA))\n\n#define PUSH_1P(X,o,p,s,mA,dp,ds)                       \\\n\tPUSH_1(X, DATAp, ds, 0, o, (p), s, X##mA, (dp))\n#define PUSH_2P(X,o,p,s,mA,dA,mB,dp,ds)                 \\\n\tPUSH_2(X, DATAp, ds, 0, o, (p), s, X##mB, (dp), \\\n\t\t\t\t\t   X##mA, (dA))\n#define PUSH_3P(X,o,p,s,mA,dA,mB,dB,mC,dp,ds)           \\\n\tPUSH_3(X, DATAp, ds, 0, o, (p), s, X##mC, (dp), \\\n\t\t\t\t\t   X##mB, (dB), \\\n\t\t\t\t\t   X##mA, (dA))\n\n#define PUSH_(A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,IMPL,...) IMPL\n#define PUSH(A...) PUSH_(A, PUSH_10P, PUSH_10D,          \\\n\t\t\t    PUSH_9P , PUSH_9D,           \\\n\t\t\t    PUSH_8P , PUSH_8D,           \\\n\t\t\t    PUSH_7P , PUSH_7D,           \\\n\t\t\t    PUSH_6P , PUSH_6D,           \\\n\t\t\t    PUSH_5P , PUSH_5D,           \\\n\t\t\t    PUSH_4P , PUSH_4D,           \\\n\t\t\t    PUSH_3P , PUSH_3D,           \\\n\t\t\t    PUSH_2P , PUSH_2D,           \\\n\t\t\t    PUSH_1P , PUSH_1D)(, ##A)\n\n#define PUSH_NVIM(p,c,m,d) do {             \\\n\tstruct nvif_push *__p = (p);        \\\n\tu32 __d = (d);                      \\\n\tPUSH_IMMD_HDR(__p, c, m, __d);      \\\n\t__p->cur--;                         \\\n\tPUSH_PRINTF(__p, \"%08x-> \"#m, __d); \\\n\t__p->cur++;                         \\\n} while(0)\n#define PUSH_NVSQ(A...) PUSH(MTHD, ##A)\n#define PUSH_NV1I(A...) PUSH(1INC, ##A)\n#define PUSH_NVNI(A...) PUSH(NINC, ##A)\n\n\n#define PUSH_NV_1(X,o,p,c,mA,d...) \\\n       PUSH_##o(p,c,c##_##mA,d)\n#define PUSH_NV_2(X,o,p,c,mA,dA,mB,d...) \\\n       PUSH_##o(p,c,c##_##mA,dA,         \\\n\t\t    c##_##mB,d)\n#define PUSH_NV_3(X,o,p,c,mA,dA,mB,dB,mC,d...) \\\n       PUSH_##o(p,c,c##_##mA,dA,               \\\n\t\t    c##_##mB,dB,               \\\n\t\t    c##_##mC,d)\n#define PUSH_NV_4(X,o,p,c,mA,dA,mB,dB,mC,dC,mD,d...) \\\n       PUSH_##o(p,c,c##_##mA,dA,                     \\\n\t\t    c##_##mB,dB,                     \\\n\t\t    c##_##mC,dC,                     \\\n\t\t    c##_##mD,d)\n#define PUSH_NV_5(X,o,p,c,mA,dA,mB,dB,mC,dC,mD,dD,mE,d...) \\\n       PUSH_##o(p,c,c##_##mA,dA,                           \\\n\t\t    c##_##mB,dB,                           \\\n\t\t    c##_##mC,dC,                           \\\n\t\t    c##_##mD,dD,                           \\\n\t\t    c##_##mE,d)\n#define PUSH_NV_6(X,o,p,c,mA,dA,mB,dB,mC,dC,mD,dD,mE,dE,mF,d...) \\\n       PUSH_##o(p,c,c##_##mA,dA,                                 \\\n\t\t    c##_##mB,dB,                                 \\\n\t\t    c##_##mC,dC,                                 \\\n\t\t    c##_##mD,dD,                                 \\\n\t\t    c##_##mE,dE,                                 \\\n\t\t    c##_##mF,d)\n#define PUSH_NV_7(X,o,p,c,mA,dA,mB,dB,mC,dC,mD,dD,mE,dE,mF,dF,mG,d...) \\\n       PUSH_##o(p,c,c##_##mA,dA,                                       \\\n\t\t    c##_##mB,dB,                                       \\\n\t\t    c##_##mC,dC,                                       \\\n\t\t    c##_##mD,dD,                                       \\\n\t\t    c##_##mE,dE,                                       \\\n\t\t    c##_##mF,dF,                                       \\\n\t\t    c##_##mG,d)\n#define PUSH_NV_8(X,o,p,c,mA,dA,mB,dB,mC,dC,mD,dD,mE,dE,mF,dF,mG,dG,mH,d...) \\\n       PUSH_##o(p,c,c##_##mA,dA,                                             \\\n\t\t    c##_##mB,dB,                                             \\\n\t\t    c##_##mC,dC,                                             \\\n\t\t    c##_##mD,dD,                                             \\\n\t\t    c##_##mE,dE,                                             \\\n\t\t    c##_##mF,dF,                                             \\\n\t\t    c##_##mG,dG,                                             \\\n\t\t    c##_##mH,d)\n#define PUSH_NV_9(X,o,p,c,mA,dA,mB,dB,mC,dC,mD,dD,mE,dE,mF,dF,mG,dG,mH,dH,mI,d...) \\\n       PUSH_##o(p,c,c##_##mA,dA,                                                   \\\n\t\t    c##_##mB,dB,                                                   \\\n\t\t    c##_##mC,dC,                                                   \\\n\t\t    c##_##mD,dD,                                                   \\\n\t\t    c##_##mE,dE,                                                   \\\n\t\t    c##_##mF,dF,                                                   \\\n\t\t    c##_##mG,dG,                                                   \\\n\t\t    c##_##mH,dH,                                                   \\\n\t\t    c##_##mI,d)\n#define PUSH_NV_10(X,o,p,c,mA,dA,mB,dB,mC,dC,mD,dD,mE,dE,mF,dF,mG,dG,mH,dH,mI,dI,mJ,d...) \\\n       PUSH_##o(p,c,c##_##mA,dA,                                                          \\\n\t\t    c##_##mB,dB,                                                          \\\n\t\t    c##_##mC,dC,                                                          \\\n\t\t    c##_##mD,dD,                                                          \\\n\t\t    c##_##mE,dE,                                                          \\\n\t\t    c##_##mF,dF,                                                          \\\n\t\t    c##_##mG,dG,                                                          \\\n\t\t    c##_##mH,dH,                                                          \\\n\t\t    c##_##mI,dI,                                                          \\\n\t\t    c##_##mJ,d)\n\n#define PUSH_NV_(A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,IMPL,...) IMPL\n#define PUSH_NV(A...) PUSH_NV_(A, PUSH_NV_10, PUSH_NV_10,       \\\n\t\t\t\t  PUSH_NV_9 , PUSH_NV_9,        \\\n\t\t\t\t  PUSH_NV_8 , PUSH_NV_8,        \\\n\t\t\t\t  PUSH_NV_7 , PUSH_NV_7,        \\\n\t\t\t\t  PUSH_NV_6 , PUSH_NV_6,        \\\n\t\t\t\t  PUSH_NV_5 , PUSH_NV_5,        \\\n\t\t\t\t  PUSH_NV_4 , PUSH_NV_4,        \\\n\t\t\t\t  PUSH_NV_3 , PUSH_NV_3,        \\\n\t\t\t\t  PUSH_NV_2 , PUSH_NV_2,        \\\n\t\t\t\t  PUSH_NV_1 , PUSH_NV_1)(, ##A)\n\n#define PUSH_IMMD(A...) PUSH_NV(NVIM, ##A)\n#define PUSH_MTHD(A...) PUSH_NV(NVSQ, ##A)\n#define PUSH_1INC(A...) PUSH_NV(NV1I, ##A)\n#define PUSH_NINC(A...) PUSH_NV(NVNI, ##A)\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}