{
  "module_name": "fb.h",
  "hash_id": "85a1731df54430bd6a1503bd0e9b6c6f3bc749f2371c8164365accca440e8b95",
  "original_prompt": "Ingested from linux-6.6.14/drivers/gpu/drm/nouveau/include/nvkm/subdev/fb.h",
  "human_readable_source": " \n#ifndef __NVKM_FB_H__\n#define __NVKM_FB_H__\n#include <core/subdev.h>\n#include <core/falcon.h>\n#include <core/mm.h>\n\n \n#define NV_MEM_ACCESS_RO  1\n#define NV_MEM_ACCESS_WO  2\n#define NV_MEM_ACCESS_RW (NV_MEM_ACCESS_RO | NV_MEM_ACCESS_WO)\n#define NV_MEM_ACCESS_SYS 4\n#define NV_MEM_ACCESS_VM  8\n#define NV_MEM_ACCESS_NOSNOOP 16\n\n#define NV_MEM_TARGET_VRAM        0\n#define NV_MEM_TARGET_PCI         1\n#define NV_MEM_TARGET_PCI_NOSNOOP 2\n#define NV_MEM_TARGET_VM          3\n#define NV_MEM_TARGET_GART        4\n\n#define NVKM_RAM_TYPE_VM 0x7f\n#define NV_MEM_COMP_VM 0x03\n\nstruct nvkm_fb_tile {\n\tstruct nvkm_mm_node *tag;\n\tu32 addr;\n\tu32 limit;\n\tu32 pitch;\n\tu32 zcomp;\n};\n\nstruct nvkm_fb {\n\tconst struct nvkm_fb_func *func;\n\tstruct nvkm_subdev subdev;\n\n\tstruct nvkm_falcon_fw vpr_scrubber;\n\n\tstruct {\n\t\tstruct page *flush_page;\n\t\tdma_addr_t flush_page_addr;\n\t} sysmem;\n\n\tstruct nvkm_ram *ram;\n\n\tstruct {\n\t\tstruct mutex mutex;  \n\t\tstruct nvkm_mm mm;\n\t} tags;\n\n\tstruct {\n\t\tstruct nvkm_fb_tile region[16];\n\t\tint regions;\n\t} tile;\n\n\tu8 page;\n\n\tstruct nvkm_memory *mmu_rd;\n\tstruct nvkm_memory *mmu_wr;\n};\n\nu64 nvkm_fb_vidmem_size(struct nvkm_device *);\nint nvkm_fb_mem_unlock(struct nvkm_fb *);\n\nvoid nvkm_fb_tile_init(struct nvkm_fb *, int region, u32 addr, u32 size,\n\t\t       u32 pitch, u32 flags, struct nvkm_fb_tile *);\nvoid nvkm_fb_tile_fini(struct nvkm_fb *, int region, struct nvkm_fb_tile *);\nvoid nvkm_fb_tile_prog(struct nvkm_fb *, int region, struct nvkm_fb_tile *);\n\nint nv04_fb_new(struct nvkm_device *, enum nvkm_subdev_type, int inst, struct nvkm_fb **);\nint nv10_fb_new(struct nvkm_device *, enum nvkm_subdev_type, int inst, struct nvkm_fb **);\nint nv1a_fb_new(struct nvkm_device *, enum nvkm_subdev_type, int inst, struct nvkm_fb **);\nint nv20_fb_new(struct nvkm_device *, enum nvkm_subdev_type, int inst, struct nvkm_fb **);\nint nv25_fb_new(struct nvkm_device *, enum nvkm_subdev_type, int inst, struct nvkm_fb **);\nint nv30_fb_new(struct nvkm_device *, enum nvkm_subdev_type, int inst, struct nvkm_fb **);\nint nv35_fb_new(struct nvkm_device *, enum nvkm_subdev_type, int inst, struct nvkm_fb **);\nint nv36_fb_new(struct nvkm_device *, enum nvkm_subdev_type, int inst, struct nvkm_fb **);\nint nv40_fb_new(struct nvkm_device *, enum nvkm_subdev_type, int inst, struct nvkm_fb **);\nint nv41_fb_new(struct nvkm_device *, enum nvkm_subdev_type, int inst, struct nvkm_fb **);\nint nv44_fb_new(struct nvkm_device *, enum nvkm_subdev_type, int inst, struct nvkm_fb **);\nint nv46_fb_new(struct nvkm_device *, enum nvkm_subdev_type, int inst, struct nvkm_fb **);\nint nv47_fb_new(struct nvkm_device *, enum nvkm_subdev_type, int inst, struct nvkm_fb **);\nint nv49_fb_new(struct nvkm_device *, enum nvkm_subdev_type, int inst, struct nvkm_fb **);\nint nv4e_fb_new(struct nvkm_device *, enum nvkm_subdev_type, int inst, struct nvkm_fb **);\nint nv50_fb_new(struct nvkm_device *, enum nvkm_subdev_type, int inst, struct nvkm_fb **);\nint g84_fb_new(struct nvkm_device *, enum nvkm_subdev_type, int inst, struct nvkm_fb **);\nint gt215_fb_new(struct nvkm_device *, enum nvkm_subdev_type, int inst, struct nvkm_fb **);\nint mcp77_fb_new(struct nvkm_device *, enum nvkm_subdev_type, int inst, struct nvkm_fb **);\nint mcp89_fb_new(struct nvkm_device *, enum nvkm_subdev_type, int inst, struct nvkm_fb **);\nint gf100_fb_new(struct nvkm_device *, enum nvkm_subdev_type, int inst, struct nvkm_fb **);\nint gf108_fb_new(struct nvkm_device *, enum nvkm_subdev_type, int inst, struct nvkm_fb **);\nint gk104_fb_new(struct nvkm_device *, enum nvkm_subdev_type, int inst, struct nvkm_fb **);\nint gk110_fb_new(struct nvkm_device *, enum nvkm_subdev_type, int inst, struct nvkm_fb **);\nint gk20a_fb_new(struct nvkm_device *, enum nvkm_subdev_type, int inst, struct nvkm_fb **);\nint gm107_fb_new(struct nvkm_device *, enum nvkm_subdev_type, int inst, struct nvkm_fb **);\nint gm200_fb_new(struct nvkm_device *, enum nvkm_subdev_type, int inst, struct nvkm_fb **);\nint gm20b_fb_new(struct nvkm_device *, enum nvkm_subdev_type, int inst, struct nvkm_fb **);\nint gp100_fb_new(struct nvkm_device *, enum nvkm_subdev_type, int inst, struct nvkm_fb **);\nint gp102_fb_new(struct nvkm_device *, enum nvkm_subdev_type, int inst, struct nvkm_fb **);\nint gp10b_fb_new(struct nvkm_device *, enum nvkm_subdev_type, int inst, struct nvkm_fb **);\nint gv100_fb_new(struct nvkm_device *, enum nvkm_subdev_type, int inst, struct nvkm_fb **);\nint tu102_fb_new(struct nvkm_device *, enum nvkm_subdev_type, int inst, struct nvkm_fb **);\nint ga100_fb_new(struct nvkm_device *, enum nvkm_subdev_type, int inst, struct nvkm_fb **);\nint ga102_fb_new(struct nvkm_device *, enum nvkm_subdev_type, int inst, struct nvkm_fb **);\n\n#include <subdev/bios.h>\n#include <subdev/bios/ramcfg.h>\n\nstruct nvkm_ram_data {\n\tstruct list_head head;\n\tstruct nvbios_ramcfg bios;\n\tu32 freq;\n};\n\nenum nvkm_ram_type {\n\tNVKM_RAM_TYPE_UNKNOWN = 0,\n\tNVKM_RAM_TYPE_STOLEN,\n\tNVKM_RAM_TYPE_SGRAM,\n\tNVKM_RAM_TYPE_SDRAM,\n\tNVKM_RAM_TYPE_DDR1,\n\tNVKM_RAM_TYPE_DDR2,\n\tNVKM_RAM_TYPE_DDR3,\n\tNVKM_RAM_TYPE_GDDR2,\n\tNVKM_RAM_TYPE_GDDR3,\n\tNVKM_RAM_TYPE_GDDR4,\n\tNVKM_RAM_TYPE_GDDR5,\n\tNVKM_RAM_TYPE_GDDR5X,\n\tNVKM_RAM_TYPE_GDDR6,\n\tNVKM_RAM_TYPE_HBM2,\n};\n\nstruct nvkm_ram {\n\tconst struct nvkm_ram_func *func;\n\tstruct nvkm_fb *fb;\n\tenum nvkm_ram_type type;\n\tu64 size;\n\n#define NVKM_RAM_MM_SHIFT 12\n#define NVKM_RAM_MM_ANY    (NVKM_MM_HEAP_ANY + 0)\n#define NVKM_RAM_MM_NORMAL (NVKM_MM_HEAP_ANY + 1)\n#define NVKM_RAM_MM_NOMAP  (NVKM_MM_HEAP_ANY + 2)\n#define NVKM_RAM_MM_MIXED  (NVKM_MM_HEAP_ANY + 3)\n\tstruct nvkm_mm vram;\n\tu64 stolen;\n\tstruct mutex mutex;\n\n\tint ranks;\n\tint parts;\n\tint part_mask;\n\n\tu32 freq;\n\tu32 mr[16];\n\tu32 mr1_nuts;\n\n\tstruct nvkm_ram_data *next;\n\tstruct nvkm_ram_data former;\n\tstruct nvkm_ram_data xition;\n\tstruct nvkm_ram_data target;\n};\n\nint\nnvkm_ram_get(struct nvkm_device *, u8 heap, u8 type, u8 page, u64 size,\n\t     bool contig, bool back, struct nvkm_memory **);\n\nstruct nvkm_ram_func {\n\tu64 upper;\n\tu32 (*probe_fbp)(const struct nvkm_ram_func *, struct nvkm_device *,\n\t\t\t int fbp, int *pltcs);\n\tu32 (*probe_fbp_amount)(const struct nvkm_ram_func *, u32 fbpao,\n\t\t\t\tstruct nvkm_device *, int fbp, int *pltcs);\n\tu32 (*probe_fbpa_amount)(struct nvkm_device *, int fbpa);\n\tvoid *(*dtor)(struct nvkm_ram *);\n\tint (*init)(struct nvkm_ram *);\n\n\tint (*calc)(struct nvkm_ram *, u32 freq);\n\tint (*prog)(struct nvkm_ram *);\n\tvoid (*tidy)(struct nvkm_ram *);\n};\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}