{
  "module_name": "event.h",
  "hash_id": "c3445aa74a39b3e8a28fdb7150a76cc9c352bd4ec05a1a5dd1d2ac3721325d26",
  "original_prompt": "Ingested from linux-6.6.14/drivers/gpu/drm/nouveau/include/nvkm/core/event.h",
  "human_readable_source": " \n#ifndef __NVKM_EVENT_H__\n#define __NVKM_EVENT_H__\n#include <core/os.h>\nstruct nvkm_object;\nstruct nvkm_oclass;\nstruct nvkm_uevent;\n\nstruct nvkm_event {\n\tconst struct nvkm_event_func *func;\n\tstruct nvkm_subdev *subdev;\n\n\tint types_nr;\n\tint index_nr;\n\n\tspinlock_t refs_lock;\n\trwlock_t list_lock;\n\tint *refs;\n\n\tstruct list_head ntfy;\n};\n\nstruct nvkm_event_func {\n\tvoid (*init)(struct nvkm_event *, int type, int index);\n\tvoid (*fini)(struct nvkm_event *, int type, int index);\n};\n\nint  __nvkm_event_init(const struct nvkm_event_func *func, struct nvkm_subdev *, int types_nr,\n\t\t       int index_nr, struct nvkm_event *);\n\n \nstatic __always_inline int\nnvkm_event_init(const struct nvkm_event_func *func, struct nvkm_subdev *subdev,\n\t\tint types_nr, int index_nr, struct nvkm_event *event)\n{\n\tspin_lock_init(&event->refs_lock);\n\trwlock_init(&event->list_lock);\n\treturn __nvkm_event_init(func, subdev, types_nr, index_nr, event);\n}\n\nvoid nvkm_event_fini(struct nvkm_event *);\n\n#define NVKM_EVENT_KEEP 0\n#define NVKM_EVENT_DROP 1\nstruct nvkm_event_ntfy;\ntypedef int (*nvkm_event_func)(struct nvkm_event_ntfy *, u32 bits);\n\nstruct nvkm_event_ntfy {\n\tstruct nvkm_event *event;\n\tint id;\n\tu32 bits;\n\tbool wait;\n\tnvkm_event_func func;\n\n\tatomic_t allowed;\n\tbool running;\n\n\tstruct list_head head;\n};\n\nvoid nvkm_event_ntfy(struct nvkm_event *, int id, u32 bits);\nbool nvkm_event_ntfy_valid(struct nvkm_event *, int id, u32 bits);\nvoid nvkm_event_ntfy_add(struct nvkm_event *, int id, u32 bits, bool wait, nvkm_event_func,\n\t\t\t struct nvkm_event_ntfy *);\nvoid nvkm_event_ntfy_del(struct nvkm_event_ntfy *);\nvoid nvkm_event_ntfy_allow(struct nvkm_event_ntfy *);\nvoid nvkm_event_ntfy_block(struct nvkm_event_ntfy *);\n\ntypedef int (*nvkm_uevent_func)(struct nvkm_object *, u64 token, u32 bits);\n\nint nvkm_uevent_new(const struct nvkm_oclass *, void *argv, u32 argc, struct nvkm_object **);\nint nvkm_uevent_add(struct nvkm_uevent *, struct nvkm_event *, int id, u32 bits, nvkm_uevent_func);\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}