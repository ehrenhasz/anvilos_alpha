{
  "module_name": "device.h",
  "hash_id": "9d6f0546f129d73e3714aa43ab8e7bf7148a1e8529eb6c1c1b68f03e9736b87b",
  "original_prompt": "Ingested from linux-6.6.14/drivers/gpu/drm/nouveau/include/nvkm/core/device.h",
  "human_readable_source": " \n#ifndef __NVKM_DEVICE_H__\n#define __NVKM_DEVICE_H__\n#include <core/oclass.h>\n#include <core/intr.h>\nenum nvkm_subdev_type;\n\nenum nvkm_device_type {\n\tNVKM_DEVICE_PCI,\n\tNVKM_DEVICE_AGP,\n\tNVKM_DEVICE_PCIE,\n\tNVKM_DEVICE_TEGRA,\n};\n\nstruct nvkm_device {\n\tconst struct nvkm_device_func *func;\n\tconst struct nvkm_device_quirk *quirk;\n\tstruct device *dev;\n\tenum nvkm_device_type type;\n\tu64 handle;\n\tconst char *name;\n\tconst char *cfgopt;\n\tconst char *dbgopt;\n\n\tstruct list_head head;\n\tstruct mutex mutex;\n\tint refcount;\n\n\tvoid __iomem *pri;\n\n\tu32 debug;\n\n\tconst struct nvkm_device_chip *chip;\n\tenum {\n\t\tNV_04    = 0x04,\n\t\tNV_10    = 0x10,\n\t\tNV_11    = 0x11,\n\t\tNV_20    = 0x20,\n\t\tNV_30    = 0x30,\n\t\tNV_40    = 0x40,\n\t\tNV_50    = 0x50,\n\t\tNV_C0    = 0xc0,\n\t\tNV_E0    = 0xe0,\n\t\tGM100    = 0x110,\n\t\tGP100    = 0x130,\n\t\tGV100    = 0x140,\n\t\tTU100    = 0x160,\n\t\tGA100    = 0x170,\n\t} card_type;\n\tu32 chipset;\n\tu8  chiprev;\n\tu32 crystal;\n\n\tstruct {\n\t\tstruct notifier_block nb;\n\t} acpi;\n\n#define NVKM_LAYOUT_ONCE(type,data,ptr) data *ptr;\n#define NVKM_LAYOUT_INST(type,data,ptr,cnt) data *ptr[cnt];\n#include <core/layout.h>\n#undef NVKM_LAYOUT_INST\n#undef NVKM_LAYOUT_ONCE\n\tstruct list_head subdev;\n\n\tstruct {\n\t\tstruct list_head intr;\n\t\tstruct list_head prio[NVKM_INTR_PRIO_NR];\n\t\tspinlock_t lock;\n\t\tint irq;\n\t\tbool alloc;\n\t\tbool armed;\n\t\tbool legacy_done;\n\t} intr;\n};\n\nstruct nvkm_subdev *nvkm_device_subdev(struct nvkm_device *, int type, int inst);\nstruct nvkm_engine *nvkm_device_engine(struct nvkm_device *, int type, int inst);\n\nstruct nvkm_device_func {\n\tstruct nvkm_device_pci *(*pci)(struct nvkm_device *);\n\tstruct nvkm_device_tegra *(*tegra)(struct nvkm_device *);\n\tvoid *(*dtor)(struct nvkm_device *);\n\tint (*preinit)(struct nvkm_device *);\n\tint (*init)(struct nvkm_device *);\n\tvoid (*fini)(struct nvkm_device *, bool suspend);\n\tint (*irq)(struct nvkm_device *);\n\tresource_size_t (*resource_addr)(struct nvkm_device *, unsigned bar);\n\tresource_size_t (*resource_size)(struct nvkm_device *, unsigned bar);\n\tbool cpu_coherent;\n};\n\nstruct nvkm_device_quirk {\n\tu8 tv_pin_mask;\n\tu8 tv_gpio;\n};\n\nstruct nvkm_device_chip {\n\tconst char *name;\n#define NVKM_LAYOUT_ONCE(type,data,ptr,...)                                                  \\\n\tstruct {                                                                             \\\n\t\tu32 inst;                                                                    \\\n\t\tint (*ctor)(struct nvkm_device *, enum nvkm_subdev_type, int inst, data **); \\\n\t} ptr;\n#define NVKM_LAYOUT_INST(A...) NVKM_LAYOUT_ONCE(A)\n#include <core/layout.h>\n#undef NVKM_LAYOUT_INST\n#undef NVKM_LAYOUT_ONCE\n};\n\nstruct nvkm_device *nvkm_device_find(u64 name);\nint nvkm_device_list(u64 *name, int size);\n\n \n#define nvkm_rd08(d,a) ioread8((d)->pri + (a))\n#define nvkm_rd16(d,a) ioread16_native((d)->pri + (a))\n#define nvkm_rd32(d,a) ioread32_native((d)->pri + (a))\n#define nvkm_wr08(d,a,v) iowrite8((v), (d)->pri + (a))\n#define nvkm_wr16(d,a,v) iowrite16_native((v), (d)->pri + (a))\n#define nvkm_wr32(d,a,v) iowrite32_native((v), (d)->pri + (a))\n#define nvkm_mask(d,a,m,v) ({                                                  \\\n\tstruct nvkm_device *_device = (d);                                     \\\n\tu32 _addr = (a), _temp = nvkm_rd32(_device, _addr);                    \\\n\tnvkm_wr32(_device, _addr, (_temp & ~(m)) | (v));                       \\\n\t_temp;                                                                 \\\n})\n\nvoid nvkm_device_del(struct nvkm_device **);\n\nstruct nvkm_device_oclass {\n\tint (*ctor)(struct nvkm_device *, const struct nvkm_oclass *,\n\t\t    void *data, u32 size, struct nvkm_object **);\n\tstruct nvkm_sclass base;\n};\n\nextern const struct nvkm_sclass nvkm_udevice_sclass;\n\n \n#define nvdev_printk_(d,l,p,f,a...) do {                                       \\\n\tconst struct nvkm_device *_device = (d);                               \\\n\tif (_device->debug >= (l))                                             \\\n\t\tdev_##p(_device->dev, f, ##a);                                 \\\n} while(0)\n#define nvdev_printk(d,l,p,f,a...) nvdev_printk_((d), NV_DBG_##l, p, f, ##a)\n#define nvdev_fatal(d,f,a...) nvdev_printk((d), FATAL,   crit, f, ##a)\n#define nvdev_error(d,f,a...) nvdev_printk((d), ERROR,    err, f, ##a)\n#define nvdev_warn(d,f,a...)  nvdev_printk((d),  WARN, notice, f, ##a)\n#define nvdev_info(d,f,a...)  nvdev_printk((d),  INFO,   info, f, ##a)\n#define nvdev_debug(d,f,a...) nvdev_printk((d), DEBUG,   info, f, ##a)\n#define nvdev_trace(d,f,a...) nvdev_printk((d), TRACE,   info, f, ##a)\n#define nvdev_spam(d,f,a...)  nvdev_printk((d),  SPAM,    dbg, f, ##a)\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}