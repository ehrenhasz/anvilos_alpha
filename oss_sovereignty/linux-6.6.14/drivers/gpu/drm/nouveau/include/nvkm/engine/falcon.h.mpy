{
  "module_name": "falcon.h",
  "hash_id": "7ac562b3ee41ccf00f77d567d86876bafd3615ec352fe49bae1cfcf4e23b7964",
  "original_prompt": "Ingested from linux-6.6.14/drivers/gpu/drm/nouveau/include/nvkm/engine/falcon.h",
  "human_readable_source": " \n#ifndef __NVKM_FLCNEN_H__\n#define __NVKM_FLCNEN_H__\n#define nvkm_falcon(p) container_of((p), struct nvkm_falcon, engine)\n#include <core/engine.h>\nstruct nvkm_chan;\n\nenum nvkm_falcon_dmaidx {\n\tFALCON_DMAIDX_UCODE\t\t= 0,\n\tFALCON_DMAIDX_VIRT\t\t= 1,\n\tFALCON_DMAIDX_PHYS_VID\t\t= 2,\n\tFALCON_DMAIDX_PHYS_SYS_COH\t= 3,\n\tFALCON_DMAIDX_PHYS_SYS_NCOH\t= 4,\n\tFALCON_SEC2_DMAIDX_UCODE\t= 6,\n};\n\nstruct nvkm_falcon {\n\tconst struct nvkm_falcon_func *func;\n\tstruct nvkm_subdev *owner;\n\tconst char *name;\n\tu32 addr;\n\tu32 addr2;\n\n\tstruct mutex mutex;\n\tstruct mutex dmem_mutex;\n\tbool oneinit;\n\n\tstruct nvkm_subdev *user;\n\n\tu8 version;\n\tu8 secret;\n\tbool debug;\n\n\tstruct nvkm_memory *core;\n\tbool external;\n\n\tstruct {\n\t\tu32 limit;\n\t\tu32 *data;\n\t\tu32  size;\n\t\tu8 ports;\n\t} code;\n\n\tstruct {\n\t\tu32 limit;\n\t\tu32 *data;\n\t\tu32  size;\n\t\tu8 ports;\n\t} data;\n\n\tstruct nvkm_engine engine;\n};\n\nint nvkm_falcon_get(struct nvkm_falcon *, struct nvkm_subdev *);\nvoid nvkm_falcon_put(struct nvkm_falcon *, struct nvkm_subdev *);\n\nint nvkm_falcon_new_(const struct nvkm_falcon_func *, struct nvkm_device *,\n\t\t     enum nvkm_subdev_type, int inst, bool enable, u32 addr, struct nvkm_engine **);\n\nstruct nvkm_falcon_func {\n\tint (*disable)(struct nvkm_falcon *);\n\tint (*enable)(struct nvkm_falcon *);\n\tint (*select)(struct nvkm_falcon *);\n\tu32 addr2;\n\tbool reset_pmc;\n\tint (*reset_eng)(struct nvkm_falcon *);\n\tint (*reset_prep)(struct nvkm_falcon *);\n\tint (*reset_wait_mem_scrubbing)(struct nvkm_falcon *);\n\n\tu32 debug;\n\tvoid (*bind_inst)(struct nvkm_falcon *, int target, u64 addr);\n\tint (*bind_stat)(struct nvkm_falcon *, bool intr);\n\tbool bind_intr;\n\n\tconst struct nvkm_falcon_func_pio *imem_pio;\n\tconst struct nvkm_falcon_func_dma *imem_dma;\n\n\tconst struct nvkm_falcon_func_pio *dmem_pio;\n\tconst struct nvkm_falcon_func_dma *dmem_dma;\n\n\tu32 emem_addr;\n\tconst struct nvkm_falcon_func_pio *emem_pio;\n\n\tstruct {\n\t\tu32 head;\n\t\tu32 tail;\n\t\tu32 stride;\n\t} cmdq, msgq;\n\n\tstruct {\n\t\tu32 *data;\n\t\tu32  size;\n\t} code;\n\tstruct {\n\t\tu32 *data;\n\t\tu32  size;\n\t} data;\n\tvoid (*init)(struct nvkm_falcon *);\n\tvoid (*intr)(struct nvkm_falcon *, struct nvkm_chan *);\n\n\tvoid (*load_imem)(struct nvkm_falcon *, void *, u32, u32, u16, u8, bool);\n\tvoid (*load_dmem)(struct nvkm_falcon *, void *, u32, u32, u8);\n\tvoid (*start)(struct nvkm_falcon *);\n\n\tstruct nvkm_sclass sclass[];\n};\n\nstatic inline u32\nnvkm_falcon_rd32(struct nvkm_falcon *falcon, u32 addr)\n{\n\treturn nvkm_rd32(falcon->owner->device, falcon->addr + addr);\n}\n\nstatic inline void\nnvkm_falcon_wr32(struct nvkm_falcon *falcon, u32 addr, u32 data)\n{\n\tnvkm_wr32(falcon->owner->device, falcon->addr + addr, data);\n}\n\nstatic inline u32\nnvkm_falcon_mask(struct nvkm_falcon *falcon, u32 addr, u32 mask, u32 val)\n{\n\tstruct nvkm_device *device = falcon->owner->device;\n\n\treturn nvkm_mask(device, falcon->addr + addr, mask, val);\n}\n\nvoid nvkm_falcon_load_imem(struct nvkm_falcon *, void *, u32, u32, u16, u8,\n\t\t\t   bool);\nvoid nvkm_falcon_load_dmem(struct nvkm_falcon *, void *, u32, u32, u8);\nvoid nvkm_falcon_start(struct nvkm_falcon *);\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}