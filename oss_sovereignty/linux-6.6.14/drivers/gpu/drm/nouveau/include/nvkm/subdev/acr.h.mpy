{
  "module_name": "acr.h",
  "hash_id": "8e1767e1c2f775d8f90fe53d9b6ab37246a81b8cefee370060f401f6927a0d39",
  "original_prompt": "Ingested from linux-6.6.14/drivers/gpu/drm/nouveau/include/nvkm/subdev/acr.h",
  "human_readable_source": " \n#ifndef __NVKM_ACR_H__\n#define __NVKM_ACR_H__\n#define nvkm_acr(p) container_of((p), struct nvkm_acr, subdev)\n#include <core/subdev.h>\n#include <core/falcon.h>\n\nenum nvkm_acr_lsf_id {\n\tNVKM_ACR_LSF_PMU = 0,\n\tNVKM_ACR_LSF_GSPLITE = 1,\n\tNVKM_ACR_LSF_FECS = 2,\n\tNVKM_ACR_LSF_GPCCS = 3,\n\tNVKM_ACR_LSF_NVDEC = 4,\n\tNVKM_ACR_LSF_SEC2 = 7,\n\tNVKM_ACR_LSF_MINION = 10,\n\tNVKM_ACR_LSF_NUM\n};\n\nstatic inline const char *\nnvkm_acr_lsf_id(enum nvkm_acr_lsf_id id)\n{\n\tswitch (id) {\n\tcase NVKM_ACR_LSF_PMU    : return \"pmu\";\n\tcase NVKM_ACR_LSF_GSPLITE: return \"gsplite\";\n\tcase NVKM_ACR_LSF_FECS   : return \"fecs\";\n\tcase NVKM_ACR_LSF_GPCCS  : return \"gpccs\";\n\tcase NVKM_ACR_LSF_NVDEC  : return \"nvdec\";\n\tcase NVKM_ACR_LSF_SEC2   : return \"sec2\";\n\tcase NVKM_ACR_LSF_MINION : return \"minion\";\n\tdefault:\n\t\treturn \"unknown\";\n\t}\n}\n\nstruct nvkm_acr {\n\tconst struct nvkm_acr_func *func;\n\tstruct nvkm_subdev subdev;\n\n\tstruct list_head hsfw;\n\tstruct list_head lsfw, lsf;\n\n\tu64 managed_falcons;\n\n\tstruct nvkm_memory *wpr;\n\tu64 wpr_start;\n\tu64 wpr_end;\n\tu64 shadow_start;\n\n\tstruct nvkm_memory *inst;\n\tstruct nvkm_vmm *vmm;\n\n\tbool done;\n\tstruct nvkm_acr_lsf *rtos;\n\n\tconst struct firmware *wpr_fw;\n\tbool wpr_comp;\n\tu64 wpr_prev;\n};\n\nbool nvkm_acr_managed_falcon(struct nvkm_device *, enum nvkm_acr_lsf_id);\nint nvkm_acr_bootstrap_falcons(struct nvkm_device *, unsigned long mask);\n\nint gm200_acr_new(struct nvkm_device *, enum nvkm_subdev_type, int inst, struct nvkm_acr **);\nint gm20b_acr_new(struct nvkm_device *, enum nvkm_subdev_type, int inst, struct nvkm_acr **);\nint gp102_acr_new(struct nvkm_device *, enum nvkm_subdev_type, int inst, struct nvkm_acr **);\nint gp108_acr_new(struct nvkm_device *, enum nvkm_subdev_type, int inst, struct nvkm_acr **);\nint gp10b_acr_new(struct nvkm_device *, enum nvkm_subdev_type, int inst, struct nvkm_acr **);\nint gv100_acr_new(struct nvkm_device *, enum nvkm_subdev_type, int inst, struct nvkm_acr **);\nint tu102_acr_new(struct nvkm_device *, enum nvkm_subdev_type, int inst, struct nvkm_acr **);\nint ga102_acr_new(struct nvkm_device *, enum nvkm_subdev_type, int inst, struct nvkm_acr **);\n\nstruct nvkm_acr_lsfw {\n\tconst struct nvkm_acr_lsf_func *func;\n\tstruct nvkm_falcon *falcon;\n\tenum nvkm_acr_lsf_id id;\n\n\tstruct list_head head;\n\n\tstruct nvkm_blob img;\n\n\tconst struct firmware *sig;\n\n\tbool secure_bootloader;\n\tu32 bootloader_size;\n\tu32 bootloader_imem_offset;\n\n\tu32 app_size;\n\tu32 app_start_offset;\n\tu32 app_imem_entry;\n\tu32 app_resident_code_offset;\n\tu32 app_resident_code_size;\n\tu32 app_resident_data_offset;\n\tu32 app_resident_data_size;\n\tu32 app_imem_offset;\n\tu32 app_dmem_offset;\n\n\tu32 ucode_size;\n\tu32 data_size;\n\n\tu32 fuse_ver;\n\tu32 engine_id;\n\tu32 ucode_id;\n\tu32 sig_size;\n\tu32 sig_nr;\n\tu8 *sigs;\n\n\tstruct {\n\t\tu32 lsb;\n\t\tu32 img;\n\t\tu32 bld;\n\t} offset;\n\tu32 bl_data_size;\n};\n\nstruct nvkm_acr_lsf_func {\n \n#define NVKM_ACR_LSF_LOAD_CODE_AT_0                                  0x00000001\n#define NVKM_ACR_LSF_DMACTL_REQ_CTX                                  0x00000004\n#define NVKM_ACR_LSF_FORCE_PRIV_LOAD                                 0x00000008\n\tu32 flags;\n\tu32 bl_entry;\n\tu32 bld_size;\n\tvoid (*bld_write)(struct nvkm_acr *, u32 bld, struct nvkm_acr_lsfw *);\n\tvoid (*bld_patch)(struct nvkm_acr *, u32 bld, s64 adjust);\n\tu64 bootstrap_falcons;\n\tint (*bootstrap_falcon)(struct nvkm_falcon *, enum nvkm_acr_lsf_id);\n\tint (*bootstrap_multiple_falcons)(struct nvkm_falcon *, u32 mask);\n};\n\nint\nnvkm_acr_lsfw_load_sig_image_desc(struct nvkm_subdev *, struct nvkm_falcon *,\n\t\t\t\t  enum nvkm_acr_lsf_id, const char *path,\n\t\t\t\t  int ver, const struct nvkm_acr_lsf_func *);\nint\nnvkm_acr_lsfw_load_sig_image_desc_v1(struct nvkm_subdev *, struct nvkm_falcon *,\n\t\t\t\t     enum nvkm_acr_lsf_id, const char *path,\n\t\t\t\t     int ver, const struct nvkm_acr_lsf_func *);\n\nint\nnvkm_acr_lsfw_load_sig_image_desc_v2(struct nvkm_subdev *, struct nvkm_falcon *,\n\t\t\t\t     enum nvkm_acr_lsf_id, const char *path,\n\t\t\t\t     int ver, const struct nvkm_acr_lsf_func *);\n\nint\nnvkm_acr_lsfw_load_bl_inst_data_sig(struct nvkm_subdev *, struct nvkm_falcon *,\n\t\t\t\t    enum nvkm_acr_lsf_id, const char *path,\n\t\t\t\t    int ver, const struct nvkm_acr_lsf_func *);\n\nint\nnvkm_acr_lsfw_load_bl_sig_net(struct nvkm_subdev *, struct nvkm_falcon *,\n\t\t\t\t    enum nvkm_acr_lsf_id, const char *path,\n\t\t\t\t    int ver, const struct nvkm_acr_lsf_func *,\n\t\t\t\t    const void *, u32, const void *, u32);\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}