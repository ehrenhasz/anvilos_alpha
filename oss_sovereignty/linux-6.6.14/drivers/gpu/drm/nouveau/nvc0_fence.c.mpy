{
  "module_name": "nvc0_fence.c",
  "hash_id": "ae36c8e50df0662acd7a59c61b456eb71db6c4accac2aa8f89de128c61f1a909",
  "original_prompt": "Ingested from linux-6.6.14/drivers/gpu/drm/nouveau/nvc0_fence.c",
  "human_readable_source": " \n#include \"nouveau_drv.h\"\n#include \"nouveau_dma.h\"\n#include \"nouveau_fence.h\"\n\n#include \"nv50_display.h\"\n\n#include <nvif/push906f.h>\n\n#include <nvhw/class/cl906f.h>\n\nstatic int\nnvc0_fence_emit32(struct nouveau_channel *chan, u64 virtual, u32 sequence)\n{\n\tstruct nvif_push *push = chan->chan.push;\n\tint ret = PUSH_WAIT(push, 6);\n\tif (ret == 0) {\n\t\tPUSH_MTHD(push, NV906F, SEMAPHOREA,\n\t\t\t  NVVAL(NV906F, SEMAPHOREA, OFFSET_UPPER, upper_32_bits(virtual)),\n\n\t\t\t\t\tSEMAPHOREB, lower_32_bits(virtual),\n\t\t\t\t\tSEMAPHOREC, sequence,\n\n\t\t\t\t\tSEMAPHORED,\n\t\t\t  NVDEF(NV906F, SEMAPHORED, OPERATION, RELEASE) |\n\t\t\t  NVDEF(NV906F, SEMAPHORED, RELEASE_WFI, EN) |\n\t\t\t  NVDEF(NV906F, SEMAPHORED, RELEASE_SIZE, 16BYTE),\n\n\t\t\t\t\tNON_STALL_INTERRUPT, 0);\n\t\tPUSH_KICK(push);\n\t}\n\treturn ret;\n}\n\nstatic int\nnvc0_fence_sync32(struct nouveau_channel *chan, u64 virtual, u32 sequence)\n{\n\tstruct nvif_push *push = chan->chan.push;\n\tint ret = PUSH_WAIT(push, 5);\n\tif (ret == 0) {\n\t\tPUSH_MTHD(push, NV906F, SEMAPHOREA,\n\t\t\t  NVVAL(NV906F, SEMAPHOREA, OFFSET_UPPER, upper_32_bits(virtual)),\n\n\t\t\t\t\tSEMAPHOREB, lower_32_bits(virtual),\n\t\t\t\t\tSEMAPHOREC, sequence,\n\n\t\t\t\t\tSEMAPHORED,\n\t\t\t  NVDEF(NV906F, SEMAPHORED, OPERATION, ACQ_GEQ) |\n\t\t\t  NVDEF(NV906F, SEMAPHORED, ACQUIRE_SWITCH, ENABLED));\n\t\tPUSH_KICK(push);\n\t}\n\treturn ret;\n}\n\nstatic int\nnvc0_fence_context_new(struct nouveau_channel *chan)\n{\n\tint ret = nv84_fence_context_new(chan);\n\tif (ret == 0) {\n\t\tstruct nv84_fence_chan *fctx = chan->fence;\n\t\tfctx->base.emit32 = nvc0_fence_emit32;\n\t\tfctx->base.sync32 = nvc0_fence_sync32;\n\t}\n\treturn ret;\n}\n\nint\nnvc0_fence_create(struct nouveau_drm *drm)\n{\n\tint ret = nv84_fence_create(drm);\n\tif (ret == 0) {\n\t\tstruct nv84_fence_priv *priv = drm->fence;\n\t\tpriv->base.context_new = nvc0_fence_context_new;\n\t}\n\treturn ret;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}