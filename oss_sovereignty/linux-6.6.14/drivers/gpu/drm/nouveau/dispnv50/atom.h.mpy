{
  "module_name": "atom.h",
  "hash_id": "7a53053eee952d1c0415167ac7aa2d6bf01d2a132995b84a954593cbec9fa7fc",
  "original_prompt": "Ingested from linux-6.6.14/drivers/gpu/drm/nouveau/dispnv50/atom.h",
  "human_readable_source": "#ifndef __NV50_KMS_ATOM_H__\n#define __NV50_KMS_ATOM_H__\n#define nv50_atom(p) container_of((p), struct nv50_atom, state)\n#include <drm/drm_atomic.h>\n#include \"crc.h\"\n\nstruct nouveau_encoder;\n\nstruct nv50_atom {\n\tstruct drm_atomic_state state;\n\n\tstruct list_head outp;\n\tbool lock_core;\n\tbool flush_disable;\n};\n\n#define nv50_head_atom(p) container_of((p), struct nv50_head_atom, state)\n\nstruct nv50_head_atom {\n\tstruct drm_crtc_state state;\n\n\tstruct {\n\t\tu32 mask;\n\t\tu32 owned;\n\t\tu32 olut;\n\t} wndw;\n\n\tstruct {\n\t\tu16 iW;\n\t\tu16 iH;\n\t\tu16 oW;\n\t\tu16 oH;\n\t} view;\n\n\tstruct nv50_head_mode {\n\t\tbool interlace;\n\t\tu32 clock;\n\t\tstruct {\n\t\t\tu16 active;\n\t\t\tu16 synce;\n\t\t\tu16 blanke;\n\t\t\tu16 blanks;\n\t\t} h;\n\t\tstruct {\n\t\t\tu32 active;\n\t\t\tu16 synce;\n\t\t\tu16 blanke;\n\t\t\tu16 blanks;\n\t\t\tu16 blank2s;\n\t\t\tu16 blank2e;\n\t\t\tu16 blankus;\n\t\t} v;\n\t} mode;\n\n\tstruct {\n\t\tbool visible;\n\t\tu32 handle;\n\t\tu64 offset:40;\n\t\tu8 buffer:1;\n\t\tu8 mode:4;\n\t\tu16 size:11;\n\t\tu8 range:2;\n\t\tu8 output_mode:2;\n\t\tvoid (*load)(struct drm_color_lut *, int size, void __iomem *);\n\t} olut;\n\n\tstruct {\n\t\tbool visible;\n\t\tu32 handle;\n\t\tu64 offset:40;\n\t\tu8  format;\n\t\tu8  kind:7;\n\t\tu8  layout:1;\n\t\tu8  blockh:4;\n\t\tu16 blocks:12;\n\t\tu32 pitch:20;\n\t\tu16 x;\n\t\tu16 y;\n\t\tu16 w;\n\t\tu16 h;\n\t} core;\n\n\tstruct {\n\t\tbool visible;\n\t\tu32 handle;\n\t\tu64 offset:40;\n\t\tu8  layout:2;\n\t\tu8  format:8;\n\t} curs;\n\n\tstruct {\n\t\tu8  depth;\n\t\tu8  cpp;\n\t\tu16 x;\n\t\tu16 y;\n\t\tu16 w;\n\t\tu16 h;\n\t} base;\n\n\tstruct {\n\t\tu8 cpp;\n\t} ovly;\n\n\tstruct {\n\t\tbool enable:1;\n\t\tu8 bits:2;\n\t\tu8 mode:4;\n\t} dither;\n\n\tstruct {\n\t\tstruct {\n\t\t\tu16 cos:12;\n\t\t\tu16 sin:12;\n\t\t} sat;\n\t} procamp;\n\n\tstruct {\n\t\tu8 nhsync:1;\n\t\tu8 nvsync:1;\n\t\tu8 depth:4;\n\t\tu8 crc_raster:2;\n\t\tu8 bpc;\n\t} or;\n\n\tstruct nv50_crc_atom crc;\n\n\t \n\tstruct {\n\t\tint pbn;\n\t\tu8 tu:6;\n\t} dp;\n\n\tunion nv50_head_atom_mask {\n\t\tstruct {\n\t\t\tbool olut:1;\n\t\t\tbool core:1;\n\t\t\tbool curs:1;\n\t\t\tbool view:1;\n\t\t\tbool mode:1;\n\t\t\tbool base:1;\n\t\t\tbool ovly:1;\n\t\t\tbool dither:1;\n\t\t\tbool procamp:1;\n\t\t\tbool crc:1;\n\t\t\tbool or:1;\n\t\t};\n\t\tu16 mask;\n\t} set, clr;\n};\n\nstatic inline struct nv50_head_atom *\nnv50_head_atom_get(struct drm_atomic_state *state, struct drm_crtc *crtc)\n{\n\tstruct drm_crtc_state *statec = drm_atomic_get_crtc_state(state, crtc);\n\tif (IS_ERR(statec))\n\t\treturn (void *)statec;\n\treturn nv50_head_atom(statec);\n}\n\nstatic inline struct drm_encoder *\nnv50_head_atom_get_encoder(struct nv50_head_atom *atom)\n{\n\tstruct drm_encoder *encoder;\n\n\t \n\tdrm_for_each_encoder_mask(encoder, atom->state.crtc->dev,\n\t\t\t\t  atom->state.encoder_mask)\n\t\treturn encoder;\n\n\treturn NULL;\n}\n\n#define nv50_wndw_atom(p) container_of((p), struct nv50_wndw_atom, state)\n\nstruct nv50_wndw_atom {\n\tstruct drm_plane_state state;\n\n\tstruct drm_property_blob *ilut;\n\tbool visible;\n\n\tstruct {\n\t\tu32  handle;\n\t\tu16  offset:12;\n\t\tbool awaken:1;\n\t} ntfy;\n\n\tstruct {\n\t\tu32 handle;\n\t\tu16 offset:12;\n\t\tu32 acquire;\n\t\tu32 release;\n\t} sema;\n\n\tstruct {\n\t\tu32 handle;\n\t\tstruct {\n\t\t\tu64 offset:40;\n\t\t\tu8  buffer:1;\n\t\t\tu8  enable:2;\n\t\t\tu8  mode:4;\n\t\t\tu16 size:11;\n\t\t\tu8  range:2;\n\t\t\tu8  output_mode:2;\n\t\t\tvoid (*load)(struct drm_color_lut *, int size,\n\t\t\t\t     void __iomem *);\n\t\t} i;\n\t} xlut;\n\n\tstruct {\n\t\tu32 matrix[12];\n\t\tbool valid;\n\t} csc;\n\n\tstruct {\n\t\tu8  mode:2;\n\t\tu8  interval:4;\n\n\t\tu8  colorspace:2;\n\t\tu8  format;\n\t\tu8  kind:7;\n\t\tu8  layout:1;\n\t\tu8  blockh:4;\n\t\tu16 blocks[3];\n\t\tu32 pitch[3];\n\t\tu16 w;\n\t\tu16 h;\n\n\t\tu32 handle[6];\n\t\tu64 offset[6];\n\t} image;\n\n\tstruct {\n\t\tu16 sx;\n\t\tu16 sy;\n\t\tu16 sw;\n\t\tu16 sh;\n\t\tu16 dw;\n\t\tu16 dh;\n\t} scale;\n\n\tstruct {\n\t\tu16 x;\n\t\tu16 y;\n\t} point;\n\n\tstruct {\n\t\tu8 depth;\n\t\tu8 k1;\n\t\tu8 src_color:4;\n\t\tu8 dst_color:4;\n\t} blend;\n\n\tunion nv50_wndw_atom_mask {\n\t\tstruct {\n\t\t\tbool ntfy:1;\n\t\t\tbool sema:1;\n\t\t\tbool xlut:1;\n\t\t\tbool csc:1;\n\t\t\tbool image:1;\n\t\t\tbool scale:1;\n\t\t\tbool point:1;\n\t\t\tbool blend:1;\n\t\t};\n\t\tu8 mask;\n\t} set, clr;\n};\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}