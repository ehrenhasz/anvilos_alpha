{
  "module_name": "nouveau_dma.h",
  "hash_id": "deee5583e4ae7604bf4d0835d9ffd785b88388687f8e55d55f6cc5b2ba579308",
  "original_prompt": "Ingested from linux-6.6.14/drivers/gpu/drm/nouveau/nouveau_dma.h",
  "human_readable_source": " \n\n#ifndef __NOUVEAU_DMA_H__\n#define __NOUVEAU_DMA_H__\n\n#include \"nouveau_bo.h\"\n#include \"nouveau_chan.h\"\n\nint nouveau_dma_wait(struct nouveau_channel *, int slots, int size);\nvoid nv50_dma_push(struct nouveau_channel *, u64 addr, u32 length,\n\t\t   bool no_prefetch);\n\n \n#define NOUVEAU_DMA_SKIPS (128 / 4)\n\n \n#define NV50_DMA_PUSH_MAX_LENGTH 0x7fffff\n\n \n#define NV50_DMA_IB_MAX ((0x02000 / 8) - 1)\n\n \nenum {\n\tNvDmaFB\t\t= 0x80000002,\n\tNvDmaTT\t\t= 0x80000003,\n\tNvNotify0       = 0x80000006,\n\tNvSema\t\t= 0x8000000f,\n\tNvEvoSema0\t= 0x80000010,\n\tNvEvoSema1\t= 0x80000011,\n};\n\nstatic __must_check inline int\nRING_SPACE(struct nouveau_channel *chan, int size)\n{\n\tint ret;\n\n\tret = nouveau_dma_wait(chan, 1, size);\n\tif (ret)\n\t\treturn ret;\n\n\tchan->dma.free -= size;\n\treturn 0;\n}\n\nstatic inline void\nOUT_RING(struct nouveau_channel *chan, int data)\n{\n\tnouveau_bo_wr32(chan->push.buffer, chan->dma.cur++, data);\n}\n\n#define WRITE_PUT(val) do {                                                    \\\n\tmb();                                                   \\\n\tnouveau_bo_rd32(chan->push.buffer, 0);                                 \\\n\tnvif_wr32(&chan->user, chan->user_put, ((val) << 2) + chan->push.addr);\\\n} while (0)\n\nstatic inline void\nFIRE_RING(struct nouveau_channel *chan)\n{\n\tif (chan->dma.cur == chan->dma.put)\n\t\treturn;\n\tchan->accel_done = true;\n\n\tif (chan->dma.ib_max) {\n\t\tnv50_dma_push(chan, chan->push.addr + (chan->dma.put << 2),\n\t\t\t      (chan->dma.cur - chan->dma.put) << 2, false);\n\t} else {\n\t\tWRITE_PUT(chan->dma.cur);\n\t}\n\n\tchan->dma.put = chan->dma.cur;\n}\n\nstatic inline void\nWIND_RING(struct nouveau_channel *chan)\n{\n\tchan->dma.cur = chan->dma.put;\n}\n\n \n#define NV_SW_DMA_VBLSEM                                             0x0000018c\n#define NV_SW_VBLSEM_OFFSET                                          0x00000400\n#define NV_SW_VBLSEM_RELEASE_VALUE                                   0x00000404\n#define NV_SW_VBLSEM_RELEASE                                         0x00000408\n#define NV_SW_PAGE_FLIP                                              0x00000500\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}