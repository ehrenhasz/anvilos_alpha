{
  "module_name": "pmu.c",
  "hash_id": "e06529810786545832cdb76cdcfaafc9299582dc3ea0b772fd1eac6d6dbf2898",
  "original_prompt": "Ingested from linux-6.6.14/drivers/gpu/drm/nouveau/nvkm/subdev/bios/pmu.c",
  "human_readable_source": " \n#include <subdev/bios.h>\n#include <subdev/bios/bit.h>\n#include <subdev/bios/image.h>\n#include <subdev/bios/pmu.h>\n\nu32\nnvbios_pmuTe(struct nvkm_bios *bios, u8 *ver, u8 *hdr, u8 *cnt, u8 *len)\n{\n\tstruct bit_entry bit_p;\n\tu32 data = 0;\n\n\tif (!bit_entry(bios, 'p', &bit_p)) {\n\t\tif (bit_p.version == 2 && bit_p.length >= 4)\n\t\t\tdata = nvbios_rd32(bios, bit_p.offset + 0x00);\n\t\tif (data) {\n\t\t\t*ver = nvbios_rd08(bios, data + 0x00);  \n\t\t\t*hdr = nvbios_rd08(bios, data + 0x01);\n\t\t\t*len = nvbios_rd08(bios, data + 0x02);\n\t\t\t*cnt = nvbios_rd08(bios, data + 0x03);\n\t\t}\n\t}\n\n\treturn data;\n}\n\nu32\nnvbios_pmuEe(struct nvkm_bios *bios, int idx, u8 *ver, u8 *hdr)\n{\n\tu8  cnt, len;\n\tu32 data = nvbios_pmuTe(bios, ver, hdr, &cnt, &len);\n\tif (data && idx < cnt) {\n\t\tdata = data + *hdr + (idx * len);\n\t\t*hdr = len;\n\t\treturn data;\n\t}\n\treturn 0;\n}\n\nu32\nnvbios_pmuEp(struct nvkm_bios *bios, int idx, u8 *ver, u8 *hdr,\n\t     struct nvbios_pmuE *info)\n{\n\tu32 data = nvbios_pmuEe(bios, idx, ver, hdr);\n\tif (data) {\n\t\tinfo->type = nvbios_rd08(bios, data + 0x00);\n\t\tinfo->data = nvbios_rd32(bios, data + 0x02);\n\t}\n\treturn data;\n}\n\nbool\nnvbios_pmuRm(struct nvkm_bios *bios, u8 type, struct nvbios_pmuR *info)\n{\n\tstruct nvbios_pmuE pmuE;\n\tu8  ver, hdr, idx = 0;\n\tu32 data;\n\tmemset(info, 0x00, sizeof(*info));\n\twhile ((data = nvbios_pmuEp(bios, idx++, &ver, &hdr, &pmuE))) {\n\t\tif (pmuE.type == type && (data = pmuE.data)) {\n\t\t\tinfo->init_addr_pmu = nvbios_rd32(bios, data + 0x08);\n\t\t\tinfo->args_addr_pmu = nvbios_rd32(bios, data + 0x0c);\n\t\t\tinfo->boot_addr     = data + 0x30;\n\t\t\tinfo->boot_addr_pmu = nvbios_rd32(bios, data + 0x10) +\n\t\t\t\t\t      nvbios_rd32(bios, data + 0x18);\n\t\t\tinfo->boot_size     = nvbios_rd32(bios, data + 0x1c) -\n\t\t\t\t\t      nvbios_rd32(bios, data + 0x18);\n\t\t\tinfo->code_addr     = info->boot_addr + info->boot_size;\n\t\t\tinfo->code_addr_pmu = info->boot_addr_pmu +\n\t\t\t\t\t      info->boot_size;\n\t\t\tinfo->code_size     = nvbios_rd32(bios, data + 0x20);\n\t\t\tinfo->data_addr     = data + 0x30 +\n\t\t\t\t\t      nvbios_rd32(bios, data + 0x24);\n\t\t\tinfo->data_addr_pmu = nvbios_rd32(bios, data + 0x28);\n\t\t\tinfo->data_size     = nvbios_rd32(bios, data + 0x2c);\n\t\t\treturn true;\n\t\t}\n\t}\n\treturn false;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}