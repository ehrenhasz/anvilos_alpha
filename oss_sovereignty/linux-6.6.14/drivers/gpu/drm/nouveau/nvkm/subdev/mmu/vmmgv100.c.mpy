{
  "module_name": "vmmgv100.c",
  "hash_id": "24998c078d25cf8825b8e24f7bb9f715556f658bb5f13c0d4199ffec76c5226a",
  "original_prompt": "Ingested from linux-6.6.14/drivers/gpu/drm/nouveau/nvkm/subdev/mmu/vmmgv100.c",
  "human_readable_source": " \n#include \"vmm.h\"\n\n#include <subdev/fb.h>\n#include <subdev/ltc.h>\n\n#include <nvif/ifc00d.h>\n#include <nvif/unpack.h>\n\nint\ngv100_vmm_join(struct nvkm_vmm *vmm, struct nvkm_memory *inst)\n{\n\tu64 data[2], mask;\n\tint ret = gp100_vmm_join(vmm, inst), i;\n\tif (ret)\n\t\treturn ret;\n\n\tnvkm_kmap(inst);\n\tdata[0] = nvkm_ro32(inst, 0x200);\n\tdata[1] = nvkm_ro32(inst, 0x204);\n\tmask = BIT_ULL(0);\n\n\tnvkm_wo32(inst, 0x21c, 0x00000000);\n\n\tfor (i = 0; i < 64; i++) {\n\t\tif (mask & BIT_ULL(i)) {\n\t\t\tnvkm_wo32(inst, 0x2a4 + (i * 0x10), data[1]);\n\t\t\tnvkm_wo32(inst, 0x2a0 + (i * 0x10), data[0]);\n\t\t} else {\n\t\t\tnvkm_wo32(inst, 0x2a4 + (i * 0x10), 0x00000001);\n\t\t\tnvkm_wo32(inst, 0x2a0 + (i * 0x10), 0x00000001);\n\t\t}\n\t\tnvkm_wo32(inst, 0x2a8 + (i * 0x10), 0x00000000);\n\t}\n\n\tnvkm_wo32(inst, 0x298, lower_32_bits(mask));\n\tnvkm_wo32(inst, 0x29c, upper_32_bits(mask));\n\tnvkm_done(inst);\n\treturn 0;\n}\n\nstatic const struct nvkm_vmm_func\ngv100_vmm = {\n\t.join = gv100_vmm_join,\n\t.part = gf100_vmm_part,\n\t.aper = gf100_vmm_aper,\n\t.valid = gp100_vmm_valid,\n\t.flush = gp100_vmm_flush,\n\t.mthd = gp100_vmm_mthd,\n\t.invalidate_pdb = gp100_vmm_invalidate_pdb,\n\t.page = {\n\t\t{ 47, &gp100_vmm_desc_16[4], NVKM_VMM_PAGE_Sxxx },\n\t\t{ 38, &gp100_vmm_desc_16[3], NVKM_VMM_PAGE_Sxxx },\n\t\t{ 29, &gp100_vmm_desc_16[2], NVKM_VMM_PAGE_Sxxx },\n\t\t{ 21, &gp100_vmm_desc_16[1], NVKM_VMM_PAGE_SVxC },\n\t\t{ 16, &gp100_vmm_desc_16[0], NVKM_VMM_PAGE_SVxC },\n\t\t{ 12, &gp100_vmm_desc_12[0], NVKM_VMM_PAGE_SVHx },\n\t\t{}\n\t}\n};\n\nint\ngv100_vmm_new(struct nvkm_mmu *mmu, bool managed, u64 addr, u64 size,\n\t      void *argv, u32 argc, struct lock_class_key *key,\n\t      const char *name, struct nvkm_vmm **pvmm)\n{\n\treturn gp100_vmm_new_(&gv100_vmm, mmu, managed, addr, size,\n\t\t\t      argv, argc, key, name, pvmm);\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}