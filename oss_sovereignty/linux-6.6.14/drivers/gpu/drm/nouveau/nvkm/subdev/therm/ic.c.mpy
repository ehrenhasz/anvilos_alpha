{
  "module_name": "ic.c",
  "hash_id": "87341e6355fb79ef6111f93eab39670d9bc85f1845413e16927967eaa0f1e12d",
  "original_prompt": "Ingested from linux-6.6.14/drivers/gpu/drm/nouveau/nvkm/subdev/therm/ic.c",
  "human_readable_source": " \n#include \"priv.h\"\n\n#include <subdev/bios/extdev.h>\n#include <subdev/i2c.h>\n\nstatic bool\nprobe_monitoring_device(struct nvkm_i2c_bus *bus,\n\t\t\tstruct i2c_board_info *info, void *data)\n{\n\tstruct nvkm_therm *therm = data;\n\tstruct nvbios_therm_sensor *sensor = &therm->bios_sensor;\n\tstruct i2c_client *client;\n\n\trequest_module(\"%s%s\", I2C_MODULE_PREFIX, info->type);\n\n\tclient = i2c_new_client_device(&bus->i2c, info);\n\tif (IS_ERR(client))\n\t\treturn false;\n\n\tif (!client->dev.driver ||\n\t    to_i2c_driver(client->dev.driver)->detect(client, info)) {\n\t\ti2c_unregister_device(client);\n\t\treturn false;\n\t}\n\n\tnvkm_debug(&therm->subdev,\n\t\t   \"Found an %s at address 0x%x (controlled by lm_sensors, \"\n\t\t   \"temp offset %+i C)\\n\",\n\t\t   info->type, info->addr, sensor->offset_constant);\n\ttherm->ic = client;\n\treturn true;\n}\n\nstatic struct nvkm_i2c_bus_probe\nnv_board_infos[] = {\n\t{ { I2C_BOARD_INFO(\"w83l785ts\", 0x2d) }, 0 },\n\t{ { I2C_BOARD_INFO(\"w83781d\", 0x2d) }, 0  },\n\t{ { I2C_BOARD_INFO(\"adt7473\", 0x2e) }, 40  },\n\t{ { I2C_BOARD_INFO(\"adt7473\", 0x2d) }, 40  },\n\t{ { I2C_BOARD_INFO(\"adt7473\", 0x2c) }, 40  },\n\t{ { I2C_BOARD_INFO(\"f75375\", 0x2e) }, 0  },\n\t{ { I2C_BOARD_INFO(\"lm99\", 0x4c) }, 0  },\n\t{ { I2C_BOARD_INFO(\"lm90\", 0x4c) }, 0  },\n\t{ { I2C_BOARD_INFO(\"lm90\", 0x4d) }, 0  },\n\t{ { I2C_BOARD_INFO(\"adm1021\", 0x18) }, 0  },\n\t{ { I2C_BOARD_INFO(\"adm1021\", 0x19) }, 0  },\n\t{ { I2C_BOARD_INFO(\"adm1021\", 0x1a) }, 0  },\n\t{ { I2C_BOARD_INFO(\"adm1021\", 0x29) }, 0  },\n\t{ { I2C_BOARD_INFO(\"adm1021\", 0x2a) }, 0  },\n\t{ { I2C_BOARD_INFO(\"adm1021\", 0x2b) }, 0  },\n\t{ { I2C_BOARD_INFO(\"adm1021\", 0x4c) }, 0  },\n\t{ { I2C_BOARD_INFO(\"adm1021\", 0x4d) }, 0  },\n\t{ { I2C_BOARD_INFO(\"adm1021\", 0x4e) }, 0  },\n\t{ { I2C_BOARD_INFO(\"lm63\", 0x18) }, 0  },\n\t{ { I2C_BOARD_INFO(\"lm63\", 0x4e) }, 0  },\n\t{ }\n};\n\nvoid\nnvkm_therm_ic_ctor(struct nvkm_therm *therm)\n{\n\tstruct nvkm_device *device = therm->subdev.device;\n\tstruct nvkm_bios *bios = device->bios;\n\tstruct nvkm_i2c *i2c = device->i2c;\n\tstruct nvkm_i2c_bus *bus;\n\tstruct nvbios_extdev_func extdev_entry;\n\n\tbus = nvkm_i2c_bus_find(i2c, NVKM_I2C_BUS_PRI);\n\tif (!bus)\n\t\treturn;\n\n\tif (!nvbios_extdev_find(bios, NVBIOS_EXTDEV_LM89, &extdev_entry)) {\n\t\tstruct nvkm_i2c_bus_probe board[] = {\n\t\t  { { I2C_BOARD_INFO(\"lm90\", extdev_entry.addr >> 1) }, 0},\n\t\t  { }\n\t\t};\n\n\t\tnvkm_i2c_bus_probe(bus, \"monitoring device\", board,\n\t\t\t\t   probe_monitoring_device, therm);\n\t\tif (therm->ic)\n\t\t\treturn;\n\t}\n\n\tif (!nvbios_extdev_find(bios, NVBIOS_EXTDEV_ADT7473, &extdev_entry)) {\n\t\tstruct nvkm_i2c_bus_probe board[] = {\n\t\t  { { I2C_BOARD_INFO(\"adt7473\", extdev_entry.addr >> 1) }, 20 },\n\t\t  { }\n\t\t};\n\n\t\tnvkm_i2c_bus_probe(bus, \"monitoring device\", board,\n\t\t\t\t   probe_monitoring_device, therm);\n\t\tif (therm->ic)\n\t\t\treturn;\n\t}\n\n\tif (nvbios_extdev_skip_probe(bios))\n\t\treturn;\n\n\t \n\tnvkm_i2c_bus_probe(bus, \"monitoring device\", nv_board_infos,\n\t\t\t   probe_monitoring_device, therm);\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}