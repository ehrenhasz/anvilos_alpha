{
  "module_name": "shadowof.c",
  "hash_id": "32ec22a8d724851517ffa8bb5d1e7999e336012e41cff13fc3574bafb5164338",
  "original_prompt": "Ingested from linux-6.6.14/drivers/gpu/drm/nouveau/nvkm/subdev/bios/shadowof.c",
  "human_readable_source": " \n#include \"priv.h\"\n\n#include <core/pci.h>\n\n#if defined(__powerpc__)\nstruct priv {\n\tconst void __iomem *data;\n\tint size;\n};\n\nstatic u32\nof_read(void *data, u32 offset, u32 length, struct nvkm_bios *bios)\n{\n\tstruct priv *priv = data;\n\tif (offset < priv->size) {\n\t\tlength = min_t(u32, length, priv->size - offset);\n\t\tmemcpy_fromio(bios->data + offset, priv->data + offset, length);\n\t\treturn length;\n\t}\n\treturn 0;\n}\n\nstatic u32\nof_size(void *data)\n{\n\tstruct priv *priv = data;\n\treturn priv->size;\n}\n\nstatic void *\nof_init(struct nvkm_bios *bios, const char *name)\n{\n\tstruct nvkm_device *device = bios->subdev.device;\n\tstruct pci_dev *pdev = device->func->pci(device)->pdev;\n\tstruct device_node *dn;\n\tstruct priv *priv;\n\tif (!(dn = pci_device_to_OF_node(pdev)))\n\t\treturn ERR_PTR(-ENODEV);\n\tif (!(priv = kzalloc(sizeof(*priv), GFP_KERNEL)))\n\t\treturn ERR_PTR(-ENOMEM);\n\tif ((priv->data = of_get_property(dn, \"NVDA,BMP\", &priv->size)))\n\t\treturn priv;\n\tkfree(priv);\n\treturn ERR_PTR(-EINVAL);\n}\n\nconst struct nvbios_source\nnvbios_of = {\n\t.name = \"OpenFirmware\",\n\t.init = of_init,\n\t.fini = (void(*)(void *))kfree,\n\t.read = of_read,\n\t.size = of_size,\n\t.rw = false,\n\t.ignore_checksum = true,\n\t.no_pcir = true,\n};\n#else\nconst struct nvbios_source\nnvbios_of = {\n};\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}