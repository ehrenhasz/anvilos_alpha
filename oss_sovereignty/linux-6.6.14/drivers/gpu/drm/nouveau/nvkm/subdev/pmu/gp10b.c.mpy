{
  "module_name": "gp10b.c",
  "hash_id": "5592e13b51ff2cd703cc977747314bf8ed54fb61c453a3ae5243314e862d21c0",
  "original_prompt": "Ingested from linux-6.6.14/drivers/gpu/drm/nouveau/nvkm/subdev/pmu/gp10b.c",
  "human_readable_source": " \n#include \"priv.h\"\n\n#include <subdev/acr.h>\n\n#include <nvfw/flcn.h>\n#include <nvfw/pmu.h>\n\nstatic int\ngp10b_pmu_acr_bootstrap_multiple_falcons_cb(void *priv,\n\t\t\t\t\t    struct nvfw_falcon_msg *hdr)\n{\n\tstruct nv_pmu_acr_bootstrap_multiple_falcons_msg *msg =\n\t\tcontainer_of(hdr, typeof(*msg), msg.hdr);\n\treturn msg->falcon_mask;\n}\nstatic int\ngp10b_pmu_acr_bootstrap_multiple_falcons(struct nvkm_falcon *falcon, u32 mask)\n{\n\tstruct nvkm_pmu *pmu = container_of(falcon, typeof(*pmu), falcon);\n\tstruct nv_pmu_acr_bootstrap_multiple_falcons_cmd cmd = {\n\t\t.cmd.hdr.unit_id = NV_PMU_UNIT_ACR,\n\t\t.cmd.hdr.size = sizeof(cmd),\n\t\t.cmd.cmd_type = NV_PMU_ACR_CMD_BOOTSTRAP_MULTIPLE_FALCONS,\n\t\t.flags = NV_PMU_ACR_BOOTSTRAP_MULTIPLE_FALCONS_FLAGS_RESET_YES,\n\t\t.falcon_mask = mask,\n\t\t.wpr_lo = 0,  \n\t\t.wpr_hi = 0,  \n\t};\n\tint ret;\n\n\tret = nvkm_falcon_cmdq_send(pmu->hpq, &cmd.cmd.hdr,\n\t\t\t\t    gp10b_pmu_acr_bootstrap_multiple_falcons_cb,\n\t\t\t\t    &pmu->subdev, msecs_to_jiffies(1000));\n\tif (ret >= 0) {\n\t\tif (ret != cmd.falcon_mask)\n\t\t\tret = -EIO;\n\t\telse\n\t\t\tret = 0;\n\t}\n\n\treturn ret;\n}\n\nstatic const struct nvkm_acr_lsf_func\ngp10b_pmu_acr = {\n\t.flags = NVKM_ACR_LSF_DMACTL_REQ_CTX,\n\t.bld_size = sizeof(struct loader_config),\n\t.bld_write = gm20b_pmu_acr_bld_write,\n\t.bld_patch = gm20b_pmu_acr_bld_patch,\n\t.bootstrap_falcons = BIT_ULL(NVKM_ACR_LSF_PMU) |\n\t\t\t     BIT_ULL(NVKM_ACR_LSF_FECS) |\n\t\t\t     BIT_ULL(NVKM_ACR_LSF_GPCCS),\n\t.bootstrap_falcon = gm20b_pmu_acr_bootstrap_falcon,\n\t.bootstrap_multiple_falcons = gp10b_pmu_acr_bootstrap_multiple_falcons,\n};\n\n#if IS_ENABLED(CONFIG_ARCH_TEGRA_210_SOC)\nMODULE_FIRMWARE(\"nvidia/gp10b/pmu/desc.bin\");\nMODULE_FIRMWARE(\"nvidia/gp10b/pmu/image.bin\");\nMODULE_FIRMWARE(\"nvidia/gp10b/pmu/sig.bin\");\n#endif\n\nstatic const struct nvkm_pmu_fwif\ngp10b_pmu_fwif[] = {\n\t{  0, gm20b_pmu_load, &gm20b_pmu, &gp10b_pmu_acr },\n\t{ -1, gm200_pmu_nofw, &gm20b_pmu },\n\t{}\n};\n\nint\ngp10b_pmu_new(struct nvkm_device *device, enum nvkm_subdev_type type, int inst,\n\t      struct nvkm_pmu **ppmu)\n{\n\treturn nvkm_pmu_new_(gp10b_pmu_fwif, device, type, inst, ppmu);\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}