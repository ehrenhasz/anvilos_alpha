{
  "module_name": "gk20a.h",
  "hash_id": "7f38996526ef9f90cf32349bb6a184dcc0bf138c97765866759f4602d7641a2e",
  "original_prompt": "Ingested from linux-6.6.14/drivers/gpu/drm/nouveau/nvkm/subdev/clk/gk20a.h",
  "human_readable_source": " \n\n#ifndef __NVKM_CLK_GK20A_H__\n#define __NVKM_CLK_GK20A_H__\n\n#define KHZ (1000)\n#define MHZ (KHZ * 1000)\n\n#define MASK(w)\t((1 << (w)) - 1)\n\n#define GK20A_CLK_GPC_MDIV 1000\n\n#define SYS_GPCPLL_CFG_BASE\t0x00137000\n#define GPCPLL_CFG\t\t(SYS_GPCPLL_CFG_BASE + 0)\n#define GPCPLL_CFG_ENABLE\tBIT(0)\n#define GPCPLL_CFG_IDDQ\t\tBIT(1)\n#define GPCPLL_CFG_LOCK_DET_OFF\tBIT(4)\n#define GPCPLL_CFG_LOCK\t\tBIT(17)\n\n#define GPCPLL_CFG2\t\t(SYS_GPCPLL_CFG_BASE + 0xc)\n#define GPCPLL_CFG2_SETUP2_SHIFT\t16\n#define GPCPLL_CFG2_PLL_STEPA_SHIFT\t24\n\n#define GPCPLL_CFG3\t\t\t(SYS_GPCPLL_CFG_BASE + 0x18)\n#define GPCPLL_CFG3_VCO_CTRL_SHIFT\t\t0\n#define GPCPLL_CFG3_VCO_CTRL_WIDTH\t\t9\n#define GPCPLL_CFG3_VCO_CTRL_MASK\t\t\\\n\t(MASK(GPCPLL_CFG3_VCO_CTRL_WIDTH) << GPCPLL_CFG3_VCO_CTRL_SHIFT)\n#define GPCPLL_CFG3_PLL_STEPB_SHIFT\t\t16\n#define GPCPLL_CFG3_PLL_STEPB_WIDTH\t\t8\n\n#define GPCPLL_COEFF\t\t(SYS_GPCPLL_CFG_BASE + 4)\n#define GPCPLL_COEFF_M_SHIFT\t0\n#define GPCPLL_COEFF_M_WIDTH\t8\n#define GPCPLL_COEFF_N_SHIFT\t8\n#define GPCPLL_COEFF_N_WIDTH\t8\n#define GPCPLL_COEFF_N_MASK\t\\\n\t(MASK(GPCPLL_COEFF_N_WIDTH) << GPCPLL_COEFF_N_SHIFT)\n#define GPCPLL_COEFF_P_SHIFT\t16\n#define GPCPLL_COEFF_P_WIDTH\t6\n\n#define GPCPLL_NDIV_SLOWDOWN\t\t\t(SYS_GPCPLL_CFG_BASE + 0x1c)\n#define GPCPLL_NDIV_SLOWDOWN_NDIV_LO_SHIFT\t0\n#define GPCPLL_NDIV_SLOWDOWN_NDIV_MID_SHIFT\t8\n#define GPCPLL_NDIV_SLOWDOWN_STEP_SIZE_LO2MID_SHIFT\t16\n#define GPCPLL_NDIV_SLOWDOWN_SLOWDOWN_USING_PLL_SHIFT\t22\n#define GPCPLL_NDIV_SLOWDOWN_EN_DYNRAMP_SHIFT\t31\n\n#define GPC_BCAST_GPCPLL_CFG_BASE\t\t0x00132800\n#define GPC_BCAST_NDIV_SLOWDOWN_DEBUG\t(GPC_BCAST_GPCPLL_CFG_BASE + 0xa0)\n#define GPC_BCAST_NDIV_SLOWDOWN_DEBUG_PLL_DYNRAMP_DONE_SYNCED_SHIFT\t24\n#define GPC_BCAST_NDIV_SLOWDOWN_DEBUG_PLL_DYNRAMP_DONE_SYNCED_MASK \\\n\t(0x1 << GPC_BCAST_NDIV_SLOWDOWN_DEBUG_PLL_DYNRAMP_DONE_SYNCED_SHIFT)\n\n#define SEL_VCO\t\t\t\t(SYS_GPCPLL_CFG_BASE + 0x100)\n#define SEL_VCO_GPC2CLK_OUT_SHIFT\t0\n\n#define GPC2CLK_OUT\t\t\t(SYS_GPCPLL_CFG_BASE + 0x250)\n#define GPC2CLK_OUT_SDIV14_INDIV4_WIDTH\t1\n#define GPC2CLK_OUT_SDIV14_INDIV4_SHIFT\t31\n#define GPC2CLK_OUT_SDIV14_INDIV4_MODE\t1\n#define GPC2CLK_OUT_VCODIV_WIDTH\t6\n#define GPC2CLK_OUT_VCODIV_SHIFT\t8\n#define GPC2CLK_OUT_VCODIV1\t\t0\n#define GPC2CLK_OUT_VCODIV2\t\t2\n#define GPC2CLK_OUT_VCODIV_MASK\t\t(MASK(GPC2CLK_OUT_VCODIV_WIDTH) << \\\n\t\t\t\t\tGPC2CLK_OUT_VCODIV_SHIFT)\n#define GPC2CLK_OUT_BYPDIV_WIDTH\t6\n#define GPC2CLK_OUT_BYPDIV_SHIFT\t0\n#define GPC2CLK_OUT_BYPDIV31\t\t0x3c\n#define GPC2CLK_OUT_INIT_MASK\t((MASK(GPC2CLK_OUT_SDIV14_INDIV4_WIDTH) << \\\n\t\tGPC2CLK_OUT_SDIV14_INDIV4_SHIFT)\\\n\t\t| (MASK(GPC2CLK_OUT_VCODIV_WIDTH) << GPC2CLK_OUT_VCODIV_SHIFT)\\\n\t\t| (MASK(GPC2CLK_OUT_BYPDIV_WIDTH) << GPC2CLK_OUT_BYPDIV_SHIFT))\n#define GPC2CLK_OUT_INIT_VAL\t((GPC2CLK_OUT_SDIV14_INDIV4_MODE << \\\n\t\tGPC2CLK_OUT_SDIV14_INDIV4_SHIFT) \\\n\t\t| (GPC2CLK_OUT_VCODIV1 << GPC2CLK_OUT_VCODIV_SHIFT) \\\n\t\t| (GPC2CLK_OUT_BYPDIV31 << GPC2CLK_OUT_BYPDIV_SHIFT))\n\n \nstruct gk20a_clk_pllg_params {\n\tu32 min_vco, max_vco;\n\tu32 min_u, max_u;\n\tu32 min_m, max_m;\n\tu32 min_n, max_n;\n\tu32 min_pl, max_pl;\n};\n\nstruct gk20a_pll {\n\tu32 m;\n\tu32 n;\n\tu32 pl;\n};\n\nstruct gk20a_clk {\n\tstruct nvkm_clk base;\n\tconst struct gk20a_clk_pllg_params *params;\n\tstruct gk20a_pll pll;\n\tu32 parent_rate;\n\n\tu32 (*div_to_pl)(u32);\n\tu32 (*pl_to_div)(u32);\n};\n#define gk20a_clk(p) container_of((p), struct gk20a_clk, base)\n\nu32 gk20a_pllg_calc_rate(struct gk20a_clk *, struct gk20a_pll *);\nint gk20a_pllg_calc_mnp(struct gk20a_clk *, unsigned long, struct gk20a_pll *);\nvoid gk20a_pllg_read_mnp(struct gk20a_clk *, struct gk20a_pll *);\nvoid gk20a_pllg_write_mnp(struct gk20a_clk *, const struct gk20a_pll *);\n\nstatic inline bool\ngk20a_pllg_is_enabled(struct gk20a_clk *clk)\n{\n\tstruct nvkm_device *device = clk->base.subdev.device;\n\tu32 val;\n\n\tval = nvkm_rd32(device, GPCPLL_CFG);\n\treturn val & GPCPLL_CFG_ENABLE;\n}\n\nstatic inline u32\ngk20a_pllg_n_lo(struct gk20a_clk *clk, struct gk20a_pll *pll)\n{\n\treturn DIV_ROUND_UP(pll->m * clk->params->min_vco,\n\t\t\t    clk->parent_rate / KHZ);\n}\n\nint gk20a_clk_ctor(struct nvkm_device *, enum nvkm_subdev_type, int, const struct nvkm_clk_func *,\n\t\t   const struct gk20a_clk_pllg_params *, struct gk20a_clk *);\nvoid gk20a_clk_fini(struct nvkm_clk *);\nint gk20a_clk_read(struct nvkm_clk *, enum nv_clk_src);\nint gk20a_clk_calc(struct nvkm_clk *, struct nvkm_cstate *);\nint gk20a_clk_prog(struct nvkm_clk *);\nvoid gk20a_clk_tidy(struct nvkm_clk *);\n\nint gk20a_clk_setup_slide(struct gk20a_clk *);\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}