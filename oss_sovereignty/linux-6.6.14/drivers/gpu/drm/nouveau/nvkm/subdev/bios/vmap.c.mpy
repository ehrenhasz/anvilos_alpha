{
  "module_name": "vmap.c",
  "hash_id": "672174f4fff662034d31f9b17b0b7a55e9ed58d3e63654eec00d0d1c78367178",
  "original_prompt": "Ingested from linux-6.6.14/drivers/gpu/drm/nouveau/nvkm/subdev/bios/vmap.c",
  "human_readable_source": " \n#include <subdev/bios.h>\n#include <subdev/bios/bit.h>\n#include <subdev/bios/vmap.h>\n\nu32\nnvbios_vmap_table(struct nvkm_bios *bios, u8 *ver, u8 *hdr, u8 *cnt, u8 *len)\n{\n\tstruct bit_entry bit_P;\n\tu32 vmap = 0;\n\n\tif (!bit_entry(bios, 'P', &bit_P)) {\n\t\tif (bit_P.version == 2) {\n\t\t\tvmap = nvbios_rd32(bios, bit_P.offset + 0x20);\n\t\t\tif (vmap) {\n\t\t\t\t*ver = nvbios_rd08(bios, vmap + 0);\n\t\t\t\tswitch (*ver) {\n\t\t\t\tcase 0x10:\n\t\t\t\tcase 0x20:\n\t\t\t\t\t*hdr = nvbios_rd08(bios, vmap + 1);\n\t\t\t\t\t*cnt = nvbios_rd08(bios, vmap + 3);\n\t\t\t\t\t*len = nvbios_rd08(bios, vmap + 2);\n\t\t\t\t\treturn vmap;\n\t\t\t\tdefault:\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\treturn 0;\n}\n\nu32\nnvbios_vmap_parse(struct nvkm_bios *bios, u8 *ver, u8 *hdr, u8 *cnt, u8 *len,\n\t\t  struct nvbios_vmap *info)\n{\n\tu32 vmap = nvbios_vmap_table(bios, ver, hdr, cnt, len);\n\tmemset(info, 0x00, sizeof(*info));\n\tswitch (!!vmap * *ver) {\n\tcase 0x10:\n\t\tinfo->max0 = 0xff;\n\t\tinfo->max1 = 0xff;\n\t\tinfo->max2 = 0xff;\n\t\tbreak;\n\tcase 0x20:\n\t\tinfo->max0 = nvbios_rd08(bios, vmap + 0x7);\n\t\tinfo->max1 = nvbios_rd08(bios, vmap + 0x8);\n\t\tif (*len >= 0xc)\n\t\t\tinfo->max2 = nvbios_rd08(bios, vmap + 0xc);\n\t\telse\n\t\t\tinfo->max2 = 0xff;\n\t\tbreak;\n\t}\n\treturn vmap;\n}\n\nu32\nnvbios_vmap_entry(struct nvkm_bios *bios, int idx, u8 *ver, u8 *len)\n{\n\tu8  hdr, cnt;\n\tu32 vmap = nvbios_vmap_table(bios, ver, &hdr, &cnt, len);\n\tif (vmap && idx < cnt) {\n\t\tvmap = vmap + hdr + (idx * *len);\n\t\treturn vmap;\n\t}\n\treturn 0;\n}\n\nu32\nnvbios_vmap_entry_parse(struct nvkm_bios *bios, int idx, u8 *ver, u8 *len,\n\t\t\tstruct nvbios_vmap_entry *info)\n{\n\tu32 vmap = nvbios_vmap_entry(bios, idx, ver, len);\n\tmemset(info, 0x00, sizeof(*info));\n\tswitch (!!vmap * *ver) {\n\tcase 0x10:\n\t\tinfo->link   = 0xff;\n\t\tinfo->min    = nvbios_rd32(bios, vmap + 0x00);\n\t\tinfo->max    = nvbios_rd32(bios, vmap + 0x04);\n\t\tinfo->arg[0] = nvbios_rd32(bios, vmap + 0x08);\n\t\tinfo->arg[1] = nvbios_rd32(bios, vmap + 0x0c);\n\t\tinfo->arg[2] = nvbios_rd32(bios, vmap + 0x10);\n\t\tbreak;\n\tcase 0x20:\n\t\tinfo->mode   = nvbios_rd08(bios, vmap + 0x00);\n\t\tinfo->link   = nvbios_rd08(bios, vmap + 0x01);\n\t\tinfo->min    = nvbios_rd32(bios, vmap + 0x02);\n\t\tinfo->max    = nvbios_rd32(bios, vmap + 0x06);\n\t\tinfo->arg[0] = nvbios_rd32(bios, vmap + 0x0a);\n\t\tinfo->arg[1] = nvbios_rd32(bios, vmap + 0x0e);\n\t\tinfo->arg[2] = nvbios_rd32(bios, vmap + 0x12);\n\t\tinfo->arg[3] = nvbios_rd32(bios, vmap + 0x16);\n\t\tinfo->arg[4] = nvbios_rd32(bios, vmap + 0x1a);\n\t\tinfo->arg[5] = nvbios_rd32(bios, vmap + 0x1e);\n\t\tbreak;\n\t}\n\treturn vmap;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}