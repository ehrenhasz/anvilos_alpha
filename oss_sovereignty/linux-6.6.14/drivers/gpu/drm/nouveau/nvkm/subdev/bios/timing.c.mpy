{
  "module_name": "timing.c",
  "hash_id": "bac06b82553dfee8d9877e18ae381e88468272f70e4a4d4e70ca9cced413b9f1",
  "original_prompt": "Ingested from linux-6.6.14/drivers/gpu/drm/nouveau/nvkm/subdev/bios/timing.c",
  "human_readable_source": " \n#include <subdev/bios.h>\n#include <subdev/bios/bit.h>\n#include <subdev/bios/timing.h>\n\nu32\nnvbios_timingTe(struct nvkm_bios *bios,\n\t\tu8 *ver, u8 *hdr, u8 *cnt, u8 *len, u8 *snr, u8 *ssz)\n{\n\tstruct bit_entry bit_P;\n\tu32 timing = 0;\n\n\tif (!bit_entry(bios, 'P', &bit_P)) {\n\t\tif (bit_P.version == 1)\n\t\t\ttiming = nvbios_rd32(bios, bit_P.offset + 4);\n\t\telse\n\t\tif (bit_P.version == 2)\n\t\t\ttiming = nvbios_rd32(bios, bit_P.offset + 8);\n\n\t\tif (timing) {\n\t\t\t*ver = nvbios_rd08(bios, timing + 0);\n\t\t\tswitch (*ver) {\n\t\t\tcase 0x10:\n\t\t\t\t*hdr = nvbios_rd08(bios, timing + 1);\n\t\t\t\t*cnt = nvbios_rd08(bios, timing + 2);\n\t\t\t\t*len = nvbios_rd08(bios, timing + 3);\n\t\t\t\t*snr = 0;\n\t\t\t\t*ssz = 0;\n\t\t\t\treturn timing;\n\t\t\tcase 0x20:\n\t\t\t\t*hdr = nvbios_rd08(bios, timing + 1);\n\t\t\t\t*cnt = nvbios_rd08(bios, timing + 5);\n\t\t\t\t*len = nvbios_rd08(bios, timing + 2);\n\t\t\t\t*snr = nvbios_rd08(bios, timing + 4);\n\t\t\t\t*ssz = nvbios_rd08(bios, timing + 3);\n\t\t\t\treturn timing;\n\t\t\tdefault:\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\treturn 0;\n}\n\nu32\nnvbios_timingEe(struct nvkm_bios *bios, int idx,\n\t\tu8 *ver, u8 *hdr, u8 *cnt, u8 *len)\n{\n\tu8  snr, ssz;\n\tu32 timing = nvbios_timingTe(bios, ver, hdr, cnt, len, &snr, &ssz);\n\tif (timing && idx < *cnt) {\n\t\ttiming += *hdr + idx * (*len + (snr * ssz));\n\t\t*hdr = *len;\n\t\t*cnt = snr;\n\t\t*len = ssz;\n\t\treturn timing;\n\t}\n\treturn 0;\n}\n\nu32\nnvbios_timingEp(struct nvkm_bios *bios, int idx,\n\t\tu8 *ver, u8 *hdr, u8 *cnt, u8 *len, struct nvbios_ramcfg *p)\n{\n\tu32 data = nvbios_timingEe(bios, idx, ver, hdr, cnt, len), temp;\n\tp->timing_ver = *ver;\n\tp->timing_hdr = *hdr;\n\tswitch (!!data * *ver) {\n\tcase 0x10:\n\t\tp->timing_10_WR    = nvbios_rd08(bios, data + 0x00);\n\t\tp->timing_10_WTR   = nvbios_rd08(bios, data + 0x01);\n\t\tp->timing_10_CL    = nvbios_rd08(bios, data + 0x02);\n\t\tp->timing_10_RC    = nvbios_rd08(bios, data + 0x03);\n\t\tp->timing_10_RFC   = nvbios_rd08(bios, data + 0x05);\n\t\tp->timing_10_RAS   = nvbios_rd08(bios, data + 0x07);\n\t\tp->timing_10_RP    = nvbios_rd08(bios, data + 0x09);\n\t\tp->timing_10_RCDRD = nvbios_rd08(bios, data + 0x0a);\n\t\tp->timing_10_RCDWR = nvbios_rd08(bios, data + 0x0b);\n\t\tp->timing_10_RRD   = nvbios_rd08(bios, data + 0x0c);\n\t\tp->timing_10_13    = nvbios_rd08(bios, data + 0x0d);\n\t\tp->timing_10_ODT   = nvbios_rd08(bios, data + 0x0e) & 0x07;\n\t\tif (p->ramcfg_ver >= 0x10)\n\t\t\tp->ramcfg_RON = nvbios_rd08(bios, data + 0x0e) & 0x07;\n\n\t\tp->timing_10_24  = 0xff;\n\t\tp->timing_10_21  = 0;\n\t\tp->timing_10_20  = 0;\n\t\tp->timing_10_CWL = 0;\n\t\tp->timing_10_18  = 0;\n\t\tp->timing_10_16  = 0;\n\n\t\tswitch (min_t(u8, *hdr, 25)) {\n\t\tcase 25:\n\t\t\tp->timing_10_24  = nvbios_rd08(bios, data + 0x18);\n\t\t\tfallthrough;\n\t\tcase 24:\n\t\tcase 23:\n\t\tcase 22:\n\t\t\tp->timing_10_21  = nvbios_rd08(bios, data + 0x15);\n\t\t\tfallthrough;\n\t\tcase 21:\n\t\t\tp->timing_10_20  = nvbios_rd08(bios, data + 0x14);\n\t\t\tfallthrough;\n\t\tcase 20:\n\t\t\tp->timing_10_CWL = nvbios_rd08(bios, data + 0x13);\n\t\t\tfallthrough;\n\t\tcase 19:\n\t\t\tp->timing_10_18  = nvbios_rd08(bios, data + 0x12);\n\t\t\tfallthrough;\n\t\tcase 18:\n\t\tcase 17:\n\t\t\tp->timing_10_16  = nvbios_rd08(bios, data + 0x10);\n\t\t}\n\n\t\tbreak;\n\tcase 0x20:\n\t\tp->timing[0] = nvbios_rd32(bios, data + 0x00);\n\t\tp->timing[1] = nvbios_rd32(bios, data + 0x04);\n\t\tp->timing[2] = nvbios_rd32(bios, data + 0x08);\n\t\tp->timing[3] = nvbios_rd32(bios, data + 0x0c);\n\t\tp->timing[4] = nvbios_rd32(bios, data + 0x10);\n\t\tp->timing[5] = nvbios_rd32(bios, data + 0x14);\n\t\tp->timing[6] = nvbios_rd32(bios, data + 0x18);\n\t\tp->timing[7] = nvbios_rd32(bios, data + 0x1c);\n\t\tp->timing[8] = nvbios_rd32(bios, data + 0x20);\n\t\tp->timing[9] = nvbios_rd32(bios, data + 0x24);\n\t\tp->timing[10] = nvbios_rd32(bios, data + 0x28);\n\t\tp->timing_20_2e_03 = (nvbios_rd08(bios, data + 0x2e) & 0x03) >> 0;\n\t\tp->timing_20_2e_30 = (nvbios_rd08(bios, data + 0x2e) & 0x30) >> 4;\n\t\tp->timing_20_2e_c0 = (nvbios_rd08(bios, data + 0x2e) & 0xc0) >> 6;\n\t\tp->timing_20_2f_03 = (nvbios_rd08(bios, data + 0x2f) & 0x03) >> 0;\n\t\ttemp = nvbios_rd16(bios, data + 0x2c);\n\t\tp->timing_20_2c_003f = (temp & 0x003f) >> 0;\n\t\tp->timing_20_2c_1fc0 = (temp & 0x1fc0) >> 6;\n\t\tp->timing_20_30_07 = (nvbios_rd08(bios, data + 0x30) & 0x07) >> 0;\n\t\tp->timing_20_30_f8 = (nvbios_rd08(bios, data + 0x30) & 0xf8) >> 3;\n\t\ttemp = nvbios_rd16(bios, data + 0x31);\n\t\tp->timing_20_31_0007 = (temp & 0x0007) >> 0;\n\t\tp->timing_20_31_0078 = (temp & 0x0078) >> 3;\n\t\tp->timing_20_31_0780 = (temp & 0x0780) >> 7;\n\t\tp->timing_20_31_0800 = (temp & 0x0800) >> 11;\n\t\tp->timing_20_31_7000 = (temp & 0x7000) >> 12;\n\t\tp->timing_20_31_8000 = (temp & 0x8000) >> 15;\n\t\tbreak;\n\tdefault:\n\t\tdata = 0;\n\t\tbreak;\n\t}\n\treturn data;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}