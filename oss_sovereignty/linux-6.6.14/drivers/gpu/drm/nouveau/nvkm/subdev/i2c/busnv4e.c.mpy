{
  "module_name": "busnv4e.c",
  "hash_id": "0bd8917da7bed9a4054736725d57718ce3c28aca47278e6752eeefd06f147b0b",
  "original_prompt": "Ingested from linux-6.6.14/drivers/gpu/drm/nouveau/nvkm/subdev/i2c/busnv4e.c",
  "human_readable_source": " \n#define nv4e_i2c_bus(p) container_of((p), struct nv4e_i2c_bus, base)\n#include \"bus.h\"\n\nstruct nv4e_i2c_bus {\n\tstruct nvkm_i2c_bus base;\n\tu32 addr;\n};\n\nstatic void\nnv4e_i2c_bus_drive_scl(struct nvkm_i2c_bus *base, int state)\n{\n\tstruct nv4e_i2c_bus *bus = nv4e_i2c_bus(base);\n\tstruct nvkm_device *device = bus->base.pad->i2c->subdev.device;\n\tnvkm_mask(device, bus->addr, 0x2f, state ? 0x21 : 0x01);\n}\n\nstatic void\nnv4e_i2c_bus_drive_sda(struct nvkm_i2c_bus *base, int state)\n{\n\tstruct nv4e_i2c_bus *bus = nv4e_i2c_bus(base);\n\tstruct nvkm_device *device = bus->base.pad->i2c->subdev.device;\n\tnvkm_mask(device, bus->addr, 0x1f, state ? 0x11 : 0x01);\n}\n\nstatic int\nnv4e_i2c_bus_sense_scl(struct nvkm_i2c_bus *base)\n{\n\tstruct nv4e_i2c_bus *bus = nv4e_i2c_bus(base);\n\tstruct nvkm_device *device = bus->base.pad->i2c->subdev.device;\n\treturn !!(nvkm_rd32(device, bus->addr) & 0x00040000);\n}\n\nstatic int\nnv4e_i2c_bus_sense_sda(struct nvkm_i2c_bus *base)\n{\n\tstruct nv4e_i2c_bus *bus = nv4e_i2c_bus(base);\n\tstruct nvkm_device *device = bus->base.pad->i2c->subdev.device;\n\treturn !!(nvkm_rd32(device, bus->addr) & 0x00080000);\n}\n\nstatic const struct nvkm_i2c_bus_func\nnv4e_i2c_bus_func = {\n\t.drive_scl = nv4e_i2c_bus_drive_scl,\n\t.drive_sda = nv4e_i2c_bus_drive_sda,\n\t.sense_scl = nv4e_i2c_bus_sense_scl,\n\t.sense_sda = nv4e_i2c_bus_sense_sda,\n\t.xfer = nvkm_i2c_bit_xfer,\n};\n\nint\nnv4e_i2c_bus_new(struct nvkm_i2c_pad *pad, int id, u8 drive,\n\t\t struct nvkm_i2c_bus **pbus)\n{\n\tstruct nv4e_i2c_bus *bus;\n\n\tif (!(bus = kzalloc(sizeof(*bus), GFP_KERNEL)))\n\t\treturn -ENOMEM;\n\t*pbus = &bus->base;\n\n\tnvkm_i2c_bus_ctor(&nv4e_i2c_bus_func, pad, id, &bus->base);\n\tbus->addr = 0x600800 + drive;\n\treturn 0;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}