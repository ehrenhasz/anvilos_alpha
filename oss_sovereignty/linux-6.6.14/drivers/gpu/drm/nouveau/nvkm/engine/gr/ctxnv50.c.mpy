{
  "module_name": "ctxnv50.c",
  "hash_id": "fd30ef583a84b53d83a22aa8f91e7d6ace3d80d18e388ff4387c8ec983d9426a",
  "original_prompt": "Ingested from linux-6.6.14/drivers/gpu/drm/nouveau/nvkm/engine/gr/ctxnv50.c",
  "human_readable_source": " \n\n#define CP_FLAG_CLEAR                 0\n#define CP_FLAG_SET                   1\n#define CP_FLAG_SWAP_DIRECTION        ((0 * 32) + 0)\n#define CP_FLAG_SWAP_DIRECTION_LOAD   0\n#define CP_FLAG_SWAP_DIRECTION_SAVE   1\n#define CP_FLAG_UNK01                 ((0 * 32) + 1)\n#define CP_FLAG_UNK01_CLEAR           0\n#define CP_FLAG_UNK01_SET             1\n#define CP_FLAG_UNK03                 ((0 * 32) + 3)\n#define CP_FLAG_UNK03_CLEAR           0\n#define CP_FLAG_UNK03_SET             1\n#define CP_FLAG_USER_SAVE             ((0 * 32) + 5)\n#define CP_FLAG_USER_SAVE_NOT_PENDING 0\n#define CP_FLAG_USER_SAVE_PENDING     1\n#define CP_FLAG_USER_LOAD             ((0 * 32) + 6)\n#define CP_FLAG_USER_LOAD_NOT_PENDING 0\n#define CP_FLAG_USER_LOAD_PENDING     1\n#define CP_FLAG_UNK0B                 ((0 * 32) + 0xb)\n#define CP_FLAG_UNK0B_CLEAR           0\n#define CP_FLAG_UNK0B_SET             1\n#define CP_FLAG_XFER_SWITCH           ((0 * 32) + 0xe)\n#define CP_FLAG_XFER_SWITCH_DISABLE   0\n#define CP_FLAG_XFER_SWITCH_ENABLE    1\n#define CP_FLAG_STATE                 ((0 * 32) + 0x1c)\n#define CP_FLAG_STATE_STOPPED         0\n#define CP_FLAG_STATE_RUNNING         1\n#define CP_FLAG_UNK1D                 ((0 * 32) + 0x1d)\n#define CP_FLAG_UNK1D_CLEAR           0\n#define CP_FLAG_UNK1D_SET             1\n#define CP_FLAG_UNK20                 ((1 * 32) + 0)\n#define CP_FLAG_UNK20_CLEAR           0\n#define CP_FLAG_UNK20_SET             1\n#define CP_FLAG_STATUS                ((2 * 32) + 0)\n#define CP_FLAG_STATUS_BUSY           0\n#define CP_FLAG_STATUS_IDLE           1\n#define CP_FLAG_AUTO_SAVE             ((2 * 32) + 4)\n#define CP_FLAG_AUTO_SAVE_NOT_PENDING 0\n#define CP_FLAG_AUTO_SAVE_PENDING     1\n#define CP_FLAG_AUTO_LOAD             ((2 * 32) + 5)\n#define CP_FLAG_AUTO_LOAD_NOT_PENDING 0\n#define CP_FLAG_AUTO_LOAD_PENDING     1\n#define CP_FLAG_NEWCTX                ((2 * 32) + 10)\n#define CP_FLAG_NEWCTX_BUSY           0\n#define CP_FLAG_NEWCTX_DONE           1\n#define CP_FLAG_XFER                  ((2 * 32) + 11)\n#define CP_FLAG_XFER_IDLE             0\n#define CP_FLAG_XFER_BUSY             1\n#define CP_FLAG_ALWAYS                ((2 * 32) + 13)\n#define CP_FLAG_ALWAYS_FALSE          0\n#define CP_FLAG_ALWAYS_TRUE           1\n#define CP_FLAG_INTR                  ((2 * 32) + 15)\n#define CP_FLAG_INTR_NOT_PENDING      0\n#define CP_FLAG_INTR_PENDING          1\n\n#define CP_CTX                   0x00100000\n#define CP_CTX_COUNT             0x000f0000\n#define CP_CTX_COUNT_SHIFT               16\n#define CP_CTX_REG               0x00003fff\n#define CP_LOAD_SR               0x00200000\n#define CP_LOAD_SR_VALUE         0x000fffff\n#define CP_BRA                   0x00400000\n#define CP_BRA_IP                0x0001ff00\n#define CP_BRA_IP_SHIFT                   8\n#define CP_BRA_IF_CLEAR          0x00000080\n#define CP_BRA_FLAG              0x0000007f\n#define CP_WAIT                  0x00500000\n#define CP_WAIT_SET              0x00000080\n#define CP_WAIT_FLAG             0x0000007f\n#define CP_SET                   0x00700000\n#define CP_SET_1                 0x00000080\n#define CP_SET_FLAG              0x0000007f\n#define CP_NEWCTX                0x00600004\n#define CP_NEXT_TO_SWAP          0x00600005\n#define CP_SET_CONTEXT_POINTER   0x00600006\n#define CP_SET_XFER_POINTER      0x00600007\n#define CP_ENABLE                0x00600009\n#define CP_END                   0x0060000c\n#define CP_NEXT_TO_CURRENT       0x0060000d\n#define CP_DISABLE1              0x0090ffff\n#define CP_DISABLE2              0x0091ffff\n#define CP_XFER_1      0x008000ff\n#define CP_XFER_2      0x008800ff\n#define CP_SEEK_1      0x00c000ff\n#define CP_SEEK_2      0x00c800ff\n\n#include \"ctxnv40.h\"\n#include \"nv50.h\"\n\n#include <subdev/fb.h>\n\n#define IS_NVA3F(x) (((x) > 0xa0 && (x) < 0xaa) || (x) == 0xaf)\n#define IS_NVAAF(x) ((x) >= 0xaa && (x) <= 0xac)\n\n \n\n \n\n \n\nenum cp_label {\n\tcp_check_load = 1,\n\tcp_setup_auto_load,\n\tcp_setup_load,\n\tcp_setup_save,\n\tcp_swap_state,\n\tcp_prepare_exit,\n\tcp_exit,\n};\n\nstatic void nv50_gr_construct_mmio(struct nvkm_grctx *ctx);\nstatic void nv50_gr_construct_xfer1(struct nvkm_grctx *ctx);\nstatic void nv50_gr_construct_xfer2(struct nvkm_grctx *ctx);\n\n \n\nstatic int\nnv50_grctx_generate(struct nvkm_grctx *ctx)\n{\n\tcp_set (ctx, STATE, RUNNING);\n\tcp_set (ctx, XFER_SWITCH, ENABLE);\n\t \n\tcp_bra (ctx, AUTO_SAVE, PENDING, cp_setup_save);\n\tcp_bra (ctx, USER_SAVE, PENDING, cp_setup_save);\n\n\tcp_name(ctx, cp_check_load);\n\tcp_bra (ctx, AUTO_LOAD, PENDING, cp_setup_auto_load);\n\tcp_bra (ctx, USER_LOAD, PENDING, cp_setup_load);\n\tcp_bra (ctx, ALWAYS, TRUE, cp_prepare_exit);\n\n\t \n\tcp_name(ctx, cp_setup_auto_load);\n\tcp_out (ctx, CP_DISABLE1);\n\tcp_out (ctx, CP_DISABLE2);\n\tcp_out (ctx, CP_ENABLE);\n\tcp_out (ctx, CP_NEXT_TO_SWAP);\n\tcp_set (ctx, UNK01, SET);\n\tcp_name(ctx, cp_setup_load);\n\tcp_out (ctx, CP_NEWCTX);\n\tcp_wait(ctx, NEWCTX, BUSY);\n\tcp_set (ctx, UNK1D, CLEAR);\n\tcp_set (ctx, SWAP_DIRECTION, LOAD);\n\tcp_bra (ctx, UNK0B, SET, cp_prepare_exit);\n\tcp_bra (ctx, ALWAYS, TRUE, cp_swap_state);\n\n\t \n\tcp_name(ctx, cp_setup_save);\n\tcp_set (ctx, UNK1D, SET);\n\tcp_wait(ctx, STATUS, BUSY);\n\tcp_wait(ctx, INTR, PENDING);\n\tcp_bra (ctx, STATUS, BUSY, cp_setup_save);\n\tcp_set (ctx, UNK01, SET);\n\tcp_set (ctx, SWAP_DIRECTION, SAVE);\n\n\t \n\tcp_name(ctx, cp_swap_state);\n\tcp_set (ctx, UNK03, SET);\n\tcp_pos (ctx, 0x00004/4);\n\tcp_ctx (ctx, 0x400828, 1);  \n\tcp_pos (ctx, 0x00100/4);\n\tnv50_gr_construct_mmio(ctx);\n\tnv50_gr_construct_xfer1(ctx);\n\tnv50_gr_construct_xfer2(ctx);\n\n\tcp_bra (ctx, SWAP_DIRECTION, SAVE, cp_check_load);\n\n\tcp_set (ctx, UNK20, SET);\n\tcp_set (ctx, SWAP_DIRECTION, SAVE);  \n\tcp_lsr (ctx, ctx->ctxvals_base);\n\tcp_out (ctx, CP_SET_XFER_POINTER);\n\tcp_lsr (ctx, 4);\n\tcp_out (ctx, CP_SEEK_1);\n\tcp_out (ctx, CP_XFER_1);\n\tcp_wait(ctx, XFER, BUSY);\n\n\t \n\tcp_name(ctx, cp_prepare_exit);\n\tcp_set (ctx, UNK01, CLEAR);\n\tcp_set (ctx, UNK03, CLEAR);\n\tcp_set (ctx, UNK1D, CLEAR);\n\n\tcp_bra (ctx, USER_SAVE, PENDING, cp_exit);\n\tcp_out (ctx, CP_NEXT_TO_CURRENT);\n\n\tcp_name(ctx, cp_exit);\n\tcp_set (ctx, USER_SAVE, NOT_PENDING);\n\tcp_set (ctx, USER_LOAD, NOT_PENDING);\n\tcp_set (ctx, XFER_SWITCH, DISABLE);\n\tcp_set (ctx, STATE, STOPPED);\n\tcp_out (ctx, CP_END);\n\tctx->ctxvals_pos += 0x400;  \n\n\treturn 0;\n}\n\nvoid\nnv50_grctx_fill(struct nvkm_device *device, struct nvkm_gpuobj *mem)\n{\n\tnv50_grctx_generate(&(struct nvkm_grctx) {\n\t\t\t     .device = device,\n\t\t\t     .mode = NVKM_GRCTX_VALS,\n\t\t\t     .data = mem,\n\t\t\t   });\n}\n\nint\nnv50_grctx_init(struct nvkm_device *device, u32 *size)\n{\n\tu32 *ctxprog = kmalloc(512 * 4, GFP_KERNEL), i;\n\tstruct nvkm_grctx ctx = {\n\t\t.device = device,\n\t\t.mode = NVKM_GRCTX_PROG,\n\t\t.ucode = ctxprog,\n\t\t.ctxprog_max = 512,\n\t};\n\n\tif (!ctxprog)\n\t\treturn -ENOMEM;\n\tnv50_grctx_generate(&ctx);\n\n\tnvkm_wr32(device, 0x400324, 0);\n\tfor (i = 0; i < ctx.ctxprog_len; i++)\n\t\tnvkm_wr32(device, 0x400328, ctxprog[i]);\n\t*size = ctx.ctxvals_pos * 4;\n\tkfree(ctxprog);\n\treturn 0;\n}\n\n \n\nstatic void\nnv50_gr_construct_mmio_ddata(struct nvkm_grctx *ctx);\n\nstatic void\nnv50_gr_construct_mmio(struct nvkm_grctx *ctx)\n{\n\tstruct nvkm_device *device = ctx->device;\n\tint i, j;\n\tint offset, base;\n\tu32 units = nvkm_rd32(device, 0x1540);\n\n\t \n\tcp_ctx(ctx, 0x400808, 7);\n\tgr_def(ctx, 0x400814, 0x00000030);\n\tcp_ctx(ctx, 0x400834, 0x32);\n\tif (device->chipset == 0x50) {\n\t\tgr_def(ctx, 0x400834, 0xff400040);\n\t\tgr_def(ctx, 0x400838, 0xfff00080);\n\t\tgr_def(ctx, 0x40083c, 0xfff70090);\n\t\tgr_def(ctx, 0x400840, 0xffe806a8);\n\t}\n\tgr_def(ctx, 0x400844, 0x00000002);\n\tif (IS_NVA3F(device->chipset))\n\t\tgr_def(ctx, 0x400894, 0x00001000);\n\tgr_def(ctx, 0x4008e8, 0x00000003);\n\tgr_def(ctx, 0x4008ec, 0x00001000);\n\tif (device->chipset == 0x50)\n\t\tcp_ctx(ctx, 0x400908, 0xb);\n\telse if (device->chipset < 0xa0)\n\t\tcp_ctx(ctx, 0x400908, 0xc);\n\telse\n\t\tcp_ctx(ctx, 0x400908, 0xe);\n\n\tif (device->chipset >= 0xa0)\n\t\tcp_ctx(ctx, 0x400b00, 0x1);\n\tif (IS_NVA3F(device->chipset)) {\n\t\tcp_ctx(ctx, 0x400b10, 0x1);\n\t\tgr_def(ctx, 0x400b10, 0x0001629d);\n\t\tcp_ctx(ctx, 0x400b20, 0x1);\n\t\tgr_def(ctx, 0x400b20, 0x0001629d);\n\t}\n\n\tnv50_gr_construct_mmio_ddata(ctx);\n\n\t \n\tcp_ctx(ctx, 0x400c08, 0x2);\n\tgr_def(ctx, 0x400c08, 0x0000fe0c);\n\n\t \n\tif (device->chipset < 0xa0) {\n\t\tcp_ctx(ctx, 0x401008, 0x4);\n\t\tgr_def(ctx, 0x401014, 0x00001000);\n\t} else if (!IS_NVA3F(device->chipset)) {\n\t\tcp_ctx(ctx, 0x401008, 0x5);\n\t\tgr_def(ctx, 0x401018, 0x00001000);\n\t} else {\n\t\tcp_ctx(ctx, 0x401008, 0x5);\n\t\tgr_def(ctx, 0x401018, 0x00004000);\n\t}\n\n\t \n\tcp_ctx(ctx, 0x401400, 0x8);\n\tcp_ctx(ctx, 0x401424, 0x3);\n\tif (device->chipset == 0x50)\n\t\tgr_def(ctx, 0x40142c, 0x0001fd87);\n\telse\n\t\tgr_def(ctx, 0x40142c, 0x00000187);\n\tcp_ctx(ctx, 0x401540, 0x5);\n\tgr_def(ctx, 0x401550, 0x00001018);\n\n\t \n\tcp_ctx(ctx, 0x401814, 0x1);\n\tgr_def(ctx, 0x401814, 0x000000ff);\n\tif (device->chipset == 0x50) {\n\t\tcp_ctx(ctx, 0x40181c, 0xe);\n\t\tgr_def(ctx, 0x401850, 0x00000004);\n\t} else if (device->chipset < 0xa0) {\n\t\tcp_ctx(ctx, 0x40181c, 0xf);\n\t\tgr_def(ctx, 0x401854, 0x00000004);\n\t} else {\n\t\tcp_ctx(ctx, 0x40181c, 0x13);\n\t\tgr_def(ctx, 0x401864, 0x00000004);\n\t}\n\n\t \n\tcp_ctx(ctx, 0x401c00, 0x1);\n\tswitch (device->chipset) {\n\tcase 0x50:\n\t\tgr_def(ctx, 0x401c00, 0x0001005f);\n\t\tbreak;\n\tcase 0x84:\n\tcase 0x86:\n\tcase 0x94:\n\t\tgr_def(ctx, 0x401c00, 0x044d00df);\n\t\tbreak;\n\tcase 0x92:\n\tcase 0x96:\n\tcase 0x98:\n\tcase 0xa0:\n\tcase 0xaa:\n\tcase 0xac:\n\t\tgr_def(ctx, 0x401c00, 0x042500df);\n\t\tbreak;\n\tcase 0xa3:\n\tcase 0xa5:\n\tcase 0xa8:\n\tcase 0xaf:\n\t\tgr_def(ctx, 0x401c00, 0x142500df);\n\t\tbreak;\n\t}\n\n\t \n\n\t \n\tcp_ctx(ctx, 0x402400, 0x1);\n\tif (device->chipset == 0x50)\n\t\tcp_ctx(ctx, 0x402408, 0x1);\n\telse\n\t\tcp_ctx(ctx, 0x402408, 0x2);\n\tgr_def(ctx, 0x402408, 0x00000600);\n\n\t \n\tcp_ctx(ctx, 0x402800, 0x1);\n\tif (device->chipset == 0x50)\n\t\tgr_def(ctx, 0x402800, 0x00000006);\n\n\t \n\tcp_ctx(ctx, 0x402c08, 0x6);\n\tif (device->chipset != 0x50)\n\t\tgr_def(ctx, 0x402c14, 0x01000000);\n\tgr_def(ctx, 0x402c18, 0x000000ff);\n\tif (device->chipset == 0x50)\n\t\tcp_ctx(ctx, 0x402ca0, 0x1);\n\telse\n\t\tcp_ctx(ctx, 0x402ca0, 0x2);\n\tif (device->chipset < 0xa0)\n\t\tgr_def(ctx, 0x402ca0, 0x00000400);\n\telse if (!IS_NVA3F(device->chipset))\n\t\tgr_def(ctx, 0x402ca0, 0x00000800);\n\telse\n\t\tgr_def(ctx, 0x402ca0, 0x00000400);\n\tcp_ctx(ctx, 0x402cac, 0x4);\n\n\t \n\tcp_ctx(ctx, 0x403004, 0x1);\n\tgr_def(ctx, 0x403004, 0x00000001);\n\n\t \n\tif (device->chipset >= 0xa0) {\n\t\tcp_ctx(ctx, 0x403404, 0x1);\n\t\tgr_def(ctx, 0x403404, 0x00000001);\n\t}\n\n\t \n\tcp_ctx(ctx, 0x405000, 0x1);\n\tswitch (device->chipset) {\n\tcase 0x50:\n\t\tgr_def(ctx, 0x405000, 0x00300080);\n\t\tbreak;\n\tcase 0x84:\n\tcase 0xa0:\n\tcase 0xa3:\n\tcase 0xa5:\n\tcase 0xa8:\n\tcase 0xaa:\n\tcase 0xac:\n\tcase 0xaf:\n\t\tgr_def(ctx, 0x405000, 0x000e0080);\n\t\tbreak;\n\tcase 0x86:\n\tcase 0x92:\n\tcase 0x94:\n\tcase 0x96:\n\tcase 0x98:\n\t\tgr_def(ctx, 0x405000, 0x00000080);\n\t\tbreak;\n\t}\n\tcp_ctx(ctx, 0x405014, 0x1);\n\tgr_def(ctx, 0x405014, 0x00000004);\n\tcp_ctx(ctx, 0x40501c, 0x1);\n\tcp_ctx(ctx, 0x405024, 0x1);\n\tcp_ctx(ctx, 0x40502c, 0x1);\n\n\t \n\tif (device->chipset == 0x50)\n\t\tcp_ctx(ctx, 0x4063e0, 0x1);\n\n\t \n\tif (device->chipset < 0x90) {\n\t\tcp_ctx(ctx, 0x406814, 0x2b);\n\t\tgr_def(ctx, 0x406818, 0x00000f80);\n\t\tgr_def(ctx, 0x406860, 0x007f0080);\n\t\tgr_def(ctx, 0x40689c, 0x007f0080);\n\t} else {\n\t\tcp_ctx(ctx, 0x406814, 0x4);\n\t\tif (device->chipset == 0x98)\n\t\t\tgr_def(ctx, 0x406818, 0x00000f80);\n\t\telse\n\t\t\tgr_def(ctx, 0x406818, 0x00001f80);\n\t\tif (IS_NVA3F(device->chipset))\n\t\t\tgr_def(ctx, 0x40681c, 0x00000030);\n\t\tcp_ctx(ctx, 0x406830, 0x3);\n\t}\n\n\t \n\tfor (i = 0; i < 8; i++) {\n\t\tif (units & (1<<(i+16))) {\n\t\t\tcp_ctx(ctx, 0x407000 + (i<<8), 3);\n\t\t\tif (device->chipset == 0x50)\n\t\t\t\tgr_def(ctx, 0x407000 + (i<<8), 0x1b74f820);\n\t\t\telse if (device->chipset != 0xa5)\n\t\t\t\tgr_def(ctx, 0x407000 + (i<<8), 0x3b74f821);\n\t\t\telse\n\t\t\t\tgr_def(ctx, 0x407000 + (i<<8), 0x7b74f821);\n\t\t\tgr_def(ctx, 0x407004 + (i<<8), 0x89058001);\n\n\t\t\tif (device->chipset == 0x50) {\n\t\t\t\tcp_ctx(ctx, 0x407010 + (i<<8), 1);\n\t\t\t} else if (device->chipset < 0xa0) {\n\t\t\t\tcp_ctx(ctx, 0x407010 + (i<<8), 2);\n\t\t\t\tgr_def(ctx, 0x407010 + (i<<8), 0x00001000);\n\t\t\t\tgr_def(ctx, 0x407014 + (i<<8), 0x0000001f);\n\t\t\t} else {\n\t\t\t\tcp_ctx(ctx, 0x407010 + (i<<8), 3);\n\t\t\t\tgr_def(ctx, 0x407010 + (i<<8), 0x00001000);\n\t\t\t\tif (device->chipset != 0xa5)\n\t\t\t\t\tgr_def(ctx, 0x407014 + (i<<8), 0x000000ff);\n\t\t\t\telse\n\t\t\t\t\tgr_def(ctx, 0x407014 + (i<<8), 0x000001ff);\n\t\t\t}\n\n\t\t\tcp_ctx(ctx, 0x407080 + (i<<8), 4);\n\t\t\tif (device->chipset != 0xa5)\n\t\t\t\tgr_def(ctx, 0x407080 + (i<<8), 0x027c10fa);\n\t\t\telse\n\t\t\t\tgr_def(ctx, 0x407080 + (i<<8), 0x827c10fa);\n\t\t\tif (device->chipset == 0x50)\n\t\t\t\tgr_def(ctx, 0x407084 + (i<<8), 0x000000c0);\n\t\t\telse\n\t\t\t\tgr_def(ctx, 0x407084 + (i<<8), 0x400000c0);\n\t\t\tgr_def(ctx, 0x407088 + (i<<8), 0xb7892080);\n\n\t\t\tif (device->chipset < 0xa0)\n\t\t\t\tcp_ctx(ctx, 0x407094 + (i<<8), 1);\n\t\t\telse if (!IS_NVA3F(device->chipset))\n\t\t\t\tcp_ctx(ctx, 0x407094 + (i<<8), 3);\n\t\t\telse {\n\t\t\t\tcp_ctx(ctx, 0x407094 + (i<<8), 4);\n\t\t\t\tgr_def(ctx, 0x4070a0 + (i<<8), 1);\n\t\t\t}\n\t\t}\n\t}\n\n\tcp_ctx(ctx, 0x407c00, 0x3);\n\tif (device->chipset < 0x90)\n\t\tgr_def(ctx, 0x407c00, 0x00010040);\n\telse if (device->chipset < 0xa0)\n\t\tgr_def(ctx, 0x407c00, 0x00390040);\n\telse\n\t\tgr_def(ctx, 0x407c00, 0x003d0040);\n\tgr_def(ctx, 0x407c08, 0x00000022);\n\tif (device->chipset >= 0xa0) {\n\t\tcp_ctx(ctx, 0x407c10, 0x3);\n\t\tcp_ctx(ctx, 0x407c20, 0x1);\n\t\tcp_ctx(ctx, 0x407c2c, 0x1);\n\t}\n\n\tif (device->chipset < 0xa0) {\n\t\tcp_ctx(ctx, 0x407d00, 0x9);\n\t} else {\n\t\tcp_ctx(ctx, 0x407d00, 0x15);\n\t}\n\tif (device->chipset == 0x98)\n\t\tgr_def(ctx, 0x407d08, 0x00380040);\n\telse {\n\t\tif (device->chipset < 0x90)\n\t\t\tgr_def(ctx, 0x407d08, 0x00010040);\n\t\telse if (device->chipset < 0xa0)\n\t\t\tgr_def(ctx, 0x407d08, 0x00390040);\n\t\telse {\n\t\t\tif (device->fb->ram->type != NVKM_RAM_TYPE_GDDR5)\n\t\t\t\tgr_def(ctx, 0x407d08, 0x003d0040);\n\t\t\telse\n\t\t\t\tgr_def(ctx, 0x407d08, 0x003c0040);\n\t\t}\n\t\tgr_def(ctx, 0x407d0c, 0x00000022);\n\t}\n\n\t \n\tfor (i = 0; i < 10; i++) {\n\t\tif (units & (1<<i)) {\n\t\t\tif (device->chipset < 0xa0)\n\t\t\t\tbase = 0x408000 + (i<<12);\n\t\t\telse\n\t\t\t\tbase = 0x408000 + (i<<11);\n\t\t\tif (device->chipset < 0xa0)\n\t\t\t\toffset = base + 0xc00;\n\t\t\telse\n\t\t\t\toffset = base + 0x80;\n\t\t\tcp_ctx(ctx, offset + 0x00, 1);\n\t\t\tgr_def(ctx, offset + 0x00, 0x0000ff0a);\n\t\t\tcp_ctx(ctx, offset + 0x08, 1);\n\n\t\t\t \n\t\t\tfor (j = 0; j < (device->chipset < 0xa0 ? 2 : 4); j++) {\n\t\t\t\tif (!(units & (1 << (j+24)))) continue;\n\t\t\t\tif (device->chipset < 0xa0)\n\t\t\t\t\toffset = base + 0x200 + (j<<7);\n\t\t\t\telse\n\t\t\t\t\toffset = base + 0x100 + (j<<7);\n\t\t\t\tcp_ctx(ctx, offset, 0x20);\n\t\t\t\tgr_def(ctx, offset + 0x00, 0x01800000);\n\t\t\t\tgr_def(ctx, offset + 0x04, 0x00160000);\n\t\t\t\tgr_def(ctx, offset + 0x08, 0x01800000);\n\t\t\t\tgr_def(ctx, offset + 0x18, 0x0003ffff);\n\t\t\t\tswitch (device->chipset) {\n\t\t\t\tcase 0x50:\n\t\t\t\t\tgr_def(ctx, offset + 0x1c, 0x00080000);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 0x84:\n\t\t\t\t\tgr_def(ctx, offset + 0x1c, 0x00880000);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 0x86:\n\t\t\t\t\tgr_def(ctx, offset + 0x1c, 0x018c0000);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 0x92:\n\t\t\t\tcase 0x96:\n\t\t\t\tcase 0x98:\n\t\t\t\t\tgr_def(ctx, offset + 0x1c, 0x118c0000);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 0x94:\n\t\t\t\t\tgr_def(ctx, offset + 0x1c, 0x10880000);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 0xa0:\n\t\t\t\tcase 0xa5:\n\t\t\t\t\tgr_def(ctx, offset + 0x1c, 0x310c0000);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 0xa3:\n\t\t\t\tcase 0xa8:\n\t\t\t\tcase 0xaa:\n\t\t\t\tcase 0xac:\n\t\t\t\tcase 0xaf:\n\t\t\t\t\tgr_def(ctx, offset + 0x1c, 0x300c0000);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tgr_def(ctx, offset + 0x40, 0x00010401);\n\t\t\t\tif (device->chipset == 0x50)\n\t\t\t\t\tgr_def(ctx, offset + 0x48, 0x00000040);\n\t\t\t\telse\n\t\t\t\t\tgr_def(ctx, offset + 0x48, 0x00000078);\n\t\t\t\tgr_def(ctx, offset + 0x50, 0x000000bf);\n\t\t\t\tgr_def(ctx, offset + 0x58, 0x00001210);\n\t\t\t\tif (device->chipset == 0x50)\n\t\t\t\t\tgr_def(ctx, offset + 0x5c, 0x00000080);\n\t\t\t\telse\n\t\t\t\t\tgr_def(ctx, offset + 0x5c, 0x08000080);\n\t\t\t\tif (device->chipset >= 0xa0)\n\t\t\t\t\tgr_def(ctx, offset + 0x68, 0x0000003e);\n\t\t\t}\n\n\t\t\tif (device->chipset < 0xa0)\n\t\t\t\tcp_ctx(ctx, base + 0x300, 0x4);\n\t\t\telse\n\t\t\t\tcp_ctx(ctx, base + 0x300, 0x5);\n\t\t\tif (device->chipset == 0x50)\n\t\t\t\tgr_def(ctx, base + 0x304, 0x00007070);\n\t\t\telse if (device->chipset < 0xa0)\n\t\t\t\tgr_def(ctx, base + 0x304, 0x00027070);\n\t\t\telse if (!IS_NVA3F(device->chipset))\n\t\t\t\tgr_def(ctx, base + 0x304, 0x01127070);\n\t\t\telse\n\t\t\t\tgr_def(ctx, base + 0x304, 0x05127070);\n\n\t\t\tif (device->chipset < 0xa0)\n\t\t\t\tcp_ctx(ctx, base + 0x318, 1);\n\t\t\telse\n\t\t\t\tcp_ctx(ctx, base + 0x320, 1);\n\t\t\tif (device->chipset == 0x50)\n\t\t\t\tgr_def(ctx, base + 0x318, 0x0003ffff);\n\t\t\telse if (device->chipset < 0xa0)\n\t\t\t\tgr_def(ctx, base + 0x318, 0x03ffffff);\n\t\t\telse\n\t\t\t\tgr_def(ctx, base + 0x320, 0x07ffffff);\n\n\t\t\tif (device->chipset < 0xa0)\n\t\t\t\tcp_ctx(ctx, base + 0x324, 5);\n\t\t\telse\n\t\t\t\tcp_ctx(ctx, base + 0x328, 4);\n\n\t\t\tif (device->chipset < 0xa0) {\n\t\t\t\tcp_ctx(ctx, base + 0x340, 9);\n\t\t\t\toffset = base + 0x340;\n\t\t\t} else if (!IS_NVA3F(device->chipset)) {\n\t\t\t\tcp_ctx(ctx, base + 0x33c, 0xb);\n\t\t\t\toffset = base + 0x344;\n\t\t\t} else {\n\t\t\t\tcp_ctx(ctx, base + 0x33c, 0xd);\n\t\t\t\toffset = base + 0x344;\n\t\t\t}\n\t\t\tgr_def(ctx, offset + 0x0, 0x00120407);\n\t\t\tgr_def(ctx, offset + 0x4, 0x05091507);\n\t\t\tif (device->chipset == 0x84)\n\t\t\t\tgr_def(ctx, offset + 0x8, 0x05100202);\n\t\t\telse\n\t\t\t\tgr_def(ctx, offset + 0x8, 0x05010202);\n\t\t\tgr_def(ctx, offset + 0xc, 0x00030201);\n\t\t\tif (device->chipset == 0xa3)\n\t\t\t\tcp_ctx(ctx, base + 0x36c, 1);\n\n\t\t\tcp_ctx(ctx, base + 0x400, 2);\n\t\t\tgr_def(ctx, base + 0x404, 0x00000040);\n\t\t\tcp_ctx(ctx, base + 0x40c, 2);\n\t\t\tgr_def(ctx, base + 0x40c, 0x0d0c0b0a);\n\t\t\tgr_def(ctx, base + 0x410, 0x00141210);\n\n\t\t\tif (device->chipset < 0xa0)\n\t\t\t\toffset = base + 0x800;\n\t\t\telse\n\t\t\t\toffset = base + 0x500;\n\t\t\tcp_ctx(ctx, offset, 6);\n\t\t\tgr_def(ctx, offset + 0x0, 0x000001f0);\n\t\t\tgr_def(ctx, offset + 0x4, 0x00000001);\n\t\t\tgr_def(ctx, offset + 0x8, 0x00000003);\n\t\t\tif (device->chipset == 0x50 || IS_NVAAF(device->chipset))\n\t\t\t\tgr_def(ctx, offset + 0xc, 0x00008000);\n\t\t\tgr_def(ctx, offset + 0x14, 0x00039e00);\n\t\t\tcp_ctx(ctx, offset + 0x1c, 2);\n\t\t\tif (device->chipset == 0x50)\n\t\t\t\tgr_def(ctx, offset + 0x1c, 0x00000040);\n\t\t\telse\n\t\t\t\tgr_def(ctx, offset + 0x1c, 0x00000100);\n\t\t\tgr_def(ctx, offset + 0x20, 0x00003800);\n\n\t\t\tif (device->chipset >= 0xa0) {\n\t\t\t\tcp_ctx(ctx, base + 0x54c, 2);\n\t\t\t\tif (!IS_NVA3F(device->chipset))\n\t\t\t\t\tgr_def(ctx, base + 0x54c, 0x003fe006);\n\t\t\t\telse\n\t\t\t\t\tgr_def(ctx, base + 0x54c, 0x003fe007);\n\t\t\t\tgr_def(ctx, base + 0x550, 0x003fe000);\n\t\t\t}\n\n\t\t\tif (device->chipset < 0xa0)\n\t\t\t\toffset = base + 0xa00;\n\t\t\telse\n\t\t\t\toffset = base + 0x680;\n\t\t\tcp_ctx(ctx, offset, 1);\n\t\t\tgr_def(ctx, offset, 0x00404040);\n\n\t\t\tif (device->chipset < 0xa0)\n\t\t\t\toffset = base + 0xe00;\n\t\t\telse\n\t\t\t\toffset = base + 0x700;\n\t\t\tcp_ctx(ctx, offset, 2);\n\t\t\tif (device->chipset < 0xa0)\n\t\t\t\tgr_def(ctx, offset, 0x0077f005);\n\t\t\telse if (device->chipset == 0xa5)\n\t\t\t\tgr_def(ctx, offset, 0x6cf7f007);\n\t\t\telse if (device->chipset == 0xa8)\n\t\t\t\tgr_def(ctx, offset, 0x6cfff007);\n\t\t\telse if (device->chipset == 0xac)\n\t\t\t\tgr_def(ctx, offset, 0x0cfff007);\n\t\t\telse\n\t\t\t\tgr_def(ctx, offset, 0x0cf7f007);\n\t\t\tif (device->chipset == 0x50)\n\t\t\t\tgr_def(ctx, offset + 0x4, 0x00007fff);\n\t\t\telse if (device->chipset < 0xa0)\n\t\t\t\tgr_def(ctx, offset + 0x4, 0x003f7fff);\n\t\t\telse\n\t\t\t\tgr_def(ctx, offset + 0x4, 0x02bf7fff);\n\t\t\tcp_ctx(ctx, offset + 0x2c, 1);\n\t\t\tif (device->chipset == 0x50) {\n\t\t\t\tcp_ctx(ctx, offset + 0x50, 9);\n\t\t\t\tgr_def(ctx, offset + 0x54, 0x000003ff);\n\t\t\t\tgr_def(ctx, offset + 0x58, 0x00000003);\n\t\t\t\tgr_def(ctx, offset + 0x5c, 0x00000003);\n\t\t\t\tgr_def(ctx, offset + 0x60, 0x000001ff);\n\t\t\t\tgr_def(ctx, offset + 0x64, 0x0000001f);\n\t\t\t\tgr_def(ctx, offset + 0x68, 0x0000000f);\n\t\t\t\tgr_def(ctx, offset + 0x6c, 0x0000000f);\n\t\t\t} else if (device->chipset < 0xa0) {\n\t\t\t\tcp_ctx(ctx, offset + 0x50, 1);\n\t\t\t\tcp_ctx(ctx, offset + 0x70, 1);\n\t\t\t} else {\n\t\t\t\tcp_ctx(ctx, offset + 0x50, 1);\n\t\t\t\tcp_ctx(ctx, offset + 0x60, 5);\n\t\t\t}\n\t\t}\n\t}\n}\n\nstatic void\ndd_emit(struct nvkm_grctx *ctx, int num, u32 val) {\n\tint i;\n\tif (val && ctx->mode == NVKM_GRCTX_VALS) {\n\t\tfor (i = 0; i < num; i++)\n\t\t\tnvkm_wo32(ctx->data, 4 * (ctx->ctxvals_pos + i), val);\n\t}\n\tctx->ctxvals_pos += num;\n}\n\nstatic void\nnv50_gr_construct_mmio_ddata(struct nvkm_grctx *ctx)\n{\n\tstruct nvkm_device *device = ctx->device;\n\tint base, num;\n\tbase = ctx->ctxvals_pos;\n\n\t \n\tdd_emit(ctx, 1, 0);\t \n\tdd_emit(ctx, 1, 0);\t \n\n\t \n\tdd_emit(ctx, 1, 0);\t \n\tdd_emit(ctx, 1, 2);\t \n\tdd_emit(ctx, 1, 1);\t \n\tdd_emit(ctx, 1, 0);\t \n\tdd_emit(ctx, 1, 0);\t \n\tif (device->chipset >= 0x94)\n\t\tdd_emit(ctx, 1, 0);\t \n\tdd_emit(ctx, 1, 1);\t \n\tdd_emit(ctx, 1, 0x100);\t \n\n\t \n\tdd_emit(ctx, 1, 0);\t\t \n\tdd_emit(ctx, 1, 0);\t\t \n\tdd_emit(ctx, 1, 0);\t\t \n\tdd_emit(ctx, 1, 0);\t\t \n\tdd_emit(ctx, 1, 0);\t\t \n\tdd_emit(ctx, 1, 2);\t\t \n\tdd_emit(ctx, 1, 1);\t\t \n\tdd_emit(ctx, 1, 1);\t\t \n\tdd_emit(ctx, 1, 0);\t\t \n\tdd_emit(ctx, 1, 0);\t\t \n\tdd_emit(ctx, 1, 0);\t\t \n\tdd_emit(ctx, 1, 1);\t\t \n\tdd_emit(ctx, 1, 0x3fffff);\t \n\tdd_emit(ctx, 1, 0x1fff);\t \n\tdd_emit(ctx, 1, 0);\t\t \n\tdd_emit(ctx, 1, 1);\t\t \n\tdd_emit(ctx, 1, 1);\t\t \n\tdd_emit(ctx, 1, 0);\t\t \n\tdd_emit(ctx, 1, 1);\t\t \n\tdd_emit(ctx, 1, 1);\t\t \n\tdd_emit(ctx, 1, 1);\t\t \n\tdd_emit(ctx, 1, 4);\t\t \n\tdd_emit(ctx, 1, 1);\t\t \n\tif (IS_NVA3F(device->chipset))\n\t\tdd_emit(ctx, 1, 0);\t \n\tdd_emit(ctx, 1, 1);\t\t \n\tdd_emit(ctx, 1, 1);\t\t \n\tdd_emit(ctx, 1, 7);\t\t \n\tdd_emit(ctx, 1, 1);\t\t \n\tdd_emit(ctx, 1, 7);\t\t \n\tdd_emit(ctx, 1, 1);\t\t \n\tdd_emit(ctx, 1, 1);\t\t \n\tdd_emit(ctx, 1, 1);\t\t \n\n\t \n\tif (device->chipset == 0x50) {\n\t\tdd_emit(ctx, 4, 0);\t\t \n\n\t\tdd_emit(ctx, 1, 1);\t\t \n\n\t\tdd_emit(ctx, 1, 1);\t\t \n\t\tdd_emit(ctx, 1, 0);\t\t \n\t\tdd_emit(ctx, 1, 1);\t\t \n\n\t\tdd_emit(ctx, 1, 0xa);\t\t \n\t\tdd_emit(ctx, 1, 0);\t\t \n\t\tdd_emit(ctx, 1, 0);\t\t \n\t\tdd_emit(ctx, 1, 0);\t\t \n\t\tdd_emit(ctx, 1, 0x40);\t\t \n\t\tdd_emit(ctx, 1, 0);\t\t \n\t\tdd_emit(ctx, 1, 2);\t\t \n\t\tdd_emit(ctx, 1, 0x100);\t\t \n\t\tdd_emit(ctx, 1, 1);\t\t \n\t\tdd_emit(ctx, 1, 0x100);\t\t \n\n\t\tdd_emit(ctx, 1, 0);\t\t \n\t\tdd_emit(ctx, 1, 0);\t\t \n\t\tdd_emit(ctx, 1, 0);\t\t \n\t\tdd_emit(ctx, 1, 0);\t\t \n\t\tdd_emit(ctx, 1, 0);\t\t \n\t\tdd_emit(ctx, 1, 0);\t\t \n\t\tdd_emit(ctx, 1, 1);\t\t \n\t\tdd_emit(ctx, 1, 0);\t\t \n\t\tdd_emit(ctx, 1, 0);\t\t \n\t\tdd_emit(ctx, 1, 0);\t\t \n\n\t\tdd_emit(ctx, 1, 0);\t\t \n\t\tdd_emit(ctx, 1, 0);\t\t \n\n\t\tdd_emit(ctx, 1, 0);\t\t \n\n\t\tdd_emit(ctx, 1, 0);\t\t \n\t\tdd_emit(ctx, 1, 0);\t\t \n\t\tdd_emit(ctx, 1, 4);\t\t \n\t\tdd_emit(ctx, 1, 0);\t\t \n\t}\n\n\t \n\tdd_emit(ctx, 1, 0);\t\t \n\tdd_emit(ctx, 1, 0);\t\t \n\tdd_emit(ctx, 2, 0);\t\t \n\tdd_emit(ctx, 1, 1);\t\t \n\tdd_emit(ctx, 1, 0x100);\t\t \n\tdd_emit(ctx, 1, 0);\t\t \n\tdd_emit(ctx, 1, 1);\t\t \n\tdd_emit(ctx, 2, 0);\t\t \n\tdd_emit(ctx, 1, 0x100);\t\t \n\tdd_emit(ctx, 1, 1);\t\t \n\tdd_emit(ctx, 1, 0x100);\t\t \n\tdd_emit(ctx, 1, 0);\t\t \n\tdd_emit(ctx, 1, 1);\t\t \n\tdd_emit(ctx, 2, 0);\t\t \n\tdd_emit(ctx, 1, 0x100);\t\t \n\n\t \n\tif (device->chipset == 0x50) {\n\t\tdd_emit(ctx, 1, 1);\t\t \n\t\tdd_emit(ctx, 1, 0);\t\t \n\n\t\tdd_emit(ctx, 1, 1);\t\t \n\t\tdd_emit(ctx, 1, 0);\t\t \n\n\t\tdd_emit(ctx, 1, 0);\t\t \n\t\tdd_emit(ctx, 1, 2);\t\t \n\t\tdd_emit(ctx, 1, 0);\t\t \n\t\tdd_emit(ctx, 1, 1);\t\t \n\t\tdd_emit(ctx, 1, 0);\t\t \n\t\tdd_emit(ctx, 1, 1);\t\t \n\t\tdd_emit(ctx, 1, 0);\t\t \n\t\tdd_emit(ctx, 1, 0);\t\t \n\t\tdd_emit(ctx, 1, 0);\t\t \n\t\tdd_emit(ctx, 1, 0);\t\t \n\t\tdd_emit(ctx, 1, 3);\t\t \n\t\tdd_emit(ctx, 1, 0);\t\t \n\n\t\tdd_emit(ctx, 1, 0);\t\t \n\t}\n\n\t \n\tdd_emit(ctx, 1, 0);\t\t \n\tdd_emit(ctx, 1, 0);\t\t \n\tdd_emit(ctx, 1, 0);\t\t \n\tdd_emit(ctx, 1, 0);\t\t \n\tdd_emit(ctx, 1, 4);\t\t \n\tdd_emit(ctx, 1, 0x70);\t\t \n\tdd_emit(ctx, 1, 0x80);\t\t \n\tdd_emit(ctx, 1, 0);\t\t \n\tdd_emit(ctx, 1, 0);\t\t \n\tdd_emit(ctx, 1, 0);\t\t \n\tif (IS_NVA3F(device->chipset)) {\n\t\tdd_emit(ctx, 1, 0);\t \n\t\tdd_emit(ctx, 1, 0);\t \n\t} else {\n\t\tdd_emit(ctx, 1, 0);\t \n\t}\n\tdd_emit(ctx, 1, 0xc);\t\t \n\tif (device->chipset != 0x50)\n\t\tdd_emit(ctx, 1, 0);\t \n\tdd_emit(ctx, 1, 8);\t\t \n\tdd_emit(ctx, 1, 0x14);\t\t \n\tif (device->chipset == 0x50) {\n\t\tdd_emit(ctx, 1, 0);\t \n\t\tdd_emit(ctx, 1, 0);\t \n\t} else {\n\t\tdd_emit(ctx, 1, 0);\t \n\t\tdd_emit(ctx, 1, 0x29);\t \n\t\tdd_emit(ctx, 1, 0x27);\t \n\t\tdd_emit(ctx, 1, 0x26);\t \n\t\tdd_emit(ctx, 1, 8);\t \n\t\tdd_emit(ctx, 1, 4);\t \n\t\tdd_emit(ctx, 1, 0x27);\t \n\t\tdd_emit(ctx, 1, 0);\t \n\t}\n\tdd_emit(ctx, 1, 0);\t\t \n\tdd_emit(ctx, 1, 1);\t\t \n\tdd_emit(ctx, 1, 2);\t\t \n\tdd_emit(ctx, 1, 3);\t\t \n\tdd_emit(ctx, 1, 4);\t\t \n\tdd_emit(ctx, 1, 5);\t\t \n\tdd_emit(ctx, 1, 6);\t\t \n\tdd_emit(ctx, 1, 7);\t\t \n\tdd_emit(ctx, 1, 1);\t\t \n\tdd_emit(ctx, 8, 0);\t\t \n\tdd_emit(ctx, 8, 0);\t\t \n\tdd_emit(ctx, 1, 0xcf);\t\t \n\tdd_emit(ctx, 7, 0);\t\t \n\tif (device->chipset != 0x50)\n\t\tdd_emit(ctx, 3, 0);\t \n\telse\n\t\tdd_emit(ctx, 2, 0);\t \n\tdd_emit(ctx, 1, 0);\t\t \n\tdd_emit(ctx, 1, 0x80);\t\t \n\tdd_emit(ctx, 1, 4);\t\t \n\tdd_emit(ctx, 1, 4);\t\t \n\tif (IS_NVA3F(device->chipset)) {\n\t\tdd_emit(ctx, 1, 3);\t \n\t\tdd_emit(ctx, 1, 0);\t \n\t}\n\tif (device->chipset != 0x50)\n\t\tdd_emit(ctx, 1, 3);\t \n\tdd_emit(ctx, 1, 1);\t\t \n\tdd_emit(ctx, 1, 0);\t\t \n\tif (device->chipset != 0x50)\n\t\tdd_emit(ctx, 1, 0);\t \n\tdd_emit(ctx, 1, 0x12);\t\t \n\tdd_emit(ctx, 1, 0x10);\t\t \n\tdd_emit(ctx, 1, 0xc);\t\t \n\tdd_emit(ctx, 1, 1);\t\t \n\tdd_emit(ctx, 1, 0);\t\t \n\tdd_emit(ctx, 1, 0);\t\t \n\tdd_emit(ctx, 1, 0);\t\t \n\tdd_emit(ctx, 1, 4);\t\t \n\tdd_emit(ctx, 1, 2);\t\t \n\tdd_emit(ctx, 1, 4);\t\t \n\tif (device->chipset >= 0xa0)\n\t\tdd_emit(ctx, 1, 0);\t \n\tdd_emit(ctx, 1, 0);\t\t \n\tdd_emit(ctx, 1, 0);\t\t \n\tdd_emit(ctx, 1, 0x3fffff);\t \n\tdd_emit(ctx, 1, 0x1fff);\t \n\tdd_emit(ctx, 1, 0);\t\t \n\tif (device->chipset != 0x50)\n\t\tdd_emit(ctx, 8, 0);\t \n\tif (device->chipset >= 0xa0) {\n\t\tdd_emit(ctx, 1, 1);\t \n\t\tdd_emit(ctx, 1, 1);\t \n\t\tdd_emit(ctx, 1, 2);\t \n\t\tdd_emit(ctx, 1, 0);\t \n\t}\n\tdd_emit(ctx, 1, 4);\t\t \n\tdd_emit(ctx, 1, 0x14);\t\t \n\tdd_emit(ctx, 1, 1);\t\t \n\tdd_emit(ctx, 1, 0);\t\t \n\tdd_emit(ctx, 1, 0);\t\t \n\tif (IS_NVA3F(device->chipset))\n\t\tdd_emit(ctx, 1, 0);\t \n\tdd_emit(ctx, 1, 2);\t\t \n\tif (device->chipset >= 0xa0)\n\t\tdd_emit(ctx, 1, 0);\t \n\tdd_emit(ctx, 1, 0);\t\t \n\tif (device->chipset >= 0xa0)\n\t\tdd_emit(ctx, 1, 0);\t \n\tdd_emit(ctx, 1, 0);\t\t \n\tdd_emit(ctx, 1, 1);\t\t \n\tdd_emit(ctx, 1, 0);\t\t \n\tdd_emit(ctx, 1, 2);\t\t \n\tdd_emit(ctx, 1, 0x1000);\t \n\tif (device->chipset != 0x50) {\n\t\tdd_emit(ctx, 1, 0xe00);\t\t \n\t\tdd_emit(ctx, 1, 0x1000);\t \n\t\tdd_emit(ctx, 1, 0x1e00);\t \n\t}\n\tdd_emit(ctx, 1, 0);\t\t \n\tdd_emit(ctx, 1, 1);\t\t \n\tdd_emit(ctx, 1, 1);\t\t \n\tdd_emit(ctx, 1, 1);\t\t \n\tdd_emit(ctx, 1, 1);\t\t \n\tdd_emit(ctx, 1, 1);\t\t \n\tdd_emit(ctx, 1, 0);\t\t \n\tdd_emit(ctx, 1, 0);\t\t \n\tdd_emit(ctx, 1, 0);\t\t \n\tdd_emit(ctx, 1, 0x200);\t\t \n\tif (IS_NVA3F(device->chipset))\n\t\tdd_emit(ctx, 1, 0x200);\n\tdd_emit(ctx, 1, 0);\t\t \n\tif (device->chipset < 0xa0) {\n\t\tdd_emit(ctx, 1, 1);\t \n\t\tdd_emit(ctx, 1, 0x70);\t \n\t\tdd_emit(ctx, 1, 0x80);\t \n\t\tdd_emit(ctx, 1, 0);\t \n\t\tdd_emit(ctx, 1, 0);\t \n\t\tdd_emit(ctx, 1, 1);\t \n\t\tdd_emit(ctx, 1, 0x70);\t \n\t\tdd_emit(ctx, 1, 0x80);\t \n\t\tdd_emit(ctx, 1, 0);\t \n\t} else {\n\t\tdd_emit(ctx, 1, 1);\t \n\t\tdd_emit(ctx, 1, 0xf0);\t \n\t\tdd_emit(ctx, 1, 0xff);\t \n\t\tdd_emit(ctx, 1, 0);\t \n\t\tdd_emit(ctx, 1, 0);\t \n\t\tdd_emit(ctx, 1, 1);\t \n\t\tdd_emit(ctx, 1, 0xf0);\t \n\t\tdd_emit(ctx, 1, 0xff);\t \n\t\tdd_emit(ctx, 1, 0);\t \n\t\tdd_emit(ctx, 1, 9);\t \n\t}\n\n\t \n\tdd_emit(ctx, 1, 0);\t\t \n\tdd_emit(ctx, 1, 0);\t\t \n\tdd_emit(ctx, 1, 1);\t\t \n\tdd_emit(ctx, 1, 0xcf);\t\t \n\tdd_emit(ctx, 1, 0);\t\t \n\tdd_emit(ctx, 1, 1);\t\t \n\tdd_emit(ctx, 1, 0);\t\t \n\tdd_emit(ctx, 1, 0);\t\t \n\tdd_emit(ctx, 1, 0);\t\t \n\tdd_emit(ctx, 1, 0xcf);\t\t \n\tdd_emit(ctx, 1, 0);\t\t \n\tdd_emit(ctx, 1, 2);\t\t \n\tdd_emit(ctx, 1, 0);\t\t \n\tdd_emit(ctx, 1, 1);\t\t \n\tdd_emit(ctx, 1, 0);\t\t \n\tdd_emit(ctx, 1, 1);\t\t \n\tdd_emit(ctx, 1, 0);\t\t \n\tdd_emit(ctx, 1, 0xcf);\t\t \n\tdd_emit(ctx, 1, 0xcf);\t\t \n\tdd_emit(ctx, 1, 1);\t\t \n\n\tnum = ctx->ctxvals_pos - base;\n\tctx->ctxvals_pos = base;\n\tif (IS_NVA3F(device->chipset))\n\t\tcp_ctx(ctx, 0x404800, num);\n\telse\n\t\tcp_ctx(ctx, 0x405400, num);\n}\n\n \n\nstatic void\nxf_emit(struct nvkm_grctx *ctx, int num, u32 val) {\n\tint i;\n\tif (val && ctx->mode == NVKM_GRCTX_VALS) {\n\t\tfor (i = 0; i < num; i++)\n\t\t\tnvkm_wo32(ctx->data, 4 * (ctx->ctxvals_pos + (i << 3)), val);\n\t}\n\tctx->ctxvals_pos += num << 3;\n}\n\n \n\nstatic void nv50_gr_construct_gene_dispatch(struct nvkm_grctx *ctx);\nstatic void nv50_gr_construct_gene_m2mf(struct nvkm_grctx *ctx);\nstatic void nv50_gr_construct_gene_ccache(struct nvkm_grctx *ctx);\nstatic void nv50_gr_construct_gene_unk10xx(struct nvkm_grctx *ctx);\nstatic void nv50_gr_construct_gene_unk14xx(struct nvkm_grctx *ctx);\nstatic void nv50_gr_construct_gene_zcull(struct nvkm_grctx *ctx);\nstatic void nv50_gr_construct_gene_clipid(struct nvkm_grctx *ctx);\nstatic void nv50_gr_construct_gene_unk24xx(struct nvkm_grctx *ctx);\nstatic void nv50_gr_construct_gene_vfetch(struct nvkm_grctx *ctx);\nstatic void nv50_gr_construct_gene_eng2d(struct nvkm_grctx *ctx);\nstatic void nv50_gr_construct_gene_csched(struct nvkm_grctx *ctx);\nstatic void nv50_gr_construct_gene_unk1cxx(struct nvkm_grctx *ctx);\nstatic void nv50_gr_construct_gene_strmout(struct nvkm_grctx *ctx);\nstatic void nv50_gr_construct_gene_unk34xx(struct nvkm_grctx *ctx);\nstatic void nv50_gr_construct_gene_ropm1(struct nvkm_grctx *ctx);\nstatic void nv50_gr_construct_gene_ropm2(struct nvkm_grctx *ctx);\nstatic void nv50_gr_construct_gene_ropc(struct nvkm_grctx *ctx);\nstatic void nv50_gr_construct_xfer_tp(struct nvkm_grctx *ctx);\n\nstatic void\nnv50_gr_construct_xfer1(struct nvkm_grctx *ctx)\n{\n\tstruct nvkm_device *device = ctx->device;\n\tint i;\n\tint offset;\n\tint size = 0;\n\tu32 units = nvkm_rd32(device, 0x1540);\n\n\toffset = (ctx->ctxvals_pos+0x3f)&~0x3f;\n\tctx->ctxvals_base = offset;\n\n\tif (device->chipset < 0xa0) {\n\t\t \n\t\tctx->ctxvals_pos = offset;\n\t\tnv50_gr_construct_gene_dispatch(ctx);\n\t\tnv50_gr_construct_gene_m2mf(ctx);\n\t\tnv50_gr_construct_gene_unk24xx(ctx);\n\t\tnv50_gr_construct_gene_clipid(ctx);\n\t\tnv50_gr_construct_gene_zcull(ctx);\n\t\tif ((ctx->ctxvals_pos-offset)/8 > size)\n\t\t\tsize = (ctx->ctxvals_pos-offset)/8;\n\n\t\t \n\t\tctx->ctxvals_pos = offset + 0x1;\n\t\tnv50_gr_construct_gene_vfetch(ctx);\n\t\tnv50_gr_construct_gene_eng2d(ctx);\n\t\tnv50_gr_construct_gene_csched(ctx);\n\t\tnv50_gr_construct_gene_ropm1(ctx);\n\t\tnv50_gr_construct_gene_ropm2(ctx);\n\t\tif ((ctx->ctxvals_pos-offset)/8 > size)\n\t\t\tsize = (ctx->ctxvals_pos-offset)/8;\n\n\t\t \n\t\tctx->ctxvals_pos = offset + 0x2;\n\t\tnv50_gr_construct_gene_ccache(ctx);\n\t\tnv50_gr_construct_gene_unk1cxx(ctx);\n\t\tnv50_gr_construct_gene_strmout(ctx);\n\t\tnv50_gr_construct_gene_unk14xx(ctx);\n\t\tnv50_gr_construct_gene_unk10xx(ctx);\n\t\tnv50_gr_construct_gene_unk34xx(ctx);\n\t\tif ((ctx->ctxvals_pos-offset)/8 > size)\n\t\t\tsize = (ctx->ctxvals_pos-offset)/8;\n\n\t\t \n\t\tctx->ctxvals_pos = offset + 3;\n\t\tfor (i = 0; i < 6; i++)\n\t\t\tif (units & (1 << (i + 16)))\n\t\t\t\tnv50_gr_construct_gene_ropc(ctx);\n\t\tif ((ctx->ctxvals_pos-offset)/8 > size)\n\t\t\tsize = (ctx->ctxvals_pos-offset)/8;\n\n\t\t \n\t\tfor (i = 0; i < 4; i++) {\n\t\t\tctx->ctxvals_pos = offset + 4 + i;\n\t\t\tif (units & (1 << (2 * i)))\n\t\t\t\tnv50_gr_construct_xfer_tp(ctx);\n\t\t\tif (units & (1 << (2 * i + 1)))\n\t\t\t\tnv50_gr_construct_xfer_tp(ctx);\n\t\t\tif ((ctx->ctxvals_pos-offset)/8 > size)\n\t\t\t\tsize = (ctx->ctxvals_pos-offset)/8;\n\t\t}\n\t} else {\n\t\t \n\t\tctx->ctxvals_pos = offset;\n\t\tnv50_gr_construct_gene_dispatch(ctx);\n\t\tnv50_gr_construct_gene_m2mf(ctx);\n\t\tnv50_gr_construct_gene_unk34xx(ctx);\n\t\tnv50_gr_construct_gene_csched(ctx);\n\t\tnv50_gr_construct_gene_unk1cxx(ctx);\n\t\tnv50_gr_construct_gene_strmout(ctx);\n\t\tif ((ctx->ctxvals_pos-offset)/8 > size)\n\t\t\tsize = (ctx->ctxvals_pos-offset)/8;\n\n\t\t \n\t\tctx->ctxvals_pos = offset + 1;\n\t\tnv50_gr_construct_gene_unk10xx(ctx);\n\t\tif ((ctx->ctxvals_pos-offset)/8 > size)\n\t\t\tsize = (ctx->ctxvals_pos-offset)/8;\n\n\t\t \n\t\tctx->ctxvals_pos = offset + 2;\n\t\tif (device->chipset == 0xa0)\n\t\t\tnv50_gr_construct_gene_unk14xx(ctx);\n\t\tnv50_gr_construct_gene_unk24xx(ctx);\n\t\tif ((ctx->ctxvals_pos-offset)/8 > size)\n\t\t\tsize = (ctx->ctxvals_pos-offset)/8;\n\n\t\t \n\t\tctx->ctxvals_pos = offset + 3;\n\t\tnv50_gr_construct_gene_vfetch(ctx);\n\t\tif ((ctx->ctxvals_pos-offset)/8 > size)\n\t\t\tsize = (ctx->ctxvals_pos-offset)/8;\n\n\t\t \n\t\tctx->ctxvals_pos = offset + 4;\n\t\tnv50_gr_construct_gene_ccache(ctx);\n\t\tif ((ctx->ctxvals_pos-offset)/8 > size)\n\t\t\tsize = (ctx->ctxvals_pos-offset)/8;\n\n\t\t \n\t\tctx->ctxvals_pos = offset + 5;\n\t\tnv50_gr_construct_gene_ropm2(ctx);\n\t\tnv50_gr_construct_gene_ropm1(ctx);\n\t\t \n\t\tfor (i = 0; i < 8; i++)\n\t\t\tif (units & (1<<(i+16)))\n\t\t\t\tnv50_gr_construct_gene_ropc(ctx);\n\t\tif ((ctx->ctxvals_pos-offset)/8 > size)\n\t\t\tsize = (ctx->ctxvals_pos-offset)/8;\n\n\t\t \n\t\tctx->ctxvals_pos = offset + 6;\n\t\tnv50_gr_construct_gene_zcull(ctx);\n\t\tnv50_gr_construct_gene_clipid(ctx);\n\t\tnv50_gr_construct_gene_eng2d(ctx);\n\t\tif (units & (1 << 0))\n\t\t\tnv50_gr_construct_xfer_tp(ctx);\n\t\tif (units & (1 << 1))\n\t\t\tnv50_gr_construct_xfer_tp(ctx);\n\t\tif (units & (1 << 2))\n\t\t\tnv50_gr_construct_xfer_tp(ctx);\n\t\tif (units & (1 << 3))\n\t\t\tnv50_gr_construct_xfer_tp(ctx);\n\t\tif ((ctx->ctxvals_pos-offset)/8 > size)\n\t\t\tsize = (ctx->ctxvals_pos-offset)/8;\n\n\t\t \n\t\tctx->ctxvals_pos = offset + 7;\n\t\tif (device->chipset == 0xa0) {\n\t\t\tif (units & (1 << 4))\n\t\t\t\tnv50_gr_construct_xfer_tp(ctx);\n\t\t\tif (units & (1 << 5))\n\t\t\t\tnv50_gr_construct_xfer_tp(ctx);\n\t\t\tif (units & (1 << 6))\n\t\t\t\tnv50_gr_construct_xfer_tp(ctx);\n\t\t\tif (units & (1 << 7))\n\t\t\t\tnv50_gr_construct_xfer_tp(ctx);\n\t\t\tif (units & (1 << 8))\n\t\t\t\tnv50_gr_construct_xfer_tp(ctx);\n\t\t\tif (units & (1 << 9))\n\t\t\t\tnv50_gr_construct_xfer_tp(ctx);\n\t\t} else {\n\t\t\tnv50_gr_construct_gene_unk14xx(ctx);\n\t\t}\n\t\tif ((ctx->ctxvals_pos-offset)/8 > size)\n\t\t\tsize = (ctx->ctxvals_pos-offset)/8;\n\t}\n\n\tctx->ctxvals_pos = offset + size * 8;\n\tctx->ctxvals_pos = (ctx->ctxvals_pos+0x3f)&~0x3f;\n\tcp_lsr (ctx, offset);\n\tcp_out (ctx, CP_SET_XFER_POINTER);\n\tcp_lsr (ctx, size);\n\tcp_out (ctx, CP_SEEK_1);\n\tcp_out (ctx, CP_XFER_1);\n\tcp_wait(ctx, XFER, BUSY);\n}\n\n \n\nstatic void\nnv50_gr_construct_gene_dispatch(struct nvkm_grctx *ctx)\n{\n\t \n\tstruct nvkm_device *device = ctx->device;\n\t \n\tif (device->chipset == 0x50)\n\t\txf_emit(ctx, 5, 0);\n\telse if (!IS_NVA3F(device->chipset))\n\t\txf_emit(ctx, 6, 0);\n\telse\n\t\txf_emit(ctx, 4, 0);\n\t \n\t \n\tif (device->chipset == 0x50)\n\t\txf_emit(ctx, 8*3, 0);\n\telse\n\t\txf_emit(ctx, 0x100*3, 0);\n\t \n\txf_emit(ctx, 3, 0);\n\t \n\tif (IS_NVA3F(device->chipset))\n\t\txf_emit(ctx, 3, 0);\n\t \n\t \n\txf_emit(ctx, 9, 0);\n\t \n\txf_emit(ctx, 9, 0);\n\t \n\txf_emit(ctx, 9, 0);\n\t \n\txf_emit(ctx, 9, 0);\n\t \n\tif (device->chipset < 0x90)\n\t\txf_emit(ctx, 4, 0);\n\t \n\txf_emit(ctx, 2, 0);\n\t \n\txf_emit(ctx, 6*2, 0);\n\txf_emit(ctx, 2, 0);\n\t \n\txf_emit(ctx, 2, 0);\n\t \n\txf_emit(ctx, 6*2, 0);\n\txf_emit(ctx, 2, 0);\n\t \n\tif (device->chipset == 0x50)\n\t\txf_emit(ctx, 0x1c, 0);\n\telse if (device->chipset < 0xa0)\n\t\txf_emit(ctx, 0x1e, 0);\n\telse\n\t\txf_emit(ctx, 0x22, 0);\n\t \n\txf_emit(ctx, 0x15, 0);\n}\n\nstatic void\nnv50_gr_construct_gene_m2mf(struct nvkm_grctx *ctx)\n{\n\t \n\tstruct nvkm_device *device = ctx->device;\n\tint smallm2mf = 0;\n\tif (device->chipset < 0x92 || device->chipset == 0x98)\n\t\tsmallm2mf = 1;\n\t \n\txf_emit (ctx, 1, 0);\t\t \n\txf_emit (ctx, 1, 0);\t\t \n\txf_emit (ctx, 1, 0);\t\t \n\txf_emit (ctx, 1, 0);\t\t \n\txf_emit (ctx, 1, 0);\t\t \n\txf_emit (ctx, 1, 0);\t\t \n\txf_emit (ctx, 1, 0);\t\t \n\txf_emit (ctx, 1, 0);\t\t \n\txf_emit (ctx, 1, 0);\t\t \n\txf_emit (ctx, 1, 0x21);\t\t \n\txf_emit (ctx, 1, 1);\t\t \n\txf_emit (ctx, 1, 0x2);\t\t \n\txf_emit (ctx, 1, 0x100);\t \n\txf_emit (ctx, 1, 0x100);\t \n\txf_emit (ctx, 1, 1);\t\t \n\txf_emit (ctx, 1, 0);\t\t \n\txf_emit (ctx, 1, 0);\t\t \n\txf_emit (ctx, 1, 1);\t\t \n\txf_emit (ctx, 1, 0x2);\t\t \n\txf_emit (ctx, 1, 0x100);\t \n\txf_emit (ctx, 1, 0x100);\t \n\txf_emit (ctx, 1, 1);\t\t \n\txf_emit (ctx, 1, 0);\t\t \n\txf_emit (ctx, 1, 0);\t\t \n\txf_emit (ctx, 1, 0);\t\t \n\txf_emit (ctx, 1, 0);\t\t \n\t \n\tif (smallm2mf)\n\t\txf_emit(ctx, 0x40, 0);\t \n\telse\n\t\txf_emit(ctx, 0x100, 0);\t \n\txf_emit(ctx, 4, 0);\t\t \n\t \n\tif (smallm2mf)\n\t\txf_emit(ctx, 0x400, 0);\t \n\telse\n\t\txf_emit(ctx, 0x800, 0);\t \n\txf_emit(ctx, 4, 0);\t\t \n\t \n\txf_emit(ctx, 0x40, 0);\t\t \n\txf_emit(ctx, 0x6, 0);\t\t \n}\n\nstatic void\nnv50_gr_construct_gene_ccache(struct nvkm_grctx *ctx)\n{\n\tstruct nvkm_device *device = ctx->device;\n\txf_emit(ctx, 2, 0);\t\t \n\txf_emit(ctx, 0x800, 0);\t\t \n\tswitch (device->chipset) {\n\tcase 0x50:\n\tcase 0x92:\n\tcase 0xa0:\n\t\txf_emit(ctx, 0x2b, 0);\n\t\tbreak;\n\tcase 0x84:\n\t\txf_emit(ctx, 0x29, 0);\n\t\tbreak;\n\tcase 0x94:\n\tcase 0x96:\n\tcase 0xa3:\n\t\txf_emit(ctx, 0x27, 0);\n\t\tbreak;\n\tcase 0x86:\n\tcase 0x98:\n\tcase 0xa5:\n\tcase 0xa8:\n\tcase 0xaa:\n\tcase 0xac:\n\tcase 0xaf:\n\t\txf_emit(ctx, 0x25, 0);\n\t\tbreak;\n\t}\n\t \n\txf_emit(ctx, 0x100, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 0x30, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 4, 0);\t\t \n\txf_emit(ctx, 0x100, 0);\t\t \n\txf_emit(ctx, 8, 0);\t\t \n\txf_emit(ctx, 8, 0);\t\t \n\txf_emit(ctx, 4, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0x3fffff);\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0x1fff);\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n}\n\nstatic void\nnv50_gr_construct_gene_unk10xx(struct nvkm_grctx *ctx)\n{\n\tstruct nvkm_device *device = ctx->device;\n\tint i;\n\t \n\txf_emit(ctx, 1, 4);\t\t \n\txf_emit(ctx, 1, 4);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0x80);\t\t \n\txf_emit(ctx, 1, 4);\t\t \n\txf_emit(ctx, 1, 0x80c14);\t \n\txf_emit(ctx, 1, 0);\t\t \n\tif (device->chipset == 0x50)\n\t\txf_emit(ctx, 1, 0x3ff);\n\telse\n\t\txf_emit(ctx, 1, 0x7ff);\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\tfor (i = 0; i < 8; i++) {\n\t\tswitch (device->chipset) {\n\t\tcase 0x50:\n\t\tcase 0x86:\n\t\tcase 0x98:\n\t\tcase 0xaa:\n\t\tcase 0xac:\n\t\t\txf_emit(ctx, 0xa0, 0);\t \n\t\t\tbreak;\n\t\tcase 0x84:\n\t\tcase 0x92:\n\t\tcase 0x94:\n\t\tcase 0x96:\n\t\t\txf_emit(ctx, 0x120, 0);\n\t\t\tbreak;\n\t\tcase 0xa5:\n\t\tcase 0xa8:\n\t\t\txf_emit(ctx, 0x100, 0);\t \n\t\t\tbreak;\n\t\tcase 0xa0:\n\t\tcase 0xa3:\n\t\tcase 0xaf:\n\t\t\txf_emit(ctx, 0x400, 0);\t \n\t\t\tbreak;\n\t\t}\n\t\txf_emit(ctx, 4, 0);\t \n\t\txf_emit(ctx, 4, 0);\t \n\t}\n\txf_emit(ctx, 1, 4);\t\t \n\txf_emit(ctx, 1, 4);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0x80);\t\t \n\txf_emit(ctx, 1, 4);\t\t \n\txf_emit(ctx, 1, 1);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0x27);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0x26);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n}\n\nstatic void\nnv50_gr_construct_gene_unk34xx(struct nvkm_grctx *ctx)\n{\n\tstruct nvkm_device *device = ctx->device;\n\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 0x10, 0x04000000);\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 0x20, 0);\t\t \n\txf_emit(ctx, 2, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0x04e3bfdf);\t \n\txf_emit(ctx, 1, 0x04e3bfdf);\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0x1fe21);\t \n\tif (device->chipset >= 0xa0)\n\t\txf_emit(ctx, 1, 0x0fac6881);\n\tif (IS_NVA3F(device->chipset)) {\n\t\txf_emit(ctx, 1, 1);\n\t\txf_emit(ctx, 3, 0);\n\t}\n}\n\nstatic void\nnv50_gr_construct_gene_unk14xx(struct nvkm_grctx *ctx)\n{\n\tstruct nvkm_device *device = ctx->device;\n\t \n\tif (device->chipset != 0x50) {\n\t\txf_emit(ctx, 5, 0);\t\t \n\t\txf_emit(ctx, 1, 0x80c14);\t \n\t\txf_emit(ctx, 1, 0);\t\t \n\t\txf_emit(ctx, 1, 0);\t\t \n\t\txf_emit(ctx, 1, 0x804);\t\t \n\t\txf_emit(ctx, 1, 0);\t\t \n\t\txf_emit(ctx, 2, 4);\t\t \n\t\txf_emit(ctx, 1, 0x8100c12);\t \n\t}\n\txf_emit(ctx, 1, 0);\t\t\t \n\txf_emit(ctx, 1, 4);\t\t\t \n\txf_emit(ctx, 1, 4);\t\t\t \n\txf_emit(ctx, 1, 0);\t\t\t \n\txf_emit(ctx, 1, 0x10);\t\t\t \n\txf_emit(ctx, 1, 0);\t\t\t \n\tif (device->chipset != 0x50)\n\t\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t\t \n\txf_emit(ctx, 1, 0);\t\t\t \n\txf_emit(ctx, 1, 0x804);\t\t\t \n\txf_emit(ctx, 1, 1);\t\t\t \n\txf_emit(ctx, 1, 0x1a);\t\t\t \n\tif (device->chipset != 0x50)\n\t\txf_emit(ctx, 1, 0x7f);\t\t \n\txf_emit(ctx, 1, 0);\t\t\t \n\txf_emit(ctx, 1, 1);\t\t\t \n\txf_emit(ctx, 1, 0x80c14);\t\t \n\txf_emit(ctx, 1, 0);\t\t\t \n\txf_emit(ctx, 1, 0x8100c12);\t\t \n\txf_emit(ctx, 1, 4);\t\t\t \n\txf_emit(ctx, 1, 4);\t\t\t \n\txf_emit(ctx, 1, 0);\t\t\t \n\txf_emit(ctx, 1, 0x10);\t\t\t \n\txf_emit(ctx, 1, 0);\t\t\t \n\txf_emit(ctx, 1, 0);\t\t\t \n\txf_emit(ctx, 1, 0);\t\t\t \n\txf_emit(ctx, 1, 1);\t\t\t \n\txf_emit(ctx, 1, 0x8100c12);\t\t \n\txf_emit(ctx, 4, 0);\t\t\t \n\txf_emit(ctx, 1, 0);\t\t\t \n\txf_emit(ctx, 1, 0);\t\t\t \n\tif (device->chipset == 0x50)\n\t\txf_emit(ctx, 1, 0x3ff);\t\t \n\telse\n\t\txf_emit(ctx, 1, 0x7ff);\t\t \n\txf_emit(ctx, 1, 0x80c14);\t\t \n\txf_emit(ctx, 1, 0);\t\t\t \n\txf_emit(ctx, 0x30, 0);\t\t\t \n\txf_emit(ctx, 3, 0);\t\t\t \n\txf_emit(ctx, 3, 0);\t\t\t \n\txf_emit(ctx, 1, 0);\t\t\t \n\txf_emit(ctx, 1, 1);\t\t\t \n\txf_emit(ctx, 1, 0);\t\t\t \n\txf_emit(ctx, 1, 0);\t\t\t \n\txf_emit(ctx, 1, 0x10);\t\t\t \n\txf_emit(ctx, 1, 0);\t\t\t \n\txf_emit(ctx, 0x30, 0);\t\t\t \n\txf_emit(ctx, 3, 0);\t\t\t \n\txf_emit(ctx, 3, 0);\t\t\t \n\txf_emit(ctx, 1, 0);\t\t\t \n\txf_emit(ctx, 2, 0x88);\t\t\t \n\txf_emit(ctx, 1, 0);\t\t\t \n\txf_emit(ctx, 1, 0);\t\t\t \n\txf_emit(ctx, 1, 4);\t\t\t \n\txf_emit(ctx, 2, 0);\t\t\t \n\txf_emit(ctx, 2, 0);\t\t\t \n\txf_emit(ctx, 1, 0);\t\t\t \n\txf_emit(ctx, 0x10, 0);\t\t\t \n\txf_emit(ctx, 1, 0);\t\t\t \n\txf_emit(ctx, 1, 0x26);\t\t\t \n\txf_emit(ctx, 1, 0);\t\t\t \n\txf_emit(ctx, 1, 0);\t\t\t \n\txf_emit(ctx, 1, 0x3f800000);\t\t \n\txf_emit(ctx, 1, 0);\t\t\t \n\txf_emit(ctx, 1, 0);\t\t\t \n\txf_emit(ctx, 1, 0);\t\t\t \n\tif (IS_NVA3F(device->chipset))\n\t\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0x1a);\t\t\t \n\txf_emit(ctx, 1, 0x10);\t\t\t \n\tif (device->chipset != 0x50) {\n\t\txf_emit(ctx, 1, 0);\t\t \n\t\txf_emit(ctx, 1, 0);\t\t \n\t\txf_emit(ctx, 1, 0);\t\t \n\t}\n\txf_emit(ctx, 0x20, 0);\t\t\t \n\txf_emit(ctx, 1, 0);\t\t\t \n\txf_emit(ctx, 1, 0);\t\t\t \n\txf_emit(ctx, 1, 0);\t\t\t \n\txf_emit(ctx, 1, 0);\t\t\t \n\txf_emit(ctx, 1, 0);\t\t\t \n\txf_emit(ctx, 1, 0x52);\t\t\t \n\txf_emit(ctx, 1, 0);\t\t\t \n\txf_emit(ctx, 1, 0x26);\t\t\t \n\txf_emit(ctx, 1, 0);\t\t\t \n\txf_emit(ctx, 1, 4);\t\t\t \n\txf_emit(ctx, 1, 4);\t\t\t \n\txf_emit(ctx, 1, 0);\t\t\t \n\txf_emit(ctx, 1, 0x1a);\t\t\t \n\txf_emit(ctx, 1, 0);\t\t\t \n\txf_emit(ctx, 1, 0);\t\t\t \n\txf_emit(ctx, 1, 0x00ffff00);\t\t \n\txf_emit(ctx, 1, 0);\t\t\t \n}\n\nstatic void\nnv50_gr_construct_gene_zcull(struct nvkm_grctx *ctx)\n{\n\tstruct nvkm_device *device = ctx->device;\n\t \n\t \n\txf_emit(ctx, 1, 0x3f);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 3, 0);\t\t \n\txf_emit(ctx, 1, 2);\t\t \n\txf_emit(ctx, 2, 0x04000000);\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 2, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 4);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 4);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 3, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\tif (device->chipset != 0x50)\n\t\txf_emit(ctx, 1, 0);\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 1);\t\t \n\txf_emit(ctx, 1, 0x1001);\t \n\t \n\txf_emit(ctx, 4, 0xffff);\t \n\txf_emit(ctx, 0x10, 0);\t\t \n\txf_emit(ctx, 0x10, 0);\t\t \n\txf_emit(ctx, 0x10, 0x3f800000);\t \n\txf_emit(ctx, 1, 0x10);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 3);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\tif (device->chipset != 0x50)\n\t\txf_emit(ctx, 1, 0);\t \n\txf_emit(ctx, 1, 0);\t\t \n}\n\nstatic void\nnv50_gr_construct_gene_clipid(struct nvkm_grctx *ctx)\n{\n\t \n\t \n\txf_emit(ctx, 1, 0);\t\t \n\t \n\txf_emit(ctx, 4, 0);\t\t \n\txf_emit(ctx, 4, 0);\t\t \n\txf_emit(ctx, 2, 0);\t\t \n\txf_emit(ctx, 2, 0x04000000);\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0x80);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0x80);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n}\n\nstatic void\nnv50_gr_construct_gene_unk24xx(struct nvkm_grctx *ctx)\n{\n\tstruct nvkm_device *device = ctx->device;\n\tint i;\n\t \n\t \n\txf_emit(ctx, 0x33, 0);\n\t \n\txf_emit(ctx, 2, 0);\n\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 4);\t\t \n\txf_emit(ctx, 1, 4);\t\t \n\t \n\tif (IS_NVA3F(device->chipset)) {\n\t\txf_emit(ctx, 4, 0);\t \n\t\txf_emit(ctx, 0xe10, 0);  \n\t\txf_emit(ctx, 1, 0);\t \n\t\txf_emit(ctx, 8, 0);\t \n\t\txf_emit(ctx, 9, 0);\t \n\n\t\txf_emit(ctx, 4, 0);\t \n\t\txf_emit(ctx, 0xe10, 0);  \n\t\txf_emit(ctx, 1, 0);\t \n\t\txf_emit(ctx, 8, 0);\t \n\t\txf_emit(ctx, 9, 0);\t \n\t} else {\n\t\txf_emit(ctx, 0xc, 0);\t \n\t\t \n\t\txf_emit(ctx, 0xe10, 0);  \n\t\txf_emit(ctx, 1, 0);\t \n\t\txf_emit(ctx, 8, 0);\t \n\n\t\t \n\t\txf_emit(ctx, 0xc, 0);\t \n\t\t \n\t\txf_emit(ctx, 0xe10, 0);  \n\t\txf_emit(ctx, 1, 0);\t \n\t\txf_emit(ctx, 8, 0);\t \n\t}\n\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 4);\t\t \n\txf_emit(ctx, 1, 4);\t\t \n\txf_emit(ctx, 1, 0x8100c12);\t \n\tif (device->chipset != 0x50)\n\t\txf_emit(ctx, 1, 3);\t \n\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0x8100c12);\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0x80c14);\t \n\txf_emit(ctx, 1, 1);\t\t \n\t \n\tif (device->chipset >= 0xa0)\n\t\txf_emit(ctx, 2, 4);\t \n\txf_emit(ctx, 1, 0x80c14);\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0x8100c12);\t \n\txf_emit(ctx, 1, 0x27);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 1);\t\t \n\tfor (i = 0; i < 10; i++) {\n\t\t \n\t\txf_emit(ctx, 0x40, 0);\t\t \n\t\txf_emit(ctx, 0x10, 0);\t\t \n\t\txf_emit(ctx, 0x10, 0);\t\t \n\t}\n\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 1);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 4, 0);\t\t \n\txf_emit(ctx, 0x10, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0x8100c12);\t \n\tif (device->chipset != 0x50)\n\t\txf_emit(ctx, 1, 0);\t \n}\n\nstatic void\nnv50_gr_construct_gene_vfetch(struct nvkm_grctx *ctx)\n{\n\tstruct nvkm_device *device = ctx->device;\n\tint acnt = 0x10, rep, i;\n\t \n\tif (IS_NVA3F(device->chipset))\n\t\tacnt = 0x20;\n\t \n\tif (device->chipset >= 0xa0) {\n\t\txf_emit(ctx, 1, 0);\t \n\t\txf_emit(ctx, 1, 1);\t \n\t}\n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0xf);\t\t \n\txf_emit(ctx, (acnt/8)-1, 0);\t \n\txf_emit(ctx, acnt/8, 0);\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0x20);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\t \n\tif (IS_NVA3F(device->chipset))\n\t\txf_emit(ctx, 0xb, 0);\t \n\telse if (device->chipset >= 0xa0)\n\t\txf_emit(ctx, 0x9, 0);\t \n\telse\n\t\txf_emit(ctx, 0x8, 0);\t \n\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0x1a);\t\t \n\t \n\txf_emit(ctx, 0xc, 0);\t\t \n\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 4);\t\t \n\txf_emit(ctx, 1, 4);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 4);\t\t \n\txf_emit(ctx, 1, 8);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\tif (device->chipset == 0x50)\n\t\txf_emit(ctx, 1, 0x3ff);\t \n\telse\n\t\txf_emit(ctx, 1, 0x7ff);\t \n\tif (device->chipset == 0xa8)\n\t\txf_emit(ctx, 1, 0x1e00);\t \n\t \n\txf_emit(ctx, 0xc, 0);\t\t \n\t \n\txf_emit(ctx, 1, 0xf);\t\t \n\txf_emit(ctx, (acnt/8)-1, 0);\t \n\txf_emit(ctx, 1, 0);\t\t \n\tif (device->chipset > 0x50 && device->chipset < 0xa0)\n\t\txf_emit(ctx, 2, 0);\t \n\telse\n\t\txf_emit(ctx, 1, 0);\t \n\txf_emit(ctx, 1, 0);\t\t \n\t \n\tif (IS_NVA3F(device->chipset)) {\n\t\txf_emit(ctx, 0x10, 0);\t \n\t\txf_emit(ctx, 2, 0);\t \n\t\txf_emit(ctx, 2, 0);\t \n\t} else {\n\t\txf_emit(ctx, 8, 0);\t \n\t\txf_emit(ctx, 1, 0);\t \n\t\txf_emit(ctx, 2, 0);\t \n\t}\n\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, acnt, 0);\t\t \n\tif (device->chipset >= 0xa0)\n\t\txf_emit(ctx, 1, 0);\t \n\t \n\txf_emit(ctx, acnt, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\t \n\txf_emit(ctx, acnt, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\t \n\txf_emit(ctx, acnt, 0);\t\t \n\txf_emit(ctx, 2, 0);\t\t \n\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\t \n\txf_emit(ctx, acnt, 0);\t\t \n\txf_emit(ctx, 3, 0);\t\t \n\t \n\txf_emit(ctx, acnt, 0);\t\t \n\txf_emit(ctx, 3, 0);\t\t \n\t \n\txf_emit(ctx, acnt, 0);\t\t \n\txf_emit(ctx, 3, 0);\t\t \n\t \n\txf_emit(ctx, acnt, 0);\t\t \n\txf_emit(ctx, 3, 0);\t\t \n\t \n\txf_emit(ctx, acnt, 0);\t\t \n\txf_emit(ctx, 3, 0);\t\t \n\t \n\txf_emit(ctx, acnt, 0);\t\t \n\txf_emit(ctx, 3, 0);\t\t \n\t \n\tif (IS_NVA3F(device->chipset)) {\n\t\txf_emit(ctx, acnt, 0);\t\t \n\t\txf_emit(ctx, 3, 0);\t\t \n\t}\n\t \n\tif (IS_NVA3F(device->chipset))\n\t\txf_emit(ctx, 2, 0);\t \n\telse\n\t\txf_emit(ctx, 5, 0);\t \n\t \n\txf_emit(ctx, 1, 0);\t\t \n\t \n\tif (device->chipset < 0xa0) {\n\t\txf_emit(ctx, 0x41, 0);\t \n\t\t \n\t\txf_emit(ctx, 0x11, 0);\t \n\t} else if (!IS_NVA3F(device->chipset))\n\t\txf_emit(ctx, 0x50, 0);\t \n\telse\n\t\txf_emit(ctx, 0x58, 0);\t \n\t \n\txf_emit(ctx, 1, 0xf);\t\t \n\txf_emit(ctx, (acnt/8)-1, 0);\t \n\txf_emit(ctx, 1, 1);\t\t \n\t \n\txf_emit(ctx, acnt*4, 0);\t \n\txf_emit(ctx, 4, 0);\t\t \n\t \n\tif (IS_NVA3F(device->chipset))\n\t\txf_emit(ctx, 0x1d, 0);\t \n\telse\n\t\txf_emit(ctx, 0x16, 0);\t \n\t \n\txf_emit(ctx, 1, 0xf);\t\t \n\txf_emit(ctx, (acnt/8)-1, 0);\t \n\t \n\tif (device->chipset < 0xa0)\n\t\txf_emit(ctx, 8, 0);\t \n\telse if (IS_NVA3F(device->chipset))\n\t\txf_emit(ctx, 0xc, 0);\t \n\telse\n\t\txf_emit(ctx, 7, 0);\t \n\t \n\txf_emit(ctx, 0xa, 0);\t\t \n\tif (device->chipset == 0xa0)\n\t\trep = 0xc;\n\telse\n\t\trep = 4;\n\tfor (i = 0; i < rep; i++) {\n\t\t \n\t\tif (IS_NVA3F(device->chipset))\n\t\t\txf_emit(ctx, 0x20, 0);\t \n\t\txf_emit(ctx, 0x200, 0);\t \n\t\txf_emit(ctx, 4, 0);\t \n\t\txf_emit(ctx, 4, 0);\t \n\t}\n\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0xf);\t\t \n\txf_emit(ctx, (acnt/8)-1, 0);\t \n\txf_emit(ctx, acnt/8, 0);\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\t \n\tif (IS_NVA3F(device->chipset))\n\t\txf_emit(ctx, 7, 0);\t \n\telse\n\t\txf_emit(ctx, 5, 0);\t \n}\n\nstatic void\nnv50_gr_construct_gene_eng2d(struct nvkm_grctx *ctx)\n{\n\tstruct nvkm_device *device = ctx->device;\n\t \n\t \n\txf_emit(ctx, 2, 0);\t\t \n\txf_emit(ctx, 2, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\tif (device->chipset < 0xa0) {\n\t\t \n\t\txf_emit(ctx, 2, 0);\t \n\t\txf_emit(ctx, 2, 1);\t \n\t\txf_emit(ctx, 1, 0);\t \n\t}\n\txf_emit(ctx, 1, 1);\t\t \n\txf_emit(ctx, 1, 0x100);\t\t \n\txf_emit(ctx, 1, 0x100);\t\t \n\txf_emit(ctx, 1, 0x11);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 8);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 1);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 1);\t\t \n\txf_emit(ctx, 1, 1);\t\t \n\txf_emit(ctx, 1, 1);\t\t \n\txf_emit(ctx, 1, 0xcf);\t\t \n\txf_emit(ctx, 1, 2);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 1);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 1);\t\t \n\txf_emit(ctx, 1, 1);\t\t \n\txf_emit(ctx, 1, 1);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 4);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 1);\t\t \n\txf_emit(ctx, 1, 0x15);\t\t \n\txf_emit(ctx, 2, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0x4444480);\t \n\t \n\txf_emit(ctx, 0x10, 0);\n\t \n\txf_emit(ctx, 0x27, 0);\n}\n\nstatic void\nnv50_gr_construct_gene_csched(struct nvkm_grctx *ctx)\n{\n\tstruct nvkm_device *device = ctx->device;\n\t \n\t \n\txf_emit(ctx, 2, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0x8100c12);\t \n\txf_emit(ctx, 1, 0);\t\t \n\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0x100);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0x10001);\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0x10001);\t \n\txf_emit(ctx, 1, 1);\t\t \n\txf_emit(ctx, 1, 0x10001);\t \n\txf_emit(ctx, 1, 1);\t\t \n\txf_emit(ctx, 1, 4);\t\t \n\txf_emit(ctx, 1, 2);\t\t \n\t \n\txf_emit(ctx, 0x40, 0);\t\t \n\tswitch (device->chipset) {\n\tcase 0x50:\n\tcase 0x92:\n\t\txf_emit(ctx, 8, 0);\t \n\t\txf_emit(ctx, 0x80, 0);\t \n\t\txf_emit(ctx, 2, 0);\t \n\t\txf_emit(ctx, 0x10*2, 0);\t \n\t\tbreak;\n\tcase 0x84:\n\t\txf_emit(ctx, 8, 0);\t \n\t\txf_emit(ctx, 0x60, 0);\t \n\t\txf_emit(ctx, 2, 0);\t \n\t\txf_emit(ctx, 0xc*2, 0);\t \n\t\tbreak;\n\tcase 0x94:\n\tcase 0x96:\n\t\txf_emit(ctx, 8, 0);\t \n\t\txf_emit(ctx, 0x40, 0);\t \n\t\txf_emit(ctx, 2, 0);\t \n\t\txf_emit(ctx, 8*2, 0);\t \n\t\tbreak;\n\tcase 0x86:\n\tcase 0x98:\n\t\txf_emit(ctx, 4, 0);\t \n\t\txf_emit(ctx, 0x10, 0);\t \n\t\txf_emit(ctx, 2, 0);\t \n\t\txf_emit(ctx, 2*2, 0);\t \n\t\tbreak;\n\tcase 0xa0:\n\t\txf_emit(ctx, 8, 0);\t \n\t\txf_emit(ctx, 0xf0, 0);\t \n\t\txf_emit(ctx, 2, 0);\t \n\t\txf_emit(ctx, 0x1e*2, 0);\t \n\t\tbreak;\n\tcase 0xa3:\n\t\txf_emit(ctx, 8, 0);\t \n\t\txf_emit(ctx, 0x60, 0);\t \n\t\txf_emit(ctx, 2, 0);\t \n\t\txf_emit(ctx, 0xc*2, 0);\t \n\t\tbreak;\n\tcase 0xa5:\n\tcase 0xaf:\n\t\txf_emit(ctx, 8, 0);\t \n\t\txf_emit(ctx, 0x30, 0);\t \n\t\txf_emit(ctx, 2, 0);\t \n\t\txf_emit(ctx, 6*2, 0);\t \n\t\tbreak;\n\tcase 0xaa:\n\t\txf_emit(ctx, 0x12, 0);\n\t\tbreak;\n\tcase 0xa8:\n\tcase 0xac:\n\t\txf_emit(ctx, 4, 0);\t \n\t\txf_emit(ctx, 0x10, 0);\t \n\t\txf_emit(ctx, 2, 0);\t \n\t\txf_emit(ctx, 2*2, 0);\t \n\t\tbreak;\n\t}\n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 4, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 4, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n}\n\nstatic void\nnv50_gr_construct_gene_unk1cxx(struct nvkm_grctx *ctx)\n{\n\tstruct nvkm_device *device = ctx->device;\n\txf_emit(ctx, 2, 0);\t\t \n\txf_emit(ctx, 1, 0x3f800000);\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 3, 0);\t\t \n\txf_emit(ctx, 1, 4);\t\t \n\txf_emit(ctx, 1, 0x1a);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 1);\t\t \n\txf_emit(ctx, 0x10, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0x00ffff00);\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 2, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0xf);\t\t \n\txf_emit(ctx, 7, 0);\t\t \n\txf_emit(ctx, 1, 0x0fac6881);\t \n\txf_emit(ctx, 1, 0x11);\t\t \n\txf_emit(ctx, 7, 0);\t\t \n\txf_emit(ctx, 8, 0);\t\t \n\txf_emit(ctx, 1, 4);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\tif (IS_NVA3F(device->chipset))\n\t\txf_emit(ctx, 1, 3);\t \n\telse if (device->chipset >= 0xa0)\n\t\txf_emit(ctx, 1, 1);\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 2);\t\t \n\txf_emit(ctx, 2, 0x04000000);\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 5);\t\t \n\txf_emit(ctx, 1, 0x52);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\tif (device->chipset != 0x50) {\n\t\txf_emit(ctx, 1, 0);\t \n\t\txf_emit(ctx, 1, 1);\t \n\t}\n\tif (IS_NVA3F(device->chipset))\n\t\txf_emit(ctx, 1, 0);\t \n\txf_emit(ctx, 0x10, 0);\t\t \n\txf_emit(ctx, 0x10, 0x3f800000);\t \n\txf_emit(ctx, 1, 0x10);\t\t \n\txf_emit(ctx, 0x20, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0x8100c12);\t \n\txf_emit(ctx, 1, 5);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 1);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 4, 0xffff);\t \n\tif (device->chipset != 0x50)\n\t\txf_emit(ctx, 1, 3);\t \n\tif (device->chipset < 0xa0)\n\t\txf_emit(ctx, 0x1c, 0);\t \n\telse if (IS_NVA3F(device->chipset))\n\t\txf_emit(ctx, 0x9, 0);\n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0x00ffff00);\t \n\txf_emit(ctx, 1, 0x1a);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\tif (device->chipset != 0x50) {\n\t\txf_emit(ctx, 1, 3);\t \n\t\txf_emit(ctx, 1, 0);\t \n\t}\n\t \n\tif (device->chipset < 0xa0)\n\t\txf_emit(ctx, 0x25, 0);\n\telse\n\t\txf_emit(ctx, 0x3b, 0);\n}\n\nstatic void\nnv50_gr_construct_gene_strmout(struct nvkm_grctx *ctx)\n{\n\tstruct nvkm_device *device = ctx->device;\n\txf_emit(ctx, 1, 0x102);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 4, 4);\t\t \n\tif (device->chipset >= 0xa0) {\n\t\txf_emit(ctx, 4, 0);\t \n\t\txf_emit(ctx, 4, 0);\t \n\t}\n\txf_emit(ctx, 1, 4);\t\t \n\txf_emit(ctx, 1, 4);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\tif (device->chipset == 0x50)\n\t\txf_emit(ctx, 1, 0x3ff);\t \n\telse\n\t\txf_emit(ctx, 1, 0x7ff);\t \n\txf_emit(ctx, 1, 0);\t\t \n\t \n\txf_emit(ctx, 1, 0x102);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 4, 0);\t\t \n\txf_emit(ctx, 4, 0);\t\t \n\txf_emit(ctx, 4, 4);\t\t \n\tif (device->chipset >= 0xa0) {\n\t\txf_emit(ctx, 4, 0);\t \n\t\txf_emit(ctx, 4, 0);\t \n\t}\n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 2, 0);\t\t \n\txf_emit(ctx, 2, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\t \n\txf_emit(ctx, 0x20, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 2, 0);\t\t \n}\n\nstatic void\nnv50_gr_construct_gene_ropm1(struct nvkm_grctx *ctx)\n{\n\tstruct nvkm_device *device = ctx->device;\n\txf_emit(ctx, 1, 0x4e3bfdf);\t \n\txf_emit(ctx, 1, 0x4e3bfdf);\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\tif (IS_NVA3F(device->chipset))\n\t\txf_emit(ctx, 1, 0x11);\t \n\txf_emit(ctx, 1, 0);\t\t \n}\n\nstatic void\nnv50_gr_construct_gene_ropm2(struct nvkm_grctx *ctx)\n{\n\tstruct nvkm_device *device = ctx->device;\n\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0x0fac6881);\t \n\txf_emit(ctx, 2, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 2, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 2, 0);\t\t \n\txf_emit(ctx, 1, 0x4e3bfdf);\t \n\txf_emit(ctx, 1, 0x4e3bfdf);\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\tif (IS_NVA3F(device->chipset))\n\t\txf_emit(ctx, 1, 0x11);\t \n\txf_emit(ctx, 1, 0);\t\t \n}\n\nstatic void\nnv50_gr_construct_gene_ropc(struct nvkm_grctx *ctx)\n{\n\tstruct nvkm_device *device = ctx->device;\n\tint magic2;\n\tif (device->chipset == 0x50) {\n\t\tmagic2 = 0x00003e60;\n\t} else if (!IS_NVA3F(device->chipset)) {\n\t\tmagic2 = 0x001ffe67;\n\t} else {\n\t\tmagic2 = 0x00087e67;\n\t}\n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 3, 0);\t\t \n\txf_emit(ctx, 1, 2);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, magic2);\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\tif (IS_NVA3F(device->chipset))\n\t\txf_emit(ctx, 1, 1);\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 3, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\tif (device->chipset >= 0xa0 && !IS_NVAAF(device->chipset))\n\t\txf_emit(ctx, 1, 0x15);\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 1);\t\t \n\txf_emit(ctx, 1, 0x10);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 1);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\tif (device->chipset == 0x86 || device->chipset == 0x92 || device->chipset == 0x98 || device->chipset >= 0xa0) {\n\t\txf_emit(ctx, 3, 0);\t \n\t\txf_emit(ctx, 1, 4);\t \n\t\txf_emit(ctx, 1, 0x400);\t \n\t\txf_emit(ctx, 1, 0x300);\t \n\t\txf_emit(ctx, 1, 0x1001);\t \n\t\tif (device->chipset != 0xa0) {\n\t\t\tif (IS_NVA3F(device->chipset))\n\t\t\t\txf_emit(ctx, 1, 0);\t \n\t\t\telse\n\t\t\t\txf_emit(ctx, 1, 0x15);\t \n\t\t}\n\t}\n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 2);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 1);\t\t \n\txf_emit(ctx, 1, 0x10);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 1);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 2, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0x10);\t\t \n\txf_emit(ctx, 0x10, 0);\t\t \n\txf_emit(ctx, 0x10, 0x3f800000);\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 3, 0);\t\t \n\txf_emit(ctx, 2, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 3, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0x10);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0x3f);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 2, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 1);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 1);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 1);\t\t \n\tif (device->chipset >= 0xa0) {\n\t\txf_emit(ctx, 2, 0);\n\t\txf_emit(ctx, 1, 0x1001);\n\t\txf_emit(ctx, 0xb, 0);\n\t} else {\n\t\txf_emit(ctx, 1, 0);\t \n\t\txf_emit(ctx, 1, 0);\t \n\t\txf_emit(ctx, 1, 0);\t \n\t\txf_emit(ctx, 8, 0);\t \n\t\txf_emit(ctx, 1, 0);\t \n\t}\n\txf_emit(ctx, 1, 0x11);\t\t \n\txf_emit(ctx, 7, 0);\t\t \n\txf_emit(ctx, 1, 0xf);\t\t \n\txf_emit(ctx, 7, 0);\t\t \n\txf_emit(ctx, 1, 0x11);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\tif (device->chipset != 0x50) {\n\t\txf_emit(ctx, 1, 0);\t \n\t\txf_emit(ctx, 1, 0);\t \n\t}\n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 2, 1);\t\t \n\txf_emit(ctx, 1, 1);\t\t \n\txf_emit(ctx, 1, 2);\t\t \n\txf_emit(ctx, 1, 1);\t\t \n\txf_emit(ctx, 1, 2);\t\t \n\txf_emit(ctx, 1, 1);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, magic2);\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0x0fac6881);\t \n\tif (IS_NVA3F(device->chipset)) {\n\t\txf_emit(ctx, 1, 0);\t \n\t\txf_emit(ctx, 8, 1);\t \n\t\txf_emit(ctx, 8, 1);\t \n\t\txf_emit(ctx, 8, 1);\t \n\t\txf_emit(ctx, 8, 2);\t \n\t\txf_emit(ctx, 8, 1);\t \n\t\txf_emit(ctx, 8, 2);\t \n\t\txf_emit(ctx, 8, 1);\t \n\t\txf_emit(ctx, 1, 0);\t \n\t\txf_emit(ctx, 2, 0);\t \n\t\txf_emit(ctx, 1, 1);\t \n\t\txf_emit(ctx, 1, 0);\t \n\t\txf_emit(ctx, 1, 0);\t \n\t\txf_emit(ctx, 1, 0);\t \n\t\txf_emit(ctx, 2, 0);\t \n\t\txf_emit(ctx, 1, 1);\t \n\t\txf_emit(ctx, 1, 0);\t \n\t\txf_emit(ctx, 1, 0);\t \n\t} else if (device->chipset >= 0xa0) {\n\t\txf_emit(ctx, 2, 0);\t \n\t\txf_emit(ctx, 1, 0);\t \n\t\txf_emit(ctx, 1, 0);\t \n\t\txf_emit(ctx, 1, 0);\t \n\t\txf_emit(ctx, 2, 0);\t \n\t} else {\n\t\txf_emit(ctx, 1, 0);\t \n\t\txf_emit(ctx, 1, 0);\t \n\t\txf_emit(ctx, 1, 0);\t \n\t}\n\txf_emit(ctx, 4, 0);\t\t \n\txf_emit(ctx, 4, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\tif (device->chipset >= 0xa0)\n\t\txf_emit(ctx, 2, 0);\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 8, 0);\t\t \n\txf_emit(ctx, 1, 1);\t\t \n\txf_emit(ctx, 1, 2);\t\t \n\txf_emit(ctx, 1, 1);\t\t \n\txf_emit(ctx, 1, 1);\t\t \n\txf_emit(ctx, 1, 2);\t\t \n\txf_emit(ctx, 1, 1);\t\t \n\txf_emit(ctx, 1, 1);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\tif (device->chipset >= 0xa0)\n\t\txf_emit(ctx, 1, 0);\t \n\tif (IS_NVA3F(device->chipset)) {\n\t\txf_emit(ctx, 8, 1);\t \n\t\txf_emit(ctx, 8, 1);\t \n\t\txf_emit(ctx, 8, 2);\t \n\t\txf_emit(ctx, 8, 1);\t \n\t\txf_emit(ctx, 8, 1);\t \n\t\txf_emit(ctx, 8, 2);\t \n\t\txf_emit(ctx, 8, 1);\t \n\t\txf_emit(ctx, 1, 0);\t \n\t\txf_emit(ctx, 1, 0);\t \n\t\txf_emit(ctx, 1, 0);\t \n\t}\n\txf_emit(ctx, 1, 0x11);\t\t \n\txf_emit(ctx, 1, 1);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 2, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 2, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 0x50, 0);\t\t \n}\n\nstatic void\nnv50_gr_construct_xfer_unk84xx(struct nvkm_grctx *ctx)\n{\n\tstruct nvkm_device *device = ctx->device;\n\tint magic3;\n\tswitch (device->chipset) {\n\tcase 0x50:\n\t\tmagic3 = 0x1000;\n\t\tbreak;\n\tcase 0x86:\n\tcase 0x98:\n\tcase 0xa8:\n\tcase 0xaa:\n\tcase 0xac:\n\tcase 0xaf:\n\t\tmagic3 = 0x1e00;\n\t\tbreak;\n\tdefault:\n\t\tmagic3 = 0;\n\t}\n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 4);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\tif (IS_NVA3F(device->chipset))\n\t\txf_emit(ctx, 0x1f, 0);\t \n\telse if (device->chipset >= 0xa0)\n\t\txf_emit(ctx, 0x0f, 0);\t \n\telse\n\t\txf_emit(ctx, 0x10, 0);\t \n\txf_emit(ctx, 2, 0);\t\t \n\txf_emit(ctx, 1, 4);\t\t \n\txf_emit(ctx, 1, 4);\t\t \n\tif (device->chipset >= 0xa0)\n\t\txf_emit(ctx, 1, 0x03020100);\t \n\telse\n\t\txf_emit(ctx, 1, 0x00608080);\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 2, 0);\t\t \n\txf_emit(ctx, 1, 4);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 4);\t\t \n\txf_emit(ctx, 1, 4);\t\t \n\txf_emit(ctx, 1, 0x80);\t\t \n\tif (magic3)\n\t\txf_emit(ctx, 1, magic3);\t \n\txf_emit(ctx, 1, 4);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 0x1f, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 4);\t\t \n\txf_emit(ctx, 1, 0x80);\t\t \n\txf_emit(ctx, 1, 4);\t\t \n\txf_emit(ctx, 1, 0x03020100);\t \n\txf_emit(ctx, 1, 3);\t\t \n\tif (magic3)\n\t\txf_emit(ctx, 1, magic3);\t \n\txf_emit(ctx, 1, 4);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 4);\t\t \n\txf_emit(ctx, 1, 3);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 4);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\tif (device->chipset == 0x94 || device->chipset == 0x96)\n\t\txf_emit(ctx, 0x1020, 0);\t \n\telse if (device->chipset < 0xa0)\n\t\txf_emit(ctx, 0xa20, 0);\t \n\telse if (!IS_NVA3F(device->chipset))\n\t\txf_emit(ctx, 0x210, 0);\t \n\telse\n\t\txf_emit(ctx, 0x410, 0);\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 4);\t\t \n\txf_emit(ctx, 1, 3);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n}\n\nstatic void\nnv50_gr_construct_xfer_tprop(struct nvkm_grctx *ctx)\n{\n\tstruct nvkm_device *device = ctx->device;\n\tint magic1, magic2;\n\tif (device->chipset == 0x50) {\n\t\tmagic1 = 0x3ff;\n\t\tmagic2 = 0x00003e60;\n\t} else if (!IS_NVA3F(device->chipset)) {\n\t\tmagic1 = 0x7ff;\n\t\tmagic2 = 0x001ffe67;\n\t} else {\n\t\tmagic1 = 0x7ff;\n\t\tmagic2 = 0x00087e67;\n\t}\n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\tif (IS_NVA3F(device->chipset))\n\t\txf_emit(ctx, 1, 1);\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 3, 0);\t\t \n\txf_emit(ctx, 4, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0xf);\t\t \n\txf_emit(ctx, 7, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 4);\t\t \n\txf_emit(ctx, 4, 0xffff);\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 3, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 2, 0);\t\t \n\txf_emit(ctx, 1, 1);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 1);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 2, 0);\t\t \n\txf_emit(ctx, 1, 1);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\tif (IS_NVA3F(device->chipset)) {\n\t\txf_emit(ctx, 1, 3);\t \n\t\txf_emit(ctx, 1, 0);\t \n\t\txf_emit(ctx, 1, 0);\t \n\t} else if (device->chipset >= 0xa0) {\n\t\txf_emit(ctx, 1, 1);\t \n\t\txf_emit(ctx, 1, 0);\t \n\t} else {\n\t\txf_emit(ctx, 1, 0);\t \n\t}\n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 8, 0);\t\t \n\txf_emit(ctx, 1, 1);\t\t \n\txf_emit(ctx, 1, 1);\t\t \n\txf_emit(ctx, 1, 2);\t\t \n\txf_emit(ctx, 1, 1);\t\t \n\txf_emit(ctx, 1, 1);\t\t \n\txf_emit(ctx, 1, 2);\t\t \n\tif (IS_NVA3F(device->chipset)) {\n\t\txf_emit(ctx, 1, 0);\t \n\t\txf_emit(ctx, 8, 1);\t \n\t\txf_emit(ctx, 8, 1);\t \n\t\txf_emit(ctx, 8, 1);\t \n\t\txf_emit(ctx, 8, 2);\t \n\t\txf_emit(ctx, 8, 1);\t \n\t\txf_emit(ctx, 8, 2);\t \n\t\txf_emit(ctx, 8, 1);\t \n\t\txf_emit(ctx, 1, 0);\t \n\t}\n\txf_emit(ctx, 1, 1);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0x11);\t\t \n\txf_emit(ctx, 7, 0);\t\t \n\txf_emit(ctx, 1, 0x0fac6881);\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 4);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0x11);\t\t \n\txf_emit(ctx, 1, 1);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0xcf);\t\t \n\txf_emit(ctx, 1, 0xcf);\t\t \n\txf_emit(ctx, 1, 0xcf);\t\t \n\tif (IS_NVA3F(device->chipset))\n\t\txf_emit(ctx, 1, 1);\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 8, 0);\t\t \n\txf_emit(ctx, 1, 1);\t\t \n\txf_emit(ctx, 1, 1);\t\t \n\txf_emit(ctx, 1, 2);\t\t \n\txf_emit(ctx, 1, 1);\t\t \n\txf_emit(ctx, 1, 1);\t\t \n\txf_emit(ctx, 1, 2);\t\t \n\txf_emit(ctx, 1, 1);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 8, 1);\t\t \n\txf_emit(ctx, 1, 0x11);\t\t \n\txf_emit(ctx, 7, 0);\t\t \n\txf_emit(ctx, 1, 0x0fac6881);\t \n\txf_emit(ctx, 1, 0xf);\t\t \n\txf_emit(ctx, 7, 0);\t\t \n\txf_emit(ctx, 1, magic2);\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0x11);\t\t \n\txf_emit(ctx, 1, 1);\t\t \n\tif (IS_NVA3F(device->chipset))\n\t\txf_emit(ctx, 1, 1);\t \n\tif (device->chipset == 0x50)\n\t\txf_emit(ctx, 1, 0);\t \n\telse\n\t\txf_emit(ctx, 3, 0);\t \n\txf_emit(ctx, 1, 4);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 1);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0x11);\t\t \n\txf_emit(ctx, 7, 0);\t\t \n\txf_emit(ctx, 1, 0x0fac6881);\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0x11);\t\t \n\txf_emit(ctx, 1, 1);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 1);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 1);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, magic1);\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 1);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 1);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\tif (IS_NVA3F(device->chipset))\n\t\txf_emit(ctx, 1, 1);\t \n\txf_emit(ctx, 8, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 8, 0);\t\t \n\txf_emit(ctx, 8, 0);\t\t \n\txf_emit(ctx, 8, 0);\t\t \n\txf_emit(ctx, 8, 8);\t\t \n\txf_emit(ctx, 1, 0x11);\t\t \n\txf_emit(ctx, 7, 0);\t\t \n\txf_emit(ctx, 1, 0x0fac6881);\t \n\txf_emit(ctx, 8, 0x400);\t\t \n\txf_emit(ctx, 8, 0x300);\t\t \n\txf_emit(ctx, 1, 1);\t\t \n\txf_emit(ctx, 1, 0xf);\t\t \n\txf_emit(ctx, 7, 0);\t\t \n\txf_emit(ctx, 1, 0x20);\t\t \n\txf_emit(ctx, 1, 0x11);\t\t \n\txf_emit(ctx, 1, 0x100);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 1);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0x40);\t\t \n\txf_emit(ctx, 1, 0x100);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 3);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\tif (IS_NVA3F(device->chipset))\n\t\txf_emit(ctx, 1, 1);\t \n\txf_emit(ctx, 1, magic2);\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 2);\t\t \n\txf_emit(ctx, 1, 0x0fac6881);\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 2, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 1);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 4);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 1);\t\t \n\txf_emit(ctx, 1, 0x400);\t\t \n\txf_emit(ctx, 1, 0x300);\t\t \n\txf_emit(ctx, 1, 0x1001);\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\tif (IS_NVA3F(device->chipset))\n\t\txf_emit(ctx, 1, 0);\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0x11);\t\t \n\txf_emit(ctx, 7, 0);\t\t \n\txf_emit(ctx, 1, 0x0fac6881);\t \n\txf_emit(ctx, 1, 0xf);\t\t \n\txf_emit(ctx, 7, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 8, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\tif (IS_NVA3F(device->chipset)) {\n\t\txf_emit(ctx, 1, 0);\t \n\t\txf_emit(ctx, 1, 1);\t \n\t}\n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\tif (device->chipset >= 0xa0)\n\t\txf_emit(ctx, 1, 0x0fac6881);\t \n\txf_emit(ctx, 1, magic2);\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0x11);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 4);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 1);\t\t \n\txf_emit(ctx, 1, 1);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 1);\t\t \n\tif (IS_NVA3F(device->chipset)) {\n\t\txf_emit(ctx, 1, 1);\t \n\t\txf_emit(ctx, 1, 0);\t \n\t}\n\txf_emit(ctx, 1, 0);\t\t \n\tif (device->chipset >= 0xa0) {\n\t\txf_emit(ctx, 3, 0);\t\t \n\t\txf_emit(ctx, 1, 0xfac6881);\t \n\t\txf_emit(ctx, 4, 0);\t\t \n\t\txf_emit(ctx, 1, 4);\t\t \n\t\txf_emit(ctx, 1, 0);\t\t \n\t\txf_emit(ctx, 2, 1);\t\t \n\t\txf_emit(ctx, 2, 0);\t\t \n\t\txf_emit(ctx, 1, 1);\t\t \n\t\txf_emit(ctx, 1, 0);\t\t \n\t\tif (IS_NVA3F(device->chipset))\n\t\t\txf_emit(ctx, 0x9, 0);\t \n\t\telse\n\t\t\txf_emit(ctx, 0x8, 0);\t \n\t\txf_emit(ctx, 1, 0);\t\t \n\t\txf_emit(ctx, 8, 1);\t\t \n\t\txf_emit(ctx, 1, 0x11);\t\t \n\t\txf_emit(ctx, 7, 0);\t\t \n\t\txf_emit(ctx, 1, 0xfac6881);\t \n\t\txf_emit(ctx, 1, 0xf);\t\t \n\t\txf_emit(ctx, 7, 0);\t\t \n\t\txf_emit(ctx, 1, 0x11);\t\t \n\t\txf_emit(ctx, 1, 1);\t\t \n\t\txf_emit(ctx, 5, 0);\t\t \n\t\tif (IS_NVA3F(device->chipset)) {\n\t\t\txf_emit(ctx, 1, 0);\t \n\t\t\txf_emit(ctx, 1, 1);\t \n\t\t}\n\t}\n}\n\nstatic void\nnv50_gr_construct_xfer_tex(struct nvkm_grctx *ctx)\n{\n\tstruct nvkm_device *device = ctx->device;\n\txf_emit(ctx, 2, 0);\t\t \n\tif (device->chipset != 0x50)\n\t\txf_emit(ctx, 1, 0);\t \n\txf_emit(ctx, 1, 1);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 1);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\tif (device->chipset == 0x50)\n\t\txf_emit(ctx, 1, 0);\t \n\telse\n\t\txf_emit(ctx, 2, 0);\t \n\txf_emit(ctx, 1, 0x2a712488);\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0x4085c000);\t \n\txf_emit(ctx, 1, 0x40);\t\t \n\txf_emit(ctx, 1, 0x100);\t\t \n\txf_emit(ctx, 1, 0x10100);\t \n\txf_emit(ctx, 1, 0x02800000);\t \n\txf_emit(ctx, 1, 0);\t\t \n\tif (device->chipset == 0x50) {\n\t\txf_emit(ctx, 1, 0);\t \n\t\txf_emit(ctx, 1, 0);\t \n\t\txf_emit(ctx, 1, 0);\t \n\t\txf_emit(ctx, 1, 0);\t \n\t\txf_emit(ctx, 1, 0);\t \n\t} else if (!IS_NVAAF(device->chipset)) {\n\t\txf_emit(ctx, 1, 0);\t \n\t\txf_emit(ctx, 1, 0);\t \n\t\txf_emit(ctx, 1, 0);\t \n\t\txf_emit(ctx, 1, 0);\t \n\t\txf_emit(ctx, 1, 0);\t \n\t\txf_emit(ctx, 1, 0);\t \n\t\txf_emit(ctx, 1, 0);\t \n\t\txf_emit(ctx, 1, 0);\t \n\t} else {\n\t\txf_emit(ctx, 0x6, 0);\n\t}\n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n}\n\nstatic void\nnv50_gr_construct_xfer_unk8cxx(struct nvkm_grctx *ctx)\n{\n\tstruct nvkm_device *device = ctx->device;\n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 2, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0x04e3bfdf);\t \n\txf_emit(ctx, 1, 0x04e3bfdf);\t \n\txf_emit(ctx, 1, 1);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0x00ffff00);\t \n\txf_emit(ctx, 1, 1);\t\t \n\tif (IS_NVA3F(device->chipset))\n\t\txf_emit(ctx, 1, 1);\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0x00ffff00);\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 1);\t\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 1);\t\t \n\txf_emit(ctx, 1, 0x30201000);\t \n\txf_emit(ctx, 1, 0x70605040);\t \n\txf_emit(ctx, 1, 0xb8a89888);\t \n\txf_emit(ctx, 1, 0xf8e8d8c8);\t \n\txf_emit(ctx, 1, 0);\t\t \n\txf_emit(ctx, 1, 0x1a);\t\t \n}\n\nstatic void\nnv50_gr_construct_xfer_tp(struct nvkm_grctx *ctx)\n{\n\tstruct nvkm_device *device = ctx->device;\n\tif (device->chipset < 0xa0) {\n\t\tnv50_gr_construct_xfer_unk84xx(ctx);\n\t\tnv50_gr_construct_xfer_tprop(ctx);\n\t\tnv50_gr_construct_xfer_tex(ctx);\n\t\tnv50_gr_construct_xfer_unk8cxx(ctx);\n\t} else {\n\t\tnv50_gr_construct_xfer_tex(ctx);\n\t\tnv50_gr_construct_xfer_tprop(ctx);\n\t\tnv50_gr_construct_xfer_unk8cxx(ctx);\n\t\tnv50_gr_construct_xfer_unk84xx(ctx);\n\t}\n}\n\nstatic void\nnv50_gr_construct_xfer_mpc(struct nvkm_grctx *ctx)\n{\n\tstruct nvkm_device *device = ctx->device;\n\tint i, mpcnt = 2;\n\tswitch (device->chipset) {\n\t\tcase 0x98:\n\t\tcase 0xaa:\n\t\t\tmpcnt = 1;\n\t\t\tbreak;\n\t\tcase 0x50:\n\t\tcase 0x84:\n\t\tcase 0x86:\n\t\tcase 0x92:\n\t\tcase 0x94:\n\t\tcase 0x96:\n\t\tcase 0xa8:\n\t\tcase 0xac:\n\t\t\tmpcnt = 2;\n\t\t\tbreak;\n\t\tcase 0xa0:\n\t\tcase 0xa3:\n\t\tcase 0xa5:\n\t\tcase 0xaf:\n\t\t\tmpcnt = 3;\n\t\t\tbreak;\n\t}\n\tfor (i = 0; i < mpcnt; i++) {\n\t\txf_emit(ctx, 1, 0);\t\t \n\t\txf_emit(ctx, 1, 0x80);\t\t \n\t\txf_emit(ctx, 1, 0x80007004);\t \n\t\txf_emit(ctx, 1, 0x04000400);\t \n\t\tif (device->chipset >= 0xa0)\n\t\t\txf_emit(ctx, 1, 0xc0);\t \n\t\txf_emit(ctx, 1, 0x1000);\t \n\t\txf_emit(ctx, 1, 0);\t\t \n\t\txf_emit(ctx, 1, 0);\t\t \n\t\tif (device->chipset == 0x86 || device->chipset == 0x98 || device->chipset == 0xa8 || IS_NVAAF(device->chipset)) {\n\t\t\txf_emit(ctx, 1, 0xe00);\t\t \n\t\t\txf_emit(ctx, 1, 0x1e00);\t \n\t\t}\n\t\txf_emit(ctx, 1, 1);\t\t \n\t\txf_emit(ctx, 1, 0);\t\t \n\t\txf_emit(ctx, 1, 0);\t\t \n\t\tif (device->chipset == 0x50)\n\t\t\txf_emit(ctx, 2, 0x1000);\t \n\t\txf_emit(ctx, 1, 1);\t\t \n\t\txf_emit(ctx, 1, 0);\t\t \n\t\txf_emit(ctx, 1, 4);\t\t \n\t\txf_emit(ctx, 1, 2);\t\t \n\t\tif (IS_NVAAF(device->chipset))\n\t\t\txf_emit(ctx, 0xb, 0);\t \n\t\telse if (device->chipset >= 0xa0)\n\t\t\txf_emit(ctx, 0xc, 0);\t \n\t\telse\n\t\t\txf_emit(ctx, 0xa, 0);\t \n\t}\n\txf_emit(ctx, 1, 0x08100c12);\t\t \n\txf_emit(ctx, 1, 0);\t\t\t \n\tif (device->chipset >= 0xa0) {\n\t\txf_emit(ctx, 1, 0x1fe21);\t \n\t}\n\txf_emit(ctx, 3, 0);\t\t\t \n\txf_emit(ctx, 1, 0);\t\t\t \n\txf_emit(ctx, 1, 0);\t\t\t \n\txf_emit(ctx, 4, 0xffff);\t\t \n\txf_emit(ctx, 1, 1);\t\t\t \n\txf_emit(ctx, 1, 0x10001);\t\t \n\txf_emit(ctx, 1, 0x10001);\t\t \n\txf_emit(ctx, 1, 1);\t\t\t \n\txf_emit(ctx, 1, 0);\t\t\t \n\txf_emit(ctx, 1, 0x1fe21);\t\t \n\txf_emit(ctx, 1, 0);\t\t\t \n\tif (IS_NVA3F(device->chipset))\n\t\txf_emit(ctx, 1, 1);\t\t \n\txf_emit(ctx, 1, 0);\t\t\t \n\txf_emit(ctx, 1, 0);\t\t\t \n\txf_emit(ctx, 1, 0);\t\t\t \n\txf_emit(ctx, 1, 0);\t\t\t \n\txf_emit(ctx, 1, 0x08100c12);\t\t \n\txf_emit(ctx, 1, 4);\t\t\t \n\txf_emit(ctx, 1, 0);\t\t\t \n\txf_emit(ctx, 1, 2);\t\t\t \n\txf_emit(ctx, 1, 0x11);\t\t\t \n\txf_emit(ctx, 7, 0);\t\t\t \n\txf_emit(ctx, 1, 0);\t\t\t \n\txf_emit(ctx, 1, 0xfac6881);\t\t \n\txf_emit(ctx, 1, 0);\t\t\t \n\tif (IS_NVA3F(device->chipset))\n\t\txf_emit(ctx, 1, 3);\t\t \n\txf_emit(ctx, 1, 0);\t\t\t \n\txf_emit(ctx, 1, 0);\t\t\t \n\txf_emit(ctx, 1, 0);\t\t\t \n\txf_emit(ctx, 1, 4);\t\t\t \n\txf_emit(ctx, 8, 0);\t\t\t \n\txf_emit(ctx, 1, 0);\t\t\t \n\txf_emit(ctx, 1, 2);\t\t\t \n\txf_emit(ctx, 1, 1);\t\t\t \n\txf_emit(ctx, 1, 1);\t\t\t \n\txf_emit(ctx, 1, 2);\t\t\t \n\txf_emit(ctx, 1, 1);\t\t\t \n\txf_emit(ctx, 1, 1);\t\t\t \n\txf_emit(ctx, 1, 1);\t\t\t \n\tif (IS_NVA3F(device->chipset)) {\n\t\txf_emit(ctx, 1, 0);\t\t \n\t\txf_emit(ctx, 8, 2);\t\t \n\t\txf_emit(ctx, 8, 1);\t\t \n\t\txf_emit(ctx, 8, 1);\t\t \n\t\txf_emit(ctx, 8, 2);\t\t \n\t\txf_emit(ctx, 8, 1);\t\t \n\t\txf_emit(ctx, 8, 1);\t\t \n\t\txf_emit(ctx, 8, 1);\t\t \n\t\txf_emit(ctx, 1, 0);\t\t \n\t\txf_emit(ctx, 1, 0);\t\t \n\t}\n\txf_emit(ctx, 1, 0);\t\t\t \n\txf_emit(ctx, 1, 4);\t\t\t \n\t \n\tif (device->chipset == 0x50)\n\t\txf_emit(ctx, 0x3a0, 0);\n\telse if (device->chipset < 0x94)\n\t\txf_emit(ctx, 0x3a2, 0);\n\telse if (device->chipset == 0x98 || device->chipset == 0xaa)\n\t\txf_emit(ctx, 0x39f, 0);\n\telse\n\t\txf_emit(ctx, 0x3a3, 0);\n\txf_emit(ctx, 1, 0x11);\t\t\t \n\txf_emit(ctx, 1, 0);\t\t\t \n\txf_emit(ctx, 1, 1);\t\t\t \n\txf_emit(ctx, 0x2d, 0);\n}\n\nstatic void\nnv50_gr_construct_xfer2(struct nvkm_grctx *ctx)\n{\n\tstruct nvkm_device *device = ctx->device;\n\tint i;\n\tu32 offset;\n\tu32 units = nvkm_rd32(device, 0x1540);\n\tint size = 0;\n\n\toffset = (ctx->ctxvals_pos+0x3f)&~0x3f;\n\n\tif (device->chipset < 0xa0) {\n\t\tfor (i = 0; i < 8; i++) {\n\t\t\tctx->ctxvals_pos = offset + i;\n\t\t\t \n\t\t\tif (i == 0)\n\t\t\t\txf_emit(ctx, 1, 0x08100c12);  \n\t\t\tif (units & (1 << i))\n\t\t\t\tnv50_gr_construct_xfer_mpc(ctx);\n\t\t\tif ((ctx->ctxvals_pos-offset)/8 > size)\n\t\t\t\tsize = (ctx->ctxvals_pos-offset)/8;\n\t\t}\n\t} else {\n\t\t \n\t\tctx->ctxvals_pos = offset;\n\t\t \n\t\txf_emit(ctx, 1, 0x08100c12);  \n\t\tif (units & (1 << 0))\n\t\t\tnv50_gr_construct_xfer_mpc(ctx);\n\t\tif (units & (1 << 1))\n\t\t\tnv50_gr_construct_xfer_mpc(ctx);\n\t\tif ((ctx->ctxvals_pos-offset)/8 > size)\n\t\t\tsize = (ctx->ctxvals_pos-offset)/8;\n\n\t\t \n\t\tctx->ctxvals_pos = offset + 1;\n\t\tif (units & (1 << 2))\n\t\t\tnv50_gr_construct_xfer_mpc(ctx);\n\t\tif (units & (1 << 3))\n\t\t\tnv50_gr_construct_xfer_mpc(ctx);\n\t\tif ((ctx->ctxvals_pos-offset)/8 > size)\n\t\t\tsize = (ctx->ctxvals_pos-offset)/8;\n\n\t\t \n\t\tctx->ctxvals_pos = offset + 2;\n\t\tif (units & (1 << 4))\n\t\t\tnv50_gr_construct_xfer_mpc(ctx);\n\t\tif (units & (1 << 5))\n\t\t\tnv50_gr_construct_xfer_mpc(ctx);\n\t\tif (units & (1 << 6))\n\t\t\tnv50_gr_construct_xfer_mpc(ctx);\n\t\tif ((ctx->ctxvals_pos-offset)/8 > size)\n\t\t\tsize = (ctx->ctxvals_pos-offset)/8;\n\n\t\t \n\t\tctx->ctxvals_pos = offset + 3;\n\t\tif (units & (1 << 7))\n\t\t\tnv50_gr_construct_xfer_mpc(ctx);\n\t\tif (units & (1 << 8))\n\t\t\tnv50_gr_construct_xfer_mpc(ctx);\n\t\tif (units & (1 << 9))\n\t\t\tnv50_gr_construct_xfer_mpc(ctx);\n\t\tif ((ctx->ctxvals_pos-offset)/8 > size)\n\t\t\tsize = (ctx->ctxvals_pos-offset)/8;\n\t}\n\tctx->ctxvals_pos = offset + size * 8;\n\tctx->ctxvals_pos = (ctx->ctxvals_pos+0x3f)&~0x3f;\n\tcp_lsr (ctx, offset);\n\tcp_out (ctx, CP_SET_XFER_POINTER);\n\tcp_lsr (ctx, size);\n\tcp_out (ctx, CP_SEEK_2);\n\tcp_out (ctx, CP_XFER_2);\n\tcp_wait(ctx, XFER, BUSY);\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}