{
  "module_name": "gf100.h",
  "hash_id": "10c5f7d2c52228a89109d36a5d4fe58a04dda3410855100b955ac3f1cdd882bb",
  "original_prompt": "Ingested from linux-6.6.14/drivers/gpu/drm/nouveau/nvkm/engine/gr/gf100.h",
  "human_readable_source": " \n#ifndef __GF100_GR_H__\n#define __GF100_GR_H__\n#define gf100_gr(p) container_of((p), struct gf100_gr, base)\n#include \"priv.h\"\n\n#include <core/gpuobj.h>\n#include <subdev/ltc.h>\n#include <subdev/mmu.h>\n#include <engine/falcon.h>\n\nstruct nvkm_acr_lsfw;\n\n#define GPC_MAX 32\n#define TPC_MAX_PER_GPC 8\n#define TPC_MAX (GPC_MAX * TPC_MAX_PER_GPC)\n\n#define ROP_BCAST(r)      (0x408800 + (r))\n#define ROP_UNIT(u, r)    (0x410000 + (u) * 0x400 + (r))\n#define GPC_BCAST(r)      (0x418000 + (r))\n#define GPC_UNIT(t, r)    (0x500000 + (t) * 0x8000 + (r))\n#define PPC_UNIT(t, m, r) (0x503000 + (t) * 0x8000 + (m) * 0x200 + (r))\n#define TPC_UNIT(t, m, r) (0x504000 + (t) * 0x8000 + (m) * 0x800 + (r))\n\nstruct gf100_gr_zbc_color {\n\tu32 format;\n\tu32 ds[4];\n\tu32 l2[4];\n};\n\nstruct gf100_gr_zbc_depth {\n\tu32 format;\n\tu32 ds;\n\tu32 l2;\n};\n\nstruct gf100_gr_zbc_stencil {\n\tu32 format;\n\tu32 ds;\n\tu32 l2;\n};\n\nstruct gf100_gr {\n\tconst struct gf100_gr_func *func;\n\tstruct nvkm_gr base;\n\n\tstruct {\n\t\tstruct nvkm_falcon falcon;\n\t\tstruct nvkm_blob inst;\n\t\tstruct nvkm_blob data;\n\n\t\tstruct mutex mutex;\n\t\tu32 disable;\n\t} fecs;\n\n\tstruct {\n\t\tstruct nvkm_falcon falcon;\n\t\tstruct nvkm_blob inst;\n\t\tstruct nvkm_blob data;\n\t} gpccs;\n\n\tbool firmware;\n\n\t \n\tstruct gf100_gr_pack *sw_nonctx;\n\tstruct gf100_gr_pack *sw_nonctx1;\n\tstruct gf100_gr_pack *sw_nonctx2;\n\tstruct gf100_gr_pack *sw_nonctx3;\n\tstruct gf100_gr_pack *sw_nonctx4;\n\tstruct gf100_gr_pack *sw_ctx;\n\tstruct gf100_gr_pack *bundle;\n\tstruct gf100_gr_pack *bundle_veid;\n\tstruct gf100_gr_pack *bundle64;\n\tstruct gf100_gr_pack *method;\n\n\tstruct gf100_gr_zbc_color zbc_color[NVKM_LTC_MAX_ZBC_COLOR_CNT];\n\tstruct gf100_gr_zbc_depth zbc_depth[NVKM_LTC_MAX_ZBC_DEPTH_CNT];\n\tstruct gf100_gr_zbc_stencil zbc_stencil[NVKM_LTC_MAX_ZBC_DEPTH_CNT];\n\n\tu8 rop_nr;\n\tu8 gpc_nr;\n\tu8 tpc_nr[GPC_MAX];\n\tu8 tpc_max;\n\tu8 tpc_total;\n\tu8 ppc_nr[GPC_MAX];\n\tu8 ppc_mask[GPC_MAX];\n\tu8 ppc_tpc_mask[GPC_MAX][4];\n\tu8 ppc_tpc_nr[GPC_MAX][4];\n\tu8 ppc_tpc_min;\n\tu8 ppc_tpc_max;\n\tu8 ppc_total;\n\n\tstruct nvkm_memory *pagepool;\n\tstruct nvkm_memory *bundle_cb;\n\tstruct nvkm_memory *attrib_cb;\n\tstruct nvkm_memory *unknown;\n\n\tu8 screen_tile_row_offset;\n\tu8 tile[TPC_MAX];\n\n\tstruct {\n\t\tu8 gpc;\n\t\tu8 tpc;\n\t} sm[TPC_MAX];\n\tu8 sm_nr;\n\n\tu32  size;\n\tu32 *data;\n\tu32 size_zcull;\n\tu32 size_pm;\n};\n\nint gf100_gr_fecs_bind_pointer(struct gf100_gr *, u32 inst);\nint gf100_gr_fecs_wfi_golden_save(struct gf100_gr *, u32 inst);\n\nstruct gf100_gr_func_zbc {\n\tvoid (*clear_color)(struct gf100_gr *, int zbc);\n\tvoid (*clear_depth)(struct gf100_gr *, int zbc);\n\tint (*stencil_get)(struct gf100_gr *, int format,\n\t\t\t   const u32 ds, const u32 l2);\n\tvoid (*clear_stencil)(struct gf100_gr *, int zbc);\n};\n\nstruct gf100_gr_func {\n\tint (*nonstall)(struct gf100_gr *);\n\tstruct nvkm_intr *(*oneinit_intr)(struct gf100_gr *, enum nvkm_intr_type *);\n\tvoid (*oneinit_tiles)(struct gf100_gr *);\n\tint (*oneinit_sm_id)(struct gf100_gr *);\n\tint (*init)(struct gf100_gr *);\n\tvoid (*init_419bd8)(struct gf100_gr *);\n\tvoid (*init_gpc_mmu)(struct gf100_gr *);\n\tvoid (*init_r405a14)(struct gf100_gr *);\n\tvoid (*init_bios)(struct gf100_gr *);\n\tvoid (*init_vsc_stream_master)(struct gf100_gr *);\n\tvoid (*init_zcull)(struct gf100_gr *);\n\tvoid (*init_num_active_ltcs)(struct gf100_gr *);\n\tvoid (*init_rop_active_fbps)(struct gf100_gr *);\n\tvoid (*init_bios_2)(struct gf100_gr *);\n\tvoid (*init_swdx_pes_mask)(struct gf100_gr *);\n\tvoid (*init_fs)(struct gf100_gr *);\n\tvoid (*init_fecs_exceptions)(struct gf100_gr *);\n\tvoid (*init_40a790)(struct gf100_gr *);\n\tvoid (*init_ds_hww_esr_2)(struct gf100_gr *);\n\tvoid (*init_40601c)(struct gf100_gr *);\n\tvoid (*init_sked_hww_esr)(struct gf100_gr *);\n\tvoid (*init_419cc0)(struct gf100_gr *);\n\tvoid (*init_419eb4)(struct gf100_gr *);\n\tvoid (*init_419c9c)(struct gf100_gr *);\n\tvoid (*init_ppc_exceptions)(struct gf100_gr *);\n\tvoid (*init_tex_hww_esr)(struct gf100_gr *, int gpc, int tpc);\n\tvoid (*init_504430)(struct gf100_gr *, int gpc, int tpc);\n\tvoid (*init_shader_exceptions)(struct gf100_gr *, int gpc, int tpc);\n\tvoid (*init_rop_exceptions)(struct gf100_gr *);\n\tvoid (*init_exception2)(struct gf100_gr *);\n\tvoid (*init_400054)(struct gf100_gr *);\n\tvoid (*init_4188a4)(struct gf100_gr *);\n\tvoid (*trap_mp)(struct gf100_gr *, int gpc, int tpc);\n\tvoid (*set_hww_esr_report_mask)(struct gf100_gr *);\n\tconst struct gf100_gr_pack *mmio;\n\tstruct {\n\t\tstruct gf100_gr_ucode *ucode;\n\t\tvoid (*reset)(struct gf100_gr *);\n\t} fecs;\n\tstruct {\n\t\tstruct gf100_gr_ucode *ucode;\n\t\tvoid (*reset)(struct gf100_gr *);\n\t} gpccs;\n\tint (*rops)(struct gf100_gr *);\n\tint gpc_nr;\n\tint tpc_nr;\n\tint ppc_nr;\n\tconst struct gf100_grctx_func *grctx;\n\tconst struct nvkm_therm_clkgate_pack *clkgate_pack;\n\tconst struct gf100_gr_func_zbc *zbc;\n\tstruct nvkm_sclass sclass[];\n};\n\nint gf100_gr_rops(struct gf100_gr *);\nvoid gf100_gr_oneinit_tiles(struct gf100_gr *);\nint gf100_gr_oneinit_sm_id(struct gf100_gr *);\nint gf100_gr_init(struct gf100_gr *);\nvoid gf100_gr_init_vsc_stream_master(struct gf100_gr *);\nvoid gf100_gr_init_zcull(struct gf100_gr *);\nvoid gf100_gr_init_num_active_ltcs(struct gf100_gr *);\nvoid gf100_gr_init_fecs_exceptions(struct gf100_gr *);\nvoid gf100_gr_init_40601c(struct gf100_gr *);\nvoid gf100_gr_init_419cc0(struct gf100_gr *);\nvoid gf100_gr_init_419eb4(struct gf100_gr *);\nvoid gf100_gr_init_tex_hww_esr(struct gf100_gr *, int, int);\nvoid gf100_gr_init_shader_exceptions(struct gf100_gr *, int, int);\nvoid gf100_gr_init_rop_exceptions(struct gf100_gr *);\nvoid gf100_gr_init_exception2(struct gf100_gr *);\nvoid gf100_gr_init_400054(struct gf100_gr *);\nvoid gf100_gr_init_num_tpc_per_gpc(struct gf100_gr *, bool, bool);\nextern const struct gf100_gr_func_zbc gf100_gr_zbc;\nvoid gf100_gr_fecs_reset(struct gf100_gr *);\n\nvoid gf117_gr_init_zcull(struct gf100_gr *);\n\nvoid gk104_gr_init_vsc_stream_master(struct gf100_gr *);\nvoid gk104_gr_init_rop_active_fbps(struct gf100_gr *);\nvoid gk104_gr_init_ppc_exceptions(struct gf100_gr *);\nvoid gk104_gr_init_sked_hww_esr(struct gf100_gr *);\n\nvoid gk110_gr_init_419eb4(struct gf100_gr *);\n\nvoid gm107_gr_init_504430(struct gf100_gr *, int, int);\nvoid gm107_gr_init_shader_exceptions(struct gf100_gr *, int, int);\nvoid gm107_gr_init_400054(struct gf100_gr *);\n\nint gk20a_gr_init(struct gf100_gr *);\nint gk20a_gr_av_to_init_(struct nvkm_blob *, u8 count, u32 pitch, struct gf100_gr_pack **);\nint gk20a_gr_av_to_init(struct nvkm_blob *, struct gf100_gr_pack **);\nint gk20a_gr_aiv_to_init(struct nvkm_blob *, struct gf100_gr_pack **);\nint gk20a_gr_av_to_method(struct nvkm_blob *, struct gf100_gr_pack **);\n\nvoid gm200_gr_oneinit_tiles(struct gf100_gr *);\nint gm200_gr_oneinit_sm_id(struct gf100_gr *);\nint gm200_gr_rops(struct gf100_gr *);\nvoid gm200_gr_init_num_active_ltcs(struct gf100_gr *);\nvoid gm200_gr_init_ds_hww_esr_2(struct gf100_gr *);\n\nvoid gp100_gr_init_rop_active_fbps(struct gf100_gr *);\nvoid gp100_gr_init_fecs_exceptions(struct gf100_gr *);\nvoid gp100_gr_init_shader_exceptions(struct gf100_gr *, int, int);\nvoid gp100_gr_zbc_clear_color(struct gf100_gr *, int);\nvoid gp100_gr_zbc_clear_depth(struct gf100_gr *, int);\nextern const struct gf100_gr_func_zbc gp100_gr_zbc;\n\nvoid gp102_gr_init_swdx_pes_mask(struct gf100_gr *);\nextern const struct gf100_gr_func_zbc gp102_gr_zbc;\nint gp102_gr_zbc_stencil_get(struct gf100_gr *, int, const u32, const u32);\nvoid gp102_gr_zbc_clear_stencil(struct gf100_gr *, int);\n\nextern const struct gf100_gr_func gp107_gr;\n\nint gv100_gr_oneinit_sm_id(struct gf100_gr *);\nu32 gv100_gr_nonpes_aware_tpc(struct gf100_gr *gr, u32 gpc, u32 tpc);\nvoid gv100_gr_init_419bd8(struct gf100_gr *);\nvoid gv100_gr_init_504430(struct gf100_gr *, int, int);\nvoid gv100_gr_init_shader_exceptions(struct gf100_gr *, int, int);\nvoid gv100_gr_init_4188a4(struct gf100_gr *);\nvoid gv100_gr_trap_mp(struct gf100_gr *, int, int);\n\nint tu102_gr_av_to_init_veid(struct nvkm_blob *, struct gf100_gr_pack **);\nvoid tu102_gr_init_zcull(struct gf100_gr *);\nvoid tu102_gr_init_fs(struct gf100_gr *);\nvoid tu102_gr_init_fecs_exceptions(struct gf100_gr *);\n\n#define gf100_gr_chan(p) container_of((p), struct gf100_gr_chan, object)\n#include <core/object.h>\n\nstruct gf100_gr_chan {\n\tstruct nvkm_object object;\n\tstruct gf100_gr *gr;\n\tstruct nvkm_vmm *vmm;\n\n\tstruct nvkm_vma *pagepool;\n\tstruct nvkm_vma *bundle_cb;\n\tstruct nvkm_vma *attrib_cb;\n\tstruct nvkm_vma *unknown;\n\n\tstruct nvkm_memory *mmio;\n\tstruct nvkm_vma *mmio_vma;\n\tint mmio_nr;\n};\n\nvoid gf100_gr_ctxctl_debug(struct gf100_gr *);\n\nu64  gf100_gr_units(struct nvkm_gr *);\nvoid gf100_gr_zbc_init(struct gf100_gr *);\n\nextern const struct nvkm_object_func gf100_fermi;\n\nstruct gf100_gr_init {\n\tu32 addr;\n\tu8  count;\n\tu32 pitch;\n\tu64 data;\n};\n\nstruct gf100_gr_pack {\n\tconst struct gf100_gr_init *init;\n\tu32 type;\n};\n\n#define pack_for_each_init(init, pack, head)                                   \\\n\tfor (pack = head; pack && pack->init; pack++)                          \\\n\t\t  for (init = pack->init; init && init->count; init++)\n\nstruct gf100_gr_ucode {\n\tstruct nvkm_blob code;\n\tstruct nvkm_blob data;\n};\n\nextern struct gf100_gr_ucode gf100_gr_fecs_ucode;\nextern struct gf100_gr_ucode gf100_gr_gpccs_ucode;\n\nextern struct gf100_gr_ucode gk110_gr_fecs_ucode;\nextern struct gf100_gr_ucode gk110_gr_gpccs_ucode;\n\nint  gf100_gr_wait_idle(struct gf100_gr *);\nvoid gf100_gr_mmio(struct gf100_gr *, const struct gf100_gr_pack *);\nvoid gf100_gr_icmd(struct gf100_gr *, const struct gf100_gr_pack *);\nvoid gf100_gr_mthd(struct gf100_gr *, const struct gf100_gr_pack *);\nint  gf100_gr_init_ctxctl(struct gf100_gr *);\n\n \n\nextern const struct gf100_gr_init gf100_gr_init_main_0[];\nextern const struct gf100_gr_init gf100_gr_init_fe_0[];\nextern const struct gf100_gr_init gf100_gr_init_pri_0[];\nextern const struct gf100_gr_init gf100_gr_init_rstr2d_0[];\nextern const struct gf100_gr_init gf100_gr_init_pd_0[];\nextern const struct gf100_gr_init gf100_gr_init_ds_0[];\nextern const struct gf100_gr_init gf100_gr_init_scc_0[];\nextern const struct gf100_gr_init gf100_gr_init_prop_0[];\nextern const struct gf100_gr_init gf100_gr_init_gpc_unk_0[];\nextern const struct gf100_gr_init gf100_gr_init_setup_0[];\nextern const struct gf100_gr_init gf100_gr_init_crstr_0[];\nextern const struct gf100_gr_init gf100_gr_init_setup_1[];\nextern const struct gf100_gr_init gf100_gr_init_zcull_0[];\nextern const struct gf100_gr_init gf100_gr_init_gpm_0[];\nextern const struct gf100_gr_init gf100_gr_init_gpc_unk_1[];\nextern const struct gf100_gr_init gf100_gr_init_gcc_0[];\nextern const struct gf100_gr_init gf100_gr_init_tpccs_0[];\nextern const struct gf100_gr_init gf100_gr_init_tex_0[];\nextern const struct gf100_gr_init gf100_gr_init_pe_0[];\nextern const struct gf100_gr_init gf100_gr_init_l1c_0[];\nextern const struct gf100_gr_init gf100_gr_init_wwdx_0[];\nextern const struct gf100_gr_init gf100_gr_init_tpccs_1[];\nextern const struct gf100_gr_init gf100_gr_init_mpc_0[];\nextern const struct gf100_gr_init gf100_gr_init_be_0[];\nextern const struct gf100_gr_init gf100_gr_init_fe_1[];\nextern const struct gf100_gr_init gf100_gr_init_pe_1[];\nvoid gf100_gr_init_gpc_mmu(struct gf100_gr *);\nvoid gf100_gr_trap_mp(struct gf100_gr *, int, int);\nextern const struct nvkm_bitfield gf100_mp_global_error[];\nextern const struct nvkm_enum gf100_mp_warp_error[];\n\nextern const struct gf100_gr_init gf104_gr_init_ds_0[];\nextern const struct gf100_gr_init gf104_gr_init_tex_0[];\nextern const struct gf100_gr_init gf104_gr_init_sm_0[];\n\nextern const struct gf100_gr_init gf108_gr_init_gpc_unk_0[];\nextern const struct gf100_gr_init gf108_gr_init_setup_1[];\n\nextern const struct gf100_gr_init gf119_gr_init_pd_0[];\nextern const struct gf100_gr_init gf119_gr_init_ds_0[];\nextern const struct gf100_gr_init gf119_gr_init_prop_0[];\nextern const struct gf100_gr_init gf119_gr_init_gpm_0[];\nextern const struct gf100_gr_init gf119_gr_init_gpc_unk_1[];\nextern const struct gf100_gr_init gf119_gr_init_tex_0[];\nextern const struct gf100_gr_init gf119_gr_init_sm_0[];\nextern const struct gf100_gr_init gf119_gr_init_fe_1[];\n\nextern const struct gf100_gr_init gf117_gr_init_pes_0[];\nextern const struct gf100_gr_init gf117_gr_init_wwdx_0[];\nextern const struct gf100_gr_init gf117_gr_init_cbm_0[];\n\nextern const struct gf100_gr_init gk104_gr_init_main_0[];\nextern const struct gf100_gr_init gk104_gr_init_gpc_unk_2[];\nextern const struct gf100_gr_init gk104_gr_init_tpccs_0[];\nextern const struct gf100_gr_init gk104_gr_init_pe_0[];\nextern const struct gf100_gr_init gk104_gr_init_be_0[];\nextern const struct gf100_gr_pack gk104_gr_pack_mmio[];\n\nextern const struct gf100_gr_init gk110_gr_init_fe_0[];\nextern const struct gf100_gr_init gk110_gr_init_ds_0[];\nextern const struct gf100_gr_init gk110_gr_init_sked_0[];\nextern const struct gf100_gr_init gk110_gr_init_cwd_0[];\nextern const struct gf100_gr_init gk110_gr_init_gpc_unk_1[];\nextern const struct gf100_gr_init gk110_gr_init_tex_0[];\nextern const struct gf100_gr_init gk110_gr_init_sm_0[];\n\nextern const struct gf100_gr_init gk208_gr_init_gpc_unk_0[];\n\nextern const struct gf100_gr_init gm107_gr_init_scc_0[];\nextern const struct gf100_gr_init gm107_gr_init_prop_0[];\nextern const struct gf100_gr_init gm107_gr_init_setup_1[];\nextern const struct gf100_gr_init gm107_gr_init_zcull_0[];\nextern const struct gf100_gr_init gm107_gr_init_gpc_unk_1[];\nextern const struct gf100_gr_init gm107_gr_init_tex_0[];\nextern const struct gf100_gr_init gm107_gr_init_l1c_0[];\nextern const struct gf100_gr_init gm107_gr_init_wwdx_0[];\nextern const struct gf100_gr_init gm107_gr_init_cbm_0[];\nvoid gm107_gr_init_bios(struct gf100_gr *);\n\nvoid gm200_gr_init_gpc_mmu(struct gf100_gr *);\n\nstruct gf100_gr_fwif {\n\tint version;\n\tint (*load)(struct gf100_gr *, int ver, const struct gf100_gr_fwif *);\n\tconst struct gf100_gr_func *func;\n\tconst struct nvkm_acr_lsf_func *fecs;\n\tconst struct nvkm_acr_lsf_func *gpccs;\n};\n\nint gf100_gr_load(struct gf100_gr *, int, const struct gf100_gr_fwif *);\nint gf100_gr_nofw(struct gf100_gr *, int, const struct gf100_gr_fwif *);\n\nint gk20a_gr_load_sw(struct gf100_gr *, const char *path, int ver);\nint gk20a_gr_load_net(struct gf100_gr *, const char *, const char *, int,\n\t\t      int (*)(struct nvkm_blob *, struct gf100_gr_pack **),\n\t\t      struct gf100_gr_pack **);\n\nint gm200_gr_nofw(struct gf100_gr *, int, const struct gf100_gr_fwif *);\nint gm200_gr_load(struct gf100_gr *, int, const struct gf100_gr_fwif *);\nextern const struct nvkm_acr_lsf_func gm200_gr_gpccs_acr;\nextern const struct nvkm_acr_lsf_func gm200_gr_fecs_acr;\n\nextern const struct nvkm_acr_lsf_func gm20b_gr_fecs_acr;\nvoid gm20b_gr_acr_bld_write(struct nvkm_acr *, u32, struct nvkm_acr_lsfw *);\nvoid gm20b_gr_acr_bld_patch(struct nvkm_acr *, u32, s64);\n\nextern const struct nvkm_acr_lsf_func gp108_gr_gpccs_acr;\nextern const struct nvkm_acr_lsf_func gp108_gr_fecs_acr;\nvoid gp108_gr_acr_bld_write(struct nvkm_acr *, u32, struct nvkm_acr_lsfw *);\nvoid gp108_gr_acr_bld_patch(struct nvkm_acr *, u32, s64);\n\nint gf100_gr_new_(const struct gf100_gr_fwif *, struct nvkm_device *, enum nvkm_subdev_type, int,\n\t\t  struct nvkm_gr **);\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}