{
  "module_name": "base.c",
  "hash_id": "26d6772d7957778f38e0b6201082ac71d534bc52b60e47b4457d794cefe5a261",
  "original_prompt": "Ingested from linux-6.6.14/drivers/gpu/drm/nouveau/nvkm/engine/sw/base.c",
  "human_readable_source": " \n#include \"priv.h\"\n#include \"chan.h\"\n\n#include <engine/fifo.h>\n\nbool\nnvkm_sw_mthd(struct nvkm_sw *sw, int chid, int subc, u32 mthd, u32 data)\n{\n\tstruct nvkm_sw_chan *chan;\n\tbool handled = false;\n\tunsigned long flags;\n\n\tspin_lock_irqsave(&sw->engine.lock, flags);\n\tlist_for_each_entry(chan, &sw->chan, head) {\n\t\tif (chan->fifo->id == chid) {\n\t\t\thandled = nvkm_sw_chan_mthd(chan, subc, mthd, data);\n\t\t\tlist_del(&chan->head);\n\t\t\tlist_add(&chan->head, &sw->chan);\n\t\t\tbreak;\n\t\t}\n\t}\n\tspin_unlock_irqrestore(&sw->engine.lock, flags);\n\treturn handled;\n}\n\nstatic int\nnvkm_sw_oclass_new(const struct nvkm_oclass *oclass, void *data, u32 size,\n\t\t   struct nvkm_object **pobject)\n{\n\tstruct nvkm_sw_chan *chan = nvkm_sw_chan(oclass->parent);\n\tconst struct nvkm_sw_chan_sclass *sclass = oclass->engn;\n\treturn sclass->ctor(chan, oclass, data, size, pobject);\n}\n\nstatic int\nnvkm_sw_oclass_get(struct nvkm_oclass *oclass, int index)\n{\n\tstruct nvkm_sw *sw = nvkm_sw(oclass->engine);\n\tint c = 0;\n\n\twhile (sw->func->sclass[c].ctor) {\n\t\tif (c++ == index) {\n\t\t\toclass->engn = &sw->func->sclass[index];\n\t\t\toclass->base =  sw->func->sclass[index].base;\n\t\t\toclass->base.ctor = nvkm_sw_oclass_new;\n\t\t\treturn index;\n\t\t}\n\t}\n\n\treturn c;\n}\n\nstatic int\nnvkm_sw_cclass_get(struct nvkm_chan *fifoch, const struct nvkm_oclass *oclass,\n\t\t   struct nvkm_object **pobject)\n{\n\tstruct nvkm_sw *sw = nvkm_sw(oclass->engine);\n\treturn sw->func->chan_new(sw, fifoch, oclass, pobject);\n}\n\nstatic void *\nnvkm_sw_dtor(struct nvkm_engine *engine)\n{\n\treturn nvkm_sw(engine);\n}\n\nstatic const struct nvkm_engine_func\nnvkm_sw = {\n\t.dtor = nvkm_sw_dtor,\n\t.fifo.cclass = nvkm_sw_cclass_get,\n\t.fifo.sclass = nvkm_sw_oclass_get,\n};\n\nint\nnvkm_sw_new_(const struct nvkm_sw_func *func, struct nvkm_device *device,\n\t     enum nvkm_subdev_type type, int inst, struct nvkm_sw **psw)\n{\n\tstruct nvkm_sw *sw;\n\n\tif (!(sw = *psw = kzalloc(sizeof(*sw), GFP_KERNEL)))\n\t\treturn -ENOMEM;\n\tINIT_LIST_HEAD(&sw->chan);\n\tsw->func = func;\n\n\treturn nvkm_engine_ctor(&nvkm_sw, device, type, inst, true, &sw->engine);\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}