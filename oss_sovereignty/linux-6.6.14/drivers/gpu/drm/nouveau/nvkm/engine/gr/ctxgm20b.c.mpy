{
  "module_name": "ctxgm20b.c",
  "hash_id": "a138d14025c9842c708a387da78f63ce46b1c86290bcf2f09e4e30b5e2daae76",
  "original_prompt": "Ingested from linux-6.6.14/drivers/gpu/drm/nouveau/nvkm/engine/gr/ctxgm20b.c",
  "human_readable_source": " \n#include \"ctxgf100.h\"\n\nstatic void\ngm20b_grctx_generate_main(struct gf100_gr_chan *chan)\n{\n\tstruct gf100_gr *gr = chan->gr;\n\tstruct nvkm_device *device = gr->base.engine.subdev.device;\n\tconst struct gf100_grctx_func *grctx = gr->func->grctx;\n\tu32 idle_timeout;\n\tint i, tmp;\n\n\tgf100_gr_mmio(gr, gr->sw_ctx);\n\n\tgf100_gr_wait_idle(gr);\n\n\tidle_timeout = nvkm_mask(device, 0x404154, 0xffffffff, 0x00000000);\n\n\tgrctx->attrib_cb(chan, chan->attrib_cb->addr, grctx->attrib_cb_size(gr));\n\tgrctx->attrib(chan);\n\n\tgrctx->unkn(gr);\n\n\tgf100_grctx_generate_floorsweep(gr);\n\n\tfor (i = 0; i < 8; i++)\n\t\tnvkm_wr32(device, 0x4064d0 + (i * 0x04), 0x00000000);\n\n\tnvkm_wr32(device, 0x405b00, (gr->tpc_total << 8) | gr->gpc_nr);\n\n\tnvkm_wr32(device, 0x408908, nvkm_rd32(device, 0x410108) | 0x80000000);\n\n\tfor (tmp = 0, i = 0; i < gr->gpc_nr; i++)\n\t\ttmp |= ((1 << gr->tpc_nr[i]) - 1) << (i * 4);\n\tnvkm_wr32(device, 0x4041c4, tmp);\n\n\tgm200_grctx_generate_smid_config(gr);\n\n\tgf100_gr_wait_idle(gr);\n\n\tnvkm_wr32(device, 0x404154, idle_timeout);\n\tgf100_gr_wait_idle(gr);\n\n\tgf100_gr_mthd(gr, gr->method);\n\tgf100_gr_wait_idle(gr);\n\n\tgf100_gr_icmd(gr, gr->bundle);\n\tgrctx->pagepool(chan, chan->pagepool->addr);\n\tgrctx->bundle(chan, chan->bundle_cb->addr, grctx->bundle_size);\n}\n\nconst struct gf100_grctx_func\ngm20b_grctx = {\n\t.main  = gm20b_grctx_generate_main,\n\t.unkn  = gk104_grctx_generate_unkn,\n\t.bundle = gm107_grctx_generate_bundle,\n\t.bundle_size = 0x1800,\n\t.bundle_min_gpm_fifo_depth = 0x182,\n\t.bundle_token_limit = 0x1c0,\n\t.pagepool = gm107_grctx_generate_pagepool,\n\t.pagepool_size = 0x8000,\n\t.attrib_cb_size = gf100_grctx_generate_attrib_cb_size,\n\t.attrib_cb = gm107_grctx_generate_attrib_cb,\n\t.attrib = gm107_grctx_generate_attrib,\n\t.attrib_nr_max = 0x600,\n\t.attrib_nr = 0x400,\n\t.alpha_nr_max = 0xc00,\n\t.alpha_nr = 0x800,\n\t.sm_id = gm107_grctx_generate_sm_id,\n\t.rop_mapping = gf117_grctx_generate_rop_mapping,\n};\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}