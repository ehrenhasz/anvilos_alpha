{
  "module_name": "nouveau_sched.h",
  "hash_id": "7f1d14106a9093115a4603af6c0e894c1869a0618438a6730fc3903734f618a0",
  "original_prompt": "Ingested from linux-6.6.14/drivers/gpu/drm/nouveau/nouveau_sched.h",
  "human_readable_source": " \n\n#ifndef NOUVEAU_SCHED_H\n#define NOUVEAU_SCHED_H\n\n#include <linux/types.h>\n\n#include <drm/drm_exec.h>\n#include <drm/gpu_scheduler.h>\n\n#include \"nouveau_drv.h\"\n\n#define to_nouveau_job(sched_job)\t\t\\\n\t\tcontainer_of((sched_job), struct nouveau_job, base)\n\nstruct nouveau_job_ops;\n\nenum nouveau_job_state {\n\tNOUVEAU_JOB_UNINITIALIZED = 0,\n\tNOUVEAU_JOB_INITIALIZED,\n\tNOUVEAU_JOB_SUBMIT_SUCCESS,\n\tNOUVEAU_JOB_SUBMIT_FAILED,\n\tNOUVEAU_JOB_RUN_SUCCESS,\n\tNOUVEAU_JOB_RUN_FAILED,\n};\n\nstruct nouveau_job_args {\n\tstruct drm_file *file_priv;\n\tstruct nouveau_sched_entity *sched_entity;\n\n\tenum dma_resv_usage resv_usage;\n\tbool sync;\n\n\tstruct {\n\t\tstruct drm_nouveau_sync *s;\n\t\tu32 count;\n\t} in_sync;\n\n\tstruct {\n\t\tstruct drm_nouveau_sync *s;\n\t\tu32 count;\n\t} out_sync;\n\n\tstruct nouveau_job_ops *ops;\n};\n\nstruct nouveau_job {\n\tstruct drm_sched_job base;\n\n\tenum nouveau_job_state state;\n\n\tstruct nouveau_sched_entity *entity;\n\n\tstruct drm_file *file_priv;\n\tstruct nouveau_cli *cli;\n\n\tstruct drm_exec exec;\n\tenum dma_resv_usage resv_usage;\n\tstruct dma_fence *done_fence;\n\n\tbool sync;\n\n\tstruct {\n\t\tstruct drm_nouveau_sync *data;\n\t\tu32 count;\n\t} in_sync;\n\n\tstruct {\n\t\tstruct drm_nouveau_sync *data;\n\t\tstruct drm_syncobj **objs;\n\t\tstruct dma_fence_chain **chains;\n\t\tu32 count;\n\t} out_sync;\n\n\tstruct nouveau_job_ops {\n\t\t \n\t\tint (*submit)(struct nouveau_job *);\n\t\tvoid (*armed_submit)(struct nouveau_job *);\n\t\tstruct dma_fence *(*run)(struct nouveau_job *);\n\t\tvoid (*free)(struct nouveau_job *);\n\t\tenum drm_gpu_sched_stat (*timeout)(struct nouveau_job *);\n\t} *ops;\n};\n\nint nouveau_job_ucopy_syncs(struct nouveau_job_args *args,\n\t\t\t    u32 inc, u64 ins,\n\t\t\t    u32 outc, u64 outs);\n\nint nouveau_job_init(struct nouveau_job *job,\n\t\t     struct nouveau_job_args *args);\nvoid nouveau_job_free(struct nouveau_job *job);\n\nint nouveau_job_submit(struct nouveau_job *job);\nvoid nouveau_job_fini(struct nouveau_job *job);\n\n#define to_nouveau_sched_entity(entity)\t\t\\\n\t\tcontainer_of((entity), struct nouveau_sched_entity, base)\n\nstruct nouveau_sched_entity {\n\tstruct drm_sched_entity base;\n\tstruct mutex mutex;\n\n\tstruct workqueue_struct *sched_wq;\n\n\tstruct {\n\t\tstruct {\n\t\t\tstruct list_head head;\n\t\t\tspinlock_t lock;\n\t\t} list;\n\t\tstruct wait_queue_head wq;\n\t} job;\n};\n\nint nouveau_sched_entity_init(struct nouveau_sched_entity *entity,\n\t\t\t      struct drm_gpu_scheduler *sched,\n\t\t\t      struct workqueue_struct *sched_wq);\nvoid nouveau_sched_entity_fini(struct nouveau_sched_entity *entity);\n\nbool nouveau_sched_entity_qwork(struct nouveau_sched_entity *entity,\n\t\t\t\tstruct work_struct *work);\n\nint nouveau_sched_init(struct nouveau_drm *drm);\nvoid nouveau_sched_fini(struct nouveau_drm *drm);\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}