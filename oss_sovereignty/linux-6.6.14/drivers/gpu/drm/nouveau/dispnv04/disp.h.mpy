{
  "module_name": "disp.h",
  "hash_id": "959959f33b4576416cd67c1ba56a1a5ff55011bc5d7d1bb33704c296470d2222",
  "original_prompt": "Ingested from linux-6.6.14/drivers/gpu/drm/nouveau/dispnv04/disp.h",
  "human_readable_source": " \n#ifndef __NV04_DISPLAY_H__\n#define __NV04_DISPLAY_H__\n#include <subdev/bios.h>\n#include <subdev/bios/pll.h>\n\n#include \"nouveau_display.h\"\n\n#include <nvif/event.h>\n\nstruct nouveau_encoder;\n\nenum nv04_fp_display_regs {\n\tFP_DISPLAY_END,\n\tFP_TOTAL,\n\tFP_CRTC,\n\tFP_SYNC_START,\n\tFP_SYNC_END,\n\tFP_VALID_START,\n\tFP_VALID_END\n};\n\nstruct nv04_crtc_reg {\n\tunsigned char MiscOutReg;\n\tuint8_t CRTC[0xa0];\n\tuint8_t CR58[0x10];\n\tuint8_t Sequencer[5];\n\tuint8_t Graphics[9];\n\tuint8_t Attribute[21];\n\tunsigned char DAC[768];\n\n\t \n\tuint32_t fb_start;\n\tuint32_t crtc_cfg;\n\tuint32_t cursor_cfg;\n\tuint32_t gpio_ext;\n\tuint32_t crtc_830;\n\tuint32_t crtc_834;\n\tuint32_t crtc_850;\n\tuint32_t crtc_eng_ctrl;\n\n\t \n\tuint32_t nv10_cursync;\n\tstruct nvkm_pll_vals pllvals;\n\tuint32_t ramdac_gen_ctrl;\n\tuint32_t ramdac_630;\n\tuint32_t ramdac_634;\n\tuint32_t tv_setup;\n\tuint32_t tv_vtotal;\n\tuint32_t tv_vskew;\n\tuint32_t tv_vsync_delay;\n\tuint32_t tv_htotal;\n\tuint32_t tv_hskew;\n\tuint32_t tv_hsync_delay;\n\tuint32_t tv_hsync_delay2;\n\tuint32_t fp_horiz_regs[7];\n\tuint32_t fp_vert_regs[7];\n\tuint32_t dither;\n\tuint32_t fp_control;\n\tuint32_t dither_regs[6];\n\tuint32_t fp_debug_0;\n\tuint32_t fp_debug_1;\n\tuint32_t fp_debug_2;\n\tuint32_t fp_margin_color;\n\tuint32_t ramdac_8c0;\n\tuint32_t ramdac_a20;\n\tuint32_t ramdac_a24;\n\tuint32_t ramdac_a34;\n\tuint32_t ctv_regs[38];\n};\n\nstruct nv04_output_reg {\n\tuint32_t output;\n\tint head;\n};\n\nstruct nv04_mode_state {\n\tstruct nv04_crtc_reg crtc_reg[2];\n\tuint32_t pllsel;\n\tuint32_t sel_clk;\n};\n\nstruct nv04_display {\n\tstruct nv04_mode_state mode_reg;\n\tstruct nv04_mode_state saved_reg;\n\tuint32_t saved_vga_font[4][16384];\n\tuint32_t dac_users[4];\n\tstruct nouveau_bo *image[2];\n\tstruct nvif_event flip;\n\tstruct nouveau_drm *drm;\n};\n\nstatic inline struct nv04_display *\nnv04_display(struct drm_device *dev)\n{\n\treturn nouveau_display(dev)->priv;\n}\n\n \nint nv04_display_create(struct drm_device *);\nstruct nouveau_connector *\nnv04_encoder_get_connector(struct nouveau_encoder *nv_encoder);\n\n \nint nv04_crtc_create(struct drm_device *, int index);\n\n \nint nv04_dac_create(struct drm_connector *, struct dcb_output *);\nuint32_t nv17_dac_sample_load(struct drm_encoder *encoder);\nint nv04_dac_output_offset(struct drm_encoder *encoder);\nvoid nv04_dac_update_dacclk(struct drm_encoder *encoder, bool enable);\nbool nv04_dac_in_use(struct drm_encoder *encoder);\n\n \nint nv04_dfp_create(struct drm_connector *, struct dcb_output *);\nint nv04_dfp_get_bound_head(struct drm_device *dev, struct dcb_output *dcbent);\nvoid nv04_dfp_bind_head(struct drm_device *dev, struct dcb_output *dcbent,\n\t\t\t       int head, bool dl);\nvoid nv04_dfp_disable(struct drm_device *dev, int head);\nvoid nv04_dfp_update_fp_control(struct drm_encoder *encoder, int mode);\n\n \nint nv04_tv_identify(struct drm_device *dev, int i2c_index);\nint nv04_tv_create(struct drm_connector *, struct dcb_output *);\n\n \nint nv17_tv_create(struct drm_connector *, struct dcb_output *);\n\n \nvoid nouveau_overlay_init(struct drm_device *dev);\n\nstatic inline bool\nnv_two_heads(struct drm_device *dev)\n{\n\tstruct nouveau_drm *drm = nouveau_drm(dev);\n\tconst int impl = to_pci_dev(dev->dev)->device & 0x0ff0;\n\n\tif (drm->client.device.info.family >= NV_DEVICE_INFO_V0_CELSIUS && impl != 0x0100 &&\n\t    impl != 0x0150 && impl != 0x01a0 && impl != 0x0200)\n\t\treturn true;\n\n\treturn false;\n}\n\nstatic inline bool\nnv_gf4_disp_arch(struct drm_device *dev)\n{\n\treturn nv_two_heads(dev) && (to_pci_dev(dev->dev)->device & 0x0ff0) != 0x0110;\n}\n\nstatic inline bool\nnv_two_reg_pll(struct drm_device *dev)\n{\n\tstruct nouveau_drm *drm = nouveau_drm(dev);\n\tconst int impl = to_pci_dev(dev->dev)->device & 0x0ff0;\n\n\tif (impl == 0x0310 || impl == 0x0340 || drm->client.device.info.family >= NV_DEVICE_INFO_V0_CURIE)\n\t\treturn true;\n\treturn false;\n}\n\nstatic inline bool\nnv_match_device(struct drm_device *dev, unsigned device,\n\t\tunsigned sub_vendor, unsigned sub_device)\n{\n\tstruct pci_dev *pdev = to_pci_dev(dev->dev);\n\n\treturn pdev->device == device &&\n\t\tpdev->subsystem_vendor == sub_vendor &&\n\t\tpdev->subsystem_device == sub_device;\n}\n\n#include <subdev/bios/init.h>\n\nstatic inline void\nnouveau_bios_run_init_table(struct drm_device *dev, u16 table,\n\t\t\t    struct dcb_output *outp, int crtc)\n{\n\tnvbios_init(&nvxx_bios(&nouveau_drm(dev)->client.device)->subdev, table,\n\t\tinit.outp = outp;\n\t\tinit.head = crtc;\n\t);\n}\n\nint nv04_flip_complete(struct nvif_event *, void *, u32);\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}