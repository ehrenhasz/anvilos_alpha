{
  "module_name": "drbd_polymorph_printk.h",
  "hash_id": "cf4387962d23d5b161d73a99b5d7f43f5312adcd74240aaf6182aa4c44b055dc",
  "original_prompt": "Ingested from linux-6.6.14/drivers/block/drbd/drbd_polymorph_printk.h",
  "human_readable_source": " \n#ifndef DRBD_POLYMORPH_PRINTK_H\n#define DRBD_POLYMORPH_PRINTK_H\n\n#if !defined(CONFIG_DYNAMIC_DEBUG)\n#undef DEFINE_DYNAMIC_DEBUG_METADATA\n#undef __dynamic_pr_debug\n#undef DYNAMIC_DEBUG_BRANCH\n#define DEFINE_DYNAMIC_DEBUG_METADATA(D, F) const char *D = F; ((void)D)\n#define __dynamic_pr_debug(D, F, args...) do { (void)(D); if (0) printk(F, ## args); } while (0)\n#define DYNAMIC_DEBUG_BRANCH(D) false\n#endif\n\n\n#define __drbd_printk_drbd_device_prep(device)\t\t\t\\\n\tconst struct drbd_device *__d = (device);\t\t\\\n\tconst struct drbd_resource *__r = __d->resource\n#define __drbd_printk_drbd_device_fmt(fmt)\t\"drbd %s/%u drbd%u: \" fmt\n#define __drbd_printk_drbd_device_args()\t__r->name, __d->vnr, __d->minor\n#define __drbd_printk_drbd_device_unprep()\n\n#define __drbd_printk_drbd_peer_device_prep(peer_device)\t\\\n\tconst struct drbd_device *__d;\t\t\t\t\\\n\tconst struct drbd_resource *__r;\t\t\t\\\n\t__d = (peer_device)->device;\t\t\t\t\\\n\t__r = __d->resource\n#define __drbd_printk_drbd_peer_device_fmt(fmt) \\\n\t\"drbd %s/%u drbd%u: \" fmt\n#define __drbd_printk_drbd_peer_device_args() \\\n\t__r->name, __d->vnr, __d->minor\n#define __drbd_printk_drbd_peer_device_unprep()\n\n#define __drbd_printk_drbd_resource_prep(resource) \\\n\tconst struct drbd_resource *__r = resource\n#define __drbd_printk_drbd_resource_fmt(fmt) \"drbd %s: \" fmt\n#define __drbd_printk_drbd_resource_args()\t__r->name\n#define __drbd_printk_drbd_resource_unprep(resource)\n\n#define __drbd_printk_drbd_connection_prep(connection)\t\t\\\n\tconst struct drbd_connection *__c = (connection);\t\\\n\tconst struct drbd_resource *__r = __c->resource\n#define __drbd_printk_drbd_connection_fmt(fmt)\t\t\t\\\n\t\"drbd %s: \" fmt\n#define __drbd_printk_drbd_connection_args()\t\t\t\\\n\t__r->name\n#define __drbd_printk_drbd_connection_unprep()\n\nvoid drbd_printk_with_wrong_object_type(void);\nvoid drbd_dyn_dbg_with_wrong_object_type(void);\n\n#define __drbd_printk_choose_cond(obj, struct_name) \\\n\t(__builtin_types_compatible_p(typeof(obj), struct struct_name *) || \\\n\t __builtin_types_compatible_p(typeof(obj), const struct struct_name *))\n#define __drbd_printk_if_same_type(obj, struct_name, level, fmt, args...) \\\n\t__drbd_printk_choose_cond(obj, struct_name), \\\n({ \\\n\t__drbd_printk_ ## struct_name ## _prep((const struct struct_name *)(obj)); \\\n\tprintk(level __drbd_printk_ ## struct_name ## _fmt(fmt), \\\n\t\t__drbd_printk_ ## struct_name ## _args(), ## args); \\\n\t__drbd_printk_ ## struct_name ## _unprep(); \\\n})\n\n#define drbd_printk(level, obj, fmt, args...) \\\n\t__builtin_choose_expr( \\\n\t  __drbd_printk_if_same_type(obj, drbd_device, level, fmt, ## args), \\\n\t  __builtin_choose_expr( \\\n\t    __drbd_printk_if_same_type(obj, drbd_resource, level, fmt, ## args), \\\n\t    __builtin_choose_expr( \\\n\t      __drbd_printk_if_same_type(obj, drbd_connection, level, fmt, ## args), \\\n\t      __builtin_choose_expr( \\\n\t\t__drbd_printk_if_same_type(obj, drbd_peer_device, level, fmt, ## args), \\\n\t\tdrbd_printk_with_wrong_object_type()))))\n\n#define __drbd_dyn_dbg_if_same_type(obj, struct_name, fmt, args...) \\\n\t__drbd_printk_choose_cond(obj, struct_name), \\\n({ \\\n\tDEFINE_DYNAMIC_DEBUG_METADATA(descriptor, fmt);\t\t\\\n\tif (DYNAMIC_DEBUG_BRANCH(descriptor)) {\t\t\t\\\n\t\t__drbd_printk_ ## struct_name ## _prep((const struct struct_name *)(obj)); \\\n\t\t__dynamic_pr_debug(&descriptor, __drbd_printk_ ## struct_name ## _fmt(fmt), \\\n\t\t\t__drbd_printk_ ## struct_name ## _args(), ## args); \\\n\t\t__drbd_printk_ ## struct_name ## _unprep();\t\\\n\t}\t\t\t\t\t\t\t\\\n})\n\n#define dynamic_drbd_dbg(obj, fmt, args...) \\\n\t__builtin_choose_expr( \\\n\t  __drbd_dyn_dbg_if_same_type(obj, drbd_device, fmt, ## args), \\\n\t  __builtin_choose_expr( \\\n\t    __drbd_dyn_dbg_if_same_type(obj, drbd_resource, fmt, ## args), \\\n\t    __builtin_choose_expr( \\\n\t      __drbd_dyn_dbg_if_same_type(obj, drbd_connection, fmt, ## args), \\\n\t      __builtin_choose_expr( \\\n\t\t__drbd_dyn_dbg_if_same_type(obj, drbd_peer_device, fmt, ## args), \\\n\t\tdrbd_dyn_dbg_with_wrong_object_type()))))\n\n#define drbd_emerg(device, fmt, args...) \\\n\tdrbd_printk(KERN_EMERG, device, fmt, ## args)\n#define drbd_alert(device, fmt, args...) \\\n\tdrbd_printk(KERN_ALERT, device, fmt, ## args)\n#define drbd_crit(device, fmt, args...) \\\n\tdrbd_printk(KERN_CRIT, device, fmt, ## args)\n#define drbd_err(device, fmt, args...) \\\n\tdrbd_printk(KERN_ERR, device, fmt, ## args)\n#define drbd_warn(device, fmt, args...) \\\n\tdrbd_printk(KERN_WARNING, device, fmt, ## args)\n#define drbd_notice(device, fmt, args...) \\\n\tdrbd_printk(KERN_NOTICE, device, fmt, ## args)\n#define drbd_info(device, fmt, args...) \\\n\tdrbd_printk(KERN_INFO, device, fmt, ## args)\n\n\n#define drbd_ratelimit() \\\n({\t\t\t\t\t\t\\\n\tstatic DEFINE_RATELIMIT_STATE(_rs,\t\\\n\t\tDEFAULT_RATELIMIT_INTERVAL,\t\\\n\t\tDEFAULT_RATELIMIT_BURST);\t\\\n\t__ratelimit(&_rs);\t\t\t\\\n})\n\n#define D_ASSERT(x, exp)\t\t\t\t\t\t\t\\\n\tdo {\t\t\t\t\t\t\t\t\t\\\n\t\tif (!(exp))\t\t\t\t\t\t\t\\\n\t\t\tdrbd_err(x, \"ASSERTION %s FAILED in %s\\n\",\t\t\\\n\t\t\t\t#exp, __func__);\t\t\t\t\\\n\t} while (0)\n\n \n#define expect(x, exp) ({\t\t\t\t\t\t\t\\\n\t\tbool _bool = (exp);\t\t\t\t\t\t\\\n\t\tif (!_bool && drbd_ratelimit())\t\t\t\t\t\\\n\t\t\tdrbd_err(x, \"ASSERTION %s FAILED in %s\\n\",\t\t\\\n\t\t\t\t#exp, __func__);\t\t\t\t\\\n\t\t_bool;\t\t\t\t\t\t\t\t\\\n\t\t})\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}