{
  "module_name": "drbd_req.h",
  "hash_id": "64c4d59a102f80e6a37596c833b58e55c1ff95135cb3dbb347a922dc84f8a086",
  "original_prompt": "Ingested from linux-6.6.14/drivers/block/drbd/drbd_req.h",
  "human_readable_source": " \n \n\n#ifndef _DRBD_REQ_H\n#define _DRBD_REQ_H\n\n#include <linux/module.h>\n\n#include <linux/slab.h>\n#include <linux/drbd.h>\n#include \"drbd_int.h\"\n\n \n\n \n\nenum drbd_req_event {\n\tCREATED,\n\tTO_BE_SENT,\n\tTO_BE_SUBMITTED,\n\n\t \n\tQUEUE_FOR_NET_WRITE,\n\tQUEUE_FOR_NET_READ,\n\tQUEUE_FOR_SEND_OOS,\n\n\t \n\tQUEUE_AS_DRBD_BARRIER,\n\n\tSEND_CANCELED,\n\tSEND_FAILED,\n\tHANDED_OVER_TO_NETWORK,\n\tOOS_HANDED_TO_NETWORK,\n\tCONNECTION_LOST_WHILE_PENDING,\n\tREAD_RETRY_REMOTE_CANCELED,\n\tRECV_ACKED_BY_PEER,\n\tWRITE_ACKED_BY_PEER,\n\tWRITE_ACKED_BY_PEER_AND_SIS,  \n\tCONFLICT_RESOLVED,\n\tPOSTPONE_WRITE,\n\tNEG_ACKED,\n\tBARRIER_ACKED,  \n\tDATA_RECEIVED,  \n\n\tCOMPLETED_OK,\n\tREAD_COMPLETED_WITH_ERROR,\n\tREAD_AHEAD_COMPLETED_WITH_ERROR,\n\tWRITE_COMPLETED_WITH_ERROR,\n\tDISCARD_COMPLETED_NOTSUPP,\n\tDISCARD_COMPLETED_WITH_ERROR,\n\n\tABORT_DISK_IO,\n\tRESEND,\n\tFAIL_FROZEN_DISK_IO,\n\tRESTART_FROZEN_DISK_IO,\n\tNOTHING,\n};\n\n \nenum drbd_req_state_bits {\n\t \n\t__RQ_LOCAL_PENDING,\n\t__RQ_LOCAL_COMPLETED,\n\t__RQ_LOCAL_OK,\n\t__RQ_LOCAL_ABORTED,\n\n\t \n\n\t \n\t__RQ_NET_PENDING,\n\n\t \n\t__RQ_NET_QUEUED,\n\n\t \n\t__RQ_NET_SENT,\n\n\t \n\t__RQ_NET_DONE,\n\n\t \n\t__RQ_NET_OK,\n\n\t \n\t__RQ_NET_SIS,\n\n\t \n\t__RQ_NET_MAX,\n\n\t \n\t__RQ_WRITE,\n\t__RQ_WSAME,\n\t__RQ_UNMAP,\n\t__RQ_ZEROES,\n\n\t \n\t__RQ_IN_ACT_LOG,\n\n\t \n\t__RQ_UNPLUG,\n\n\t \n\t__RQ_POSTPONED,\n\n\t \n\t__RQ_COMPLETION_SUSP,\n\n\t \n\t__RQ_EXP_RECEIVE_ACK,\n\n\t \n\t__RQ_EXP_WRITE_ACK,\n\n\t \n\t__RQ_EXP_BARR_ACK,\n};\n\n#define RQ_LOCAL_PENDING   (1UL << __RQ_LOCAL_PENDING)\n#define RQ_LOCAL_COMPLETED (1UL << __RQ_LOCAL_COMPLETED)\n#define RQ_LOCAL_OK        (1UL << __RQ_LOCAL_OK)\n#define RQ_LOCAL_ABORTED   (1UL << __RQ_LOCAL_ABORTED)\n\n#define RQ_LOCAL_MASK      ((RQ_LOCAL_ABORTED << 1)-1)\n\n#define RQ_NET_PENDING     (1UL << __RQ_NET_PENDING)\n#define RQ_NET_QUEUED      (1UL << __RQ_NET_QUEUED)\n#define RQ_NET_SENT        (1UL << __RQ_NET_SENT)\n#define RQ_NET_DONE        (1UL << __RQ_NET_DONE)\n#define RQ_NET_OK          (1UL << __RQ_NET_OK)\n#define RQ_NET_SIS         (1UL << __RQ_NET_SIS)\n\n#define RQ_NET_MASK        (((1UL << __RQ_NET_MAX)-1) & ~RQ_LOCAL_MASK)\n\n#define RQ_WRITE           (1UL << __RQ_WRITE)\n#define RQ_WSAME           (1UL << __RQ_WSAME)\n#define RQ_UNMAP           (1UL << __RQ_UNMAP)\n#define RQ_ZEROES          (1UL << __RQ_ZEROES)\n#define RQ_IN_ACT_LOG      (1UL << __RQ_IN_ACT_LOG)\n#define RQ_UNPLUG          (1UL << __RQ_UNPLUG)\n#define RQ_POSTPONED\t   (1UL << __RQ_POSTPONED)\n#define RQ_COMPLETION_SUSP (1UL << __RQ_COMPLETION_SUSP)\n#define RQ_EXP_RECEIVE_ACK (1UL << __RQ_EXP_RECEIVE_ACK)\n#define RQ_EXP_WRITE_ACK   (1UL << __RQ_EXP_WRITE_ACK)\n#define RQ_EXP_BARR_ACK    (1UL << __RQ_EXP_BARR_ACK)\n\n \n#define MR_WRITE       1\n#define MR_READ        2\n\n \nstruct bio_and_error {\n\tstruct bio *bio;\n\tint error;\n};\n\nextern void start_new_tl_epoch(struct drbd_connection *connection);\nextern void drbd_req_destroy(struct kref *kref);\nextern int __req_mod(struct drbd_request *req, enum drbd_req_event what,\n\t\tstruct drbd_peer_device *peer_device,\n\t\tstruct bio_and_error *m);\nextern void complete_master_bio(struct drbd_device *device,\n\t\tstruct bio_and_error *m);\nextern void request_timer_fn(struct timer_list *t);\nextern void tl_restart(struct drbd_connection *connection, enum drbd_req_event what);\nextern void _tl_restart(struct drbd_connection *connection, enum drbd_req_event what);\nextern void tl_abort_disk_io(struct drbd_device *device);\n\n \nextern void drbd_restart_request(struct drbd_request *req);\n\n \nstatic inline int _req_mod(struct drbd_request *req, enum drbd_req_event what,\n\t\tstruct drbd_peer_device *peer_device)\n{\n\tstruct drbd_device *device = req->device;\n\tstruct bio_and_error m;\n\tint rv;\n\n\t \n\trv = __req_mod(req, what, peer_device, &m);\n\tif (m.bio)\n\t\tcomplete_master_bio(device, &m);\n\n\treturn rv;\n}\n\n \nstatic inline int req_mod(struct drbd_request *req,\n\t\tenum drbd_req_event what,\n\t\tstruct drbd_peer_device *peer_device)\n{\n\tunsigned long flags;\n\tstruct drbd_device *device = req->device;\n\tstruct bio_and_error m;\n\tint rv;\n\n\tspin_lock_irqsave(&device->resource->req_lock, flags);\n\trv = __req_mod(req, what, peer_device, &m);\n\tspin_unlock_irqrestore(&device->resource->req_lock, flags);\n\n\tif (m.bio)\n\t\tcomplete_master_bio(device, &m);\n\n\treturn rv;\n}\n\nextern bool drbd_should_do_remote(union drbd_dev_state);\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}