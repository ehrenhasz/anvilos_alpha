{
  "module_name": "swim_asm.S",
  "hash_id": "f49627bf7f06d22c40ff3f32c848fa41ad0df39fe3fdb3c3604fdc175998a549",
  "original_prompt": "Ingested from linux-6.6.14/drivers/block/swim_asm.S",
  "human_readable_source": " \n \n\n\t.equ\twrite_data,\t0x0000\n\t.equ\twrite_mark,\t0x0200\n\t.equ\twrite_CRC,\t0x0400\n\t.equ\twrite_parameter,0x0600\n\t.equ\twrite_phase,\t0x0800\n\t.equ\twrite_setup,\t0x0a00\n\t.equ\twrite_mode0,\t0x0c00\n\t.equ\twrite_mode1,\t0x0e00\n\t.equ\tread_data,\t0x1000\n\t.equ\tread_mark,\t0x1200\n\t.equ\tread_error,\t0x1400\n\t.equ\tread_parameter,\t0x1600\n\t.equ\tread_phase,\t0x1800\n\t.equ\tread_setup,\t0x1a00\n\t.equ\tread_status,\t0x1c00\n\t.equ\tread_handshake,\t0x1e00\n\n\t.equ\to_side, 0\n\t.equ\to_track, 1\n\t.equ\to_sector, 2\n\t.equ\to_size, 3\n\t.equ\to_crc0, 4\n\t.equ\to_crc1, 5\n\n\t.equ\tseek_time, 30000\n\t.equ\tmax_retry, 40\n\t.equ\tsector_size, 512\n\n\t.global swim_read_sector_header\nswim_read_sector_header:\n\tlink\t%a6, #0\n\tmoveml\t%d1-%d5/%a0-%a4,%sp@-\n\tmovel\t%a6@(0x0c), %a4\n\tbsr\tmfm_read_addrmark\n\tmoveml\t%sp@+, %d1-%d5/%a0-%a4\n\tunlk\t%a6\n\trts\n\nsector_address_mark:\n\t.byte\t0xa1, 0xa1, 0xa1, 0xfe\nsector_data_mark:\n\t.byte\t0xa1, 0xa1, 0xa1, 0xfb\n\nmfm_read_addrmark:\n\tmovel\t%a6@(0x08), %a3\n\tlea\t%a3@(read_handshake), %a2\n\tlea\t%a3@(read_mark), %a3\n\tmoveq\t#-1, %d0\n\tmovew\t#seek_time, %d2\n\nwait_header_init:\n\ttstb\t%a3@(read_error - read_mark)\n\tmoveb\t#0x18, %a3@(write_mode0 - read_mark)\n\tmoveb\t#0x01, %a3@(write_mode1 - read_mark)\n\tmoveb\t#0x01, %a3@(write_mode0 - read_mark)\n\ttstb\t%a3@(read_error - read_mark)\n\tmoveb\t#0x08, %a3@(write_mode1 - read_mark)\n\n\tlea\tsector_address_mark, %a0\n\tmoveq\t#3, %d1\n\nwait_addr_mark_byte:\n\n\ttstb\t%a2@\n\tdbmi\t%d2, wait_addr_mark_byte\n\tbpl\theader_exit\n\n\tmoveb\t%a3@, %d3\n\tcmpb\t%a0@+, %d3\n\tdbne\t%d1, wait_addr_mark_byte\n\tbne\twait_header_init\n\n\tmoveq\t#max_retry, %d2\n\namark0:\ttstb\t%a2@\n\tdbmi\t%d2, amark0\n\tbpl\tsignal_nonyb\n\n\tmoveb\t%a3@, %a4@(o_track)\n\n\tmoveq\t#max_retry, %d2\n\namark1:\ttstb\t%a2@\n\tdbmi\t%d2, amark1\n\tbpl\tsignal_nonyb\n\n\tmoveb\t%a3@, %a4@(o_side)\n\n\tmoveq\t#max_retry, %d2\n\namark2:\ttstb\t%a2@\n\tdbmi\t%d2, amark2\n\tbpl\tsignal_nonyb\n\n\tmoveb\t%a3@, %a4@(o_sector)\n\n\tmoveq\t#max_retry, %d2\n\namark3:\ttstb\t%a2@\n\tdbmi\t%d2, amark3\n\tbpl\tsignal_nonyb\n\n\tmoveb\t%a3@, %a4@(o_size)\n\n\tmoveq\t#max_retry, %d2\n\ncrc0:\ttstb\t%a2@\n\tdbmi\t%d2, crc0\n\tbpl\tsignal_nonyb\n\n\tmoveb\t%a3@, %a4@(o_crc0)\n\n\tmoveq\t#max_retry, %d2\n\ncrc1:\ttstb\t%a2@\n\tdbmi\t%d2, crc1\n\tbpl\tsignal_nonyb\n\n\tmoveb\t%a3@, %a4@(o_crc1)\n\n\ttstb\t%a3@(read_error - read_mark)\n\nheader_exit:\n\tmoveq\t#0, %d0\n\tmoveb\t#0x18, %a3@(write_mode0 - read_mark)\n\trts\nsignal_nonyb:\n\tmoveq\t#-1, %d0\n\tmoveb\t#0x18, %a3@(write_mode0 - read_mark)\n\trts\n\n\t.global swim_read_sector_data\nswim_read_sector_data:\n\tlink\t%a6, #0\n\tmoveml\t%d1-%d5/%a0-%a5,%sp@-\n\tmovel\t%a6@(0x0c), %a4\n\tbsr\tmfm_read_data\n\tmoveml\t%sp@+, %d1-%d5/%a0-%a5\n\tunlk\t%a6\n\trts\n\nmfm_read_data:\n\tmovel\t%a6@(0x08), %a3\n\tlea\t%a3@(read_handshake), %a2\n\tlea\t%a3@(read_data), %a5\n\tlea\t%a3@(read_mark), %a3\n\tmovew\t#seek_time, %d2\n\nwait_data_init:\n\ttstb\t%a3@(read_error - read_mark)\n\tmoveb\t#0x18, %a3@(write_mode0 - read_mark)\n\tmoveb\t#0x01, %a3@(write_mode1 - read_mark)\n\tmoveb\t#0x01, %a3@(write_mode0 - read_mark)\n\ttstb\t%a3@(read_error - read_mark)\n\tmoveb\t#0x08, %a3@(write_mode1 - read_mark)\n\n\tlea\tsector_data_mark, %a0\n\tmoveq\t#3, %d1\n\n\t \n\nwait_data_mark_byte:\n\n\ttstb\t%a2@\n\tdbmi\t%d2, wait_data_mark_byte\n\tbpl\tdata_exit\n\n\tmoveb\t%a3@, %d3\n\tcmpb\t%a0@+, %d3\n\tdbne\t%d1, wait_data_mark_byte\n\tbne\twait_data_init\n\n\t \n\n\ttstb\t%a3@(read_error - read_mark)\n\n\tmovel\t#sector_size-1, %d4\t\t \nread_new_data:\n\tmovew\t#max_retry, %d2\nread_data_loop:\n\tmoveb\t%a2@, %d5\n\tandb\t#0xc0, %d5\n\tdbne\t%d2, read_data_loop\n\tbeq\tdata_exit\n\tmoveb\t%a5@, %a4@+\n\tandb\t#0x40, %d5\n\tdbne\t%d4, read_new_data\n\tbeq\texit_loop\n\tmoveb\t%a5@, %a4@+\n\tdbra\t%d4, read_new_data\nexit_loop:\n\n\t \n\n\tmovew\t#max_retry, %d2\ndata_crc0:\n\n\ttstb\t%a2@\n\tdbmi\t%d2, data_crc0\n\tbpl\tdata_exit\n\n\tmoveb\t%a3@, %d5\n\n\tmoveq\t#max_retry, %d2\n\ndata_crc1:\n\n\ttstb\t%a2@\n\tdbmi\t%d2, data_crc1\n\tbpl\tdata_exit\n\n\tmoveb\t%a3@, %d5\n\n\ttstb\t%a3@(read_error - read_mark)\n\n\tmoveb\t#0x18, %a3@(write_mode0 - read_mark)\n\n\t \n\n\tmovel\t#sector_size, %d0\n\taddw\t#1, %d4\n\tsubl\t%d4, %d0\n\trts\ndata_exit:\n\tmoveb\t#0x18, %a3@(write_mode0 - read_mark)\n\tmoveq\t#-1, %d0\n\trts\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}