{
  "module_name": "rnbd-srv-trace.h",
  "hash_id": "013c81657332c59b58dd4cd955c3a0efbdc6e235c507b531d35a6228bf41f32a",
  "original_prompt": "Ingested from linux-6.6.14/drivers/block/rnbd/rnbd-srv-trace.h",
  "human_readable_source": " \n \n#undef TRACE_SYSTEM\n#define TRACE_SYSTEM rnbd_srv\n\n#if !defined(_TRACE_RNBD_SRV_H) || defined(TRACE_HEADER_MULTI_READ)\n#define _TRACE_RNBD_SRV_H\n\n#include <linux/tracepoint.h>\n\nstruct rnbd_srv_session;\nstruct rtrs_srv_op;\n\nDECLARE_EVENT_CLASS(rnbd_srv_link_class,\n\tTP_PROTO(struct rnbd_srv_session *srv),\n\n\tTP_ARGS(srv),\n\n\tTP_STRUCT__entry(\n\t\t__field(int, qdepth)\n\t\t__string(sessname, srv->sessname)\n\t),\n\n\tTP_fast_assign(\n\t\t__entry->qdepth = srv->queue_depth;\n\t\t__assign_str(sessname, srv->sessname);\n\t),\n\n\tTP_printk(\"sessname: %s qdepth: %d\",\n\t\t   __get_str(sessname),\n\t\t   __entry->qdepth\n\t)\n);\n\n#define DEFINE_LINK_EVENT(name) \\\nDEFINE_EVENT(rnbd_srv_link_class, name, \\\n\tTP_PROTO(struct rnbd_srv_session *srv), \\\n\tTP_ARGS(srv))\n\nDEFINE_LINK_EVENT(create_sess);\nDEFINE_LINK_EVENT(destroy_sess);\n\nTRACE_DEFINE_ENUM(RNBD_OP_READ);\nTRACE_DEFINE_ENUM(RNBD_OP_WRITE);\nTRACE_DEFINE_ENUM(RNBD_OP_FLUSH);\nTRACE_DEFINE_ENUM(RNBD_OP_DISCARD);\nTRACE_DEFINE_ENUM(RNBD_OP_SECURE_ERASE);\nTRACE_DEFINE_ENUM(RNBD_F_SYNC);\nTRACE_DEFINE_ENUM(RNBD_F_FUA);\n\n#define show_rnbd_rw_flags(x) \\\n\t__print_flags(x, \"|\", \\\n\t\t{ RNBD_OP_READ,\t\t\"READ\" }, \\\n\t\t{ RNBD_OP_WRITE,\t\"WRITE\" }, \\\n\t\t{ RNBD_OP_FLUSH,\t\"FLUSH\" }, \\\n\t\t{ RNBD_OP_DISCARD,\t\"DISCARD\" }, \\\n\t\t{ RNBD_OP_SECURE_ERASE,\t\"SECURE_ERASE\" }, \\\n\t\t{ RNBD_F_SYNC,\t\t\"SYNC\" }, \\\n\t\t{ RNBD_F_FUA,\t\t\"FUA\" })\n\nTRACE_EVENT(process_rdma,\n\tTP_PROTO(struct rnbd_srv_session *srv,\n\t\t const struct rnbd_msg_io *msg,\n\t\t struct rtrs_srv_op *id,\n\t\t u32 datalen,\n\t\t size_t usrlen),\n\n\tTP_ARGS(srv, msg, id, datalen, usrlen),\n\n\tTP_STRUCT__entry(\n\t\t__string(sessname, srv->sessname)\n\t\t__field(u8, dir)\n\t\t__field(u8, ver)\n\t\t__field(u32, device_id)\n\t\t__field(u64, sector)\n\t\t__field(u32, flags)\n\t\t__field(u32, bi_size)\n\t\t__field(u16, ioprio)\n\t\t__field(u32, datalen)\n\t\t__field(size_t, usrlen)\n\t),\n\n\tTP_fast_assign(\n\t\t__assign_str(sessname, srv->sessname);\n\t\t__entry->dir = id->dir;\n\t\t__entry->ver = srv->ver;\n\t\t__entry->device_id = le32_to_cpu(msg->device_id);\n\t\t__entry->sector = le64_to_cpu(msg->sector);\n\t\t__entry->bi_size = le32_to_cpu(msg->bi_size);\n\t\t__entry->flags = le32_to_cpu(msg->rw);\n\t\t__entry->ioprio = le16_to_cpu(msg->prio);\n\t\t__entry->datalen = datalen;\n\t\t__entry->usrlen = usrlen;\n\t),\n\n\tTP_printk(\"I/O req: sess: %s, type: %s, ver: %d, devid: %u, sector: %llu, bsize: %u, flags: %s, ioprio: %d, datalen: %u, usrlen: %zu\",\n\t\t   __get_str(sessname),\n\t\t   __print_symbolic(__entry->dir,\n\t\t\t { READ,  \"READ\" },\n\t\t\t { WRITE, \"WRITE\" }),\n\t\t   __entry->ver,\n\t\t   __entry->device_id,\n\t\t   __entry->sector,\n\t\t   __entry->bi_size,\n\t\t   show_rnbd_rw_flags(__entry->flags),\n\t\t   __entry->ioprio,\n\t\t   __entry->datalen,\n\t\t   __entry->usrlen\n\t)\n);\n\nTRACE_EVENT(process_msg_sess_info,\n\tTP_PROTO(struct rnbd_srv_session *srv,\n\t\t const struct rnbd_msg_sess_info *msg),\n\n\tTP_ARGS(srv, msg),\n\n\tTP_STRUCT__entry(\n\t\t__field(u8, proto_ver)\n\t\t__field(u8, clt_ver)\n\t\t__field(u8, srv_ver)\n\t\t__string(sessname, srv->sessname)\n\t),\n\n\tTP_fast_assign(\n\t\t__entry->proto_ver = srv->ver;\n\t\t__entry->clt_ver = msg->ver;\n\t\t__entry->srv_ver = RNBD_PROTO_VER_MAJOR;\n\t\t__assign_str(sessname, srv->sessname);\n\t),\n\n\tTP_printk(\"Session %s using proto-ver %d (clt-ver: %d, srv-ver: %d)\",\n\t\t   __get_str(sessname),\n\t\t   __entry->proto_ver,\n\t\t   __entry->clt_ver,\n\t\t   __entry->srv_ver\n\t)\n);\n\nTRACE_DEFINE_ENUM(RNBD_ACCESS_RO);\nTRACE_DEFINE_ENUM(RNBD_ACCESS_RW);\nTRACE_DEFINE_ENUM(RNBD_ACCESS_MIGRATION);\n\n#define show_rnbd_access_mode(x) \\\n\t__print_symbolic(x, \\\n\t\t{ RNBD_ACCESS_RO,\t\t\"RO\" }, \\\n\t\t{ RNBD_ACCESS_RW,\t\t\"RW\" }, \\\n\t\t{ RNBD_ACCESS_MIGRATION,\t\"MIGRATION\" })\n\nTRACE_EVENT(process_msg_open,\n\tTP_PROTO(struct rnbd_srv_session *srv,\n\t\t const struct rnbd_msg_open *msg),\n\n\tTP_ARGS(srv, msg),\n\n\tTP_STRUCT__entry(\n\t\t__field(u8, access_mode)\n\t\t__string(sessname, srv->sessname)\n\t\t__string(dev_name, msg->dev_name)\n\t),\n\n\tTP_fast_assign(\n\t\t__entry->access_mode = msg->access_mode;\n\t\t__assign_str(sessname, srv->sessname);\n\t\t__assign_str(dev_name, msg->dev_name);\n\t),\n\n\tTP_printk(\"Open message received: session='%s' path='%s' access_mode=%s\",\n\t\t   __get_str(sessname),\n\t\t   __get_str(dev_name),\n\t\t   show_rnbd_access_mode(__entry->access_mode)\n\t)\n);\n\nTRACE_EVENT(process_msg_close,\n\tTP_PROTO(struct rnbd_srv_session *srv,\n\t\t const struct rnbd_msg_close *msg),\n\n\tTP_ARGS(srv, msg),\n\n\tTP_STRUCT__entry(\n\t\t__field(u32, device_id)\n\t\t__string(sessname, srv->sessname)\n\t),\n\n\tTP_fast_assign(\n\t\t__entry->device_id = le32_to_cpu(msg->device_id);\n\t\t__assign_str(sessname, srv->sessname);\n\t),\n\n\tTP_printk(\"Close message received: session='%s' device id='%d'\",\n\t\t   __get_str(sessname),\n\t\t   __entry->device_id\n\t)\n);\n\n#endif  \n\n#undef TRACE_INCLUDE_PATH\n#define TRACE_INCLUDE_PATH .\n#define TRACE_INCLUDE_FILE rnbd-srv-trace\n#include <trace/define_trace.h>\n\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}