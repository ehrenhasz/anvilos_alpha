{
  "module_name": "coresight-priv.h",
  "hash_id": "60833e33ac93c985aa99cb34a248373ce6dcc76b70d08c3df21440c557c9b3bd",
  "original_prompt": "Ingested from linux-6.6.14/drivers/hwtracing/coresight/coresight-priv.h",
  "human_readable_source": " \n \n\n#ifndef _CORESIGHT_PRIV_H\n#define _CORESIGHT_PRIV_H\n\n#include <linux/amba/bus.h>\n#include <linux/bitops.h>\n#include <linux/io.h>\n#include <linux/coresight.h>\n#include <linux/pm_runtime.h>\n\n \n#define CORESIGHT_ITCTRL\t0xf00\n#define CORESIGHT_CLAIMSET\t0xfa0\n#define CORESIGHT_CLAIMCLR\t0xfa4\n#define CORESIGHT_LAR\t\t0xfb0\n#define CORESIGHT_LSR\t\t0xfb4\n#define CORESIGHT_DEVARCH\t0xfbc\n#define CORESIGHT_AUTHSTATUS\t0xfb8\n#define CORESIGHT_DEVID\t\t0xfc8\n#define CORESIGHT_DEVTYPE\t0xfcc\n\n\n \n#define CORESIGHT_CLAIM_SELF_HOSTED\tBIT(1)\n\n#define TIMEOUT_US\t\t100\n#define BMVAL(val, lsb, msb)\t((val & GENMASK(msb, lsb)) >> lsb)\n\n#define ETM_MODE_EXCL_KERN\tBIT(30)\n#define ETM_MODE_EXCL_USER\tBIT(31)\nstruct cs_pair_attribute {\n\tstruct device_attribute attr;\n\tu32 lo_off;\n\tu32 hi_off;\n};\n\nstruct cs_off_attribute {\n\tstruct device_attribute attr;\n\tu32 off;\n};\n\nextern ssize_t coresight_simple_show32(struct device *_dev,\n\t\t\t\t     struct device_attribute *attr, char *buf);\nextern ssize_t coresight_simple_show_pair(struct device *_dev,\n\t\t\t\t     struct device_attribute *attr, char *buf);\n\n#define coresight_simple_reg32(name, offset)\t\t\t\t\\\n\t(&((struct cs_off_attribute[]) {\t\t\t\t\\\n\t   {\t\t\t\t\t\t\t\t\\\n\t\t__ATTR(name, 0444, coresight_simple_show32, NULL),\t\\\n\t\toffset\t\t\t\t\t\t\t\\\n\t   }\t\t\t\t\t\t\t\t\\\n\t})[0].attr.attr)\n\n#define coresight_simple_reg64(name, lo_off, hi_off)\t\t\t\\\n\t(&((struct cs_pair_attribute[]) {\t\t\t\t\\\n\t   {\t\t\t\t\t\t\t\t\\\n\t\t__ATTR(name, 0444, coresight_simple_show_pair, NULL),\t\\\n\t\tlo_off, hi_off\t\t\t\t\t\t\\\n\t   }\t\t\t\t\t\t\t\t\\\n\t})[0].attr.attr)\n\nextern const u32 coresight_barrier_pkt[4];\n#define CORESIGHT_BARRIER_PKT_SIZE (sizeof(coresight_barrier_pkt))\n\nenum etm_addr_type {\n\tETM_ADDR_TYPE_NONE,\n\tETM_ADDR_TYPE_SINGLE,\n\tETM_ADDR_TYPE_RANGE,\n\tETM_ADDR_TYPE_START,\n\tETM_ADDR_TYPE_STOP,\n};\n\n \nstruct cs_buffers {\n\tunsigned int\t\tcur;\n\tunsigned int\t\tnr_pages;\n\tpid_t\t\t\tpid;\n\tunsigned long\t\toffset;\n\tlocal_t\t\t\tdata_size;\n\tbool\t\t\tsnapshot;\n\tvoid\t\t\t**data_pages;\n};\n\nstatic inline void coresight_insert_barrier_packet(void *buf)\n{\n\tif (buf)\n\t\tmemcpy(buf, coresight_barrier_pkt, CORESIGHT_BARRIER_PKT_SIZE);\n}\n\nstatic inline void CS_LOCK(void __iomem *addr)\n{\n\tdo {\n\t\t \n\t\tmb();\n\t\twritel_relaxed(0x0, addr + CORESIGHT_LAR);\n\t} while (0);\n}\n\nstatic inline void CS_UNLOCK(void __iomem *addr)\n{\n\tdo {\n\t\twritel_relaxed(CORESIGHT_UNLOCK, addr + CORESIGHT_LAR);\n\t\t \n\t\tmb();\n\t} while (0);\n}\n\nvoid coresight_disable_path(struct list_head *path);\nint coresight_enable_path(struct list_head *path, enum cs_mode mode,\n\t\t\t  void *sink_data);\nstruct coresight_device *coresight_get_sink(struct list_head *path);\nstruct coresight_device *\ncoresight_get_enabled_sink(struct coresight_device *source);\nstruct coresight_device *coresight_get_sink_by_id(u32 id);\nstruct coresight_device *\ncoresight_find_default_sink(struct coresight_device *csdev);\nstruct list_head *coresight_build_path(struct coresight_device *csdev,\n\t\t\t\t       struct coresight_device *sink);\nvoid coresight_release_path(struct list_head *path);\nint coresight_add_sysfs_link(struct coresight_sysfs_link *info);\nvoid coresight_remove_sysfs_link(struct coresight_sysfs_link *info);\nint coresight_create_conns_sysfs_group(struct coresight_device *csdev);\nvoid coresight_remove_conns_sysfs_group(struct coresight_device *csdev);\nint coresight_make_links(struct coresight_device *orig,\n\t\t\t struct coresight_connection *conn,\n\t\t\t struct coresight_device *target);\nvoid coresight_remove_links(struct coresight_device *orig,\n\t\t\t    struct coresight_connection *conn);\n\n#if IS_ENABLED(CONFIG_CORESIGHT_SOURCE_ETM3X)\nextern int etm_readl_cp14(u32 off, unsigned int *val);\nextern int etm_writel_cp14(u32 off, u32 val);\n#else\nstatic inline int etm_readl_cp14(u32 off, unsigned int *val) { return 0; }\nstatic inline int etm_writel_cp14(u32 off, u32 val) { return 0; }\n#endif\n\nstruct cti_assoc_op {\n\tvoid (*add)(struct coresight_device *csdev);\n\tvoid (*remove)(struct coresight_device *csdev);\n};\n\nextern void coresight_set_cti_ops(const struct cti_assoc_op *cti_op);\nextern void coresight_remove_cti_ops(void);\n\n \n\n \n#define CS_AMBA_ID(pid)\t\t\t\\\n\t{\t\t\t\t\\\n\t\t.id\t= pid,\t\t\\\n\t\t.mask\t= 0x000fffff,\t\\\n\t}\n\n \n#define CS_AMBA_ID_DATA(pid, dval)\t\t\t\t\\\n\t{\t\t\t\t\t\t\t\\\n\t\t.id\t= pid,\t\t\t\t\t\\\n\t\t.mask\t= 0x000fffff,\t\t\t\t\\\n\t\t.data\t=  (void *)&(struct amba_cs_uci_id)\t\\\n\t\t\t{\t\t\t\t\\\n\t\t\t\t.data = (void *)dval,\t\\\n\t\t\t}\t\t\t\t\\\n\t}\n\n \n#define __CS_AMBA_UCI_ID(pid, m, uci_ptr)\t\\\n\t{\t\t\t\t\t\\\n\t\t.id\t= pid,\t\t\t\\\n\t\t.mask\t= m,\t\t\t\\\n\t\t.data\t= (void *)uci_ptr\t\\\n\t}\n#define CS_AMBA_UCI_ID(pid, uci)\t__CS_AMBA_UCI_ID(pid, 0x000fffff, uci)\n \n#define PIDR2_JEDEC\t\t\tBIT(3)\n#define PID_PIDR2_JEDEC\t\t\t(PIDR2_JEDEC << 16)\n \n#define CS_AMBA_MATCH_ALL_UCI(uci)\t\t\t\t\t\\\n\t__CS_AMBA_UCI_ID(PID_PIDR2_JEDEC, PID_PIDR2_JEDEC, uci)\n\n \nstatic inline void *coresight_get_uci_data(const struct amba_id *id)\n{\n\tstruct amba_cs_uci_id *uci_id = id->data;\n\n\tif (!uci_id)\n\t\treturn NULL;\n\n\treturn uci_id->data;\n}\n\nvoid coresight_release_platform_data(struct coresight_device *csdev,\n\t\t\t\t     struct device *dev,\n\t\t\t\t     struct coresight_platform_data *pdata);\nstruct coresight_device *\ncoresight_find_csdev_by_fwnode(struct fwnode_handle *r_fwnode);\nvoid coresight_add_helper(struct coresight_device *csdev,\n\t\t\t  struct coresight_device *helper);\n\nvoid coresight_set_percpu_sink(int cpu, struct coresight_device *csdev);\nstruct coresight_device *coresight_get_percpu_sink(int cpu);\nint coresight_enable_source(struct coresight_device *csdev, enum cs_mode mode,\n\t\t\t    void *data);\nbool coresight_disable_source(struct coresight_device *csdev, void *data);\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}