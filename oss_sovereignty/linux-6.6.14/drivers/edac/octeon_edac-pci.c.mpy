{
  "module_name": "octeon_edac-pci.c",
  "hash_id": "4bc976b08c65859e39a5c35b5d1869c257effa7fcc92b7bf0d4ec48597eb9ae4",
  "original_prompt": "Ingested from linux-6.6.14/drivers/edac/octeon_edac-pci.c",
  "human_readable_source": " \n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/slab.h>\n#include <linux/io.h>\n#include <linux/edac.h>\n\n#include <asm/octeon/cvmx.h>\n#include <asm/octeon/cvmx-npi-defs.h>\n#include <asm/octeon/cvmx-pci-defs.h>\n#include <asm/octeon/octeon.h>\n\n#include \"edac_module.h\"\n\nstatic void octeon_pci_poll(struct edac_pci_ctl_info *pci)\n{\n\tunion cvmx_pci_cfg01 cfg01;\n\n\tcfg01.u32 = octeon_npi_read32(CVMX_NPI_PCI_CFG01);\n\tif (cfg01.s.dpe) {\t\t \n\t\tedac_pci_handle_pe(pci, pci->ctl_name);\n\t\tcfg01.s.dpe = 1;\t\t \n\t\tocteon_npi_write32(CVMX_NPI_PCI_CFG01, cfg01.u32);\n\t}\n\tif (cfg01.s.sse) {\n\t\tedac_pci_handle_npe(pci, \"Signaled System Error\");\n\t\tcfg01.s.sse = 1;\t\t \n\t\tocteon_npi_write32(CVMX_NPI_PCI_CFG01, cfg01.u32);\n\t}\n\tif (cfg01.s.rma) {\n\t\tedac_pci_handle_npe(pci, \"Received Master Abort\");\n\t\tcfg01.s.rma = 1;\t\t \n\t\tocteon_npi_write32(CVMX_NPI_PCI_CFG01, cfg01.u32);\n\t}\n\tif (cfg01.s.rta) {\n\t\tedac_pci_handle_npe(pci, \"Received Target Abort\");\n\t\tcfg01.s.rta = 1;\t\t \n\t\tocteon_npi_write32(CVMX_NPI_PCI_CFG01, cfg01.u32);\n\t}\n\tif (cfg01.s.sta) {\n\t\tedac_pci_handle_npe(pci, \"Signaled Target Abort\");\n\t\tcfg01.s.sta = 1;\t\t \n\t\tocteon_npi_write32(CVMX_NPI_PCI_CFG01, cfg01.u32);\n\t}\n\tif (cfg01.s.mdpe) {\n\t\tedac_pci_handle_npe(pci, \"Master Data Parity Error\");\n\t\tcfg01.s.mdpe = 1;\t\t \n\t\tocteon_npi_write32(CVMX_NPI_PCI_CFG01, cfg01.u32);\n\t}\n}\n\nstatic int octeon_pci_probe(struct platform_device *pdev)\n{\n\tstruct edac_pci_ctl_info *pci;\n\tint res = 0;\n\n\tpci = edac_pci_alloc_ctl_info(0, \"octeon_pci_err\");\n\tif (!pci)\n\t\treturn -ENOMEM;\n\n\tpci->dev = &pdev->dev;\n\tplatform_set_drvdata(pdev, pci);\n\tpci->dev_name = dev_name(&pdev->dev);\n\n\tpci->mod_name = \"octeon-pci\";\n\tpci->ctl_name = \"octeon_pci_err\";\n\tpci->edac_check = octeon_pci_poll;\n\n\tif (edac_pci_add_device(pci, 0) > 0) {\n\t\tpr_err(\"%s: edac_pci_add_device() failed\\n\", __func__);\n\t\tgoto err;\n\t}\n\n\treturn 0;\n\nerr:\n\tedac_pci_free_ctl_info(pci);\n\n\treturn res;\n}\n\nstatic int octeon_pci_remove(struct platform_device *pdev)\n{\n\tstruct edac_pci_ctl_info *pci = platform_get_drvdata(pdev);\n\n\tedac_pci_del_device(&pdev->dev);\n\tedac_pci_free_ctl_info(pci);\n\n\treturn 0;\n}\n\nstatic struct platform_driver octeon_pci_driver = {\n\t.probe = octeon_pci_probe,\n\t.remove = octeon_pci_remove,\n\t.driver = {\n\t\t   .name = \"octeon_pci_edac\",\n\t}\n};\nmodule_platform_driver(octeon_pci_driver);\n\nMODULE_LICENSE(\"GPL\");\nMODULE_AUTHOR(\"Ralf Baechle <ralf@linux-mips.org>\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}