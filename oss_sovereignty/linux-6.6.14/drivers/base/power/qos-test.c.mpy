{
  "module_name": "qos-test.c",
  "hash_id": "e4dcb43f9e59de1e5f0b82f51c16f86f8975a87b18e619431d687c77899b10b8",
  "original_prompt": "Ingested from linux-6.6.14/drivers/base/power/qos-test.c",
  "human_readable_source": "\n \n#include <kunit/test.h>\n#include <linux/pm_qos.h>\n\n \nstatic void freq_qos_test_min(struct kunit *test)\n{\n\tstruct freq_constraints\tqos;\n\tstruct freq_qos_request\treq1, req2;\n\tint ret;\n\n\tfreq_constraints_init(&qos);\n\tmemset(&req1, 0, sizeof(req1));\n\tmemset(&req2, 0, sizeof(req2));\n\n\tret = freq_qos_add_request(&qos, &req1, FREQ_QOS_MIN, 1000);\n\tKUNIT_EXPECT_EQ(test, ret, 1);\n\tret = freq_qos_add_request(&qos, &req2, FREQ_QOS_MIN, 2000);\n\tKUNIT_EXPECT_EQ(test, ret, 1);\n\n\tKUNIT_EXPECT_EQ(test, freq_qos_read_value(&qos, FREQ_QOS_MIN), 2000);\n\n\tret = freq_qos_remove_request(&req2);\n\tKUNIT_EXPECT_EQ(test, ret, 1);\n\tKUNIT_EXPECT_EQ(test, freq_qos_read_value(&qos, FREQ_QOS_MIN), 1000);\n\n\tret = freq_qos_remove_request(&req1);\n\tKUNIT_EXPECT_EQ(test, ret, 1);\n\tKUNIT_EXPECT_EQ(test, freq_qos_read_value(&qos, FREQ_QOS_MIN),\n\t\t\tFREQ_QOS_MIN_DEFAULT_VALUE);\n}\n\n \nstatic void freq_qos_test_maxdef(struct kunit *test)\n{\n\tstruct freq_constraints\tqos;\n\tstruct freq_qos_request\treq1, req2;\n\tint ret;\n\n\tfreq_constraints_init(&qos);\n\tmemset(&req1, 0, sizeof(req1));\n\tmemset(&req2, 0, sizeof(req2));\n\tKUNIT_EXPECT_EQ(test, freq_qos_read_value(&qos, FREQ_QOS_MAX),\n\t\t\tFREQ_QOS_MAX_DEFAULT_VALUE);\n\n\tret = freq_qos_add_request(&qos, &req1, FREQ_QOS_MAX,\n\t\t\tFREQ_QOS_MAX_DEFAULT_VALUE);\n\tKUNIT_EXPECT_EQ(test, ret, 0);\n\tret = freq_qos_add_request(&qos, &req2, FREQ_QOS_MAX,\n\t\t\tFREQ_QOS_MAX_DEFAULT_VALUE);\n\tKUNIT_EXPECT_EQ(test, ret, 0);\n\n\t \n\tret = freq_qos_update_request(&req1, 1000);\n\tKUNIT_EXPECT_EQ(test, ret, 1);\n\tKUNIT_EXPECT_EQ(test, freq_qos_read_value(&qos, FREQ_QOS_MAX), 1000);\n\n\t \n\tret = freq_qos_update_request(&req2, 2000);\n\tKUNIT_EXPECT_EQ(test, ret, 0);\n\tKUNIT_EXPECT_EQ(test, freq_qos_read_value(&qos, FREQ_QOS_MAX), 1000);\n\n\t \n\tret = freq_qos_remove_request(&req1);\n\tKUNIT_EXPECT_EQ(test, ret, 1);\n\tKUNIT_EXPECT_EQ(test, freq_qos_read_value(&qos, FREQ_QOS_MAX), 2000);\n}\n\n \nstatic void freq_qos_test_readd(struct kunit *test)\n{\n\tstruct freq_constraints\tqos;\n\tstruct freq_qos_request\treq;\n\tint ret;\n\n\tfreq_constraints_init(&qos);\n\tmemset(&req, 0, sizeof(req));\n\tKUNIT_EXPECT_EQ(test, freq_qos_read_value(&qos, FREQ_QOS_MIN),\n\t\t\tFREQ_QOS_MIN_DEFAULT_VALUE);\n\n\t \n\tret = freq_qos_add_request(&qos, &req, FREQ_QOS_MIN, 1000);\n\tKUNIT_EXPECT_EQ(test, ret, 1);\n\tKUNIT_EXPECT_EQ(test, freq_qos_read_value(&qos, FREQ_QOS_MIN), 1000);\n\n\t \n\tret = freq_qos_remove_request(&req);\n\tKUNIT_EXPECT_EQ(test, ret, 1);\n\tKUNIT_EXPECT_EQ(test, freq_qos_read_value(&qos, FREQ_QOS_MIN),\n\t\t\tFREQ_QOS_MIN_DEFAULT_VALUE);\n\n\t \n\tret = freq_qos_add_request(&qos, &req, FREQ_QOS_MIN, 2000);\n\tKUNIT_EXPECT_EQ(test, ret, 1);\n\tKUNIT_EXPECT_EQ(test, freq_qos_read_value(&qos, FREQ_QOS_MIN), 2000);\n}\n\nstatic struct kunit_case pm_qos_test_cases[] = {\n\tKUNIT_CASE(freq_qos_test_min),\n\tKUNIT_CASE(freq_qos_test_maxdef),\n\tKUNIT_CASE(freq_qos_test_readd),\n\t{},\n};\n\nstatic struct kunit_suite pm_qos_test_module = {\n\t.name = \"qos-kunit-test\",\n\t.test_cases = pm_qos_test_cases,\n};\nkunit_test_suites(&pm_qos_test_module);\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}