{
  "module_name": "regmap-slimbus.c",
  "hash_id": "fdb8a704f11977470117a98a66f126cc0368fbea0ce4f04f3181ed0676243a42",
  "original_prompt": "Ingested from linux-6.6.14/drivers/base/regmap/regmap-slimbus.c",
  "human_readable_source": "\n\n\n#include <linux/regmap.h>\n#include <linux/slimbus.h>\n#include <linux/module.h>\n\n#include \"internal.h\"\n\nstatic int regmap_slimbus_write(void *context, const void *data, size_t count)\n{\n\tstruct slim_device *sdev = context;\n\n\treturn slim_write(sdev, *(u16 *)data, count - 2, (u8 *)data + 2);\n}\n\nstatic int regmap_slimbus_read(void *context, const void *reg, size_t reg_size,\n\t\t\t       void *val, size_t val_size)\n{\n\tstruct slim_device *sdev = context;\n\n\treturn slim_read(sdev, *(u16 *)reg, val_size, val);\n}\n\nstatic const struct regmap_bus regmap_slimbus_bus = {\n\t.write = regmap_slimbus_write,\n\t.read = regmap_slimbus_read,\n\t.reg_format_endian_default = REGMAP_ENDIAN_LITTLE,\n\t.val_format_endian_default = REGMAP_ENDIAN_LITTLE,\n};\n\nstatic const struct regmap_bus *regmap_get_slimbus(struct slim_device *slim,\n\t\t\t\t\tconst struct regmap_config *config)\n{\n\tif (config->val_bits == 8 && config->reg_bits == 16)\n\t\treturn &regmap_slimbus_bus;\n\n\treturn ERR_PTR(-ENOTSUPP);\n}\n\nstruct regmap *__regmap_init_slimbus(struct slim_device *slimbus,\n\t\t\t\t     const struct regmap_config *config,\n\t\t\t\t     struct lock_class_key *lock_key,\n\t\t\t\t     const char *lock_name)\n{\n\tconst struct regmap_bus *bus = regmap_get_slimbus(slimbus, config);\n\n\tif (IS_ERR(bus))\n\t\treturn ERR_CAST(bus);\n\n\treturn __regmap_init(&slimbus->dev, bus, &slimbus->dev, config,\n\t\t\t     lock_key, lock_name);\n}\nEXPORT_SYMBOL_GPL(__regmap_init_slimbus);\n\nstruct regmap *__devm_regmap_init_slimbus(struct slim_device *slimbus,\n\t\t\t\t\t  const struct regmap_config *config,\n\t\t\t\t\t  struct lock_class_key *lock_key,\n\t\t\t\t\t  const char *lock_name)\n{\n\tconst struct regmap_bus *bus = regmap_get_slimbus(slimbus, config);\n\n\tif (IS_ERR(bus))\n\t\treturn ERR_CAST(bus);\n\n\treturn __devm_regmap_init(&slimbus->dev, bus, &slimbus, config,\n\t\t\t\t  lock_key, lock_name);\n}\nEXPORT_SYMBOL_GPL(__devm_regmap_init_slimbus);\n\nMODULE_LICENSE(\"GPL v2\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}