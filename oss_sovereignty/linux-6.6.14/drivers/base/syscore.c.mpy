{
  "module_name": "syscore.c",
  "hash_id": "b4caabadfdbcd6f4b2495b7611786b4e55731272ce43803247d930c93eba5412",
  "original_prompt": "Ingested from linux-6.6.14/drivers/base/syscore.c",
  "human_readable_source": "\n \n\n#include <linux/syscore_ops.h>\n#include <linux/mutex.h>\n#include <linux/module.h>\n#include <linux/suspend.h>\n#include <trace/events/power.h>\n\nstatic LIST_HEAD(syscore_ops_list);\nstatic DEFINE_MUTEX(syscore_ops_lock);\n\n \nvoid register_syscore_ops(struct syscore_ops *ops)\n{\n\tmutex_lock(&syscore_ops_lock);\n\tlist_add_tail(&ops->node, &syscore_ops_list);\n\tmutex_unlock(&syscore_ops_lock);\n}\nEXPORT_SYMBOL_GPL(register_syscore_ops);\n\n \nvoid unregister_syscore_ops(struct syscore_ops *ops)\n{\n\tmutex_lock(&syscore_ops_lock);\n\tlist_del(&ops->node);\n\tmutex_unlock(&syscore_ops_lock);\n}\nEXPORT_SYMBOL_GPL(unregister_syscore_ops);\n\n#ifdef CONFIG_PM_SLEEP\n \nint syscore_suspend(void)\n{\n\tstruct syscore_ops *ops;\n\tint ret = 0;\n\n\ttrace_suspend_resume(TPS(\"syscore_suspend\"), 0, true);\n\tpm_pr_dbg(\"Checking wakeup interrupts\\n\");\n\n\t \n\tif (pm_wakeup_pending())\n\t\treturn -EBUSY;\n\n\tWARN_ONCE(!irqs_disabled(),\n\t\t\"Interrupts enabled before system core suspend.\\n\");\n\n\tlist_for_each_entry_reverse(ops, &syscore_ops_list, node)\n\t\tif (ops->suspend) {\n\t\t\tpm_pr_dbg(\"Calling %pS\\n\", ops->suspend);\n\t\t\tret = ops->suspend();\n\t\t\tif (ret)\n\t\t\t\tgoto err_out;\n\t\t\tWARN_ONCE(!irqs_disabled(),\n\t\t\t\t\"Interrupts enabled after %pS\\n\", ops->suspend);\n\t\t}\n\n\ttrace_suspend_resume(TPS(\"syscore_suspend\"), 0, false);\n\treturn 0;\n\n err_out:\n\tpr_err(\"PM: System core suspend callback %pS failed.\\n\", ops->suspend);\n\n\tlist_for_each_entry_continue(ops, &syscore_ops_list, node)\n\t\tif (ops->resume)\n\t\t\tops->resume();\n\n\treturn ret;\n}\nEXPORT_SYMBOL_GPL(syscore_suspend);\n\n \nvoid syscore_resume(void)\n{\n\tstruct syscore_ops *ops;\n\n\ttrace_suspend_resume(TPS(\"syscore_resume\"), 0, true);\n\tWARN_ONCE(!irqs_disabled(),\n\t\t\"Interrupts enabled before system core resume.\\n\");\n\n\tlist_for_each_entry(ops, &syscore_ops_list, node)\n\t\tif (ops->resume) {\n\t\t\tpm_pr_dbg(\"Calling %pS\\n\", ops->resume);\n\t\t\tops->resume();\n\t\t\tWARN_ONCE(!irqs_disabled(),\n\t\t\t\t\"Interrupts enabled after %pS\\n\", ops->resume);\n\t\t}\n\ttrace_suspend_resume(TPS(\"syscore_resume\"), 0, false);\n}\nEXPORT_SYMBOL_GPL(syscore_resume);\n#endif  \n\n \nvoid syscore_shutdown(void)\n{\n\tstruct syscore_ops *ops;\n\n\tmutex_lock(&syscore_ops_lock);\n\n\tlist_for_each_entry_reverse(ops, &syscore_ops_list, node)\n\t\tif (ops->shutdown) {\n\t\t\tif (initcall_debug)\n\t\t\t\tpr_info(\"PM: Calling %pS\\n\", ops->shutdown);\n\t\t\tops->shutdown();\n\t\t}\n\n\tmutex_unlock(&syscore_ops_lock);\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}