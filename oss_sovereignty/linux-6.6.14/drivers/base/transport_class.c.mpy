{
  "module_name": "transport_class.c",
  "hash_id": "b7979aef71133c435c35dced0d4cea51bc10171ac3cebfeb74d51982d54d9622",
  "original_prompt": "Ingested from linux-6.6.14/drivers/base/transport_class.c",
  "human_readable_source": "\n \n#include <linux/export.h>\n#include <linux/attribute_container.h>\n#include <linux/transport_class.h>\n\nstatic int transport_remove_classdev(struct attribute_container *cont,\n\t\t\t\t     struct device *dev,\n\t\t\t\t     struct device *classdev);\n\n \nint transport_class_register(struct transport_class *tclass)\n{\n\treturn class_register(&tclass->class);\n}\nEXPORT_SYMBOL_GPL(transport_class_register);\n\n \nvoid transport_class_unregister(struct transport_class *tclass)\n{\n\tclass_unregister(&tclass->class);\n}\nEXPORT_SYMBOL_GPL(transport_class_unregister);\n\nstatic int anon_transport_dummy_function(struct transport_container *tc,\n\t\t\t\t\t struct device *dev,\n\t\t\t\t\t struct device *cdev)\n{\n\t \n\treturn 0;\n}\n\n \nint anon_transport_class_register(struct anon_transport_class *atc)\n{\n\tint error;\n\tatc->container.class = &atc->tclass.class;\n\tattribute_container_set_no_classdevs(&atc->container);\n\terror = attribute_container_register(&atc->container);\n\tif (error)\n\t\treturn error;\n\tatc->tclass.setup = anon_transport_dummy_function;\n\tatc->tclass.remove = anon_transport_dummy_function;\n\treturn 0;\n}\nEXPORT_SYMBOL_GPL(anon_transport_class_register);\n\n \nvoid anon_transport_class_unregister(struct anon_transport_class *atc)\n{\n\tif (unlikely(attribute_container_unregister(&atc->container)))\n\t\tBUG();\n}\nEXPORT_SYMBOL_GPL(anon_transport_class_unregister);\n\nstatic int transport_setup_classdev(struct attribute_container *cont,\n\t\t\t\t    struct device *dev,\n\t\t\t\t    struct device *classdev)\n{\n\tstruct transport_class *tclass = class_to_transport_class(cont->class);\n\tstruct transport_container *tcont = attribute_container_to_transport_container(cont);\n\n\tif (tclass->setup)\n\t\ttclass->setup(tcont, dev, classdev);\n\n\treturn 0;\n}\n\n \n\nvoid transport_setup_device(struct device *dev)\n{\n\tattribute_container_add_device(dev, transport_setup_classdev);\n}\nEXPORT_SYMBOL_GPL(transport_setup_device);\n\nstatic int transport_add_class_device(struct attribute_container *cont,\n\t\t\t\t      struct device *dev,\n\t\t\t\t      struct device *classdev)\n{\n\tstruct transport_class *tclass = class_to_transport_class(cont->class);\n\tint error = attribute_container_add_class_device(classdev);\n\tstruct transport_container *tcont = \n\t\tattribute_container_to_transport_container(cont);\n\n\tif (error)\n\t\tgoto err_remove;\n\n\tif (tcont->statistics) {\n\t\terror = sysfs_create_group(&classdev->kobj, tcont->statistics);\n\t\tif (error)\n\t\t\tgoto err_del;\n\t}\n\n\treturn 0;\n\nerr_del:\n\tattribute_container_class_device_del(classdev);\nerr_remove:\n\tif (tclass->remove)\n\t\ttclass->remove(tcont, dev, classdev);\n\n\treturn error;\n}\n\n\n \nint transport_add_device(struct device *dev)\n{\n\treturn attribute_container_device_trigger_safe(dev,\n\t\t\t\t\ttransport_add_class_device,\n\t\t\t\t\ttransport_remove_classdev);\n}\nEXPORT_SYMBOL_GPL(transport_add_device);\n\nstatic int transport_configure(struct attribute_container *cont,\n\t\t\t       struct device *dev,\n\t\t\t       struct device *cdev)\n{\n\tstruct transport_class *tclass = class_to_transport_class(cont->class);\n\tstruct transport_container *tcont = attribute_container_to_transport_container(cont);\n\n\tif (tclass->configure)\n\t\ttclass->configure(tcont, dev, cdev);\n\n\treturn 0;\n}\n\n \nvoid transport_configure_device(struct device *dev)\n{\n\tattribute_container_device_trigger(dev, transport_configure);\n}\nEXPORT_SYMBOL_GPL(transport_configure_device);\n\nstatic int transport_remove_classdev(struct attribute_container *cont,\n\t\t\t\t     struct device *dev,\n\t\t\t\t     struct device *classdev)\n{\n\tstruct transport_container *tcont = \n\t\tattribute_container_to_transport_container(cont);\n\tstruct transport_class *tclass = class_to_transport_class(cont->class);\n\n\tif (tclass->remove)\n\t\ttclass->remove(tcont, dev, classdev);\n\n\tif (tclass->remove != anon_transport_dummy_function) {\n\t\tif (tcont->statistics)\n\t\t\tsysfs_remove_group(&classdev->kobj, tcont->statistics);\n\t\tattribute_container_class_device_del(classdev);\n\t}\n\n\treturn 0;\n}\n\n\n \nvoid transport_remove_device(struct device *dev)\n{\n\tattribute_container_device_trigger(dev, transport_remove_classdev);\n}\nEXPORT_SYMBOL_GPL(transport_remove_device);\n\nstatic void transport_destroy_classdev(struct attribute_container *cont,\n\t\t\t\t      struct device *dev,\n\t\t\t\t      struct device *classdev)\n{\n\tstruct transport_class *tclass = class_to_transport_class(cont->class);\n\n\tif (tclass->remove != anon_transport_dummy_function)\n\t\tput_device(classdev);\n}\n\n\n \nvoid transport_destroy_device(struct device *dev)\n{\n\tattribute_container_remove_device(dev, transport_destroy_classdev);\n}\nEXPORT_SYMBOL_GPL(transport_destroy_device);\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}