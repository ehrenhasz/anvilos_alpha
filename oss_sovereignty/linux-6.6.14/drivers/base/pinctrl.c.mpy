{
  "module_name": "pinctrl.c",
  "hash_id": "a1dc0209aa409ad6165313b3163fbdd939d8729c2041a9ac71ce8c940cddbbaf",
  "original_prompt": "Ingested from linux-6.6.14/drivers/base/pinctrl.c",
  "human_readable_source": "\n \n\n#include <linux/device.h>\n#include <linux/pinctrl/devinfo.h>\n#include <linux/pinctrl/consumer.h>\n#include <linux/slab.h>\n\n \nint pinctrl_bind_pins(struct device *dev)\n{\n\tint ret;\n\n\tif (dev->of_node_reused)\n\t\treturn 0;\n\n\tdev->pins = devm_kzalloc(dev, sizeof(*(dev->pins)), GFP_KERNEL);\n\tif (!dev->pins)\n\t\treturn -ENOMEM;\n\n\tdev->pins->p = devm_pinctrl_get(dev);\n\tif (IS_ERR(dev->pins->p)) {\n\t\tdev_dbg(dev, \"no pinctrl handle\\n\");\n\t\tret = PTR_ERR(dev->pins->p);\n\t\tgoto cleanup_alloc;\n\t}\n\n\tdev->pins->default_state = pinctrl_lookup_state(dev->pins->p,\n\t\t\t\t\tPINCTRL_STATE_DEFAULT);\n\tif (IS_ERR(dev->pins->default_state)) {\n\t\tdev_dbg(dev, \"no default pinctrl state\\n\");\n\t\tret = 0;\n\t\tgoto cleanup_get;\n\t}\n\n\tdev->pins->init_state = pinctrl_lookup_state(dev->pins->p,\n\t\t\t\t\tPINCTRL_STATE_INIT);\n\tif (IS_ERR(dev->pins->init_state)) {\n\t\t \n\t\tdev_dbg(dev, \"no init pinctrl state\\n\");\n\n\t\tret = pinctrl_select_state(dev->pins->p,\n\t\t\t\t\t   dev->pins->default_state);\n\t} else {\n\t\tret = pinctrl_select_state(dev->pins->p, dev->pins->init_state);\n\t}\n\n\tif (ret) {\n\t\tdev_dbg(dev, \"failed to activate initial pinctrl state\\n\");\n\t\tgoto cleanup_get;\n\t}\n\n#ifdef CONFIG_PM\n\t \n\tdev->pins->sleep_state = pinctrl_lookup_state(dev->pins->p,\n\t\t\t\t\tPINCTRL_STATE_SLEEP);\n\tif (IS_ERR(dev->pins->sleep_state))\n\t\t \n\t\tdev_dbg(dev, \"no sleep pinctrl state\\n\");\n\n\tdev->pins->idle_state = pinctrl_lookup_state(dev->pins->p,\n\t\t\t\t\tPINCTRL_STATE_IDLE);\n\tif (IS_ERR(dev->pins->idle_state))\n\t\t \n\t\tdev_dbg(dev, \"no idle pinctrl state\\n\");\n#endif\n\n\treturn 0;\n\n\t \ncleanup_get:\n\tdevm_pinctrl_put(dev->pins->p);\ncleanup_alloc:\n\tdevm_kfree(dev, dev->pins);\n\tdev->pins = NULL;\n\n\t \n\tif (ret == -EPROBE_DEFER)\n\t\treturn ret;\n\t \n\tif (ret == -EINVAL)\n\t\treturn ret;\n\t \n\n\treturn 0;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}