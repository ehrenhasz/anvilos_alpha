{
  "module_name": "e820.c",
  "hash_id": "1e57458954e6a034ed33e0b0a051c3aedccba853cc524a17eef2005e4020ce34",
  "original_prompt": "Ingested from linux-6.6.14/drivers/nvdimm/e820.c",
  "human_readable_source": "\n \n#include <linux/platform_device.h>\n#include <linux/memory_hotplug.h>\n#include <linux/libnvdimm.h>\n#include <linux/module.h>\n#include <linux/numa.h>\n\nstatic int e820_pmem_remove(struct platform_device *pdev)\n{\n\tstruct nvdimm_bus *nvdimm_bus = platform_get_drvdata(pdev);\n\n\tnvdimm_bus_unregister(nvdimm_bus);\n\treturn 0;\n}\n\nstatic int e820_register_one(struct resource *res, void *data)\n{\n\tstruct nd_region_desc ndr_desc;\n\tstruct nvdimm_bus *nvdimm_bus = data;\n\tint nid = phys_to_target_node(res->start);\n\n\tmemset(&ndr_desc, 0, sizeof(ndr_desc));\n\tndr_desc.res = res;\n\tndr_desc.numa_node = numa_map_to_online_node(nid);\n\tndr_desc.target_node = nid;\n\tset_bit(ND_REGION_PAGEMAP, &ndr_desc.flags);\n\tif (!nvdimm_pmem_region_create(nvdimm_bus, &ndr_desc))\n\t\treturn -ENXIO;\n\treturn 0;\n}\n\nstatic int e820_pmem_probe(struct platform_device *pdev)\n{\n\tstatic struct nvdimm_bus_descriptor nd_desc;\n\tstruct device *dev = &pdev->dev;\n\tstruct nvdimm_bus *nvdimm_bus;\n\tint rc = -ENXIO;\n\n\tnd_desc.provider_name = \"e820\";\n\tnd_desc.module = THIS_MODULE;\n\tnvdimm_bus = nvdimm_bus_register(dev, &nd_desc);\n\tif (!nvdimm_bus)\n\t\tgoto err;\n\tplatform_set_drvdata(pdev, nvdimm_bus);\n\n\trc = walk_iomem_res_desc(IORES_DESC_PERSISTENT_MEMORY_LEGACY,\n\t\t\tIORESOURCE_MEM, 0, -1, nvdimm_bus, e820_register_one);\n\tif (rc)\n\t\tgoto err;\n\treturn 0;\nerr:\n\tnvdimm_bus_unregister(nvdimm_bus);\n\tdev_err(dev, \"failed to register legacy persistent memory ranges\\n\");\n\treturn rc;\n}\n\nstatic struct platform_driver e820_pmem_driver = {\n\t.probe = e820_pmem_probe,\n\t.remove = e820_pmem_remove,\n\t.driver = {\n\t\t.name = \"e820_pmem\",\n\t},\n};\n\nmodule_platform_driver(e820_pmem_driver);\n\nMODULE_ALIAS(\"platform:e820_pmem*\");\nMODULE_LICENSE(\"GPL v2\");\nMODULE_AUTHOR(\"Intel Corporation\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}