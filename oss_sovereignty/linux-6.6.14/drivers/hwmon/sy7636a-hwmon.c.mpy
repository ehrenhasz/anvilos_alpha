{
  "module_name": "sy7636a-hwmon.c",
  "hash_id": "eadd7466b03ac625e01f827124aa0e5737848240dc914b5c5e94fd0bcc4afe43",
  "original_prompt": "Ingested from linux-6.6.14/drivers/hwmon/sy7636a-hwmon.c",
  "human_readable_source": "\n \n\n#include <linux/err.h>\n#include <linux/hwmon.h>\n#include <linux/init.h>\n#include <linux/module.h>\n#include <linux/platform_device.h>\n#include <linux/regmap.h>\n#include <linux/regulator/machine.h>\n\n#include <linux/mfd/sy7636a.h>\n\nstatic int sy7636a_read(struct device *dev, enum hwmon_sensor_types type,\n\t\t\tu32 attr, int channel, long *temp)\n{\n\tstruct regmap *regmap = dev_get_drvdata(dev);\n\tint ret, reg_val;\n\n\tret = regmap_read(regmap,\n\t\t\t  SY7636A_REG_TERMISTOR_READOUT, &reg_val);\n\tif (ret)\n\t\treturn ret;\n\n\t*temp = reg_val * 1000;\n\n\treturn 0;\n}\n\nstatic umode_t sy7636a_is_visible(const void *data,\n\t\t\t\t  enum hwmon_sensor_types type,\n\t\t\t\t  u32 attr, int channel)\n{\n\tif (type != hwmon_temp)\n\t\treturn 0;\n\n\tif (attr != hwmon_temp_input)\n\t\treturn 0;\n\n\treturn 0444;\n}\n\nstatic const struct hwmon_ops sy7636a_hwmon_ops = {\n\t.is_visible = sy7636a_is_visible,\n\t.read = sy7636a_read,\n};\n\nstatic const struct hwmon_channel_info * const sy7636a_info[] = {\n\tHWMON_CHANNEL_INFO(chip, HWMON_C_REGISTER_TZ),\n\tHWMON_CHANNEL_INFO(temp, HWMON_T_INPUT),\n\tNULL\n};\n\nstatic const struct hwmon_chip_info sy7636a_chip_info = {\n\t.ops = &sy7636a_hwmon_ops,\n\t.info = sy7636a_info,\n};\n\nstatic int sy7636a_sensor_probe(struct platform_device *pdev)\n{\n\tstruct regmap *regmap = dev_get_regmap(pdev->dev.parent, NULL);\n\tstruct regulator *regulator;\n\tstruct device *hwmon_dev;\n\tint err;\n\n\tif (!regmap)\n\t\treturn -EPROBE_DEFER;\n\n\tregulator = devm_regulator_get(&pdev->dev, \"vcom\");\n\tif (IS_ERR(regulator))\n\t\treturn PTR_ERR(regulator);\n\n\terr = regulator_enable(regulator);\n\tif (err)\n\t\treturn err;\n\n\thwmon_dev = devm_hwmon_device_register_with_info(&pdev->dev,\n\t\t\t\t\t\t\t \"sy7636a_temperature\", regmap,\n\t\t\t\t\t\t\t &sy7636a_chip_info, NULL);\n\n\tif (IS_ERR(hwmon_dev)) {\n\t\terr = PTR_ERR(hwmon_dev);\n\t\tdev_err(&pdev->dev, \"Unable to register hwmon device, returned %d\\n\", err);\n\t\treturn err;\n\t}\n\n\treturn 0;\n}\n\nstatic struct platform_driver sy7636a_sensor_driver = {\n\t.probe = sy7636a_sensor_probe,\n\t.driver = {\n\t\t.name = \"sy7636a-temperature\",\n\t},\n};\nmodule_platform_driver(sy7636a_sensor_driver);\n\nMODULE_DESCRIPTION(\"SY7636A sensor driver\");\nMODULE_LICENSE(\"GPL\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}