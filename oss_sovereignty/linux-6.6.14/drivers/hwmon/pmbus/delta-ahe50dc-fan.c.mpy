{
  "module_name": "delta-ahe50dc-fan.c",
  "hash_id": "fa4c900bc9767f1f1787c87e7d4bafe618236098fe82585b29090f8b879e773b",
  "original_prompt": "Ingested from linux-6.6.14/drivers/hwmon/pmbus/delta-ahe50dc-fan.c",
  "human_readable_source": "\n \n\n#include <linux/i2c.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n#include <linux/pmbus.h>\n\n#include \"pmbus.h\"\n\n#define AHE50DC_PMBUS_READ_TEMP4 0xd0\n\nstatic int ahe50dc_fan_write_byte(struct i2c_client *client, int page, u8 value)\n{\n\t \n\treturn value == PMBUS_CLEAR_FAULTS ? -EOPNOTSUPP : -ENODATA;\n}\n\nstatic int ahe50dc_fan_read_word_data(struct i2c_client *client, int page, int phase, int reg)\n{\n\t \n\tif (page == 1) {\n\t\tif (reg == PMBUS_READ_TEMPERATURE_1)\n\t\t\treturn i2c_smbus_read_word_data(client, AHE50DC_PMBUS_READ_TEMP4);\n\t\treturn -EOPNOTSUPP;\n\t}\n\n\t \n\tswitch (reg) {\n\tcase PMBUS_STATUS_WORD:\n\tcase PMBUS_FAN_COMMAND_1:\n\tcase PMBUS_FAN_COMMAND_2:\n\tcase PMBUS_FAN_COMMAND_3:\n\tcase PMBUS_FAN_COMMAND_4:\n\tcase PMBUS_STATUS_FAN_12:\n\tcase PMBUS_STATUS_FAN_34:\n\tcase PMBUS_READ_VIN:\n\tcase PMBUS_READ_TEMPERATURE_1:\n\tcase PMBUS_READ_TEMPERATURE_2:\n\tcase PMBUS_READ_TEMPERATURE_3:\n\tcase PMBUS_READ_FAN_SPEED_1:\n\tcase PMBUS_READ_FAN_SPEED_2:\n\tcase PMBUS_READ_FAN_SPEED_3:\n\tcase PMBUS_READ_FAN_SPEED_4:\n\t\treturn -ENODATA;\n\tdefault:\n\t\treturn -EOPNOTSUPP;\n\t}\n}\n\nstatic struct pmbus_driver_info ahe50dc_fan_info = {\n\t.pages = 2,\n\t.format[PSC_FAN] = direct,\n\t.format[PSC_TEMPERATURE] = direct,\n\t.format[PSC_VOLTAGE_IN] = direct,\n\t.m[PSC_FAN] = 1,\n\t.b[PSC_FAN] = 0,\n\t.R[PSC_FAN] = 0,\n\t.m[PSC_TEMPERATURE] = 1,\n\t.b[PSC_TEMPERATURE] = 0,\n\t.R[PSC_TEMPERATURE] = 1,\n\t.m[PSC_VOLTAGE_IN] = 1,\n\t.b[PSC_VOLTAGE_IN] = 0,\n\t.R[PSC_VOLTAGE_IN] = 3,\n\t.func[0] = PMBUS_HAVE_TEMP | PMBUS_HAVE_TEMP2 | PMBUS_HAVE_TEMP3 |\n\t\tPMBUS_HAVE_VIN | PMBUS_HAVE_FAN12 | PMBUS_HAVE_FAN34 |\n\t\tPMBUS_HAVE_STATUS_FAN12 | PMBUS_HAVE_STATUS_FAN34 | PMBUS_PAGE_VIRTUAL,\n\t.func[1] = PMBUS_HAVE_TEMP | PMBUS_PAGE_VIRTUAL,\n\t.write_byte = ahe50dc_fan_write_byte,\n\t.read_word_data = ahe50dc_fan_read_word_data,\n};\n\n \nstatic struct pmbus_platform_data ahe50dc_fan_data = {\n\t.flags = PMBUS_NO_CAPABILITY,\n};\n\nstatic int ahe50dc_fan_probe(struct i2c_client *client)\n{\n\tclient->dev.platform_data = &ahe50dc_fan_data;\n\treturn pmbus_do_probe(client, &ahe50dc_fan_info);\n}\n\nstatic const struct i2c_device_id ahe50dc_fan_id[] = {\n\t{ \"ahe50dc_fan\" },\n\t{ }\n};\nMODULE_DEVICE_TABLE(i2c, ahe50dc_fan_id);\n\nstatic const struct of_device_id __maybe_unused ahe50dc_fan_of_match[] = {\n\t{ .compatible = \"delta,ahe50dc-fan\" },\n\t{ }\n};\nMODULE_DEVICE_TABLE(of, ahe50dc_fan_of_match);\n\nstatic struct i2c_driver ahe50dc_fan_driver = {\n\t.driver = {\n\t\t   .name = \"ahe50dc_fan\",\n\t\t   .of_match_table = of_match_ptr(ahe50dc_fan_of_match),\n\t},\n\t.probe = ahe50dc_fan_probe,\n\t.id_table = ahe50dc_fan_id,\n};\nmodule_i2c_driver(ahe50dc_fan_driver);\n\nMODULE_AUTHOR(\"Zev Weiss <zev@bewilderbeest.net>\");\nMODULE_DESCRIPTION(\"Driver for Delta AHE-50DC power shelf fan control module\");\nMODULE_LICENSE(\"GPL\");\nMODULE_IMPORT_NS(PMBUS);\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}