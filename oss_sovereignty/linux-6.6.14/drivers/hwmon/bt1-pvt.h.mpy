{
  "module_name": "bt1-pvt.h",
  "hash_id": "a8164644e7d6e066f18548370caad33b9e8ffd1381d4974cf5dc1e56c4ef4c2b",
  "original_prompt": "Ingested from linux-6.6.14/drivers/hwmon/bt1-pvt.h",
  "human_readable_source": " \n \n#ifndef __HWMON_BT1_PVT_H__\n#define __HWMON_BT1_PVT_H__\n\n#include <linux/completion.h>\n#include <linux/hwmon.h>\n#include <linux/kernel.h>\n#include <linux/ktime.h>\n#include <linux/mutex.h>\n#include <linux/seqlock.h>\n\n \n#define PVT_CTRL\t\t\t0x00\n#define PVT_CTRL_EN\t\t\tBIT(0)\n#define PVT_CTRL_MODE_FLD\t\t1\n#define PVT_CTRL_MODE_MASK\t\tGENMASK(3, PVT_CTRL_MODE_FLD)\n#define PVT_CTRL_MODE_TEMP\t\t0x0\n#define PVT_CTRL_MODE_VOLT\t\t0x1\n#define PVT_CTRL_MODE_LVT\t\t0x2\n#define PVT_CTRL_MODE_HVT\t\t0x4\n#define PVT_CTRL_MODE_SVT\t\t0x6\n#define PVT_CTRL_TRIM_FLD\t\t4\n#define PVT_CTRL_TRIM_MASK\t\tGENMASK(8, PVT_CTRL_TRIM_FLD)\n#define PVT_DATA\t\t\t0x04\n#define PVT_DATA_VALID\t\t\tBIT(10)\n#define PVT_DATA_DATA_FLD\t\t0\n#define PVT_DATA_DATA_MASK\t\tGENMASK(9, PVT_DATA_DATA_FLD)\n#define PVT_TTHRES\t\t\t0x08\n#define PVT_VTHRES\t\t\t0x0C\n#define PVT_LTHRES\t\t\t0x10\n#define PVT_HTHRES\t\t\t0x14\n#define PVT_STHRES\t\t\t0x18\n#define PVT_THRES_LO_FLD\t\t0\n#define PVT_THRES_LO_MASK\t\tGENMASK(9, PVT_THRES_LO_FLD)\n#define PVT_THRES_HI_FLD\t\t10\n#define PVT_THRES_HI_MASK\t\tGENMASK(19, PVT_THRES_HI_FLD)\n#define PVT_TTIMEOUT\t\t\t0x1C\n#define PVT_INTR_STAT\t\t\t0x20\n#define PVT_INTR_MASK\t\t\t0x24\n#define PVT_RAW_INTR_STAT\t\t0x28\n#define PVT_INTR_DVALID\t\t\tBIT(0)\n#define PVT_INTR_TTHRES_LO\t\tBIT(1)\n#define PVT_INTR_TTHRES_HI\t\tBIT(2)\n#define PVT_INTR_VTHRES_LO\t\tBIT(3)\n#define PVT_INTR_VTHRES_HI\t\tBIT(4)\n#define PVT_INTR_LTHRES_LO\t\tBIT(5)\n#define PVT_INTR_LTHRES_HI\t\tBIT(6)\n#define PVT_INTR_HTHRES_LO\t\tBIT(7)\n#define PVT_INTR_HTHRES_HI\t\tBIT(8)\n#define PVT_INTR_STHRES_LO\t\tBIT(9)\n#define PVT_INTR_STHRES_HI\t\tBIT(10)\n#define PVT_INTR_ALL\t\t\tGENMASK(10, 0)\n#define PVT_CLR_INTR\t\t\t0x2C\n\n \n#define PVT_TEMP_MIN\t\t-48380L\n#define PVT_TEMP_MAX\t\t147438L\n#define PVT_TEMP_CHS\t\t1\n#define PVT_VOLT_MIN\t\t620L\n#define PVT_VOLT_MAX\t\t1168L\n#define PVT_VOLT_CHS\t\t4\n#define PVT_DATA_MIN\t\t0\n#define PVT_DATA_MAX\t\t(PVT_DATA_DATA_MASK >> PVT_DATA_DATA_FLD)\n#define PVT_TRIM_MIN\t\t0\n#define PVT_TRIM_MAX\t\t(PVT_CTRL_TRIM_MASK >> PVT_CTRL_TRIM_FLD)\n#define PVT_TRIM_TEMP\t\t7130\n#define PVT_TRIM_STEP\t\t(PVT_TRIM_TEMP / PVT_TRIM_MAX)\n#define PVT_TRIM_DEF\t\t0\n#define PVT_TOUT_MIN\t\t(NSEC_PER_SEC / 3000)\n#if defined(CONFIG_SENSORS_BT1_PVT_ALARMS)\n# define PVT_TOUT_DEF\t\t60000\n#else\n# define PVT_TOUT_DEF\t\t0\n#endif\n\n \nenum pvt_sensor_type {\n\tPVT_SENSOR_FIRST,\n\tPVT_TEMP = PVT_SENSOR_FIRST,\n\tPVT_VOLT,\n\tPVT_LVT,\n\tPVT_HVT,\n\tPVT_SVT,\n\tPVT_SENSOR_LAST = PVT_SVT,\n\tPVT_SENSORS_NUM\n};\n\n \nenum pvt_clock_type {\n\tPVT_CLOCK_APB,\n\tPVT_CLOCK_REF,\n\tPVT_CLOCK_NUM\n};\n\n \nstruct pvt_sensor_info {\n\tint channel;\n\tconst char *label;\n\tu32 mode;\n\tunsigned long thres_base;\n\tu32 thres_sts_lo;\n\tu32 thres_sts_hi;\n\tenum hwmon_sensor_types type;\n\tu32 attr_min_alarm;\n\tu32 attr_max_alarm;\n};\n\n#define PVT_SENSOR_INFO(_ch, _label, _type, _mode, _thres)\t\\\n\t{\t\t\t\t\t\t\t\\\n\t\t.channel = _ch,\t\t\t\t\t\\\n\t\t.label = _label,\t\t\t\t\\\n\t\t.mode = PVT_CTRL_MODE_ ##_mode,\t\t\t\\\n\t\t.thres_base = PVT_ ##_thres,\t\t\t\\\n\t\t.thres_sts_lo = PVT_INTR_ ##_thres## _LO,\t\\\n\t\t.thres_sts_hi = PVT_INTR_ ##_thres## _HI,\t\\\n\t\t.type = _type,\t\t\t\t\t\\\n\t\t.attr_min_alarm = _type## _min,\t\t\t\\\n\t\t.attr_max_alarm = _type## _max,\t\t\t\\\n\t}\n\n \nstruct pvt_cache {\n\tu32 data;\n#if defined(CONFIG_SENSORS_BT1_PVT_ALARMS)\n\tseqlock_t data_seqlock;\n\tu32 thres_sts_lo;\n\tu32 thres_sts_hi;\n#else\n\tstruct completion conversion;\n#endif\n};\n\n \nstruct pvt_hwmon {\n\tstruct device *dev;\n\tstruct device *hwmon;\n\n\tvoid __iomem *regs;\n\tint irq;\n\n\tstruct clk_bulk_data clks[PVT_CLOCK_NUM];\n\n\tstruct mutex iface_mtx;\n\tenum pvt_sensor_type sensor;\n\tstruct pvt_cache cache[PVT_SENSORS_NUM];\n\tktime_t timeout;\n};\n\n \nstruct pvt_poly_term {\n\tunsigned int deg;\n\tlong coef;\n\tlong divider;\n\tlong divider_leftover;\n};\n\n \nstruct pvt_poly {\n\tlong total_divider;\n\tstruct pvt_poly_term terms[];\n};\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}