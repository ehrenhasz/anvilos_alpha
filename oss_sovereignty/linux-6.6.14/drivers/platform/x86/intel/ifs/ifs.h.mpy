{
  "module_name": "ifs.h",
  "hash_id": "beef8157e8d40da4a094e055149aa45961d71729c1bfdf8ae1b3a6f3a12d7e34",
  "original_prompt": "Ingested from linux-6.6.14/drivers/platform/x86/intel/ifs/ifs.h",
  "human_readable_source": " \n \n\n#ifndef _IFS_H_\n#define _IFS_H_\n\n \n#include <linux/device.h>\n#include <linux/miscdevice.h>\n\n#define MSR_ARRAY_BIST\t\t\t\t0x00000105\n#define MSR_COPY_SCAN_HASHES\t\t\t0x000002c2\n#define MSR_SCAN_HASHES_STATUS\t\t\t0x000002c3\n#define MSR_AUTHENTICATE_AND_COPY_CHUNK\t\t0x000002c4\n#define MSR_CHUNKS_AUTHENTICATION_STATUS\t0x000002c5\n#define MSR_ACTIVATE_SCAN\t\t\t0x000002c6\n#define MSR_SCAN_STATUS\t\t\t\t0x000002c7\n#define SCAN_NOT_TESTED\t\t\t\t0\n#define SCAN_TEST_PASS\t\t\t\t1\n#define SCAN_TEST_FAIL\t\t\t\t2\n\n#define IFS_TYPE_SAF\t\t\t0\n#define IFS_TYPE_ARRAY_BIST\t\t1\n\n \nunion ifs_scan_hashes_status {\n\tu64\tdata;\n\tstruct {\n\t\tu32\tchunk_size\t:16;\n\t\tu32\tnum_chunks\t:8;\n\t\tu32\trsvd1\t\t:8;\n\t\tu32\terror_code\t:8;\n\t\tu32\trsvd2\t\t:11;\n\t\tu32\tmax_core_limit\t:12;\n\t\tu32\tvalid\t\t:1;\n\t};\n};\n\n \nunion ifs_chunks_auth_status {\n\tu64\tdata;\n\tstruct {\n\t\tu32\tvalid_chunks\t:8;\n\t\tu32\ttotal_chunks\t:8;\n\t\tu32\trsvd1\t\t:16;\n\t\tu32\terror_code\t:8;\n\t\tu32\trsvd2\t\t:24;\n\t};\n};\n\n \nunion ifs_scan {\n\tu64\tdata;\n\tstruct {\n\t\tu32\tstart\t:8;\n\t\tu32\tstop\t:8;\n\t\tu32\trsvd\t:16;\n\t\tu32\tdelay\t:31;\n\t\tu32\tsigmce\t:1;\n\t};\n};\n\n \nunion ifs_status {\n\tu64\tdata;\n\tstruct {\n\t\tu32\tchunk_num\t\t:8;\n\t\tu32\tchunk_stop_index\t:8;\n\t\tu32\trsvd1\t\t\t:16;\n\t\tu32\terror_code\t\t:8;\n\t\tu32\trsvd2\t\t\t:22;\n\t\tu32\tcontrol_error\t\t:1;\n\t\tu32\tsignature_error\t\t:1;\n\t};\n};\n\n \nunion ifs_array {\n\tu64\tdata;\n\tstruct {\n\t\tu32\tarray_bitmask;\n\t\tu16\tarray_bank;\n\t\tu16\trsvd\t\t\t:15;\n\t\tu16\tctrl_result\t\t:1;\n\t};\n};\n\n \n#define IFS_SW_TIMEOUT\t\t\t\t0xFD\n#define IFS_SW_PARTIAL_COMPLETION\t\t0xFE\n\nstruct ifs_test_caps {\n\tint\tintegrity_cap_bit;\n\tint\ttest_num;\n};\n\n \nstruct ifs_data {\n\tint\tloaded_version;\n\tbool\tloaded;\n\tbool\tloading_error;\n\tint\tvalid_chunks;\n\tint\tstatus;\n\tu64\tscan_details;\n\tu32\tcur_batch;\n};\n\nstruct ifs_work {\n\tstruct work_struct w;\n\tstruct device *dev;\n};\n\nstruct ifs_device {\n\tconst struct ifs_test_caps *test_caps;\n\tstruct ifs_data rw_data;\n\tstruct miscdevice misc;\n};\n\nstatic inline struct ifs_data *ifs_get_data(struct device *dev)\n{\n\tstruct miscdevice *m = dev_get_drvdata(dev);\n\tstruct ifs_device *d = container_of(m, struct ifs_device, misc);\n\n\treturn &d->rw_data;\n}\n\nstatic inline const struct ifs_test_caps *ifs_get_test_caps(struct device *dev)\n{\n\tstruct miscdevice *m = dev_get_drvdata(dev);\n\tstruct ifs_device *d = container_of(m, struct ifs_device, misc);\n\n\treturn d->test_caps;\n}\n\nextern bool *ifs_pkg_auth;\nint ifs_load_firmware(struct device *dev);\nint do_core_test(int cpu, struct device *dev);\nextern struct attribute *plat_ifs_attrs[];\nextern struct attribute *plat_ifs_array_attrs[];\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}