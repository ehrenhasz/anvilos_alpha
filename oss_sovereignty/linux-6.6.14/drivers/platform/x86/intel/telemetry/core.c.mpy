{
  "module_name": "core.c",
  "hash_id": "3b66f4a61ce5d088994e9c1d089a6dd301961266e550d5f9e3640607b67abcc0",
  "original_prompt": "Ingested from linux-6.6.14/drivers/platform/x86/intel/telemetry/core.c",
  "human_readable_source": "\n \n#include <linux/device.h>\n#include <linux/module.h>\n\n#include <asm/intel_telemetry.h>\n\n#define DRIVER_NAME \"intel_telemetry_core\"\n\nstruct telemetry_core_config {\n\tstruct telemetry_plt_config *plt_config;\n\tconst struct telemetry_core_ops *telem_ops;\n};\n\nstatic struct telemetry_core_config telm_core_conf;\n\nstatic int telemetry_def_update_events(struct telemetry_evtconfig pss_evtconfig,\n\t\t\t\t      struct telemetry_evtconfig ioss_evtconfig)\n{\n\treturn 0;\n}\n\nstatic int telemetry_def_set_sampling_period(u8 pss_period, u8 ioss_period)\n{\n\treturn 0;\n}\n\nstatic int telemetry_def_get_sampling_period(u8 *pss_min_period,\n\t\t\t\t\t     u8 *pss_max_period,\n\t\t\t\t\t     u8 *ioss_min_period,\n\t\t\t\t\t     u8 *ioss_max_period)\n{\n\treturn 0;\n}\n\nstatic int telemetry_def_get_eventconfig(\n\t\t\tstruct telemetry_evtconfig *pss_evtconfig,\n\t\t\tstruct telemetry_evtconfig *ioss_evtconfig,\n\t\t\tint pss_len, int ioss_len)\n{\n\treturn 0;\n}\n\nstatic int telemetry_def_get_trace_verbosity(enum telemetry_unit telem_unit,\n\t\t\t\t\t     u32 *verbosity)\n{\n\treturn 0;\n}\n\n\nstatic int telemetry_def_set_trace_verbosity(enum telemetry_unit telem_unit,\n\t\t\t\t\t     u32 verbosity)\n{\n\treturn 0;\n}\n\nstatic int telemetry_def_raw_read_eventlog(enum telemetry_unit telem_unit,\n\t\t\t\t\t   struct telemetry_evtlog *evtlog,\n\t\t\t\t\t   int len, int log_all_evts)\n{\n\treturn 0;\n}\n\nstatic int telemetry_def_read_eventlog(enum telemetry_unit telem_unit,\n\t\t\t\t       struct telemetry_evtlog *evtlog,\n\t\t\t\t       int len, int log_all_evts)\n{\n\treturn 0;\n}\n\nstatic int telemetry_def_add_events(u8 num_pss_evts, u8 num_ioss_evts,\n\t\t\t\t    u32 *pss_evtmap, u32 *ioss_evtmap)\n{\n\treturn 0;\n}\n\nstatic int telemetry_def_reset_events(void)\n{\n\treturn 0;\n}\n\nstatic const struct telemetry_core_ops telm_defpltops = {\n\t.set_sampling_period = telemetry_def_set_sampling_period,\n\t.get_sampling_period = telemetry_def_get_sampling_period,\n\t.get_trace_verbosity = telemetry_def_get_trace_verbosity,\n\t.set_trace_verbosity = telemetry_def_set_trace_verbosity,\n\t.raw_read_eventlog = telemetry_def_raw_read_eventlog,\n\t.get_eventconfig = telemetry_def_get_eventconfig,\n\t.read_eventlog = telemetry_def_read_eventlog,\n\t.update_events = telemetry_def_update_events,\n\t.reset_events = telemetry_def_reset_events,\n\t.add_events = telemetry_def_add_events,\n};\n\n \nint telemetry_update_events(struct telemetry_evtconfig pss_evtconfig,\n\t\t\t    struct telemetry_evtconfig ioss_evtconfig)\n{\n\treturn telm_core_conf.telem_ops->update_events(pss_evtconfig,\n\t\t\t\t\t\t       ioss_evtconfig);\n}\nEXPORT_SYMBOL_GPL(telemetry_update_events);\n\n\n \nint telemetry_set_sampling_period(u8 pss_period, u8 ioss_period)\n{\n\treturn telm_core_conf.telem_ops->set_sampling_period(pss_period,\n\t\t\t\t\t\t\t     ioss_period);\n}\nEXPORT_SYMBOL_GPL(telemetry_set_sampling_period);\n\n \nint telemetry_get_sampling_period(u8 *pss_min_period, u8 *pss_max_period,\n\t\t\t\t  u8 *ioss_min_period, u8 *ioss_max_period)\n{\n\treturn telm_core_conf.telem_ops->get_sampling_period(pss_min_period,\n\t\t\t\t\t\t\t     pss_max_period,\n\t\t\t\t\t\t\t     ioss_min_period,\n\t\t\t\t\t\t\t     ioss_max_period);\n}\nEXPORT_SYMBOL_GPL(telemetry_get_sampling_period);\n\n\n \nint telemetry_reset_events(void)\n{\n\treturn telm_core_conf.telem_ops->reset_events();\n}\nEXPORT_SYMBOL_GPL(telemetry_reset_events);\n\n \nint telemetry_get_eventconfig(struct telemetry_evtconfig *pss_evtconfig,\n\t\t\t      struct telemetry_evtconfig *ioss_evtconfig,\n\t\t\t      int pss_len, int ioss_len)\n{\n\treturn telm_core_conf.telem_ops->get_eventconfig(pss_evtconfig,\n\t\t\t\t\t\t\t ioss_evtconfig,\n\t\t\t\t\t\t\t pss_len, ioss_len);\n}\nEXPORT_SYMBOL_GPL(telemetry_get_eventconfig);\n\n \nint telemetry_add_events(u8 num_pss_evts, u8 num_ioss_evts,\n\t\t\t u32 *pss_evtmap, u32 *ioss_evtmap)\n{\n\treturn telm_core_conf.telem_ops->add_events(num_pss_evts,\n\t\t\t\t\t\t    num_ioss_evts, pss_evtmap,\n\t\t\t\t\t\t    ioss_evtmap);\n}\nEXPORT_SYMBOL_GPL(telemetry_add_events);\n\n \nint telemetry_read_events(enum telemetry_unit telem_unit,\n\t\t\t  struct telemetry_evtlog *evtlog, int len)\n{\n\treturn telm_core_conf.telem_ops->read_eventlog(telem_unit, evtlog,\n\t\t\t\t\t\t       len, 0);\n}\nEXPORT_SYMBOL_GPL(telemetry_read_events);\n\n \nint telemetry_raw_read_events(enum telemetry_unit telem_unit,\n\t\t\t      struct telemetry_evtlog *evtlog, int len)\n{\n\treturn telm_core_conf.telem_ops->raw_read_eventlog(telem_unit, evtlog,\n\t\t\t\t\t\t\t   len, 0);\n}\nEXPORT_SYMBOL_GPL(telemetry_raw_read_events);\n\n \nint telemetry_read_eventlog(enum telemetry_unit telem_unit,\n\t\t\t    struct telemetry_evtlog *evtlog, int len)\n{\n\treturn telm_core_conf.telem_ops->read_eventlog(telem_unit, evtlog,\n\t\t\t\t\t\t       len, 1);\n}\nEXPORT_SYMBOL_GPL(telemetry_read_eventlog);\n\n \nint telemetry_raw_read_eventlog(enum telemetry_unit telem_unit,\n\t\t\t\tstruct telemetry_evtlog *evtlog, int len)\n{\n\treturn telm_core_conf.telem_ops->raw_read_eventlog(telem_unit, evtlog,\n\t\t\t\t\t\t\t   len, 1);\n}\nEXPORT_SYMBOL_GPL(telemetry_raw_read_eventlog);\n\n\n \nint telemetry_get_trace_verbosity(enum telemetry_unit telem_unit,\n\t\t\t\t  u32 *verbosity)\n{\n\treturn telm_core_conf.telem_ops->get_trace_verbosity(telem_unit,\n\t\t\t\t\t\t\t     verbosity);\n}\nEXPORT_SYMBOL_GPL(telemetry_get_trace_verbosity);\n\n\n \nint telemetry_set_trace_verbosity(enum telemetry_unit telem_unit, u32 verbosity)\n{\n\treturn telm_core_conf.telem_ops->set_trace_verbosity(telem_unit,\n\t\t\t\t\t\t\t     verbosity);\n}\nEXPORT_SYMBOL_GPL(telemetry_set_trace_verbosity);\n\n \nint telemetry_set_pltdata(const struct telemetry_core_ops *ops,\n\t\t\t  struct telemetry_plt_config *pltconfig)\n{\n\tif (ops)\n\t\ttelm_core_conf.telem_ops = ops;\n\n\tif (pltconfig)\n\t\ttelm_core_conf.plt_config = pltconfig;\n\n\treturn 0;\n}\nEXPORT_SYMBOL_GPL(telemetry_set_pltdata);\n\n \nint telemetry_clear_pltdata(void)\n{\n\ttelm_core_conf.telem_ops = &telm_defpltops;\n\ttelm_core_conf.plt_config = NULL;\n\n\treturn 0;\n}\nEXPORT_SYMBOL_GPL(telemetry_clear_pltdata);\n\n \nstruct telemetry_plt_config *telemetry_get_pltdata(void)\n{\n\treturn telm_core_conf.plt_config;\n}\nEXPORT_SYMBOL_GPL(telemetry_get_pltdata);\n\nstatic inline int telemetry_get_pssevtname(enum telemetry_unit telem_unit,\n\t\t\t\t\t   const char **name, int len)\n{\n\tstruct telemetry_unit_config psscfg;\n\tint i;\n\n\tif (!telm_core_conf.plt_config)\n\t\treturn -EINVAL;\n\n\tpsscfg = telm_core_conf.plt_config->pss_config;\n\n\tif (len > psscfg.ssram_evts_used)\n\t\tlen = psscfg.ssram_evts_used;\n\n\tfor (i = 0; i < len; i++)\n\t\tname[i] = psscfg.telem_evts[i].name;\n\n\treturn 0;\n}\n\nstatic inline int telemetry_get_iossevtname(enum telemetry_unit telem_unit,\n\t\t\t\t\t    const char **name, int len)\n{\n\tstruct telemetry_unit_config iosscfg;\n\tint i;\n\n\tif (!(telm_core_conf.plt_config))\n\t\treturn -EINVAL;\n\n\tiosscfg = telm_core_conf.plt_config->ioss_config;\n\n\tif (len > iosscfg.ssram_evts_used)\n\t\tlen = iosscfg.ssram_evts_used;\n\n\tfor (i = 0; i < len; i++)\n\t\tname[i] = iosscfg.telem_evts[i].name;\n\n\treturn 0;\n\n}\n\n \nint telemetry_get_evtname(enum telemetry_unit telem_unit,\n\t\t\t  const char **name, int len)\n{\n\tint ret = -EINVAL;\n\n\tif (telem_unit == TELEM_PSS)\n\t\tret = telemetry_get_pssevtname(telem_unit, name, len);\n\n\telse if (telem_unit == TELEM_IOSS)\n\t\tret = telemetry_get_iossevtname(telem_unit, name, len);\n\n\treturn ret;\n}\nEXPORT_SYMBOL_GPL(telemetry_get_evtname);\n\nstatic int __init telemetry_module_init(void)\n{\n\tpr_info(pr_fmt(DRIVER_NAME) \" Init\\n\");\n\n\ttelm_core_conf.telem_ops = &telm_defpltops;\n\treturn 0;\n}\n\nstatic void __exit telemetry_module_exit(void)\n{\n}\n\nmodule_init(telemetry_module_init);\nmodule_exit(telemetry_module_exit);\n\nMODULE_AUTHOR(\"Souvik Kumar Chakravarty <souvik.k.chakravarty@intel.com>\");\nMODULE_DESCRIPTION(\"Intel SoC Telemetry Interface\");\nMODULE_LICENSE(\"GPL v2\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}