{
  "module_name": "cnp.c",
  "hash_id": "9d6406ad037684c108d0294383ed6ab649a6d3a4fb2b5515b7856e20aa57dca0",
  "original_prompt": "Ingested from linux-6.6.14/drivers/platform/x86/intel/pmc/cnp.c",
  "human_readable_source": "\n \n\n#include \"core.h\"\n\n \nconst struct pmc_bit_map cnp_pfear_map[] = {\n\t{\"PMC\",                 BIT(0)},\n\t{\"OPI-DMI\",             BIT(1)},\n\t{\"SPI/eSPI\",            BIT(2)},\n\t{\"XHCI\",                BIT(3)},\n\t{\"SPA\",                 BIT(4)},\n\t{\"SPB\",                 BIT(5)},\n\t{\"SPC\",                 BIT(6)},\n\t{\"GBE\",                 BIT(7)},\n\n\t{\"SATA\",                BIT(0)},\n\t{\"HDA_PGD0\",            BIT(1)},\n\t{\"HDA_PGD1\",            BIT(2)},\n\t{\"HDA_PGD2\",            BIT(3)},\n\t{\"HDA_PGD3\",            BIT(4)},\n\t{\"SPD\",                 BIT(5)},\n\t{\"LPSS\",                BIT(6)},\n\t{\"LPC\",                 BIT(7)},\n\n\t{\"SMB\",                 BIT(0)},\n\t{\"ISH\",                 BIT(1)},\n\t{\"P2SB\",                BIT(2)},\n\t{\"NPK_VNN\",             BIT(3)},\n\t{\"SDX\",                 BIT(4)},\n\t{\"SPE\",                 BIT(5)},\n\t{\"Fuse\",                BIT(6)},\n\t{\"SBR8\",\t\tBIT(7)},\n\n\t{\"CSME_FSC\",            BIT(0)},\n\t{\"USB3_OTG\",            BIT(1)},\n\t{\"EXI\",                 BIT(2)},\n\t{\"CSE\",                 BIT(3)},\n\t{\"CSME_KVM\",            BIT(4)},\n\t{\"CSME_PMT\",            BIT(5)},\n\t{\"CSME_CLINK\",          BIT(6)},\n\t{\"CSME_PTIO\",           BIT(7)},\n\n\t{\"CSME_USBR\",           BIT(0)},\n\t{\"CSME_SUSRAM\",         BIT(1)},\n\t{\"CSME_SMT1\",           BIT(2)},\n\t{\"CSME_SMT4\",           BIT(3)},\n\t{\"CSME_SMS2\",           BIT(4)},\n\t{\"CSME_SMS1\",           BIT(5)},\n\t{\"CSME_RTC\",            BIT(6)},\n\t{\"CSME_PSF\",            BIT(7)},\n\n\t{\"SBR0\",                BIT(0)},\n\t{\"SBR1\",                BIT(1)},\n\t{\"SBR2\",                BIT(2)},\n\t{\"SBR3\",                BIT(3)},\n\t{\"SBR4\",                BIT(4)},\n\t{\"SBR5\",                BIT(5)},\n\t{\"CSME_PECI\",           BIT(6)},\n\t{\"PSF1\",                BIT(7)},\n\n\t{\"PSF2\",                BIT(0)},\n\t{\"PSF3\",                BIT(1)},\n\t{\"PSF4\",                BIT(2)},\n\t{\"CNVI\",                BIT(3)},\n\t{\"UFS0\",                BIT(4)},\n\t{\"EMMC\",                BIT(5)},\n\t{\"SPF\",\t\t\tBIT(6)},\n\t{\"SBR6\",                BIT(7)},\n\n\t{\"SBR7\",                BIT(0)},\n\t{\"NPK_AON\",             BIT(1)},\n\t{\"HDA_PGD4\",            BIT(2)},\n\t{\"HDA_PGD5\",            BIT(3)},\n\t{\"HDA_PGD6\",            BIT(4)},\n\t{\"PSF6\",\t\tBIT(5)},\n\t{\"PSF7\",\t\tBIT(6)},\n\t{\"PSF8\",\t\tBIT(7)},\n\t{}\n};\n\nconst struct pmc_bit_map *ext_cnp_pfear_map[] = {\n\t \n\tcnp_pfear_map,\n\tNULL\n};\n\nconst struct pmc_bit_map cnp_slps0_dbg0_map[] = {\n\t{\"AUDIO_D3\",\t\tBIT(0)},\n\t{\"OTG_D3\",\t\tBIT(1)},\n\t{\"XHCI_D3\",\t\tBIT(2)},\n\t{\"LPIO_D3\",\t\tBIT(3)},\n\t{\"SDX_D3\",\t\tBIT(4)},\n\t{\"SATA_D3\",\t\tBIT(5)},\n\t{\"UFS0_D3\",\t\tBIT(6)},\n\t{\"UFS1_D3\",\t\tBIT(7)},\n\t{\"EMMC_D3\",\t\tBIT(8)},\n\t{}\n};\n\nconst struct pmc_bit_map cnp_slps0_dbg1_map[] = {\n\t{\"SDIO_PLL_OFF\",\tBIT(0)},\n\t{\"USB2_PLL_OFF\",\tBIT(1)},\n\t{\"AUDIO_PLL_OFF\",\tBIT(2)},\n\t{\"OC_PLL_OFF\",\t\tBIT(3)},\n\t{\"MAIN_PLL_OFF\",\tBIT(4)},\n\t{\"XOSC_OFF\",\t\tBIT(5)},\n\t{\"LPC_CLKS_GATED\",\tBIT(6)},\n\t{\"PCIE_CLKREQS_IDLE\",\tBIT(7)},\n\t{\"AUDIO_ROSC_OFF\",\tBIT(8)},\n\t{\"HPET_XOSC_CLK_REQ\",\tBIT(9)},\n\t{\"PMC_ROSC_SLOW_CLK\",\tBIT(10)},\n\t{\"AON2_ROSC_GATED\",\tBIT(11)},\n\t{\"CLKACKS_DEASSERTED\",\tBIT(12)},\n\t{}\n};\n\nconst struct pmc_bit_map cnp_slps0_dbg2_map[] = {\n\t{\"MPHY_CORE_GATED\",\tBIT(0)},\n\t{\"CSME_GATED\",\t\tBIT(1)},\n\t{\"USB2_SUS_GATED\",\tBIT(2)},\n\t{\"DYN_FLEX_IO_IDLE\",\tBIT(3)},\n\t{\"GBE_NO_LINK\",\t\tBIT(4)},\n\t{\"THERM_SEN_DISABLED\",\tBIT(5)},\n\t{\"PCIE_LOW_POWER\",\tBIT(6)},\n\t{\"ISH_VNNAON_REQ_ACT\",\tBIT(7)},\n\t{\"ISH_VNN_REQ_ACT\",\tBIT(8)},\n\t{\"CNV_VNNAON_REQ_ACT\",\tBIT(9)},\n\t{\"CNV_VNN_REQ_ACT\",\tBIT(10)},\n\t{\"NPK_VNNON_REQ_ACT\",\tBIT(11)},\n\t{\"PMSYNC_STATE_IDLE\",\tBIT(12)},\n\t{\"ALST_GT_THRES\",\tBIT(13)},\n\t{\"PMC_ARC_PG_READY\",\tBIT(14)},\n\t{}\n};\n\nconst struct pmc_bit_map *cnp_slps0_dbg_maps[] = {\n\tcnp_slps0_dbg0_map,\n\tcnp_slps0_dbg1_map,\n\tcnp_slps0_dbg2_map,\n\tNULL\n};\n\nconst struct pmc_bit_map cnp_ltr_show_map[] = {\n\t{\"SOUTHPORT_A\",\t\tCNP_PMC_LTR_SPA},\n\t{\"SOUTHPORT_B\",\t\tCNP_PMC_LTR_SPB},\n\t{\"SATA\",\t\tCNP_PMC_LTR_SATA},\n\t{\"GIGABIT_ETHERNET\",\tCNP_PMC_LTR_GBE},\n\t{\"XHCI\",\t\tCNP_PMC_LTR_XHCI},\n\t{\"Reserved\",\t\tCNP_PMC_LTR_RESERVED},\n\t{\"ME\",\t\t\tCNP_PMC_LTR_ME},\n\t \n\t{\"EVA\",\t\t\tCNP_PMC_LTR_EVA},\n\t{\"SOUTHPORT_C\",\t\tCNP_PMC_LTR_SPC},\n\t{\"HD_AUDIO\",\t\tCNP_PMC_LTR_AZ},\n\t{\"CNV\",\t\t\tCNP_PMC_LTR_CNV},\n\t{\"LPSS\",\t\tCNP_PMC_LTR_LPSS},\n\t{\"SOUTHPORT_D\",\t\tCNP_PMC_LTR_SPD},\n\t{\"SOUTHPORT_E\",\t\tCNP_PMC_LTR_SPE},\n\t{\"CAMERA\",\t\tCNP_PMC_LTR_CAM},\n\t{\"ESPI\",\t\tCNP_PMC_LTR_ESPI},\n\t{\"SCC\",\t\t\tCNP_PMC_LTR_SCC},\n\t{\"ISH\",\t\t\tCNP_PMC_LTR_ISH},\n\t{\"UFSX2\",\t\tCNP_PMC_LTR_UFSX2},\n\t{\"EMMC\",\t\tCNP_PMC_LTR_EMMC},\n\t \n\t{\"WIGIG\",\t\tICL_PMC_LTR_WIGIG},\n\t{\"THC0\",                TGL_PMC_LTR_THC0},\n\t{\"THC1\",                TGL_PMC_LTR_THC1},\n\t \n\t{\"CURRENT_PLATFORM\",\tCNP_PMC_LTR_CUR_PLT},\n\t{\"AGGREGATED_SYSTEM\",\tCNP_PMC_LTR_CUR_ASLT},\n\t{}\n};\n\nconst struct pmc_reg_map cnp_reg_map = {\n\t.pfear_sts = ext_cnp_pfear_map,\n\t.slp_s0_offset = CNP_PMC_SLP_S0_RES_COUNTER_OFFSET,\n\t.slp_s0_res_counter_step = SPT_PMC_SLP_S0_RES_COUNTER_STEP,\n\t.slps0_dbg_maps = cnp_slps0_dbg_maps,\n\t.ltr_show_sts = cnp_ltr_show_map,\n\t.msr_sts = msr_map,\n\t.slps0_dbg_offset = CNP_PMC_SLPS0_DBG_OFFSET,\n\t.ltr_ignore_offset = CNP_PMC_LTR_IGNORE_OFFSET,\n\t.regmap_length = CNP_PMC_MMIO_REG_LEN,\n\t.ppfear0_offset = CNP_PMC_HOST_PPFEAR0A,\n\t.ppfear_buckets = CNP_PPFEAR_NUM_ENTRIES,\n\t.pm_cfg_offset = CNP_PMC_PM_CFG_OFFSET,\n\t.pm_read_disable_bit = CNP_PMC_READ_DISABLE_BIT,\n\t.ltr_ignore_max = CNP_NUM_IP_IGN_ALLOWED,\n\t.etr3_offset = ETR3_OFFSET,\n};\n\nvoid cnl_suspend(struct pmc_dev *pmcdev)\n{\n\t \n\tpmc_core_send_ltr_ignore(pmcdev, 3, 1);\n}\n\nint cnl_resume(struct pmc_dev *pmcdev)\n{\n\tpmc_core_send_ltr_ignore(pmcdev, 3, 0);\n\n\treturn pmc_core_resume_common(pmcdev);\n}\n\nint cnp_core_init(struct pmc_dev *pmcdev)\n{\n\tstruct pmc *pmc = pmcdev->pmcs[PMC_IDX_MAIN];\n\tint ret;\n\n\tpmcdev->suspend = cnl_suspend;\n\tpmcdev->resume = cnl_resume;\n\n\tpmc->map = &cnp_reg_map;\n\tret = get_primary_reg_base(pmc);\n\tif (ret)\n\t\treturn ret;\n\n\treturn 0;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}