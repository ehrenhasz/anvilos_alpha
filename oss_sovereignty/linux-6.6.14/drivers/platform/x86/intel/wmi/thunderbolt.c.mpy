{
  "module_name": "thunderbolt.c",
  "hash_id": "0ebb2ace5b3ba94db10b9c0a50986e79c2916dae075997af0ac9fb26b6f2c9c6",
  "original_prompt": "Ingested from linux-6.6.14/drivers/platform/x86/intel/wmi/thunderbolt.c",
  "human_readable_source": "\n \n\n#define pr_fmt(fmt) KBUILD_MODNAME \": \" fmt\n\n#include <linux/acpi.h>\n#include <linux/device.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n#include <linux/string.h>\n#include <linux/sysfs.h>\n#include <linux/types.h>\n#include <linux/wmi.h>\n\n#define INTEL_WMI_THUNDERBOLT_GUID \"86CCFD48-205E-4A77-9C48-2021CBEDE341\"\n\nstatic ssize_t force_power_store(struct device *dev,\n\t\t\t\t struct device_attribute *attr,\n\t\t\t\t const char *buf, size_t count)\n{\n\tstruct acpi_buffer input;\n\tacpi_status status;\n\tu8 mode;\n\n\tinput.length = sizeof(u8);\n\tinput.pointer = &mode;\n\tmode = hex_to_bin(buf[0]);\n\tdev_dbg(dev, \"force_power: storing %#x\\n\", mode);\n\tif (mode == 0 || mode == 1) {\n\t\tstatus = wmi_evaluate_method(INTEL_WMI_THUNDERBOLT_GUID, 0, 1,\n\t\t\t\t\t     &input, NULL);\n\t\tif (ACPI_FAILURE(status)) {\n\t\t\tdev_dbg(dev, \"force_power: failed to evaluate ACPI method\\n\");\n\t\t\treturn -ENODEV;\n\t\t}\n\t} else {\n\t\tdev_dbg(dev, \"force_power: unsupported mode\\n\");\n\t\treturn -EINVAL;\n\t}\n\treturn count;\n}\n\nstatic DEVICE_ATTR_WO(force_power);\n\nstatic struct attribute *tbt_attrs[] = {\n\t&dev_attr_force_power.attr,\n\tNULL\n};\nATTRIBUTE_GROUPS(tbt);\n\nstatic const struct wmi_device_id intel_wmi_thunderbolt_id_table[] = {\n\t{ .guid_string = INTEL_WMI_THUNDERBOLT_GUID },\n\t{ },\n};\n\nstatic struct wmi_driver intel_wmi_thunderbolt_driver = {\n\t.driver = {\n\t\t.name = \"intel-wmi-thunderbolt\",\n\t\t.dev_groups = tbt_groups,\n\t},\n\t.id_table = intel_wmi_thunderbolt_id_table,\n};\n\nmodule_wmi_driver(intel_wmi_thunderbolt_driver);\n\nMODULE_DEVICE_TABLE(wmi, intel_wmi_thunderbolt_id_table);\nMODULE_AUTHOR(\"Mario Limonciello <mario.limonciello@dell.com>\");\nMODULE_DESCRIPTION(\"Intel WMI Thunderbolt force power driver\");\nMODULE_LICENSE(\"GPL v2\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}