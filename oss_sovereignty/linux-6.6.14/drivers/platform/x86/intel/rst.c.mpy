{
  "module_name": "rst.c",
  "hash_id": "85e5ab56438a4988c69a385bc40ad327d25f3e2bcfccbe5d7b9ac98a1e42a8f9",
  "original_prompt": "Ingested from linux-6.6.14/drivers/platform/x86/intel/rst.c",
  "human_readable_source": "\n \n\n#include <linux/acpi.h>\n#include <linux/module.h>\n#include <linux/slab.h>\n\nMODULE_LICENSE(\"GPL\");\n\nstatic ssize_t irst_show_wakeup_events(struct device *dev,\n\t\t\t\t       struct device_attribute *attr,\n\t\t\t\t       char *buf)\n{\n\tstruct acpi_device *acpi;\n\tunsigned long long value;\n\tacpi_status status;\n\n\tacpi = to_acpi_device(dev);\n\n\tstatus = acpi_evaluate_integer(acpi->handle, \"GFFS\", NULL, &value);\n\tif (ACPI_FAILURE(status))\n\t\treturn -EINVAL;\n\n\treturn sprintf(buf, \"%lld\\n\", value);\n}\n\nstatic ssize_t irst_store_wakeup_events(struct device *dev,\n\t\t\t\t\tstruct device_attribute *attr,\n\t\t\t\t\tconst char *buf, size_t count)\n{\n\tstruct acpi_device *acpi;\n\tacpi_status status;\n\tunsigned long value;\n\tint error;\n\n\tacpi = to_acpi_device(dev);\n\n\terror = kstrtoul(buf, 0, &value);\n\tif (error)\n\t\treturn error;\n\n\tstatus = acpi_execute_simple_method(acpi->handle, \"SFFS\", value);\n\tif (ACPI_FAILURE(status))\n\t\treturn -EINVAL;\n\n\treturn count;\n}\n\nstatic struct device_attribute irst_wakeup_attr = {\n\t.attr = { .name = \"wakeup_events\", .mode = 0600 },\n\t.show = irst_show_wakeup_events,\n\t.store = irst_store_wakeup_events\n};\n\nstatic ssize_t irst_show_wakeup_time(struct device *dev,\n\t\t\t\t     struct device_attribute *attr, char *buf)\n{\n\tstruct acpi_device *acpi;\n\tunsigned long long value;\n\tacpi_status status;\n\n\tacpi = to_acpi_device(dev);\n\n\tstatus = acpi_evaluate_integer(acpi->handle, \"GFTV\", NULL, &value);\n\tif (ACPI_FAILURE(status))\n\t\treturn -EINVAL;\n\n\treturn sprintf(buf, \"%lld\\n\", value);\n}\n\nstatic ssize_t irst_store_wakeup_time(struct device *dev,\n\t\t\t\t      struct device_attribute *attr,\n\t\t\t\t      const char *buf, size_t count)\n{\n\tstruct acpi_device *acpi;\n\tacpi_status status;\n\tunsigned long value;\n\tint error;\n\n\tacpi = to_acpi_device(dev);\n\n\terror = kstrtoul(buf, 0, &value);\n\tif (error)\n\t\treturn error;\n\n\tstatus = acpi_execute_simple_method(acpi->handle, \"SFTV\", value);\n\tif (ACPI_FAILURE(status))\n\t\treturn -EINVAL;\n\n\treturn count;\n}\n\nstatic struct device_attribute irst_timeout_attr = {\n\t.attr = { .name = \"wakeup_time\", .mode = 0600 },\n\t.show = irst_show_wakeup_time,\n\t.store = irst_store_wakeup_time\n};\n\nstatic int irst_add(struct acpi_device *acpi)\n{\n\tint error;\n\n\terror = device_create_file(&acpi->dev, &irst_timeout_attr);\n\tif (unlikely(error))\n\t\treturn error;\n\n\terror = device_create_file(&acpi->dev, &irst_wakeup_attr);\n\tif (unlikely(error))\n\t\tdevice_remove_file(&acpi->dev, &irst_timeout_attr);\n\n\treturn error;\n}\n\nstatic void irst_remove(struct acpi_device *acpi)\n{\n\tdevice_remove_file(&acpi->dev, &irst_wakeup_attr);\n\tdevice_remove_file(&acpi->dev, &irst_timeout_attr);\n}\n\nstatic const struct acpi_device_id irst_ids[] = {\n\t{\"INT3392\", 0},\n\t{\"\", 0}\n};\n\nstatic struct acpi_driver irst_driver = {\n\t.owner = THIS_MODULE,\n\t.name = \"intel_rapid_start\",\n\t.class = \"intel_rapid_start\",\n\t.ids = irst_ids,\n\t.ops = {\n\t\t.add = irst_add,\n\t\t.remove = irst_remove,\n\t},\n};\n\nmodule_acpi_driver(irst_driver);\n\nMODULE_DEVICE_TABLE(acpi, irst_ids);\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}