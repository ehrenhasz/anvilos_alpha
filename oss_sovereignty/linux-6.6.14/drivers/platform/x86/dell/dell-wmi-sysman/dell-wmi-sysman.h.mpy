{
  "module_name": "dell-wmi-sysman.h",
  "hash_id": "f951b5c5c07f9dd7b77e0b3946c65bf46e48b9af262b645bcf840b43d80137f5",
  "original_prompt": "Ingested from linux-6.6.14/drivers/platform/x86/dell/dell-wmi-sysman/dell-wmi-sysman.h",
  "human_readable_source": " \n\n#ifndef _DELL_WMI_BIOS_ATTR_H_\n#define _DELL_WMI_BIOS_ATTR_H_\n\n#include <linux/wmi.h>\n#include <linux/device.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n#include <linux/capability.h>\n\n#define DRIVER_NAME\t\t\t\t\t\"dell-wmi-sysman\"\n#define MAX_BUFF  512\n\n#define DELL_WMI_BIOS_ENUMERATION_ATTRIBUTE_GUID\t\"F1DDEE52-063C-4784-A11E-8A06684B9BF5\"\n#define DELL_WMI_BIOS_INTEGER_ATTRIBUTE_GUID\t\t\"F1DDEE52-063C-4784-A11E-8A06684B9BFA\"\n#define DELL_WMI_BIOS_STRING_ATTRIBUTE_GUID\t\t\"F1DDEE52-063C-4784-A11E-8A06684B9BF9\"\n#define DELL_WMI_BIOS_PASSOBJ_ATTRIBUTE_GUID\t\t\"0894B8D6-44A6-4719-97D7-6AD24108BFD4\"\n#define DELL_WMI_BIOS_ATTRIBUTES_INTERFACE_GUID\t\t\"F1DDEE52-063C-4784-A11E-8A06684B9BF4\"\n#define DELL_WMI_BIOS_PASSWORD_INTERFACE_GUID\t\t\"70FE8229-D03B-4214-A1C6-1F884B1A892A\"\n\nstruct enumeration_data {\n\tstruct kobject *attr_name_kobj;\n\tchar display_name_language_code[MAX_BUFF];\n\tchar dell_value_modifier[MAX_BUFF];\n\tchar possible_values[MAX_BUFF];\n\tchar attribute_name[MAX_BUFF];\n\tchar default_value[MAX_BUFF];\n\tchar dell_modifier[MAX_BUFF];\n\tchar display_name[MAX_BUFF];\n};\n\nstruct integer_data {\n\tstruct kobject *attr_name_kobj;\n\tchar display_name_language_code[MAX_BUFF];\n\tchar attribute_name[MAX_BUFF];\n\tchar dell_modifier[MAX_BUFF];\n\tchar display_name[MAX_BUFF];\n\tint scalar_increment;\n\tint default_value;\n\tint min_value;\n\tint max_value;\n};\n\nstruct str_data {\n\tstruct kobject *attr_name_kobj;\n\tchar display_name_language_code[MAX_BUFF];\n\tchar attribute_name[MAX_BUFF];\n\tchar display_name[MAX_BUFF];\n\tchar default_value[MAX_BUFF];\n\tchar dell_modifier[MAX_BUFF];\n\tint min_length;\n\tint max_length;\n};\n\nstruct po_data {\n\tstruct kobject *attr_name_kobj;\n\tchar attribute_name[MAX_BUFF];\n\tint min_password_length;\n\tint max_password_length;\n};\n\nstruct wmi_sysman_priv {\n\tchar current_admin_password[MAX_BUFF];\n\tchar current_system_password[MAX_BUFF];\n\tstruct wmi_device *password_attr_wdev;\n\tstruct wmi_device *bios_attr_wdev;\n\tstruct kset *authentication_dir_kset;\n\tstruct kset *main_dir_kset;\n\tstruct device *class_dev;\n\tstruct enumeration_data *enumeration_data;\n\tint enumeration_instances_count;\n\tstruct integer_data *integer_data;\n\tint integer_instances_count;\n\tstruct str_data *str_data;\n\tint str_instances_count;\n\tstruct po_data *po_data;\n\tint po_instances_count;\n\tbool pending_changes;\n\tstruct mutex mutex;\n};\n\n \nextern struct wmi_sysman_priv wmi_priv;\n\nenum { ENUM, INT, STR, PO };\n\nenum {\n\tATTR_NAME,\n\tDISPL_NAME_LANG_CODE,\n\tDISPLAY_NAME,\n\tDEFAULT_VAL,\n\tCURRENT_VAL,\n\tMODIFIER\n};\n\n#define get_instance_id(type)\t\t\t\t\t\t\t\\\nstatic int get_##type##_instance_id(struct kobject *kobj)\t\t\t\\\n{\t\t\t\t\t\t\t\t\t\t\\\n\tint i;\t\t\t\t\t\t\t\t\t\\\n\tfor (i = 0; i <= wmi_priv.type##_instances_count; i++) {\t\t\\\n\t\tif (!(strcmp(kobj->name, wmi_priv.type##_data[i].attribute_name)))\\\n\t\t\treturn i;\t\t\t\t\t\t\\\n\t}\t\t\t\t\t\t\t\t\t\\\n\treturn -EIO;\t\t\t\t\t\t\t\t\\\n}\n\n#define attribute_s_property_show(name, type)\t\t\t\t\t\\\nstatic ssize_t name##_show(struct kobject *kobj, struct kobj_attribute *attr,\t\\\n\t\t\t   char *buf)\t\t\t\t\t\t\\\n{\t\t\t\t\t\t\t\t\t\t\\\n\tint i = get_##type##_instance_id(kobj);\t\t\t\t\t\\\n\tif (i >= 0)\t\t\t\t\t\t\t\t\\\n\t\treturn sprintf(buf, \"%s\\n\", wmi_priv.type##_data[i].name);\t\\\n\treturn 0;\t\t\t\t\t\t\t\t\\\n}\n\n#define attribute_n_property_show(name, type)\t\t\t\t\t\\\nstatic ssize_t name##_show(struct kobject *kobj, struct kobj_attribute *attr,\t\\\n\t\t\t   char *buf)\t\t\t\t\t\t\\\n{\t\t\t\t\t\t\t\t\t\t\\\n\tint i = get_##type##_instance_id(kobj);\t\t\t\t\t\\\n\tif (i >= 0)\t\t\t\t\t\t\t\t\\\n\t\treturn sprintf(buf, \"%d\\n\", wmi_priv.type##_data[i].name);\t\\\n\treturn 0;\t\t\t\t\t\t\t\t\\\n}\n\n#define attribute_property_store(curr_val, type)\t\t\t\t\\\nstatic ssize_t curr_val##_store(struct kobject *kobj,\t\t\t\t\\\n\t\t\t\tstruct kobj_attribute *attr,\t\t\t\\\n\t\t\t\tconst char *buf, size_t count)\t\t\t\\\n{\t\t\t\t\t\t\t\t\t\t\\\n\tchar *p, *buf_cp;\t\t\t\t\t\t\t\\\n\tint i, ret = -EIO;\t\t\t\t\t\t\t\\\n\tbuf_cp = kstrdup(buf, GFP_KERNEL);\t\t\t\t\t\\\n\tif (!buf_cp)\t\t\t\t\t\t\t\t\\\n\t\treturn -ENOMEM;\t\t\t\t\t\t\t\\\n\tp = memchr(buf_cp, '\\n', count);\t\t\t\t\t\\\n\t\t\t\t\t\t\t\t\t\t\\\n\tif (p != NULL)\t\t\t\t\t\t\t\t\\\n\t\t*p = '\\0';\t\t\t\t\t\t\t\\\n\ti = get_##type##_instance_id(kobj);\t\t\t\t\t\\\n\tif (i >= 0)\t\t\t\t\t\t\t\t\\\n\t\tret = validate_##type##_input(i, buf_cp);\t\t\t\\\n\tif (!ret)\t\t\t\t\t\t\t\t\\\n\t\tret = set_attribute(kobj->name, buf_cp);\t\t\t\\\n\tkfree(buf_cp);\t\t\t\t\t\t\t\t\\\n\treturn ret ? ret : count;\t\t\t\t\t\t\\\n}\n\n#define check_property_type(attr, prop, valuetype)\t\t\t\t\\\n\t(attr##_obj[prop].type != valuetype)\n\nunion acpi_object *get_wmiobj_pointer(int instance_id, const char *guid_string);\nint get_instance_count(const char *guid_string);\nvoid strlcpy_attr(char *dest, char *src);\n\nint populate_enum_data(union acpi_object *enumeration_obj, int instance_id,\n\t\t\tstruct kobject *attr_name_kobj, u32 enum_property_count);\nint alloc_enum_data(void);\nvoid exit_enum_attributes(void);\n\nint populate_int_data(union acpi_object *integer_obj, int instance_id,\n\t\t\tstruct kobject *attr_name_kobj);\nint alloc_int_data(void);\nvoid exit_int_attributes(void);\n\nint populate_str_data(union acpi_object *str_obj, int instance_id, struct kobject *attr_name_kobj);\nint alloc_str_data(void);\nvoid exit_str_attributes(void);\n\nint populate_po_data(union acpi_object *po_obj, int instance_id, struct kobject *attr_name_kobj);\nint alloc_po_data(void);\nvoid exit_po_attributes(void);\n\nint set_attribute(const char *a_name, const char *a_value);\nint set_bios_defaults(u8 defType);\n\nvoid exit_bios_attr_set_interface(void);\nint init_bios_attr_set_interface(void);\nint map_wmi_error(int error_code);\nsize_t calculate_string_buffer(const char *str);\nsize_t calculate_security_buffer(char *authentication);\nvoid populate_security_buffer(char *buffer, char *authentication);\nssize_t populate_string_buffer(char *buffer, size_t buffer_len, const char *str);\nint set_new_password(const char *password_type, const char *new);\nint init_bios_attr_pass_interface(void);\nvoid exit_bios_attr_pass_interface(void);\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}