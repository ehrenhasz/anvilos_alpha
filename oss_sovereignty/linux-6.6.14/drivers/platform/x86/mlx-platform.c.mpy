{
  "module_name": "mlx-platform.c",
  "hash_id": "ec84f6c6a10686c9f1c4c022856ad86f36ee032dce38c2a0c1bfc9ee75439f9a",
  "original_prompt": "Ingested from linux-6.6.14/drivers/platform/x86/mlx-platform.c",
  "human_readable_source": "\n \n\n#include <linux/device.h>\n#include <linux/dmi.h>\n#include <linux/i2c.h>\n#include <linux/i2c-mux.h>\n#include <linux/io.h>\n#include <linux/module.h>\n#include <linux/pci.h>\n#include <linux/platform_device.h>\n#include <linux/platform_data/i2c-mux-reg.h>\n#include <linux/platform_data/mlxreg.h>\n#include <linux/reboot.h>\n#include <linux/regmap.h>\n\n#define MLX_PLAT_DEVICE_NAME\t\t\"mlxplat\"\n\n \n#define MLXPLAT_CPLD_LPC_I2C_BASE_ADRR\t\t0x2000\n#define MLXPLAT_CPLD_LPC_REG_BASE_ADRR\t\t0x2500\n#define MLXPLAT_CPLD_LPC_REG_CPLD1_VER_OFFSET\t0x00\n#define MLXPLAT_CPLD_LPC_REG_CPLD2_VER_OFFSET\t0x01\n#define MLXPLAT_CPLD_LPC_REG_CPLD3_VER_OFFSET\t0x02\n#define MLXPLAT_CPLD_LPC_REG_CPLD4_VER_OFFSET\t0x03\n#define MLXPLAT_CPLD_LPC_REG_CPLD1_PN_OFFSET\t0x04\n#define MLXPLAT_CPLD_LPC_REG_CPLD1_PN1_OFFSET\t0x05\n#define MLXPLAT_CPLD_LPC_REG_CPLD2_PN_OFFSET\t0x06\n#define MLXPLAT_CPLD_LPC_REG_CPLD2_PN1_OFFSET\t0x07\n#define MLXPLAT_CPLD_LPC_REG_CPLD3_PN_OFFSET\t0x08\n#define MLXPLAT_CPLD_LPC_REG_CPLD3_PN1_OFFSET\t0x09\n#define MLXPLAT_CPLD_LPC_REG_CPLD4_PN_OFFSET\t0x0a\n#define MLXPLAT_CPLD_LPC_REG_CPLD4_PN1_OFFSET\t0x0b\n#define MLXPLAT_CPLD_LPC_REG_RESET_GP1_OFFSET\t0x17\n#define MLXPLAT_CPLD_LPC_REG_RESET_GP2_OFFSET\t0x19\n#define MLXPLAT_CPLD_LPC_REG_RESET_GP4_OFFSET\t0x1c\n#define MLXPLAT_CPLD_LPC_REG_RESET_CAUSE_OFFSET\t0x1d\n#define MLXPLAT_CPLD_LPC_REG_RST_CAUSE1_OFFSET\t0x1e\n#define MLXPLAT_CPLD_LPC_REG_RST_CAUSE2_OFFSET\t0x1f\n#define MLXPLAT_CPLD_LPC_REG_LED1_OFFSET\t0x20\n#define MLXPLAT_CPLD_LPC_REG_LED2_OFFSET\t0x21\n#define MLXPLAT_CPLD_LPC_REG_LED3_OFFSET\t0x22\n#define MLXPLAT_CPLD_LPC_REG_LED4_OFFSET\t0x23\n#define MLXPLAT_CPLD_LPC_REG_LED5_OFFSET\t0x24\n#define MLXPLAT_CPLD_LPC_REG_LED6_OFFSET\t0x25\n#define MLXPLAT_CPLD_LPC_REG_LED7_OFFSET\t0x26\n#define MLXPLAT_CPLD_LPC_REG_FAN_DIRECTION\t0x2a\n#define MLXPLAT_CPLD_LPC_REG_GP0_RO_OFFSET\t0x2b\n#define MLXPLAT_CPLD_LPC_REG_GPCOM0_OFFSET\t0x2d\n#define MLXPLAT_CPLD_LPC_REG_GP0_OFFSET\t\t0x2e\n#define MLXPLAT_CPLD_LPC_REG_GP_RST_OFFSET\t0x2f\n#define MLXPLAT_CPLD_LPC_REG_GP1_OFFSET\t\t0x30\n#define MLXPLAT_CPLD_LPC_REG_WP1_OFFSET\t\t0x31\n#define MLXPLAT_CPLD_LPC_REG_GP2_OFFSET\t\t0x32\n#define MLXPLAT_CPLD_LPC_REG_WP2_OFFSET\t\t0x33\n#define MLXPLAT_CPLD_LPC_REG_FIELD_UPGRADE\t0x34\n#define MLXPLAT_CPLD_LPC_SAFE_BIOS_OFFSET\t0x35\n#define MLXPLAT_CPLD_LPC_SAFE_BIOS_WP_OFFSET\t0x36\n#define MLXPLAT_CPLD_LPC_REG_PWM_CONTROL_OFFSET\t0x37\n#define MLXPLAT_CPLD_LPC_REG_AGGR_OFFSET\t0x3a\n#define MLXPLAT_CPLD_LPC_REG_AGGR_MASK_OFFSET\t0x3b\n#define MLXPLAT_CPLD_LPC_REG_FU_CAP_OFFSET\t0x3c\n#define MLXPLAT_CPLD_LPC_REG_AGGRLO_OFFSET\t0x40\n#define MLXPLAT_CPLD_LPC_REG_AGGRLO_MASK_OFFSET\t0x41\n#define MLXPLAT_CPLD_LPC_REG_AGGRCO_OFFSET\t0x42\n#define MLXPLAT_CPLD_LPC_REG_AGGRCO_MASK_OFFSET\t0x43\n#define MLXPLAT_CPLD_LPC_REG_AGGRCX_OFFSET\t0x44\n#define MLXPLAT_CPLD_LPC_REG_AGGRCX_MASK_OFFSET 0x45\n#define MLXPLAT_CPLD_LPC_REG_BRD_OFFSET\t\t0x47\n#define MLXPLAT_CPLD_LPC_REG_BRD_EVENT_OFFSET\t0x48\n#define MLXPLAT_CPLD_LPC_REG_BRD_MASK_OFFSET\t0x49\n#define MLXPLAT_CPLD_LPC_REG_GWP_OFFSET\t\t0x4a\n#define MLXPLAT_CPLD_LPC_REG_GWP_EVENT_OFFSET\t0x4b\n#define MLXPLAT_CPLD_LPC_REG_GWP_MASK_OFFSET\t0x4c\n#define MLXPLAT_CPLD_LPC_REG_ASIC_HEALTH_OFFSET 0x50\n#define MLXPLAT_CPLD_LPC_REG_ASIC_EVENT_OFFSET\t0x51\n#define MLXPLAT_CPLD_LPC_REG_ASIC_MASK_OFFSET\t0x52\n#define MLXPLAT_CPLD_LPC_REG_ASIC2_HEALTH_OFFSET 0x53\n#define MLXPLAT_CPLD_LPC_REG_ASIC2_EVENT_OFFSET\t0x54\n#define MLXPLAT_CPLD_LPC_REG_ASIC2_MASK_OFFSET\t0x55\n#define MLXPLAT_CPLD_LPC_REG_AGGRLC_OFFSET\t0x56\n#define MLXPLAT_CPLD_LPC_REG_AGGRLC_MASK_OFFSET\t0x57\n#define MLXPLAT_CPLD_LPC_REG_PSU_OFFSET\t\t0x58\n#define MLXPLAT_CPLD_LPC_REG_PSU_EVENT_OFFSET\t0x59\n#define MLXPLAT_CPLD_LPC_REG_PSU_MASK_OFFSET\t0x5a\n#define MLXPLAT_CPLD_LPC_REG_PWR_OFFSET\t\t0x64\n#define MLXPLAT_CPLD_LPC_REG_PWR_EVENT_OFFSET\t0x65\n#define MLXPLAT_CPLD_LPC_REG_PWR_MASK_OFFSET\t0x66\n#define MLXPLAT_CPLD_LPC_REG_LC_IN_OFFSET\t0x70\n#define MLXPLAT_CPLD_LPC_REG_LC_IN_EVENT_OFFSET\t0x71\n#define MLXPLAT_CPLD_LPC_REG_LC_IN_MASK_OFFSET\t0x72\n#define MLXPLAT_CPLD_LPC_REG_FAN_OFFSET\t\t0x88\n#define MLXPLAT_CPLD_LPC_REG_FAN_EVENT_OFFSET\t0x89\n#define MLXPLAT_CPLD_LPC_REG_FAN_MASK_OFFSET\t0x8a\n#define MLXPLAT_CPLD_LPC_REG_CPLD5_VER_OFFSET\t0x8e\n#define MLXPLAT_CPLD_LPC_REG_CPLD5_PN_OFFSET\t0x8f\n#define MLXPLAT_CPLD_LPC_REG_CPLD5_PN1_OFFSET\t0x90\n#define MLXPLAT_CPLD_LPC_REG_EROT_OFFSET\t0x91\n#define MLXPLAT_CPLD_LPC_REG_EROT_EVENT_OFFSET\t0x92\n#define MLXPLAT_CPLD_LPC_REG_EROT_MASK_OFFSET\t0x93\n#define MLXPLAT_CPLD_LPC_REG_EROTE_OFFSET\t0x94\n#define MLXPLAT_CPLD_LPC_REG_EROTE_EVENT_OFFSET\t0x95\n#define MLXPLAT_CPLD_LPC_REG_EROTE_MASK_OFFSET\t0x96\n#define MLXPLAT_CPLD_LPC_REG_PWRB_OFFSET\t0x97\n#define MLXPLAT_CPLD_LPC_REG_PWRB_EVENT_OFFSET\t0x98\n#define MLXPLAT_CPLD_LPC_REG_PWRB_MASK_OFFSET\t0x99\n#define MLXPLAT_CPLD_LPC_REG_LC_VR_OFFSET\t0x9a\n#define MLXPLAT_CPLD_LPC_REG_LC_VR_EVENT_OFFSET\t0x9b\n#define MLXPLAT_CPLD_LPC_REG_LC_VR_MASK_OFFSET\t0x9c\n#define MLXPLAT_CPLD_LPC_REG_LC_PG_OFFSET\t0x9d\n#define MLXPLAT_CPLD_LPC_REG_LC_PG_EVENT_OFFSET\t0x9e\n#define MLXPLAT_CPLD_LPC_REG_LC_PG_MASK_OFFSET\t0x9f\n#define MLXPLAT_CPLD_LPC_REG_LC_RD_OFFSET\t0xa0\n#define MLXPLAT_CPLD_LPC_REG_LC_RD_EVENT_OFFSET 0xa1\n#define MLXPLAT_CPLD_LPC_REG_LC_RD_MASK_OFFSET\t0xa2\n#define MLXPLAT_CPLD_LPC_REG_LC_SN_OFFSET\t0xa3\n#define MLXPLAT_CPLD_LPC_REG_LC_SN_EVENT_OFFSET 0xa4\n#define MLXPLAT_CPLD_LPC_REG_LC_SN_MASK_OFFSET\t0xa5\n#define MLXPLAT_CPLD_LPC_REG_LC_OK_OFFSET\t0xa6\n#define MLXPLAT_CPLD_LPC_REG_LC_OK_EVENT_OFFSET\t0xa7\n#define MLXPLAT_CPLD_LPC_REG_LC_OK_MASK_OFFSET\t0xa8\n#define MLXPLAT_CPLD_LPC_REG_LC_SD_OFFSET\t0xa9\n#define MLXPLAT_CPLD_LPC_REG_LC_SD_EVENT_OFFSET\t0xaa\n#define MLXPLAT_CPLD_LPC_REG_LC_SD_MASK_OFFSET\t0xab\n#define MLXPLAT_CPLD_LPC_REG_LC_PWR_ON\t\t0xb2\n#define MLXPLAT_CPLD_LPC_REG_DBG1_OFFSET\t0xb6\n#define MLXPLAT_CPLD_LPC_REG_DBG2_OFFSET\t0xb7\n#define MLXPLAT_CPLD_LPC_REG_DBG3_OFFSET\t0xb8\n#define MLXPLAT_CPLD_LPC_REG_DBG4_OFFSET\t0xb9\n#define MLXPLAT_CPLD_LPC_REG_GP4_RO_OFFSET\t0xc2\n#define MLXPLAT_CPLD_LPC_REG_SPI_CHNL_SELECT\t0xc3\n#define MLXPLAT_CPLD_LPC_REG_CPLD5_MVER_OFFSET\t0xc4\n#define MLXPLAT_CPLD_LPC_REG_WD_CLEAR_OFFSET\t0xc7\n#define MLXPLAT_CPLD_LPC_REG_WD_CLEAR_WP_OFFSET\t0xc8\n#define MLXPLAT_CPLD_LPC_REG_WD1_TMR_OFFSET\t0xc9\n#define MLXPLAT_CPLD_LPC_REG_WD1_ACT_OFFSET\t0xcb\n#define MLXPLAT_CPLD_LPC_REG_WD2_TMR_OFFSET\t0xcd\n#define MLXPLAT_CPLD_LPC_REG_WD2_TLEFT_OFFSET\t0xce\n#define MLXPLAT_CPLD_LPC_REG_WD2_ACT_OFFSET\t0xcf\n#define MLXPLAT_CPLD_LPC_REG_WD3_TMR_OFFSET\t0xd1\n#define MLXPLAT_CPLD_LPC_REG_WD3_TLEFT_OFFSET\t0xd2\n#define MLXPLAT_CPLD_LPC_REG_WD3_ACT_OFFSET\t0xd3\n#define MLXPLAT_CPLD_LPC_REG_DBG_CTRL_OFFSET\t0xd9\n#define MLXPLAT_CPLD_LPC_REG_I2C_CH1_OFFSET\t0xdb\n#define MLXPLAT_CPLD_LPC_REG_I2C_CH2_OFFSET\t0xda\n#define MLXPLAT_CPLD_LPC_REG_I2C_CH3_OFFSET\t0xdc\n#define MLXPLAT_CPLD_LPC_REG_I2C_CH4_OFFSET\t0xdd\n#define MLXPLAT_CPLD_LPC_REG_CPLD1_MVER_OFFSET\t0xde\n#define MLXPLAT_CPLD_LPC_REG_CPLD2_MVER_OFFSET\t0xdf\n#define MLXPLAT_CPLD_LPC_REG_CPLD3_MVER_OFFSET\t0xe0\n#define MLXPLAT_CPLD_LPC_REG_CPLD4_MVER_OFFSET\t0xe1\n#define MLXPLAT_CPLD_LPC_REG_UFM_VERSION_OFFSET\t0xe2\n#define MLXPLAT_CPLD_LPC_REG_PWM1_OFFSET\t0xe3\n#define MLXPLAT_CPLD_LPC_REG_TACHO1_OFFSET\t0xe4\n#define MLXPLAT_CPLD_LPC_REG_TACHO2_OFFSET\t0xe5\n#define MLXPLAT_CPLD_LPC_REG_TACHO3_OFFSET\t0xe6\n#define MLXPLAT_CPLD_LPC_REG_TACHO4_OFFSET\t0xe7\n#define MLXPLAT_CPLD_LPC_REG_TACHO5_OFFSET\t0xe8\n#define MLXPLAT_CPLD_LPC_REG_TACHO6_OFFSET\t0xe9\n#define MLXPLAT_CPLD_LPC_REG_PWM2_OFFSET\t0xea\n#define MLXPLAT_CPLD_LPC_REG_TACHO7_OFFSET\t0xeb\n#define MLXPLAT_CPLD_LPC_REG_TACHO8_OFFSET\t0xec\n#define MLXPLAT_CPLD_LPC_REG_TACHO9_OFFSET\t0xed\n#define MLXPLAT_CPLD_LPC_REG_TACHO10_OFFSET\t0xee\n#define MLXPLAT_CPLD_LPC_REG_TACHO11_OFFSET\t0xef\n#define MLXPLAT_CPLD_LPC_REG_TACHO12_OFFSET\t0xf0\n#define MLXPLAT_CPLD_LPC_REG_TACHO13_OFFSET\t0xf1\n#define MLXPLAT_CPLD_LPC_REG_TACHO14_OFFSET\t0xf2\n#define MLXPLAT_CPLD_LPC_REG_PWM3_OFFSET\t0xf3\n#define MLXPLAT_CPLD_LPC_REG_PWM4_OFFSET\t0xf4\n#define MLXPLAT_CPLD_LPC_REG_FAN_CAP1_OFFSET\t0xf5\n#define MLXPLAT_CPLD_LPC_REG_FAN_CAP2_OFFSET\t0xf6\n#define MLXPLAT_CPLD_LPC_REG_FAN_DRW_CAP_OFFSET\t0xf7\n#define MLXPLAT_CPLD_LPC_REG_TACHO_SPEED_OFFSET\t0xf8\n#define MLXPLAT_CPLD_LPC_REG_PSU_I2C_CAP_OFFSET 0xf9\n#define MLXPLAT_CPLD_LPC_REG_SLOT_QTY_OFFSET\t0xfa\n#define MLXPLAT_CPLD_LPC_REG_CONFIG1_OFFSET\t0xfb\n#define MLXPLAT_CPLD_LPC_REG_CONFIG2_OFFSET\t0xfc\n#define MLXPLAT_CPLD_LPC_REG_CONFIG3_OFFSET\t0xfd\n#define MLXPLAT_CPLD_LPC_IO_RANGE\t\t0x100\n\n#define MLXPLAT_CPLD_LPC_PIO_OFFSET\t\t0x10000UL\n#define MLXPLAT_CPLD_LPC_REG1\t((MLXPLAT_CPLD_LPC_REG_BASE_ADRR + \\\n\t\t\t\t  MLXPLAT_CPLD_LPC_REG_I2C_CH1_OFFSET) | \\\n\t\t\t\t  MLXPLAT_CPLD_LPC_PIO_OFFSET)\n#define MLXPLAT_CPLD_LPC_REG2\t((MLXPLAT_CPLD_LPC_REG_BASE_ADRR + \\\n\t\t\t\t  MLXPLAT_CPLD_LPC_REG_I2C_CH2_OFFSET) | \\\n\t\t\t\t  MLXPLAT_CPLD_LPC_PIO_OFFSET)\n#define MLXPLAT_CPLD_LPC_REG3\t((MLXPLAT_CPLD_LPC_REG_BASE_ADRR + \\\n\t\t\t\t  MLXPLAT_CPLD_LPC_REG_I2C_CH3_OFFSET) | \\\n\t\t\t\t  MLXPLAT_CPLD_LPC_PIO_OFFSET)\n#define MLXPLAT_CPLD_LPC_REG4\t((MLXPLAT_CPLD_LPC_REG_BASE_ADRR + \\\n\t\t\t\t  MLXPLAT_CPLD_LPC_REG_I2C_CH4_OFFSET) | \\\n\t\t\t\t  MLXPLAT_CPLD_LPC_PIO_OFFSET)\n\n \n#define MLXPLAT_CPLD_AGGR_ASIC_MASK_DEF\t0x04\n#define MLXPLAT_CPLD_AGGR_PSU_MASK_DEF\t0x08\n#define MLXPLAT_CPLD_AGGR_PWR_MASK_DEF\t0x08\n#define MLXPLAT_CPLD_AGGR_FAN_MASK_DEF\t0x40\n#define MLXPLAT_CPLD_AGGR_MASK_DEF\t(MLXPLAT_CPLD_AGGR_ASIC_MASK_DEF | \\\n\t\t\t\t\t MLXPLAT_CPLD_AGGR_PSU_MASK_DEF | \\\n\t\t\t\t\t MLXPLAT_CPLD_AGGR_FAN_MASK_DEF)\n#define MLXPLAT_CPLD_AGGR_ASIC_MASK_NG\t0x01\n#define MLXPLAT_CPLD_AGGR_MASK_NG_DEF\t0x04\n#define MLXPLAT_CPLD_AGGR_MASK_COMEX\tBIT(0)\n#define MLXPLAT_CPLD_AGGR_MASK_LC\tBIT(3)\n#define MLXPLAT_CPLD_AGGR_MASK_MODULAR\t(MLXPLAT_CPLD_AGGR_MASK_NG_DEF | \\\n\t\t\t\t\t MLXPLAT_CPLD_AGGR_MASK_COMEX | \\\n\t\t\t\t\t MLXPLAT_CPLD_AGGR_MASK_LC)\n#define MLXPLAT_CPLD_AGGR_MASK_LC_PRSNT\tBIT(0)\n#define MLXPLAT_CPLD_AGGR_MASK_LC_RDY\tBIT(1)\n#define MLXPLAT_CPLD_AGGR_MASK_LC_PG\tBIT(2)\n#define MLXPLAT_CPLD_AGGR_MASK_LC_SCRD\tBIT(3)\n#define MLXPLAT_CPLD_AGGR_MASK_LC_SYNC\tBIT(4)\n#define MLXPLAT_CPLD_AGGR_MASK_LC_ACT\tBIT(5)\n#define MLXPLAT_CPLD_AGGR_MASK_LC_SDWN\tBIT(6)\n#define MLXPLAT_CPLD_AGGR_MASK_LC_LOW\t(MLXPLAT_CPLD_AGGR_MASK_LC_PRSNT | \\\n\t\t\t\t\t MLXPLAT_CPLD_AGGR_MASK_LC_RDY | \\\n\t\t\t\t\t MLXPLAT_CPLD_AGGR_MASK_LC_PG | \\\n\t\t\t\t\t MLXPLAT_CPLD_AGGR_MASK_LC_SCRD | \\\n\t\t\t\t\t MLXPLAT_CPLD_AGGR_MASK_LC_SYNC | \\\n\t\t\t\t\t MLXPLAT_CPLD_AGGR_MASK_LC_ACT | \\\n\t\t\t\t\t MLXPLAT_CPLD_AGGR_MASK_LC_SDWN)\n#define MLXPLAT_CPLD_LOW_AGGR_MASK_LOW\t0xc1\n#define MLXPLAT_CPLD_LOW_AGGR_MASK_ASIC2\tBIT(2)\n#define MLXPLAT_CPLD_LOW_AGGR_MASK_PWR_BUT\tGENMASK(5, 4)\n#define MLXPLAT_CPLD_LOW_AGGR_MASK_I2C\tBIT(6)\n#define MLXPLAT_CPLD_PSU_MASK\t\tGENMASK(1, 0)\n#define MLXPLAT_CPLD_PWR_MASK\t\tGENMASK(1, 0)\n#define MLXPLAT_CPLD_PSU_EXT_MASK\tGENMASK(3, 0)\n#define MLXPLAT_CPLD_PWR_EXT_MASK\tGENMASK(3, 0)\n#define MLXPLAT_CPLD_FAN_MASK\t\tGENMASK(3, 0)\n#define MLXPLAT_CPLD_ASIC_MASK\t\tGENMASK(1, 0)\n#define MLXPLAT_CPLD_FAN_NG_MASK\tGENMASK(6, 0)\n#define MLXPLAT_CPLD_LED_LO_NIBBLE_MASK\tGENMASK(7, 4)\n#define MLXPLAT_CPLD_LED_HI_NIBBLE_MASK\tGENMASK(3, 0)\n#define MLXPLAT_CPLD_VOLTREG_UPD_MASK\tGENMASK(5, 4)\n#define MLXPLAT_CPLD_GWP_MASK\t\tGENMASK(0, 0)\n#define MLXPLAT_CPLD_EROT_MASK\t\tGENMASK(1, 0)\n#define MLXPLAT_CPLD_FU_CAP_MASK\tGENMASK(1, 0)\n#define MLXPLAT_CPLD_PWR_BUTTON_MASK\tBIT(0)\n#define MLXPLAT_CPLD_LATCH_RST_MASK\tBIT(6)\n#define MLXPLAT_CPLD_THERMAL1_PDB_MASK\tBIT(3)\n#define MLXPLAT_CPLD_THERMAL2_PDB_MASK\tBIT(4)\n#define MLXPLAT_CPLD_INTRUSION_MASK\tBIT(6)\n#define MLXPLAT_CPLD_PWM_PG_MASK\tBIT(7)\n#define MLXPLAT_CPLD_L1_CHA_HEALTH_MASK (MLXPLAT_CPLD_THERMAL1_PDB_MASK | \\\n\t\t\t\t\t MLXPLAT_CPLD_THERMAL2_PDB_MASK | \\\n\t\t\t\t\t MLXPLAT_CPLD_INTRUSION_MASK |\\\n\t\t\t\t\t MLXPLAT_CPLD_PWM_PG_MASK)\n#define MLXPLAT_CPLD_I2C_CAP_BIT\t0x04\n#define MLXPLAT_CPLD_I2C_CAP_MASK\tGENMASK(5, MLXPLAT_CPLD_I2C_CAP_BIT)\n#define MLXPLAT_CPLD_SYS_RESET_MASK\tBIT(0)\n\n \n#define MLXPLAT_CPLD_AGGR_MASK_CARRIER\tBIT(1)\n#define MLXPLAT_CPLD_AGGR_MASK_CARR_DEF\t(MLXPLAT_CPLD_AGGR_ASIC_MASK_DEF | \\\n\t\t\t\t\t MLXPLAT_CPLD_AGGR_MASK_CARRIER)\n#define MLXPLAT_CPLD_LOW_AGGRCX_MASK\t0xc1\n\n \n#define MLXPLAT_CPLD_LPC_LC_MASK\tGENMASK(7, 0)\n\n#define MLXPLAT_CPLD_HALT_MASK\t\tBIT(3)\n#define MLXPLAT_CPLD_RESET_MASK\t\tGENMASK(7, 1)\n\n \n#define MLXPLAT_CPLD_PHYS_ADAPTER_DEF_NR\t1\n\n \n#define MLXPLAT_CPLD_MAX_PHYS_ADAPTER_NUM\t16\n#define MLXPLAT_CPLD_MAX_PHYS_EXT_ADAPTER_NUM\t24\n\n \n#define MLXPLAT_CPLD_GRP_CHNL_NUM\t\t8\n\n \n#define MLXPLAT_CPLD_CH1\t\t\t2\n#define MLXPLAT_CPLD_CH2\t\t\t10\n#define MLXPLAT_CPLD_CH3\t\t\t18\n#define MLXPLAT_CPLD_CH2_ETH_MODULAR\t\t3\n#define MLXPLAT_CPLD_CH3_ETH_MODULAR\t\t43\n#define MLXPLAT_CPLD_CH4_ETH_MODULAR\t\t51\n#define MLXPLAT_CPLD_CH2_RACK_SWITCH\t\t18\n#define MLXPLAT_CPLD_CH2_NG800\t\t\t34\n\n \n#define MLXPLAT_CPLD_LPC_MUX_DEVS\t\t4\n\n \n#define MLXPLAT_CPLD_NR_NONE\t\t\t-1\n#define MLXPLAT_CPLD_PSU_DEFAULT_NR\t\t10\n#define MLXPLAT_CPLD_PSU_MSNXXXX_NR\t\t4\n#define MLXPLAT_CPLD_FAN1_DEFAULT_NR\t\t11\n#define MLXPLAT_CPLD_FAN2_DEFAULT_NR\t\t12\n#define MLXPLAT_CPLD_FAN3_DEFAULT_NR\t\t13\n#define MLXPLAT_CPLD_FAN4_DEFAULT_NR\t\t14\n#define MLXPLAT_CPLD_NR_ASIC\t\t\t3\n#define MLXPLAT_CPLD_NR_LC_BASE\t\t\t34\n\n#define MLXPLAT_CPLD_NR_LC_SET(nr)\t(MLXPLAT_CPLD_NR_LC_BASE + (nr))\n#define MLXPLAT_CPLD_LC_ADDR\t\t0x32\n\n \n#define MLXPLAT_CPLD_WD1_CLEAR_MASK\tGENMASK(7, 1)\n#define MLXPLAT_CPLD_WD2_CLEAR_MASK\t(GENMASK(7, 0) & ~BIT(1))\n\n#define MLXPLAT_CPLD_WD_TYPE1_TO_MASK\tGENMASK(7, 4)\n#define MLXPLAT_CPLD_WD_TYPE2_TO_MASK\t0\n#define MLXPLAT_CPLD_WD_RESET_ACT_MASK\tGENMASK(7, 1)\n#define MLXPLAT_CPLD_WD_FAN_ACT_MASK\t(GENMASK(7, 0) & ~BIT(4))\n#define MLXPLAT_CPLD_WD_COUNT_ACT_MASK\t(GENMASK(7, 0) & ~BIT(7))\n#define MLXPLAT_CPLD_WD_CPBLTY_MASK\t(GENMASK(7, 0) & ~BIT(6))\n#define MLXPLAT_CPLD_WD_DFLT_TIMEOUT\t30\n#define MLXPLAT_CPLD_WD3_DFLT_TIMEOUT\t600\n#define MLXPLAT_CPLD_WD_MAX_DEVS\t2\n\n#define MLXPLAT_CPLD_LPC_SYSIRQ\t\t17\n\n \n#define MLXPLAT_CPLD_ETH_MODULAR_PWR_MIN\t50\n\n \n#define MLXPLAT_REGMAP_NVSWITCH_PWM_DEFAULT 0xf4\n\n#define MLXPLAT_I2C_MAIN_BUS_NOTIFIED\t\t0x01\n#define MLXPLAT_I2C_MAIN_BUS_HANDLE_CREATED\t0x02\n\n \n#define PCI_VENDOR_ID_LATTICE\t\t\t0x1204\n#define PCI_DEVICE_ID_LATTICE_I2C_BRIDGE\t0x9c2f\n#define PCI_DEVICE_ID_LATTICE_JTAG_BRIDGE\t0x9c30\n#define PCI_DEVICE_ID_LATTICE_LPC_BRIDGE\t0x9c32\n\n \nstruct mlxplat_priv {\n\tstruct platform_device *pdev_i2c;\n\tstruct platform_device *pdev_mux[MLXPLAT_CPLD_LPC_MUX_DEVS];\n\tstruct platform_device *pdev_hotplug;\n\tstruct platform_device *pdev_led;\n\tstruct platform_device *pdev_io_regs;\n\tstruct platform_device *pdev_fan;\n\tstruct platform_device *pdev_wd[MLXPLAT_CPLD_WD_MAX_DEVS];\n\tvoid *regmap;\n\tstruct resource *hotplug_resources;\n\tunsigned int hotplug_resources_size;\n\tu8 i2c_main_init_status;\n\tint irq_fpga;\n};\n\nstatic struct platform_device *mlxplat_dev;\nstatic int mlxplat_i2c_main_complition_notify(void *handle, int id);\nstatic void __iomem *i2c_bridge_addr, *jtag_bridge_addr;\n\n \nstatic const struct resource mlxplat_lpc_resources[] = {\n\t[0] = DEFINE_RES_NAMED(MLXPLAT_CPLD_LPC_I2C_BASE_ADRR,\n\t\t\t       MLXPLAT_CPLD_LPC_IO_RANGE,\n\t\t\t       \"mlxplat_cpld_lpc_i2c_ctrl\", IORESOURCE_IO),\n\t[1] = DEFINE_RES_NAMED(MLXPLAT_CPLD_LPC_REG_BASE_ADRR,\n\t\t\t       MLXPLAT_CPLD_LPC_IO_RANGE,\n\t\t\t       \"mlxplat_cpld_lpc_regs\",\n\t\t\t       IORESOURCE_IO),\n};\n\n \nstatic struct mlxreg_core_hotplug_platform_data mlxplat_mlxcpld_i2c_default_data = {\n\t.completion_notify = mlxplat_i2c_main_complition_notify,\n};\n\n \nstatic struct mlxreg_core_data mlxplat_mlxcpld_i2c_ng_items_data[] = {\n\t{\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_PSU_I2C_CAP_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_I2C_CAP_MASK,\n\t\t.bit = MLXPLAT_CPLD_I2C_CAP_BIT,\n\t},\n};\n\nstatic struct mlxreg_core_item mlxplat_mlxcpld_i2c_ng_items[] = {\n\t{\n\t\t.data = mlxplat_mlxcpld_i2c_ng_items_data,\n\t},\n};\n\n \nstatic struct mlxreg_core_hotplug_platform_data mlxplat_mlxcpld_i2c_ng_data = {\n\t.items = mlxplat_mlxcpld_i2c_ng_items,\n\t.cell = MLXPLAT_CPLD_LPC_REG_AGGR_OFFSET,\n\t.mask = MLXPLAT_CPLD_AGGR_MASK_COMEX,\n\t.cell_low = MLXPLAT_CPLD_LPC_REG_AGGRCO_OFFSET,\n\t.mask_low = MLXPLAT_CPLD_LOW_AGGR_MASK_I2C,\n\t.completion_notify = mlxplat_i2c_main_complition_notify,\n};\n\n \nstatic const int mlxplat_default_channels[][MLXPLAT_CPLD_GRP_CHNL_NUM] = {\n\t{\n\t\tMLXPLAT_CPLD_CH1, MLXPLAT_CPLD_CH1 + 1, MLXPLAT_CPLD_CH1 + 2,\n\t\tMLXPLAT_CPLD_CH1 + 3, MLXPLAT_CPLD_CH1 + 4, MLXPLAT_CPLD_CH1 +\n\t\t5, MLXPLAT_CPLD_CH1 + 6, MLXPLAT_CPLD_CH1 + 7\n\t},\n\t{\n\t\tMLXPLAT_CPLD_CH2, MLXPLAT_CPLD_CH2 + 1, MLXPLAT_CPLD_CH2 + 2,\n\t\tMLXPLAT_CPLD_CH2 + 3, MLXPLAT_CPLD_CH2 + 4, MLXPLAT_CPLD_CH2 +\n\t\t5, MLXPLAT_CPLD_CH2 + 6, MLXPLAT_CPLD_CH2 + 7\n\t},\n};\n\n \nstatic const int mlxplat_msn21xx_channels[] = { 1, 2, 3, 4, 5, 6, 7, 8 };\n\n \nstatic struct i2c_mux_reg_platform_data mlxplat_default_mux_data[] = {\n\t{\n\t\t.parent = 1,\n\t\t.base_nr = MLXPLAT_CPLD_CH1,\n\t\t.write_only = 1,\n\t\t.reg = (void __iomem *)MLXPLAT_CPLD_LPC_REG1,\n\t\t.reg_size = 1,\n\t\t.idle_in_use = 1,\n\t},\n\t{\n\t\t.parent = 1,\n\t\t.base_nr = MLXPLAT_CPLD_CH2,\n\t\t.write_only = 1,\n\t\t.reg = (void __iomem *)MLXPLAT_CPLD_LPC_REG2,\n\t\t.reg_size = 1,\n\t\t.idle_in_use = 1,\n\t},\n\n};\n\n \nstatic int mlxplat_max_adap_num;\nstatic int mlxplat_mux_num;\nstatic struct i2c_mux_reg_platform_data *mlxplat_mux_data;\nstatic struct notifier_block *mlxplat_reboot_nb;\n\n \nstatic struct i2c_mux_reg_platform_data mlxplat_extended_mux_data[] = {\n\t{\n\t\t.parent = 1,\n\t\t.base_nr = MLXPLAT_CPLD_CH1,\n\t\t.write_only = 1,\n\t\t.reg = (void __iomem *)MLXPLAT_CPLD_LPC_REG1,\n\t\t.reg_size = 1,\n\t\t.idle_in_use = 1,\n\t},\n\t{\n\t\t.parent = 1,\n\t\t.base_nr = MLXPLAT_CPLD_CH2,\n\t\t.write_only = 1,\n\t\t.reg = (void __iomem *)MLXPLAT_CPLD_LPC_REG3,\n\t\t.reg_size = 1,\n\t\t.idle_in_use = 1,\n\t},\n\t{\n\t\t.parent = 1,\n\t\t.base_nr = MLXPLAT_CPLD_CH3,\n\t\t.write_only = 1,\n\t\t.reg = (void __iomem *)MLXPLAT_CPLD_LPC_REG2,\n\t\t.reg_size = 1,\n\t\t.idle_in_use = 1,\n\t},\n\n};\n\n \nstatic const int mlxplat_modular_upper_channel[] = { 1 };\nstatic const int mlxplat_modular_channels[] = {\n\t1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,\n\t21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37,\n\t38, 39, 40\n};\n\n \nstatic struct i2c_mux_reg_platform_data mlxplat_modular_mux_data[] = {\n\t{\n\t\t.parent = 1,\n\t\t.base_nr = MLXPLAT_CPLD_CH1,\n\t\t.write_only = 1,\n\t\t.reg = (void __iomem *)MLXPLAT_CPLD_LPC_REG4,\n\t\t.reg_size = 1,\n\t\t.idle_in_use = 1,\n\t\t.values = mlxplat_modular_upper_channel,\n\t\t.n_values = ARRAY_SIZE(mlxplat_modular_upper_channel),\n\t},\n\t{\n\t\t.parent = 1,\n\t\t.base_nr = MLXPLAT_CPLD_CH2_ETH_MODULAR,\n\t\t.write_only = 1,\n\t\t.reg = (void __iomem *)MLXPLAT_CPLD_LPC_REG1,\n\t\t.reg_size = 1,\n\t\t.idle_in_use = 1,\n\t\t.values = mlxplat_modular_channels,\n\t\t.n_values = ARRAY_SIZE(mlxplat_modular_channels),\n\t},\n\t{\n\t\t.parent = MLXPLAT_CPLD_CH1,\n\t\t.base_nr = MLXPLAT_CPLD_CH3_ETH_MODULAR,\n\t\t.write_only = 1,\n\t\t.reg = (void __iomem *)MLXPLAT_CPLD_LPC_REG3,\n\t\t.reg_size = 1,\n\t\t.idle_in_use = 1,\n\t\t.values = mlxplat_msn21xx_channels,\n\t\t.n_values = ARRAY_SIZE(mlxplat_msn21xx_channels),\n\t},\n\t{\n\t\t.parent = 1,\n\t\t.base_nr = MLXPLAT_CPLD_CH4_ETH_MODULAR,\n\t\t.write_only = 1,\n\t\t.reg = (void __iomem *)MLXPLAT_CPLD_LPC_REG2,\n\t\t.reg_size = 1,\n\t\t.idle_in_use = 1,\n\t\t.values = mlxplat_msn21xx_channels,\n\t\t.n_values = ARRAY_SIZE(mlxplat_msn21xx_channels),\n\t},\n};\n\n \nstatic const int mlxplat_rack_switch_channels[] = {\n\t1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16,\n};\n\n \nstatic struct i2c_mux_reg_platform_data mlxplat_rack_switch_mux_data[] = {\n\t{\n\t\t.parent = 1,\n\t\t.base_nr = MLXPLAT_CPLD_CH1,\n\t\t.write_only = 1,\n\t\t.reg = (void __iomem *)MLXPLAT_CPLD_LPC_REG1,\n\t\t.reg_size = 1,\n\t\t.idle_in_use = 1,\n\t\t.values = mlxplat_rack_switch_channels,\n\t\t.n_values = ARRAY_SIZE(mlxplat_rack_switch_channels),\n\t},\n\t{\n\t\t.parent = 1,\n\t\t.base_nr = MLXPLAT_CPLD_CH2_RACK_SWITCH,\n\t\t.write_only = 1,\n\t\t.reg = (void __iomem *)MLXPLAT_CPLD_LPC_REG2,\n\t\t.reg_size = 1,\n\t\t.idle_in_use = 1,\n\t\t.values = mlxplat_msn21xx_channels,\n\t\t.n_values = ARRAY_SIZE(mlxplat_msn21xx_channels),\n\t},\n\n};\n\n \nstatic const int mlxplat_ng800_channels[] = {\n\t1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17,\n\t18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32\n};\n\n \nstatic struct i2c_mux_reg_platform_data mlxplat_ng800_mux_data[] = {\n\t{\n\t\t.parent = 1,\n\t\t.base_nr = MLXPLAT_CPLD_CH1,\n\t\t.write_only = 1,\n\t\t.reg = (void __iomem *)MLXPLAT_CPLD_LPC_REG1,\n\t\t.reg_size = 1,\n\t\t.idle_in_use = 1,\n\t\t.values = mlxplat_ng800_channels,\n\t\t.n_values = ARRAY_SIZE(mlxplat_ng800_channels),\n\t},\n\t{\n\t\t.parent = 1,\n\t\t.base_nr = MLXPLAT_CPLD_CH2_NG800,\n\t\t.write_only = 1,\n\t\t.reg = (void __iomem *)MLXPLAT_CPLD_LPC_REG2,\n\t\t.reg_size = 1,\n\t\t.idle_in_use = 1,\n\t\t.values = mlxplat_msn21xx_channels,\n\t\t.n_values = ARRAY_SIZE(mlxplat_msn21xx_channels),\n\t},\n\n};\n\n \nstatic struct i2c_board_info mlxplat_mlxcpld_pwr[] = {\n\t{\n\t\tI2C_BOARD_INFO(\"dps460\", 0x59),\n\t},\n\t{\n\t\tI2C_BOARD_INFO(\"dps460\", 0x58),\n\t},\n};\n\nstatic struct i2c_board_info mlxplat_mlxcpld_ext_pwr[] = {\n\t{\n\t\tI2C_BOARD_INFO(\"dps460\", 0x5b),\n\t},\n\t{\n\t\tI2C_BOARD_INFO(\"dps460\", 0x5a),\n\t},\n};\n\nstatic struct i2c_board_info mlxplat_mlxcpld_pwr_ng800[] = {\n\t{\n\t\tI2C_BOARD_INFO(\"dps460\", 0x59),\n\t},\n\t{\n\t\tI2C_BOARD_INFO(\"dps460\", 0x5a),\n\t},\n};\n\nstatic struct i2c_board_info mlxplat_mlxcpld_fan[] = {\n\t{\n\t\tI2C_BOARD_INFO(\"24c32\", 0x50),\n\t},\n\t{\n\t\tI2C_BOARD_INFO(\"24c32\", 0x50),\n\t},\n\t{\n\t\tI2C_BOARD_INFO(\"24c32\", 0x50),\n\t},\n\t{\n\t\tI2C_BOARD_INFO(\"24c32\", 0x50),\n\t},\n};\n\n \nstatic struct mlxreg_core_data mlxplat_mlxcpld_comex_psu_items_data[] = {\n\t{\n\t\t.label = \"psu1\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_PSU_OFFSET,\n\t\t.mask = BIT(0),\n\t\t.hpdev.nr = MLXPLAT_CPLD_NR_NONE,\n\t},\n\t{\n\t\t.label = \"psu2\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_PSU_OFFSET,\n\t\t.mask = BIT(1),\n\t\t.hpdev.nr = MLXPLAT_CPLD_NR_NONE,\n\t},\n};\n\n \nstatic struct mlxreg_core_data mlxplat_mlxcpld_default_psu_items_data[] = {\n\t{\n\t\t.label = \"psu1\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_PSU_OFFSET,\n\t\t.mask = BIT(0),\n\t\t.hpdev.nr = MLXPLAT_CPLD_NR_NONE,\n\t},\n\t{\n\t\t.label = \"psu2\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_PSU_OFFSET,\n\t\t.mask = BIT(1),\n\t\t.hpdev.nr = MLXPLAT_CPLD_NR_NONE,\n\t},\n};\n\nstatic struct mlxreg_core_data mlxplat_mlxcpld_default_pwr_items_data[] = {\n\t{\n\t\t.label = \"pwr1\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_PWR_OFFSET,\n\t\t.mask = BIT(0),\n\t\t.hpdev.brdinfo = &mlxplat_mlxcpld_pwr[0],\n\t\t.hpdev.nr = MLXPLAT_CPLD_PSU_DEFAULT_NR,\n\t},\n\t{\n\t\t.label = \"pwr2\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_PWR_OFFSET,\n\t\t.mask = BIT(1),\n\t\t.hpdev.brdinfo = &mlxplat_mlxcpld_pwr[1],\n\t\t.hpdev.nr = MLXPLAT_CPLD_PSU_DEFAULT_NR,\n\t},\n};\n\nstatic struct mlxreg_core_data mlxplat_mlxcpld_default_pwr_wc_items_data[] = {\n\t{\n\t\t.label = \"pwr1\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_PWR_OFFSET,\n\t\t.mask = BIT(0),\n\t\t.hpdev.nr = MLXPLAT_CPLD_NR_NONE,\n\t},\n\t{\n\t\t.label = \"pwr2\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_PWR_OFFSET,\n\t\t.mask = BIT(1),\n\t\t.hpdev.nr = MLXPLAT_CPLD_NR_NONE,\n\t},\n};\n\nstatic struct mlxreg_core_data mlxplat_mlxcpld_default_pwr_ng800_items_data[] = {\n\t{\n\t\t.label = \"pwr1\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_PWR_OFFSET,\n\t\t.mask = BIT(0),\n\t\t.hpdev.brdinfo = &mlxplat_mlxcpld_pwr_ng800[0],\n\t\t.hpdev.nr = MLXPLAT_CPLD_PSU_MSNXXXX_NR,\n\t},\n\t{\n\t\t.label = \"pwr2\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_PWR_OFFSET,\n\t\t.mask = BIT(1),\n\t\t.hpdev.brdinfo = &mlxplat_mlxcpld_pwr_ng800[1],\n\t\t.hpdev.nr = MLXPLAT_CPLD_PSU_MSNXXXX_NR,\n\t},\n};\n\nstatic struct mlxreg_core_data mlxplat_mlxcpld_default_fan_items_data[] = {\n\t{\n\t\t.label = \"fan1\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_FAN_OFFSET,\n\t\t.mask = BIT(0),\n\t\t.hpdev.brdinfo = &mlxplat_mlxcpld_fan[0],\n\t\t.hpdev.nr = MLXPLAT_CPLD_FAN1_DEFAULT_NR,\n\t},\n\t{\n\t\t.label = \"fan2\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_FAN_OFFSET,\n\t\t.mask = BIT(1),\n\t\t.hpdev.brdinfo = &mlxplat_mlxcpld_fan[1],\n\t\t.hpdev.nr = MLXPLAT_CPLD_FAN2_DEFAULT_NR,\n\t},\n\t{\n\t\t.label = \"fan3\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_FAN_OFFSET,\n\t\t.mask = BIT(2),\n\t\t.hpdev.brdinfo = &mlxplat_mlxcpld_fan[2],\n\t\t.hpdev.nr = MLXPLAT_CPLD_FAN3_DEFAULT_NR,\n\t},\n\t{\n\t\t.label = \"fan4\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_FAN_OFFSET,\n\t\t.mask = BIT(3),\n\t\t.hpdev.brdinfo = &mlxplat_mlxcpld_fan[3],\n\t\t.hpdev.nr = MLXPLAT_CPLD_FAN4_DEFAULT_NR,\n\t},\n};\n\nstatic struct mlxreg_core_data mlxplat_mlxcpld_default_asic_items_data[] = {\n\t{\n\t\t.label = \"asic1\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_ASIC_HEALTH_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_ASIC_MASK,\n\t\t.hpdev.nr = MLXPLAT_CPLD_NR_NONE,\n\t},\n};\n\nstatic struct mlxreg_core_data mlxplat_mlxcpld_default_asic2_items_data[] = {\n\t{\n\t\t.label = \"asic2\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_ASIC2_HEALTH_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_ASIC_MASK,\n\t\t.hpdev.nr = MLXPLAT_CPLD_NR_NONE,\n\t},\n};\n\nstatic struct mlxreg_core_item mlxplat_mlxcpld_default_items[] = {\n\t{\n\t\t.data = mlxplat_mlxcpld_default_psu_items_data,\n\t\t.aggr_mask = MLXPLAT_CPLD_AGGR_PSU_MASK_DEF,\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_PSU_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_PSU_MASK,\n\t\t.count = ARRAY_SIZE(mlxplat_mlxcpld_default_psu_items_data),\n\t\t.inversed = 1,\n\t\t.health = false,\n\t},\n\t{\n\t\t.data = mlxplat_mlxcpld_default_pwr_items_data,\n\t\t.aggr_mask = MLXPLAT_CPLD_AGGR_PWR_MASK_DEF,\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_PWR_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_PWR_MASK,\n\t\t.count = ARRAY_SIZE(mlxplat_mlxcpld_default_pwr_items_data),\n\t\t.inversed = 0,\n\t\t.health = false,\n\t},\n\t{\n\t\t.data = mlxplat_mlxcpld_default_fan_items_data,\n\t\t.aggr_mask = MLXPLAT_CPLD_AGGR_FAN_MASK_DEF,\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_FAN_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_FAN_MASK,\n\t\t.count = ARRAY_SIZE(mlxplat_mlxcpld_default_fan_items_data),\n\t\t.inversed = 1,\n\t\t.health = false,\n\t},\n\t{\n\t\t.data = mlxplat_mlxcpld_default_asic_items_data,\n\t\t.aggr_mask = MLXPLAT_CPLD_AGGR_ASIC_MASK_DEF,\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_ASIC_HEALTH_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_ASIC_MASK,\n\t\t.count = ARRAY_SIZE(mlxplat_mlxcpld_default_asic_items_data),\n\t\t.inversed = 0,\n\t\t.health = true,\n\t},\n};\n\nstatic struct mlxreg_core_item mlxplat_mlxcpld_comex_items[] = {\n\t{\n\t\t.data = mlxplat_mlxcpld_comex_psu_items_data,\n\t\t.aggr_mask = MLXPLAT_CPLD_AGGR_MASK_CARRIER,\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_PSU_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_PSU_MASK,\n\t\t.count = ARRAY_SIZE(mlxplat_mlxcpld_default_psu_items_data),\n\t\t.inversed = 1,\n\t\t.health = false,\n\t},\n\t{\n\t\t.data = mlxplat_mlxcpld_default_pwr_items_data,\n\t\t.aggr_mask = MLXPLAT_CPLD_AGGR_MASK_CARRIER,\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_PWR_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_PWR_MASK,\n\t\t.count = ARRAY_SIZE(mlxplat_mlxcpld_default_pwr_items_data),\n\t\t.inversed = 0,\n\t\t.health = false,\n\t},\n\t{\n\t\t.data = mlxplat_mlxcpld_default_fan_items_data,\n\t\t.aggr_mask = MLXPLAT_CPLD_AGGR_MASK_CARRIER,\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_FAN_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_FAN_MASK,\n\t\t.count = ARRAY_SIZE(mlxplat_mlxcpld_default_fan_items_data),\n\t\t.inversed = 1,\n\t\t.health = false,\n\t},\n\t{\n\t\t.data = mlxplat_mlxcpld_default_asic_items_data,\n\t\t.aggr_mask = MLXPLAT_CPLD_AGGR_ASIC_MASK_DEF,\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_ASIC_HEALTH_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_ASIC_MASK,\n\t\t.count = ARRAY_SIZE(mlxplat_mlxcpld_default_asic_items_data),\n\t\t.inversed = 0,\n\t\t.health = true,\n\t},\n};\n\nstatic\nstruct mlxreg_core_hotplug_platform_data mlxplat_mlxcpld_default_data = {\n\t.items = mlxplat_mlxcpld_default_items,\n\t.counter = ARRAY_SIZE(mlxplat_mlxcpld_default_items),\n\t.cell = MLXPLAT_CPLD_LPC_REG_AGGR_OFFSET,\n\t.mask = MLXPLAT_CPLD_AGGR_MASK_DEF,\n\t.cell_low = MLXPLAT_CPLD_LPC_REG_AGGRLO_OFFSET,\n\t.mask_low = MLXPLAT_CPLD_LOW_AGGR_MASK_LOW,\n};\n\nstatic struct mlxreg_core_item mlxplat_mlxcpld_default_wc_items[] = {\n\t{\n\t\t.data = mlxplat_mlxcpld_comex_psu_items_data,\n\t\t.aggr_mask = MLXPLAT_CPLD_AGGR_MASK_CARRIER,\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_PSU_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_PSU_MASK,\n\t\t.count = ARRAY_SIZE(mlxplat_mlxcpld_default_psu_items_data),\n\t\t.inversed = 1,\n\t\t.health = false,\n\t},\n\t{\n\t\t.data = mlxplat_mlxcpld_default_pwr_wc_items_data,\n\t\t.aggr_mask = MLXPLAT_CPLD_AGGR_MASK_CARRIER,\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_PWR_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_PWR_MASK,\n\t\t.count = ARRAY_SIZE(mlxplat_mlxcpld_default_pwr_items_data),\n\t\t.inversed = 0,\n\t\t.health = false,\n\t},\n\t{\n\t\t.data = mlxplat_mlxcpld_default_asic_items_data,\n\t\t.aggr_mask = MLXPLAT_CPLD_AGGR_ASIC_MASK_DEF,\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_ASIC_HEALTH_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_ASIC_MASK,\n\t\t.count = ARRAY_SIZE(mlxplat_mlxcpld_default_asic_items_data),\n\t\t.inversed = 0,\n\t\t.health = true,\n\t},\n};\n\nstatic\nstruct mlxreg_core_hotplug_platform_data mlxplat_mlxcpld_default_wc_data = {\n\t.items = mlxplat_mlxcpld_default_wc_items,\n\t.counter = ARRAY_SIZE(mlxplat_mlxcpld_default_wc_items),\n\t.cell = MLXPLAT_CPLD_LPC_REG_AGGR_OFFSET,\n\t.mask = MLXPLAT_CPLD_AGGR_MASK_DEF,\n\t.cell_low = MLXPLAT_CPLD_LPC_REG_AGGRLO_OFFSET,\n\t.mask_low = MLXPLAT_CPLD_LOW_AGGR_MASK_LOW,\n};\n\nstatic\nstruct mlxreg_core_hotplug_platform_data mlxplat_mlxcpld_comex_data = {\n\t.items = mlxplat_mlxcpld_comex_items,\n\t.counter = ARRAY_SIZE(mlxplat_mlxcpld_comex_items),\n\t.cell = MLXPLAT_CPLD_LPC_REG_AGGR_OFFSET,\n\t.mask = MLXPLAT_CPLD_AGGR_MASK_CARR_DEF,\n\t.cell_low = MLXPLAT_CPLD_LPC_REG_AGGRCX_OFFSET,\n\t.mask_low = MLXPLAT_CPLD_LOW_AGGRCX_MASK,\n};\n\nstatic struct mlxreg_core_data mlxplat_mlxcpld_msn21xx_pwr_items_data[] = {\n\t{\n\t\t.label = \"pwr1\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_PWR_OFFSET,\n\t\t.mask = BIT(0),\n\t\t.hpdev.nr = MLXPLAT_CPLD_NR_NONE,\n\t},\n\t{\n\t\t.label = \"pwr2\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_PWR_OFFSET,\n\t\t.mask = BIT(1),\n\t\t.hpdev.nr = MLXPLAT_CPLD_NR_NONE,\n\t},\n};\n\n \nstatic struct mlxreg_core_item mlxplat_mlxcpld_msn21xx_items[] = {\n\t{\n\t\t.data = mlxplat_mlxcpld_msn21xx_pwr_items_data,\n\t\t.aggr_mask = MLXPLAT_CPLD_AGGR_PWR_MASK_DEF,\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_PWR_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_PWR_MASK,\n\t\t.count = ARRAY_SIZE(mlxplat_mlxcpld_msn21xx_pwr_items_data),\n\t\t.inversed = 0,\n\t\t.health = false,\n\t},\n\t{\n\t\t.data = mlxplat_mlxcpld_default_asic_items_data,\n\t\t.aggr_mask = MLXPLAT_CPLD_AGGR_ASIC_MASK_DEF,\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_ASIC_HEALTH_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_ASIC_MASK,\n\t\t.count = ARRAY_SIZE(mlxplat_mlxcpld_default_asic_items_data),\n\t\t.inversed = 0,\n\t\t.health = true,\n\t},\n};\n\nstatic\nstruct mlxreg_core_hotplug_platform_data mlxplat_mlxcpld_msn21xx_data = {\n\t.items = mlxplat_mlxcpld_msn21xx_items,\n\t.counter = ARRAY_SIZE(mlxplat_mlxcpld_msn21xx_items),\n\t.cell = MLXPLAT_CPLD_LPC_REG_AGGR_OFFSET,\n\t.mask = MLXPLAT_CPLD_AGGR_MASK_DEF,\n\t.cell_low = MLXPLAT_CPLD_LPC_REG_AGGRLO_OFFSET,\n\t.mask_low = MLXPLAT_CPLD_LOW_AGGR_MASK_LOW,\n};\n\n \nstatic struct mlxreg_core_data mlxplat_mlxcpld_msn274x_psu_items_data[] = {\n\t{\n\t\t.label = \"psu1\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_PSU_OFFSET,\n\t\t.mask = BIT(0),\n\t\t.hpdev.nr = MLXPLAT_CPLD_NR_NONE,\n\t},\n\t{\n\t\t.label = \"psu2\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_PSU_OFFSET,\n\t\t.mask = BIT(1),\n\t\t.hpdev.nr = MLXPLAT_CPLD_NR_NONE,\n\t},\n};\n\nstatic struct mlxreg_core_data mlxplat_mlxcpld_default_ng_pwr_items_data[] = {\n\t{\n\t\t.label = \"pwr1\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_PWR_OFFSET,\n\t\t.mask = BIT(0),\n\t\t.hpdev.brdinfo = &mlxplat_mlxcpld_pwr[0],\n\t\t.hpdev.nr = MLXPLAT_CPLD_PSU_MSNXXXX_NR,\n\t},\n\t{\n\t\t.label = \"pwr2\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_PWR_OFFSET,\n\t\t.mask = BIT(1),\n\t\t.hpdev.brdinfo = &mlxplat_mlxcpld_pwr[1],\n\t\t.hpdev.nr = MLXPLAT_CPLD_PSU_MSNXXXX_NR,\n\t},\n};\n\nstatic struct mlxreg_core_data mlxplat_mlxcpld_msn274x_fan_items_data[] = {\n\t{\n\t\t.label = \"fan1\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_FAN_OFFSET,\n\t\t.mask = BIT(0),\n\t\t.hpdev.nr = MLXPLAT_CPLD_NR_NONE,\n\t},\n\t{\n\t\t.label = \"fan2\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_FAN_OFFSET,\n\t\t.mask = BIT(1),\n\t\t.hpdev.nr = MLXPLAT_CPLD_NR_NONE,\n\t},\n\t{\n\t\t.label = \"fan3\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_FAN_OFFSET,\n\t\t.mask = BIT(2),\n\t\t.hpdev.nr = MLXPLAT_CPLD_NR_NONE,\n\t},\n\t{\n\t\t.label = \"fan4\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_FAN_OFFSET,\n\t\t.mask = BIT(3),\n\t\t.hpdev.nr = MLXPLAT_CPLD_NR_NONE,\n\t},\n};\n\nstatic struct mlxreg_core_item mlxplat_mlxcpld_msn274x_items[] = {\n\t{\n\t\t.data = mlxplat_mlxcpld_msn274x_psu_items_data,\n\t\t.aggr_mask = MLXPLAT_CPLD_AGGR_MASK_NG_DEF,\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_PSU_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_PSU_MASK,\n\t\t.count = ARRAY_SIZE(mlxplat_mlxcpld_msn274x_psu_items_data),\n\t\t.inversed = 1,\n\t\t.health = false,\n\t},\n\t{\n\t\t.data = mlxplat_mlxcpld_default_ng_pwr_items_data,\n\t\t.aggr_mask = MLXPLAT_CPLD_AGGR_MASK_NG_DEF,\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_PWR_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_PWR_MASK,\n\t\t.count = ARRAY_SIZE(mlxplat_mlxcpld_default_ng_pwr_items_data),\n\t\t.inversed = 0,\n\t\t.health = false,\n\t},\n\t{\n\t\t.data = mlxplat_mlxcpld_msn274x_fan_items_data,\n\t\t.aggr_mask = MLXPLAT_CPLD_AGGR_MASK_NG_DEF,\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_FAN_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_FAN_MASK,\n\t\t.count = ARRAY_SIZE(mlxplat_mlxcpld_msn274x_fan_items_data),\n\t\t.inversed = 1,\n\t\t.health = false,\n\t},\n\t{\n\t\t.data = mlxplat_mlxcpld_default_asic_items_data,\n\t\t.aggr_mask = MLXPLAT_CPLD_AGGR_MASK_NG_DEF,\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_ASIC_HEALTH_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_ASIC_MASK,\n\t\t.count = ARRAY_SIZE(mlxplat_mlxcpld_default_asic_items_data),\n\t\t.inversed = 0,\n\t\t.health = true,\n\t},\n};\n\nstatic\nstruct mlxreg_core_hotplug_platform_data mlxplat_mlxcpld_msn274x_data = {\n\t.items = mlxplat_mlxcpld_msn274x_items,\n\t.counter = ARRAY_SIZE(mlxplat_mlxcpld_msn274x_items),\n\t.cell = MLXPLAT_CPLD_LPC_REG_AGGR_OFFSET,\n\t.mask = MLXPLAT_CPLD_AGGR_MASK_NG_DEF,\n\t.cell_low = MLXPLAT_CPLD_LPC_REG_AGGRLO_OFFSET,\n\t.mask_low = MLXPLAT_CPLD_LOW_AGGR_MASK_LOW,\n};\n\n \nstatic struct mlxreg_core_data mlxplat_mlxcpld_msn201x_pwr_items_data[] = {\n\t{\n\t\t.label = \"pwr1\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_PWR_OFFSET,\n\t\t.mask = BIT(0),\n\t\t.hpdev.nr = MLXPLAT_CPLD_NR_NONE,\n\t},\n\t{\n\t\t.label = \"pwr2\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_PWR_OFFSET,\n\t\t.mask = BIT(1),\n\t\t.hpdev.nr = MLXPLAT_CPLD_NR_NONE,\n\t},\n};\n\nstatic struct mlxreg_core_item mlxplat_mlxcpld_msn201x_items[] = {\n\t{\n\t\t.data = mlxplat_mlxcpld_msn201x_pwr_items_data,\n\t\t.aggr_mask = MLXPLAT_CPLD_AGGR_PWR_MASK_DEF,\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_PWR_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_PWR_MASK,\n\t\t.count = ARRAY_SIZE(mlxplat_mlxcpld_msn201x_pwr_items_data),\n\t\t.inversed = 0,\n\t\t.health = false,\n\t},\n\t{\n\t\t.data = mlxplat_mlxcpld_default_asic_items_data,\n\t\t.aggr_mask = MLXPLAT_CPLD_AGGR_ASIC_MASK_DEF,\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_ASIC_HEALTH_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_ASIC_MASK,\n\t\t.count = ARRAY_SIZE(mlxplat_mlxcpld_default_asic_items_data),\n\t\t.inversed = 0,\n\t\t.health = true,\n\t},\n};\n\nstatic\nstruct mlxreg_core_hotplug_platform_data mlxplat_mlxcpld_msn201x_data = {\n\t.items = mlxplat_mlxcpld_msn201x_items,\n\t.counter = ARRAY_SIZE(mlxplat_mlxcpld_msn201x_items),\n\t.cell = MLXPLAT_CPLD_LPC_REG_AGGR_OFFSET,\n\t.mask = MLXPLAT_CPLD_AGGR_MASK_DEF,\n\t.cell_low = MLXPLAT_CPLD_LPC_REG_AGGRLO_OFFSET,\n\t.mask_low = MLXPLAT_CPLD_LOW_AGGR_MASK_LOW,\n};\n\n \nstatic struct mlxreg_core_data mlxplat_mlxcpld_default_ng_psu_items_data[] = {\n\t{\n\t\t.label = \"psu1\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_PSU_OFFSET,\n\t\t.mask = BIT(0),\n\t\t.hpdev.nr = MLXPLAT_CPLD_NR_NONE,\n\t},\n\t{\n\t\t.label = \"psu2\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_PSU_OFFSET,\n\t\t.mask = BIT(1),\n\t\t.hpdev.nr = MLXPLAT_CPLD_NR_NONE,\n\t},\n};\n\nstatic struct mlxreg_core_data mlxplat_mlxcpld_default_ng_fan_items_data[] = {\n\t{\n\t\t.label = \"fan1\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_FAN_OFFSET,\n\t\t.mask = BIT(0),\n\t\t.capability = MLXPLAT_CPLD_LPC_REG_FAN_DRW_CAP_OFFSET,\n\t\t.bit = BIT(0),\n\t\t.hpdev.nr = MLXPLAT_CPLD_NR_NONE,\n\t},\n\t{\n\t\t.label = \"fan2\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_FAN_OFFSET,\n\t\t.mask = BIT(1),\n\t\t.capability = MLXPLAT_CPLD_LPC_REG_FAN_DRW_CAP_OFFSET,\n\t\t.bit = BIT(1),\n\t\t.hpdev.nr = MLXPLAT_CPLD_NR_NONE,\n\t},\n\t{\n\t\t.label = \"fan3\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_FAN_OFFSET,\n\t\t.mask = BIT(2),\n\t\t.capability = MLXPLAT_CPLD_LPC_REG_FAN_DRW_CAP_OFFSET,\n\t\t.bit = BIT(2),\n\t\t.hpdev.nr = MLXPLAT_CPLD_NR_NONE,\n\t},\n\t{\n\t\t.label = \"fan4\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_FAN_OFFSET,\n\t\t.mask = BIT(3),\n\t\t.capability = MLXPLAT_CPLD_LPC_REG_FAN_DRW_CAP_OFFSET,\n\t\t.bit = BIT(3),\n\t\t.hpdev.nr = MLXPLAT_CPLD_NR_NONE,\n\t},\n\t{\n\t\t.label = \"fan5\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_FAN_OFFSET,\n\t\t.mask = BIT(4),\n\t\t.capability = MLXPLAT_CPLD_LPC_REG_FAN_DRW_CAP_OFFSET,\n\t\t.bit = BIT(4),\n\t\t.hpdev.nr = MLXPLAT_CPLD_NR_NONE,\n\t},\n\t{\n\t\t.label = \"fan6\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_FAN_OFFSET,\n\t\t.mask = BIT(5),\n\t\t.capability = MLXPLAT_CPLD_LPC_REG_FAN_DRW_CAP_OFFSET,\n\t\t.bit = BIT(5),\n\t\t.hpdev.nr = MLXPLAT_CPLD_NR_NONE,\n\t},\n\t{\n\t\t.label = \"fan7\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_FAN_OFFSET,\n\t\t.mask = BIT(6),\n\t\t.capability = MLXPLAT_CPLD_LPC_REG_FAN_DRW_CAP_OFFSET,\n\t\t.bit = BIT(6),\n\t\t.hpdev.nr = MLXPLAT_CPLD_NR_NONE,\n\t},\n};\n\nstatic struct mlxreg_core_item mlxplat_mlxcpld_default_ng_items[] = {\n\t{\n\t\t.data = mlxplat_mlxcpld_default_ng_psu_items_data,\n\t\t.aggr_mask = MLXPLAT_CPLD_AGGR_MASK_NG_DEF,\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_PSU_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_PSU_MASK,\n\t\t.count = ARRAY_SIZE(mlxplat_mlxcpld_default_ng_psu_items_data),\n\t\t.inversed = 1,\n\t\t.health = false,\n\t},\n\t{\n\t\t.data = mlxplat_mlxcpld_default_ng_pwr_items_data,\n\t\t.aggr_mask = MLXPLAT_CPLD_AGGR_MASK_NG_DEF,\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_PWR_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_PWR_MASK,\n\t\t.count = ARRAY_SIZE(mlxplat_mlxcpld_default_ng_pwr_items_data),\n\t\t.inversed = 0,\n\t\t.health = false,\n\t},\n\t{\n\t\t.data = mlxplat_mlxcpld_default_ng_fan_items_data,\n\t\t.aggr_mask = MLXPLAT_CPLD_AGGR_MASK_NG_DEF,\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_FAN_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_FAN_NG_MASK,\n\t\t.count = ARRAY_SIZE(mlxplat_mlxcpld_default_ng_fan_items_data),\n\t\t.inversed = 1,\n\t\t.health = false,\n\t},\n\t{\n\t\t.data = mlxplat_mlxcpld_default_asic_items_data,\n\t\t.aggr_mask = MLXPLAT_CPLD_AGGR_MASK_NG_DEF,\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_ASIC_HEALTH_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_ASIC_MASK,\n\t\t.count = ARRAY_SIZE(mlxplat_mlxcpld_default_asic_items_data),\n\t\t.inversed = 0,\n\t\t.health = true,\n\t},\n};\n\nstatic\nstruct mlxreg_core_hotplug_platform_data mlxplat_mlxcpld_default_ng_data = {\n\t.items = mlxplat_mlxcpld_default_ng_items,\n\t.counter = ARRAY_SIZE(mlxplat_mlxcpld_default_ng_items),\n\t.cell = MLXPLAT_CPLD_LPC_REG_AGGR_OFFSET,\n\t.mask = MLXPLAT_CPLD_AGGR_MASK_NG_DEF | MLXPLAT_CPLD_AGGR_MASK_COMEX,\n\t.cell_low = MLXPLAT_CPLD_LPC_REG_AGGRLO_OFFSET,\n\t.mask_low = MLXPLAT_CPLD_LOW_AGGR_MASK_LOW,\n};\n\n \nstatic struct mlxreg_core_data mlxplat_mlxcpld_ext_psu_items_data[] = {\n\t{\n\t\t.label = \"psu1\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_PSU_OFFSET,\n\t\t.mask = BIT(0),\n\t\t.hpdev.nr = MLXPLAT_CPLD_NR_NONE,\n\t},\n\t{\n\t\t.label = \"psu2\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_PSU_OFFSET,\n\t\t.mask = BIT(1),\n\t\t.hpdev.nr = MLXPLAT_CPLD_NR_NONE,\n\t},\n\t{\n\t\t.label = \"psu3\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_PSU_OFFSET,\n\t\t.mask = BIT(2),\n\t\t.hpdev.nr = MLXPLAT_CPLD_NR_NONE,\n\t},\n\t{\n\t\t.label = \"psu4\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_PSU_OFFSET,\n\t\t.mask = BIT(3),\n\t\t.hpdev.nr = MLXPLAT_CPLD_NR_NONE,\n\t},\n};\n\nstatic struct mlxreg_core_data mlxplat_mlxcpld_ext_pwr_items_data[] = {\n\t{\n\t\t.label = \"pwr1\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_PWR_OFFSET,\n\t\t.mask = BIT(0),\n\t\t.hpdev.brdinfo = &mlxplat_mlxcpld_pwr[0],\n\t\t.hpdev.nr = MLXPLAT_CPLD_PSU_MSNXXXX_NR,\n\t},\n\t{\n\t\t.label = \"pwr2\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_PWR_OFFSET,\n\t\t.mask = BIT(1),\n\t\t.hpdev.brdinfo = &mlxplat_mlxcpld_pwr[1],\n\t\t.hpdev.nr = MLXPLAT_CPLD_PSU_MSNXXXX_NR,\n\t},\n\t{\n\t\t.label = \"pwr3\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_PWR_OFFSET,\n\t\t.mask = BIT(2),\n\t\t.hpdev.brdinfo = &mlxplat_mlxcpld_ext_pwr[0],\n\t\t.hpdev.nr = MLXPLAT_CPLD_PSU_MSNXXXX_NR,\n\t},\n\t{\n\t\t.label = \"pwr4\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_PWR_OFFSET,\n\t\t.mask = BIT(3),\n\t\t.hpdev.brdinfo = &mlxplat_mlxcpld_ext_pwr[1],\n\t\t.hpdev.nr = MLXPLAT_CPLD_PSU_MSNXXXX_NR,\n\t},\n};\n\nstatic struct mlxreg_core_item mlxplat_mlxcpld_ext_items[] = {\n\t{\n\t\t.data = mlxplat_mlxcpld_ext_psu_items_data,\n\t\t.aggr_mask = MLXPLAT_CPLD_AGGR_MASK_NG_DEF,\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_PSU_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_PSU_EXT_MASK,\n\t\t.capability = MLXPLAT_CPLD_LPC_REG_PSU_I2C_CAP_OFFSET,\n\t\t.count = ARRAY_SIZE(mlxplat_mlxcpld_ext_psu_items_data),\n\t\t.inversed = 1,\n\t\t.health = false,\n\t},\n\t{\n\t\t.data = mlxplat_mlxcpld_ext_pwr_items_data,\n\t\t.aggr_mask = MLXPLAT_CPLD_AGGR_MASK_NG_DEF,\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_PWR_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_PWR_EXT_MASK,\n\t\t.capability = MLXPLAT_CPLD_LPC_REG_PSU_I2C_CAP_OFFSET,\n\t\t.count = ARRAY_SIZE(mlxplat_mlxcpld_ext_pwr_items_data),\n\t\t.inversed = 0,\n\t\t.health = false,\n\t},\n\t{\n\t\t.data = mlxplat_mlxcpld_default_ng_fan_items_data,\n\t\t.aggr_mask = MLXPLAT_CPLD_AGGR_MASK_NG_DEF,\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_FAN_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_FAN_NG_MASK,\n\t\t.count = ARRAY_SIZE(mlxplat_mlxcpld_default_ng_fan_items_data),\n\t\t.inversed = 1,\n\t\t.health = false,\n\t},\n\t{\n\t\t.data = mlxplat_mlxcpld_default_asic_items_data,\n\t\t.aggr_mask = MLXPLAT_CPLD_AGGR_MASK_NG_DEF,\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_ASIC_HEALTH_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_ASIC_MASK,\n\t\t.count = ARRAY_SIZE(mlxplat_mlxcpld_default_asic_items_data),\n\t\t.inversed = 0,\n\t\t.health = true,\n\t},\n\t{\n\t\t.data = mlxplat_mlxcpld_default_asic2_items_data,\n\t\t.aggr_mask = MLXPLAT_CPLD_AGGR_MASK_NG_DEF,\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_ASIC2_HEALTH_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_ASIC_MASK,\n\t\t.count = ARRAY_SIZE(mlxplat_mlxcpld_default_asic2_items_data),\n\t\t.inversed = 0,\n\t\t.health = true,\n\t}\n};\n\nstatic struct mlxreg_core_item mlxplat_mlxcpld_ng800_items[] = {\n\t{\n\t\t.data = mlxplat_mlxcpld_default_ng_psu_items_data,\n\t\t.aggr_mask = MLXPLAT_CPLD_AGGR_MASK_NG_DEF,\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_PSU_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_PSU_EXT_MASK,\n\t\t.capability = MLXPLAT_CPLD_LPC_REG_PSU_I2C_CAP_OFFSET,\n\t\t.count = ARRAY_SIZE(mlxplat_mlxcpld_default_ng_psu_items_data),\n\t\t.inversed = 1,\n\t\t.health = false,\n\t},\n\t{\n\t\t.data = mlxplat_mlxcpld_default_pwr_ng800_items_data,\n\t\t.aggr_mask = MLXPLAT_CPLD_AGGR_MASK_NG_DEF,\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_PWR_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_PWR_EXT_MASK,\n\t\t.capability = MLXPLAT_CPLD_LPC_REG_PSU_I2C_CAP_OFFSET,\n\t\t.count = ARRAY_SIZE(mlxplat_mlxcpld_default_pwr_ng800_items_data),\n\t\t.inversed = 0,\n\t\t.health = false,\n\t},\n\t{\n\t\t.data = mlxplat_mlxcpld_default_ng_fan_items_data,\n\t\t.aggr_mask = MLXPLAT_CPLD_AGGR_MASK_NG_DEF,\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_FAN_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_FAN_NG_MASK,\n\t\t.count = ARRAY_SIZE(mlxplat_mlxcpld_default_ng_fan_items_data),\n\t\t.inversed = 1,\n\t\t.health = false,\n\t},\n\t{\n\t\t.data = mlxplat_mlxcpld_default_asic_items_data,\n\t\t.aggr_mask = MLXPLAT_CPLD_AGGR_MASK_NG_DEF,\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_ASIC_HEALTH_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_ASIC_MASK,\n\t\t.count = ARRAY_SIZE(mlxplat_mlxcpld_default_asic_items_data),\n\t\t.inversed = 0,\n\t\t.health = true,\n\t},\n};\n\nstatic\nstruct mlxreg_core_hotplug_platform_data mlxplat_mlxcpld_ext_data = {\n\t.items = mlxplat_mlxcpld_ext_items,\n\t.counter = ARRAY_SIZE(mlxplat_mlxcpld_ext_items),\n\t.cell = MLXPLAT_CPLD_LPC_REG_AGGR_OFFSET,\n\t.mask = MLXPLAT_CPLD_AGGR_MASK_NG_DEF | MLXPLAT_CPLD_AGGR_MASK_COMEX,\n\t.cell_low = MLXPLAT_CPLD_LPC_REG_AGGRLO_OFFSET,\n\t.mask_low = MLXPLAT_CPLD_LOW_AGGR_MASK_LOW | MLXPLAT_CPLD_LOW_AGGR_MASK_ASIC2,\n};\n\nstatic\nstruct mlxreg_core_hotplug_platform_data mlxplat_mlxcpld_ng800_data = {\n\t.items = mlxplat_mlxcpld_ng800_items,\n\t.counter = ARRAY_SIZE(mlxplat_mlxcpld_ng800_items),\n\t.cell = MLXPLAT_CPLD_LPC_REG_AGGR_OFFSET,\n\t.mask = MLXPLAT_CPLD_AGGR_MASK_NG_DEF | MLXPLAT_CPLD_AGGR_MASK_COMEX,\n\t.cell_low = MLXPLAT_CPLD_LPC_REG_AGGRLO_OFFSET,\n\t.mask_low = MLXPLAT_CPLD_LOW_AGGR_MASK_LOW | MLXPLAT_CPLD_LOW_AGGR_MASK_ASIC2,\n};\n\nstatic struct mlxreg_core_data mlxplat_mlxcpld_modular_pwr_items_data[] = {\n\t{\n\t\t.label = \"pwr1\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_PWR_OFFSET,\n\t\t.mask = BIT(0),\n\t\t.hpdev.brdinfo = &mlxplat_mlxcpld_pwr[0],\n\t\t.hpdev.nr = MLXPLAT_CPLD_PSU_MSNXXXX_NR,\n\t},\n\t{\n\t\t.label = \"pwr2\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_PWR_OFFSET,\n\t\t.mask = BIT(1),\n\t\t.hpdev.brdinfo = &mlxplat_mlxcpld_pwr[1],\n\t\t.hpdev.nr = MLXPLAT_CPLD_PSU_MSNXXXX_NR,\n\t},\n\t{\n\t\t.label = \"pwr3\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_PWR_OFFSET,\n\t\t.mask = BIT(2),\n\t\t.hpdev.brdinfo = &mlxplat_mlxcpld_ext_pwr[0],\n\t\t.hpdev.nr = MLXPLAT_CPLD_PSU_MSNXXXX_NR,\n\t},\n\t{\n\t\t.label = \"pwr4\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_PWR_OFFSET,\n\t\t.mask = BIT(3),\n\t\t.hpdev.brdinfo = &mlxplat_mlxcpld_ext_pwr[1],\n\t\t.hpdev.nr = MLXPLAT_CPLD_PSU_MSNXXXX_NR,\n\t},\n};\n\nstatic\nstruct mlxreg_core_hotplug_platform_data mlxplat_mlxcpld_lc_act = {\n\t.irq = MLXPLAT_CPLD_LPC_SYSIRQ,\n};\n\nstatic struct mlxreg_core_data mlxplat_mlxcpld_modular_asic_items_data[] = {\n\t{\n\t\t.label = \"asic1\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_ASIC_HEALTH_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_ASIC_MASK,\n\t\t.hpdev.nr = MLXPLAT_CPLD_NR_NONE,\n\t},\n};\n\nstatic struct i2c_board_info mlxplat_mlxcpld_lc_i2c_dev[] = {\n\t{\n\t\tI2C_BOARD_INFO(\"mlxreg-lc\", MLXPLAT_CPLD_LC_ADDR),\n\t\t.platform_data = &mlxplat_mlxcpld_lc_act,\n\t},\n\t{\n\t\tI2C_BOARD_INFO(\"mlxreg-lc\", MLXPLAT_CPLD_LC_ADDR),\n\t\t.platform_data = &mlxplat_mlxcpld_lc_act,\n\t},\n\t{\n\t\tI2C_BOARD_INFO(\"mlxreg-lc\", MLXPLAT_CPLD_LC_ADDR),\n\t\t.platform_data = &mlxplat_mlxcpld_lc_act,\n\t},\n\t{\n\t\tI2C_BOARD_INFO(\"mlxreg-lc\", MLXPLAT_CPLD_LC_ADDR),\n\t\t.platform_data = &mlxplat_mlxcpld_lc_act,\n\t},\n\t{\n\t\tI2C_BOARD_INFO(\"mlxreg-lc\", MLXPLAT_CPLD_LC_ADDR),\n\t\t.platform_data = &mlxplat_mlxcpld_lc_act,\n\t},\n\t{\n\t\tI2C_BOARD_INFO(\"mlxreg-lc\", MLXPLAT_CPLD_LC_ADDR),\n\t\t.platform_data = &mlxplat_mlxcpld_lc_act,\n\t},\n\t{\n\t\tI2C_BOARD_INFO(\"mlxreg-lc\", MLXPLAT_CPLD_LC_ADDR),\n\t\t.platform_data = &mlxplat_mlxcpld_lc_act,\n\t},\n\t{\n\t\tI2C_BOARD_INFO(\"mlxreg-lc\", MLXPLAT_CPLD_LC_ADDR),\n\t\t.platform_data = &mlxplat_mlxcpld_lc_act,\n\t},\n};\n\nstatic struct mlxreg_core_hotplug_notifier mlxplat_mlxcpld_modular_lc_notifier[] = {\n\t{\n\t\t.identity = \"lc1\",\n\t},\n\t{\n\t\t.identity = \"lc2\",\n\t},\n\t{\n\t\t.identity = \"lc3\",\n\t},\n\t{\n\t\t.identity = \"lc4\",\n\t},\n\t{\n\t\t.identity = \"lc5\",\n\t},\n\t{\n\t\t.identity = \"lc6\",\n\t},\n\t{\n\t\t.identity = \"lc7\",\n\t},\n\t{\n\t\t.identity = \"lc8\",\n\t},\n};\n\nstatic struct mlxreg_core_data mlxplat_mlxcpld_modular_lc_pr_items_data[] = {\n\t{\n\t\t.label = \"lc1_present\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LC_IN_OFFSET,\n\t\t.mask = BIT(0),\n\t\t.hpdev.brdinfo = &mlxplat_mlxcpld_lc_i2c_dev[0],\n\t\t.hpdev.nr = MLXPLAT_CPLD_NR_LC_SET(0),\n\t\t.hpdev.action = MLXREG_HOTPLUG_DEVICE_NO_ACTION,\n\t\t.hpdev.notifier = &mlxplat_mlxcpld_modular_lc_notifier[0],\n\t\t.slot = 1,\n\t},\n\t{\n\t\t.label = \"lc2_present\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LC_IN_OFFSET,\n\t\t.mask = BIT(1),\n\t\t.hpdev.brdinfo = &mlxplat_mlxcpld_lc_i2c_dev[1],\n\t\t.hpdev.nr = MLXPLAT_CPLD_NR_LC_SET(1),\n\t\t.hpdev.action = MLXREG_HOTPLUG_DEVICE_NO_ACTION,\n\t\t.hpdev.notifier = &mlxplat_mlxcpld_modular_lc_notifier[1],\n\t\t.slot = 2,\n\t},\n\t{\n\t\t.label = \"lc3_present\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LC_IN_OFFSET,\n\t\t.mask = BIT(2),\n\t\t.hpdev.brdinfo = &mlxplat_mlxcpld_lc_i2c_dev[2],\n\t\t.hpdev.nr = MLXPLAT_CPLD_NR_LC_SET(2),\n\t\t.hpdev.action = MLXREG_HOTPLUG_DEVICE_NO_ACTION,\n\t\t.hpdev.notifier = &mlxplat_mlxcpld_modular_lc_notifier[2],\n\t\t.slot = 3,\n\t},\n\t{\n\t\t.label = \"lc4_present\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LC_IN_OFFSET,\n\t\t.mask = BIT(3),\n\t\t.hpdev.brdinfo = &mlxplat_mlxcpld_lc_i2c_dev[3],\n\t\t.hpdev.nr = MLXPLAT_CPLD_NR_LC_SET(3),\n\t\t.hpdev.action = MLXREG_HOTPLUG_DEVICE_NO_ACTION,\n\t\t.hpdev.notifier = &mlxplat_mlxcpld_modular_lc_notifier[3],\n\t\t.slot = 4,\n\t},\n\t{\n\t\t.label = \"lc5_present\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LC_IN_OFFSET,\n\t\t.mask = BIT(4),\n\t\t.hpdev.brdinfo = &mlxplat_mlxcpld_lc_i2c_dev[4],\n\t\t.hpdev.nr = MLXPLAT_CPLD_NR_LC_SET(4),\n\t\t.hpdev.action = MLXREG_HOTPLUG_DEVICE_NO_ACTION,\n\t\t.hpdev.notifier = &mlxplat_mlxcpld_modular_lc_notifier[4],\n\t\t.slot = 5,\n\t},\n\t{\n\t\t.label = \"lc6_present\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LC_IN_OFFSET,\n\t\t.mask = BIT(5),\n\t\t.hpdev.brdinfo = &mlxplat_mlxcpld_lc_i2c_dev[5],\n\t\t.hpdev.nr = MLXPLAT_CPLD_NR_LC_SET(5),\n\t\t.hpdev.action = MLXREG_HOTPLUG_DEVICE_NO_ACTION,\n\t\t.hpdev.notifier = &mlxplat_mlxcpld_modular_lc_notifier[5],\n\t\t.slot = 6,\n\t},\n\t{\n\t\t.label = \"lc7_present\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LC_IN_OFFSET,\n\t\t.mask = BIT(6),\n\t\t.hpdev.brdinfo = &mlxplat_mlxcpld_lc_i2c_dev[6],\n\t\t.hpdev.nr = MLXPLAT_CPLD_NR_LC_SET(6),\n\t\t.hpdev.action = MLXREG_HOTPLUG_DEVICE_NO_ACTION,\n\t\t.hpdev.notifier = &mlxplat_mlxcpld_modular_lc_notifier[6],\n\t\t.slot = 7,\n\t},\n\t{\n\t\t.label = \"lc8_present\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LC_IN_OFFSET,\n\t\t.mask = BIT(7),\n\t\t.hpdev.brdinfo = &mlxplat_mlxcpld_lc_i2c_dev[7],\n\t\t.hpdev.nr = MLXPLAT_CPLD_NR_LC_SET(7),\n\t\t.hpdev.action = MLXREG_HOTPLUG_DEVICE_NO_ACTION,\n\t\t.hpdev.notifier = &mlxplat_mlxcpld_modular_lc_notifier[7],\n\t\t.slot = 8,\n\t},\n};\n\nstatic struct mlxreg_core_data mlxplat_mlxcpld_modular_lc_ver_items_data[] = {\n\t{\n\t\t.label = \"lc1_verified\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LC_VR_OFFSET,\n\t\t.mask = BIT(0),\n\t\t.reg_prsnt = MLXPLAT_CPLD_LPC_REG_LC_PG_OFFSET,\n\t\t.reg_sync = MLXPLAT_CPLD_LPC_REG_LC_SN_OFFSET,\n\t\t.reg_pwr = MLXPLAT_CPLD_LPC_REG_LC_PWR_ON,\n\t\t.reg_ena = MLXPLAT_CPLD_LPC_REG_RESET_GP4_OFFSET,\n\t\t.hpdev.brdinfo = &mlxplat_mlxcpld_lc_i2c_dev[0],\n\t\t.hpdev.nr = MLXPLAT_CPLD_NR_LC_SET(0),\n\t\t.hpdev.action = MLXREG_HOTPLUG_DEVICE_PLATFORM_ACTION,\n\t\t.hpdev.notifier = &mlxplat_mlxcpld_modular_lc_notifier[0],\n\t\t.slot = 1,\n\t},\n\t{\n\t\t.label = \"lc2_verified\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LC_VR_OFFSET,\n\t\t.mask = BIT(1),\n\t\t.reg_prsnt = MLXPLAT_CPLD_LPC_REG_LC_PG_OFFSET,\n\t\t.reg_sync = MLXPLAT_CPLD_LPC_REG_LC_SN_OFFSET,\n\t\t.reg_pwr = MLXPLAT_CPLD_LPC_REG_LC_PWR_ON,\n\t\t.reg_ena = MLXPLAT_CPLD_LPC_REG_RESET_GP4_OFFSET,\n\t\t.hpdev.brdinfo = &mlxplat_mlxcpld_lc_i2c_dev[1],\n\t\t.hpdev.nr = MLXPLAT_CPLD_NR_LC_SET(1),\n\t\t.hpdev.action = MLXREG_HOTPLUG_DEVICE_PLATFORM_ACTION,\n\t\t.hpdev.notifier = &mlxplat_mlxcpld_modular_lc_notifier[1],\n\t\t.slot = 2,\n\t},\n\t{\n\t\t.label = \"lc3_verified\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LC_VR_OFFSET,\n\t\t.mask = BIT(2),\n\t\t.reg_prsnt = MLXPLAT_CPLD_LPC_REG_LC_PG_OFFSET,\n\t\t.reg_sync = MLXPLAT_CPLD_LPC_REG_LC_SN_OFFSET,\n\t\t.reg_pwr = MLXPLAT_CPLD_LPC_REG_LC_PWR_ON,\n\t\t.reg_ena = MLXPLAT_CPLD_LPC_REG_RESET_GP4_OFFSET,\n\t\t.hpdev.brdinfo = &mlxplat_mlxcpld_lc_i2c_dev[2],\n\t\t.hpdev.nr = MLXPLAT_CPLD_NR_LC_SET(2),\n\t\t.hpdev.action = MLXREG_HOTPLUG_DEVICE_PLATFORM_ACTION,\n\t\t.hpdev.notifier = &mlxplat_mlxcpld_modular_lc_notifier[2],\n\t\t.slot = 3,\n\t},\n\t{\n\t\t.label = \"lc4_verified\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LC_VR_OFFSET,\n\t\t.mask = BIT(3),\n\t\t.reg_prsnt = MLXPLAT_CPLD_LPC_REG_LC_PG_OFFSET,\n\t\t.reg_sync = MLXPLAT_CPLD_LPC_REG_LC_SN_OFFSET,\n\t\t.reg_pwr = MLXPLAT_CPLD_LPC_REG_LC_PWR_ON,\n\t\t.reg_ena = MLXPLAT_CPLD_LPC_REG_RESET_GP4_OFFSET,\n\t\t.hpdev.brdinfo = &mlxplat_mlxcpld_lc_i2c_dev[3],\n\t\t.hpdev.nr = MLXPLAT_CPLD_NR_LC_SET(3),\n\t\t.hpdev.action = MLXREG_HOTPLUG_DEVICE_PLATFORM_ACTION,\n\t\t.hpdev.notifier = &mlxplat_mlxcpld_modular_lc_notifier[3],\n\t\t.slot = 4,\n\t},\n\t{\n\t\t.label = \"lc5_verified\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LC_VR_OFFSET,\n\t\t.mask = BIT(4),\n\t\t.reg_prsnt = MLXPLAT_CPLD_LPC_REG_LC_PG_OFFSET,\n\t\t.reg_sync = MLXPLAT_CPLD_LPC_REG_LC_SN_OFFSET,\n\t\t.reg_pwr = MLXPLAT_CPLD_LPC_REG_LC_PWR_ON,\n\t\t.reg_ena = MLXPLAT_CPLD_LPC_REG_RESET_GP4_OFFSET,\n\t\t.hpdev.brdinfo = &mlxplat_mlxcpld_lc_i2c_dev[4],\n\t\t.hpdev.nr = MLXPLAT_CPLD_NR_LC_SET(4),\n\t\t.hpdev.action = MLXREG_HOTPLUG_DEVICE_PLATFORM_ACTION,\n\t\t.hpdev.notifier = &mlxplat_mlxcpld_modular_lc_notifier[4],\n\t\t.slot = 5,\n\t},\n\t{\n\t\t.label = \"lc6_verified\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LC_VR_OFFSET,\n\t\t.mask = BIT(5),\n\t\t.reg_prsnt = MLXPLAT_CPLD_LPC_REG_LC_PG_OFFSET,\n\t\t.reg_sync = MLXPLAT_CPLD_LPC_REG_LC_SN_OFFSET,\n\t\t.reg_pwr = MLXPLAT_CPLD_LPC_REG_LC_PWR_ON,\n\t\t.reg_ena = MLXPLAT_CPLD_LPC_REG_RESET_GP4_OFFSET,\n\t\t.hpdev.brdinfo = &mlxplat_mlxcpld_lc_i2c_dev[5],\n\t\t.hpdev.nr = MLXPLAT_CPLD_NR_LC_SET(5),\n\t\t.hpdev.action = MLXREG_HOTPLUG_DEVICE_PLATFORM_ACTION,\n\t\t.hpdev.notifier = &mlxplat_mlxcpld_modular_lc_notifier[5],\n\t\t.slot = 6,\n\t},\n\t{\n\t\t.label = \"lc7_verified\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LC_VR_OFFSET,\n\t\t.mask = BIT(6),\n\t\t.reg_prsnt = MLXPLAT_CPLD_LPC_REG_LC_PG_OFFSET,\n\t\t.reg_sync = MLXPLAT_CPLD_LPC_REG_LC_SN_OFFSET,\n\t\t.reg_pwr = MLXPLAT_CPLD_LPC_REG_LC_PWR_ON,\n\t\t.reg_ena = MLXPLAT_CPLD_LPC_REG_RESET_GP4_OFFSET,\n\t\t.hpdev.brdinfo = &mlxplat_mlxcpld_lc_i2c_dev[6],\n\t\t.hpdev.nr = MLXPLAT_CPLD_NR_LC_SET(6),\n\t\t.hpdev.action = MLXREG_HOTPLUG_DEVICE_PLATFORM_ACTION,\n\t\t.hpdev.notifier = &mlxplat_mlxcpld_modular_lc_notifier[6],\n\t\t.slot = 7,\n\t},\n\t{\n\t\t.label = \"lc8_verified\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LC_VR_OFFSET,\n\t\t.mask = BIT(7),\n\t\t.reg_prsnt = MLXPLAT_CPLD_LPC_REG_LC_PG_OFFSET,\n\t\t.reg_sync = MLXPLAT_CPLD_LPC_REG_LC_SN_OFFSET,\n\t\t.reg_pwr = MLXPLAT_CPLD_LPC_REG_LC_PWR_ON,\n\t\t.reg_ena = MLXPLAT_CPLD_LPC_REG_RESET_GP4_OFFSET,\n\t\t.hpdev.brdinfo = &mlxplat_mlxcpld_lc_i2c_dev[7],\n\t\t.hpdev.nr = MLXPLAT_CPLD_NR_LC_SET(7),\n\t\t.hpdev.action = MLXREG_HOTPLUG_DEVICE_PLATFORM_ACTION,\n\t\t.hpdev.notifier = &mlxplat_mlxcpld_modular_lc_notifier[7],\n\t\t.slot = 8,\n\t},\n};\n\nstatic struct mlxreg_core_data mlxplat_mlxcpld_modular_lc_pg_data[] = {\n\t{\n\t\t.label = \"lc1_powered\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LC_PG_OFFSET,\n\t\t.mask = BIT(0),\n\t\t.hpdev.brdinfo = &mlxplat_mlxcpld_lc_i2c_dev[0],\n\t\t.hpdev.nr = MLXPLAT_CPLD_NR_LC_SET(0),\n\t\t.hpdev.action = MLXREG_HOTPLUG_DEVICE_NO_ACTION,\n\t\t.hpdev.notifier = &mlxplat_mlxcpld_modular_lc_notifier[0],\n\t\t.slot = 1,\n\t},\n\t{\n\t\t.label = \"lc2_powered\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LC_PG_OFFSET,\n\t\t.mask = BIT(1),\n\t\t.hpdev.brdinfo = &mlxplat_mlxcpld_lc_i2c_dev[1],\n\t\t.hpdev.nr = MLXPLAT_CPLD_NR_LC_SET(1),\n\t\t.hpdev.action = MLXREG_HOTPLUG_DEVICE_NO_ACTION,\n\t\t.hpdev.notifier = &mlxplat_mlxcpld_modular_lc_notifier[1],\n\t\t.slot = 2,\n\t},\n\t{\n\t\t.label = \"lc3_powered\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LC_PG_OFFSET,\n\t\t.mask = BIT(2),\n\t\t.hpdev.brdinfo = &mlxplat_mlxcpld_lc_i2c_dev[2],\n\t\t.hpdev.nr = MLXPLAT_CPLD_NR_LC_SET(2),\n\t\t.hpdev.action = MLXREG_HOTPLUG_DEVICE_NO_ACTION,\n\t\t.hpdev.notifier = &mlxplat_mlxcpld_modular_lc_notifier[2],\n\t\t.slot = 3,\n\t},\n\t{\n\t\t.label = \"lc4_powered\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LC_PG_OFFSET,\n\t\t.mask = BIT(3),\n\t\t.hpdev.brdinfo = &mlxplat_mlxcpld_lc_i2c_dev[3],\n\t\t.hpdev.nr = MLXPLAT_CPLD_NR_LC_SET(3),\n\t\t.hpdev.action = MLXREG_HOTPLUG_DEVICE_NO_ACTION,\n\t\t.hpdev.notifier = &mlxplat_mlxcpld_modular_lc_notifier[3],\n\t\t.slot = 4,\n\t},\n\t{\n\t\t.label = \"lc5_powered\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LC_PG_OFFSET,\n\t\t.mask = BIT(4),\n\t\t.hpdev.brdinfo = &mlxplat_mlxcpld_lc_i2c_dev[4],\n\t\t.hpdev.nr = MLXPLAT_CPLD_NR_LC_SET(4),\n\t\t.hpdev.action = MLXREG_HOTPLUG_DEVICE_NO_ACTION,\n\t\t.hpdev.notifier = &mlxplat_mlxcpld_modular_lc_notifier[4],\n\t\t.slot = 5,\n\t},\n\t{\n\t\t.label = \"lc6_powered\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LC_PG_OFFSET,\n\t\t.mask = BIT(5),\n\t\t.hpdev.brdinfo = &mlxplat_mlxcpld_lc_i2c_dev[5],\n\t\t.hpdev.nr = MLXPLAT_CPLD_NR_LC_SET(5),\n\t\t.hpdev.action = MLXREG_HOTPLUG_DEVICE_NO_ACTION,\n\t\t.hpdev.notifier = &mlxplat_mlxcpld_modular_lc_notifier[5],\n\t\t.slot = 6,\n\t},\n\t{\n\t\t.label = \"lc7_powered\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LC_PG_OFFSET,\n\t\t.mask = BIT(6),\n\t\t.hpdev.brdinfo = &mlxplat_mlxcpld_lc_i2c_dev[6],\n\t\t.hpdev.nr = MLXPLAT_CPLD_NR_LC_SET(6),\n\t\t.hpdev.action = MLXREG_HOTPLUG_DEVICE_NO_ACTION,\n\t\t.hpdev.notifier = &mlxplat_mlxcpld_modular_lc_notifier[6],\n\t\t.slot = 7,\n\t},\n\t{\n\t\t.label = \"lc8_powered\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LC_PG_OFFSET,\n\t\t.mask = BIT(7),\n\t\t.hpdev.brdinfo = &mlxplat_mlxcpld_lc_i2c_dev[7],\n\t\t.hpdev.nr = MLXPLAT_CPLD_NR_LC_SET(7),\n\t\t.hpdev.action = MLXREG_HOTPLUG_DEVICE_NO_ACTION,\n\t\t.hpdev.notifier = &mlxplat_mlxcpld_modular_lc_notifier[7],\n\t\t.slot = 8,\n\t},\n};\n\nstatic struct mlxreg_core_data mlxplat_mlxcpld_modular_lc_ready_data[] = {\n\t{\n\t\t.label = \"lc1_ready\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LC_RD_OFFSET,\n\t\t.mask = BIT(0),\n\t\t.hpdev.brdinfo = &mlxplat_mlxcpld_lc_i2c_dev[0],\n\t\t.hpdev.nr = MLXPLAT_CPLD_NR_LC_SET(0),\n\t\t.hpdev.action = MLXREG_HOTPLUG_DEVICE_NO_ACTION,\n\t\t.hpdev.notifier = &mlxplat_mlxcpld_modular_lc_notifier[0],\n\t\t.slot = 1,\n\t},\n\t{\n\t\t.label = \"lc2_ready\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LC_RD_OFFSET,\n\t\t.mask = BIT(1),\n\t\t.hpdev.brdinfo = &mlxplat_mlxcpld_lc_i2c_dev[1],\n\t\t.hpdev.nr = MLXPLAT_CPLD_NR_LC_SET(1),\n\t\t.hpdev.action = MLXREG_HOTPLUG_DEVICE_NO_ACTION,\n\t\t.hpdev.notifier = &mlxplat_mlxcpld_modular_lc_notifier[1],\n\t\t.slot = 2,\n\t},\n\t{\n\t\t.label = \"lc3_ready\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LC_RD_OFFSET,\n\t\t.mask = BIT(2),\n\t\t.hpdev.brdinfo = &mlxplat_mlxcpld_lc_i2c_dev[2],\n\t\t.hpdev.nr = MLXPLAT_CPLD_NR_LC_SET(2),\n\t\t.hpdev.action = MLXREG_HOTPLUG_DEVICE_NO_ACTION,\n\t\t.hpdev.notifier = &mlxplat_mlxcpld_modular_lc_notifier[2],\n\t\t.slot = 3,\n\t},\n\t{\n\t\t.label = \"lc4_ready\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LC_RD_OFFSET,\n\t\t.mask = BIT(3),\n\t\t.hpdev.brdinfo = &mlxplat_mlxcpld_lc_i2c_dev[3],\n\t\t.hpdev.nr = MLXPLAT_CPLD_NR_LC_SET(3),\n\t\t.hpdev.action = MLXREG_HOTPLUG_DEVICE_NO_ACTION,\n\t\t.hpdev.notifier = &mlxplat_mlxcpld_modular_lc_notifier[3],\n\t\t.slot = 4,\n\t},\n\t{\n\t\t.label = \"lc5_ready\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LC_RD_OFFSET,\n\t\t.mask = BIT(4),\n\t\t.hpdev.brdinfo = &mlxplat_mlxcpld_lc_i2c_dev[4],\n\t\t.hpdev.nr = MLXPLAT_CPLD_NR_LC_SET(4),\n\t\t.hpdev.action = MLXREG_HOTPLUG_DEVICE_NO_ACTION,\n\t\t.hpdev.notifier = &mlxplat_mlxcpld_modular_lc_notifier[4],\n\t\t.slot = 5,\n\t},\n\t{\n\t\t.label = \"lc6_ready\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LC_RD_OFFSET,\n\t\t.mask = BIT(5),\n\t\t.hpdev.brdinfo = &mlxplat_mlxcpld_lc_i2c_dev[5],\n\t\t.hpdev.nr = MLXPLAT_CPLD_NR_LC_SET(5),\n\t\t.hpdev.action = MLXREG_HOTPLUG_DEVICE_NO_ACTION,\n\t\t.hpdev.notifier = &mlxplat_mlxcpld_modular_lc_notifier[5],\n\t\t.slot = 6,\n\t},\n\t{\n\t\t.label = \"lc7_ready\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LC_RD_OFFSET,\n\t\t.mask = BIT(6),\n\t\t.hpdev.brdinfo = &mlxplat_mlxcpld_lc_i2c_dev[6],\n\t\t.hpdev.nr = MLXPLAT_CPLD_NR_LC_SET(6),\n\t\t.hpdev.action = MLXREG_HOTPLUG_DEVICE_NO_ACTION,\n\t\t.hpdev.notifier = &mlxplat_mlxcpld_modular_lc_notifier[6],\n\t\t.slot = 7,\n\t},\n\t{\n\t\t.label = \"lc8_ready\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LC_RD_OFFSET,\n\t\t.mask = BIT(7),\n\t\t.hpdev.brdinfo = &mlxplat_mlxcpld_lc_i2c_dev[7],\n\t\t.hpdev.nr = MLXPLAT_CPLD_NR_LC_SET(7),\n\t\t.hpdev.action = MLXREG_HOTPLUG_DEVICE_NO_ACTION,\n\t\t.hpdev.notifier = &mlxplat_mlxcpld_modular_lc_notifier[7],\n\t\t.slot = 8,\n\t},\n};\n\nstatic struct mlxreg_core_data mlxplat_mlxcpld_modular_lc_synced_data[] = {\n\t{\n\t\t.label = \"lc1_synced\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LC_SN_OFFSET,\n\t\t.mask = BIT(0),\n\t\t.hpdev.brdinfo = &mlxplat_mlxcpld_lc_i2c_dev[0],\n\t\t.hpdev.nr = MLXPLAT_CPLD_NR_LC_SET(0),\n\t\t.hpdev.action = MLXREG_HOTPLUG_DEVICE_NO_ACTION,\n\t\t.hpdev.notifier = &mlxplat_mlxcpld_modular_lc_notifier[0],\n\t\t.slot = 1,\n\t},\n\t{\n\t\t.label = \"lc2_synced\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LC_SN_OFFSET,\n\t\t.mask = BIT(1),\n\t\t.hpdev.brdinfo = &mlxplat_mlxcpld_lc_i2c_dev[1],\n\t\t.hpdev.nr = MLXPLAT_CPLD_NR_LC_SET(1),\n\t\t.hpdev.action = MLXREG_HOTPLUG_DEVICE_NO_ACTION,\n\t\t.hpdev.notifier = &mlxplat_mlxcpld_modular_lc_notifier[1],\n\t\t.slot = 2,\n\t},\n\t{\n\t\t.label = \"lc3_synced\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LC_SN_OFFSET,\n\t\t.mask = BIT(2),\n\t\t.hpdev.brdinfo = &mlxplat_mlxcpld_lc_i2c_dev[2],\n\t\t.hpdev.nr = MLXPLAT_CPLD_NR_LC_SET(2),\n\t\t.hpdev.action = MLXREG_HOTPLUG_DEVICE_NO_ACTION,\n\t\t.hpdev.notifier = &mlxplat_mlxcpld_modular_lc_notifier[2],\n\t\t.slot = 3,\n\t},\n\t{\n\t\t.label = \"lc4_synced\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LC_SN_OFFSET,\n\t\t.mask = BIT(3),\n\t\t.hpdev.brdinfo = &mlxplat_mlxcpld_lc_i2c_dev[3],\n\t\t.hpdev.nr = MLXPLAT_CPLD_NR_LC_SET(3),\n\t\t.hpdev.action = MLXREG_HOTPLUG_DEVICE_NO_ACTION,\n\t\t.hpdev.notifier = &mlxplat_mlxcpld_modular_lc_notifier[3],\n\t\t.slot = 4,\n\t},\n\t{\n\t\t.label = \"lc5_synced\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LC_SN_OFFSET,\n\t\t.mask = BIT(4),\n\t\t.hpdev.brdinfo = &mlxplat_mlxcpld_lc_i2c_dev[4],\n\t\t.hpdev.nr = MLXPLAT_CPLD_NR_LC_SET(4),\n\t\t.hpdev.action = MLXREG_HOTPLUG_DEVICE_NO_ACTION,\n\t\t.hpdev.notifier = &mlxplat_mlxcpld_modular_lc_notifier[4],\n\t\t.slot = 5,\n\t},\n\t{\n\t\t.label = \"lc6_synced\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LC_SN_OFFSET,\n\t\t.mask = BIT(5),\n\t\t.hpdev.brdinfo = &mlxplat_mlxcpld_lc_i2c_dev[5],\n\t\t.hpdev.nr = MLXPLAT_CPLD_NR_LC_SET(5),\n\t\t.hpdev.action = MLXREG_HOTPLUG_DEVICE_NO_ACTION,\n\t\t.hpdev.notifier = &mlxplat_mlxcpld_modular_lc_notifier[5],\n\t\t.slot = 6,\n\t},\n\t{\n\t\t.label = \"lc7_synced\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LC_SN_OFFSET,\n\t\t.mask = BIT(6),\n\t\t.hpdev.brdinfo = &mlxplat_mlxcpld_lc_i2c_dev[6],\n\t\t.hpdev.nr = MLXPLAT_CPLD_NR_LC_SET(6),\n\t\t.hpdev.action = MLXREG_HOTPLUG_DEVICE_NO_ACTION,\n\t\t.hpdev.notifier = &mlxplat_mlxcpld_modular_lc_notifier[6],\n\t\t.slot = 7,\n\t},\n\t{\n\t\t.label = \"lc8_synced\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LC_SN_OFFSET,\n\t\t.mask = BIT(7),\n\t\t.hpdev.brdinfo = &mlxplat_mlxcpld_lc_i2c_dev[7],\n\t\t.hpdev.nr = MLXPLAT_CPLD_NR_LC_SET(7),\n\t\t.hpdev.action = MLXREG_HOTPLUG_DEVICE_NO_ACTION,\n\t\t.hpdev.notifier = &mlxplat_mlxcpld_modular_lc_notifier[7],\n\t\t.slot = 8,\n\t},\n};\n\nstatic struct mlxreg_core_data mlxplat_mlxcpld_modular_lc_act_data[] = {\n\t{\n\t\t.label = \"lc1_active\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LC_OK_OFFSET,\n\t\t.mask = BIT(0),\n\t\t.hpdev.brdinfo = &mlxplat_mlxcpld_lc_i2c_dev[0],\n\t\t.hpdev.nr = MLXPLAT_CPLD_NR_LC_SET(0),\n\t\t.hpdev.action = MLXREG_HOTPLUG_DEVICE_NO_ACTION,\n\t\t.hpdev.notifier = &mlxplat_mlxcpld_modular_lc_notifier[0],\n\t\t.slot = 1,\n\t},\n\t{\n\t\t.label = \"lc2_active\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LC_OK_OFFSET,\n\t\t.mask = BIT(1),\n\t\t.hpdev.brdinfo = &mlxplat_mlxcpld_lc_i2c_dev[1],\n\t\t.hpdev.nr = MLXPLAT_CPLD_NR_LC_SET(1),\n\t\t.hpdev.action = MLXREG_HOTPLUG_DEVICE_NO_ACTION,\n\t\t.hpdev.notifier = &mlxplat_mlxcpld_modular_lc_notifier[1],\n\t\t.slot = 2,\n\t},\n\t{\n\t\t.label = \"lc3_active\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LC_OK_OFFSET,\n\t\t.mask = BIT(2),\n\t\t.hpdev.brdinfo = &mlxplat_mlxcpld_lc_i2c_dev[2],\n\t\t.hpdev.nr = MLXPLAT_CPLD_NR_LC_SET(2),\n\t\t.hpdev.action = MLXREG_HOTPLUG_DEVICE_NO_ACTION,\n\t\t.hpdev.notifier = &mlxplat_mlxcpld_modular_lc_notifier[2],\n\t\t.slot = 3,\n\t},\n\t{\n\t\t.label = \"lc4_active\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LC_OK_OFFSET,\n\t\t.mask = BIT(3),\n\t\t.hpdev.brdinfo = &mlxplat_mlxcpld_lc_i2c_dev[3],\n\t\t.hpdev.nr = MLXPLAT_CPLD_NR_LC_SET(3),\n\t\t.hpdev.action = MLXREG_HOTPLUG_DEVICE_NO_ACTION,\n\t\t.hpdev.notifier = &mlxplat_mlxcpld_modular_lc_notifier[3],\n\t\t.slot = 4,\n\t},\n\t{\n\t\t.label = \"lc5_active\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LC_OK_OFFSET,\n\t\t.mask = BIT(4),\n\t\t.hpdev.brdinfo = &mlxplat_mlxcpld_lc_i2c_dev[4],\n\t\t.hpdev.nr = MLXPLAT_CPLD_NR_LC_SET(4),\n\t\t.hpdev.action = MLXREG_HOTPLUG_DEVICE_NO_ACTION,\n\t\t.hpdev.notifier = &mlxplat_mlxcpld_modular_lc_notifier[4],\n\t\t.slot = 5,\n\t},\n\t{\n\t\t.label = \"lc6_active\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LC_OK_OFFSET,\n\t\t.mask = BIT(5),\n\t\t.hpdev.brdinfo = &mlxplat_mlxcpld_lc_i2c_dev[5],\n\t\t.hpdev.nr = MLXPLAT_CPLD_NR_LC_SET(5),\n\t\t.hpdev.action = MLXREG_HOTPLUG_DEVICE_NO_ACTION,\n\t\t.hpdev.notifier = &mlxplat_mlxcpld_modular_lc_notifier[5],\n\t\t.slot = 6,\n\t},\n\t{\n\t\t.label = \"lc7_active\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LC_OK_OFFSET,\n\t\t.mask = BIT(6),\n\t\t.hpdev.brdinfo = &mlxplat_mlxcpld_lc_i2c_dev[6],\n\t\t.hpdev.nr = MLXPLAT_CPLD_NR_LC_SET(6),\n\t\t.hpdev.action = MLXREG_HOTPLUG_DEVICE_NO_ACTION,\n\t\t.hpdev.notifier = &mlxplat_mlxcpld_modular_lc_notifier[6],\n\t\t.slot = 7,\n\t},\n\t{\n\t\t.label = \"lc8_active\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LC_OK_OFFSET,\n\t\t.mask = BIT(7),\n\t\t.hpdev.brdinfo = &mlxplat_mlxcpld_lc_i2c_dev[7],\n\t\t.hpdev.nr = MLXPLAT_CPLD_NR_LC_SET(7),\n\t\t.hpdev.action = MLXREG_HOTPLUG_DEVICE_NO_ACTION,\n\t\t.hpdev.notifier = &mlxplat_mlxcpld_modular_lc_notifier[7],\n\t\t.slot = 8,\n\t},\n};\n\nstatic struct mlxreg_core_data mlxplat_mlxcpld_modular_lc_sd_data[] = {\n\t{\n\t\t.label = \"lc1_shutdown\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LC_SD_OFFSET,\n\t\t.mask = BIT(0),\n\t\t.hpdev.brdinfo = &mlxplat_mlxcpld_lc_i2c_dev[0],\n\t\t.hpdev.nr = MLXPLAT_CPLD_NR_LC_SET(0),\n\t\t.hpdev.action = MLXREG_HOTPLUG_DEVICE_NO_ACTION,\n\t\t.hpdev.notifier = &mlxplat_mlxcpld_modular_lc_notifier[0],\n\t\t.slot = 1,\n\t},\n\t{\n\t\t.label = \"lc2_shutdown\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LC_SD_OFFSET,\n\t\t.mask = BIT(1),\n\t\t.hpdev.brdinfo = &mlxplat_mlxcpld_lc_i2c_dev[1],\n\t\t.hpdev.nr = MLXPLAT_CPLD_NR_LC_SET(1),\n\t\t.hpdev.action = MLXREG_HOTPLUG_DEVICE_NO_ACTION,\n\t\t.hpdev.notifier = &mlxplat_mlxcpld_modular_lc_notifier[1],\n\t\t.slot = 2,\n\t},\n\t{\n\t\t.label = \"lc3_shutdown\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LC_SD_OFFSET,\n\t\t.mask = BIT(2),\n\t\t.hpdev.brdinfo = &mlxplat_mlxcpld_lc_i2c_dev[2],\n\t\t.hpdev.nr = MLXPLAT_CPLD_NR_LC_SET(2),\n\t\t.hpdev.action = MLXREG_HOTPLUG_DEVICE_NO_ACTION,\n\t\t.hpdev.notifier = &mlxplat_mlxcpld_modular_lc_notifier[2],\n\t\t.slot = 3,\n\t},\n\t{\n\t\t.label = \"lc4_shutdown\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LC_SD_OFFSET,\n\t\t.mask = BIT(3),\n\t\t.hpdev.brdinfo = &mlxplat_mlxcpld_lc_i2c_dev[3],\n\t\t.hpdev.nr = MLXPLAT_CPLD_NR_LC_SET(3),\n\t\t.hpdev.action = MLXREG_HOTPLUG_DEVICE_NO_ACTION,\n\t\t.hpdev.notifier = &mlxplat_mlxcpld_modular_lc_notifier[3],\n\t\t.slot = 4,\n\t},\n\t{\n\t\t.label = \"lc5_shutdown\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LC_SD_OFFSET,\n\t\t.mask = BIT(4),\n\t\t.hpdev.brdinfo = &mlxplat_mlxcpld_lc_i2c_dev[4],\n\t\t.hpdev.nr = MLXPLAT_CPLD_NR_LC_SET(4),\n\t\t.hpdev.action = MLXREG_HOTPLUG_DEVICE_NO_ACTION,\n\t\t.hpdev.notifier = &mlxplat_mlxcpld_modular_lc_notifier[4],\n\t\t.slot = 5,\n\t},\n\t{\n\t\t.label = \"lc6_shutdown\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LC_SD_OFFSET,\n\t\t.mask = BIT(5),\n\t\t.hpdev.brdinfo = &mlxplat_mlxcpld_lc_i2c_dev[5],\n\t\t.hpdev.nr = MLXPLAT_CPLD_NR_LC_SET(5),\n\t\t.hpdev.action = MLXREG_HOTPLUG_DEVICE_NO_ACTION,\n\t\t.hpdev.notifier = &mlxplat_mlxcpld_modular_lc_notifier[5],\n\t\t.slot = 6,\n\t},\n\t{\n\t\t.label = \"lc7_shutdown\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LC_SD_OFFSET,\n\t\t.mask = BIT(6),\n\t\t.hpdev.brdinfo = &mlxplat_mlxcpld_lc_i2c_dev[6],\n\t\t.hpdev.nr = MLXPLAT_CPLD_NR_LC_SET(6),\n\t\t.hpdev.action = MLXREG_HOTPLUG_DEVICE_NO_ACTION,\n\t\t.hpdev.notifier = &mlxplat_mlxcpld_modular_lc_notifier[6],\n\t\t.slot = 7,\n\t},\n\t{\n\t\t.label = \"lc8_shutdown\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LC_SD_OFFSET,\n\t\t.mask = BIT(7),\n\t\t.hpdev.brdinfo = &mlxplat_mlxcpld_lc_i2c_dev[7],\n\t\t.hpdev.nr = MLXPLAT_CPLD_NR_LC_SET(7),\n\t\t.hpdev.action = MLXREG_HOTPLUG_DEVICE_NO_ACTION,\n\t\t.hpdev.notifier = &mlxplat_mlxcpld_modular_lc_notifier[7],\n\t\t.slot = 8,\n\t},\n};\n\nstatic struct mlxreg_core_item mlxplat_mlxcpld_modular_items[] = {\n\t{\n\t\t.data = mlxplat_mlxcpld_ext_psu_items_data,\n\t\t.aggr_mask = MLXPLAT_CPLD_AGGR_MASK_NG_DEF,\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_PSU_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_PSU_EXT_MASK,\n\t\t.capability = MLXPLAT_CPLD_LPC_REG_PSU_I2C_CAP_OFFSET,\n\t\t.count = ARRAY_SIZE(mlxplat_mlxcpld_ext_psu_items_data),\n\t\t.inversed = 1,\n\t\t.health = false,\n\t},\n\t{\n\t\t.data = mlxplat_mlxcpld_modular_pwr_items_data,\n\t\t.aggr_mask = MLXPLAT_CPLD_AGGR_MASK_NG_DEF,\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_PWR_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_PWR_EXT_MASK,\n\t\t.capability = MLXPLAT_CPLD_LPC_REG_PSU_I2C_CAP_OFFSET,\n\t\t.count = ARRAY_SIZE(mlxplat_mlxcpld_ext_pwr_items_data),\n\t\t.inversed = 0,\n\t\t.health = false,\n\t},\n\t{\n\t\t.data = mlxplat_mlxcpld_default_ng_fan_items_data,\n\t\t.aggr_mask = MLXPLAT_CPLD_AGGR_MASK_NG_DEF,\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_FAN_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_FAN_NG_MASK,\n\t\t.count = ARRAY_SIZE(mlxplat_mlxcpld_default_ng_fan_items_data),\n\t\t.inversed = 1,\n\t\t.health = false,\n\t},\n\t{\n\t\t.data = mlxplat_mlxcpld_modular_asic_items_data,\n\t\t.aggr_mask = MLXPLAT_CPLD_AGGR_MASK_NG_DEF,\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_ASIC_HEALTH_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_ASIC_MASK,\n\t\t.count = ARRAY_SIZE(mlxplat_mlxcpld_modular_asic_items_data),\n\t\t.inversed = 0,\n\t\t.health = true,\n\t},\n\t{\n\t\t.data = mlxplat_mlxcpld_modular_lc_pr_items_data,\n\t\t.kind = MLXREG_HOTPLUG_LC_PRESENT,\n\t\t.aggr_mask = MLXPLAT_CPLD_AGGR_MASK_LC,\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LC_IN_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_LPC_LC_MASK,\n\t\t.count = ARRAY_SIZE(mlxplat_mlxcpld_modular_lc_pr_items_data),\n\t\t.inversed = 1,\n\t\t.health = false,\n\t},\n\t{\n\t\t.data = mlxplat_mlxcpld_modular_lc_ver_items_data,\n\t\t.kind = MLXREG_HOTPLUG_LC_VERIFIED,\n\t\t.aggr_mask = MLXPLAT_CPLD_AGGR_MASK_LC,\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LC_VR_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_LPC_LC_MASK,\n\t\t.count = ARRAY_SIZE(mlxplat_mlxcpld_modular_lc_ver_items_data),\n\t\t.inversed = 0,\n\t\t.health = false,\n\t},\n\t{\n\t\t.data = mlxplat_mlxcpld_modular_lc_pg_data,\n\t\t.kind = MLXREG_HOTPLUG_LC_POWERED,\n\t\t.aggr_mask = MLXPLAT_CPLD_AGGR_MASK_LC,\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LC_PG_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_LPC_LC_MASK,\n\t\t.count = ARRAY_SIZE(mlxplat_mlxcpld_modular_lc_pg_data),\n\t\t.inversed = 0,\n\t\t.health = false,\n\t},\n\t{\n\t\t.data = mlxplat_mlxcpld_modular_lc_ready_data,\n\t\t.kind = MLXREG_HOTPLUG_LC_READY,\n\t\t.aggr_mask = MLXPLAT_CPLD_AGGR_MASK_LC,\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LC_RD_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_LPC_LC_MASK,\n\t\t.count = ARRAY_SIZE(mlxplat_mlxcpld_modular_lc_ready_data),\n\t\t.inversed = 0,\n\t\t.health = false,\n\t},\n\t{\n\t\t.data = mlxplat_mlxcpld_modular_lc_synced_data,\n\t\t.kind = MLXREG_HOTPLUG_LC_SYNCED,\n\t\t.aggr_mask = MLXPLAT_CPLD_AGGR_MASK_LC,\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LC_SN_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_LPC_LC_MASK,\n\t\t.count = ARRAY_SIZE(mlxplat_mlxcpld_modular_lc_synced_data),\n\t\t.inversed = 0,\n\t\t.health = false,\n\t},\n\t{\n\t\t.data = mlxplat_mlxcpld_modular_lc_act_data,\n\t\t.kind = MLXREG_HOTPLUG_LC_ACTIVE,\n\t\t.aggr_mask = MLXPLAT_CPLD_AGGR_MASK_LC,\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LC_OK_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_LPC_LC_MASK,\n\t\t.count = ARRAY_SIZE(mlxplat_mlxcpld_modular_lc_act_data),\n\t\t.inversed = 0,\n\t\t.health = false,\n\t},\n\t{\n\t\t.data = mlxplat_mlxcpld_modular_lc_sd_data,\n\t\t.kind = MLXREG_HOTPLUG_LC_THERMAL,\n\t\t.aggr_mask = MLXPLAT_CPLD_AGGR_MASK_LC,\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LC_SD_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_LPC_LC_MASK,\n\t\t.count = ARRAY_SIZE(mlxplat_mlxcpld_modular_lc_sd_data),\n\t\t.inversed = 0,\n\t\t.health = false,\n\t},\n};\n\nstatic\nstruct mlxreg_core_hotplug_platform_data mlxplat_mlxcpld_modular_data = {\n\t.items = mlxplat_mlxcpld_modular_items,\n\t.counter = ARRAY_SIZE(mlxplat_mlxcpld_modular_items),\n\t.cell = MLXPLAT_CPLD_LPC_REG_AGGR_OFFSET,\n\t.mask = MLXPLAT_CPLD_AGGR_MASK_MODULAR,\n\t.cell_low = MLXPLAT_CPLD_LPC_REG_AGGRLO_OFFSET,\n\t.mask_low = MLXPLAT_CPLD_LOW_AGGR_MASK_LOW,\n};\n\n \nstatic struct mlxreg_core_data mlxplat_mlxcpld_global_wp_items_data[] = {\n\t{\n\t\t.label = \"global_wp_grant\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_GWP_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_GWP_MASK,\n\t\t.hpdev.nr = MLXPLAT_CPLD_NR_NONE,\n\t},\n};\n\nstatic struct mlxreg_core_item mlxplat_mlxcpld_chassis_blade_items[] = {\n\t{\n\t\t.data = mlxplat_mlxcpld_global_wp_items_data,\n\t\t.aggr_mask = MLXPLAT_CPLD_AGGR_MASK_NG_DEF,\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_GWP_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_GWP_MASK,\n\t\t.count = ARRAY_SIZE(mlxplat_mlxcpld_global_wp_items_data),\n\t\t.inversed = 0,\n\t\t.health = false,\n\t},\n};\n\nstatic\nstruct mlxreg_core_hotplug_platform_data mlxplat_mlxcpld_chassis_blade_data = {\n\t.items = mlxplat_mlxcpld_chassis_blade_items,\n\t.counter = ARRAY_SIZE(mlxplat_mlxcpld_chassis_blade_items),\n\t.cell = MLXPLAT_CPLD_LPC_REG_AGGR_OFFSET,\n\t.mask = MLXPLAT_CPLD_AGGR_MASK_COMEX,\n\t.cell_low = MLXPLAT_CPLD_LPC_REG_AGGRLO_OFFSET,\n\t.mask_low = MLXPLAT_CPLD_LOW_AGGR_MASK_LOW,\n};\n\n \nstatic struct mlxreg_core_data mlxplat_mlxcpld_erot_ap_items_data[] = {\n\t{\n\t\t.label = \"erot1_ap\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_EROT_OFFSET,\n\t\t.mask = BIT(0),\n\t\t.hpdev.nr = MLXPLAT_CPLD_NR_NONE,\n\t},\n\t{\n\t\t.label = \"erot2_ap\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_EROT_OFFSET,\n\t\t.mask = BIT(1),\n\t\t.hpdev.nr = MLXPLAT_CPLD_NR_NONE,\n\t},\n};\n\nstatic struct mlxreg_core_data mlxplat_mlxcpld_erot_error_items_data[] = {\n\t{\n\t\t.label = \"erot1_error\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_EROTE_OFFSET,\n\t\t.mask = BIT(0),\n\t\t.hpdev.nr = MLXPLAT_CPLD_NR_NONE,\n\t},\n\t{\n\t\t.label = \"erot2_error\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_EROTE_OFFSET,\n\t\t.mask = BIT(1),\n\t\t.hpdev.nr = MLXPLAT_CPLD_NR_NONE,\n\t},\n};\n\nstatic struct mlxreg_core_item mlxplat_mlxcpld_rack_switch_items[] = {\n\t{\n\t\t.data = mlxplat_mlxcpld_ext_psu_items_data,\n\t\t.aggr_mask = MLXPLAT_CPLD_AGGR_MASK_NG_DEF,\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_PSU_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_PSU_EXT_MASK,\n\t\t.capability = MLXPLAT_CPLD_LPC_REG_PSU_I2C_CAP_OFFSET,\n\t\t.count = ARRAY_SIZE(mlxplat_mlxcpld_ext_psu_items_data),\n\t\t.inversed = 1,\n\t\t.health = false,\n\t},\n\t{\n\t\t.data = mlxplat_mlxcpld_ext_pwr_items_data,\n\t\t.aggr_mask = MLXPLAT_CPLD_AGGR_MASK_NG_DEF,\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_PWR_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_PWR_EXT_MASK,\n\t\t.capability = MLXPLAT_CPLD_LPC_REG_PSU_I2C_CAP_OFFSET,\n\t\t.count = ARRAY_SIZE(mlxplat_mlxcpld_ext_pwr_items_data),\n\t\t.inversed = 0,\n\t\t.health = false,\n\t},\n\t{\n\t\t.data = mlxplat_mlxcpld_default_ng_fan_items_data,\n\t\t.aggr_mask = MLXPLAT_CPLD_AGGR_MASK_NG_DEF,\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_FAN_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_FAN_NG_MASK,\n\t\t.count = ARRAY_SIZE(mlxplat_mlxcpld_default_ng_fan_items_data),\n\t\t.inversed = 1,\n\t\t.health = false,\n\t},\n\t{\n\t\t.data = mlxplat_mlxcpld_erot_ap_items_data,\n\t\t.aggr_mask = MLXPLAT_CPLD_AGGR_MASK_NG_DEF,\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_EROT_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_EROT_MASK,\n\t\t.count = ARRAY_SIZE(mlxplat_mlxcpld_erot_ap_items_data),\n\t\t.inversed = 1,\n\t\t.health = false,\n\t},\n\t{\n\t\t.data = mlxplat_mlxcpld_erot_error_items_data,\n\t\t.aggr_mask = MLXPLAT_CPLD_AGGR_MASK_NG_DEF,\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_EROTE_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_EROT_MASK,\n\t\t.count = ARRAY_SIZE(mlxplat_mlxcpld_erot_error_items_data),\n\t\t.inversed = 1,\n\t\t.health = false,\n\t},\n};\n\nstatic\nstruct mlxreg_core_hotplug_platform_data mlxplat_mlxcpld_rack_switch_data = {\n\t.items = mlxplat_mlxcpld_rack_switch_items,\n\t.counter = ARRAY_SIZE(mlxplat_mlxcpld_rack_switch_items),\n\t.cell = MLXPLAT_CPLD_LPC_REG_AGGR_OFFSET,\n\t.mask = MLXPLAT_CPLD_AGGR_MASK_NG_DEF | MLXPLAT_CPLD_AGGR_MASK_COMEX,\n\t.cell_low = MLXPLAT_CPLD_LPC_REG_AGGRLO_OFFSET,\n\t.mask_low = MLXPLAT_CPLD_LOW_AGGR_MASK_LOW,\n};\n\n \nstatic int\nmlxplat_mlxcpld_l1_switch_pwr_events_handler(void *handle, enum mlxreg_hotplug_kind kind,\n\t\t\t\t\t     u8 action)\n{\n\tif (action) {\n\t\tdev_info(&mlxplat_dev->dev, \"System shutdown due to short press of power button\");\n\t\tkernel_power_off();\n\t}\n\n\treturn 0;\n}\n\nstatic struct mlxreg_core_hotplug_notifier mlxplat_mlxcpld_l1_switch_pwr_events_notifier = {\n\t.user_handler = mlxplat_mlxcpld_l1_switch_pwr_events_handler,\n};\n\n \nstatic struct mlxreg_core_data mlxplat_mlxcpld_l1_switch_pwr_events_items_data[] = {\n\t{\n\t\t.label = \"power_button\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_PWRB_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_PWR_BUTTON_MASK,\n\t\t.hpdev.nr = MLXPLAT_CPLD_NR_NONE,\n\t\t.hpdev.action = MLXREG_HOTPLUG_DEVICE_NO_ACTION,\n\t\t.hpdev.notifier = &mlxplat_mlxcpld_l1_switch_pwr_events_notifier,\n\t},\n};\n\n \nstatic int\nmlxplat_mlxcpld_l1_switch_intrusion_events_handler(void *handle, enum mlxreg_hotplug_kind kind,\n\t\t\t\t\t\t   u8 action)\n{\n\tstruct mlxplat_priv *priv = platform_get_drvdata(mlxplat_dev);\n\tu32 regval;\n\tint err;\n\n\terr = regmap_read(priv->regmap, MLXPLAT_CPLD_LPC_REG_GP1_OFFSET, &regval);\n\tif (err)\n\t\tgoto fail_regmap_read;\n\n\tif (action) {\n\t\tdev_info(&mlxplat_dev->dev, \"Detected intrusion - system latch is opened\");\n\t\terr = regmap_write(priv->regmap, MLXPLAT_CPLD_LPC_REG_GP1_OFFSET,\n\t\t\t\t   regval | MLXPLAT_CPLD_LATCH_RST_MASK);\n\t} else {\n\t\tdev_info(&mlxplat_dev->dev, \"System latch is properly closed\");\n\t\terr = regmap_write(priv->regmap, MLXPLAT_CPLD_LPC_REG_GP1_OFFSET,\n\t\t\t\t   regval & ~MLXPLAT_CPLD_LATCH_RST_MASK);\n\t}\n\n\tif (err)\n\t\tgoto fail_regmap_write;\n\n\treturn 0;\n\nfail_regmap_read:\nfail_regmap_write:\n\tdev_err(&mlxplat_dev->dev, \"Register access failed\");\n\treturn err;\n}\n\nstatic struct mlxreg_core_hotplug_notifier mlxplat_mlxcpld_l1_switch_intrusion_events_notifier = {\n\t.user_handler = mlxplat_mlxcpld_l1_switch_intrusion_events_handler,\n};\n\nstatic struct mlxreg_core_data mlxplat_mlxcpld_l1_switch_health_events_items_data[] = {\n\t{\n\t\t.label = \"thermal1_pdb\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_BRD_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_THERMAL1_PDB_MASK,\n\t\t.hpdev.nr = MLXPLAT_CPLD_NR_NONE,\n\t},\n\t{\n\t\t.label = \"thermal2_pdb\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_BRD_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_THERMAL2_PDB_MASK,\n\t\t.hpdev.nr = MLXPLAT_CPLD_NR_NONE,\n\t},\n\t{\n\t\t.label = \"intrusion\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_BRD_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_INTRUSION_MASK,\n\t\t.hpdev.nr = MLXPLAT_CPLD_NR_NONE,\n\t\t.hpdev.action = MLXREG_HOTPLUG_DEVICE_NO_ACTION,\n\t\t.hpdev.notifier = &mlxplat_mlxcpld_l1_switch_intrusion_events_notifier,\n\t},\n\t{\n\t\t.label = \"pwm_pg\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_BRD_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_PWM_PG_MASK,\n\t\t.hpdev.nr = MLXPLAT_CPLD_NR_NONE,\n\t},\n};\n\nstatic struct mlxreg_core_item mlxplat_mlxcpld_l1_switch_events_items[] = {\n\t{\n\t\t.data = mlxplat_mlxcpld_default_ng_fan_items_data,\n\t\t.aggr_mask = MLXPLAT_CPLD_AGGR_MASK_NG_DEF,\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_FAN_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_FAN_NG_MASK,\n\t\t.count = ARRAY_SIZE(mlxplat_mlxcpld_default_ng_fan_items_data),\n\t\t.inversed = 1,\n\t\t.health = false,\n\t},\n\t{\n\t\t.data = mlxplat_mlxcpld_erot_ap_items_data,\n\t\t.aggr_mask = MLXPLAT_CPLD_AGGR_MASK_NG_DEF,\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_EROT_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_EROT_MASK,\n\t\t.count = ARRAY_SIZE(mlxplat_mlxcpld_erot_ap_items_data),\n\t\t.inversed = 1,\n\t\t.health = false,\n\t},\n\t{\n\t\t.data = mlxplat_mlxcpld_erot_error_items_data,\n\t\t.aggr_mask = MLXPLAT_CPLD_AGGR_MASK_NG_DEF,\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_EROTE_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_EROT_MASK,\n\t\t.count = ARRAY_SIZE(mlxplat_mlxcpld_erot_error_items_data),\n\t\t.inversed = 1,\n\t\t.health = false,\n\t},\n\t{\n\t\t.data = mlxplat_mlxcpld_l1_switch_pwr_events_items_data,\n\t\t.aggr_mask = MLXPLAT_CPLD_AGGR_MASK_NG_DEF,\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_PWRB_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_PWR_BUTTON_MASK,\n\t\t.count = ARRAY_SIZE(mlxplat_mlxcpld_l1_switch_pwr_events_items_data),\n\t\t.inversed = 1,\n\t\t.health = false,\n\t},\n\t{\n\t\t.data = mlxplat_mlxcpld_l1_switch_health_events_items_data,\n\t\t.aggr_mask = MLXPLAT_CPLD_AGGR_MASK_NG_DEF,\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_BRD_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_L1_CHA_HEALTH_MASK,\n\t\t.count = ARRAY_SIZE(mlxplat_mlxcpld_l1_switch_health_events_items_data),\n\t\t.inversed = 1,\n\t\t.health = false,\n\t\t.ind = 8,\n\t},\n};\n\nstatic\nstruct mlxreg_core_hotplug_platform_data mlxplat_mlxcpld_l1_switch_data = {\n\t.items = mlxplat_mlxcpld_l1_switch_events_items,\n\t.counter = ARRAY_SIZE(mlxplat_mlxcpld_l1_switch_events_items),\n\t.cell = MLXPLAT_CPLD_LPC_REG_AGGR_OFFSET,\n\t.mask = MLXPLAT_CPLD_AGGR_MASK_NG_DEF | MLXPLAT_CPLD_AGGR_MASK_COMEX,\n\t.cell_low = MLXPLAT_CPLD_LPC_REG_AGGRLO_OFFSET,\n\t.mask_low = MLXPLAT_CPLD_LOW_AGGR_MASK_LOW | MLXPLAT_CPLD_LOW_AGGR_MASK_PWR_BUT,\n};\n\n \nstatic struct mlxreg_core_data mlxplat_mlxcpld_default_led_data[] = {\n\t{\n\t\t.label = \"status:green\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LED1_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_LED_LO_NIBBLE_MASK,\n\t},\n\t{\n\t\t.label = \"status:red\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LED1_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_LED_LO_NIBBLE_MASK\n\t},\n\t{\n\t\t.label = \"psu:green\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LED1_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_LED_HI_NIBBLE_MASK,\n\t},\n\t{\n\t\t.label = \"psu:red\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LED1_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_LED_HI_NIBBLE_MASK,\n\t},\n\t{\n\t\t.label = \"fan1:green\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LED2_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_LED_LO_NIBBLE_MASK,\n\t},\n\t{\n\t\t.label = \"fan1:red\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LED2_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_LED_LO_NIBBLE_MASK,\n\t},\n\t{\n\t\t.label = \"fan2:green\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LED2_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_LED_HI_NIBBLE_MASK,\n\t},\n\t{\n\t\t.label = \"fan2:red\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LED2_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_LED_HI_NIBBLE_MASK,\n\t},\n\t{\n\t\t.label = \"fan3:green\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LED3_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_LED_LO_NIBBLE_MASK,\n\t},\n\t{\n\t\t.label = \"fan3:red\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LED3_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_LED_LO_NIBBLE_MASK,\n\t},\n\t{\n\t\t.label = \"fan4:green\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LED3_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_LED_HI_NIBBLE_MASK,\n\t},\n\t{\n\t\t.label = \"fan4:red\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LED3_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_LED_HI_NIBBLE_MASK,\n\t},\n};\n\nstatic struct mlxreg_core_platform_data mlxplat_default_led_data = {\n\t\t.data = mlxplat_mlxcpld_default_led_data,\n\t\t.counter = ARRAY_SIZE(mlxplat_mlxcpld_default_led_data),\n};\n\n \nstatic struct mlxreg_core_data mlxplat_mlxcpld_default_led_wc_data[] = {\n\t{\n\t\t.label = \"status:green\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LED1_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_LED_LO_NIBBLE_MASK,\n\t},\n\t{\n\t\t.label = \"status:red\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LED1_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_LED_LO_NIBBLE_MASK\n\t},\n\t{\n\t\t.label = \"psu:green\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LED1_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_LED_HI_NIBBLE_MASK,\n\t},\n\t{\n\t\t.label = \"psu:red\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LED1_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_LED_HI_NIBBLE_MASK,\n\t},\n};\n\nstatic struct mlxreg_core_platform_data mlxplat_default_led_wc_data = {\n\t\t.data = mlxplat_mlxcpld_default_led_wc_data,\n\t\t.counter = ARRAY_SIZE(mlxplat_mlxcpld_default_led_wc_data),\n};\n\n \nstatic struct mlxreg_core_data mlxplat_mlxcpld_default_led_eth_wc_blade_data[] = {\n\t{\n\t\t.label = \"status:green\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LED1_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_LED_LO_NIBBLE_MASK,\n\t},\n\t{\n\t\t.label = \"status:red\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LED1_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_LED_LO_NIBBLE_MASK\n\t},\n};\n\nstatic struct mlxreg_core_platform_data mlxplat_default_led_eth_wc_blade_data = {\n\t.data = mlxplat_mlxcpld_default_led_eth_wc_blade_data,\n\t.counter = ARRAY_SIZE(mlxplat_mlxcpld_default_led_eth_wc_blade_data),\n};\n\n \nstatic struct mlxreg_core_data mlxplat_mlxcpld_msn21xx_led_data[] = {\n\t{\n\t\t.label = \"status:green\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LED1_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_LED_LO_NIBBLE_MASK,\n\t},\n\t{\n\t\t.label = \"status:red\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LED1_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_LED_LO_NIBBLE_MASK\n\t},\n\t{\n\t\t.label = \"fan:green\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LED2_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_LED_LO_NIBBLE_MASK,\n\t},\n\t{\n\t\t.label = \"fan:red\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LED2_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_LED_LO_NIBBLE_MASK,\n\t},\n\t{\n\t\t.label = \"psu1:green\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LED4_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_LED_LO_NIBBLE_MASK,\n\t},\n\t{\n\t\t.label = \"psu1:red\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LED4_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_LED_LO_NIBBLE_MASK,\n\t},\n\t{\n\t\t.label = \"psu2:green\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LED4_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_LED_HI_NIBBLE_MASK,\n\t},\n\t{\n\t\t.label = \"psu2:red\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LED4_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_LED_HI_NIBBLE_MASK,\n\t},\n\t{\n\t\t.label = \"uid:blue\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LED5_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_LED_LO_NIBBLE_MASK,\n\t},\n};\n\nstatic struct mlxreg_core_platform_data mlxplat_msn21xx_led_data = {\n\t\t.data = mlxplat_mlxcpld_msn21xx_led_data,\n\t\t.counter = ARRAY_SIZE(mlxplat_mlxcpld_msn21xx_led_data),\n};\n\n \nstatic struct mlxreg_core_data mlxplat_mlxcpld_default_ng_led_data[] = {\n\t{\n\t\t.label = \"status:green\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LED1_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_LED_LO_NIBBLE_MASK,\n\t},\n\t{\n\t\t.label = \"status:orange\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LED1_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_LED_LO_NIBBLE_MASK\n\t},\n\t{\n\t\t.label = \"psu:green\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LED1_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_LED_HI_NIBBLE_MASK,\n\t},\n\t{\n\t\t.label = \"psu:orange\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LED1_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_LED_HI_NIBBLE_MASK,\n\t},\n\t{\n\t\t.label = \"fan1:green\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LED2_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_LED_LO_NIBBLE_MASK,\n\t\t.capability = MLXPLAT_CPLD_LPC_REG_FAN_DRW_CAP_OFFSET,\n\t\t.bit = BIT(0),\n\t},\n\t{\n\t\t.label = \"fan1:orange\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LED2_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_LED_LO_NIBBLE_MASK,\n\t\t.capability = MLXPLAT_CPLD_LPC_REG_FAN_DRW_CAP_OFFSET,\n\t\t.bit = BIT(0),\n\t},\n\t{\n\t\t.label = \"fan2:green\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LED2_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_LED_HI_NIBBLE_MASK,\n\t\t.capability = MLXPLAT_CPLD_LPC_REG_FAN_DRW_CAP_OFFSET,\n\t\t.bit = BIT(1),\n\t},\n\t{\n\t\t.label = \"fan2:orange\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LED2_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_LED_HI_NIBBLE_MASK,\n\t\t.capability = MLXPLAT_CPLD_LPC_REG_FAN_DRW_CAP_OFFSET,\n\t\t.bit = BIT(1),\n\t},\n\t{\n\t\t.label = \"fan3:green\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LED3_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_LED_LO_NIBBLE_MASK,\n\t\t.capability = MLXPLAT_CPLD_LPC_REG_FAN_DRW_CAP_OFFSET,\n\t\t.bit = BIT(2),\n\t},\n\t{\n\t\t.label = \"fan3:orange\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LED3_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_LED_LO_NIBBLE_MASK,\n\t\t.capability = MLXPLAT_CPLD_LPC_REG_FAN_DRW_CAP_OFFSET,\n\t\t.bit = BIT(2),\n\t},\n\t{\n\t\t.label = \"fan4:green\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LED3_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_LED_HI_NIBBLE_MASK,\n\t\t.capability = MLXPLAT_CPLD_LPC_REG_FAN_DRW_CAP_OFFSET,\n\t\t.bit = BIT(3),\n\t},\n\t{\n\t\t.label = \"fan4:orange\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LED3_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_LED_HI_NIBBLE_MASK,\n\t\t.capability = MLXPLAT_CPLD_LPC_REG_FAN_DRW_CAP_OFFSET,\n\t\t.bit = BIT(3),\n\t},\n\t{\n\t\t.label = \"fan5:green\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LED4_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_LED_LO_NIBBLE_MASK,\n\t\t.capability = MLXPLAT_CPLD_LPC_REG_FAN_DRW_CAP_OFFSET,\n\t\t.bit = BIT(4),\n\t},\n\t{\n\t\t.label = \"fan5:orange\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LED4_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_LED_LO_NIBBLE_MASK,\n\t\t.capability = MLXPLAT_CPLD_LPC_REG_FAN_DRW_CAP_OFFSET,\n\t\t.bit = BIT(4),\n\t},\n\t{\n\t\t.label = \"fan6:green\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LED4_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_LED_HI_NIBBLE_MASK,\n\t\t.capability = MLXPLAT_CPLD_LPC_REG_FAN_DRW_CAP_OFFSET,\n\t\t.bit = BIT(5),\n\t},\n\t{\n\t\t.label = \"fan6:orange\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LED4_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_LED_HI_NIBBLE_MASK,\n\t\t.capability = MLXPLAT_CPLD_LPC_REG_FAN_DRW_CAP_OFFSET,\n\t\t.bit = BIT(5),\n\t},\n\t{\n\t\t.label = \"fan7:green\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LED6_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_LED_HI_NIBBLE_MASK,\n\t\t.capability = MLXPLAT_CPLD_LPC_REG_FAN_DRW_CAP_OFFSET,\n\t\t.bit = BIT(6),\n\t},\n\t{\n\t\t.label = \"fan7:orange\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LED6_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_LED_HI_NIBBLE_MASK,\n\t\t.capability = MLXPLAT_CPLD_LPC_REG_FAN_DRW_CAP_OFFSET,\n\t\t.bit = BIT(6),\n\t},\n\t{\n\t\t.label = \"uid:blue\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LED5_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_LED_LO_NIBBLE_MASK,\n\t},\n};\n\nstatic struct mlxreg_core_platform_data mlxplat_default_ng_led_data = {\n\t\t.data = mlxplat_mlxcpld_default_ng_led_data,\n\t\t.counter = ARRAY_SIZE(mlxplat_mlxcpld_default_ng_led_data),\n};\n\n \nstatic struct mlxreg_core_data mlxplat_mlxcpld_comex_100G_led_data[] = {\n\t{\n\t\t.label = \"status:green\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LED1_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_LED_LO_NIBBLE_MASK,\n\t},\n\t{\n\t\t.label = \"status:red\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LED1_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_LED_LO_NIBBLE_MASK\n\t},\n\t{\n\t\t.label = \"psu:green\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LED1_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_LED_HI_NIBBLE_MASK,\n\t},\n\t{\n\t\t.label = \"psu:red\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LED1_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_LED_HI_NIBBLE_MASK,\n\t},\n\t{\n\t\t.label = \"fan1:green\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LED2_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_LED_LO_NIBBLE_MASK,\n\t},\n\t{\n\t\t.label = \"fan1:red\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LED2_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_LED_LO_NIBBLE_MASK,\n\t},\n\t{\n\t\t.label = \"fan2:green\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LED2_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_LED_HI_NIBBLE_MASK,\n\t},\n\t{\n\t\t.label = \"fan2:red\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LED2_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_LED_HI_NIBBLE_MASK,\n\t},\n\t{\n\t\t.label = \"fan3:green\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LED3_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_LED_LO_NIBBLE_MASK,\n\t},\n\t{\n\t\t.label = \"fan3:red\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LED3_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_LED_LO_NIBBLE_MASK,\n\t},\n\t{\n\t\t.label = \"fan4:green\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LED3_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_LED_HI_NIBBLE_MASK,\n\t},\n\t{\n\t\t.label = \"fan4:red\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LED3_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_LED_HI_NIBBLE_MASK,\n\t},\n\t{\n\t\t.label = \"uid:blue\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LED5_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_LED_LO_NIBBLE_MASK,\n\t},\n};\n\nstatic struct mlxreg_core_platform_data mlxplat_comex_100G_led_data = {\n\t\t.data = mlxplat_mlxcpld_comex_100G_led_data,\n\t\t.counter = ARRAY_SIZE(mlxplat_mlxcpld_comex_100G_led_data),\n};\n\n \nstatic struct mlxreg_core_data mlxplat_mlxcpld_modular_led_data[] = {\n\t{\n\t\t.label = \"status:green\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LED1_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_LED_LO_NIBBLE_MASK,\n\t},\n\t{\n\t\t.label = \"status:orange\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LED1_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_LED_LO_NIBBLE_MASK\n\t},\n\t{\n\t\t.label = \"psu:green\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LED1_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_LED_HI_NIBBLE_MASK,\n\t},\n\t{\n\t\t.label = \"psu:orange\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LED1_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_LED_HI_NIBBLE_MASK,\n\t},\n\t{\n\t\t.label = \"fan1:green\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LED2_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_LED_LO_NIBBLE_MASK,\n\t\t.capability = MLXPLAT_CPLD_LPC_REG_FAN_DRW_CAP_OFFSET,\n\t\t.bit = BIT(0),\n\t},\n\t{\n\t\t.label = \"fan1:orange\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LED2_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_LED_LO_NIBBLE_MASK,\n\t\t.capability = MLXPLAT_CPLD_LPC_REG_FAN_DRW_CAP_OFFSET,\n\t\t.bit = BIT(0),\n\t},\n\t{\n\t\t.label = \"fan2:green\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LED2_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_LED_HI_NIBBLE_MASK,\n\t\t.capability = MLXPLAT_CPLD_LPC_REG_FAN_DRW_CAP_OFFSET,\n\t\t.bit = BIT(1),\n\t},\n\t{\n\t\t.label = \"fan2:orange\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LED2_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_LED_HI_NIBBLE_MASK,\n\t\t.capability = MLXPLAT_CPLD_LPC_REG_FAN_DRW_CAP_OFFSET,\n\t\t.bit = BIT(1),\n\t},\n\t{\n\t\t.label = \"fan3:green\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LED3_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_LED_LO_NIBBLE_MASK,\n\t\t.capability = MLXPLAT_CPLD_LPC_REG_FAN_DRW_CAP_OFFSET,\n\t\t.bit = BIT(2),\n\t},\n\t{\n\t\t.label = \"fan3:orange\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LED3_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_LED_LO_NIBBLE_MASK,\n\t\t.capability = MLXPLAT_CPLD_LPC_REG_FAN_DRW_CAP_OFFSET,\n\t\t.bit = BIT(2),\n\t},\n\t{\n\t\t.label = \"fan4:green\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LED3_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_LED_HI_NIBBLE_MASK,\n\t\t.capability = MLXPLAT_CPLD_LPC_REG_FAN_DRW_CAP_OFFSET,\n\t\t.bit = BIT(3),\n\t},\n\t{\n\t\t.label = \"fan4:orange\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LED3_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_LED_HI_NIBBLE_MASK,\n\t\t.capability = MLXPLAT_CPLD_LPC_REG_FAN_DRW_CAP_OFFSET,\n\t\t.bit = BIT(3),\n\t},\n\t{\n\t\t.label = \"fan5:green\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LED4_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_LED_LO_NIBBLE_MASK,\n\t\t.capability = MLXPLAT_CPLD_LPC_REG_FAN_DRW_CAP_OFFSET,\n\t\t.bit = BIT(4),\n\t},\n\t{\n\t\t.label = \"fan5:orange\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LED4_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_LED_LO_NIBBLE_MASK,\n\t\t.capability = MLXPLAT_CPLD_LPC_REG_FAN_DRW_CAP_OFFSET,\n\t\t.bit = BIT(4),\n\t},\n\t{\n\t\t.label = \"fan6:green\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LED4_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_LED_HI_NIBBLE_MASK,\n\t\t.capability = MLXPLAT_CPLD_LPC_REG_FAN_DRW_CAP_OFFSET,\n\t\t.bit = BIT(5),\n\t},\n\t{\n\t\t.label = \"fan6:orange\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LED4_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_LED_HI_NIBBLE_MASK,\n\t\t.capability = MLXPLAT_CPLD_LPC_REG_FAN_DRW_CAP_OFFSET,\n\t\t.bit = BIT(5),\n\t},\n\t{\n\t\t.label = \"fan7:green\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LED6_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_LED_LO_NIBBLE_MASK,\n\t\t.capability = MLXPLAT_CPLD_LPC_REG_FAN_DRW_CAP_OFFSET,\n\t\t.bit = BIT(6),\n\t},\n\t{\n\t\t.label = \"fan7:orange\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LED6_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_LED_LO_NIBBLE_MASK,\n\t\t.capability = MLXPLAT_CPLD_LPC_REG_FAN_DRW_CAP_OFFSET,\n\t\t.bit = BIT(6),\n\t},\n\t{\n\t\t.label = \"uid:blue\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LED5_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_LED_LO_NIBBLE_MASK,\n\t},\n\t{\n\t\t.label = \"fan_front:green\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LED6_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_LED_LO_NIBBLE_MASK,\n\t},\n\t{\n\t\t.label = \"fan_front:orange\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LED6_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_LED_LO_NIBBLE_MASK,\n\t},\n\t{\n\t\t.label = \"mgmt:green\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LED7_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_LED_LO_NIBBLE_MASK,\n\t},\n\t{\n\t\t.label = \"mgmt:orange\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LED7_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_LED_LO_NIBBLE_MASK,\n\t},\n};\n\nstatic struct mlxreg_core_platform_data mlxplat_modular_led_data = {\n\t\t.data = mlxplat_mlxcpld_modular_led_data,\n\t\t.counter = ARRAY_SIZE(mlxplat_mlxcpld_modular_led_data),\n};\n\n \nstatic struct mlxreg_core_data mlxplat_mlxcpld_l1_switch_led_data[] = {\n\t{\n\t\t.label = \"status:green\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LED1_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_LED_LO_NIBBLE_MASK,\n\t},\n\t{\n\t\t.label = \"status:orange\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LED1_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_LED_LO_NIBBLE_MASK\n\t},\n\t{\n\t\t.label = \"fan1:green\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LED2_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_LED_LO_NIBBLE_MASK,\n\t\t.capability = MLXPLAT_CPLD_LPC_REG_FAN_DRW_CAP_OFFSET,\n\t\t.bit = BIT(0),\n\t},\n\t{\n\t\t.label = \"fan1:orange\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LED2_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_LED_LO_NIBBLE_MASK,\n\t\t.capability = MLXPLAT_CPLD_LPC_REG_FAN_DRW_CAP_OFFSET,\n\t\t.bit = BIT(0),\n\t},\n\t{\n\t\t.label = \"fan2:green\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LED2_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_LED_HI_NIBBLE_MASK,\n\t\t.capability = MLXPLAT_CPLD_LPC_REG_FAN_DRW_CAP_OFFSET,\n\t\t.bit = BIT(1),\n\t},\n\t{\n\t\t.label = \"fan2:orange\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LED2_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_LED_HI_NIBBLE_MASK,\n\t\t.capability = MLXPLAT_CPLD_LPC_REG_FAN_DRW_CAP_OFFSET,\n\t\t.bit = BIT(1),\n\t},\n\t{\n\t\t.label = \"fan3:green\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LED3_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_LED_LO_NIBBLE_MASK,\n\t\t.capability = MLXPLAT_CPLD_LPC_REG_FAN_DRW_CAP_OFFSET,\n\t\t.bit = BIT(2),\n\t},\n\t{\n\t\t.label = \"fan3:orange\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LED3_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_LED_LO_NIBBLE_MASK,\n\t\t.capability = MLXPLAT_CPLD_LPC_REG_FAN_DRW_CAP_OFFSET,\n\t\t.bit = BIT(2),\n\t},\n\t{\n\t\t.label = \"fan4:green\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LED3_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_LED_HI_NIBBLE_MASK,\n\t\t.capability = MLXPLAT_CPLD_LPC_REG_FAN_DRW_CAP_OFFSET,\n\t\t.bit = BIT(3),\n\t},\n\t{\n\t\t.label = \"fan4:orange\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LED3_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_LED_HI_NIBBLE_MASK,\n\t\t.capability = MLXPLAT_CPLD_LPC_REG_FAN_DRW_CAP_OFFSET,\n\t\t.bit = BIT(3),\n\t},\n\t{\n\t\t.label = \"fan5:green\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LED4_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_LED_LO_NIBBLE_MASK,\n\t\t.capability = MLXPLAT_CPLD_LPC_REG_FAN_DRW_CAP_OFFSET,\n\t\t.bit = BIT(4),\n\t},\n\t{\n\t\t.label = \"fan5:orange\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LED4_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_LED_LO_NIBBLE_MASK,\n\t\t.capability = MLXPLAT_CPLD_LPC_REG_FAN_DRW_CAP_OFFSET,\n\t\t.bit = BIT(4),\n\t},\n\t{\n\t\t.label = \"fan6:green\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LED4_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_LED_HI_NIBBLE_MASK,\n\t\t.capability = MLXPLAT_CPLD_LPC_REG_FAN_DRW_CAP_OFFSET,\n\t\t.bit = BIT(5),\n\t},\n\t{\n\t\t.label = \"fan6:orange\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LED4_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_LED_HI_NIBBLE_MASK,\n\t\t.capability = MLXPLAT_CPLD_LPC_REG_FAN_DRW_CAP_OFFSET,\n\t\t.bit = BIT(5),\n\t},\n\t{\n\t\t.label = \"uid:blue\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LED5_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_LED_LO_NIBBLE_MASK,\n\t},\n};\n\nstatic struct mlxreg_core_platform_data mlxplat_l1_switch_led_data = {\n\t\t.data = mlxplat_mlxcpld_l1_switch_led_data,\n\t\t.counter = ARRAY_SIZE(mlxplat_mlxcpld_l1_switch_led_data),\n};\n\n \nstatic struct mlxreg_core_data mlxplat_mlxcpld_default_regs_io_data[] = {\n\t{\n\t\t.label = \"cpld1_version\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_CPLD1_VER_OFFSET,\n\t\t.bit = GENMASK(7, 0),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"cpld2_version\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_CPLD2_VER_OFFSET,\n\t\t.bit = GENMASK(7, 0),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"cpld1_pn\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_CPLD1_PN_OFFSET,\n\t\t.bit = GENMASK(15, 0),\n\t\t.mode = 0444,\n\t\t.regnum = 2,\n\t},\n\t{\n\t\t.label = \"cpld2_pn\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_CPLD2_PN_OFFSET,\n\t\t.bit = GENMASK(15, 0),\n\t\t.mode = 0444,\n\t\t.regnum = 2,\n\t},\n\t{\n\t\t.label = \"cpld1_version_min\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_CPLD1_MVER_OFFSET,\n\t\t.bit = GENMASK(7, 0),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"cpld2_version_min\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_CPLD2_MVER_OFFSET,\n\t\t.bit = GENMASK(7, 0),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"reset_long_pb\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_RESET_CAUSE_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(0),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"reset_short_pb\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_RESET_CAUSE_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(1),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"reset_aux_pwr_or_ref\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_RESET_CAUSE_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(2),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"reset_main_pwr_fail\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_RESET_CAUSE_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(3),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"reset_sw_reset\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_RESET_CAUSE_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(4),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"reset_fw_reset\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_RESET_CAUSE_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(5),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"reset_hotswap_or_wd\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_RESET_CAUSE_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(6),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"reset_asic_thermal\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_RESET_CAUSE_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(7),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"psu1_on\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_GP1_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(0),\n\t\t.mode = 0200,\n\t},\n\t{\n\t\t.label = \"psu2_on\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_GP1_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(1),\n\t\t.mode = 0200,\n\t},\n\t{\n\t\t.label = \"pwr_cycle\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_GP1_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(2),\n\t\t.mode = 0200,\n\t},\n\t{\n\t\t.label = \"pwr_down\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_GP1_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(3),\n\t\t.mode = 0200,\n\t},\n\t{\n\t\t.label = \"select_iio\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_GP2_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(6),\n\t\t.mode = 0644,\n\t},\n\t{\n\t\t.label = \"asic_health\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_ASIC_HEALTH_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_ASIC_MASK,\n\t\t.bit = 1,\n\t\t.mode = 0444,\n\t},\n};\n\nstatic struct mlxreg_core_platform_data mlxplat_default_regs_io_data = {\n\t\t.data = mlxplat_mlxcpld_default_regs_io_data,\n\t\t.counter = ARRAY_SIZE(mlxplat_mlxcpld_default_regs_io_data),\n};\n\n \nstatic struct mlxreg_core_data mlxplat_mlxcpld_msn21xx_regs_io_data[] = {\n\t{\n\t\t.label = \"cpld1_version\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_CPLD1_VER_OFFSET,\n\t\t.bit = GENMASK(7, 0),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"cpld2_version\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_CPLD2_VER_OFFSET,\n\t\t.bit = GENMASK(7, 0),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"cpld1_pn\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_CPLD1_PN_OFFSET,\n\t\t.bit = GENMASK(15, 0),\n\t\t.mode = 0444,\n\t\t.regnum = 2,\n\t},\n\t{\n\t\t.label = \"cpld2_pn\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_CPLD2_PN_OFFSET,\n\t\t.bit = GENMASK(15, 0),\n\t\t.mode = 0444,\n\t\t.regnum = 2,\n\t},\n\t{\n\t\t.label = \"cpld1_version_min\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_CPLD1_MVER_OFFSET,\n\t\t.bit = GENMASK(7, 0),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"cpld2_version_min\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_CPLD2_MVER_OFFSET,\n\t\t.bit = GENMASK(7, 0),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"reset_long_pb\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_RESET_CAUSE_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(0),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"reset_short_pb\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_RESET_CAUSE_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(1),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"reset_aux_pwr_or_ref\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_RESET_CAUSE_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(2),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"reset_sw_reset\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_RESET_CAUSE_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(3),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"reset_main_pwr_fail\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_RESET_CAUSE_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(4),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"reset_asic_thermal\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_RESET_CAUSE_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(5),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"reset_hotswap_or_halt\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_RESET_CAUSE_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(6),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"reset_sff_wd\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_RST_CAUSE1_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(6),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"psu1_on\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_GP1_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(0),\n\t\t.mode = 0200,\n\t},\n\t{\n\t\t.label = \"psu2_on\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_GP1_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(1),\n\t\t.mode = 0200,\n\t},\n\t{\n\t\t.label = \"pwr_cycle\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_GP1_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(2),\n\t\t.mode = 0200,\n\t},\n\t{\n\t\t.label = \"pwr_down\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_GP1_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(3),\n\t\t.mode = 0200,\n\t},\n\t{\n\t\t.label = \"select_iio\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_GP2_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(6),\n\t\t.mode = 0644,\n\t},\n\t{\n\t\t.label = \"asic_health\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_ASIC_HEALTH_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_ASIC_MASK,\n\t\t.bit = 1,\n\t\t.mode = 0444,\n\t},\n};\n\nstatic struct mlxreg_core_platform_data mlxplat_msn21xx_regs_io_data = {\n\t\t.data = mlxplat_mlxcpld_msn21xx_regs_io_data,\n\t\t.counter = ARRAY_SIZE(mlxplat_mlxcpld_msn21xx_regs_io_data),\n};\n\n \nstatic struct mlxreg_core_data mlxplat_mlxcpld_default_ng_regs_io_data[] = {\n\t{\n\t\t.label = \"cpld1_version\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_CPLD1_VER_OFFSET,\n\t\t.bit = GENMASK(7, 0),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"cpld2_version\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_CPLD2_VER_OFFSET,\n\t\t.bit = GENMASK(7, 0),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"cpld3_version\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_CPLD3_VER_OFFSET,\n\t\t.bit = GENMASK(7, 0),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"cpld4_version\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_CPLD4_VER_OFFSET,\n\t\t.bit = GENMASK(7, 0),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"cpld5_version\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_CPLD5_VER_OFFSET,\n\t\t.bit = GENMASK(7, 0),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"cpld1_pn\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_CPLD1_PN_OFFSET,\n\t\t.bit = GENMASK(15, 0),\n\t\t.mode = 0444,\n\t\t.regnum = 2,\n\t},\n\t{\n\t\t.label = \"cpld2_pn\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_CPLD2_PN_OFFSET,\n\t\t.bit = GENMASK(15, 0),\n\t\t.mode = 0444,\n\t\t.regnum = 2,\n\t},\n\t{\n\t\t.label = \"cpld3_pn\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_CPLD3_PN_OFFSET,\n\t\t.bit = GENMASK(15, 0),\n\t\t.mode = 0444,\n\t\t.regnum = 2,\n\t},\n\t{\n\t\t.label = \"cpld4_pn\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_CPLD4_PN_OFFSET,\n\t\t.bit = GENMASK(15, 0),\n\t\t.mode = 0444,\n\t\t.regnum = 2,\n\t},\n\t{\n\t\t.label = \"cpld5_pn\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_CPLD5_PN_OFFSET,\n\t\t.bit = GENMASK(15, 0),\n\t\t.mode = 0444,\n\t\t.regnum = 2,\n\t},\n\t{\n\t\t.label = \"cpld1_version_min\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_CPLD1_MVER_OFFSET,\n\t\t.bit = GENMASK(7, 0),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"cpld2_version_min\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_CPLD2_MVER_OFFSET,\n\t\t.bit = GENMASK(7, 0),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"cpld3_version_min\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_CPLD3_MVER_OFFSET,\n\t\t.bit = GENMASK(7, 0),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"cpld4_version_min\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_CPLD4_MVER_OFFSET,\n\t\t.bit = GENMASK(7, 0),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"cpld5_version_min\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_CPLD5_MVER_OFFSET,\n\t\t.bit = GENMASK(7, 0),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"asic_reset\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_RESET_GP2_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(3),\n\t\t.mode = 0200,\n\t},\n\t{\n\t\t.label = \"asic2_reset\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_RESET_GP2_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(2),\n\t\t.mode = 0200,\n\t},\n\t{\n\t\t.label = \"erot1_reset\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_RESET_GP2_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(6),\n\t\t.mode = 0644,\n\t},\n\t{\n\t\t.label = \"erot2_reset\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_RESET_GP2_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(7),\n\t\t.mode = 0644,\n\t},\n\t{\n\t\t.label = \"clk_brd_prog_en\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_PWM_CONTROL_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(1),\n\t\t.mode = 0644,\n\t\t.secured = 1,\n\t},\n\t{\n\t\t.label = \"erot1_recovery\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_PWM_CONTROL_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(6),\n\t\t.mode = 0644,\n\t},\n\t{\n\t\t.label = \"erot2_recovery\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_PWM_CONTROL_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(7),\n\t\t.mode = 0644,\n\t},\n\t{\n\t\t.label = \"erot1_wp\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_PWM_CONTROL_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(4),\n\t\t.mode = 0644,\n\t\t.secured = 1,\n\t},\n\t{\n\t\t.label = \"erot2_wp\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_PWM_CONTROL_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(5),\n\t\t.mode = 0644,\n\t\t.secured = 1,\n\t},\n\t{\n\t\t.label = \"reset_long_pb\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_RESET_CAUSE_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(0),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"reset_short_pb\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_RESET_CAUSE_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(1),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"reset_aux_pwr_or_ref\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_RESET_CAUSE_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(2),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"reset_swb_dc_dc_pwr_fail\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_RESET_CAUSE_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(3),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"reset_from_asic\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_RESET_CAUSE_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(5),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"reset_swb_wd\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_RESET_CAUSE_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(6),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"reset_asic_thermal\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_RESET_CAUSE_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(7),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"reset_sw_reset\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_RST_CAUSE1_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(0),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"reset_comex_pwr_fail\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_RST_CAUSE1_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(3),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"reset_platform\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_RST_CAUSE1_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(4),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"reset_soc\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_RST_CAUSE1_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(5),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"reset_comex_wd\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_RST_CAUSE1_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(6),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"reset_pwr_converter_fail\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_RST_CAUSE2_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(0),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"reset_system\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_RST_CAUSE2_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(1),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"reset_sw_pwr_off\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_RST_CAUSE2_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(2),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"reset_comex_thermal\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_RST_CAUSE2_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(3),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"reset_reload_bios\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_RST_CAUSE2_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(5),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"reset_ac_pwr_fail\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_RST_CAUSE2_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(6),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"reset_ac_ok_fail\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_RST_CAUSE2_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(7),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"psu1_on\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_GP1_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(0),\n\t\t.mode = 0200,\n\t},\n\t{\n\t\t.label = \"psu2_on\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_GP1_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(1),\n\t\t.mode = 0200,\n\t},\n\t{\n\t\t.label = \"pwr_cycle\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_GP1_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(2),\n\t\t.mode = 0200,\n\t},\n\t{\n\t\t.label = \"pwr_down\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_GP1_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(3),\n\t\t.mode = 0200,\n\t},\n\t{\n\t\t.label = \"deep_pwr_cycle\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_GP1_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(5),\n\t\t.mode = 0200,\n\t},\n\t{\n\t\t.label = \"latch_reset\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_GP1_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(6),\n\t\t.mode = 0200,\n\t},\n\t{\n\t\t.label = \"jtag_cap\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_FU_CAP_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_FU_CAP_MASK,\n\t\t.bit = 1,\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"jtag_enable\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_GP2_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(4),\n\t\t.mode = 0644,\n\t},\n\t{\n\t\t.label = \"dbg1\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_DBG1_OFFSET,\n\t\t.bit = GENMASK(7, 0),\n\t\t.mode = 0644,\n\t},\n\t{\n\t\t.label = \"dbg2\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_DBG2_OFFSET,\n\t\t.bit = GENMASK(7, 0),\n\t\t.mode = 0644,\n\t},\n\t{\n\t\t.label = \"dbg3\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_DBG3_OFFSET,\n\t\t.bit = GENMASK(7, 0),\n\t\t.mode = 0644,\n\t},\n\t{\n\t\t.label = \"dbg4\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_DBG4_OFFSET,\n\t\t.bit = GENMASK(7, 0),\n\t\t.mode = 0644,\n\t},\n\t{\n\t\t.label = \"asic_health\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_ASIC_HEALTH_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_ASIC_MASK,\n\t\t.bit = 1,\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"asic2_health\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_ASIC2_HEALTH_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_ASIC_MASK,\n\t\t.bit = 1,\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"fan_dir\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_FAN_DIRECTION,\n\t\t.bit = GENMASK(7, 0),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"bios_safe_mode\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_GPCOM0_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(4),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"bios_active_image\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_GPCOM0_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(5),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"bios_auth_fail\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_GPCOM0_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(6),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"bios_upgrade_fail\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_GPCOM0_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(7),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"voltreg_update_status\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_GP0_RO_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_VOLTREG_UPD_MASK,\n\t\t.bit = 5,\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"pwr_converter_prog_en\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_GP0_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(0),\n\t\t.mode = 0644,\n\t\t.secured = 1,\n\t},\n\t{\n\t\t.label = \"vpd_wp\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_GP0_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(3),\n\t\t.mode = 0644,\n\t},\n\t{\n\t\t.label = \"pcie_asic_reset_dis\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_GP0_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(4),\n\t\t.mode = 0644,\n\t},\n\t{\n\t\t.label = \"erot1_ap_reset\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_GP4_RO_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(0),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"erot2_ap_reset\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_GP4_RO_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(1),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"lid_open\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_GP4_RO_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(2),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"clk_brd1_boot_fail\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_GP4_RO_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(4),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"clk_brd2_boot_fail\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_GP4_RO_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(5),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"clk_brd_fail\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_GP4_RO_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(6),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"asic_pg_fail\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_GP4_RO_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(7),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"spi_chnl_select\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_SPI_CHNL_SELECT,\n\t\t.mask = GENMASK(7, 0),\n\t\t.bit = 1,\n\t\t.mode = 0644,\n\t},\n\t{\n\t\t.label = \"config1\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_CONFIG1_OFFSET,\n\t\t.bit = GENMASK(7, 0),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"config2\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_CONFIG2_OFFSET,\n\t\t.bit = GENMASK(7, 0),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"config3\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_CONFIG3_OFFSET,\n\t\t.bit = GENMASK(7, 0),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"ufm_version\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_UFM_VERSION_OFFSET,\n\t\t.bit = GENMASK(7, 0),\n\t\t.mode = 0444,\n\t},\n};\n\nstatic struct mlxreg_core_platform_data mlxplat_default_ng_regs_io_data = {\n\t\t.data = mlxplat_mlxcpld_default_ng_regs_io_data,\n\t\t.counter = ARRAY_SIZE(mlxplat_mlxcpld_default_ng_regs_io_data),\n};\n\n \nstatic struct mlxreg_core_data mlxplat_mlxcpld_modular_regs_io_data[] = {\n\t{\n\t\t.label = \"cpld1_version\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_CPLD1_VER_OFFSET,\n\t\t.bit = GENMASK(7, 0),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"cpld2_version\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_CPLD2_VER_OFFSET,\n\t\t.bit = GENMASK(7, 0),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"cpld3_version\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_CPLD3_VER_OFFSET,\n\t\t.bit = GENMASK(7, 0),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"cpld4_version\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_CPLD4_VER_OFFSET,\n\t\t.bit = GENMASK(7, 0),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"cpld1_pn\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_CPLD1_PN_OFFSET,\n\t\t.bit = GENMASK(15, 0),\n\t\t.mode = 0444,\n\t\t.regnum = 2,\n\t},\n\t{\n\t\t.label = \"cpld2_pn\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_CPLD2_PN_OFFSET,\n\t\t.bit = GENMASK(15, 0),\n\t\t.mode = 0444,\n\t\t.regnum = 2,\n\t},\n\t{\n\t\t.label = \"cpld3_pn\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_CPLD3_PN_OFFSET,\n\t\t.bit = GENMASK(15, 0),\n\t\t.mode = 0444,\n\t\t.regnum = 2,\n\t},\n\t{\n\t\t.label = \"cpld4_pn\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_CPLD4_PN_OFFSET,\n\t\t.bit = GENMASK(15, 0),\n\t\t.mode = 0444,\n\t\t.regnum = 2,\n\t},\n\t{\n\t\t.label = \"cpld1_version_min\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_CPLD1_MVER_OFFSET,\n\t\t.bit = GENMASK(7, 0),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"cpld2_version_min\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_CPLD2_MVER_OFFSET,\n\t\t.bit = GENMASK(7, 0),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"cpld3_version_min\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_CPLD3_MVER_OFFSET,\n\t\t.bit = GENMASK(7, 0),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"cpld4_version_min\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_CPLD4_MVER_OFFSET,\n\t\t.bit = GENMASK(7, 0),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"lc1_enable\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_RESET_GP4_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(0),\n\t\t.mode = 0644,\n\t},\n\t{\n\t\t.label = \"lc2_enable\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_RESET_GP4_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(1),\n\t\t.mode = 0644,\n\t},\n\t{\n\t\t.label = \"lc3_enable\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_RESET_GP4_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(2),\n\t\t.mode = 0644,\n\t},\n\t{\n\t\t.label = \"lc4_enable\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_RESET_GP4_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(3),\n\t\t.mode = 0644,\n\t},\n\t{\n\t\t.label = \"lc5_enable\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_RESET_GP4_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(4),\n\t\t.mode = 0644,\n\t},\n\t{\n\t\t.label = \"lc6_enable\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_RESET_GP4_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(5),\n\t\t.mode = 0644,\n\t},\n\t{\n\t\t.label = \"lc7_enable\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_RESET_GP4_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(6),\n\t\t.mode = 0644,\n\t},\n\t{\n\t\t.label = \"lc8_enable\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_RESET_GP4_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(7),\n\t\t.mode = 0644,\n\t},\n\t{\n\t\t.label = \"reset_long_pb\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_RESET_CAUSE_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(0),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"reset_short_pb\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_RESET_CAUSE_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(1),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"reset_aux_pwr_or_fu\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_RESET_CAUSE_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(2),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"reset_mgmt_dc_dc_pwr_fail\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_RESET_CAUSE_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(3),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"reset_sys_comex_bios\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_RESET_CAUSE_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(5),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"reset_sw_reset\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_RST_CAUSE1_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(0),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"reset_aux_pwr_or_reload\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_RST_CAUSE1_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(2),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"reset_comex_pwr_fail\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_RST_CAUSE1_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(3),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"reset_platform\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_RST_CAUSE1_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(4),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"reset_soc\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_RST_CAUSE1_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(5),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"reset_pwr_off_from_carrier\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_RST_CAUSE1_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(7),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"reset_swb_wd\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_RST_CAUSE2_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(0),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"reset_swb_aux_pwr_or_fu\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_RESET_CAUSE_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(2),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"reset_swb_dc_dc_pwr_fail\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_RST_CAUSE2_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(3),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"reset_swb_12v_fail\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_RST_CAUSE2_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(4),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"reset_system\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_RST_CAUSE2_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(5),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"reset_thermal_spc_or_pciesw\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_RST_CAUSE2_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(7),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"bios_safe_mode\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_GPCOM0_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(4),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"bios_active_image\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_GPCOM0_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(5),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"bios_auth_fail\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_GPCOM0_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(6),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"bios_upgrade_fail\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_GPCOM0_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(7),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"voltreg_update_status\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_GP0_RO_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_VOLTREG_UPD_MASK,\n\t\t.bit = 5,\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"vpd_wp\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_GP0_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(3),\n\t\t.mode = 0644,\n\t},\n\t{\n\t\t.label = \"pcie_asic_reset_dis\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_GP0_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(4),\n\t\t.mode = 0644,\n\t},\n\t{\n\t\t.label = \"shutdown_unlock\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_GP0_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(5),\n\t\t.mode = 0644,\n\t},\n\t{\n\t\t.label = \"lc1_rst_mask\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_GP_RST_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(0),\n\t\t.mode = 0200,\n\t},\n\t{\n\t\t.label = \"lc2_rst_mask\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_GP_RST_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(1),\n\t\t.mode = 0200,\n\t},\n\t{\n\t\t.label = \"lc3_rst_mask\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_GP_RST_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(2),\n\t\t.mode = 0200,\n\t},\n\t{\n\t\t.label = \"lc4_rst_mask\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_GP_RST_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(3),\n\t\t.mode = 0200,\n\t},\n\t{\n\t\t.label = \"lc5_rst_mask\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_GP_RST_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(4),\n\t\t.mode = 0200,\n\t},\n\t{\n\t\t.label = \"lc6_rst_mask\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_GP_RST_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(5),\n\t\t.mode = 0200,\n\t},\n\t{\n\t\t.label = \"lc7_rst_mask\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_GP_RST_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(6),\n\t\t.mode = 0200,\n\t},\n\t{\n\t\t.label = \"lc8_rst_mask\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_GP_RST_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(7),\n\t\t.mode = 0200,\n\t},\n\t{\n\t\t.label = \"psu1_on\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_GP1_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(0),\n\t\t.mode = 0200,\n\t},\n\t{\n\t\t.label = \"psu2_on\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_GP1_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(1),\n\t\t.mode = 0200,\n\t},\n\t{\n\t\t.label = \"pwr_cycle\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_GP1_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(2),\n\t\t.mode = 0200,\n\t},\n\t{\n\t\t.label = \"pwr_down\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_GP1_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(3),\n\t\t.mode = 0200,\n\t},\n\t{\n\t\t.label = \"psu3_on\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_GP1_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(4),\n\t\t.mode = 0200,\n\t},\n\t{\n\t\t.label = \"psu4_on\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_GP1_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(5),\n\t\t.mode = 0200,\n\t},\n\t{\n\t\t.label = \"auto_power_mode\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_GP1_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(6),\n\t\t.mode = 0644,\n\t},\n\t{\n\t\t.label = \"pm_mgmt_en\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_GP1_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(7),\n\t\t.mode = 0644,\n\t},\n\t{\n\t\t.label = \"jtag_enable\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_FIELD_UPGRADE,\n\t\t.mask = GENMASK(3, 0),\n\t\t.bit = 1,\n\t\t.mode = 0644,\n\t},\n\t{\n\t\t.label = \"safe_bios_dis\",\n\t\t.reg = MLXPLAT_CPLD_LPC_SAFE_BIOS_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(5),\n\t\t.mode = 0644,\n\t},\n\t{\n\t\t.label = \"safe_bios_dis_wp\",\n\t\t.reg = MLXPLAT_CPLD_LPC_SAFE_BIOS_WP_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(5),\n\t\t.mode = 0644,\n\t},\n\t{\n\t\t.label = \"asic_health\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_ASIC_HEALTH_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_ASIC_MASK,\n\t\t.bit = 1,\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"fan_dir\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_FAN_DIRECTION,\n\t\t.bit = GENMASK(7, 0),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"lc1_pwr\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LC_PWR_ON,\n\t\t.mask = GENMASK(7, 0) & ~BIT(0),\n\t\t.mode = 0644,\n\t},\n\t{\n\t\t.label = \"lc2_pwr\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LC_PWR_ON,\n\t\t.mask = GENMASK(7, 0) & ~BIT(1),\n\t\t.mode = 0644,\n\t},\n\t{\n\t\t.label = \"lc3_pwr\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LC_PWR_ON,\n\t\t.mask = GENMASK(7, 0) & ~BIT(2),\n\t\t.mode = 0644,\n\t},\n\t{\n\t\t.label = \"lc4_pwr\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LC_PWR_ON,\n\t\t.mask = GENMASK(7, 0) & ~BIT(3),\n\t\t.mode = 0644,\n\t},\n\t{\n\t\t.label = \"lc5_pwr\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LC_PWR_ON,\n\t\t.mask = GENMASK(7, 0) & ~BIT(4),\n\t\t.mode = 0644,\n\t},\n\t{\n\t\t.label = \"lc6_pwr\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LC_PWR_ON,\n\t\t.mask = GENMASK(7, 0) & ~BIT(5),\n\t\t.mode = 0644,\n\t},\n\t{\n\t\t.label = \"lc7_pwr\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LC_PWR_ON,\n\t\t.mask = GENMASK(7, 0) & ~BIT(6),\n\t\t.mode = 0644,\n\t},\n\t{\n\t\t.label = \"lc8_pwr\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_LC_PWR_ON,\n\t\t.mask = GENMASK(7, 0) & ~BIT(7),\n\t\t.mode = 0644,\n\t},\n\t{\n\t\t.label = \"config1\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_CONFIG1_OFFSET,\n\t\t.bit = GENMASK(7, 0),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"config2\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_CONFIG2_OFFSET,\n\t\t.bit = GENMASK(7, 0),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"config3\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_CONFIG3_OFFSET,\n\t\t.bit = GENMASK(7, 0),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"ufm_version\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_UFM_VERSION_OFFSET,\n\t\t.bit = GENMASK(7, 0),\n\t\t.mode = 0444,\n\t},\n};\n\nstatic struct mlxreg_core_platform_data mlxplat_modular_regs_io_data = {\n\t\t.data = mlxplat_mlxcpld_modular_regs_io_data,\n\t\t.counter = ARRAY_SIZE(mlxplat_mlxcpld_modular_regs_io_data),\n};\n\n \nstatic struct mlxreg_core_data mlxplat_mlxcpld_chassis_blade_regs_io_data[] = {\n\t{\n\t\t.label = \"cpld1_version\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_CPLD1_VER_OFFSET,\n\t\t.bit = GENMASK(7, 0),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"cpld1_pn\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_CPLD1_PN_OFFSET,\n\t\t.bit = GENMASK(15, 0),\n\t\t.mode = 0444,\n\t\t.regnum = 2,\n\t},\n\t{\n\t\t.label = \"cpld1_version_min\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_CPLD1_MVER_OFFSET,\n\t\t.bit = GENMASK(7, 0),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"reset_aux_pwr_or_ref\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_RESET_CAUSE_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(2),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"reset_from_comex\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_RESET_CAUSE_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(4),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"reset_comex_pwr_fail\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_RST_CAUSE1_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(3),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"reset_platform\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_RST_CAUSE1_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(4),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"reset_soc\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_RST_CAUSE1_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(5),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"reset_comex_wd\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_RST_CAUSE1_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(6),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"reset_voltmon_upgrade_fail\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_RST_CAUSE2_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(0),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"reset_system\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_RST_CAUSE2_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(1),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"reset_sw_pwr_off\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_RST_CAUSE2_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(2),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"reset_comex_thermal\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_RST_CAUSE2_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(3),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"reset_reload_bios\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_RST_CAUSE2_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(5),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"reset_ac_pwr_fail\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_RST_CAUSE2_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(6),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"reset_long_pwr_pb\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_RST_CAUSE2_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(7),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"pwr_cycle\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_GP1_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(2),\n\t\t.mode = 0200,\n\t},\n\t{\n\t\t.label = \"pwr_down\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_GP1_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(3),\n\t\t.mode = 0200,\n\t},\n\t{\n\t\t.label = \"global_wp_request\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_GP2_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(0),\n\t\t.mode = 0644,\n\t},\n\t{\n\t\t.label = \"jtag_enable\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_GP2_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(4),\n\t\t.mode = 0644,\n\t},\n\t{\n\t\t.label = \"comm_chnl_ready\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_GP2_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(6),\n\t\t.mode = 0200,\n\t},\n\t{\n\t\t.label = \"bios_safe_mode\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_GPCOM0_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(4),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"bios_active_image\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_GPCOM0_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(5),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"bios_auth_fail\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_GPCOM0_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(6),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"bios_upgrade_fail\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_GPCOM0_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(7),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"voltreg_update_status\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_GP0_RO_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_VOLTREG_UPD_MASK,\n\t\t.bit = 5,\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"vpd_wp\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_GP0_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(3),\n\t\t.mode = 0644,\n\t},\n\t{\n\t\t.label = \"pcie_asic_reset_dis\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_GP0_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(4),\n\t\t.mode = 0644,\n\t},\n\t{\n\t\t.label = \"global_wp_response\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_GWP_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(0),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"config1\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_CONFIG1_OFFSET,\n\t\t.bit = GENMASK(7, 0),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"config2\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_CONFIG2_OFFSET,\n\t\t.bit = GENMASK(7, 0),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"config3\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_CONFIG3_OFFSET,\n\t\t.bit = GENMASK(7, 0),\n\t\t.mode = 0444,\n\t},\n\t{\n\t\t.label = \"ufm_version\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_UFM_VERSION_OFFSET,\n\t\t.bit = GENMASK(7, 0),\n\t\t.mode = 0444,\n\t},\n};\n\nstatic struct mlxreg_core_platform_data mlxplat_chassis_blade_regs_io_data = {\n\t\t.data = mlxplat_mlxcpld_chassis_blade_regs_io_data,\n\t\t.counter = ARRAY_SIZE(mlxplat_mlxcpld_chassis_blade_regs_io_data),\n};\n\n \nstatic struct mlxreg_core_data mlxplat_mlxcpld_default_fan_data[] = {\n\t{\n\t\t.label = \"pwm1\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_PWM1_OFFSET,\n\t},\n\t{\n\t\t.label = \"pwm2\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_PWM2_OFFSET,\n\t},\n\t{\n\t\t.label = \"pwm3\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_PWM3_OFFSET,\n\t},\n\t{\n\t\t.label = \"pwm4\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_PWM4_OFFSET,\n\t},\n\t{\n\t\t.label = \"tacho1\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_TACHO1_OFFSET,\n\t\t.mask = GENMASK(7, 0),\n\t\t.capability = MLXPLAT_CPLD_LPC_REG_FAN_CAP1_OFFSET,\n\t\t.bit = BIT(0),\n\t\t.reg_prsnt = MLXPLAT_CPLD_LPC_REG_FAN_OFFSET,\n\n\t},\n\t{\n\t\t.label = \"tacho2\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_TACHO2_OFFSET,\n\t\t.mask = GENMASK(7, 0),\n\t\t.capability = MLXPLAT_CPLD_LPC_REG_FAN_CAP1_OFFSET,\n\t\t.bit = BIT(1),\n\t\t.reg_prsnt = MLXPLAT_CPLD_LPC_REG_FAN_OFFSET,\n\t},\n\t{\n\t\t.label = \"tacho3\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_TACHO3_OFFSET,\n\t\t.mask = GENMASK(7, 0),\n\t\t.capability = MLXPLAT_CPLD_LPC_REG_FAN_CAP1_OFFSET,\n\t\t.bit = BIT(2),\n\t\t.reg_prsnt = MLXPLAT_CPLD_LPC_REG_FAN_OFFSET,\n\t},\n\t{\n\t\t.label = \"tacho4\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_TACHO4_OFFSET,\n\t\t.mask = GENMASK(7, 0),\n\t\t.capability = MLXPLAT_CPLD_LPC_REG_FAN_CAP1_OFFSET,\n\t\t.bit = BIT(3),\n\t\t.reg_prsnt = MLXPLAT_CPLD_LPC_REG_FAN_OFFSET,\n\t},\n\t{\n\t\t.label = \"tacho5\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_TACHO5_OFFSET,\n\t\t.mask = GENMASK(7, 0),\n\t\t.capability = MLXPLAT_CPLD_LPC_REG_FAN_CAP1_OFFSET,\n\t\t.bit = BIT(4),\n\t\t.reg_prsnt = MLXPLAT_CPLD_LPC_REG_FAN_OFFSET,\n\t},\n\t{\n\t\t.label = \"tacho6\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_TACHO6_OFFSET,\n\t\t.mask = GENMASK(7, 0),\n\t\t.capability = MLXPLAT_CPLD_LPC_REG_FAN_CAP1_OFFSET,\n\t\t.bit = BIT(5),\n\t\t.reg_prsnt = MLXPLAT_CPLD_LPC_REG_FAN_OFFSET,\n\t},\n\t{\n\t\t.label = \"tacho7\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_TACHO7_OFFSET,\n\t\t.mask = GENMASK(7, 0),\n\t\t.capability = MLXPLAT_CPLD_LPC_REG_FAN_CAP1_OFFSET,\n\t\t.bit = BIT(6),\n\t\t.reg_prsnt = MLXPLAT_CPLD_LPC_REG_FAN_OFFSET,\n\t},\n\t{\n\t\t.label = \"tacho8\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_TACHO8_OFFSET,\n\t\t.mask = GENMASK(7, 0),\n\t\t.capability = MLXPLAT_CPLD_LPC_REG_FAN_CAP1_OFFSET,\n\t\t.bit = BIT(7),\n\t\t.reg_prsnt = MLXPLAT_CPLD_LPC_REG_FAN_OFFSET,\n\t},\n\t{\n\t\t.label = \"tacho9\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_TACHO9_OFFSET,\n\t\t.mask = GENMASK(7, 0),\n\t\t.capability = MLXPLAT_CPLD_LPC_REG_FAN_CAP2_OFFSET,\n\t\t.bit = BIT(0),\n\t\t.reg_prsnt = MLXPLAT_CPLD_LPC_REG_FAN_OFFSET,\n\t},\n\t{\n\t\t.label = \"tacho10\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_TACHO10_OFFSET,\n\t\t.mask = GENMASK(7, 0),\n\t\t.capability = MLXPLAT_CPLD_LPC_REG_FAN_CAP2_OFFSET,\n\t\t.bit = BIT(1),\n\t\t.reg_prsnt = MLXPLAT_CPLD_LPC_REG_FAN_OFFSET,\n\t},\n\t{\n\t\t.label = \"tacho11\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_TACHO11_OFFSET,\n\t\t.mask = GENMASK(7, 0),\n\t\t.capability = MLXPLAT_CPLD_LPC_REG_FAN_CAP2_OFFSET,\n\t\t.bit = BIT(2),\n\t\t.reg_prsnt = MLXPLAT_CPLD_LPC_REG_FAN_OFFSET,\n\t},\n\t{\n\t\t.label = \"tacho12\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_TACHO12_OFFSET,\n\t\t.mask = GENMASK(7, 0),\n\t\t.capability = MLXPLAT_CPLD_LPC_REG_FAN_CAP2_OFFSET,\n\t\t.bit = BIT(3),\n\t\t.reg_prsnt = MLXPLAT_CPLD_LPC_REG_FAN_OFFSET,\n\t},\n\t{\n\t\t.label = \"tacho13\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_TACHO13_OFFSET,\n\t\t.mask = GENMASK(7, 0),\n\t\t.capability = MLXPLAT_CPLD_LPC_REG_FAN_CAP2_OFFSET,\n\t\t.bit = BIT(4),\n\t},\n\t{\n\t\t.label = \"tacho14\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_TACHO14_OFFSET,\n\t\t.mask = GENMASK(7, 0),\n\t\t.capability = MLXPLAT_CPLD_LPC_REG_FAN_CAP2_OFFSET,\n\t\t.bit = BIT(5),\n\t},\n\t{\n\t\t.label = \"conf\",\n\t\t.capability = MLXPLAT_CPLD_LPC_REG_TACHO_SPEED_OFFSET,\n\t},\n};\n\nstatic struct mlxreg_core_platform_data mlxplat_default_fan_data = {\n\t\t.data = mlxplat_mlxcpld_default_fan_data,\n\t\t.counter = ARRAY_SIZE(mlxplat_mlxcpld_default_fan_data),\n\t\t.capability = MLXPLAT_CPLD_LPC_REG_FAN_DRW_CAP_OFFSET,\n};\n\n \nstatic struct mlxreg_core_data mlxplat_mlxcpld_wd_main_regs_type1[] = {\n\t{\n\t\t.label = \"action\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_WD1_ACT_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_WD_RESET_ACT_MASK,\n\t\t.bit = 0,\n\t},\n\t{\n\t\t.label = \"timeout\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_WD1_TMR_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_WD_TYPE1_TO_MASK,\n\t\t.health_cntr = MLXPLAT_CPLD_WD_DFLT_TIMEOUT,\n\t},\n\t{\n\t\t.label = \"ping\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_WD_CLEAR_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_WD1_CLEAR_MASK,\n\t\t.bit = 0,\n\t},\n\t{\n\t\t.label = \"reset\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_RESET_CAUSE_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(6),\n\t\t.bit = 6,\n\t},\n};\n\nstatic struct mlxreg_core_data mlxplat_mlxcpld_wd_aux_regs_type1[] = {\n\t{\n\t\t.label = \"action\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_WD2_ACT_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_WD_FAN_ACT_MASK,\n\t\t.bit = 4,\n\t},\n\t{\n\t\t.label = \"timeout\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_WD2_TMR_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_WD_TYPE1_TO_MASK,\n\t\t.health_cntr = MLXPLAT_CPLD_WD_DFLT_TIMEOUT,\n\t},\n\t{\n\t\t.label = \"ping\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_WD_CLEAR_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_WD1_CLEAR_MASK,\n\t\t.bit = 1,\n\t},\n};\n\nstatic struct mlxreg_core_platform_data mlxplat_mlxcpld_wd_set_type1[] = {\n\t{\n\t\t.data = mlxplat_mlxcpld_wd_main_regs_type1,\n\t\t.counter = ARRAY_SIZE(mlxplat_mlxcpld_wd_main_regs_type1),\n\t\t.version = MLX_WDT_TYPE1,\n\t\t.identity = \"mlx-wdt-main\",\n\t},\n\t{\n\t\t.data = mlxplat_mlxcpld_wd_aux_regs_type1,\n\t\t.counter = ARRAY_SIZE(mlxplat_mlxcpld_wd_aux_regs_type1),\n\t\t.version = MLX_WDT_TYPE1,\n\t\t.identity = \"mlx-wdt-aux\",\n\t},\n};\n\n \nstatic struct mlxreg_core_data mlxplat_mlxcpld_wd_main_regs_type2[] = {\n\t{\n\t\t.label = \"action\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_WD2_ACT_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_WD_RESET_ACT_MASK,\n\t\t.bit = 0,\n\t},\n\t{\n\t\t.label = \"timeout\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_WD2_TMR_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_WD_TYPE2_TO_MASK,\n\t\t.health_cntr = MLXPLAT_CPLD_WD_DFLT_TIMEOUT,\n\t},\n\t{\n\t\t.label = \"timeleft\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_WD2_TLEFT_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_WD_TYPE2_TO_MASK,\n\t},\n\t{\n\t\t.label = \"ping\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_WD2_ACT_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_WD_RESET_ACT_MASK,\n\t\t.bit = 0,\n\t},\n\t{\n\t\t.label = \"reset\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_RESET_CAUSE_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(6),\n\t\t.bit = 6,\n\t},\n};\n\nstatic struct mlxreg_core_data mlxplat_mlxcpld_wd_aux_regs_type2[] = {\n\t{\n\t\t.label = \"action\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_WD3_ACT_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_WD_FAN_ACT_MASK,\n\t\t.bit = 4,\n\t},\n\t{\n\t\t.label = \"timeout\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_WD3_TMR_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_WD_TYPE2_TO_MASK,\n\t\t.health_cntr = MLXPLAT_CPLD_WD_DFLT_TIMEOUT,\n\t},\n\t{\n\t\t.label = \"timeleft\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_WD3_TLEFT_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_WD_TYPE2_TO_MASK,\n\t},\n\t{\n\t\t.label = \"ping\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_WD3_ACT_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_WD_FAN_ACT_MASK,\n\t\t.bit = 4,\n\t},\n};\n\nstatic struct mlxreg_core_platform_data mlxplat_mlxcpld_wd_set_type2[] = {\n\t{\n\t\t.data = mlxplat_mlxcpld_wd_main_regs_type2,\n\t\t.counter = ARRAY_SIZE(mlxplat_mlxcpld_wd_main_regs_type2),\n\t\t.version = MLX_WDT_TYPE2,\n\t\t.identity = \"mlx-wdt-main\",\n\t},\n\t{\n\t\t.data = mlxplat_mlxcpld_wd_aux_regs_type2,\n\t\t.counter = ARRAY_SIZE(mlxplat_mlxcpld_wd_aux_regs_type2),\n\t\t.version = MLX_WDT_TYPE2,\n\t\t.identity = \"mlx-wdt-aux\",\n\t},\n};\n\n \nstatic struct mlxreg_core_data mlxplat_mlxcpld_wd_main_regs_type3[] = {\n\t{\n\t\t.label = \"action\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_WD2_ACT_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_WD_RESET_ACT_MASK,\n\t\t.bit = 0,\n\t},\n\t{\n\t\t.label = \"timeout\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_WD2_TMR_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_WD_TYPE2_TO_MASK,\n\t\t.health_cntr = MLXPLAT_CPLD_WD3_DFLT_TIMEOUT,\n\t},\n\t{\n\t\t.label = \"timeleft\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_WD2_TMR_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_WD_TYPE2_TO_MASK,\n\t},\n\t{\n\t\t.label = \"ping\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_WD2_ACT_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_WD_RESET_ACT_MASK,\n\t\t.bit = 0,\n\t},\n\t{\n\t\t.label = \"reset\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_RESET_CAUSE_OFFSET,\n\t\t.mask = GENMASK(7, 0) & ~BIT(6),\n\t\t.bit = 6,\n\t},\n};\n\nstatic struct mlxreg_core_data mlxplat_mlxcpld_wd_aux_regs_type3[] = {\n\t{\n\t\t.label = \"action\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_WD3_ACT_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_WD_FAN_ACT_MASK,\n\t\t.bit = 4,\n\t},\n\t{\n\t\t.label = \"timeout\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_WD3_TMR_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_WD_TYPE2_TO_MASK,\n\t\t.health_cntr = MLXPLAT_CPLD_WD3_DFLT_TIMEOUT,\n\t},\n\t{\n\t\t.label = \"timeleft\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_WD3_TMR_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_WD_TYPE2_TO_MASK,\n\t},\n\t{\n\t\t.label = \"ping\",\n\t\t.reg = MLXPLAT_CPLD_LPC_REG_WD3_ACT_OFFSET,\n\t\t.mask = MLXPLAT_CPLD_WD_FAN_ACT_MASK,\n\t\t.bit = 4,\n\t},\n};\n\nstatic struct mlxreg_core_platform_data mlxplat_mlxcpld_wd_set_type3[] = {\n\t{\n\t\t.data = mlxplat_mlxcpld_wd_main_regs_type3,\n\t\t.counter = ARRAY_SIZE(mlxplat_mlxcpld_wd_main_regs_type3),\n\t\t.version = MLX_WDT_TYPE3,\n\t\t.identity = \"mlx-wdt-main\",\n\t},\n\t{\n\t\t.data = mlxplat_mlxcpld_wd_aux_regs_type3,\n\t\t.counter = ARRAY_SIZE(mlxplat_mlxcpld_wd_aux_regs_type3),\n\t\t.version = MLX_WDT_TYPE3,\n\t\t.identity = \"mlx-wdt-aux\",\n\t},\n};\n\nstatic bool mlxplat_mlxcpld_writeable_reg(struct device *dev, unsigned int reg)\n{\n\tswitch (reg) {\n\tcase MLXPLAT_CPLD_LPC_REG_RESET_GP1_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_RESET_GP4_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_LED1_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_LED2_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_LED3_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_LED4_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_LED5_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_LED6_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_LED7_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_GP0_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_GP_RST_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_GP1_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_WP1_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_GP2_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_WP2_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_FIELD_UPGRADE:\n\tcase MLXPLAT_CPLD_LPC_SAFE_BIOS_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_SAFE_BIOS_WP_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_AGGR_MASK_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_FU_CAP_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_DBG1_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_DBG2_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_DBG3_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_DBG4_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_AGGRLO_MASK_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_AGGRCO_MASK_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_AGGRCX_MASK_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_GWP_EVENT_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_GWP_MASK_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_BRD_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_BRD_EVENT_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_BRD_MASK_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_ASIC_EVENT_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_ASIC_MASK_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_ASIC2_EVENT_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_ASIC2_MASK_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_PSU_EVENT_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_PSU_MASK_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_PWR_EVENT_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_PWR_MASK_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_FAN_EVENT_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_FAN_MASK_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_EROT_EVENT_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_EROT_MASK_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_EROTE_EVENT_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_EROTE_MASK_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_PWRB_EVENT_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_PWRB_MASK_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_AGGRLC_MASK_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_LC_IN_EVENT_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_LC_IN_MASK_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_LC_VR_EVENT_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_LC_VR_MASK_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_LC_PG_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_LC_PG_EVENT_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_LC_PG_MASK_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_LC_RD_EVENT_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_LC_RD_MASK_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_LC_OK_EVENT_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_LC_OK_MASK_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_LC_SN_EVENT_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_LC_SN_MASK_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_LC_SD_EVENT_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_LC_SD_MASK_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_LC_PWR_ON:\n\tcase MLXPLAT_CPLD_LPC_REG_SPI_CHNL_SELECT:\n\tcase MLXPLAT_CPLD_LPC_REG_WD_CLEAR_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_WD_CLEAR_WP_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_WD1_TMR_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_WD1_ACT_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_WD2_TMR_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_WD2_TLEFT_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_WD2_ACT_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_WD3_TMR_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_WD3_TLEFT_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_WD3_ACT_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_DBG_CTRL_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_I2C_CH1_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_I2C_CH2_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_I2C_CH3_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_I2C_CH4_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_PWM1_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_PWM2_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_PWM3_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_PWM4_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_PWM_CONTROL_OFFSET:\n\t\treturn true;\n\t}\n\treturn false;\n}\n\nstatic bool mlxplat_mlxcpld_readable_reg(struct device *dev, unsigned int reg)\n{\n\tswitch (reg) {\n\tcase MLXPLAT_CPLD_LPC_REG_CPLD1_VER_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_CPLD2_VER_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_CPLD3_VER_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_CPLD4_VER_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_CPLD5_VER_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_CPLD1_PN_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_CPLD1_PN1_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_CPLD2_PN_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_CPLD2_PN1_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_CPLD3_PN_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_CPLD3_PN1_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_CPLD4_PN_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_CPLD4_PN1_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_CPLD5_PN_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_CPLD5_PN1_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_RESET_GP1_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_RESET_GP4_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_RESET_CAUSE_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_RST_CAUSE1_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_RST_CAUSE2_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_LED1_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_LED2_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_LED3_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_LED4_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_LED5_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_LED6_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_LED7_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_FAN_DIRECTION:\n\tcase MLXPLAT_CPLD_LPC_REG_GP0_RO_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_GPCOM0_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_GP0_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_GP_RST_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_GP1_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_WP1_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_GP2_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_WP2_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_FIELD_UPGRADE:\n\tcase MLXPLAT_CPLD_LPC_SAFE_BIOS_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_SAFE_BIOS_WP_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_AGGR_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_AGGR_MASK_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_FU_CAP_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_DBG1_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_DBG2_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_DBG3_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_DBG4_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_AGGRLO_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_AGGRLO_MASK_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_AGGRCO_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_AGGRCO_MASK_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_AGGRCX_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_AGGRCX_MASK_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_GWP_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_GWP_EVENT_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_GWP_MASK_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_BRD_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_BRD_EVENT_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_BRD_MASK_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_ASIC_HEALTH_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_ASIC_EVENT_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_ASIC_MASK_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_ASIC2_HEALTH_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_ASIC2_EVENT_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_ASIC2_MASK_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_PSU_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_PSU_EVENT_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_PSU_MASK_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_PWR_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_PWR_EVENT_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_PWR_MASK_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_FAN_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_FAN_EVENT_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_FAN_MASK_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_EROT_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_EROT_EVENT_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_EROT_MASK_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_EROTE_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_EROTE_EVENT_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_EROTE_MASK_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_PWRB_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_PWRB_EVENT_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_PWRB_MASK_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_AGGRLC_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_AGGRLC_MASK_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_LC_IN_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_LC_IN_EVENT_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_LC_IN_MASK_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_LC_VR_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_LC_VR_EVENT_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_LC_VR_MASK_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_LC_PG_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_LC_PG_EVENT_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_LC_PG_MASK_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_LC_RD_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_LC_RD_EVENT_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_LC_RD_MASK_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_LC_OK_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_LC_OK_EVENT_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_LC_OK_MASK_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_LC_SN_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_LC_SN_EVENT_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_LC_SN_MASK_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_LC_SD_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_LC_SD_EVENT_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_LC_SD_MASK_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_LC_PWR_ON:\n\tcase MLXPLAT_CPLD_LPC_REG_GP4_RO_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_SPI_CHNL_SELECT:\n\tcase MLXPLAT_CPLD_LPC_REG_WD_CLEAR_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_WD_CLEAR_WP_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_WD1_TMR_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_WD1_ACT_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_WD2_TMR_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_WD2_TLEFT_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_WD2_ACT_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_WD3_TMR_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_WD3_TLEFT_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_WD3_ACT_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_DBG_CTRL_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_I2C_CH1_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_I2C_CH2_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_I2C_CH3_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_I2C_CH4_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_CPLD1_MVER_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_CPLD2_MVER_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_CPLD3_MVER_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_CPLD4_MVER_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_CPLD5_MVER_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_PWM1_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_PWM2_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_PWM3_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_PWM4_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_TACHO1_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_TACHO2_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_TACHO3_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_TACHO4_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_TACHO5_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_TACHO6_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_TACHO7_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_TACHO8_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_TACHO9_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_TACHO10_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_TACHO11_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_TACHO12_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_TACHO13_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_TACHO14_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_PWM_CONTROL_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_FAN_CAP1_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_FAN_CAP2_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_FAN_DRW_CAP_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_TACHO_SPEED_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_PSU_I2C_CAP_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_SLOT_QTY_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_CONFIG1_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_CONFIG2_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_CONFIG3_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_UFM_VERSION_OFFSET:\n\t\treturn true;\n\t}\n\treturn false;\n}\n\nstatic bool mlxplat_mlxcpld_volatile_reg(struct device *dev, unsigned int reg)\n{\n\tswitch (reg) {\n\tcase MLXPLAT_CPLD_LPC_REG_CPLD1_VER_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_CPLD2_VER_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_CPLD3_VER_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_CPLD4_VER_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_CPLD5_VER_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_CPLD1_PN_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_CPLD1_PN1_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_CPLD2_PN_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_CPLD2_PN1_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_CPLD3_PN_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_CPLD3_PN1_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_CPLD4_PN_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_CPLD4_PN1_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_CPLD5_PN_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_CPLD5_PN1_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_RESET_GP1_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_RESET_GP4_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_RESET_CAUSE_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_RST_CAUSE1_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_RST_CAUSE2_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_LED1_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_LED2_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_LED3_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_LED4_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_LED5_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_LED6_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_LED7_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_FAN_DIRECTION:\n\tcase MLXPLAT_CPLD_LPC_REG_GP0_RO_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_GPCOM0_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_GP0_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_GP_RST_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_GP1_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_GP2_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_FIELD_UPGRADE:\n\tcase MLXPLAT_CPLD_LPC_SAFE_BIOS_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_SAFE_BIOS_WP_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_AGGR_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_AGGR_MASK_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_FU_CAP_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_DBG1_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_DBG2_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_DBG3_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_DBG4_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_AGGRLO_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_AGGRLO_MASK_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_AGGRCO_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_AGGRCO_MASK_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_AGGRCX_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_AGGRCX_MASK_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_GWP_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_GWP_EVENT_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_GWP_MASK_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_BRD_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_BRD_EVENT_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_BRD_MASK_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_ASIC_HEALTH_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_ASIC_EVENT_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_ASIC_MASK_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_ASIC2_HEALTH_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_ASIC2_EVENT_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_ASIC2_MASK_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_PSU_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_PSU_EVENT_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_PSU_MASK_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_PWR_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_PWR_EVENT_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_PWR_MASK_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_FAN_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_FAN_EVENT_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_FAN_MASK_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_EROT_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_EROT_EVENT_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_EROT_MASK_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_EROTE_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_EROTE_EVENT_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_EROTE_MASK_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_PWRB_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_PWRB_EVENT_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_PWRB_MASK_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_AGGRLC_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_AGGRLC_MASK_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_LC_IN_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_LC_IN_EVENT_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_LC_IN_MASK_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_LC_VR_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_LC_VR_EVENT_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_LC_VR_MASK_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_LC_PG_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_LC_PG_EVENT_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_LC_PG_MASK_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_LC_RD_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_LC_RD_EVENT_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_LC_RD_MASK_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_LC_OK_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_LC_OK_EVENT_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_LC_OK_MASK_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_LC_SN_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_LC_SN_EVENT_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_LC_SN_MASK_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_LC_SD_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_LC_SD_EVENT_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_LC_SD_MASK_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_LC_PWR_ON:\n\tcase MLXPLAT_CPLD_LPC_REG_GP4_RO_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_SPI_CHNL_SELECT:\n\tcase MLXPLAT_CPLD_LPC_REG_WD2_TMR_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_WD2_TLEFT_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_WD3_TMR_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_WD3_TLEFT_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_DBG_CTRL_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_I2C_CH1_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_I2C_CH2_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_I2C_CH3_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_I2C_CH4_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_CPLD1_MVER_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_CPLD2_MVER_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_CPLD3_MVER_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_CPLD4_MVER_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_CPLD5_MVER_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_PWM1_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_PWM2_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_PWM3_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_PWM4_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_TACHO1_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_TACHO2_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_TACHO3_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_TACHO4_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_TACHO5_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_TACHO6_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_TACHO7_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_TACHO8_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_TACHO9_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_TACHO10_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_TACHO11_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_TACHO12_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_TACHO13_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_TACHO14_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_PWM_CONTROL_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_FAN_CAP1_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_FAN_CAP2_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_FAN_DRW_CAP_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_TACHO_SPEED_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_PSU_I2C_CAP_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_SLOT_QTY_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_CONFIG1_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_CONFIG2_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_CONFIG3_OFFSET:\n\tcase MLXPLAT_CPLD_LPC_REG_UFM_VERSION_OFFSET:\n\t\treturn true;\n\t}\n\treturn false;\n}\n\nstatic const struct reg_default mlxplat_mlxcpld_regmap_default[] = {\n\t{ MLXPLAT_CPLD_LPC_REG_WP1_OFFSET, 0x00 },\n\t{ MLXPLAT_CPLD_LPC_REG_WP2_OFFSET, 0x00 },\n\t{ MLXPLAT_CPLD_LPC_REG_PWM_CONTROL_OFFSET, 0x00 },\n\t{ MLXPLAT_CPLD_LPC_REG_WD_CLEAR_WP_OFFSET, 0x00 },\n};\n\nstatic const struct reg_default mlxplat_mlxcpld_regmap_ng[] = {\n\t{ MLXPLAT_CPLD_LPC_REG_PWM_CONTROL_OFFSET, 0x00 },\n\t{ MLXPLAT_CPLD_LPC_REG_WD_CLEAR_WP_OFFSET, 0x00 },\n};\n\nstatic const struct reg_default mlxplat_mlxcpld_regmap_comex_default[] = {\n\t{ MLXPLAT_CPLD_LPC_REG_AGGRCX_MASK_OFFSET,\n\t  MLXPLAT_CPLD_LOW_AGGRCX_MASK },\n\t{ MLXPLAT_CPLD_LPC_REG_PWM_CONTROL_OFFSET, 0x00 },\n};\n\nstatic const struct reg_default mlxplat_mlxcpld_regmap_ng400[] = {\n\t{ MLXPLAT_CPLD_LPC_REG_PWM_CONTROL_OFFSET, 0x00 },\n\t{ MLXPLAT_CPLD_LPC_REG_WD1_ACT_OFFSET, 0x00 },\n\t{ MLXPLAT_CPLD_LPC_REG_WD2_ACT_OFFSET, 0x00 },\n\t{ MLXPLAT_CPLD_LPC_REG_WD3_ACT_OFFSET, 0x00 },\n};\n\nstatic const struct reg_default mlxplat_mlxcpld_regmap_rack_switch[] = {\n\t{ MLXPLAT_CPLD_LPC_REG_PWM_CONTROL_OFFSET, MLXPLAT_REGMAP_NVSWITCH_PWM_DEFAULT },\n\t{ MLXPLAT_CPLD_LPC_REG_WD1_ACT_OFFSET, 0x00 },\n\t{ MLXPLAT_CPLD_LPC_REG_WD2_ACT_OFFSET, 0x00 },\n\t{ MLXPLAT_CPLD_LPC_REG_WD3_ACT_OFFSET, 0x00 },\n};\n\nstatic const struct reg_default mlxplat_mlxcpld_regmap_eth_modular[] = {\n\t{ MLXPLAT_CPLD_LPC_REG_GP2_OFFSET, 0x61 },\n\t{ MLXPLAT_CPLD_LPC_REG_PWM_CONTROL_OFFSET, 0x00 },\n\t{ MLXPLAT_CPLD_LPC_REG_PWM2_OFFSET, 0x00 },\n\t{ MLXPLAT_CPLD_LPC_REG_PWM3_OFFSET, 0x00 },\n\t{ MLXPLAT_CPLD_LPC_REG_PWM4_OFFSET, 0x00 },\n\t{ MLXPLAT_CPLD_LPC_REG_WD1_ACT_OFFSET, 0x00 },\n\t{ MLXPLAT_CPLD_LPC_REG_WD2_ACT_OFFSET, 0x00 },\n\t{ MLXPLAT_CPLD_LPC_REG_WD3_ACT_OFFSET, 0x00 },\n\t{ MLXPLAT_CPLD_LPC_REG_AGGRLC_MASK_OFFSET,\n\t  MLXPLAT_CPLD_AGGR_MASK_LC_LOW },\n};\n\nstruct mlxplat_mlxcpld_regmap_context {\n\tvoid __iomem *base;\n};\n\nstatic struct mlxplat_mlxcpld_regmap_context mlxplat_mlxcpld_regmap_ctx;\n\nstatic int\nmlxplat_mlxcpld_reg_read(void *context, unsigned int reg, unsigned int *val)\n{\n\tstruct mlxplat_mlxcpld_regmap_context *ctx = context;\n\n\t*val = ioread8(ctx->base + reg);\n\treturn 0;\n}\n\nstatic int\nmlxplat_mlxcpld_reg_write(void *context, unsigned int reg, unsigned int val)\n{\n\tstruct mlxplat_mlxcpld_regmap_context *ctx = context;\n\n\tiowrite8(val, ctx->base + reg);\n\treturn 0;\n}\n\nstatic const struct regmap_config mlxplat_mlxcpld_regmap_config = {\n\t.reg_bits = 8,\n\t.val_bits = 8,\n\t.max_register = 255,\n\t.cache_type = REGCACHE_FLAT,\n\t.writeable_reg = mlxplat_mlxcpld_writeable_reg,\n\t.readable_reg = mlxplat_mlxcpld_readable_reg,\n\t.volatile_reg = mlxplat_mlxcpld_volatile_reg,\n\t.reg_defaults = mlxplat_mlxcpld_regmap_default,\n\t.num_reg_defaults = ARRAY_SIZE(mlxplat_mlxcpld_regmap_default),\n\t.reg_read = mlxplat_mlxcpld_reg_read,\n\t.reg_write = mlxplat_mlxcpld_reg_write,\n};\n\nstatic const struct regmap_config mlxplat_mlxcpld_regmap_config_ng = {\n\t.reg_bits = 8,\n\t.val_bits = 8,\n\t.max_register = 255,\n\t.cache_type = REGCACHE_FLAT,\n\t.writeable_reg = mlxplat_mlxcpld_writeable_reg,\n\t.readable_reg = mlxplat_mlxcpld_readable_reg,\n\t.volatile_reg = mlxplat_mlxcpld_volatile_reg,\n\t.reg_defaults = mlxplat_mlxcpld_regmap_ng,\n\t.num_reg_defaults = ARRAY_SIZE(mlxplat_mlxcpld_regmap_ng),\n\t.reg_read = mlxplat_mlxcpld_reg_read,\n\t.reg_write = mlxplat_mlxcpld_reg_write,\n};\n\nstatic const struct regmap_config mlxplat_mlxcpld_regmap_config_comex = {\n\t.reg_bits = 8,\n\t.val_bits = 8,\n\t.max_register = 255,\n\t.cache_type = REGCACHE_FLAT,\n\t.writeable_reg = mlxplat_mlxcpld_writeable_reg,\n\t.readable_reg = mlxplat_mlxcpld_readable_reg,\n\t.volatile_reg = mlxplat_mlxcpld_volatile_reg,\n\t.reg_defaults = mlxplat_mlxcpld_regmap_comex_default,\n\t.num_reg_defaults = ARRAY_SIZE(mlxplat_mlxcpld_regmap_comex_default),\n\t.reg_read = mlxplat_mlxcpld_reg_read,\n\t.reg_write = mlxplat_mlxcpld_reg_write,\n};\n\nstatic const struct regmap_config mlxplat_mlxcpld_regmap_config_ng400 = {\n\t.reg_bits = 8,\n\t.val_bits = 8,\n\t.max_register = 255,\n\t.cache_type = REGCACHE_FLAT,\n\t.writeable_reg = mlxplat_mlxcpld_writeable_reg,\n\t.readable_reg = mlxplat_mlxcpld_readable_reg,\n\t.volatile_reg = mlxplat_mlxcpld_volatile_reg,\n\t.reg_defaults = mlxplat_mlxcpld_regmap_ng400,\n\t.num_reg_defaults = ARRAY_SIZE(mlxplat_mlxcpld_regmap_ng400),\n\t.reg_read = mlxplat_mlxcpld_reg_read,\n\t.reg_write = mlxplat_mlxcpld_reg_write,\n};\n\nstatic const struct regmap_config mlxplat_mlxcpld_regmap_config_rack_switch = {\n\t.reg_bits = 8,\n\t.val_bits = 8,\n\t.max_register = 255,\n\t.cache_type = REGCACHE_FLAT,\n\t.writeable_reg = mlxplat_mlxcpld_writeable_reg,\n\t.readable_reg = mlxplat_mlxcpld_readable_reg,\n\t.volatile_reg = mlxplat_mlxcpld_volatile_reg,\n\t.reg_defaults = mlxplat_mlxcpld_regmap_rack_switch,\n\t.num_reg_defaults = ARRAY_SIZE(mlxplat_mlxcpld_regmap_rack_switch),\n\t.reg_read = mlxplat_mlxcpld_reg_read,\n\t.reg_write = mlxplat_mlxcpld_reg_write,\n};\n\nstatic const struct regmap_config mlxplat_mlxcpld_regmap_config_eth_modular = {\n\t.reg_bits = 8,\n\t.val_bits = 8,\n\t.max_register = 255,\n\t.cache_type = REGCACHE_FLAT,\n\t.writeable_reg = mlxplat_mlxcpld_writeable_reg,\n\t.readable_reg = mlxplat_mlxcpld_readable_reg,\n\t.volatile_reg = mlxplat_mlxcpld_volatile_reg,\n\t.reg_defaults = mlxplat_mlxcpld_regmap_eth_modular,\n\t.num_reg_defaults = ARRAY_SIZE(mlxplat_mlxcpld_regmap_eth_modular),\n\t.reg_read = mlxplat_mlxcpld_reg_read,\n\t.reg_write = mlxplat_mlxcpld_reg_write,\n};\n\nstatic struct resource mlxplat_mlxcpld_resources[] = {\n\t[0] = DEFINE_RES_IRQ_NAMED(MLXPLAT_CPLD_LPC_SYSIRQ, \"mlxreg-hotplug\"),\n};\n\nstatic struct mlxreg_core_hotplug_platform_data *mlxplat_i2c;\nstatic struct mlxreg_core_hotplug_platform_data *mlxplat_hotplug;\nstatic struct mlxreg_core_platform_data *mlxplat_led;\nstatic struct mlxreg_core_platform_data *mlxplat_regs_io;\nstatic struct mlxreg_core_platform_data *mlxplat_fan;\nstatic struct mlxreg_core_platform_data\n\t*mlxplat_wd_data[MLXPLAT_CPLD_WD_MAX_DEVS];\nstatic const struct regmap_config *mlxplat_regmap_config;\nstatic struct pci_dev *lpc_bridge;\nstatic struct pci_dev *i2c_bridge;\nstatic struct pci_dev *jtag_bridge;\n\n \nstatic int mlxplat_reboot_notifier(struct notifier_block *nb, unsigned long action, void *unused)\n{\n\tstruct mlxplat_priv *priv = platform_get_drvdata(mlxplat_dev);\n\tu32 regval;\n\tint ret;\n\n\tret = regmap_read(priv->regmap, MLXPLAT_CPLD_LPC_REG_RESET_GP1_OFFSET, &regval);\n\n\tif (action == SYS_RESTART && !ret && regval & MLXPLAT_CPLD_SYS_RESET_MASK)\n\t\tregmap_write(priv->regmap, MLXPLAT_CPLD_LPC_REG_RESET_GP1_OFFSET,\n\t\t\t     MLXPLAT_CPLD_RESET_MASK);\n\n\treturn NOTIFY_DONE;\n}\n\nstatic struct notifier_block mlxplat_reboot_default_nb = {\n\t.notifier_call = mlxplat_reboot_notifier,\n};\n\n \nstatic void mlxplat_poweroff(void)\n{\n\tstruct mlxplat_priv *priv = platform_get_drvdata(mlxplat_dev);\n\n\tif (mlxplat_reboot_nb)\n\t\tunregister_reboot_notifier(mlxplat_reboot_nb);\n\tregmap_write(priv->regmap, MLXPLAT_CPLD_LPC_REG_GP1_OFFSET, MLXPLAT_CPLD_HALT_MASK);\n\tkernel_halt();\n}\n\nstatic int __init mlxplat_register_platform_device(void)\n{\n\tmlxplat_dev = platform_device_register_simple(MLX_PLAT_DEVICE_NAME, -1,\n\t\t\t\t\t\t      mlxplat_lpc_resources,\n\t\t\t\t\t\t      ARRAY_SIZE(mlxplat_lpc_resources));\n\tif (IS_ERR(mlxplat_dev))\n\t\treturn PTR_ERR(mlxplat_dev);\n\telse\n\t\treturn 1;\n}\n\nstatic int __init mlxplat_dmi_default_matched(const struct dmi_system_id *dmi)\n{\n\tint i;\n\n\tmlxplat_max_adap_num = MLXPLAT_CPLD_MAX_PHYS_ADAPTER_NUM;\n\tmlxplat_mux_num = ARRAY_SIZE(mlxplat_default_mux_data);\n\tmlxplat_mux_data = mlxplat_default_mux_data;\n\tfor (i = 0; i < mlxplat_mux_num; i++) {\n\t\tmlxplat_mux_data[i].values = mlxplat_default_channels[i];\n\t\tmlxplat_mux_data[i].n_values =\n\t\t\t\tARRAY_SIZE(mlxplat_default_channels[i]);\n\t}\n\tmlxplat_hotplug = &mlxplat_mlxcpld_default_data;\n\tmlxplat_hotplug->deferred_nr =\n\t\tmlxplat_default_channels[i - 1][MLXPLAT_CPLD_GRP_CHNL_NUM - 1];\n\tmlxplat_led = &mlxplat_default_led_data;\n\tmlxplat_regs_io = &mlxplat_default_regs_io_data;\n\tmlxplat_wd_data[0] = &mlxplat_mlxcpld_wd_set_type1[0];\n\tmlxplat_i2c = &mlxplat_mlxcpld_i2c_default_data;\n\n\treturn mlxplat_register_platform_device();\n}\n\nstatic int __init mlxplat_dmi_default_wc_matched(const struct dmi_system_id *dmi)\n{\n\tint i;\n\n\tmlxplat_max_adap_num = MLXPLAT_CPLD_MAX_PHYS_ADAPTER_NUM;\n\tmlxplat_mux_num = ARRAY_SIZE(mlxplat_default_mux_data);\n\tmlxplat_mux_data = mlxplat_default_mux_data;\n\tfor (i = 0; i < mlxplat_mux_num; i++) {\n\t\tmlxplat_mux_data[i].values = mlxplat_default_channels[i];\n\t\tmlxplat_mux_data[i].n_values =\n\t\t\t\tARRAY_SIZE(mlxplat_default_channels[i]);\n\t}\n\tmlxplat_hotplug = &mlxplat_mlxcpld_default_wc_data;\n\tmlxplat_hotplug->deferred_nr =\n\t\tmlxplat_default_channels[i - 1][MLXPLAT_CPLD_GRP_CHNL_NUM - 1];\n\tmlxplat_led = &mlxplat_default_led_wc_data;\n\tmlxplat_regs_io = &mlxplat_default_regs_io_data;\n\tmlxplat_wd_data[0] = &mlxplat_mlxcpld_wd_set_type1[0];\n\tmlxplat_i2c = &mlxplat_mlxcpld_i2c_default_data;\n\n\treturn mlxplat_register_platform_device();\n}\n\nstatic int __init mlxplat_dmi_default_eth_wc_blade_matched(const struct dmi_system_id *dmi)\n{\n\tint i;\n\n\tmlxplat_max_adap_num = MLXPLAT_CPLD_MAX_PHYS_ADAPTER_NUM;\n\tmlxplat_mux_num = ARRAY_SIZE(mlxplat_default_mux_data);\n\tmlxplat_mux_data = mlxplat_default_mux_data;\n\tfor (i = 0; i < mlxplat_mux_num; i++) {\n\t\tmlxplat_mux_data[i].values = mlxplat_msn21xx_channels;\n\t\tmlxplat_mux_data[i].n_values =\n\t\t\t\tARRAY_SIZE(mlxplat_msn21xx_channels);\n\t}\n\tmlxplat_hotplug = &mlxplat_mlxcpld_default_wc_data;\n\tmlxplat_hotplug->deferred_nr =\n\t\tmlxplat_msn21xx_channels[MLXPLAT_CPLD_GRP_CHNL_NUM - 1];\n\tmlxplat_led = &mlxplat_default_led_eth_wc_blade_data;\n\tmlxplat_regs_io = &mlxplat_default_ng_regs_io_data;\n\tfor (i = 0; i < ARRAY_SIZE(mlxplat_mlxcpld_wd_set_type2); i++)\n\t\tmlxplat_wd_data[i] = &mlxplat_mlxcpld_wd_set_type2[i];\n\tmlxplat_i2c = &mlxplat_mlxcpld_i2c_ng_data;\n\tmlxplat_regmap_config = &mlxplat_mlxcpld_regmap_config_ng;\n\n\treturn mlxplat_register_platform_device();\n}\n\nstatic int __init mlxplat_dmi_msn21xx_matched(const struct dmi_system_id *dmi)\n{\n\tint i;\n\n\tmlxplat_max_adap_num = MLXPLAT_CPLD_MAX_PHYS_ADAPTER_NUM;\n\tmlxplat_mux_num = ARRAY_SIZE(mlxplat_default_mux_data);\n\tmlxplat_mux_data = mlxplat_default_mux_data;\n\tfor (i = 0; i < mlxplat_mux_num; i++) {\n\t\tmlxplat_mux_data[i].values = mlxplat_msn21xx_channels;\n\t\tmlxplat_mux_data[i].n_values =\n\t\t\t\tARRAY_SIZE(mlxplat_msn21xx_channels);\n\t}\n\tmlxplat_hotplug = &mlxplat_mlxcpld_msn21xx_data;\n\tmlxplat_hotplug->deferred_nr =\n\t\tmlxplat_msn21xx_channels[MLXPLAT_CPLD_GRP_CHNL_NUM - 1];\n\tmlxplat_led = &mlxplat_msn21xx_led_data;\n\tmlxplat_regs_io = &mlxplat_msn21xx_regs_io_data;\n\tmlxplat_wd_data[0] = &mlxplat_mlxcpld_wd_set_type1[0];\n\tmlxplat_i2c = &mlxplat_mlxcpld_i2c_default_data;\n\n\treturn mlxplat_register_platform_device();\n}\n\nstatic int __init mlxplat_dmi_msn274x_matched(const struct dmi_system_id *dmi)\n{\n\tint i;\n\n\tmlxplat_max_adap_num = MLXPLAT_CPLD_MAX_PHYS_ADAPTER_NUM;\n\tmlxplat_mux_num = ARRAY_SIZE(mlxplat_default_mux_data);\n\tmlxplat_mux_data = mlxplat_default_mux_data;\n\tfor (i = 0; i < mlxplat_mux_num; i++) {\n\t\tmlxplat_mux_data[i].values = mlxplat_msn21xx_channels;\n\t\tmlxplat_mux_data[i].n_values =\n\t\t\t\tARRAY_SIZE(mlxplat_msn21xx_channels);\n\t}\n\tmlxplat_hotplug = &mlxplat_mlxcpld_msn274x_data;\n\tmlxplat_hotplug->deferred_nr =\n\t\tmlxplat_msn21xx_channels[MLXPLAT_CPLD_GRP_CHNL_NUM - 1];\n\tmlxplat_led = &mlxplat_default_led_data;\n\tmlxplat_regs_io = &mlxplat_msn21xx_regs_io_data;\n\tmlxplat_wd_data[0] = &mlxplat_mlxcpld_wd_set_type1[0];\n\tmlxplat_i2c = &mlxplat_mlxcpld_i2c_default_data;\n\n\treturn mlxplat_register_platform_device();\n}\n\nstatic int __init mlxplat_dmi_msn201x_matched(const struct dmi_system_id *dmi)\n{\n\tint i;\n\n\tmlxplat_max_adap_num = MLXPLAT_CPLD_MAX_PHYS_ADAPTER_NUM;\n\tmlxplat_mux_num = ARRAY_SIZE(mlxplat_default_mux_data);\n\tmlxplat_mux_data = mlxplat_default_mux_data;\n\tfor (i = 0; i < mlxplat_mux_num; i++) {\n\t\tmlxplat_mux_data[i].values = mlxplat_msn21xx_channels;\n\t\tmlxplat_mux_data[i].n_values =\n\t\t\t\tARRAY_SIZE(mlxplat_msn21xx_channels);\n\t}\n\tmlxplat_hotplug = &mlxplat_mlxcpld_msn201x_data;\n\tmlxplat_hotplug->deferred_nr =\n\t\tmlxplat_default_channels[i - 1][MLXPLAT_CPLD_GRP_CHNL_NUM - 1];\n\tmlxplat_led = &mlxplat_msn21xx_led_data;\n\tmlxplat_regs_io = &mlxplat_msn21xx_regs_io_data;\n\tmlxplat_wd_data[0] = &mlxplat_mlxcpld_wd_set_type1[0];\n\tmlxplat_i2c = &mlxplat_mlxcpld_i2c_default_data;\n\n\treturn mlxplat_register_platform_device();\n}\n\nstatic int __init mlxplat_dmi_qmb7xx_matched(const struct dmi_system_id *dmi)\n{\n\tint i;\n\n\tmlxplat_max_adap_num = MLXPLAT_CPLD_MAX_PHYS_ADAPTER_NUM;\n\tmlxplat_mux_num = ARRAY_SIZE(mlxplat_default_mux_data);\n\tmlxplat_mux_data = mlxplat_default_mux_data;\n\tfor (i = 0; i < mlxplat_mux_num; i++) {\n\t\tmlxplat_mux_data[i].values = mlxplat_msn21xx_channels;\n\t\tmlxplat_mux_data[i].n_values =\n\t\t\t\tARRAY_SIZE(mlxplat_msn21xx_channels);\n\t}\n\tmlxplat_hotplug = &mlxplat_mlxcpld_default_ng_data;\n\tmlxplat_hotplug->deferred_nr =\n\t\tmlxplat_msn21xx_channels[MLXPLAT_CPLD_GRP_CHNL_NUM - 1];\n\tmlxplat_led = &mlxplat_default_ng_led_data;\n\tmlxplat_regs_io = &mlxplat_default_ng_regs_io_data;\n\tmlxplat_fan = &mlxplat_default_fan_data;\n\tfor (i = 0; i < ARRAY_SIZE(mlxplat_mlxcpld_wd_set_type2); i++)\n\t\tmlxplat_wd_data[i] = &mlxplat_mlxcpld_wd_set_type2[i];\n\tmlxplat_i2c = &mlxplat_mlxcpld_i2c_ng_data;\n\tmlxplat_regmap_config = &mlxplat_mlxcpld_regmap_config_ng;\n\n\treturn mlxplat_register_platform_device();\n}\n\nstatic int __init mlxplat_dmi_comex_matched(const struct dmi_system_id *dmi)\n{\n\tint i;\n\n\tmlxplat_max_adap_num = MLXPLAT_CPLD_MAX_PHYS_EXT_ADAPTER_NUM;\n\tmlxplat_mux_num = ARRAY_SIZE(mlxplat_extended_mux_data);\n\tmlxplat_mux_data = mlxplat_extended_mux_data;\n\tfor (i = 0; i < mlxplat_mux_num; i++) {\n\t\tmlxplat_mux_data[i].values = mlxplat_msn21xx_channels;\n\t\tmlxplat_mux_data[i].n_values =\n\t\t\t\tARRAY_SIZE(mlxplat_msn21xx_channels);\n\t}\n\tmlxplat_hotplug = &mlxplat_mlxcpld_comex_data;\n\tmlxplat_hotplug->deferred_nr = MLXPLAT_CPLD_MAX_PHYS_EXT_ADAPTER_NUM;\n\tmlxplat_led = &mlxplat_comex_100G_led_data;\n\tmlxplat_regs_io = &mlxplat_default_ng_regs_io_data;\n\tmlxplat_fan = &mlxplat_default_fan_data;\n\tfor (i = 0; i < ARRAY_SIZE(mlxplat_mlxcpld_wd_set_type2); i++)\n\t\tmlxplat_wd_data[i] = &mlxplat_mlxcpld_wd_set_type2[i];\n\tmlxplat_i2c = &mlxplat_mlxcpld_i2c_default_data;\n\tmlxplat_regmap_config = &mlxplat_mlxcpld_regmap_config_comex;\n\n\treturn mlxplat_register_platform_device();\n}\n\nstatic int __init mlxplat_dmi_ng400_matched(const struct dmi_system_id *dmi)\n{\n\tint i;\n\n\tmlxplat_max_adap_num = MLXPLAT_CPLD_MAX_PHYS_ADAPTER_NUM;\n\tmlxplat_mux_num = ARRAY_SIZE(mlxplat_default_mux_data);\n\tmlxplat_mux_data = mlxplat_default_mux_data;\n\tfor (i = 0; i < mlxplat_mux_num; i++) {\n\t\tmlxplat_mux_data[i].values = mlxplat_msn21xx_channels;\n\t\tmlxplat_mux_data[i].n_values =\n\t\t\t\tARRAY_SIZE(mlxplat_msn21xx_channels);\n\t}\n\tmlxplat_hotplug = &mlxplat_mlxcpld_ext_data;\n\tmlxplat_hotplug->deferred_nr =\n\t\tmlxplat_msn21xx_channels[MLXPLAT_CPLD_GRP_CHNL_NUM - 1];\n\tmlxplat_led = &mlxplat_default_ng_led_data;\n\tmlxplat_regs_io = &mlxplat_default_ng_regs_io_data;\n\tmlxplat_fan = &mlxplat_default_fan_data;\n\tfor (i = 0; i < ARRAY_SIZE(mlxplat_mlxcpld_wd_set_type2); i++)\n\t\tmlxplat_wd_data[i] = &mlxplat_mlxcpld_wd_set_type2[i];\n\tmlxplat_i2c = &mlxplat_mlxcpld_i2c_ng_data;\n\tmlxplat_regmap_config = &mlxplat_mlxcpld_regmap_config_ng400;\n\n\treturn mlxplat_register_platform_device();\n}\n\nstatic int __init mlxplat_dmi_modular_matched(const struct dmi_system_id *dmi)\n{\n\tint i;\n\n\tmlxplat_max_adap_num = MLXPLAT_CPLD_MAX_PHYS_ADAPTER_NUM;\n\tmlxplat_mux_num = ARRAY_SIZE(mlxplat_modular_mux_data);\n\tmlxplat_mux_data = mlxplat_modular_mux_data;\n\tmlxplat_hotplug = &mlxplat_mlxcpld_modular_data;\n\tmlxplat_hotplug->deferred_nr = MLXPLAT_CPLD_CH4_ETH_MODULAR;\n\tmlxplat_led = &mlxplat_modular_led_data;\n\tmlxplat_regs_io = &mlxplat_modular_regs_io_data;\n\tmlxplat_fan = &mlxplat_default_fan_data;\n\tfor (i = 0; i < ARRAY_SIZE(mlxplat_mlxcpld_wd_set_type2); i++)\n\t\tmlxplat_wd_data[i] = &mlxplat_mlxcpld_wd_set_type2[i];\n\tmlxplat_i2c = &mlxplat_mlxcpld_i2c_ng_data;\n\tmlxplat_regmap_config = &mlxplat_mlxcpld_regmap_config_eth_modular;\n\n\treturn mlxplat_register_platform_device();\n}\n\nstatic int __init mlxplat_dmi_chassis_blade_matched(const struct dmi_system_id *dmi)\n{\n\tint i;\n\n\tmlxplat_max_adap_num = MLXPLAT_CPLD_MAX_PHYS_ADAPTER_NUM;\n\tmlxplat_mux_num = ARRAY_SIZE(mlxplat_default_mux_data);\n\tmlxplat_mux_data = mlxplat_default_mux_data;\n\tmlxplat_hotplug = &mlxplat_mlxcpld_chassis_blade_data;\n\tmlxplat_hotplug->deferred_nr =\n\t\tmlxplat_msn21xx_channels[MLXPLAT_CPLD_GRP_CHNL_NUM - 1];\n\tfor (i = 0; i < mlxplat_mux_num; i++) {\n\t\tmlxplat_mux_data[i].values = mlxplat_msn21xx_channels;\n\t\tmlxplat_mux_data[i].n_values =\n\t\t\t\tARRAY_SIZE(mlxplat_msn21xx_channels);\n\t}\n\tmlxplat_regs_io = &mlxplat_chassis_blade_regs_io_data;\n\tmlxplat_i2c = &mlxplat_mlxcpld_i2c_ng_data;\n\tmlxplat_regmap_config = &mlxplat_mlxcpld_regmap_config_ng400;\n\n\treturn mlxplat_register_platform_device();\n}\n\nstatic int __init mlxplat_dmi_rack_switch_matched(const struct dmi_system_id *dmi)\n{\n\tint i;\n\n\tmlxplat_max_adap_num = MLXPLAT_CPLD_MAX_PHYS_ADAPTER_NUM;\n\tmlxplat_mux_num = ARRAY_SIZE(mlxplat_rack_switch_mux_data);\n\tmlxplat_mux_data = mlxplat_rack_switch_mux_data;\n\tmlxplat_hotplug = &mlxplat_mlxcpld_rack_switch_data;\n\tmlxplat_hotplug->deferred_nr =\n\t\tmlxplat_msn21xx_channels[MLXPLAT_CPLD_GRP_CHNL_NUM - 1];\n\tmlxplat_led = &mlxplat_default_ng_led_data;\n\tmlxplat_regs_io = &mlxplat_default_ng_regs_io_data;\n\tmlxplat_fan = &mlxplat_default_fan_data;\n\tfor (i = 0; i < ARRAY_SIZE(mlxplat_mlxcpld_wd_set_type2); i++)\n\t\tmlxplat_wd_data[i] = &mlxplat_mlxcpld_wd_set_type2[i];\n\tmlxplat_i2c = &mlxplat_mlxcpld_i2c_ng_data;\n\tmlxplat_regmap_config = &mlxplat_mlxcpld_regmap_config_rack_switch;\n\n\treturn mlxplat_register_platform_device();\n}\n\nstatic int __init mlxplat_dmi_ng800_matched(const struct dmi_system_id *dmi)\n{\n\tint i;\n\n\tmlxplat_max_adap_num = MLXPLAT_CPLD_MAX_PHYS_ADAPTER_NUM;\n\tmlxplat_mux_num = ARRAY_SIZE(mlxplat_ng800_mux_data);\n\tmlxplat_mux_data = mlxplat_ng800_mux_data;\n\tmlxplat_hotplug = &mlxplat_mlxcpld_ng800_data;\n\tmlxplat_hotplug->deferred_nr =\n\t\tmlxplat_msn21xx_channels[MLXPLAT_CPLD_GRP_CHNL_NUM - 1];\n\tmlxplat_led = &mlxplat_default_ng_led_data;\n\tmlxplat_regs_io = &mlxplat_default_ng_regs_io_data;\n\tmlxplat_fan = &mlxplat_default_fan_data;\n\tfor (i = 0; i < ARRAY_SIZE(mlxplat_mlxcpld_wd_set_type2); i++)\n\t\tmlxplat_wd_data[i] = &mlxplat_mlxcpld_wd_set_type2[i];\n\tmlxplat_i2c = &mlxplat_mlxcpld_i2c_ng_data;\n\tmlxplat_regmap_config = &mlxplat_mlxcpld_regmap_config_ng400;\n\n\treturn mlxplat_register_platform_device();\n}\n\nstatic int __init mlxplat_dmi_l1_switch_matched(const struct dmi_system_id *dmi)\n{\n\tint i;\n\n\tmlxplat_max_adap_num = MLXPLAT_CPLD_MAX_PHYS_ADAPTER_NUM;\n\tmlxplat_mux_num = ARRAY_SIZE(mlxplat_rack_switch_mux_data);\n\tmlxplat_mux_data = mlxplat_rack_switch_mux_data;\n\tmlxplat_hotplug = &mlxplat_mlxcpld_l1_switch_data;\n\tmlxplat_hotplug->deferred_nr =\n\t\tmlxplat_msn21xx_channels[MLXPLAT_CPLD_GRP_CHNL_NUM - 1];\n\tmlxplat_led = &mlxplat_l1_switch_led_data;\n\tmlxplat_regs_io = &mlxplat_default_ng_regs_io_data;\n\tmlxplat_fan = &mlxplat_default_fan_data;\n\tfor (i = 0; i < ARRAY_SIZE(mlxplat_mlxcpld_wd_set_type2); i++)\n\t\tmlxplat_wd_data[i] = &mlxplat_mlxcpld_wd_set_type2[i];\n\tmlxplat_i2c = &mlxplat_mlxcpld_i2c_ng_data;\n\tmlxplat_regmap_config = &mlxplat_mlxcpld_regmap_config_rack_switch;\n\tpm_power_off = mlxplat_poweroff;\n\tmlxplat_reboot_nb = &mlxplat_reboot_default_nb;\n\n\treturn mlxplat_register_platform_device();\n}\n\nstatic const struct dmi_system_id mlxplat_dmi_table[] __initconst = {\n\t{\n\t\t.callback = mlxplat_dmi_default_wc_matched,\n\t\t.matches = {\n\t\t\tDMI_MATCH(DMI_BOARD_NAME, \"VMOD0001\"),\n\t\t\tDMI_EXACT_MATCH(DMI_PRODUCT_SKU, \"HI138\"),\n\t\t},\n\t},\n\t{\n\t\t.callback = mlxplat_dmi_default_matched,\n\t\t.matches = {\n\t\t\tDMI_MATCH(DMI_BOARD_NAME, \"VMOD0001\"),\n\t\t},\n\t},\n\t{\n\t\t.callback = mlxplat_dmi_msn21xx_matched,\n\t\t.matches = {\n\t\t\tDMI_MATCH(DMI_BOARD_NAME, \"VMOD0002\"),\n\t\t},\n\t},\n\t{\n\t\t.callback = mlxplat_dmi_msn274x_matched,\n\t\t.matches = {\n\t\t\tDMI_MATCH(DMI_BOARD_NAME, \"VMOD0003\"),\n\t\t},\n\t},\n\t{\n\t\t.callback = mlxplat_dmi_msn201x_matched,\n\t\t.matches = {\n\t\t\tDMI_MATCH(DMI_BOARD_NAME, \"VMOD0004\"),\n\t\t},\n\t},\n\t{\n\t\t.callback = mlxplat_dmi_default_eth_wc_blade_matched,\n\t\t.matches = {\n\t\t\tDMI_MATCH(DMI_BOARD_NAME, \"VMOD0005\"),\n\t\t\tDMI_EXACT_MATCH(DMI_PRODUCT_SKU, \"HI139\"),\n\t\t},\n\t},\n\t{\n\t\t.callback = mlxplat_dmi_qmb7xx_matched,\n\t\t.matches = {\n\t\t\tDMI_MATCH(DMI_BOARD_NAME, \"VMOD0005\"),\n\t\t},\n\t},\n\t{\n\t\t.callback = mlxplat_dmi_qmb7xx_matched,\n\t\t.matches = {\n\t\t\tDMI_MATCH(DMI_BOARD_NAME, \"VMOD0007\"),\n\t\t},\n\t},\n\t{\n\t\t.callback = mlxplat_dmi_comex_matched,\n\t\t.matches = {\n\t\t\tDMI_MATCH(DMI_BOARD_NAME, \"VMOD0009\"),\n\t\t},\n\t},\n\t{\n\t\t.callback = mlxplat_dmi_rack_switch_matched,\n\t\t.matches = {\n\t\t\tDMI_MATCH(DMI_BOARD_NAME, \"VMOD0010\"),\n\t\t\tDMI_EXACT_MATCH(DMI_PRODUCT_SKU, \"HI142\"),\n\t\t},\n\t},\n\t{\n\t\t.callback = mlxplat_dmi_ng400_matched,\n\t\t.matches = {\n\t\t\tDMI_MATCH(DMI_BOARD_NAME, \"VMOD0010\"),\n\t\t},\n\t},\n\t{\n\t\t.callback = mlxplat_dmi_modular_matched,\n\t\t.matches = {\n\t\t\tDMI_MATCH(DMI_BOARD_NAME, \"VMOD0011\"),\n\t\t},\n\t},\n\t{\n\t\t.callback = mlxplat_dmi_ng800_matched,\n\t\t.matches = {\n\t\t\tDMI_MATCH(DMI_BOARD_NAME, \"VMOD0013\"),\n\t\t},\n\t},\n\t{\n\t\t.callback = mlxplat_dmi_chassis_blade_matched,\n\t\t.matches = {\n\t\t\tDMI_MATCH(DMI_BOARD_NAME, \"VMOD0015\"),\n\t\t},\n\t},\n\t{\n\t\t.callback = mlxplat_dmi_l1_switch_matched,\n\t\t.matches = {\n\t\t\tDMI_MATCH(DMI_BOARD_NAME, \"VMOD0017\"),\n\t\t},\n\t},\n\t{\n\t\t.callback = mlxplat_dmi_msn274x_matched,\n\t\t.matches = {\n\t\t\tDMI_MATCH(DMI_BOARD_VENDOR, \"Mellanox Technologies\"),\n\t\t\tDMI_MATCH(DMI_PRODUCT_NAME, \"MSN274\"),\n\t\t},\n\t},\n\t{\n\t\t.callback = mlxplat_dmi_default_matched,\n\t\t.matches = {\n\t\t\tDMI_MATCH(DMI_BOARD_VENDOR, \"Mellanox Technologies\"),\n\t\t\tDMI_MATCH(DMI_PRODUCT_NAME, \"MSN24\"),\n\t\t},\n\t},\n\t{\n\t\t.callback = mlxplat_dmi_default_matched,\n\t\t.matches = {\n\t\t\tDMI_MATCH(DMI_BOARD_VENDOR, \"Mellanox Technologies\"),\n\t\t\tDMI_MATCH(DMI_PRODUCT_NAME, \"MSN27\"),\n\t\t},\n\t},\n\t{\n\t\t.callback = mlxplat_dmi_default_matched,\n\t\t.matches = {\n\t\t\tDMI_MATCH(DMI_BOARD_VENDOR, \"Mellanox Technologies\"),\n\t\t\tDMI_MATCH(DMI_PRODUCT_NAME, \"MSB\"),\n\t\t},\n\t},\n\t{\n\t\t.callback = mlxplat_dmi_default_matched,\n\t\t.matches = {\n\t\t\tDMI_MATCH(DMI_BOARD_VENDOR, \"Mellanox Technologies\"),\n\t\t\tDMI_MATCH(DMI_PRODUCT_NAME, \"MSX\"),\n\t\t},\n\t},\n\t{\n\t\t.callback = mlxplat_dmi_msn21xx_matched,\n\t\t.matches = {\n\t\t\tDMI_MATCH(DMI_BOARD_VENDOR, \"Mellanox Technologies\"),\n\t\t\tDMI_MATCH(DMI_PRODUCT_NAME, \"MSN21\"),\n\t\t},\n\t},\n\t{\n\t\t.callback = mlxplat_dmi_msn201x_matched,\n\t\t.matches = {\n\t\t\tDMI_MATCH(DMI_BOARD_VENDOR, \"Mellanox Technologies\"),\n\t\t\tDMI_MATCH(DMI_PRODUCT_NAME, \"MSN201\"),\n\t\t},\n\t},\n\t{\n\t\t.callback = mlxplat_dmi_qmb7xx_matched,\n\t\t.matches = {\n\t\t\tDMI_MATCH(DMI_BOARD_VENDOR, \"Mellanox Technologies\"),\n\t\t\tDMI_MATCH(DMI_PRODUCT_NAME, \"MQM87\"),\n\t\t},\n\t},\n\t{\n\t\t.callback = mlxplat_dmi_qmb7xx_matched,\n\t\t.matches = {\n\t\t\tDMI_MATCH(DMI_BOARD_VENDOR, \"Mellanox Technologies\"),\n\t\t\tDMI_MATCH(DMI_PRODUCT_NAME, \"MSN37\"),\n\t\t},\n\t},\n\t{\n\t\t.callback = mlxplat_dmi_qmb7xx_matched,\n\t\t.matches = {\n\t\t\tDMI_MATCH(DMI_BOARD_VENDOR, \"Mellanox Technologies\"),\n\t\t\tDMI_MATCH(DMI_PRODUCT_NAME, \"MSN34\"),\n\t\t},\n\t},\n\t{\n\t\t.callback = mlxplat_dmi_qmb7xx_matched,\n\t\t.matches = {\n\t\t\tDMI_MATCH(DMI_BOARD_VENDOR, \"Mellanox Technologies\"),\n\t\t\tDMI_MATCH(DMI_PRODUCT_NAME, \"MSN38\"),\n\t\t},\n\t},\n\t{ }\n};\n\nMODULE_DEVICE_TABLE(dmi, mlxplat_dmi_table);\n\nstatic int mlxplat_mlxcpld_verify_bus_topology(int *nr)\n{\n\tstruct i2c_adapter *search_adap;\n\tint i, shift = 0;\n\n\t \n\t*nr = MLXPLAT_CPLD_PHYS_ADAPTER_DEF_NR;\n\tfor (i = MLXPLAT_CPLD_PHYS_ADAPTER_DEF_NR; i <\n\t     mlxplat_max_adap_num; i++) {\n\t\tsearch_adap = i2c_get_adapter(i);\n\t\tif (search_adap) {\n\t\t\ti2c_put_adapter(search_adap);\n\t\t\tcontinue;\n\t\t}\n\n\t\t \n\t\tif (i == MLXPLAT_CPLD_PHYS_ADAPTER_DEF_NR)\n\t\t\treturn 0;\n\t\tbreak;\n\t}\n\n\t \n\tif (i == mlxplat_max_adap_num)\n\t\treturn -ENODEV;\n\n\t \n\t*nr = i;\n\tfor (i = 0; i < mlxplat_mux_num; i++) {\n\t\tshift = *nr - mlxplat_mux_data[i].parent;\n\t\tmlxplat_mux_data[i].parent = *nr;\n\t\tmlxplat_mux_data[i].base_nr += shift;\n\t}\n\n\tif (shift > 0)\n\t\tmlxplat_hotplug->shift_nr = shift;\n\n\treturn 0;\n}\n\nstatic int mlxplat_mlxcpld_check_wd_capability(void *regmap)\n{\n\tu32 regval;\n\tint i, rc;\n\n\trc = regmap_read(regmap, MLXPLAT_CPLD_LPC_REG_PSU_I2C_CAP_OFFSET,\n\t\t\t &regval);\n\tif (rc)\n\t\treturn rc;\n\n\tif (!(regval & ~MLXPLAT_CPLD_WD_CPBLTY_MASK)) {\n\t\tfor (i = 0; i < ARRAY_SIZE(mlxplat_mlxcpld_wd_set_type3); i++) {\n\t\t\tif (mlxplat_wd_data[i])\n\t\t\t\tmlxplat_wd_data[i] =\n\t\t\t\t\t&mlxplat_mlxcpld_wd_set_type3[i];\n\t\t}\n\t}\n\n\treturn 0;\n}\n\nstatic int mlxplat_lpc_cpld_device_init(struct resource **hotplug_resources,\n\t\t\t\t\tunsigned int *hotplug_resources_size)\n{\n\tint err;\n\n\tmlxplat_mlxcpld_regmap_ctx.base = devm_ioport_map(&mlxplat_dev->dev,\n\t\t\t\t\t\t\t  mlxplat_lpc_resources[1].start, 1);\n\tif (!mlxplat_mlxcpld_regmap_ctx.base) {\n\t\terr = -ENOMEM;\n\t\tgoto fail_devm_ioport_map;\n\t}\n\n\t*hotplug_resources = mlxplat_mlxcpld_resources;\n\t*hotplug_resources_size = ARRAY_SIZE(mlxplat_mlxcpld_resources);\n\n\treturn 0;\n\nfail_devm_ioport_map:\n\treturn err;\n}\n\nstatic void mlxplat_lpc_cpld_device_exit(void)\n{\n}\n\nstatic int\nmlxplat_pci_fpga_device_init(unsigned int device, const char *res_name, struct pci_dev **pci_bridge,\n\t\t\t     void __iomem **pci_bridge_addr)\n{\n\tvoid __iomem *pci_mem_addr;\n\tstruct pci_dev *pci_dev;\n\tint err;\n\n\tpci_dev = pci_get_device(PCI_VENDOR_ID_LATTICE, device, NULL);\n\tif (!pci_dev)\n\t\treturn -ENODEV;\n\n\terr = pci_enable_device(pci_dev);\n\tif (err) {\n\t\tdev_err(&pci_dev->dev, \"pci_enable_device failed with error %d\\n\", err);\n\t\tgoto fail_pci_enable_device;\n\t}\n\n\terr = pci_request_region(pci_dev, 0, res_name);\n\tif (err) {\n\t\tdev_err(&pci_dev->dev, \"pci_request_regions failed with error %d\\n\", err);\n\t\tgoto fail_pci_request_regions;\n\t}\n\n\terr = dma_set_mask_and_coherent(&pci_dev->dev, DMA_BIT_MASK(64));\n\tif (err) {\n\t\terr = dma_set_mask(&pci_dev->dev, DMA_BIT_MASK(32));\n\t\tif (err) {\n\t\t\tdev_err(&pci_dev->dev, \"dma_set_mask failed with error %d\\n\", err);\n\t\t\tgoto fail_pci_set_dma_mask;\n\t\t}\n\t}\n\n\tpci_set_master(pci_dev);\n\n\tpci_mem_addr = devm_ioremap(&pci_dev->dev, pci_resource_start(pci_dev, 0),\n\t\t\t\t    pci_resource_len(pci_dev, 0));\n\tif (!pci_mem_addr) {\n\t\tdev_err(&mlxplat_dev->dev, \"ioremap failed\\n\");\n\t\terr = -EIO;\n\t\tgoto fail_ioremap;\n\t}\n\n\t*pci_bridge = pci_dev;\n\t*pci_bridge_addr = pci_mem_addr;\n\n\treturn 0;\n\nfail_ioremap:\nfail_pci_set_dma_mask:\n\tpci_release_regions(pci_dev);\nfail_pci_request_regions:\n\tpci_disable_device(pci_dev);\nfail_pci_enable_device:\n\treturn err;\n}\n\nstatic void\nmlxplat_pci_fpga_device_exit(struct pci_dev *pci_bridge,\n\t\t\t     void __iomem *pci_bridge_addr)\n{\n\tiounmap(pci_bridge_addr);\n\tpci_release_regions(pci_bridge);\n\tpci_disable_device(pci_bridge);\n}\n\nstatic int\nmlxplat_pci_fpga_devices_init(struct resource **hotplug_resources,\n\t\t\t      unsigned int *hotplug_resources_size)\n{\n\tint err;\n\n\terr = mlxplat_pci_fpga_device_init(PCI_DEVICE_ID_LATTICE_LPC_BRIDGE,\n\t\t\t\t\t   \"mlxplat_lpc_bridge\", &lpc_bridge,\n\t\t\t\t\t   &mlxplat_mlxcpld_regmap_ctx.base);\n\tif (err)\n\t\tgoto mlxplat_pci_fpga_device_init_lpc_fail;\n\n\terr = mlxplat_pci_fpga_device_init(PCI_DEVICE_ID_LATTICE_I2C_BRIDGE,\n\t\t\t\t\t   \"mlxplat_i2c_bridge\", &i2c_bridge,\n\t\t\t\t\t    &i2c_bridge_addr);\n\tif (err)\n\t\tgoto mlxplat_pci_fpga_device_init_i2c_fail;\n\n\terr = mlxplat_pci_fpga_device_init(PCI_DEVICE_ID_LATTICE_JTAG_BRIDGE,\n\t\t\t\t\t   \"mlxplat_jtag_bridge\", &jtag_bridge,\n\t\t\t\t\t    &jtag_bridge_addr);\n\tif (err)\n\t\tgoto mlxplat_pci_fpga_device_init_jtag_fail;\n\n\treturn 0;\n\nmlxplat_pci_fpga_device_init_jtag_fail:\n\tmlxplat_pci_fpga_device_exit(i2c_bridge, i2c_bridge_addr);\nmlxplat_pci_fpga_device_init_i2c_fail:\n\tmlxplat_pci_fpga_device_exit(lpc_bridge, mlxplat_mlxcpld_regmap_ctx.base);\nmlxplat_pci_fpga_device_init_lpc_fail:\n\treturn err;\n}\n\nstatic void mlxplat_pci_fpga_devices_exit(void)\n{\n\tmlxplat_pci_fpga_device_exit(jtag_bridge, jtag_bridge_addr);\n\tmlxplat_pci_fpga_device_exit(i2c_bridge, i2c_bridge_addr);\n\tmlxplat_pci_fpga_device_exit(lpc_bridge, mlxplat_mlxcpld_regmap_ctx.base);\n}\n\nstatic int\nmlxplat_pre_init(struct resource **hotplug_resources, unsigned int *hotplug_resources_size)\n{\n\tint err;\n\n\terr = mlxplat_pci_fpga_devices_init(hotplug_resources, hotplug_resources_size);\n\tif (err == -ENODEV)\n\t\treturn mlxplat_lpc_cpld_device_init(hotplug_resources, hotplug_resources_size);\n\n\treturn err;\n}\n\nstatic void mlxplat_post_exit(void)\n{\n\tif (lpc_bridge)\n\t\tmlxplat_pci_fpga_devices_exit();\n\telse\n\t\tmlxplat_lpc_cpld_device_exit();\n}\n\nstatic int mlxplat_post_init(struct mlxplat_priv *priv)\n{\n\tint i = 0, err;\n\n\t \n\tif (mlxplat_hotplug) {\n\t\tmlxplat_hotplug->regmap = priv->regmap;\n\t\tif (priv->irq_fpga)\n\t\t\tmlxplat_hotplug->irq = priv->irq_fpga;\n\t\tpriv->pdev_hotplug =\n\t\tplatform_device_register_resndata(&mlxplat_dev->dev,\n\t\t\t\t\t\t  \"mlxreg-hotplug\", PLATFORM_DEVID_NONE,\n\t\t\t\t\t\t  priv->hotplug_resources,\n\t\t\t\t\t\t  priv->hotplug_resources_size,\n\t\t\t\t\t\t  mlxplat_hotplug, sizeof(*mlxplat_hotplug));\n\t\tif (IS_ERR(priv->pdev_hotplug)) {\n\t\t\terr = PTR_ERR(priv->pdev_hotplug);\n\t\t\tgoto fail_platform_hotplug_register;\n\t\t}\n\t}\n\n\t \n\tif (mlxplat_led) {\n\t\tmlxplat_led->regmap = priv->regmap;\n\t\tpriv->pdev_led =\n\t\tplatform_device_register_resndata(&mlxplat_dev->dev, \"leds-mlxreg\",\n\t\t\t\t\t\t  PLATFORM_DEVID_NONE, NULL, 0, mlxplat_led,\n\t\t\t\t\t\t  sizeof(*mlxplat_led));\n\t\tif (IS_ERR(priv->pdev_led)) {\n\t\t\terr = PTR_ERR(priv->pdev_led);\n\t\t\tgoto fail_platform_leds_register;\n\t\t}\n\t}\n\n\t \n\tif (mlxplat_regs_io) {\n\t\tmlxplat_regs_io->regmap = priv->regmap;\n\t\tpriv->pdev_io_regs = platform_device_register_resndata(&mlxplat_dev->dev,\n\t\t\t\t\t\t\t\t       \"mlxreg-io\",\n\t\t\t\t\t\t\t\t       PLATFORM_DEVID_NONE, NULL,\n\t\t\t\t\t\t\t\t       0, mlxplat_regs_io,\n\t\t\t\t\t\t\t\t       sizeof(*mlxplat_regs_io));\n\t\tif (IS_ERR(priv->pdev_io_regs)) {\n\t\t\terr = PTR_ERR(priv->pdev_io_regs);\n\t\t\tgoto fail_platform_io_register;\n\t\t}\n\t}\n\n\t \n\tif (mlxplat_fan) {\n\t\tmlxplat_fan->regmap = priv->regmap;\n\t\tpriv->pdev_fan = platform_device_register_resndata(&mlxplat_dev->dev, \"mlxreg-fan\",\n\t\t\t\t\t\t\t\t   PLATFORM_DEVID_NONE, NULL, 0,\n\t\t\t\t\t\t\t\t   mlxplat_fan,\n\t\t\t\t\t\t\t\t   sizeof(*mlxplat_fan));\n\t\tif (IS_ERR(priv->pdev_fan)) {\n\t\t\terr = PTR_ERR(priv->pdev_fan);\n\t\t\tgoto fail_platform_fan_register;\n\t\t}\n\t}\n\n\t \n\terr = mlxplat_mlxcpld_check_wd_capability(priv->regmap);\n\tif (err)\n\t\tgoto fail_platform_wd_register;\n\tfor (i = 0; i < MLXPLAT_CPLD_WD_MAX_DEVS; i++) {\n\t\tif (mlxplat_wd_data[i]) {\n\t\t\tmlxplat_wd_data[i]->regmap = priv->regmap;\n\t\t\tpriv->pdev_wd[i] =\n\t\t\t\tplatform_device_register_resndata(&mlxplat_dev->dev, \"mlx-wdt\", i,\n\t\t\t\t\t\t\t\t  NULL, 0, mlxplat_wd_data[i],\n\t\t\t\t\t\t\t\t  sizeof(*mlxplat_wd_data[i]));\n\t\t\tif (IS_ERR(priv->pdev_wd[i])) {\n\t\t\t\terr = PTR_ERR(priv->pdev_wd[i]);\n\t\t\t\tgoto fail_platform_wd_register;\n\t\t\t}\n\t\t}\n\t}\n\n\treturn 0;\n\nfail_platform_wd_register:\n\twhile (--i >= 0)\n\t\tplatform_device_unregister(priv->pdev_wd[i]);\nfail_platform_fan_register:\n\tif (mlxplat_regs_io)\n\t\tplatform_device_unregister(priv->pdev_io_regs);\nfail_platform_io_register:\n\tif (mlxplat_led)\n\t\tplatform_device_unregister(priv->pdev_led);\nfail_platform_leds_register:\n\tif (mlxplat_hotplug)\n\t\tplatform_device_unregister(priv->pdev_hotplug);\nfail_platform_hotplug_register:\n\treturn err;\n}\n\nstatic void mlxplat_pre_exit(struct mlxplat_priv *priv)\n{\n\tint i;\n\n\tfor (i = MLXPLAT_CPLD_WD_MAX_DEVS - 1; i >= 0 ; i--)\n\t\tplatform_device_unregister(priv->pdev_wd[i]);\n\tif (priv->pdev_fan)\n\t\tplatform_device_unregister(priv->pdev_fan);\n\tif (priv->pdev_io_regs)\n\t\tplatform_device_unregister(priv->pdev_io_regs);\n\tif (priv->pdev_led)\n\t\tplatform_device_unregister(priv->pdev_led);\n\tif (priv->pdev_hotplug)\n\t\tplatform_device_unregister(priv->pdev_hotplug);\n}\n\nstatic int\nmlxplat_i2c_mux_complition_notify(void *handle, struct i2c_adapter *parent,\n\t\t\t\t  struct i2c_adapter *adapters[])\n{\n\tstruct mlxplat_priv *priv = handle;\n\n\treturn mlxplat_post_init(priv);\n}\n\nstatic int mlxplat_i2c_mux_topology_init(struct mlxplat_priv *priv)\n{\n\tint i, err;\n\n\tif (!priv->pdev_i2c) {\n\t\tpriv->i2c_main_init_status = MLXPLAT_I2C_MAIN_BUS_NOTIFIED;\n\t\treturn 0;\n\t}\n\n\tpriv->i2c_main_init_status = MLXPLAT_I2C_MAIN_BUS_HANDLE_CREATED;\n\tfor (i = 0; i < mlxplat_mux_num; i++) {\n\t\tpriv->pdev_mux[i] = platform_device_register_resndata(&priv->pdev_i2c->dev,\n\t\t\t\t\t\t\t\t      \"i2c-mux-reg\", i, NULL, 0,\n\t\t\t\t\t\t\t\t      &mlxplat_mux_data[i],\n\t\t\t\t\t\t\t\t      sizeof(mlxplat_mux_data[i]));\n\t\tif (IS_ERR(priv->pdev_mux[i])) {\n\t\t\terr = PTR_ERR(priv->pdev_mux[i]);\n\t\t\tgoto fail_platform_mux_register;\n\t\t}\n\t}\n\n\treturn mlxplat_i2c_mux_complition_notify(priv, NULL, NULL);\n\nfail_platform_mux_register:\n\twhile (--i >= 0)\n\t\tplatform_device_unregister(priv->pdev_mux[i]);\n\treturn err;\n}\n\nstatic void mlxplat_i2c_mux_topology_exit(struct mlxplat_priv *priv)\n{\n\tint i;\n\n\tfor (i = mlxplat_mux_num - 1; i >= 0 ; i--) {\n\t\tif (priv->pdev_mux[i])\n\t\t\tplatform_device_unregister(priv->pdev_mux[i]);\n\t}\n}\n\nstatic int mlxplat_i2c_main_complition_notify(void *handle, int id)\n{\n\tstruct mlxplat_priv *priv = handle;\n\n\treturn mlxplat_i2c_mux_topology_init(priv);\n}\n\nstatic int mlxplat_i2c_main_init(struct mlxplat_priv *priv)\n{\n\tint nr, err;\n\n\tif (!mlxplat_i2c)\n\t\treturn 0;\n\n\terr = mlxplat_mlxcpld_verify_bus_topology(&nr);\n\tif (nr < 0)\n\t\tgoto fail_mlxplat_mlxcpld_verify_bus_topology;\n\n\tnr = (nr == mlxplat_max_adap_num) ? -1 : nr;\n\tmlxplat_i2c->regmap = priv->regmap;\n\tmlxplat_i2c->handle = priv;\n\n\t \n\tif (lpc_bridge)\n\t\tmlxplat_i2c->addr = i2c_bridge_addr;\n\tpriv->pdev_i2c = platform_device_register_resndata(&mlxplat_dev->dev, \"i2c_mlxcpld\",\n\t\t\t\t\t\t\t   nr, priv->hotplug_resources,\n\t\t\t\t\t\t\t   priv->hotplug_resources_size,\n\t\t\t\t\t\t\t   mlxplat_i2c, sizeof(*mlxplat_i2c));\n\tif (IS_ERR(priv->pdev_i2c)) {\n\t\terr = PTR_ERR(priv->pdev_i2c);\n\t\tgoto fail_platform_i2c_register;\n\t}\n\n\tif (priv->i2c_main_init_status == MLXPLAT_I2C_MAIN_BUS_NOTIFIED) {\n\t\terr = mlxplat_i2c_mux_topology_init(priv);\n\t\tif (err)\n\t\t\tgoto fail_mlxplat_i2c_mux_topology_init;\n\t}\n\n\treturn 0;\n\nfail_mlxplat_i2c_mux_topology_init:\n\tplatform_device_unregister(priv->pdev_i2c);\nfail_platform_i2c_register:\nfail_mlxplat_mlxcpld_verify_bus_topology:\n\treturn err;\n}\n\nstatic void mlxplat_i2c_main_exit(struct mlxplat_priv *priv)\n{\n\tmlxplat_pre_exit(priv);\n\tmlxplat_i2c_mux_topology_exit(priv);\n\tif (priv->pdev_i2c)\n\t\tplatform_device_unregister(priv->pdev_i2c);\n}\n\nstatic int mlxplat_probe(struct platform_device *pdev)\n{\n\tunsigned int hotplug_resources_size = 0;\n\tstruct resource *hotplug_resources = NULL;\n\tstruct acpi_device *acpi_dev;\n\tstruct mlxplat_priv *priv;\n\tint irq_fpga = 0, i, err;\n\n\tacpi_dev = ACPI_COMPANION(&pdev->dev);\n\tif (acpi_dev) {\n\t\tirq_fpga = acpi_dev_gpio_irq_get(acpi_dev, 0);\n\t\tif (irq_fpga < 0)\n\t\t\treturn -ENODEV;\n\t\tmlxplat_dev = pdev;\n\t}\n\n\terr = mlxplat_pre_init(&hotplug_resources, &hotplug_resources_size);\n\tif (err)\n\t\treturn err;\n\n\tpriv = devm_kzalloc(&mlxplat_dev->dev, sizeof(struct mlxplat_priv),\n\t\t\t    GFP_KERNEL);\n\tif (!priv) {\n\t\terr = -ENOMEM;\n\t\tgoto fail_alloc;\n\t}\n\tplatform_set_drvdata(mlxplat_dev, priv);\n\tpriv->hotplug_resources = hotplug_resources;\n\tpriv->hotplug_resources_size = hotplug_resources_size;\n\tpriv->irq_fpga = irq_fpga;\n\n\tif (!mlxplat_regmap_config)\n\t\tmlxplat_regmap_config = &mlxplat_mlxcpld_regmap_config;\n\n\tpriv->regmap = devm_regmap_init(&mlxplat_dev->dev, NULL,\n\t\t\t\t\t&mlxplat_mlxcpld_regmap_ctx,\n\t\t\t\t\tmlxplat_regmap_config);\n\tif (IS_ERR(priv->regmap)) {\n\t\terr = PTR_ERR(priv->regmap);\n\t\tgoto fail_alloc;\n\t}\n\n\t \n\tfor (i = 0; i <  mlxplat_regmap_config->num_reg_defaults; i++) {\n\t\terr = regmap_write(priv->regmap,\n\t\t\t\t   mlxplat_regmap_config->reg_defaults[i].reg,\n\t\t\t\t   mlxplat_regmap_config->reg_defaults[i].def);\n\t\tif (err)\n\t\t\tgoto fail_regmap_write;\n\t}\n\n\terr = mlxplat_i2c_main_init(priv);\n\tif (err)\n\t\tgoto fail_mlxplat_i2c_main_init;\n\n\t \n\tregcache_mark_dirty(priv->regmap);\n\terr = regcache_sync(priv->regmap);\n\tif (err)\n\t\tgoto fail_regcache_sync;\n\n\tif (mlxplat_reboot_nb) {\n\t\terr = register_reboot_notifier(mlxplat_reboot_nb);\n\t\tif (err)\n\t\t\tgoto fail_register_reboot_notifier;\n\t}\n\n\treturn 0;\n\nfail_register_reboot_notifier:\nfail_regcache_sync:\n\tmlxplat_i2c_main_exit(priv);\nfail_mlxplat_i2c_main_init:\nfail_regmap_write:\nfail_alloc:\n\tmlxplat_post_exit();\n\n\treturn err;\n}\n\nstatic int mlxplat_remove(struct platform_device *pdev)\n{\n\tstruct mlxplat_priv *priv = platform_get_drvdata(mlxplat_dev);\n\n\tif (pm_power_off)\n\t\tpm_power_off = NULL;\n\tif (mlxplat_reboot_nb)\n\t\tunregister_reboot_notifier(mlxplat_reboot_nb);\n\tmlxplat_i2c_main_exit(priv);\n\tmlxplat_post_exit();\n\treturn 0;\n}\n\nstatic const struct acpi_device_id mlxplat_acpi_table[] = {\n\t{ \"MLNXBF49\", 0 },\n\t{}\n};\nMODULE_DEVICE_TABLE(acpi, mlxplat_acpi_table);\n\nstatic struct platform_driver mlxplat_driver = {\n\t.driver\t\t= {\n\t\t.name\t= \"mlxplat\",\n\t\t.acpi_match_table = mlxplat_acpi_table,\n\t\t.probe_type = PROBE_FORCE_SYNCHRONOUS,\n\t},\n\t.probe\t\t= mlxplat_probe,\n\t.remove\t\t= mlxplat_remove,\n};\n\nstatic int __init mlxplat_init(void)\n{\n\tint err;\n\n\tif (!dmi_check_system(mlxplat_dmi_table))\n\t\treturn -ENODEV;\n\n\terr = platform_driver_register(&mlxplat_driver);\n\tif (err)\n\t\treturn err;\n\treturn 0;\n}\nmodule_init(mlxplat_init);\n\nstatic void __exit mlxplat_exit(void)\n{\n\tif (mlxplat_dev)\n\t\tplatform_device_unregister(mlxplat_dev);\n\n\tplatform_driver_unregister(&mlxplat_driver);\n}\nmodule_exit(mlxplat_exit);\n\nMODULE_AUTHOR(\"Vadim Pasternak (vadimp@mellanox.com)\");\nMODULE_DESCRIPTION(\"Mellanox platform driver\");\nMODULE_LICENSE(\"Dual BSD/GPL\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}