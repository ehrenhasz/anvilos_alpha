{
  "module_name": "pinctrl-imx8ulp.c",
  "hash_id": "3e11db53e175cddbfbb285687b008319655a4f516d49af6e89724adc65cf1f73",
  "original_prompt": "Ingested from linux-6.6.14/drivers/pinctrl/freescale/pinctrl-imx8ulp.c",
  "human_readable_source": "\n \n\n#include <linux/err.h>\n#include <linux/init.h>\n#include <linux/io.h>\n#include <linux/mod_devicetable.h>\n#include <linux/module.h>\n#include <linux/pinctrl/pinctrl.h>\n#include <linux/platform_device.h>\n\n#include \"pinctrl-imx.h\"\n\nenum imx8ulp_pads {\n\tIMX8ULP_PAD_PTD0 = 0,\n\tIMX8ULP_PAD_PTD1,\n\tIMX8ULP_PAD_PTD2,\n\tIMX8ULP_PAD_PTD3,\n\tIMX8ULP_PAD_PTD4,\n\tIMX8ULP_PAD_PTD5,\n\tIMX8ULP_PAD_PTD6,\n\tIMX8ULP_PAD_PTD7,\n\tIMX8ULP_PAD_PTD8,\n\tIMX8ULP_PAD_PTD9,\n\tIMX8ULP_PAD_PTD10,\n\tIMX8ULP_PAD_PTD11,\n\tIMX8ULP_PAD_PTD12,\n\tIMX8ULP_PAD_PTD13,\n\tIMX8ULP_PAD_PTD14,\n\tIMX8ULP_PAD_PTD15,\n\tIMX8ULP_PAD_PTD16,\n\tIMX8ULP_PAD_PTD17,\n\tIMX8ULP_PAD_PTD18,\n\tIMX8ULP_PAD_PTD19,\n\tIMX8ULP_PAD_PTD20,\n\tIMX8ULP_PAD_PTD21,\n\tIMX8ULP_PAD_PTD22,\n\tIMX8ULP_PAD_PTD23,\n\tIMX8ULP_PAD_RESERVE0,\n\tIMX8ULP_PAD_RESERVE1,\n\tIMX8ULP_PAD_RESERVE2,\n\tIMX8ULP_PAD_RESERVE3,\n\tIMX8ULP_PAD_RESERVE4,\n\tIMX8ULP_PAD_RESERVE5,\n\tIMX8ULP_PAD_RESERVE6,\n\tIMX8ULP_PAD_RESERVE7,\n\tIMX8ULP_PAD_PTE0,\n\tIMX8ULP_PAD_PTE1,\n\tIMX8ULP_PAD_PTE2,\n\tIMX8ULP_PAD_PTE3,\n\tIMX8ULP_PAD_PTE4,\n\tIMX8ULP_PAD_PTE5,\n\tIMX8ULP_PAD_PTE6,\n\tIMX8ULP_PAD_PTE7,\n\tIMX8ULP_PAD_PTE8,\n\tIMX8ULP_PAD_PTE9,\n\tIMX8ULP_PAD_PTE10,\n\tIMX8ULP_PAD_PTE11,\n\tIMX8ULP_PAD_PTE12,\n\tIMX8ULP_PAD_PTE13,\n\tIMX8ULP_PAD_PTE14,\n\tIMX8ULP_PAD_PTE15,\n\tIMX8ULP_PAD_PTE16,\n\tIMX8ULP_PAD_PTE17,\n\tIMX8ULP_PAD_PTE18,\n\tIMX8ULP_PAD_PTE19,\n\tIMX8ULP_PAD_PTE20,\n\tIMX8ULP_PAD_PTE21,\n\tIMX8ULP_PAD_PTE22,\n\tIMX8ULP_PAD_PTE23,\n\tIMX8ULP_PAD_RESERVE8,\n\tIMX8ULP_PAD_RESERVE9,\n\tIMX8ULP_PAD_RESERVE10,\n\tIMX8ULP_PAD_RESERVE11,\n\tIMX8ULP_PAD_RESERVE12,\n\tIMX8ULP_PAD_RESERVE13,\n\tIMX8ULP_PAD_RESERVE14,\n\tIMX8ULP_PAD_RESERVE15,\n\tIMX8ULP_PAD_PTF0,\n\tIMX8ULP_PAD_PTF1,\n\tIMX8ULP_PAD_PTF2,\n\tIMX8ULP_PAD_PTF3,\n\tIMX8ULP_PAD_PTF4,\n\tIMX8ULP_PAD_PTF5,\n\tIMX8ULP_PAD_PTF6,\n\tIMX8ULP_PAD_PTF7,\n\tIMX8ULP_PAD_PTF8,\n\tIMX8ULP_PAD_PTF9,\n\tIMX8ULP_PAD_PTF10,\n\tIMX8ULP_PAD_PTF11,\n\tIMX8ULP_PAD_PTF12,\n\tIMX8ULP_PAD_PTF13,\n\tIMX8ULP_PAD_PTF14,\n\tIMX8ULP_PAD_PTF15,\n\tIMX8ULP_PAD_PTF16,\n\tIMX8ULP_PAD_PTF17,\n\tIMX8ULP_PAD_PTF18,\n\tIMX8ULP_PAD_PTF19,\n\tIMX8ULP_PAD_PTF20,\n\tIMX8ULP_PAD_PTF21,\n\tIMX8ULP_PAD_PTF22,\n\tIMX8ULP_PAD_PTF23,\n\tIMX8ULP_PAD_PTF24,\n\tIMX8ULP_PAD_PTF25,\n\tIMX8ULP_PAD_PTF26,\n\tIMX8ULP_PAD_PTF27,\n\tIMX8ULP_PAD_PTF28,\n\tIMX8ULP_PAD_PTF29,\n\tIMX8ULP_PAD_PTF30,\n\tIMX8ULP_PAD_PTF31,\n};\n\n \nstatic const struct pinctrl_pin_desc imx8ulp_pinctrl_pads[] = {\n\tIMX_PINCTRL_PIN(IMX8ULP_PAD_PTD0),\n\tIMX_PINCTRL_PIN(IMX8ULP_PAD_PTD1),\n\tIMX_PINCTRL_PIN(IMX8ULP_PAD_PTD2),\n\tIMX_PINCTRL_PIN(IMX8ULP_PAD_PTD3),\n\tIMX_PINCTRL_PIN(IMX8ULP_PAD_PTD4),\n\tIMX_PINCTRL_PIN(IMX8ULP_PAD_PTD5),\n\tIMX_PINCTRL_PIN(IMX8ULP_PAD_PTD6),\n\tIMX_PINCTRL_PIN(IMX8ULP_PAD_PTD7),\n\tIMX_PINCTRL_PIN(IMX8ULP_PAD_PTD8),\n\tIMX_PINCTRL_PIN(IMX8ULP_PAD_PTD9),\n\tIMX_PINCTRL_PIN(IMX8ULP_PAD_PTD10),\n\tIMX_PINCTRL_PIN(IMX8ULP_PAD_PTD11),\n\tIMX_PINCTRL_PIN(IMX8ULP_PAD_PTD12),\n\tIMX_PINCTRL_PIN(IMX8ULP_PAD_PTD13),\n\tIMX_PINCTRL_PIN(IMX8ULP_PAD_PTD14),\n\tIMX_PINCTRL_PIN(IMX8ULP_PAD_PTD15),\n\tIMX_PINCTRL_PIN(IMX8ULP_PAD_PTD16),\n\tIMX_PINCTRL_PIN(IMX8ULP_PAD_PTD17),\n\tIMX_PINCTRL_PIN(IMX8ULP_PAD_PTD18),\n\tIMX_PINCTRL_PIN(IMX8ULP_PAD_PTD19),\n\tIMX_PINCTRL_PIN(IMX8ULP_PAD_PTD20),\n\tIMX_PINCTRL_PIN(IMX8ULP_PAD_PTD21),\n\tIMX_PINCTRL_PIN(IMX8ULP_PAD_PTD22),\n\tIMX_PINCTRL_PIN(IMX8ULP_PAD_PTD23),\n\tIMX_PINCTRL_PIN(IMX8ULP_PAD_RESERVE0),\n\tIMX_PINCTRL_PIN(IMX8ULP_PAD_RESERVE1),\n\tIMX_PINCTRL_PIN(IMX8ULP_PAD_RESERVE2),\n\tIMX_PINCTRL_PIN(IMX8ULP_PAD_RESERVE3),\n\tIMX_PINCTRL_PIN(IMX8ULP_PAD_RESERVE4),\n\tIMX_PINCTRL_PIN(IMX8ULP_PAD_RESERVE5),\n\tIMX_PINCTRL_PIN(IMX8ULP_PAD_RESERVE6),\n\tIMX_PINCTRL_PIN(IMX8ULP_PAD_RESERVE7),\n\tIMX_PINCTRL_PIN(IMX8ULP_PAD_PTE0),\n\tIMX_PINCTRL_PIN(IMX8ULP_PAD_PTE1),\n\tIMX_PINCTRL_PIN(IMX8ULP_PAD_PTE2),\n\tIMX_PINCTRL_PIN(IMX8ULP_PAD_PTE3),\n\tIMX_PINCTRL_PIN(IMX8ULP_PAD_PTE4),\n\tIMX_PINCTRL_PIN(IMX8ULP_PAD_PTE5),\n\tIMX_PINCTRL_PIN(IMX8ULP_PAD_PTE6),\n\tIMX_PINCTRL_PIN(IMX8ULP_PAD_PTE7),\n\tIMX_PINCTRL_PIN(IMX8ULP_PAD_PTE8),\n\tIMX_PINCTRL_PIN(IMX8ULP_PAD_PTE9),\n\tIMX_PINCTRL_PIN(IMX8ULP_PAD_PTE10),\n\tIMX_PINCTRL_PIN(IMX8ULP_PAD_PTE11),\n\tIMX_PINCTRL_PIN(IMX8ULP_PAD_PTE12),\n\tIMX_PINCTRL_PIN(IMX8ULP_PAD_PTE13),\n\tIMX_PINCTRL_PIN(IMX8ULP_PAD_PTE14),\n\tIMX_PINCTRL_PIN(IMX8ULP_PAD_PTE15),\n\tIMX_PINCTRL_PIN(IMX8ULP_PAD_PTE16),\n\tIMX_PINCTRL_PIN(IMX8ULP_PAD_PTE17),\n\tIMX_PINCTRL_PIN(IMX8ULP_PAD_PTE18),\n\tIMX_PINCTRL_PIN(IMX8ULP_PAD_PTE19),\n\tIMX_PINCTRL_PIN(IMX8ULP_PAD_PTE20),\n\tIMX_PINCTRL_PIN(IMX8ULP_PAD_PTE21),\n\tIMX_PINCTRL_PIN(IMX8ULP_PAD_PTE22),\n\tIMX_PINCTRL_PIN(IMX8ULP_PAD_PTE23),\n\tIMX_PINCTRL_PIN(IMX8ULP_PAD_RESERVE8),\n\tIMX_PINCTRL_PIN(IMX8ULP_PAD_RESERVE9),\n\tIMX_PINCTRL_PIN(IMX8ULP_PAD_RESERVE10),\n\tIMX_PINCTRL_PIN(IMX8ULP_PAD_RESERVE11),\n\tIMX_PINCTRL_PIN(IMX8ULP_PAD_RESERVE12),\n\tIMX_PINCTRL_PIN(IMX8ULP_PAD_RESERVE13),\n\tIMX_PINCTRL_PIN(IMX8ULP_PAD_RESERVE14),\n\tIMX_PINCTRL_PIN(IMX8ULP_PAD_RESERVE15),\n\tIMX_PINCTRL_PIN(IMX8ULP_PAD_PTF0),\n\tIMX_PINCTRL_PIN(IMX8ULP_PAD_PTF1),\n\tIMX_PINCTRL_PIN(IMX8ULP_PAD_PTF2),\n\tIMX_PINCTRL_PIN(IMX8ULP_PAD_PTF3),\n\tIMX_PINCTRL_PIN(IMX8ULP_PAD_PTF4),\n\tIMX_PINCTRL_PIN(IMX8ULP_PAD_PTF5),\n\tIMX_PINCTRL_PIN(IMX8ULP_PAD_PTF6),\n\tIMX_PINCTRL_PIN(IMX8ULP_PAD_PTF7),\n\tIMX_PINCTRL_PIN(IMX8ULP_PAD_PTF8),\n\tIMX_PINCTRL_PIN(IMX8ULP_PAD_PTF9),\n\tIMX_PINCTRL_PIN(IMX8ULP_PAD_PTF10),\n\tIMX_PINCTRL_PIN(IMX8ULP_PAD_PTF11),\n\tIMX_PINCTRL_PIN(IMX8ULP_PAD_PTF12),\n\tIMX_PINCTRL_PIN(IMX8ULP_PAD_PTF13),\n\tIMX_PINCTRL_PIN(IMX8ULP_PAD_PTF14),\n\tIMX_PINCTRL_PIN(IMX8ULP_PAD_PTF15),\n\tIMX_PINCTRL_PIN(IMX8ULP_PAD_PTF16),\n\tIMX_PINCTRL_PIN(IMX8ULP_PAD_PTF17),\n\tIMX_PINCTRL_PIN(IMX8ULP_PAD_PTF18),\n\tIMX_PINCTRL_PIN(IMX8ULP_PAD_PTF19),\n\tIMX_PINCTRL_PIN(IMX8ULP_PAD_PTF20),\n\tIMX_PINCTRL_PIN(IMX8ULP_PAD_PTF21),\n\tIMX_PINCTRL_PIN(IMX8ULP_PAD_PTF22),\n\tIMX_PINCTRL_PIN(IMX8ULP_PAD_PTF23),\n\tIMX_PINCTRL_PIN(IMX8ULP_PAD_PTF24),\n\tIMX_PINCTRL_PIN(IMX8ULP_PAD_PTF25),\n\tIMX_PINCTRL_PIN(IMX8ULP_PAD_PTF26),\n\tIMX_PINCTRL_PIN(IMX8ULP_PAD_PTF27),\n\tIMX_PINCTRL_PIN(IMX8ULP_PAD_PTF28),\n\tIMX_PINCTRL_PIN(IMX8ULP_PAD_PTF29),\n\tIMX_PINCTRL_PIN(IMX8ULP_PAD_PTF30),\n\tIMX_PINCTRL_PIN(IMX8ULP_PAD_PTF31),\n};\n\n#define BM_OBE_ENABLED\t\tBIT(17)\n#define BM_IBE_ENABLED\t\tBIT(16)\n#define BM_MUX_MODE\t\t0xf00\n#define BP_MUX_MODE\t\t8\n\nstatic int imx8ulp_pmx_gpio_set_direction(struct pinctrl_dev *pctldev,\n\t\t\t\t\t  struct pinctrl_gpio_range *range,\n\t\t\t\t\t  unsigned offset, bool input)\n{\n\tstruct imx_pinctrl *ipctl = pinctrl_dev_get_drvdata(pctldev);\n\tconst struct imx_pin_reg *pin_reg;\n\tu32 reg;\n\n\tpin_reg = &ipctl->pin_regs[offset];\n\tif (pin_reg->mux_reg == -1)\n\t\treturn -EINVAL;\n\n\treg = readl(ipctl->base + pin_reg->mux_reg);\n\tif (input)\n\t\treg = (reg & ~BM_OBE_ENABLED) | BM_IBE_ENABLED;\n\telse\n\t\treg = (reg & ~BM_IBE_ENABLED) | BM_OBE_ENABLED;\n\twritel(reg, ipctl->base + pin_reg->mux_reg);\n\n\treturn 0;\n}\n\nstatic const struct imx_pinctrl_soc_info imx8ulp_pinctrl_info = {\n\t.pins = imx8ulp_pinctrl_pads,\n\t.npins = ARRAY_SIZE(imx8ulp_pinctrl_pads),\n\t.flags = ZERO_OFFSET_VALID | SHARE_MUX_CONF_REG,\n\t.gpio_set_direction = imx8ulp_pmx_gpio_set_direction,\n\t.mux_mask = BM_MUX_MODE,\n\t.mux_shift = BP_MUX_MODE,\n};\n\nstatic const struct of_device_id imx8ulp_pinctrl_of_match[] = {\n\t{ .compatible = \"fsl,imx8ulp-iomuxc1\", },\n\t{   }\n};\n\nstatic int imx8ulp_pinctrl_probe(struct platform_device *pdev)\n{\n\treturn imx_pinctrl_probe(pdev, &imx8ulp_pinctrl_info);\n}\n\nstatic struct platform_driver imx8ulp_pinctrl_driver = {\n\t.driver = {\n\t\t.name = \"imx8ulp-pinctrl\",\n\t\t.of_match_table = imx8ulp_pinctrl_of_match,\n\t\t.suppress_bind_attrs = true,\n\t},\n\t.probe = imx8ulp_pinctrl_probe,\n};\n\nstatic int __init imx8ulp_pinctrl_init(void)\n{\n\treturn platform_driver_register(&imx8ulp_pinctrl_driver);\n}\narch_initcall(imx8ulp_pinctrl_init);\n\nMODULE_AUTHOR(\"Jacky Bai <ping.bai@nxp.com>\");\nMODULE_DESCRIPTION(\"NXP i.MX8ULP pinctrl driver\");\nMODULE_LICENSE(\"GPL v2\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}