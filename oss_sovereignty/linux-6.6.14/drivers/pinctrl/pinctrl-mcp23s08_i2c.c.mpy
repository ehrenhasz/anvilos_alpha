{
  "module_name": "pinctrl-mcp23s08_i2c.c",
  "hash_id": "842657c4f703ff85bcc6e05827f0ffe5810ff5ea7f61b0a09db6049a0410abab",
  "original_prompt": "Ingested from linux-6.6.14/drivers/pinctrl/pinctrl-mcp23s08_i2c.c",
  "human_readable_source": "\n \n\n#include <linux/i2c.h>\n#include <linux/mod_devicetable.h>\n#include <linux/module.h>\n#include <linux/regmap.h>\n\n#include \"pinctrl-mcp23s08.h\"\n\nstatic int mcp230xx_probe(struct i2c_client *client)\n{\n\tconst struct i2c_device_id *id = i2c_client_get_device_id(client);\n\tstruct device *dev = &client->dev;\n\tunsigned int type = id->driver_data;\n\tstruct mcp23s08 *mcp;\n\tint ret;\n\n\tmcp = devm_kzalloc(dev, sizeof(*mcp), GFP_KERNEL);\n\tif (!mcp)\n\t\treturn -ENOMEM;\n\n\tswitch (type) {\n\tcase MCP_TYPE_008:\n\t\tmcp->regmap = devm_regmap_init_i2c(client, &mcp23x08_regmap);\n\t\tmcp->reg_shift = 0;\n\t\tmcp->chip.ngpio = 8;\n\t\tmcp->chip.label = \"mcp23008\";\n\t\tbreak;\n\n\tcase MCP_TYPE_017:\n\t\tmcp->regmap = devm_regmap_init_i2c(client, &mcp23x17_regmap);\n\t\tmcp->reg_shift = 1;\n\t\tmcp->chip.ngpio = 16;\n\t\tmcp->chip.label = \"mcp23017\";\n\t\tbreak;\n\n\tcase MCP_TYPE_018:\n\t\tmcp->regmap = devm_regmap_init_i2c(client, &mcp23x17_regmap);\n\t\tmcp->reg_shift = 1;\n\t\tmcp->chip.ngpio = 16;\n\t\tmcp->chip.label = \"mcp23018\";\n\t\tbreak;\n\n\tdefault:\n\t\tdev_err(dev, \"invalid device type (%d)\\n\", type);\n\t\treturn -EINVAL;\n\t}\n\n\tif (IS_ERR(mcp->regmap))\n\t\treturn PTR_ERR(mcp->regmap);\n\n\tmcp->irq = client->irq;\n\tmcp->pinctrl_desc.name = \"mcp23xxx-pinctrl\";\n\n\tret = mcp23s08_probe_one(mcp, dev, client->addr, type, -1);\n\tif (ret)\n\t\treturn ret;\n\n\ti2c_set_clientdata(client, mcp);\n\n\treturn 0;\n}\n\nstatic const struct i2c_device_id mcp230xx_id[] = {\n\t{ \"mcp23008\", MCP_TYPE_008 },\n\t{ \"mcp23017\", MCP_TYPE_017 },\n\t{ \"mcp23018\", MCP_TYPE_018 },\n\t{ }\n};\nMODULE_DEVICE_TABLE(i2c, mcp230xx_id);\n\nstatic const struct of_device_id mcp23s08_i2c_of_match[] = {\n\t{\n\t\t.compatible = \"microchip,mcp23008\",\n\t\t.data = (void *) MCP_TYPE_008,\n\t},\n\t{\n\t\t.compatible = \"microchip,mcp23017\",\n\t\t.data = (void *) MCP_TYPE_017,\n\t},\n\t{\n\t\t.compatible = \"microchip,mcp23018\",\n\t\t.data = (void *) MCP_TYPE_018,\n\t},\n \n\t{\n\t\t.compatible = \"mcp,mcp23008\",\n\t\t.data = (void *) MCP_TYPE_008,\n\t},\n\t{\n\t\t.compatible = \"mcp,mcp23017\",\n\t\t.data = (void *) MCP_TYPE_017,\n\t},\n\t{ }\n};\nMODULE_DEVICE_TABLE(of, mcp23s08_i2c_of_match);\n\nstatic struct i2c_driver mcp230xx_driver = {\n\t.driver = {\n\t\t.name\t= \"mcp230xx\",\n\t\t.of_match_table = mcp23s08_i2c_of_match,\n\t},\n\t.probe\t\t= mcp230xx_probe,\n\t.id_table\t= mcp230xx_id,\n};\n\nstatic int __init mcp23s08_i2c_init(void)\n{\n\treturn i2c_add_driver(&mcp230xx_driver);\n}\n\n \nsubsys_initcall(mcp23s08_i2c_init);\n\nstatic void mcp23s08_i2c_exit(void)\n{\n\ti2c_del_driver(&mcp230xx_driver);\n}\nmodule_exit(mcp23s08_i2c_exit);\n\nMODULE_LICENSE(\"GPL\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}