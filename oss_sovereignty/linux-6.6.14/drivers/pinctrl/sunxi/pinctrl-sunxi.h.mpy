{
  "module_name": "pinctrl-sunxi.h",
  "hash_id": "d9b12553ca3ac634d6147dfc352fb03b05b479330b134312490b1b0a515c8a6c",
  "original_prompt": "Ingested from linux-6.6.14/drivers/pinctrl/sunxi/pinctrl-sunxi.h",
  "human_readable_source": " \n\n#ifndef __PINCTRL_SUNXI_H\n#define __PINCTRL_SUNXI_H\n\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n\n#define PA_BASE\t0\n#define PB_BASE\t32\n#define PC_BASE\t64\n#define PD_BASE\t96\n#define PE_BASE\t128\n#define PF_BASE\t160\n#define PG_BASE\t192\n#define PH_BASE\t224\n#define PI_BASE\t256\n#define PL_BASE\t352\n#define PM_BASE\t384\n#define PN_BASE\t416\n\n#define SUNXI_PINCTRL_PIN(bank, pin)\t\t\\\n\tPINCTRL_PIN(P ## bank ## _BASE + (pin), \"P\" #bank #pin)\n\n#define SUNXI_PIN_NAME_MAX_LEN\t5\n\n#define BANK_MEM_SIZE\t\t0x24\n#define MUX_REGS_OFFSET\t\t0x0\n#define MUX_FIELD_WIDTH\t\t4\n#define DATA_REGS_OFFSET\t0x10\n#define DATA_FIELD_WIDTH\t1\n#define DLEVEL_REGS_OFFSET\t0x14\n#define DLEVEL_FIELD_WIDTH\t2\n#define PULL_REGS_OFFSET\t0x1c\n#define PULL_FIELD_WIDTH\t2\n\n#define D1_BANK_MEM_SIZE\t0x30\n#define D1_DLEVEL_FIELD_WIDTH\t4\n#define D1_PULL_REGS_OFFSET\t0x24\n\n#define PINS_PER_BANK\t\t32\n\n#define IRQ_PER_BANK\t\t32\n\n#define IRQ_CFG_REG\t\t0x200\n#define IRQ_CFG_IRQ_PER_REG\t\t8\n#define IRQ_CFG_IRQ_BITS\t\t4\n#define IRQ_CFG_IRQ_MASK\t\t((1 << IRQ_CFG_IRQ_BITS) - 1)\n#define IRQ_CTRL_REG\t\t0x210\n#define IRQ_CTRL_IRQ_PER_REG\t\t32\n#define IRQ_CTRL_IRQ_BITS\t\t1\n#define IRQ_CTRL_IRQ_MASK\t\t((1 << IRQ_CTRL_IRQ_BITS) - 1)\n#define IRQ_STATUS_REG\t\t0x214\n#define IRQ_STATUS_IRQ_PER_REG\t\t32\n#define IRQ_STATUS_IRQ_BITS\t\t1\n#define IRQ_STATUS_IRQ_MASK\t\t((1 << IRQ_STATUS_IRQ_BITS) - 1)\n\n#define IRQ_DEBOUNCE_REG\t0x218\n\n#define IRQ_MEM_SIZE\t\t0x20\n\n#define IRQ_EDGE_RISING\t\t0x00\n#define IRQ_EDGE_FALLING\t0x01\n#define IRQ_LEVEL_HIGH\t\t0x02\n#define IRQ_LEVEL_LOW\t\t0x03\n#define IRQ_EDGE_BOTH\t\t0x04\n\n#define GRP_CFG_REG\t\t0x300\n\n#define IO_BIAS_MASK\t\tGENMASK(3, 0)\n\n#define SUN4I_FUNC_INPUT\t0\n#define SUN4I_FUNC_IRQ\t\t6\n\n#define PINCTRL_SUN5I_A10S\tBIT(1)\n#define PINCTRL_SUN5I_A13\tBIT(2)\n#define PINCTRL_SUN5I_GR8\tBIT(3)\n#define PINCTRL_SUN6I_A31\tBIT(4)\n#define PINCTRL_SUN6I_A31S\tBIT(5)\n#define PINCTRL_SUN4I_A10\tBIT(6)\n#define PINCTRL_SUN7I_A20\tBIT(7)\n#define PINCTRL_SUN8I_R40\tBIT(8)\n#define PINCTRL_SUN8I_V3\tBIT(9)\n#define PINCTRL_SUN8I_V3S\tBIT(10)\n \n#define PINCTRL_SUN20I_D1\tBIT(11)\n\n#define PIO_POW_MOD_SEL_REG\t0x340\n#define PIO_POW_MOD_CTL_REG\t0x344\n\nenum sunxi_desc_bias_voltage {\n\tBIAS_VOLTAGE_NONE,\n\t \n\tBIAS_VOLTAGE_GRP_CONFIG,\n\t \n\tBIAS_VOLTAGE_PIO_POW_MODE_SEL,\n\t \n\tBIAS_VOLTAGE_PIO_POW_MODE_CTL,\n};\n\nstruct sunxi_desc_function {\n\tunsigned long\tvariant;\n\tconst char\t*name;\n\tu8\t\tmuxval;\n\tu8\t\tirqbank;\n\tu8\t\tirqnum;\n};\n\nstruct sunxi_desc_pin {\n\tstruct pinctrl_pin_desc\t\tpin;\n\tunsigned long\t\t\tvariant;\n\tstruct sunxi_desc_function\t*functions;\n};\n\nstruct sunxi_pinctrl_desc {\n\tconst struct sunxi_desc_pin\t*pins;\n\tint\t\t\t\tnpins;\n\tunsigned\t\t\tpin_base;\n\tunsigned\t\t\tirq_banks;\n\tconst unsigned int\t\t*irq_bank_map;\n\tbool\t\t\t\tirq_read_needs_mux;\n\tbool\t\t\t\tdisable_strict_mode;\n\tenum sunxi_desc_bias_voltage\tio_bias_cfg_variant;\n};\n\nstruct sunxi_pinctrl_function {\n\tconst char\t*name;\n\tconst char\t**groups;\n\tunsigned\tngroups;\n};\n\nstruct sunxi_pinctrl_group {\n\tconst char\t*name;\n\tunsigned\tpin;\n};\n\nstruct sunxi_pinctrl_regulator {\n\tstruct regulator\t*regulator;\n\trefcount_t\t\trefcount;\n};\n\nstruct sunxi_pinctrl {\n\tvoid __iomem\t\t\t*membase;\n\tstruct gpio_chip\t\t*chip;\n\tconst struct sunxi_pinctrl_desc\t*desc;\n\tstruct device\t\t\t*dev;\n\tstruct sunxi_pinctrl_regulator\tregulators[9];\n\tstruct irq_domain\t\t*domain;\n\tstruct sunxi_pinctrl_function\t*functions;\n\tunsigned\t\t\tnfunctions;\n\tstruct sunxi_pinctrl_group\t*groups;\n\tunsigned\t\t\tngroups;\n\tint\t\t\t\t*irq;\n\tunsigned\t\t\t*irq_array;\n\traw_spinlock_t\t\t\tlock;\n\tstruct pinctrl_dev\t\t*pctl_dev;\n\tunsigned long\t\t\tvariant;\n\tu32\t\t\t\tbank_mem_size;\n\tu32\t\t\t\tpull_regs_offset;\n\tu32\t\t\t\tdlevel_field_width;\n};\n\n#define SUNXI_PIN(_pin, ...)\t\t\t\t\t\\\n\t{\t\t\t\t\t\t\t\\\n\t\t.pin = _pin,\t\t\t\t\t\\\n\t\t.functions = (struct sunxi_desc_function[]){\t\\\n\t\t\t__VA_ARGS__, { } },\t\t\t\\\n\t}\n\n#define SUNXI_PIN_VARIANT(_pin, _variant, ...)\t\t\t\\\n\t{\t\t\t\t\t\t\t\\\n\t\t.pin = _pin,\t\t\t\t\t\\\n\t\t.variant = _variant,\t\t\t\t\\\n\t\t.functions = (struct sunxi_desc_function[]){\t\\\n\t\t\t__VA_ARGS__, { } },\t\t\t\\\n\t}\n\n#define SUNXI_FUNCTION(_val, _name)\t\t\t\t\\\n\t{\t\t\t\t\t\t\t\\\n\t\t.name = _name,\t\t\t\t\t\\\n\t\t.muxval = _val,\t\t\t\t\t\\\n\t}\n\n#define SUNXI_FUNCTION_VARIANT(_val, _name, _variant)\t\t\\\n\t{\t\t\t\t\t\t\t\\\n\t\t.name = _name,\t\t\t\t\t\\\n\t\t.muxval = _val,\t\t\t\t\t\\\n\t\t.variant = _variant,\t\t\t\t\\\n\t}\n\n#define SUNXI_FUNCTION_IRQ(_val, _irq)\t\t\t\t\\\n\t{\t\t\t\t\t\t\t\\\n\t\t.name = \"irq\",\t\t\t\t\t\\\n\t\t.muxval = _val,\t\t\t\t\t\\\n\t\t.irqnum = _irq,\t\t\t\t\t\\\n\t}\n\n#define SUNXI_FUNCTION_IRQ_BANK(_val, _bank, _irq)\t\t\\\n\t{\t\t\t\t\t\t\t\\\n\t\t.name = \"irq\",\t\t\t\t\t\\\n\t\t.muxval = _val,\t\t\t\t\t\\\n\t\t.irqbank = _bank,\t\t\t\t\\\n\t\t.irqnum = _irq,\t\t\t\t\t\\\n\t}\n\nstatic inline u32 sunxi_irq_hw_bank_num(const struct sunxi_pinctrl_desc *desc, u8 bank)\n{\n\tif (!desc->irq_bank_map)\n\t\treturn bank;\n\telse\n\t\treturn desc->irq_bank_map[bank];\n}\n\nstatic inline u32 sunxi_irq_cfg_reg(const struct sunxi_pinctrl_desc *desc,\n\t\t\t\t    u16 irq)\n{\n\tu8 bank = irq / IRQ_PER_BANK;\n\tu8 reg = (irq % IRQ_PER_BANK) / IRQ_CFG_IRQ_PER_REG * 0x04;\n\n\treturn IRQ_CFG_REG +\n\t       sunxi_irq_hw_bank_num(desc, bank) * IRQ_MEM_SIZE + reg;\n}\n\nstatic inline u32 sunxi_irq_cfg_offset(u16 irq)\n{\n\tu32 irq_num = irq % IRQ_CFG_IRQ_PER_REG;\n\treturn irq_num * IRQ_CFG_IRQ_BITS;\n}\n\nstatic inline u32 sunxi_irq_ctrl_reg_from_bank(const struct sunxi_pinctrl_desc *desc, u8 bank)\n{\n\treturn IRQ_CTRL_REG + sunxi_irq_hw_bank_num(desc, bank) * IRQ_MEM_SIZE;\n}\n\nstatic inline u32 sunxi_irq_ctrl_reg(const struct sunxi_pinctrl_desc *desc,\n\t\t\t\t     u16 irq)\n{\n\tu8 bank = irq / IRQ_PER_BANK;\n\n\treturn sunxi_irq_ctrl_reg_from_bank(desc, bank);\n}\n\nstatic inline u32 sunxi_irq_ctrl_offset(u16 irq)\n{\n\tu32 irq_num = irq % IRQ_CTRL_IRQ_PER_REG;\n\treturn irq_num * IRQ_CTRL_IRQ_BITS;\n}\n\nstatic inline u32 sunxi_irq_debounce_reg_from_bank(const struct sunxi_pinctrl_desc *desc, u8 bank)\n{\n\treturn IRQ_DEBOUNCE_REG +\n\t       sunxi_irq_hw_bank_num(desc, bank) * IRQ_MEM_SIZE;\n}\n\nstatic inline u32 sunxi_irq_status_reg_from_bank(const struct sunxi_pinctrl_desc *desc, u8 bank)\n{\n\treturn IRQ_STATUS_REG +\n\t       sunxi_irq_hw_bank_num(desc, bank) * IRQ_MEM_SIZE;\n}\n\nstatic inline u32 sunxi_irq_status_reg(const struct sunxi_pinctrl_desc *desc,\n\t\t\t\t       u16 irq)\n{\n\tu8 bank = irq / IRQ_PER_BANK;\n\n\treturn sunxi_irq_status_reg_from_bank(desc, bank);\n}\n\nstatic inline u32 sunxi_irq_status_offset(u16 irq)\n{\n\tu32 irq_num = irq % IRQ_STATUS_IRQ_PER_REG;\n\treturn irq_num * IRQ_STATUS_IRQ_BITS;\n}\n\nstatic inline u32 sunxi_grp_config_reg(u16 pin)\n{\n\tu8 bank = pin / PINS_PER_BANK;\n\n\treturn GRP_CFG_REG + bank * 0x4;\n}\n\nint sunxi_pinctrl_init_with_variant(struct platform_device *pdev,\n\t\t\t\t    const struct sunxi_pinctrl_desc *desc,\n\t\t\t\t    unsigned long variant);\n\n#define sunxi_pinctrl_init(_dev, _desc) \\\n\tsunxi_pinctrl_init_with_variant(_dev, _desc, 0)\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}