{
  "module_name": "pinctrl-spear310.c",
  "hash_id": "22af2bafc5a6095f04671a8686299f42b06e930d25b054f48486c0b34aa4d2de",
  "original_prompt": "Ingested from linux-6.6.14/drivers/pinctrl/spear/pinctrl-spear310.c",
  "human_readable_source": " \n\n#include <linux/err.h>\n#include <linux/init.h>\n#include <linux/mod_devicetable.h>\n#include <linux/platform_device.h>\n#include \"pinctrl-spear3xx.h\"\n\n#define DRIVER_NAME \"spear310-pinmux\"\n\n \n#define PMX_CONFIG_REG\t\t\t0x08\n\n \nstatic const unsigned emi_cs_0_to_5_pins[] = { 45, 46, 47, 48, 49, 50 };\nstatic struct spear_muxreg emi_cs_0_to_5_muxreg[] = {\n\t{\n\t\t.reg = PMX_CONFIG_REG,\n\t\t.mask = PMX_TIMER_0_1_MASK | PMX_TIMER_2_3_MASK,\n\t\t.val = 0,\n\t},\n};\n\nstatic struct spear_modemux emi_cs_0_to_5_modemux[] = {\n\t{\n\t\t.muxregs = emi_cs_0_to_5_muxreg,\n\t\t.nmuxregs = ARRAY_SIZE(emi_cs_0_to_5_muxreg),\n\t},\n};\n\nstatic struct spear_pingroup emi_cs_0_to_5_pingroup = {\n\t.name = \"emi_cs_0_to_5_grp\",\n\t.pins = emi_cs_0_to_5_pins,\n\t.npins = ARRAY_SIZE(emi_cs_0_to_5_pins),\n\t.modemuxs = emi_cs_0_to_5_modemux,\n\t.nmodemuxs = ARRAY_SIZE(emi_cs_0_to_5_modemux),\n};\n\nstatic const char *const emi_cs_0_to_5_grps[] = { \"emi_cs_0_to_5_grp\" };\nstatic struct spear_function emi_cs_0_to_5_function = {\n\t.name = \"emi\",\n\t.groups = emi_cs_0_to_5_grps,\n\t.ngroups = ARRAY_SIZE(emi_cs_0_to_5_grps),\n};\n\n \nstatic const unsigned uart1_pins[] = { 0, 1 };\nstatic struct spear_muxreg uart1_muxreg[] = {\n\t{\n\t\t.reg = PMX_CONFIG_REG,\n\t\t.mask = PMX_FIRDA_MASK,\n\t\t.val = 0,\n\t},\n};\n\nstatic struct spear_modemux uart1_modemux[] = {\n\t{\n\t\t.muxregs = uart1_muxreg,\n\t\t.nmuxregs = ARRAY_SIZE(uart1_muxreg),\n\t},\n};\n\nstatic struct spear_pingroup uart1_pingroup = {\n\t.name = \"uart1_grp\",\n\t.pins = uart1_pins,\n\t.npins = ARRAY_SIZE(uart1_pins),\n\t.modemuxs = uart1_modemux,\n\t.nmodemuxs = ARRAY_SIZE(uart1_modemux),\n};\n\nstatic const char *const uart1_grps[] = { \"uart1_grp\" };\nstatic struct spear_function uart1_function = {\n\t.name = \"uart1\",\n\t.groups = uart1_grps,\n\t.ngroups = ARRAY_SIZE(uart1_grps),\n};\n\n \nstatic const unsigned uart2_pins[] = { 43, 44 };\nstatic struct spear_muxreg uart2_muxreg[] = {\n\t{\n\t\t.reg = PMX_CONFIG_REG,\n\t\t.mask = PMX_TIMER_0_1_MASK,\n\t\t.val = 0,\n\t},\n};\n\nstatic struct spear_modemux uart2_modemux[] = {\n\t{\n\t\t.muxregs = uart2_muxreg,\n\t\t.nmuxregs = ARRAY_SIZE(uart2_muxreg),\n\t},\n};\n\nstatic struct spear_pingroup uart2_pingroup = {\n\t.name = \"uart2_grp\",\n\t.pins = uart2_pins,\n\t.npins = ARRAY_SIZE(uart2_pins),\n\t.modemuxs = uart2_modemux,\n\t.nmodemuxs = ARRAY_SIZE(uart2_modemux),\n};\n\nstatic const char *const uart2_grps[] = { \"uart2_grp\" };\nstatic struct spear_function uart2_function = {\n\t.name = \"uart2\",\n\t.groups = uart2_grps,\n\t.ngroups = ARRAY_SIZE(uart2_grps),\n};\n\n \nstatic const unsigned uart3_pins[] = { 37, 38 };\nstatic struct spear_muxreg uart3_muxreg[] = {\n\t{\n\t\t.reg = PMX_CONFIG_REG,\n\t\t.mask = PMX_UART0_MODEM_MASK,\n\t\t.val = 0,\n\t},\n};\n\nstatic struct spear_modemux uart3_modemux[] = {\n\t{\n\t\t.muxregs = uart3_muxreg,\n\t\t.nmuxregs = ARRAY_SIZE(uart3_muxreg),\n\t},\n};\n\nstatic struct spear_pingroup uart3_pingroup = {\n\t.name = \"uart3_grp\",\n\t.pins = uart3_pins,\n\t.npins = ARRAY_SIZE(uart3_pins),\n\t.modemuxs = uart3_modemux,\n\t.nmodemuxs = ARRAY_SIZE(uart3_modemux),\n};\n\nstatic const char *const uart3_grps[] = { \"uart3_grp\" };\nstatic struct spear_function uart3_function = {\n\t.name = \"uart3\",\n\t.groups = uart3_grps,\n\t.ngroups = ARRAY_SIZE(uart3_grps),\n};\n\n \nstatic const unsigned uart4_pins[] = { 39, 40 };\nstatic struct spear_muxreg uart4_muxreg[] = {\n\t{\n\t\t.reg = PMX_CONFIG_REG,\n\t\t.mask = PMX_UART0_MODEM_MASK,\n\t\t.val = 0,\n\t},\n};\n\nstatic struct spear_modemux uart4_modemux[] = {\n\t{\n\t\t.muxregs = uart4_muxreg,\n\t\t.nmuxregs = ARRAY_SIZE(uart4_muxreg),\n\t},\n};\n\nstatic struct spear_pingroup uart4_pingroup = {\n\t.name = \"uart4_grp\",\n\t.pins = uart4_pins,\n\t.npins = ARRAY_SIZE(uart4_pins),\n\t.modemuxs = uart4_modemux,\n\t.nmodemuxs = ARRAY_SIZE(uart4_modemux),\n};\n\nstatic const char *const uart4_grps[] = { \"uart4_grp\" };\nstatic struct spear_function uart4_function = {\n\t.name = \"uart4\",\n\t.groups = uart4_grps,\n\t.ngroups = ARRAY_SIZE(uart4_grps),\n};\n\n \nstatic const unsigned uart5_pins[] = { 41, 42 };\nstatic struct spear_muxreg uart5_muxreg[] = {\n\t{\n\t\t.reg = PMX_CONFIG_REG,\n\t\t.mask = PMX_UART0_MODEM_MASK,\n\t\t.val = 0,\n\t},\n};\n\nstatic struct spear_modemux uart5_modemux[] = {\n\t{\n\t\t.muxregs = uart5_muxreg,\n\t\t.nmuxregs = ARRAY_SIZE(uart5_muxreg),\n\t},\n};\n\nstatic struct spear_pingroup uart5_pingroup = {\n\t.name = \"uart5_grp\",\n\t.pins = uart5_pins,\n\t.npins = ARRAY_SIZE(uart5_pins),\n\t.modemuxs = uart5_modemux,\n\t.nmodemuxs = ARRAY_SIZE(uart5_modemux),\n};\n\nstatic const char *const uart5_grps[] = { \"uart5_grp\" };\nstatic struct spear_function uart5_function = {\n\t.name = \"uart5\",\n\t.groups = uart5_grps,\n\t.ngroups = ARRAY_SIZE(uart5_grps),\n};\n\n \nstatic const unsigned fsmc_pins[] = { 34, 35, 36 };\nstatic struct spear_muxreg fsmc_muxreg[] = {\n\t{\n\t\t.reg = PMX_CONFIG_REG,\n\t\t.mask = PMX_SSP_CS_MASK,\n\t\t.val = 0,\n\t},\n};\n\nstatic struct spear_modemux fsmc_modemux[] = {\n\t{\n\t\t.muxregs = fsmc_muxreg,\n\t\t.nmuxregs = ARRAY_SIZE(fsmc_muxreg),\n\t},\n};\n\nstatic struct spear_pingroup fsmc_pingroup = {\n\t.name = \"fsmc_grp\",\n\t.pins = fsmc_pins,\n\t.npins = ARRAY_SIZE(fsmc_pins),\n\t.modemuxs = fsmc_modemux,\n\t.nmodemuxs = ARRAY_SIZE(fsmc_modemux),\n};\n\nstatic const char *const fsmc_grps[] = { \"fsmc_grp\" };\nstatic struct spear_function fsmc_function = {\n\t.name = \"fsmc\",\n\t.groups = fsmc_grps,\n\t.ngroups = ARRAY_SIZE(fsmc_grps),\n};\n\n \nstatic const unsigned rs485_0_pins[] = { 19, 20, 21, 22, 23 };\nstatic struct spear_muxreg rs485_0_muxreg[] = {\n\t{\n\t\t.reg = PMX_CONFIG_REG,\n\t\t.mask = PMX_MII_MASK,\n\t\t.val = 0,\n\t},\n};\n\nstatic struct spear_modemux rs485_0_modemux[] = {\n\t{\n\t\t.muxregs = rs485_0_muxreg,\n\t\t.nmuxregs = ARRAY_SIZE(rs485_0_muxreg),\n\t},\n};\n\nstatic struct spear_pingroup rs485_0_pingroup = {\n\t.name = \"rs485_0_grp\",\n\t.pins = rs485_0_pins,\n\t.npins = ARRAY_SIZE(rs485_0_pins),\n\t.modemuxs = rs485_0_modemux,\n\t.nmodemuxs = ARRAY_SIZE(rs485_0_modemux),\n};\n\nstatic const char *const rs485_0_grps[] = { \"rs485_0\" };\nstatic struct spear_function rs485_0_function = {\n\t.name = \"rs485_0\",\n\t.groups = rs485_0_grps,\n\t.ngroups = ARRAY_SIZE(rs485_0_grps),\n};\n\n \nstatic const unsigned rs485_1_pins[] = { 14, 15, 16, 17, 18 };\nstatic struct spear_muxreg rs485_1_muxreg[] = {\n\t{\n\t\t.reg = PMX_CONFIG_REG,\n\t\t.mask = PMX_MII_MASK,\n\t\t.val = 0,\n\t},\n};\n\nstatic struct spear_modemux rs485_1_modemux[] = {\n\t{\n\t\t.muxregs = rs485_1_muxreg,\n\t\t.nmuxregs = ARRAY_SIZE(rs485_1_muxreg),\n\t},\n};\n\nstatic struct spear_pingroup rs485_1_pingroup = {\n\t.name = \"rs485_1_grp\",\n\t.pins = rs485_1_pins,\n\t.npins = ARRAY_SIZE(rs485_1_pins),\n\t.modemuxs = rs485_1_modemux,\n\t.nmodemuxs = ARRAY_SIZE(rs485_1_modemux),\n};\n\nstatic const char *const rs485_1_grps[] = { \"rs485_1\" };\nstatic struct spear_function rs485_1_function = {\n\t.name = \"rs485_1\",\n\t.groups = rs485_1_grps,\n\t.ngroups = ARRAY_SIZE(rs485_1_grps),\n};\n\n \nstatic const unsigned tdm_pins[] = { 10, 11, 12, 13 };\nstatic struct spear_muxreg tdm_muxreg[] = {\n\t{\n\t\t.reg = PMX_CONFIG_REG,\n\t\t.mask = PMX_MII_MASK,\n\t\t.val = 0,\n\t},\n};\n\nstatic struct spear_modemux tdm_modemux[] = {\n\t{\n\t\t.muxregs = tdm_muxreg,\n\t\t.nmuxregs = ARRAY_SIZE(tdm_muxreg),\n\t},\n};\n\nstatic struct spear_pingroup tdm_pingroup = {\n\t.name = \"tdm_grp\",\n\t.pins = tdm_pins,\n\t.npins = ARRAY_SIZE(tdm_pins),\n\t.modemuxs = tdm_modemux,\n\t.nmodemuxs = ARRAY_SIZE(tdm_modemux),\n};\n\nstatic const char *const tdm_grps[] = { \"tdm_grp\" };\nstatic struct spear_function tdm_function = {\n\t.name = \"tdm\",\n\t.groups = tdm_grps,\n\t.ngroups = ARRAY_SIZE(tdm_grps),\n};\n\n \nstatic struct spear_pingroup *spear310_pingroups[] = {\n\tSPEAR3XX_COMMON_PINGROUPS,\n\t&emi_cs_0_to_5_pingroup,\n\t&uart1_pingroup,\n\t&uart2_pingroup,\n\t&uart3_pingroup,\n\t&uart4_pingroup,\n\t&uart5_pingroup,\n\t&fsmc_pingroup,\n\t&rs485_0_pingroup,\n\t&rs485_1_pingroup,\n\t&tdm_pingroup,\n};\n\n \nstatic struct spear_function *spear310_functions[] = {\n\tSPEAR3XX_COMMON_FUNCTIONS,\n\t&emi_cs_0_to_5_function,\n\t&uart1_function,\n\t&uart2_function,\n\t&uart3_function,\n\t&uart4_function,\n\t&uart5_function,\n\t&fsmc_function,\n\t&rs485_0_function,\n\t&rs485_1_function,\n\t&tdm_function,\n};\n\nstatic const struct of_device_id spear310_pinctrl_of_match[] = {\n\t{\n\t\t.compatible = \"st,spear310-pinmux\",\n\t},\n\t{},\n};\n\nstatic int spear310_pinctrl_probe(struct platform_device *pdev)\n{\n\tspear3xx_machdata.groups = spear310_pingroups;\n\tspear3xx_machdata.ngroups = ARRAY_SIZE(spear310_pingroups);\n\tspear3xx_machdata.functions = spear310_functions;\n\tspear3xx_machdata.nfunctions = ARRAY_SIZE(spear310_functions);\n\n\tpmx_init_addr(&spear3xx_machdata, PMX_CONFIG_REG);\n\tpmx_init_gpio_pingroup_addr(spear3xx_machdata.gpio_pingroups,\n\t\t\tspear3xx_machdata.ngpio_pingroups, PMX_CONFIG_REG);\n\n\tspear3xx_machdata.modes_supported = false;\n\n\treturn spear_pinctrl_probe(pdev, &spear3xx_machdata);\n}\n\nstatic struct platform_driver spear310_pinctrl_driver = {\n\t.driver = {\n\t\t.name = DRIVER_NAME,\n\t\t.of_match_table = spear310_pinctrl_of_match,\n\t},\n\t.probe = spear310_pinctrl_probe,\n};\n\nstatic int __init spear310_pinctrl_init(void)\n{\n\treturn platform_driver_register(&spear310_pinctrl_driver);\n}\narch_initcall(spear310_pinctrl_init);\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}