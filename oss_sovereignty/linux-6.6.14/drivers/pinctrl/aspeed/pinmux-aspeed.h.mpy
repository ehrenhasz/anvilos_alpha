{
  "module_name": "pinmux-aspeed.h",
  "hash_id": "3ec364b63eb28352d2bd39bc2b6a0603e1e929d17523c9c97deda7aad3828189",
  "original_prompt": "Ingested from linux-6.6.14/drivers/pinctrl/aspeed/pinmux-aspeed.h",
  "human_readable_source": " \n \n\n#ifndef ASPEED_PINMUX_H\n#define ASPEED_PINMUX_H\n\n#include <linux/regmap.h>\n\n \n\n#define ASPEED_IP_SCU\t\t0\n#define ASPEED_IP_GFX\t\t1\n#define ASPEED_IP_LPC\t\t2\n#define ASPEED_NR_PINMUX_IPS\t3\n\n  \nstruct aspeed_sig_desc {\n\tunsigned int ip;\n\tunsigned int reg;\n\tu32 mask;\n\tu32 enable;\n\tu32 disable;\n};\n\n \nstruct aspeed_sig_expr {\n\tconst char *signal;\n\tconst char *function;\n\tint ndescs;\n\tconst struct aspeed_sig_desc *descs;\n};\n\n \nstruct aspeed_pin_desc {\n\tconst char *name;\n\tconst struct aspeed_sig_expr ***prios;\n};\n\n \n\n#define SIG_DESC_IP_BIT(ip, reg, idx, val) \\\n\t{ ip, reg, BIT_MASK(idx), val, (((val) + 1) & 1) }\n\n \n#define SIG_DESC_BIT(reg, idx, val) \\\n\tSIG_DESC_IP_BIT(ASPEED_IP_SCU, reg, idx, val)\n\n#define SIG_DESC_IP_SET(ip, reg, idx) SIG_DESC_IP_BIT(ip, reg, idx, 1)\n\n \n#define SIG_DESC_SET(reg, idx) SIG_DESC_IP_BIT(ASPEED_IP_SCU, reg, idx, 1)\n#define SIG_DESC_CLEAR(reg, idx) { ASPEED_IP_SCU, reg, BIT_MASK(idx), 0, 0 }\n\n#define SIG_DESC_LIST_SYM(sig, group) sig_descs_ ## sig ## _ ## group\n#define SIG_DESC_LIST_DECL(sig, group, ...) \\\n\tstatic const struct aspeed_sig_desc SIG_DESC_LIST_SYM(sig, group)[] = \\\n\t\t{ __VA_ARGS__ }\n\n#define SIG_EXPR_SYM(sig, group) sig_expr_ ## sig ## _ ## group\n#define SIG_EXPR_DECL_(sig, group, func) \\\n\tstatic const struct aspeed_sig_expr SIG_EXPR_SYM(sig, group) = \\\n\t{ \\\n\t\t.signal = #sig, \\\n\t\t.function = #func, \\\n\t\t.ndescs = ARRAY_SIZE(SIG_DESC_LIST_SYM(sig, group)), \\\n\t\t.descs = &(SIG_DESC_LIST_SYM(sig, group))[0], \\\n\t}\n\n \n#define SIG_EXPR_DECL(sig, group, func, ...) \\\n\tSIG_DESC_LIST_DECL(sig, group, __VA_ARGS__); \\\n\tSIG_EXPR_DECL_(sig, group, func)\n\n \n#define SIG_EXPR_PTR(sig, group) (&SIG_EXPR_SYM(sig, group))\n\n#define SIG_EXPR_LIST_SYM(sig, group) sig_exprs_ ## sig ## _ ## group\n\n \n#define SIG_EXPR_LIST_DECL(sig, group, ...) \\\n\tstatic const struct aspeed_sig_expr *SIG_EXPR_LIST_SYM(sig, group)[] =\\\n\t\t{ __VA_ARGS__, NULL }\n\n#define stringify(x) #x\n#define istringify(x) stringify(x)\n\n \n#define SIG_EXPR_LIST_ALIAS(pin, sig, group) \\\n\tstatic const struct aspeed_sig_expr *\\\n\t\tSIG_EXPR_LIST_SYM(pin, sig)[ARRAY_SIZE(SIG_EXPR_LIST_SYM(sig, group))] \\\n\t\t__attribute__((alias(istringify(SIG_EXPR_LIST_SYM(sig, group)))))\n\n \n#define SIG_EXPR_LIST_DECL_SESG(pin, sig, func, ...) \\\n\tSIG_DESC_LIST_DECL(sig, func, __VA_ARGS__); \\\n\tSIG_EXPR_DECL_(sig, func, func); \\\n\tSIG_EXPR_LIST_DECL(sig, func, SIG_EXPR_PTR(sig, func)); \\\n\tSIG_EXPR_LIST_ALIAS(pin, sig, func)\n\n \n#define SIG_EXPR_LIST_DECL_SEMG(pin, sig, group, func, ...) \\\n\tSIG_DESC_LIST_DECL(sig, group, __VA_ARGS__); \\\n\tSIG_EXPR_DECL_(sig, group, func); \\\n\tSIG_EXPR_LIST_DECL(sig, group, SIG_EXPR_PTR(sig, group)); \\\n\tSIG_EXPR_LIST_ALIAS(pin, sig, group)\n\n \n#define SIG_EXPR_LIST_DECL_DESG(pin, sig, f0, f1) \\\n\tSIG_EXPR_LIST_DECL(sig, f0, \\\n\t\t\t   SIG_EXPR_PTR(sig, f0), \\\n\t\t\t   SIG_EXPR_PTR(sig, f1)); \\\n\tSIG_EXPR_LIST_ALIAS(pin, sig, f0)\n\n#define SIG_EXPR_LIST_PTR(sig, group) SIG_EXPR_LIST_SYM(sig, group)\n\n#define PIN_EXPRS_SYM(pin) pin_exprs_ ## pin\n#define PIN_EXPRS_PTR(pin) (&PIN_EXPRS_SYM(pin)[0])\n#define PIN_SYM(pin) pin_ ## pin\n\n#define PIN_DECL_(pin, ...) \\\n\tstatic const struct aspeed_sig_expr **PIN_EXPRS_SYM(pin)[] = \\\n\t\t{ __VA_ARGS__, NULL }; \\\n\tstatic const struct aspeed_pin_desc PIN_SYM(pin) = \\\n\t\t{ #pin, PIN_EXPRS_PTR(pin) }\n\n \n#define PIN_DECL_1(pin, other, sig) \\\n\tSIG_EXPR_LIST_DECL_SESG(pin, other, other); \\\n\tPIN_DECL_(pin, SIG_EXPR_LIST_PTR(pin, sig), \\\n\t\t  SIG_EXPR_LIST_PTR(pin, other))\n\n \n#define SSSF_PIN_DECL(pin, other, sig, ...) \\\n\tSIG_EXPR_LIST_DECL_SESG(pin, sig, sig, __VA_ARGS__); \\\n\tSIG_EXPR_LIST_DECL_SESG(pin, other, other); \\\n\tPIN_DECL_(pin, SIG_EXPR_LIST_PTR(pin, sig), \\\n\t\t  SIG_EXPR_LIST_PTR(pin, other)); \\\n\tFUNC_GROUP_DECL(sig, pin)\n \n#define PIN_DECL_2(pin, other, high, low) \\\n\tSIG_EXPR_LIST_DECL_SESG(pin, other, other); \\\n\tPIN_DECL_(pin, \\\n\t\t\tSIG_EXPR_LIST_PTR(pin, high), \\\n\t\t\tSIG_EXPR_LIST_PTR(pin, low), \\\n\t\t\tSIG_EXPR_LIST_PTR(pin, other))\n\n#define PIN_DECL_3(pin, other, high, medium, low) \\\n\tSIG_EXPR_LIST_DECL_SESG(pin, other, other); \\\n\tPIN_DECL_(pin, \\\n\t\t\tSIG_EXPR_LIST_PTR(pin, high), \\\n\t\t\tSIG_EXPR_LIST_PTR(pin, medium), \\\n\t\t\tSIG_EXPR_LIST_PTR(pin, low), \\\n\t\t\tSIG_EXPR_LIST_PTR(pin, other))\n\n#define PIN_DECL_4(pin, other, prio1, prio2, prio3, prio4) \\\n\tSIG_EXPR_LIST_DECL_SESG(pin, other, other); \\\n\tPIN_DECL_(pin, \\\n\t\t\tSIG_EXPR_LIST_PTR(pin, prio1), \\\n\t\t\tSIG_EXPR_LIST_PTR(pin, prio2), \\\n\t\t\tSIG_EXPR_LIST_PTR(pin, prio3), \\\n\t\t\tSIG_EXPR_LIST_PTR(pin, prio4), \\\n\t\t\tSIG_EXPR_LIST_PTR(pin, other))\n\n#define GROUP_SYM(group) group_pins_ ## group\n#define GROUP_DECL(group, ...) \\\n\tstatic const int GROUP_SYM(group)[] = { __VA_ARGS__ }\n\n#define FUNC_SYM(func) func_groups_ ## func\n#define FUNC_DECL_(func, ...) \\\n\tstatic const char *FUNC_SYM(func)[] = { __VA_ARGS__ }\n\n#define FUNC_DECL_1(func, group) FUNC_DECL_(func, #group)\n#define FUNC_DECL_2(func, one, two) FUNC_DECL_(func, #one, #two)\n#define FUNC_DECL_3(func, one, two, three) FUNC_DECL_(func, #one, #two, #three)\n\n#define FUNC_GROUP_DECL(func, ...) \\\n\tGROUP_DECL(func, __VA_ARGS__); \\\n\tFUNC_DECL_(func, #func)\n\n\n#define GPIO_PIN_DECL(pin, gpio) \\\n\tSIG_EXPR_LIST_DECL_SESG(pin, gpio, gpio); \\\n\tPIN_DECL_(pin, SIG_EXPR_LIST_PTR(pin, gpio))\n\nstruct aspeed_pin_group {\n\tconst char *name;\n\tconst unsigned int *pins;\n\tconst unsigned int npins;\n};\n\n#define ASPEED_PINCTRL_GROUP(name_) { \\\n\t.name = #name_, \\\n\t.pins = &(GROUP_SYM(name_))[0], \\\n\t.npins = ARRAY_SIZE(GROUP_SYM(name_)), \\\n}\n\nstruct aspeed_pin_function {\n\tconst char *name;\n\tconst char *const *groups;\n\tunsigned int ngroups;\n};\n\n#define ASPEED_PINCTRL_FUNC(name_, ...) { \\\n\t.name = #name_, \\\n\t.groups = &FUNC_SYM(name_)[0], \\\n\t.ngroups = ARRAY_SIZE(FUNC_SYM(name_)), \\\n}\n\nstruct aspeed_pinmux_data;\n\nstruct aspeed_pinmux_ops {\n\tint (*eval)(struct aspeed_pinmux_data *ctx,\n\t\t    const struct aspeed_sig_expr *expr, bool enabled);\n\tint (*set)(struct aspeed_pinmux_data *ctx,\n\t\t   const struct aspeed_sig_expr *expr, bool enabled);\n};\n\nstruct aspeed_pinmux_data {\n\tstruct device *dev;\n\tstruct regmap *maps[ASPEED_NR_PINMUX_IPS];\n\n\tconst struct aspeed_pinmux_ops *ops;\n\n\tconst struct aspeed_pin_group *groups;\n\tconst unsigned int ngroups;\n\n\tconst struct aspeed_pin_function *functions;\n\tconst unsigned int nfunctions;\n};\n\nint aspeed_sig_desc_eval(const struct aspeed_sig_desc *desc, bool enabled,\n\t\t\t struct regmap *map);\n\nint aspeed_sig_expr_eval(struct aspeed_pinmux_data *ctx,\n\t\t\t const struct aspeed_sig_expr *expr, bool enabled);\n\nstatic inline int aspeed_sig_expr_set(struct aspeed_pinmux_data *ctx,\n\t\t\t\t      const struct aspeed_sig_expr *expr,\n\t\t\t\t      bool enabled)\n{\n\treturn ctx->ops->set(ctx, expr, enabled);\n}\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}