{
  "module_name": "rpmsg_client_sample.c",
  "hash_id": "7a5e4c1bb16fdd78bd4be26255390f2be62d01fc1b81906f284cfbf113552db6",
  "original_prompt": "Ingested from linux-6.6.14/samples/rpmsg/rpmsg_client_sample.c",
  "human_readable_source": "\n \n\n#include <linux/kernel.h>\n#include <linux/module.h>\n#include <linux/rpmsg.h>\n\n#define MSG\t\t\"hello world!\"\n\nstatic int count = 100;\nmodule_param(count, int, 0644);\n\nstruct instance_data {\n\tint rx_count;\n};\n\nstatic int rpmsg_sample_cb(struct rpmsg_device *rpdev, void *data, int len,\n\t\t\t\t\t\tvoid *priv, u32 src)\n{\n\tint ret;\n\tstruct instance_data *idata = dev_get_drvdata(&rpdev->dev);\n\n\tdev_info(&rpdev->dev, \"incoming msg %d (src: 0x%x)\\n\",\n\t\t ++idata->rx_count, src);\n\n\tprint_hex_dump_debug(__func__, DUMP_PREFIX_NONE, 16, 1, data, len,\n\t\t\t     true);\n\n\t \n\tif (idata->rx_count >= count) {\n\t\tdev_info(&rpdev->dev, \"goodbye!\\n\");\n\t\treturn 0;\n\t}\n\n\t \n\tret = rpmsg_send(rpdev->ept, MSG, strlen(MSG));\n\tif (ret)\n\t\tdev_err(&rpdev->dev, \"rpmsg_send failed: %d\\n\", ret);\n\n\treturn 0;\n}\n\nstatic int rpmsg_sample_probe(struct rpmsg_device *rpdev)\n{\n\tint ret;\n\tstruct instance_data *idata;\n\n\tdev_info(&rpdev->dev, \"new channel: 0x%x -> 0x%x!\\n\",\n\t\t\t\t\trpdev->src, rpdev->dst);\n\n\tidata = devm_kzalloc(&rpdev->dev, sizeof(*idata), GFP_KERNEL);\n\tif (!idata)\n\t\treturn -ENOMEM;\n\n\tdev_set_drvdata(&rpdev->dev, idata);\n\n\t \n\tret = rpmsg_send(rpdev->ept, MSG, strlen(MSG));\n\tif (ret) {\n\t\tdev_err(&rpdev->dev, \"rpmsg_send failed: %d\\n\", ret);\n\t\treturn ret;\n\t}\n\n\treturn 0;\n}\n\nstatic void rpmsg_sample_remove(struct rpmsg_device *rpdev)\n{\n\tdev_info(&rpdev->dev, \"rpmsg sample client driver is removed\\n\");\n}\n\nstatic struct rpmsg_device_id rpmsg_driver_sample_id_table[] = {\n\t{ .name\t= \"rpmsg-client-sample\" },\n\t{ },\n};\nMODULE_DEVICE_TABLE(rpmsg, rpmsg_driver_sample_id_table);\n\nstatic struct rpmsg_driver rpmsg_sample_client = {\n\t.drv.name\t= KBUILD_MODNAME,\n\t.id_table\t= rpmsg_driver_sample_id_table,\n\t.probe\t\t= rpmsg_sample_probe,\n\t.callback\t= rpmsg_sample_cb,\n\t.remove\t\t= rpmsg_sample_remove,\n};\nmodule_rpmsg_driver(rpmsg_sample_client);\n\nMODULE_DESCRIPTION(\"Remote processor messaging sample client driver\");\nMODULE_LICENSE(\"GPL v2\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}