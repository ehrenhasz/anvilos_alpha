{
  "module_name": "tracex5_user.c",
  "hash_id": "f5e032a7bec02f332e4facc9a9d3175fd8db5af4fd6e6d9f5cc6b87c429e08dc",
  "original_prompt": "Ingested from linux-6.6.14/samples/bpf/tracex5_user.c",
  "human_readable_source": "\n#include <stdio.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <linux/filter.h>\n#include <linux/seccomp.h>\n#include <sys/prctl.h>\n#include <bpf/bpf.h>\n#include <bpf/libbpf.h>\n#include \"trace_helpers.h\"\n#include \"bpf_util.h\"\n\n#ifdef __mips__\n#define\tMAX_ENTRIES  6000  \n#else\n#define\tMAX_ENTRIES  1024\n#endif\n\n \nstatic void install_accept_all_seccomp(void)\n{\n\tstruct sock_filter filter[] = {\n\t\tBPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_ALLOW),\n\t};\n\tstruct sock_fprog prog = {\n\t\t.len = (unsigned short)ARRAY_SIZE(filter),\n\t\t.filter = filter,\n\t};\n\tif (prctl(PR_SET_SECCOMP, 2, &prog))\n\t\tperror(\"prctl\");\n}\n\nint main(int ac, char **argv)\n{\n\tstruct bpf_link *link = NULL;\n\tstruct bpf_program *prog;\n\tstruct bpf_object *obj;\n\tint key, fd, progs_fd;\n\tconst char *section;\n\tchar filename[256];\n\tFILE *f;\n\n\tsnprintf(filename, sizeof(filename), \"%s.bpf.o\", argv[0]);\n\tobj = bpf_object__open_file(filename, NULL);\n\tif (libbpf_get_error(obj)) {\n\t\tfprintf(stderr, \"ERROR: opening BPF object file failed\\n\");\n\t\treturn 0;\n\t}\n\n\tprog = bpf_object__find_program_by_name(obj, \"bpf_prog1\");\n\tif (!prog) {\n\t\tprintf(\"finding a prog in obj file failed\\n\");\n\t\tgoto cleanup;\n\t}\n\n\t \n\tif (bpf_object__load(obj)) {\n\t\tfprintf(stderr, \"ERROR: loading BPF object file failed\\n\");\n\t\tgoto cleanup;\n\t}\n\n\tlink = bpf_program__attach(prog);\n\tif (libbpf_get_error(link)) {\n\t\tfprintf(stderr, \"ERROR: bpf_program__attach failed\\n\");\n\t\tlink = NULL;\n\t\tgoto cleanup;\n\t}\n\n\tprogs_fd = bpf_object__find_map_fd_by_name(obj, \"progs\");\n\tif (progs_fd < 0) {\n\t\tfprintf(stderr, \"ERROR: finding a map in obj file failed\\n\");\n\t\tgoto cleanup;\n\t}\n\n\tbpf_object__for_each_program(prog, obj) {\n\t\tsection = bpf_program__section_name(prog);\n\t\t \n\t\tif (sscanf(section, \"kprobe/%d\", &key) != 1)\n\t\t\tcontinue;\n\n\t\tfd = bpf_program__fd(prog);\n\t\tbpf_map_update_elem(progs_fd, &key, &fd, BPF_ANY);\n\t}\n\n\tinstall_accept_all_seccomp();\n\n\tf = popen(\"dd if=/dev/zero of=/dev/null count=5\", \"r\");\n\t(void) f;\n\n\tread_trace_pipe();\n\ncleanup:\n\tbpf_link__destroy(link);\n\tbpf_object__close(obj);\n\treturn 0;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}