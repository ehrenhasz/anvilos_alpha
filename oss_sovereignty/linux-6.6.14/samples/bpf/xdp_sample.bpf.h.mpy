{
  "module_name": "xdp_sample.bpf.h",
  "hash_id": "fff674a456eefd6704a85086a0bf2a869d329fcef0d3f443adb36f5e3d8ef490",
  "original_prompt": "Ingested from linux-6.6.14/samples/bpf/xdp_sample.bpf.h",
  "human_readable_source": "\n#ifndef _XDP_SAMPLE_BPF_H\n#define _XDP_SAMPLE_BPF_H\n\n#include \"vmlinux.h\"\n#include <bpf/bpf_tracing.h>\n#include <bpf/bpf_core_read.h>\n#include <bpf/bpf_helpers.h>\n\n#include \"net_shared.h\"\n#include \"xdp_sample_shared.h\"\n\n#define EINVAL 22\n#define ENETDOWN 100\n#define EMSGSIZE 90\n#define EOPNOTSUPP 95\n#define ENOSPC 28\n\ntypedef struct {\n\t__uint(type, BPF_MAP_TYPE_ARRAY);\n\t__uint(map_flags, BPF_F_MMAPABLE);\n\t__type(key, unsigned int);\n\t__type(value, struct datarec);\n} array_map;\n\nextern array_map rx_cnt;\nextern const volatile int nr_cpus;\n\nenum {\n\tXDP_REDIRECT_SUCCESS = 0,\n\tXDP_REDIRECT_ERROR = 1\n};\n\nstatic __always_inline void swap_src_dst_mac(void *data)\n{\n\tunsigned short *p = data;\n\tunsigned short dst[3];\n\n\tdst[0] = p[0];\n\tdst[1] = p[1];\n\tdst[2] = p[2];\n\tp[0] = p[3];\n\tp[1] = p[4];\n\tp[2] = p[5];\n\tp[3] = dst[0];\n\tp[4] = dst[1];\n\tp[5] = dst[2];\n}\n\n \ntypedef __u8  __attribute__((__may_alias__))  __u8_alias_t;\ntypedef __u16 __attribute__((__may_alias__)) __u16_alias_t;\ntypedef __u32 __attribute__((__may_alias__)) __u32_alias_t;\ntypedef __u64 __attribute__((__may_alias__)) __u64_alias_t;\n\nstatic __always_inline void __read_once_size(const volatile void *p, void *res, int size)\n{\n\tswitch (size) {\n\tcase 1: *(__u8_alias_t  *) res = *(volatile __u8_alias_t  *) p; break;\n\tcase 2: *(__u16_alias_t *) res = *(volatile __u16_alias_t *) p; break;\n\tcase 4: *(__u32_alias_t *) res = *(volatile __u32_alias_t *) p; break;\n\tcase 8: *(__u64_alias_t *) res = *(volatile __u64_alias_t *) p; break;\n\tdefault:\n\t\tasm volatile (\"\" : : : \"memory\");\n\t\t__builtin_memcpy((void *)res, (const void *)p, size);\n\t\tasm volatile (\"\" : : : \"memory\");\n\t}\n}\n\nstatic __always_inline void __write_once_size(volatile void *p, void *res, int size)\n{\n\tswitch (size) {\n\tcase 1: *(volatile  __u8_alias_t *) p = *(__u8_alias_t  *) res; break;\n\tcase 2: *(volatile __u16_alias_t *) p = *(__u16_alias_t *) res; break;\n\tcase 4: *(volatile __u32_alias_t *) p = *(__u32_alias_t *) res; break;\n\tcase 8: *(volatile __u64_alias_t *) p = *(__u64_alias_t *) res; break;\n\tdefault:\n\t\tasm volatile (\"\" : : : \"memory\");\n\t\t__builtin_memcpy((void *)p, (const void *)res, size);\n\t\tasm volatile (\"\" : : : \"memory\");\n\t}\n}\n\n#define READ_ONCE(x)\t\t\t\t\t\\\n({\t\t\t\t\t\t\t\\\n\tunion { typeof(x) __val; char __c[1]; } __u =\t\\\n\t\t{ .__c = { 0 } };\t\t\t\\\n\t__read_once_size(&(x), __u.__c, sizeof(x));\t\\\n\t__u.__val;\t\t\t\t\t\\\n})\n\n#define WRITE_ONCE(x, val)\t\t\t\t\\\n({\t\t\t\t\t\t\t\\\n\tunion { typeof(x) __val; char __c[1]; } __u =\t\\\n\t\t{ .__val = (val) }; \t\t\t\\\n\t__write_once_size(&(x), __u.__c, sizeof(x));\t\\\n\t__u.__val;\t\t\t\t\t\\\n})\n\n \n#define NO_TEAR_ADD(x, val) WRITE_ONCE((x), READ_ONCE(x) + (val))\n#define NO_TEAR_INC(x) NO_TEAR_ADD((x), 1)\n\n#define ARRAY_SIZE(x) (sizeof(x) / sizeof((x)[0]))\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}