{
  "module_name": "syscall_tp_kern.c",
  "hash_id": "977048ffb4c01c7d783fcfa73244f493f73963be333960cc1d99fbdbf2f72533",
  "original_prompt": "Ingested from linux-6.6.14/samples/bpf/syscall_tp_kern.c",
  "human_readable_source": "\n \n#include <uapi/linux/bpf.h>\n#include <bpf/bpf_helpers.h>\n\nstruct syscalls_enter_open_args {\n\tunsigned long long unused;\n\tlong syscall_nr;\n\tlong filename_ptr;\n\tlong flags;\n\tlong mode;\n};\n\nstruct syscalls_exit_open_args {\n\tunsigned long long unused;\n\tlong syscall_nr;\n\tlong ret;\n};\n\nstruct {\n\t__uint(type, BPF_MAP_TYPE_ARRAY);\n\t__type(key, u32);\n\t__type(value, u32);\n\t__uint(max_entries, 1);\n} enter_open_map SEC(\".maps\");\n\nstruct {\n\t__uint(type, BPF_MAP_TYPE_ARRAY);\n\t__type(key, u32);\n\t__type(value, u32);\n\t__uint(max_entries, 1);\n} exit_open_map SEC(\".maps\");\n\nstatic __always_inline void count(void *map)\n{\n\tu32 key = 0;\n\tu32 *value, init_val = 1;\n\n\tvalue = bpf_map_lookup_elem(map, &key);\n\tif (value)\n\t\t*value += 1;\n\telse\n\t\tbpf_map_update_elem(map, &key, &init_val, BPF_NOEXIST);\n}\n\n#if !defined(__aarch64__)\nSEC(\"tracepoint/syscalls/sys_enter_open\")\nint trace_enter_open(struct syscalls_enter_open_args *ctx)\n{\n\tcount(&enter_open_map);\n\treturn 0;\n}\n#endif\n\nSEC(\"tracepoint/syscalls/sys_enter_openat\")\nint trace_enter_open_at(struct syscalls_enter_open_args *ctx)\n{\n\tcount(&enter_open_map);\n\treturn 0;\n}\n\nSEC(\"tracepoint/syscalls/sys_enter_openat2\")\nint trace_enter_open_at2(struct syscalls_enter_open_args *ctx)\n{\n\tcount(&enter_open_map);\n\treturn 0;\n}\n\n#if !defined(__aarch64__)\nSEC(\"tracepoint/syscalls/sys_exit_open\")\nint trace_enter_exit(struct syscalls_exit_open_args *ctx)\n{\n\tcount(&exit_open_map);\n\treturn 0;\n}\n#endif\n\nSEC(\"tracepoint/syscalls/sys_exit_openat\")\nint trace_enter_exit_at(struct syscalls_exit_open_args *ctx)\n{\n\tcount(&exit_open_map);\n\treturn 0;\n}\n\nSEC(\"tracepoint/syscalls/sys_exit_openat2\")\nint trace_enter_exit_at2(struct syscalls_exit_open_args *ctx)\n{\n\tcount(&exit_open_map);\n\treturn 0;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}