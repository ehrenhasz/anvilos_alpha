{
  "module_name": "xdp2skb_meta_kern.c",
  "hash_id": "8023c8f39219bdc579389dad7e9297f500c51e03aba2c73f60641db53a82c376",
  "original_prompt": "Ingested from linux-6.6.14/samples/bpf/xdp2skb_meta_kern.c",
  "human_readable_source": " \n#include <uapi/linux/bpf.h>\n#include <uapi/linux/pkt_cls.h>\n\n#include <bpf/bpf_helpers.h>\n\n \nstruct meta_info {\n\t__u32 mark;\n} __attribute__((aligned(4)));\n\nSEC(\"xdp_mark\")\nint _xdp_mark(struct xdp_md *ctx)\n{\n\tstruct meta_info *meta;\n\tvoid *data, *data_end;\n\tint ret;\n\n\t \n\tret = bpf_xdp_adjust_meta(ctx, -(int)sizeof(*meta));\n\tif (ret < 0)\n\t\treturn XDP_ABORTED;\n\n\t \n\tdata = (void *)(unsigned long)ctx->data;\n\n\t \n\tmeta = (void *)(unsigned long)ctx->data_meta;\n\tif (meta + 1 > data)\n\t\treturn XDP_ABORTED;\n\n\tmeta->mark = 42;\n\n\treturn XDP_PASS;\n}\n\nSEC(\"tc_mark\")\nint _tc_mark(struct __sk_buff *ctx)\n{\n\tvoid *data      = (void *)(unsigned long)ctx->data;\n\tvoid *data_end  = (void *)(unsigned long)ctx->data_end;\n\tvoid *data_meta = (void *)(unsigned long)ctx->data_meta;\n\tstruct meta_info *meta = data_meta;\n\n\t \n\tif (meta + 1 > data) {\n\t\tctx->mark = 41;\n\t\t  \n\t\treturn TC_ACT_OK;\n\t}\n\n\t \n\tctx->mark = meta->mark;  \n\n\treturn TC_ACT_OK;\n}\n\n \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}