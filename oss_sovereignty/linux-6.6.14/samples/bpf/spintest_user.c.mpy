{
  "module_name": "spintest_user.c",
  "hash_id": "214bea1550aa55b3447992e7b3c47a2e989a1336e51de4bf5ae9186e150a0c26",
  "original_prompt": "Ingested from linux-6.6.14/samples/bpf/spintest_user.c",
  "human_readable_source": "\n#include <stdio.h>\n#include <unistd.h>\n#include <string.h>\n#include <assert.h>\n#include <bpf/libbpf.h>\n#include <bpf/bpf.h>\n#include \"trace_helpers.h\"\n\nint main(int ac, char **argv)\n{\n\tstruct bpf_object *obj = NULL;\n\tstruct bpf_link *links[20];\n\tlong key, next_key, value;\n\tstruct bpf_program *prog;\n\tint map_fd, i, j = 0;\n\tchar filename[256];\n\tstruct ksym *sym;\n\n\tif (load_kallsyms()) {\n\t\tprintf(\"failed to process /proc/kallsyms\\n\");\n\t\treturn 2;\n\t}\n\n\tsnprintf(filename, sizeof(filename), \"%s.bpf.o\", argv[0]);\n\tobj = bpf_object__open_file(filename, NULL);\n\tif (libbpf_get_error(obj)) {\n\t\tfprintf(stderr, \"ERROR: opening BPF object file failed\\n\");\n\t\tobj = NULL;\n\t\tgoto cleanup;\n\t}\n\n\t \n\tif (bpf_object__load(obj)) {\n\t\tfprintf(stderr, \"ERROR: loading BPF object file failed\\n\");\n\t\tgoto cleanup;\n\t}\n\n\tmap_fd = bpf_object__find_map_fd_by_name(obj, \"my_map\");\n\tif (map_fd < 0) {\n\t\tfprintf(stderr, \"ERROR: finding a map in obj file failed\\n\");\n\t\tgoto cleanup;\n\t}\n\n\tbpf_object__for_each_program(prog, obj) {\n\t\tlinks[j] = bpf_program__attach(prog);\n\t\tif (libbpf_get_error(links[j])) {\n\t\t\tfprintf(stderr, \"bpf_program__attach failed\\n\");\n\t\t\tlinks[j] = NULL;\n\t\t\tgoto cleanup;\n\t\t}\n\t\tj++;\n\t}\n\n\tfor (i = 0; i < 5; i++) {\n\t\tkey = 0;\n\t\tprintf(\"kprobing funcs:\");\n\t\twhile (bpf_map_get_next_key(map_fd, &key, &next_key) == 0) {\n\t\t\tbpf_map_lookup_elem(map_fd, &next_key, &value);\n\t\t\tassert(next_key == value);\n\t\t\tsym = ksym_search(value);\n\t\t\tkey = next_key;\n\t\t\tif (!sym) {\n\t\t\t\tprintf(\"ksym not found. Is kallsyms loaded?\\n\");\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tprintf(\" %s\", sym->name);\n\t\t}\n\t\tif (key)\n\t\t\tprintf(\"\\n\");\n\t\tkey = 0;\n\t\twhile (bpf_map_get_next_key(map_fd, &key, &next_key) == 0)\n\t\t\tbpf_map_delete_elem(map_fd, &next_key);\n\t\tsleep(1);\n\t}\n\ncleanup:\n\tfor (j--; j >= 0; j--)\n\t\tbpf_link__destroy(links[j]);\n\n\tbpf_object__close(obj);\n\treturn 0;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}