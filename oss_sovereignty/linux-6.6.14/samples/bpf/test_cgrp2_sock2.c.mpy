{
  "module_name": "test_cgrp2_sock2.c",
  "hash_id": "aaa263206ac46fc3728136e60e50c232c6f4411b8078972e39a61d0bb3836e5a",
  "original_prompt": "Ingested from linux-6.6.14/samples/bpf/test_cgrp2_sock2.c",
  "human_readable_source": "\n \n\n#define _GNU_SOURCE\n\n#include <stdio.h>\n#include <stdlib.h>\n#include <stddef.h>\n#include <string.h>\n#include <unistd.h>\n#include <assert.h>\n#include <errno.h>\n#include <fcntl.h>\n#include <net/if.h>\n#include <linux/bpf.h>\n#include <bpf/bpf.h>\n#include <bpf/libbpf.h>\n\n#include \"bpf_insn.h\"\n\nstatic int usage(const char *argv0)\n{\n\tprintf(\"Usage: %s cg-path filter-path [filter-id]\\n\", argv0);\n\treturn EXIT_FAILURE;\n}\n\nint main(int argc, char **argv)\n{\n\tint cg_fd, err, ret = EXIT_FAILURE, filter_id = 0, prog_cnt = 0;\n\tconst char *link_pin_path = \"/sys/fs/bpf/test_cgrp2_sock2\";\n\tstruct bpf_link *link = NULL;\n\tstruct bpf_program *progs[2];\n\tstruct bpf_program *prog;\n\tstruct bpf_object *obj;\n\n\tif (argc < 3)\n\t\treturn usage(argv[0]);\n\n\tif (argc > 3)\n\t\tfilter_id = atoi(argv[3]);\n\n\tcg_fd = open(argv[1], O_DIRECTORY | O_RDONLY);\n\tif (cg_fd < 0) {\n\t\tprintf(\"Failed to open cgroup path: '%s'\\n\", strerror(errno));\n\t\treturn ret;\n\t}\n\n\tobj = bpf_object__open_file(argv[2], NULL);\n\tif (libbpf_get_error(obj)) {\n\t\tprintf(\"ERROR: opening BPF object file failed\\n\");\n\t\treturn ret;\n\t}\n\n\tbpf_object__for_each_program(prog, obj) {\n\t\tprogs[prog_cnt] = prog;\n\t\tprog_cnt++;\n\t}\n\n\tif (filter_id >= prog_cnt) {\n\t\tprintf(\"Invalid program id; program not found in file\\n\");\n\t\tgoto cleanup;\n\t}\n\n\t \n\tif (bpf_object__load(obj)) {\n\t\tprintf(\"ERROR: loading BPF object file failed\\n\");\n\t\tgoto cleanup;\n\t}\n\n\tlink = bpf_program__attach_cgroup(progs[filter_id], cg_fd);\n\tif (libbpf_get_error(link)) {\n\t\tprintf(\"ERROR: bpf_program__attach failed\\n\");\n\t\tlink = NULL;\n\t\tgoto cleanup;\n\t}\n\n\terr = bpf_link__pin(link, link_pin_path);\n\tif (err < 0) {\n\t\tprintf(\"ERROR: bpf_link__pin failed: %d\\n\", err);\n\t\tgoto cleanup;\n\t}\n\n\tret = EXIT_SUCCESS;\n\ncleanup:\n\tbpf_link__destroy(link);\n\tbpf_object__close(obj);\n\treturn ret;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}