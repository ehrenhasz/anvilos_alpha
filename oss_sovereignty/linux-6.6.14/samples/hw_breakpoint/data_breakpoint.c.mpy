{
  "module_name": "data_breakpoint.c",
  "hash_id": "02352e2404ce55bc9460777dd84c1614875cf3a6b814c56fb49ab118f262507f",
  "original_prompt": "Ingested from linux-6.6.14/samples/hw_breakpoint/data_breakpoint.c",
  "human_readable_source": "\n \n#include <linux/module.h>\t \n#include <linux/kernel.h>\t \n#include <linux/init.h>\t\t \n#include <linux/kallsyms.h>\n\n#include <linux/perf_event.h>\n#include <linux/hw_breakpoint.h>\n\nstatic struct perf_event * __percpu *sample_hbp;\n\nstatic char ksym_name[KSYM_NAME_LEN] = \"jiffies\";\nmodule_param_string(ksym, ksym_name, KSYM_NAME_LEN, S_IRUGO);\nMODULE_PARM_DESC(ksym, \"Kernel symbol to monitor; this module will report any\"\n\t\t\t\" write operations on the kernel symbol\");\n\nstatic void sample_hbp_handler(struct perf_event *bp,\n\t\t\t       struct perf_sample_data *data,\n\t\t\t       struct pt_regs *regs)\n{\n\tprintk(KERN_INFO \"%s value is changed\\n\", ksym_name);\n\tdump_stack();\n\tprintk(KERN_INFO \"Dump stack from sample_hbp_handler\\n\");\n}\n\nstatic int __init hw_break_module_init(void)\n{\n\tint ret;\n\tstruct perf_event_attr attr;\n\tvoid *addr = __symbol_get(ksym_name);\n\n\tif (!addr)\n\t\treturn -ENXIO;\n\n\thw_breakpoint_init(&attr);\n\tattr.bp_addr = (unsigned long)addr;\n\tattr.bp_len = HW_BREAKPOINT_LEN_4;\n\tattr.bp_type = HW_BREAKPOINT_W;\n\n\tsample_hbp = register_wide_hw_breakpoint(&attr, sample_hbp_handler, NULL);\n\tif (IS_ERR((void __force *)sample_hbp)) {\n\t\tret = PTR_ERR((void __force *)sample_hbp);\n\t\tgoto fail;\n\t}\n\n\tprintk(KERN_INFO \"HW Breakpoint for %s write installed\\n\", ksym_name);\n\n\treturn 0;\n\nfail:\n\tprintk(KERN_INFO \"Breakpoint registration failed\\n\");\n\n\treturn ret;\n}\n\nstatic void __exit hw_break_module_exit(void)\n{\n\tunregister_wide_hw_breakpoint(sample_hbp);\n#ifdef CONFIG_MODULE_UNLOAD\n\t__symbol_put(ksym_name);\n#endif\n\tprintk(KERN_INFO \"HW Breakpoint for %s write uninstalled\\n\", ksym_name);\n}\n\nmodule_init(hw_break_module_init);\nmodule_exit(hw_break_module_exit);\n\nMODULE_LICENSE(\"GPL\");\nMODULE_AUTHOR(\"K.Prasad\");\nMODULE_DESCRIPTION(\"ksym breakpoint\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}