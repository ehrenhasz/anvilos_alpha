{
  "module_name": "pktgen_sample01_simple.sh",
  "hash_id": "c79c030d22e46948050d67429ac78f34ad1e1d90ccfb07d225c49c0d0f0c63aa",
  "original_prompt": "Ingested from linux-6.6.14/samples/pktgen/pktgen_sample01_simple.sh",
  "human_readable_source": "#!/bin/bash\n# SPDX-License-Identifier: GPL-2.0\n#\n# Simple example:\n#  * pktgen sending with single thread and single interface\n#  * flow variation via random UDP source port\n#\nbasedir=`dirname $0`\nsource ${basedir}/functions.sh\nroot_check_run_with_sudo \"$@\"\n\n# Parameter parsing via include\n# - go look in parameters.sh to see which setting are avail\n# - required param is the interface \"-i\" stored in $DEV\nsource ${basedir}/parameters.sh\n\n# Trap EXIT first\ntrap_exit\n\n#\n# Set some default params, if they didn't get set\nif [ -z \"$DEST_IP\" ]; then\n    [ -z \"$IP6\" ] && DEST_IP=\"198.18.0.42\" || DEST_IP=\"FD00::1\"\nfi\n[ -z \"$CLONE_SKB\" ] && CLONE_SKB=\"0\"\n# Example enforce param \"-m\" for dst_mac\n[ -z \"$DST_MAC\" ] && usage && err 2 \"Must specify -m dst_mac\"\n[ -z \"$COUNT\" ]   && COUNT=\"100000\" # Zero means indefinitely\nif [ -n \"$DEST_IP\" ]; then\n    validate_addr${IP6} $DEST_IP\n    read -r DST_MIN DST_MAX <<< $(parse_addr${IP6} $DEST_IP)\nfi\nif [ -n \"$DST_PORT\" ]; then\n    read -r UDP_DST_MIN UDP_DST_MAX <<< $(parse_ports $DST_PORT)\n    validate_ports $UDP_DST_MIN $UDP_DST_MAX\nfi\n\n# Flow variation random source port between min and max\nUDP_SRC_MIN=9\nUDP_SRC_MAX=109\n\n# General cleanup everything since last run\n# (especially important if other threads were configured by other scripts)\n[ -z \"$APPEND\" ] && pg_ctrl \"reset\"\n\n# Add remove all other devices and add_device $DEV to thread 0\nthread=0\n[ -z \"$APPEND\" ] && pg_thread $thread \"rem_device_all\"\npg_thread $thread \"add_device\" $DEV\n\n# How many packets to send (zero means indefinitely)\npg_set $DEV \"count $COUNT\"\n\n# Reduce alloc cost by sending same SKB many times\n# - this obviously affects the randomness within the packet\npg_set $DEV \"clone_skb $CLONE_SKB\"\n\n# Set packet size\npg_set $DEV \"pkt_size $PKT_SIZE\"\n\n# Delay between packets (zero means max speed)\npg_set $DEV \"delay $DELAY\"\n\n# Flag example disabling timestamping\npg_set $DEV \"flag NO_TIMESTAMP\"\n\n# Destination\npg_set $DEV \"dst_mac $DST_MAC\"\npg_set $DEV \"dst${IP6}_min $DST_MIN\"\npg_set $DEV \"dst${IP6}_max $DST_MAX\"\n\nif [ -n \"$DST_PORT\" ]; then\n    # Single destination port or random port range\n    pg_set $DEV \"flag UDPDST_RND\"\n    pg_set $DEV \"udp_dst_min $UDP_DST_MIN\"\n    pg_set $DEV \"udp_dst_max $UDP_DST_MAX\"\nfi\n\n[ ! -z \"$UDP_CSUM\" ] && pg_set $dev \"flag UDPCSUM\"\n\n# Setup random UDP port src range\npg_set $DEV \"flag UDPSRC_RND\"\npg_set $DEV \"udp_src_min $UDP_SRC_MIN\"\npg_set $DEV \"udp_src_max $UDP_SRC_MAX\"\n\n# Run if user hits control-c\nfunction print_result() {\n    # Print results\n    echo \"Result device: $DEV\"\n    cat /proc/net/pktgen/$DEV\n}\n# trap keyboard interrupt (Ctrl-C)\ntrap true SIGINT\n\nif [ -z \"$APPEND\" ]; then\n    # start_run\n    echo \"Running... ctrl^C to stop\" >&2\n    pg_ctrl \"start\"\n    echo \"Done\" >&2\n\n    print_result\nelse\n    echo \"Append mode: config done. Do more or use 'pg_ctrl start' to run\"\nfi",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}