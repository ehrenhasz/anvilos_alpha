{
  "module_name": "hid_mouse.bpf.c",
  "hash_id": "b215523ed8e2eacdc41a46f3afc1746446194d95b60a16967ee6ad15dff926ee",
  "original_prompt": "Ingested from linux-6.6.14/samples/hid/hid_mouse.bpf.c",
  "human_readable_source": "\n\n#include \"vmlinux.h\"\n#include <bpf/bpf_helpers.h>\n#include <bpf/bpf_tracing.h>\n#include \"hid_bpf_helpers.h\"\n\nSEC(\"fmod_ret/hid_bpf_device_event\")\nint BPF_PROG(hid_y_event, struct hid_bpf_ctx *hctx)\n{\n\ts16 y;\n\t__u8 *data = hid_bpf_get_data(hctx, 0  , 9  );\n\n\tif (!data)\n\t\treturn 0;  \n\n\tbpf_printk(\"event: size: %d\", hctx->size);\n\tbpf_printk(\"incoming event: %02x %02x %02x\",\n\t\t   data[0],\n\t\t   data[1],\n\t\t   data[2]);\n\tbpf_printk(\"                %02x %02x %02x\",\n\t\t   data[3],\n\t\t   data[4],\n\t\t   data[5]);\n\tbpf_printk(\"                %02x %02x %02x\",\n\t\t   data[6],\n\t\t   data[7],\n\t\t   data[8]);\n\n\ty = data[3] | (data[4] << 8);\n\n\ty = -y;\n\n\tdata[3] = y & 0xFF;\n\tdata[4] = (y >> 8) & 0xFF;\n\n\tbpf_printk(\"modified event: %02x %02x %02x\",\n\t\t   data[0],\n\t\t   data[1],\n\t\t   data[2]);\n\tbpf_printk(\"                %02x %02x %02x\",\n\t\t   data[3],\n\t\t   data[4],\n\t\t   data[5]);\n\tbpf_printk(\"                %02x %02x %02x\",\n\t\t   data[6],\n\t\t   data[7],\n\t\t   data[8]);\n\n\treturn 0;\n}\n\nSEC(\"fmod_ret/hid_bpf_device_event\")\nint BPF_PROG(hid_x_event, struct hid_bpf_ctx *hctx)\n{\n\ts16 x;\n\t__u8 *data = hid_bpf_get_data(hctx, 0  , 9  );\n\n\tif (!data)\n\t\treturn 0;  \n\n\tx = data[1] | (data[2] << 8);\n\n\tx = -x;\n\n\tdata[1] = x & 0xFF;\n\tdata[2] = (x >> 8) & 0xFF;\n\treturn 0;\n}\n\nSEC(\"fmod_ret/hid_bpf_rdesc_fixup\")\nint BPF_PROG(hid_rdesc_fixup, struct hid_bpf_ctx *hctx)\n{\n\t__u8 *data = hid_bpf_get_data(hctx, 0  , 4096  );\n\n\tif (!data)\n\t\treturn 0;  \n\n\tbpf_printk(\"rdesc: %02x %02x %02x\",\n\t\t   data[0],\n\t\t   data[1],\n\t\t   data[2]);\n\tbpf_printk(\"       %02x %02x %02x\",\n\t\t   data[3],\n\t\t   data[4],\n\t\t   data[5]);\n\tbpf_printk(\"       %02x %02x %02x ...\",\n\t\t   data[6],\n\t\t   data[7],\n\t\t   data[8]);\n\n\t \n\tdata[39] = 0x31;\n\tdata[41] = 0x30;\n\n\treturn 0;\n}\n\nchar _license[] SEC(\"license\") = \"GPL\";\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}