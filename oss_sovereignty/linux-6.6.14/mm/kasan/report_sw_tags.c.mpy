{
  "module_name": "report_sw_tags.c",
  "hash_id": "f1e7d6c459f82d621c8f539257d1b6682bbe1785d140ca88546a2e913d144ee3",
  "original_prompt": "Ingested from linux-6.6.14/mm/kasan/report_sw_tags.c",
  "human_readable_source": "\n \n\n#include <linux/bitops.h>\n#include <linux/ftrace.h>\n#include <linux/init.h>\n#include <linux/kernel.h>\n#include <linux/mm.h>\n#include <linux/printk.h>\n#include <linux/sched.h>\n#include <linux/sched/task_stack.h>\n#include <linux/slab.h>\n#include <linux/stackdepot.h>\n#include <linux/stacktrace.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/kasan.h>\n#include <linux/module.h>\n\n#include <asm/sections.h>\n\n#include \"kasan.h\"\n#include \"../slab.h\"\n\nconst void *kasan_find_first_bad_addr(const void *addr, size_t size)\n{\n\tu8 tag = get_tag(addr);\n\tvoid *p = kasan_reset_tag(addr);\n\tvoid *end = p + size;\n\n\tif (!addr_has_metadata(p))\n\t\treturn p;\n\n\twhile (p < end && tag == *(u8 *)kasan_mem_to_shadow(p))\n\t\tp += KASAN_GRANULE_SIZE;\n\n\treturn p;\n}\n\nsize_t kasan_get_alloc_size(void *object, struct kmem_cache *cache)\n{\n\tsize_t size = 0;\n\tu8 *shadow;\n\n\t \n\n\t \n\tshadow = (u8 *)kasan_mem_to_shadow(object);\n\twhile (size < cache->object_size) {\n\t\tif (*shadow != KASAN_TAG_INVALID)\n\t\t\tsize += KASAN_GRANULE_SIZE;\n\t\telse\n\t\t\treturn size;\n\t\tshadow++;\n\t}\n\n\treturn cache->object_size;\n}\n\nvoid kasan_metadata_fetch_row(char *buffer, void *row)\n{\n\tmemcpy(buffer, kasan_mem_to_shadow(row), META_BYTES_PER_ROW);\n}\n\nvoid kasan_print_tags(u8 addr_tag, const void *addr)\n{\n\tu8 *shadow = (u8 *)kasan_mem_to_shadow(addr);\n\n\tpr_err(\"Pointer tag: [%02x], memory tag: [%02x]\\n\", addr_tag, *shadow);\n}\n\n#ifdef CONFIG_KASAN_STACK\nvoid kasan_print_address_stack_frame(const void *addr)\n{\n\tif (WARN_ON(!object_is_on_stack(addr)))\n\t\treturn;\n\n\tpr_err(\"The buggy address belongs to stack of task %s/%d\\n\",\n\t       current->comm, task_pid_nr(current));\n}\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}