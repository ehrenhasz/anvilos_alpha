{
  "module_name": "kasan_test_module.c",
  "hash_id": "72d39b52250e66027f8a786349f13267e87921b247aa7b732f624f8d53b6da46",
  "original_prompt": "Ingested from linux-6.6.14/mm/kasan/kasan_test_module.c",
  "human_readable_source": "\n \n\n#define pr_fmt(fmt) \"kasan test: %s \" fmt, __func__\n\n#include <linux/mman.h>\n#include <linux/module.h>\n#include <linux/printk.h>\n#include <linux/slab.h>\n#include <linux/uaccess.h>\n\n#include \"kasan.h\"\n\nstatic noinline void __init copy_user_test(void)\n{\n\tchar *kmem;\n\tchar __user *usermem;\n\tsize_t size = 128 - KASAN_GRANULE_SIZE;\n\tint __maybe_unused unused;\n\n\tkmem = kmalloc(size, GFP_KERNEL);\n\tif (!kmem)\n\t\treturn;\n\n\tusermem = (char __user *)vm_mmap(NULL, 0, PAGE_SIZE,\n\t\t\t    PROT_READ | PROT_WRITE | PROT_EXEC,\n\t\t\t    MAP_ANONYMOUS | MAP_PRIVATE, 0);\n\tif (IS_ERR(usermem)) {\n\t\tpr_err(\"Failed to allocate user memory\\n\");\n\t\tkfree(kmem);\n\t\treturn;\n\t}\n\n\tOPTIMIZER_HIDE_VAR(size);\n\n\tpr_info(\"out-of-bounds in copy_from_user()\\n\");\n\tunused = copy_from_user(kmem, usermem, size + 1);\n\n\tpr_info(\"out-of-bounds in copy_to_user()\\n\");\n\tunused = copy_to_user(usermem, kmem, size + 1);\n\n\tpr_info(\"out-of-bounds in __copy_from_user()\\n\");\n\tunused = __copy_from_user(kmem, usermem, size + 1);\n\n\tpr_info(\"out-of-bounds in __copy_to_user()\\n\");\n\tunused = __copy_to_user(usermem, kmem, size + 1);\n\n\tpr_info(\"out-of-bounds in __copy_from_user_inatomic()\\n\");\n\tunused = __copy_from_user_inatomic(kmem, usermem, size + 1);\n\n\tpr_info(\"out-of-bounds in __copy_to_user_inatomic()\\n\");\n\tunused = __copy_to_user_inatomic(usermem, kmem, size + 1);\n\n\tpr_info(\"out-of-bounds in strncpy_from_user()\\n\");\n\tunused = strncpy_from_user(kmem, usermem, size + 1);\n\n\tvm_munmap((unsigned long)usermem, PAGE_SIZE);\n\tkfree(kmem);\n}\n\nstatic int __init test_kasan_module_init(void)\n{\n\t \n\tbool multishot = kasan_save_enable_multi_shot();\n\n\tcopy_user_test();\n\n\tkasan_restore_multi_shot(multishot);\n\treturn -EAGAIN;\n}\n\nmodule_init(test_kasan_module_init);\nMODULE_LICENSE(\"GPL\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}