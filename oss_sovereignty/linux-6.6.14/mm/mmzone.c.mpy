{
  "module_name": "mmzone.c",
  "hash_id": "8b3aa67ea10713d1ad40a3115f6b63023a1ba3123a61a4686224fb3cee285f19",
  "original_prompt": "Ingested from linux-6.6.14/mm/mmzone.c",
  "human_readable_source": "\n \n\n\n#include <linux/stddef.h>\n#include <linux/mm.h>\n#include <linux/mmzone.h>\n\nstruct pglist_data *first_online_pgdat(void)\n{\n\treturn NODE_DATA(first_online_node);\n}\n\nstruct pglist_data *next_online_pgdat(struct pglist_data *pgdat)\n{\n\tint nid = next_online_node(pgdat->node_id);\n\n\tif (nid == MAX_NUMNODES)\n\t\treturn NULL;\n\treturn NODE_DATA(nid);\n}\n\n \nstruct zone *next_zone(struct zone *zone)\n{\n\tpg_data_t *pgdat = zone->zone_pgdat;\n\n\tif (zone < pgdat->node_zones + MAX_NR_ZONES - 1)\n\t\tzone++;\n\telse {\n\t\tpgdat = next_online_pgdat(pgdat);\n\t\tif (pgdat)\n\t\t\tzone = pgdat->node_zones;\n\t\telse\n\t\t\tzone = NULL;\n\t}\n\treturn zone;\n}\n\nstatic inline int zref_in_nodemask(struct zoneref *zref, nodemask_t *nodes)\n{\n#ifdef CONFIG_NUMA\n\treturn node_isset(zonelist_node_idx(zref), *nodes);\n#else\n\treturn 1;\n#endif  \n}\n\n \nstruct zoneref *__next_zones_zonelist(struct zoneref *z,\n\t\t\t\t\tenum zone_type highest_zoneidx,\n\t\t\t\t\tnodemask_t *nodes)\n{\n\t \n\tif (unlikely(nodes == NULL))\n\t\twhile (zonelist_zone_idx(z) > highest_zoneidx)\n\t\t\tz++;\n\telse\n\t\twhile (zonelist_zone_idx(z) > highest_zoneidx ||\n\t\t\t\t(z->zone && !zref_in_nodemask(z, nodes)))\n\t\t\tz++;\n\n\treturn z;\n}\n\nvoid lruvec_init(struct lruvec *lruvec)\n{\n\tenum lru_list lru;\n\n\tmemset(lruvec, 0, sizeof(struct lruvec));\n\tspin_lock_init(&lruvec->lru_lock);\n\n\tfor_each_lru(lru)\n\t\tINIT_LIST_HEAD(&lruvec->lists[lru]);\n\t \n\tlist_del(&lruvec->lists[LRU_UNEVICTABLE]);\n\n\tlru_gen_init_lruvec(lruvec);\n}\n\n#if defined(CONFIG_NUMA_BALANCING) && !defined(LAST_CPUPID_NOT_IN_PAGE_FLAGS)\nint page_cpupid_xchg_last(struct page *page, int cpupid)\n{\n\tunsigned long old_flags, flags;\n\tint last_cpupid;\n\n\told_flags = READ_ONCE(page->flags);\n\tdo {\n\t\tflags = old_flags;\n\t\tlast_cpupid = (flags >> LAST_CPUPID_PGSHIFT) & LAST_CPUPID_MASK;\n\n\t\tflags &= ~(LAST_CPUPID_MASK << LAST_CPUPID_PGSHIFT);\n\t\tflags |= (cpupid & LAST_CPUPID_MASK) << LAST_CPUPID_PGSHIFT;\n\t} while (unlikely(!try_cmpxchg(&page->flags, &old_flags, flags)));\n\n\treturn last_cpupid;\n}\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}