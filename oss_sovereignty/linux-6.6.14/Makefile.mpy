{
  "module_name": "Makefile",
  "hash_id": "28daa1a76d0d7ecd0ab6e05a955129c65e3b2518b38353cf1a3feaa4921f45c5",
  "original_prompt": "Ingested from linux-6.6.14/Makefile",
  "human_readable_source": "# SPDX-License-Identifier: GPL-2.0\nVERSION = 6\nPATCHLEVEL = 6\nSUBLEVEL = 14\nEXTRAVERSION =\nNAME = Hurr durr I'ma ninja sloth\n\n# *DOCUMENTATION*\n# To see a list of typical targets execute \"make help\"\n# More info can be located in ./README\n# Comments in this file are targeted only to the developer, do not\n# expect to learn how to build the kernel reading this file.\n\nifeq ($(filter undefine,$(.FEATURES)),)\n$(error GNU Make >= 3.82 is required. Your Make version is $(MAKE_VERSION))\nendif\n\n$(if $(filter __%, $(MAKECMDGOALS)), \\\n\t$(error targets prefixed with '__' are only for internal use))\n\n# That's our default target when none is given on the command line\nPHONY := __all\n__all:\n\n# We are using a recursive build, so we need to do a little thinking\n# to get the ordering right.\n#\n# Most importantly: sub-Makefiles should only ever modify files in\n# their own directory. If in some directory we have a dependency on\n# a file in another dir (which doesn't happen often, but it's often\n# unavoidable when linking the built-in.a targets which finally\n# turn into vmlinux), we will call a sub make in that other dir, and\n# after that we are sure that everything which is in that other dir\n# is now up to date.\n#\n# The only cases where we need to modify files which have global\n# effects are thus separated out and done before the recursive\n# descending is started. They are now explicitly listed as the\n# prepare rule.\n\nthis-makefile := $(lastword $(MAKEFILE_LIST))\nexport abs_srctree := $(realpath $(dir $(this-makefile)))\nexport abs_objtree := $(CURDIR)\n\nifneq ($(sub_make_done),1)\n\n# Do not use make's built-in rules and variables\n# (this increases performance and avoids hard-to-debug behaviour)\nMAKEFLAGS += -rR\n\n# Avoid funny character set dependencies\nunexport LC_ALL\nLC_COLLATE=C\nLC_NUMERIC=C\nexport LC_COLLATE LC_NUMERIC\n\n# Avoid interference with shell env settings\nunexport GREP_OPTIONS\n\n# Beautify output\n# ---------------------------------------------------------------------------\n#\n# Most of build commands in Kbuild start with \"cmd_\". You can optionally define\n# \"quiet_cmd_*\". If defined, the short log is printed. Otherwise, no log from\n# that command is printed by default.\n#\n# e.g.)\n#    quiet_cmd_depmod = DEPMOD  $(MODLIB)\n#          cmd_depmod = $(srctree)/scripts/depmod.sh $(DEPMOD) $(KERNELRELEASE)\n#\n# A simple variant is to prefix commands with $(Q) - that's useful\n# for commands that shall be hidden in non-verbose mode.\n#\n#    $(Q)$(MAKE) $(build)=scripts/basic\n#\n# If KBUILD_VERBOSE contains 1, the whole command is echoed.\n# If KBUILD_VERBOSE contains 2, the reason for rebuilding is printed.\n#\n# To put more focus on warnings, be less verbose as default\n# Use 'make V=1' to see the full commands\n\nifeq (\"$(origin V)\", \"command line\")\n  KBUILD_VERBOSE = $(V)\nendif\n\nquiet = quiet_\nQ = @\n\nifneq ($(findstring 1, $(KBUILD_VERBOSE)),)\n  quiet =\n  Q =\nendif\n\n# If the user is running make -s (silent mode), suppress echoing of\n# commands\n# make-4.0 (and later) keep single letter options in the 1st word of MAKEFLAGS.\n\nifeq ($(filter 3.%,$(MAKE_VERSION)),)\nshort-opts := $(firstword -$(MAKEFLAGS))\nelse\nshort-opts := $(filter-out --%,$(MAKEFLAGS))\nendif\n\nifneq ($(findstring s,$(short-opts)),)\nquiet=silent_\noverride KBUILD_VERBOSE :=\nendif\n\nexport quiet Q KBUILD_VERBOSE\n\n# Call a source code checker (by default, \"sparse\") as part of the\n# C compilation.\n#\n# Use 'make C=1' to enable checking of only re-compiled files.\n# Use 'make C=2' to enable checking of *all* source files, regardless\n# of whether they are re-compiled or not.\n#\n# See the file \"Documentation/dev-tools/sparse.rst\" for more details,\n# including where to get the \"sparse\" utility.\n\nifeq (\"$(origin C)\", \"command line\")\n  KBUILD_CHECKSRC = $(C)\nendif\nifndef KBUILD_CHECKSRC\n  KBUILD_CHECKSRC = 0\nendif\n\nexport KBUILD_CHECKSRC\n\n# Enable \"clippy\" (a linter) as part of the Rust compilation.\n#\n# Use 'make CLIPPY=1' to enable it.\nifeq (\"$(origin CLIPPY)\", \"command line\")\n  KBUILD_CLIPPY := $(CLIPPY)\nendif\n\nexport KBUILD_CLIPPY\n\n# Use make M=dir or set the environment variable KBUILD_EXTMOD to specify the\n# directory of external module to build. Setting M= takes precedence.\nifeq (\"$(origin M)\", \"command line\")\n  KBUILD_EXTMOD := $(M)\nendif\n\n$(if $(word 2, $(KBUILD_EXTMOD)), \\\n\t$(error building multiple external modules is not supported))\n\n$(foreach x, % :, $(if $(findstring $x, $(KBUILD_EXTMOD)), \\\n\t$(error module directory path cannot contain '$x')))\n\n# Remove trailing slashes\nifneq ($(filter %/, $(KBUILD_EXTMOD)),)\nKBUILD_EXTMOD := $(shell dirname $(KBUILD_EXTMOD).)\nendif\n\nexport KBUILD_EXTMOD\n\n# Kbuild will save output files in the current working directory.\n# This does not need to match to the root of the kernel source tree.\n#\n# For example, you can do this:\n#\n#  cd /dir/to/store/output/files; make -f /dir/to/kernel/source/Makefile\n#\n# If you want to save output files in a different location, there are\n# two syntaxes to specify it.\n#\n# 1) O=\n# Use \"make O=dir/to/store/output/files/\"\n#\n# 2) Set KBUILD_OUTPUT\n# Set the environment variable KBUILD_OUTPUT to point to the output directory.\n# export KBUILD_OUTPUT=dir/to/store/output/files/; make\n#\n# The O= assignment takes precedence over the KBUILD_OUTPUT environment\n# variable.\n\n# Do we want to change the working directory?\nifeq (\"$(origin O)\", \"command line\")\n  KBUILD_OUTPUT := $(O)\nendif\n\nifneq ($(KBUILD_OUTPUT),)\n# Make's built-in functions such as $(abspath ...), $(realpath ...) cannot\n# expand a shell special character '~'. We use a somewhat tedious way here.\nabs_objtree := $(shell mkdir -p $(KBUILD_OUTPUT) && cd $(KBUILD_OUTPUT) && pwd)\n$(if $(abs_objtree),, \\\n     $(error failed to create output directory \"$(KBUILD_OUTPUT)\"))\n\n# $(realpath ...) resolves symlinks\nabs_objtree := $(realpath $(abs_objtree))\nendif # ifneq ($(KBUILD_OUTPUT),)\n\nifneq ($(words $(subst :, ,$(abs_srctree))), 1)\n$(error source directory cannot contain spaces or colons)\nendif\n\nifneq ($(filter 3.%,$(MAKE_VERSION)),)\n# 'MAKEFLAGS += -rR' does not immediately become effective for GNU Make 3.x\n# We need to invoke sub-make to avoid implicit rules in the top Makefile.\nneed-sub-make := 1\n# Cancel implicit rules for this Makefile.\n$(this-makefile): ;\nendif\n\nexport sub_make_done := 1\n\nendif # sub_make_done\n\nifeq ($(abs_objtree),$(CURDIR))\n# Suppress \"Entering directory ...\" if we are at the final work directory.\nno-print-directory := --no-print-directory\nelse\n# Recursion to show \"Entering directory ...\"\nneed-sub-make := 1\nendif\n\nifeq ($(filter --no-print-directory, $(MAKEFLAGS)),)\n# If --no-print-directory is unset, recurse once again to set it.\n# You may end up recursing into __sub-make twice. This is needed due to the\n# behavior change in GNU Make 4.4.1.\nneed-sub-make := 1\nendif\n\nifeq ($(need-sub-make),1)\n\nPHONY += $(MAKECMDGOALS) __sub-make\n\n$(filter-out $(this-makefile), $(MAKECMDGOALS)) __all: __sub-make\n\t@:\n\n# Invoke a second make in the output directory, passing relevant variables\n__sub-make:\n\t$(Q)$(MAKE) $(no-print-directory) -C $(abs_objtree) \\\n\t-f $(abs_srctree)/Makefile $(MAKECMDGOALS)\n\nelse # need-sub-make\n\n# We process the rest of the Makefile if this is the final invocation of make\n\nifeq ($(abs_srctree),$(abs_objtree))\n        # building in the source tree\n        srctree := .\n\tbuilding_out_of_srctree :=\nelse\n        ifeq ($(abs_srctree)/,$(dir $(abs_objtree)))\n                # building in a subdirectory of the source tree\n                srctree := ..\n        else\n                srctree := $(abs_srctree)\n        endif\n\tbuilding_out_of_srctree := 1\nendif\n\nifneq ($(KBUILD_ABS_SRCTREE),)\nsrctree := $(abs_srctree)\nendif\n\nobjtree\t\t:= .\nVPATH\t\t:= $(srctree)\n\nexport building_out_of_srctree srctree objtree VPATH\n\n# To make sure we do not include .config for any of the *config targets\n# catch them early, and hand them over to scripts/kconfig/Makefile\n# It is allowed to specify more targets when calling make, including\n# mixing *config targets and build targets.\n# For example 'make oldconfig all'.\n# Detect when mixed targets is specified, and make a second invocation\n# of make so .config is not included in this case either (for *config).\n\nversion_h := include/generated/uapi/linux/version.h\n\nclean-targets := %clean mrproper cleandocs\nno-dot-config-targets := $(clean-targets) \\\n\t\t\t cscope gtags TAGS tags help% %docs check% coccicheck \\\n\t\t\t $(version_h) headers headers_% archheaders archscripts \\\n\t\t\t %asm-generic kernelversion %src-pkg dt_binding_check \\\n\t\t\t outputmakefile rustavailable rustfmt rustfmtcheck\n# Installation targets should not require compiler. Unfortunately, vdso_install\n# is an exception where build artifacts may be updated. This must be fixed.\nno-compiler-targets := $(no-dot-config-targets) install dtbs_install \\\n\t\t\theaders_install modules_install modules_sign kernelrelease image_name\nno-sync-config-targets := $(no-dot-config-targets) %install modules_sign kernelrelease \\\n\t\t\t  image_name\nsingle-targets := %.a %.i %.ko %.lds %.ll %.lst %.mod %.o %.rsi %.s %.symtypes %/\n\nconfig-build\t:=\nmixed-build\t:=\nneed-config\t:= 1\nneed-compiler\t:= 1\nmay-sync-config\t:= 1\nsingle-build\t:=\n\nifneq ($(filter $(no-dot-config-targets), $(MAKECMDGOALS)),)\n\tifeq ($(filter-out $(no-dot-config-targets), $(MAKECMDGOALS)),)\n\t\tneed-config :=\n\tendif\nendif\n\nifneq ($(filter $(no-compiler-targets), $(MAKECMDGOALS)),)\n\tifeq ($(filter-out $(no-compiler-targets), $(MAKECMDGOALS)),)\n\t\tneed-compiler :=\n\tendif\nendif\n\nifneq ($(filter $(no-sync-config-targets), $(MAKECMDGOALS)),)\n\tifeq ($(filter-out $(no-sync-config-targets), $(MAKECMDGOALS)),)\n\t\tmay-sync-config :=\n\tendif\nendif\n\nifneq ($(KBUILD_EXTMOD),)\n\tmay-sync-config :=\nendif\n\nifeq ($(KBUILD_EXTMOD),)\n        ifneq ($(filter %config,$(MAKECMDGOALS)),)\n\t\tconfig-build := 1\n                ifneq ($(words $(MAKECMDGOALS)),1)\n\t\t\tmixed-build := 1\n                endif\n        endif\nendif\n\n# We cannot build single targets and the others at the same time\nifneq ($(filter $(single-targets), $(MAKECMDGOALS)),)\n\tsingle-build := 1\n\tifneq ($(filter-out $(single-targets), $(MAKECMDGOALS)),)\n\t\tmixed-build := 1\n\tendif\nendif\n\n# For \"make -j clean all\", \"make -j mrproper defconfig all\", etc.\nifneq ($(filter $(clean-targets),$(MAKECMDGOALS)),)\n        ifneq ($(filter-out $(clean-targets),$(MAKECMDGOALS)),)\n\t\tmixed-build := 1\n        endif\nendif\n\n# install and modules_install need also be processed one by one\nifneq ($(filter install,$(MAKECMDGOALS)),)\n        ifneq ($(filter modules_install,$(MAKECMDGOALS)),)\n\t\tmixed-build := 1\n        endif\nendif\n\nifdef mixed-build\n# ===========================================================================\n# We're called with mixed targets (*config and build targets).\n# Handle them one by one.\n\nPHONY += $(MAKECMDGOALS) __build_one_by_one\n\n$(MAKECMDGOALS): __build_one_by_one\n\t@:\n\n__build_one_by_one:\n\t$(Q)set -e; \\\n\tfor i in $(MAKECMDGOALS); do \\\n\t\t$(MAKE) -f $(srctree)/Makefile $$i; \\\n\tdone\n\nelse # !mixed-build\n\ninclude $(srctree)/scripts/Kbuild.include\n\n# Read KERNELRELEASE from include/config/kernel.release (if it exists)\nKERNELRELEASE = $(call read-file, include/config/kernel.release)\nKERNELVERSION = $(VERSION)$(if $(PATCHLEVEL),.$(PATCHLEVEL)$(if $(SUBLEVEL),.$(SUBLEVEL)))$(EXTRAVERSION)\nexport VERSION PATCHLEVEL SUBLEVEL KERNELRELEASE KERNELVERSION\n\ninclude $(srctree)/scripts/subarch.include\n\n# Cross compiling and selecting different set of gcc/bin-utils\n# ---------------------------------------------------------------------------\n#\n# When performing cross compilation for other architectures ARCH shall be set\n# to the target architecture. (See arch/* for the possibilities).\n# ARCH can be set during invocation of make:\n# make ARCH=ia64\n# Another way is to have ARCH set in the environment.\n# The default ARCH is the host where make is executed.\n\n# CROSS_COMPILE specify the prefix used for all executables used\n# during compilation. Only gcc and related bin-utils executables\n# are prefixed with $(CROSS_COMPILE).\n# CROSS_COMPILE can be set on the command line\n# make CROSS_COMPILE=ia64-linux-\n# Alternatively CROSS_COMPILE can be set in the environment.\n# Default value for CROSS_COMPILE is not to prefix executables\n# Note: Some architectures assign CROSS_COMPILE in their arch/*/Makefile\nARCH\t\t?= $(SUBARCH)\n\n# Architecture as present in compile.h\nUTS_MACHINE \t:= $(ARCH)\nSRCARCH \t:= $(ARCH)\n\n# Additional ARCH settings for x86\nifeq ($(ARCH),i386)\n        SRCARCH := x86\nendif\nifeq ($(ARCH),x86_64)\n        SRCARCH := x86\nendif\n\n# Additional ARCH settings for sparc\nifeq ($(ARCH),sparc32)\n       SRCARCH := sparc\nendif\nifeq ($(ARCH),sparc64)\n       SRCARCH := sparc\nendif\n\n# Additional ARCH settings for parisc\nifeq ($(ARCH),parisc64)\n       SRCARCH := parisc\nendif\n\nexport cross_compiling :=\nifneq ($(SRCARCH),$(SUBARCH))\ncross_compiling := 1\nendif\n\nKCONFIG_CONFIG\t?= .config\nexport KCONFIG_CONFIG\n\n# SHELL used by kbuild\nCONFIG_SHELL := sh\n\nHOST_LFS_CFLAGS := $(shell getconf LFS_CFLAGS 2>/dev/null)\nHOST_LFS_LDFLAGS := $(shell getconf LFS_LDFLAGS 2>/dev/null)\nHOST_LFS_LIBS := $(shell getconf LFS_LIBS 2>/dev/null)\n\nifneq ($(LLVM),)\nifneq ($(filter %/,$(LLVM)),)\nLLVM_PREFIX := $(LLVM)\nelse ifneq ($(filter -%,$(LLVM)),)\nLLVM_SUFFIX := $(LLVM)\nendif\n\nHOSTCC\t= $(LLVM_PREFIX)clang$(LLVM_SUFFIX)\nHOSTCXX\t= $(LLVM_PREFIX)clang++$(LLVM_SUFFIX)\nelse\nHOSTCC\t= gcc\nHOSTCXX\t= g++\nendif\nHOSTRUSTC = rustc\nHOSTPKG_CONFIG\t= pkg-config\n\nKBUILD_USERHOSTCFLAGS := -Wall -Wmissing-prototypes -Wstrict-prototypes \\\n\t\t\t -O2 -fomit-frame-pointer -std=gnu11\nKBUILD_USERCFLAGS  := $(KBUILD_USERHOSTCFLAGS) $(USERCFLAGS)\nKBUILD_USERLDFLAGS := $(USERLDFLAGS)\n\n# These flags apply to all Rust code in the tree, including the kernel and\n# host programs.\nexport rust_common_flags := --edition=2021 \\\n\t\t\t    -Zbinary_dep_depinfo=y \\\n\t\t\t    -Dunsafe_op_in_unsafe_fn -Drust_2018_idioms \\\n\t\t\t    -Dunreachable_pub -Dnon_ascii_idents \\\n\t\t\t    -Wmissing_docs \\\n\t\t\t    -Drustdoc::missing_crate_level_docs \\\n\t\t\t    -Dclippy::correctness -Dclippy::style \\\n\t\t\t    -Dclippy::suspicious -Dclippy::complexity \\\n\t\t\t    -Dclippy::perf \\\n\t\t\t    -Dclippy::let_unit_value -Dclippy::mut_mut \\\n\t\t\t    -Dclippy::needless_bitwise_bool \\\n\t\t\t    -Dclippy::needless_continue \\\n\t\t\t    -Dclippy::no_mangle_with_rust_abi \\\n\t\t\t    -Wclippy::dbg_macro\n\nKBUILD_HOSTCFLAGS   := $(KBUILD_USERHOSTCFLAGS) $(HOST_LFS_CFLAGS) $(HOSTCFLAGS)\nKBUILD_HOSTCXXFLAGS := -Wall -O2 $(HOST_LFS_CFLAGS) $(HOSTCXXFLAGS)\nKBUILD_HOSTRUSTFLAGS := $(rust_common_flags) -O -Cstrip=debuginfo \\\n\t\t\t-Zallow-features= $(HOSTRUSTFLAGS)\nKBUILD_HOSTLDFLAGS  := $(HOST_LFS_LDFLAGS) $(HOSTLDFLAGS)\nKBUILD_HOSTLDLIBS   := $(HOST_LFS_LIBS) $(HOSTLDLIBS)\n\n# Make variables (CC, etc...)\nCPP\t\t= $(CC) -E\nifneq ($(LLVM),)\nCC\t\t= $(LLVM_PREFIX)clang$(LLVM_SUFFIX)\nLD\t\t= $(LLVM_PREFIX)ld.lld$(LLVM_SUFFIX)\nAR\t\t= $(LLVM_PREFIX)llvm-ar$(LLVM_SUFFIX)\nNM\t\t= $(LLVM_PREFIX)llvm-nm$(LLVM_SUFFIX)\nOBJCOPY\t\t= $(LLVM_PREFIX)llvm-objcopy$(LLVM_SUFFIX)\nOBJDUMP\t\t= $(LLVM_PREFIX)llvm-objdump$(LLVM_SUFFIX)\nREADELF\t\t= $(LLVM_PREFIX)llvm-readelf$(LLVM_SUFFIX)\nSTRIP\t\t= $(LLVM_PREFIX)llvm-strip$(LLVM_SUFFIX)\nelse\nCC\t\t= $(CROSS_COMPILE)gcc\nLD\t\t= $(CROSS_COMPILE)ld\nAR\t\t= $(CROSS_COMPILE)ar\nNM\t\t= $(CROSS_COMPILE)nm\nOBJCOPY\t\t= $(CROSS_COMPILE)objcopy\nOBJDUMP\t\t= $(CROSS_COMPILE)objdump\nREADELF\t\t= $(CROSS_COMPILE)readelf\nSTRIP\t\t= $(CROSS_COMPILE)strip\nendif\nRUSTC\t\t= rustc\nRUSTDOC\t\t= rustdoc\nRUSTFMT\t\t= rustfmt\nCLIPPY_DRIVER\t= clippy-driver\nBINDGEN\t\t= bindgen\nCARGO\t\t= cargo\nPAHOLE\t\t= pahole\nRESOLVE_BTFIDS\t= $(objtree)/tools/bpf/resolve_btfids/resolve_btfids\nLEX\t\t= flex\nYACC\t\t= bison\nAWK\t\t= awk\nINSTALLKERNEL  := installkernel\nPERL\t\t= perl\nPYTHON3\t\t= python3\nCHECK\t\t= sparse\nBASH\t\t= bash\nKGZIP\t\t= gzip\nKBZIP2\t\t= bzip2\nKLZOP\t\t= lzop\nLZMA\t\t= lzma\nLZ4\t\t= lz4c\nXZ\t\t= xz\nZSTD\t\t= zstd\n\nPAHOLE_FLAGS\t= $(shell PAHOLE=$(PAHOLE) $(srctree)/scripts/pahole-flags.sh)\n\nCHECKFLAGS     := -D__linux__ -Dlinux -D__STDC__ -Dunix -D__unix__ \\\n\t\t  -Wbitwise -Wno-return-void -Wno-unknown-attribute $(CF)\nNOSTDINC_FLAGS :=\nCFLAGS_MODULE   =\nRUSTFLAGS_MODULE =\nAFLAGS_MODULE   =\nLDFLAGS_MODULE  =\nCFLAGS_KERNEL\t=\nRUSTFLAGS_KERNEL =\nAFLAGS_KERNEL\t=\nLDFLAGS_vmlinux =\n\n# Use USERINCLUDE when you must reference the UAPI directories only.\nUSERINCLUDE    := \\\n\t\t-I$(srctree)/arch/$(SRCARCH)/include/uapi \\\n\t\t-I$(objtree)/arch/$(SRCARCH)/include/generated/uapi \\\n\t\t-I$(srctree)/include/uapi \\\n\t\t-I$(objtree)/include/generated/uapi \\\n                -include $(srctree)/include/linux/compiler-version.h \\\n                -include $(srctree)/include/linux/kconfig.h\n\n# Use LINUXINCLUDE when you must reference the include/ directory.\n# Needed to be compatible with the O= option\nLINUXINCLUDE    := \\\n\t\t-I$(srctree)/arch/$(SRCARCH)/include \\\n\t\t-I$(objtree)/arch/$(SRCARCH)/include/generated \\\n\t\t$(if $(building_out_of_srctree),-I$(srctree)/include) \\\n\t\t-I$(objtree)/include \\\n\t\t$(USERINCLUDE)\n\nKBUILD_AFLAGS   := -D__ASSEMBLY__ -fno-PIE\n\nKBUILD_CFLAGS :=\nKBUILD_CFLAGS += -std=gnu11\nKBUILD_CFLAGS += -fshort-wchar\nKBUILD_CFLAGS += -funsigned-char\nKBUILD_CFLAGS += -fno-common\nKBUILD_CFLAGS += -fno-PIE\nKBUILD_CFLAGS += -fno-strict-aliasing\n\nKBUILD_CPPFLAGS := -D__KERNEL__\nKBUILD_RUSTFLAGS := $(rust_common_flags) \\\n\t\t    --target=$(objtree)/scripts/target.json \\\n\t\t    -Cpanic=abort -Cembed-bitcode=n -Clto=n \\\n\t\t    -Cforce-unwind-tables=n -Ccodegen-units=1 \\\n\t\t    -Csymbol-mangling-version=v0 \\\n\t\t    -Crelocation-model=static \\\n\t\t    -Zfunction-sections=n \\\n\t\t    -Dclippy::float_arithmetic\n\nKBUILD_AFLAGS_KERNEL :=\nKBUILD_CFLAGS_KERNEL :=\nKBUILD_RUSTFLAGS_KERNEL :=\nKBUILD_AFLAGS_MODULE  := -DMODULE\nKBUILD_CFLAGS_MODULE  := -DMODULE\nKBUILD_RUSTFLAGS_MODULE := --cfg MODULE\nKBUILD_LDFLAGS_MODULE :=\nKBUILD_LDFLAGS :=\nCLANG_FLAGS :=\n\nifeq ($(KBUILD_CLIPPY),1)\n\tRUSTC_OR_CLIPPY_QUIET := CLIPPY\n\tRUSTC_OR_CLIPPY = $(CLIPPY_DRIVER)\nelse\n\tRUSTC_OR_CLIPPY_QUIET := RUSTC\n\tRUSTC_OR_CLIPPY = $(RUSTC)\nendif\n\nifdef RUST_LIB_SRC\n\texport RUST_LIB_SRC\nendif\n\n# Allows the usage of unstable features in stable compilers.\nexport RUSTC_BOOTSTRAP := 1\n\nexport ARCH SRCARCH CONFIG_SHELL BASH HOSTCC KBUILD_HOSTCFLAGS CROSS_COMPILE LD CC HOSTPKG_CONFIG\nexport RUSTC RUSTDOC RUSTFMT RUSTC_OR_CLIPPY_QUIET RUSTC_OR_CLIPPY BINDGEN CARGO\nexport HOSTRUSTC KBUILD_HOSTRUSTFLAGS\nexport CPP AR NM STRIP OBJCOPY OBJDUMP READELF PAHOLE RESOLVE_BTFIDS LEX YACC AWK INSTALLKERNEL\nexport PERL PYTHON3 CHECK CHECKFLAGS MAKE UTS_MACHINE HOSTCXX\nexport KGZIP KBZIP2 KLZOP LZMA LZ4 XZ ZSTD\nexport KBUILD_HOSTCXXFLAGS KBUILD_HOSTLDFLAGS KBUILD_HOSTLDLIBS LDFLAGS_MODULE\nexport KBUILD_USERCFLAGS KBUILD_USERLDFLAGS\n\nexport KBUILD_CPPFLAGS NOSTDINC_FLAGS LINUXINCLUDE OBJCOPYFLAGS KBUILD_LDFLAGS\nexport KBUILD_CFLAGS CFLAGS_KERNEL CFLAGS_MODULE\nexport KBUILD_RUSTFLAGS RUSTFLAGS_KERNEL RUSTFLAGS_MODULE\nexport KBUILD_AFLAGS AFLAGS_KERNEL AFLAGS_MODULE\nexport KBUILD_AFLAGS_MODULE KBUILD_CFLAGS_MODULE KBUILD_RUSTFLAGS_MODULE KBUILD_LDFLAGS_MODULE\nexport KBUILD_AFLAGS_KERNEL KBUILD_CFLAGS_KERNEL KBUILD_RUSTFLAGS_KERNEL\nexport PAHOLE_FLAGS\n\n# Files to ignore in find ... statements\n\nexport RCS_FIND_IGNORE := \\( -name SCCS -o -name BitKeeper -o -name .svn -o    \\\n\t\t\t  -name CVS -o -name .pc -o -name .hg -o -name .git \\) \\\n\t\t\t  -prune -o\nexport RCS_TAR_IGNORE := --exclude SCCS --exclude BitKeeper --exclude .svn \\\n\t\t\t --exclude CVS --exclude .pc --exclude .hg --exclude .git\n\n# ===========================================================================\n# Rules shared between *config targets and build targets\n\n# Basic helpers built in scripts/basic/\nPHONY += scripts_basic\nscripts_basic:\n\t$(Q)$(MAKE) $(build)=scripts/basic\n\nPHONY += outputmakefile\nifdef building_out_of_srctree\n# Before starting out-of-tree build, make sure the source tree is clean.\n# outputmakefile generates a Makefile in the output directory, if using a\n# separate output directory. This allows convenient use of make in the\n# output directory.\n# At the same time when output Makefile generated, generate .gitignore to\n# ignore whole output directory\n\nquiet_cmd_makefile = GEN     Makefile\n      cmd_makefile = { \\\n\techo \"\\# Automatically generated by $(srctree)/Makefile: don't edit\"; \\\n\techo \"include $(srctree)/Makefile\"; \\\n\t} > Makefile\n\noutputmakefile:\n\t@if [ -f $(srctree)/.config -o \\\n\t\t -d $(srctree)/include/config -o \\\n\t\t -d $(srctree)/arch/$(SRCARCH)/include/generated ]; then \\\n\t\techo >&2 \"***\"; \\\n\t\techo >&2 \"*** The source tree is not clean, please run 'make$(if $(findstring command line, $(origin ARCH)), ARCH=$(ARCH)) mrproper'\"; \\\n\t\techo >&2 \"*** in $(abs_srctree)\";\\\n\t\techo >&2 \"***\"; \\\n\t\tfalse; \\\n\tfi\n\t$(Q)ln -fsn $(srctree) source\n\t$(call cmd,makefile)\n\t$(Q)test -e .gitignore || \\\n\t{ echo \"# this is build directory, ignore it\"; echo \"*\"; } > .gitignore\nendif\n\n# The expansion should be delayed until arch/$(SRCARCH)/Makefile is included.\n# Some architectures define CROSS_COMPILE in arch/$(SRCARCH)/Makefile.\n# CC_VERSION_TEXT is referenced from Kconfig (so it needs export),\n# and from include/config/auto.conf.cmd to detect the compiler upgrade.\nCC_VERSION_TEXT = $(subst $(pound),,$(shell LC_ALL=C $(CC) --version 2>/dev/null | head -n 1))\n\nifneq ($(findstring clang,$(CC_VERSION_TEXT)),)\ninclude $(srctree)/scripts/Makefile.clang\nendif\n\n# Include this also for config targets because some architectures need\n# cc-cross-prefix to determine CROSS_COMPILE.\nifdef need-compiler\ninclude $(srctree)/scripts/Makefile.compiler\nendif\n\nifdef config-build\n# ===========================================================================\n# *config targets only - make sure prerequisites are updated, and descend\n# in scripts/kconfig to make the *config target\n\n# Read arch specific Makefile to set KBUILD_DEFCONFIG as needed.\n# KBUILD_DEFCONFIG may point out an alternative default configuration\n# used for 'make defconfig'\ninclude $(srctree)/arch/$(SRCARCH)/Makefile\nexport KBUILD_DEFCONFIG KBUILD_KCONFIG CC_VERSION_TEXT\n\nconfig: outputmakefile scripts_basic FORCE\n\t$(Q)$(MAKE) $(build)=scripts/kconfig $@\n\n%config: outputmakefile scripts_basic FORCE\n\t$(Q)$(MAKE) $(build)=scripts/kconfig $@\n\nelse #!config-build\n# ===========================================================================\n# Build targets only - this includes vmlinux, arch specific targets, clean\n# targets and others. In general all targets except *config targets.\n\n# If building an external module we do not care about the all: rule\n# but instead __all depend on modules\nPHONY += all\nifeq ($(KBUILD_EXTMOD),)\n__all: all\nelse\n__all: modules\nendif\n\ntargets :=\n\n# Decide whether to build built-in, modular, or both.\n# Normally, just do built-in.\n\nKBUILD_MODULES :=\nKBUILD_BUILTIN := 1\n\n# If we have only \"make modules\", don't compile built-in objects.\nifeq ($(MAKECMDGOALS),modules)\n  KBUILD_BUILTIN :=\nendif\n\n# If we have \"make <whatever> modules\", compile modules\n# in addition to whatever we do anyway.\n# Just \"make\" or \"make all\" shall build modules as well\n\nifneq ($(filter all modules nsdeps %compile_commands.json clang-%,$(MAKECMDGOALS)),)\n  KBUILD_MODULES := 1\nendif\n\nifeq ($(MAKECMDGOALS),)\n  KBUILD_MODULES := 1\nendif\n\nexport KBUILD_MODULES KBUILD_BUILTIN\n\nifdef need-config\ninclude include/config/auto.conf\nendif\n\nifeq ($(KBUILD_EXTMOD),)\n# Objects we will link into vmlinux / subdirs we need to visit\ncore-y\t\t:=\ndrivers-y\t:=\nlibs-y\t\t:= lib/\nendif # KBUILD_EXTMOD\n\n# The all: target is the default when no target is given on the\n# command line.\n# This allow a user to issue only 'make' to build a kernel including modules\n# Defaults to vmlinux, but the arch makefile usually adds further targets\nall: vmlinux\n\nCFLAGS_GCOV\t:= -fprofile-arcs -ftest-coverage\nifdef CONFIG_CC_IS_GCC\nCFLAGS_GCOV\t+= -fno-tree-loop-im\nendif\nexport CFLAGS_GCOV\n\n# The arch Makefiles can override CC_FLAGS_FTRACE. We may also append it later.\nifdef CONFIG_FUNCTION_TRACER\n  CC_FLAGS_FTRACE := -pg\nendif\n\ninclude $(srctree)/arch/$(SRCARCH)/Makefile\n\nifdef need-config\nifdef may-sync-config\n# Read in dependencies to all Kconfig* files, make sure to run syncconfig if\n# changes are detected. This should be included after arch/$(SRCARCH)/Makefile\n# because some architectures define CROSS_COMPILE there.\ninclude include/config/auto.conf.cmd\n\n$(KCONFIG_CONFIG):\n\t@echo >&2 '***'\n\t@echo >&2 '*** Configuration file \"$@\" not found!'\n\t@echo >&2 '***'\n\t@echo >&2 '*** Please run some configurator (e.g. \"make oldconfig\" or'\n\t@echo >&2 '*** \"make menuconfig\" or \"make xconfig\").'\n\t@echo >&2 '***'\n\t@/bin/false\n\n# The actual configuration files used during the build are stored in\n# include/generated/ and include/config/. Update them if .config is newer than\n# include/config/auto.conf (which mirrors .config).\n#\n# This exploits the 'multi-target pattern rule' trick.\n# The syncconfig should be executed only once to make all the targets.\n# (Note: use the grouped target '&:' when we bump to GNU Make 4.3)\n#\n# Do not use $(call cmd,...) here. That would suppress prompts from syncconfig,\n# so you cannot notice that Kconfig is waiting for the user input.\n%/config/auto.conf %/config/auto.conf.cmd %/generated/autoconf.h %/generated/rustc_cfg: $(KCONFIG_CONFIG)\n\t$(Q)$(kecho) \"  SYNC    $@\"\n\t$(Q)$(MAKE) -f $(srctree)/Makefile syncconfig\nelse # !may-sync-config\n# External modules and some install targets need include/generated/autoconf.h\n# and include/config/auto.conf but do not care if they are up-to-date.\n# Use auto.conf to trigger the test\nPHONY += include/config/auto.conf\n\ninclude/config/auto.conf:\n\t@test -e include/generated/autoconf.h -a -e $@ || (\t\t\\\n\techo >&2;\t\t\t\t\t\t\t\\\n\techo >&2 \"  ERROR: Kernel configuration is invalid.\";\t\t\\\n\techo >&2 \"         include/generated/autoconf.h or $@ are missing.\";\\\n\techo >&2 \"         Run 'make oldconfig && make prepare' on kernel src to fix it.\";\t\\\n\techo >&2 ;\t\t\t\t\t\t\t\\\n\t/bin/false)\n\nendif # may-sync-config\nendif # need-config\n\nKBUILD_CFLAGS\t+= -fno-delete-null-pointer-checks\n\nifdef CONFIG_CC_OPTIMIZE_FOR_PERFORMANCE\nKBUILD_CFLAGS += -O2\nKBUILD_RUSTFLAGS += -Copt-level=2\nelse ifdef CONFIG_CC_OPTIMIZE_FOR_SIZE\nKBUILD_CFLAGS += -Os\nKBUILD_RUSTFLAGS += -Copt-level=s\nendif\n\n# Always set `debug-assertions` and `overflow-checks` because their default\n# depends on `opt-level` and `debug-assertions`, respectively.\nKBUILD_RUSTFLAGS += -Cdebug-assertions=$(if $(CONFIG_RUST_DEBUG_ASSERTIONS),y,n)\nKBUILD_RUSTFLAGS += -Coverflow-checks=$(if $(CONFIG_RUST_OVERFLOW_CHECKS),y,n)\n\n# Tell gcc to never replace conditional load with a non-conditional one\nifdef CONFIG_CC_IS_GCC\n# gcc-10 renamed --param=allow-store-data-races=0 to\n# -fno-allow-store-data-races.\nKBUILD_CFLAGS\t+= $(call cc-option,--param=allow-store-data-races=0)\nKBUILD_CFLAGS\t+= $(call cc-option,-fno-allow-store-data-races)\nendif\n\nifdef CONFIG_READABLE_ASM\n# Disable optimizations that make assembler listings hard to read.\n# reorder blocks reorders the control in the function\n# ipa clone creates specialized cloned functions\n# partial inlining inlines only parts of functions\nKBUILD_CFLAGS += -fno-reorder-blocks -fno-ipa-cp-clone -fno-partial-inlining\nendif\n\nstackp-flags-y                                    := -fno-stack-protector\nstackp-flags-$(CONFIG_STACKPROTECTOR)             := -fstack-protector\nstackp-flags-$(CONFIG_STACKPROTECTOR_STRONG)      := -fstack-protector-strong\n\nKBUILD_CFLAGS += $(stackp-flags-y)\n\nKBUILD_RUSTFLAGS-$(CONFIG_WERROR) += -Dwarnings\nKBUILD_RUSTFLAGS += $(KBUILD_RUSTFLAGS-y)\n\nifdef CONFIG_FRAME_POINTER\nKBUILD_CFLAGS\t+= -fno-omit-frame-pointer -fno-optimize-sibling-calls\nKBUILD_RUSTFLAGS += -Cforce-frame-pointers=y\nelse\n# Some targets (ARM with Thumb2, for example), can't be built with frame\n# pointers.  For those, we don't have FUNCTION_TRACER automatically\n# select FRAME_POINTER.  However, FUNCTION_TRACER adds -pg, and this is\n# incompatible with -fomit-frame-pointer with current GCC, so we don't use\n# -fomit-frame-pointer with FUNCTION_TRACER.\n# In the Rust target specification, \"frame-pointer\" is set explicitly\n# to \"may-omit\".\nifndef CONFIG_FUNCTION_TRACER\nKBUILD_CFLAGS\t+= -fomit-frame-pointer\nendif\nendif\n\n# Initialize all stack variables with a 0xAA pattern.\nifdef CONFIG_INIT_STACK_ALL_PATTERN\nKBUILD_CFLAGS\t+= -ftrivial-auto-var-init=pattern\nendif\n\n# Initialize all stack variables with a zero value.\nifdef CONFIG_INIT_STACK_ALL_ZERO\nKBUILD_CFLAGS\t+= -ftrivial-auto-var-init=zero\nifdef CONFIG_CC_HAS_AUTO_VAR_INIT_ZERO_ENABLER\n# https://github.com/llvm/llvm-project/issues/44842\nCC_AUTO_VAR_INIT_ZERO_ENABLER := -enable-trivial-auto-var-init-zero-knowing-it-will-be-removed-from-clang\nexport CC_AUTO_VAR_INIT_ZERO_ENABLER\nKBUILD_CFLAGS\t+= $(CC_AUTO_VAR_INIT_ZERO_ENABLER)\nendif\nendif\n\n# While VLAs have been removed, GCC produces unreachable stack probes\n# for the randomize_kstack_offset feature. Disable it for all compilers.\nKBUILD_CFLAGS\t+= $(call cc-option, -fno-stack-clash-protection)\n\n# Clear used registers at func exit (to reduce data lifetime and ROP gadgets).\nifdef CONFIG_ZERO_CALL_USED_REGS\nKBUILD_CFLAGS\t+= -fzero-call-used-regs=used-gpr\nendif\n\nifdef CONFIG_FUNCTION_TRACER\nifdef CONFIG_FTRACE_MCOUNT_USE_CC\n  CC_FLAGS_FTRACE\t+= -mrecord-mcount\n  ifdef CONFIG_HAVE_NOP_MCOUNT\n    ifeq ($(call cc-option-yn, -mnop-mcount),y)\n      CC_FLAGS_FTRACE\t+= -mnop-mcount\n      CC_FLAGS_USING\t+= -DCC_USING_NOP_MCOUNT\n    endif\n  endif\nendif\nifdef CONFIG_FTRACE_MCOUNT_USE_OBJTOOL\n  ifdef CONFIG_HAVE_OBJTOOL_NOP_MCOUNT\n    CC_FLAGS_USING\t+= -DCC_USING_NOP_MCOUNT\n  endif\nendif\nifdef CONFIG_FTRACE_MCOUNT_USE_RECORDMCOUNT\n  ifdef CONFIG_HAVE_C_RECORDMCOUNT\n    BUILD_C_RECORDMCOUNT := y\n    export BUILD_C_RECORDMCOUNT\n  endif\nendif\nifdef CONFIG_HAVE_FENTRY\n  # s390-linux-gnu-gcc did not support -mfentry until gcc-9.\n  ifeq ($(call cc-option-yn, -mfentry),y)\n    CC_FLAGS_FTRACE\t+= -mfentry\n    CC_FLAGS_USING\t+= -DCC_USING_FENTRY\n  endif\nendif\nexport CC_FLAGS_FTRACE\nKBUILD_CFLAGS\t+= $(CC_FLAGS_FTRACE) $(CC_FLAGS_USING)\nKBUILD_AFLAGS\t+= $(CC_FLAGS_USING)\nendif\n\n# We trigger additional mismatches with less inlining\nifdef CONFIG_DEBUG_SECTION_MISMATCH\nKBUILD_CFLAGS += -fno-inline-functions-called-once\nendif\n\n# `rustc`'s `-Zfunction-sections` applies to data too (as of 1.59.0).\nifdef CONFIG_LD_DEAD_CODE_DATA_ELIMINATION\nKBUILD_CFLAGS_KERNEL += -ffunction-sections -fdata-sections\nKBUILD_RUSTFLAGS_KERNEL += -Zfunction-sections=y\nLDFLAGS_vmlinux += --gc-sections\nendif\n\nifdef CONFIG_SHADOW_CALL_STACK\nifndef CONFIG_DYNAMIC_SCS\nCC_FLAGS_SCS\t:= -fsanitize=shadow-call-stack\nKBUILD_CFLAGS\t+= $(CC_FLAGS_SCS)\nendif\nexport CC_FLAGS_SCS\nendif\n\nifdef CONFIG_LTO_CLANG\nifdef CONFIG_LTO_CLANG_THIN\nCC_FLAGS_LTO\t:= -flto=thin -fsplit-lto-unit\nKBUILD_LDFLAGS\t+= --thinlto-cache-dir=$(extmod_prefix).thinlto-cache\nelse\nCC_FLAGS_LTO\t:= -flto\nendif\nCC_FLAGS_LTO\t+= -fvisibility=hidden\n\n# Limit inlining across translation units to reduce binary size\nKBUILD_LDFLAGS += -mllvm -import-instr-limit=5\n\n# Check for frame size exceeding threshold during prolog/epilog insertion\n# when using lld < 13.0.0.\nifneq ($(CONFIG_FRAME_WARN),0)\nifeq ($(call test-lt, $(CONFIG_LLD_VERSION), 130000),y)\nKBUILD_LDFLAGS\t+= -plugin-opt=-warn-stack-size=$(CONFIG_FRAME_WARN)\nendif\nendif\nendif\n\nifdef CONFIG_LTO\nKBUILD_CFLAGS\t+= -fno-lto $(CC_FLAGS_LTO)\nKBUILD_AFLAGS\t+= -fno-lto\nexport CC_FLAGS_LTO\nendif\n\nifdef CONFIG_CFI_CLANG\nCC_FLAGS_CFI\t:= -fsanitize=kcfi\nKBUILD_CFLAGS\t+= $(CC_FLAGS_CFI)\nexport CC_FLAGS_CFI\nendif\n\nifneq ($(CONFIG_FUNCTION_ALIGNMENT),0)\nKBUILD_CFLAGS += -falign-functions=$(CONFIG_FUNCTION_ALIGNMENT)\nendif\n\n# arch Makefile may override CC so keep this after arch Makefile is included\nNOSTDINC_FLAGS += -nostdinc\n\n# To gain proper coverage for CONFIG_UBSAN_BOUNDS and CONFIG_FORTIFY_SOURCE,\n# the kernel uses only C99 flexible arrays for dynamically sized trailing\n# arrays. Enforce this for everything that may examine structure sizes and\n# perform bounds checking.\nKBUILD_CFLAGS += $(call cc-option, -fstrict-flex-arrays=3)\n\n# disable invalid \"can't wrap\" optimizations for signed / pointers\nKBUILD_CFLAGS\t+= -fno-strict-overflow\n\n# Make sure -fstack-check isn't enabled (like gentoo apparently did)\nKBUILD_CFLAGS  += -fno-stack-check\n\n# conserve stack if available\nifdef CONFIG_CC_IS_GCC\nKBUILD_CFLAGS   += -fconserve-stack\nendif\n\n# change __FILE__ to the relative path from the srctree\nKBUILD_CPPFLAGS += $(call cc-option,-fmacro-prefix-map=$(srctree)/=)\n\n# include additional Makefiles when needed\ninclude-y\t\t\t:= scripts/Makefile.extrawarn\ninclude-$(CONFIG_DEBUG_INFO)\t+= scripts/Makefile.debug\ninclude-$(CONFIG_KASAN)\t\t+= scripts/Makefile.kasan\ninclude-$(CONFIG_KCSAN)\t\t+= scripts/Makefile.kcsan\ninclude-$(CONFIG_KMSAN)\t\t+= scripts/Makefile.kmsan\ninclude-$(CONFIG_UBSAN)\t\t+= scripts/Makefile.ubsan\ninclude-$(CONFIG_KCOV)\t\t+= scripts/Makefile.kcov\ninclude-$(CONFIG_RANDSTRUCT)\t+= scripts/Makefile.randstruct\ninclude-$(CONFIG_GCC_PLUGINS)\t+= scripts/Makefile.gcc-plugins\n\ninclude $(addprefix $(srctree)/, $(include-y))\n\n# scripts/Makefile.gcc-plugins is intentionally included last.\n# Do not add $(call cc-option,...) below this line. When you build the kernel\n# from the clean source tree, the GCC plugins do not exist at this point.\n\n# Add user supplied CPPFLAGS, AFLAGS, CFLAGS and RUSTFLAGS as the last assignments\nKBUILD_CPPFLAGS += $(KCPPFLAGS)\nKBUILD_AFLAGS   += $(KAFLAGS)\nKBUILD_CFLAGS   += $(KCFLAGS)\nKBUILD_RUSTFLAGS += $(KRUSTFLAGS)\n\nKBUILD_LDFLAGS_MODULE += --build-id=sha1\nLDFLAGS_vmlinux += --build-id=sha1\n\nKBUILD_LDFLAGS\t+= -z noexecstack\nifeq ($(CONFIG_LD_IS_BFD),y)\nKBUILD_LDFLAGS\t+= $(call ld-option,--no-warn-rwx-segments)\nendif\n\nifeq ($(CONFIG_STRIP_ASM_SYMS),y)\nLDFLAGS_vmlinux\t+= -X\nendif\n\nifeq ($(CONFIG_RELR),y)\n# ld.lld before 15 did not support -z pack-relative-relocs.\nLDFLAGS_vmlinux\t+= $(call ld-option,--pack-dyn-relocs=relr,-z pack-relative-relocs)\nendif\n\n# We never want expected sections to be placed heuristically by the\n# linker. All sections should be explicitly named in the linker script.\nifdef CONFIG_LD_ORPHAN_WARN\nLDFLAGS_vmlinux += --orphan-handling=$(CONFIG_LD_ORPHAN_WARN_LEVEL)\nendif\n\n# Align the bit size of userspace programs with the kernel\nKBUILD_USERCFLAGS  += $(filter -m32 -m64 --target=%, $(KBUILD_CFLAGS))\nKBUILD_USERLDFLAGS += $(filter -m32 -m64 --target=%, $(KBUILD_CFLAGS))\n\n# make the checker run with the right architecture\nCHECKFLAGS += --arch=$(ARCH)\n\n# insure the checker run with the right endianness\nCHECKFLAGS += $(if $(CONFIG_CPU_BIG_ENDIAN),-mbig-endian,-mlittle-endian)\n\n# the checker needs the correct machine size\nCHECKFLAGS += $(if $(CONFIG_64BIT),-m64,-m32)\n\n# Default kernel image to build when no specific target is given.\n# KBUILD_IMAGE may be overruled on the command line or\n# set in the environment\n# Also any assignments in arch/$(ARCH)/Makefile take precedence over\n# this default value\nexport KBUILD_IMAGE ?= vmlinux\n\n#\n# INSTALL_PATH specifies where to place the updated kernel and system map\n# images. Default is /boot, but you can set it to other values\nexport\tINSTALL_PATH ?= /boot\n\n#\n# INSTALL_DTBS_PATH specifies a prefix for relocations required by build roots.\n# Like INSTALL_MOD_PATH, it isn't defined in the Makefile, but can be passed as\n# an argument if needed. Otherwise it defaults to the kernel install path\n#\nexport INSTALL_DTBS_PATH ?= $(INSTALL_PATH)/dtbs/$(KERNELRELEASE)\n\n#\n# INSTALL_MOD_PATH specifies a prefix to MODLIB for module directory\n# relocations required by build roots.  This is not defined in the\n# makefile but the argument can be passed to make if needed.\n#\n\nMODLIB\t= $(INSTALL_MOD_PATH)/lib/modules/$(KERNELRELEASE)\nexport MODLIB\n\nPHONY += prepare0\n\nexport extmod_prefix = $(if $(KBUILD_EXTMOD),$(KBUILD_EXTMOD)/)\nexport MODORDER := $(extmod_prefix)modules.order\nexport MODULES_NSDEPS := $(extmod_prefix)modules.nsdeps\n\nifeq ($(KBUILD_EXTMOD),)\n\nbuild-dir\t:= .\nclean-dirs\t:= $(sort . Documentation \\\n\t\t     $(patsubst %/,%,$(filter %/, $(core-) \\\n\t\t\t$(drivers-) $(libs-))))\n\nexport ARCH_CORE\t:= $(core-y)\nexport ARCH_LIB\t\t:= $(filter %/, $(libs-y))\nexport ARCH_DRIVERS\t:= $(drivers-y) $(drivers-m)\n# Externally visible symbols (used by link-vmlinux.sh)\n\nKBUILD_VMLINUX_OBJS := ./built-in.a\nifdef CONFIG_MODULES\nKBUILD_VMLINUX_OBJS += $(patsubst %/, %/lib.a, $(filter %/, $(libs-y)))\nKBUILD_VMLINUX_LIBS := $(filter-out %/, $(libs-y))\nelse\nKBUILD_VMLINUX_LIBS := $(patsubst %/,%/lib.a, $(libs-y))\nendif\n\nexport KBUILD_VMLINUX_LIBS\nexport KBUILD_LDS          := arch/$(SRCARCH)/kernel/vmlinux.lds\n\nifdef CONFIG_TRIM_UNUSED_KSYMS\n# For the kernel to actually contain only the needed exported symbols,\n# we have to build modules as well to determine what those symbols are.\nKBUILD_MODULES := 1\nendif\n\n# '$(AR) mPi' needs 'T' to workaround the bug of llvm-ar <= 14\nquiet_cmd_ar_vmlinux.a = AR      $@\n      cmd_ar_vmlinux.a = \\\n\trm -f $@; \\\n\t$(AR) cDPrST $@ $(KBUILD_VMLINUX_OBJS); \\\n\t$(AR) mPiT $$($(AR) t $@ | sed -n 1p) $@ $$($(AR) t $@ | grep -F -f $(srctree)/scripts/head-object-list.txt)\n\ntargets += vmlinux.a\nvmlinux.a: $(KBUILD_VMLINUX_OBJS) scripts/head-object-list.txt FORCE\n\t$(call if_changed,ar_vmlinux.a)\n\nPHONY += vmlinux_o\nvmlinux_o: vmlinux.a $(KBUILD_VMLINUX_LIBS)\n\t$(Q)$(MAKE) -f $(srctree)/scripts/Makefile.vmlinux_o\n\nvmlinux.o modules.builtin.modinfo modules.builtin: vmlinux_o\n\t@:\n\nPHONY += vmlinux\n# LDFLAGS_vmlinux in the top Makefile defines linker flags for the top vmlinux,\n# not for decompressors. LDFLAGS_vmlinux in arch/*/boot/compressed/Makefile is\n# unrelated; the decompressors just happen to have the same base name,\n# arch/*/boot/compressed/vmlinux.\n# Export LDFLAGS_vmlinux only to scripts/Makefile.vmlinux.\n#\n# _LDFLAGS_vmlinux is a workaround for the 'private export' bug:\n#   https://savannah.gnu.org/bugs/?61463\n# For Make > 4.4, the following simple code will work:\n#  vmlinux: private export LDFLAGS_vmlinux := $(LDFLAGS_vmlinux)\nvmlinux: private _LDFLAGS_vmlinux := $(LDFLAGS_vmlinux)\nvmlinux: export LDFLAGS_vmlinux = $(_LDFLAGS_vmlinux)\nvmlinux: vmlinux.o $(KBUILD_LDS) modpost\n\t$(Q)$(MAKE) -f $(srctree)/scripts/Makefile.vmlinux\n\n# The actual objects are generated when descending,\n# make sure no implicit rule kicks in\n$(sort $(KBUILD_LDS) $(KBUILD_VMLINUX_OBJS) $(KBUILD_VMLINUX_LIBS)): . ;\n\nifeq ($(origin KERNELRELEASE),file)\nfilechk_kernel.release = $(srctree)/scripts/setlocalversion $(srctree)\nelse\nfilechk_kernel.release = echo $(KERNELRELEASE)\nendif\n\n# Store (new) KERNELRELEASE string in include/config/kernel.release\ninclude/config/kernel.release: FORCE\n\t$(call filechk,kernel.release)\n\n# Additional helpers built in scripts/\n# Carefully list dependencies so we do not try to build scripts twice\n# in parallel\nPHONY += scripts\nscripts: scripts_basic scripts_dtc\n\t$(Q)$(MAKE) $(build)=$(@)\n\n# Things we need to do before we recursively start building the kernel\n# or the modules are listed in \"prepare\".\n# A multi level approach is used. prepareN is processed before prepareN-1.\n# archprepare is used in arch Makefiles and when processed asm symlink,\n# version.h and scripts_basic is processed / created.\n\nPHONY += prepare archprepare\n\narchprepare: outputmakefile archheaders archscripts scripts include/config/kernel.release \\\n\tasm-generic $(version_h) include/generated/utsrelease.h \\\n\tinclude/generated/compile.h include/generated/autoconf.h remove-stale-files\n\nprepare0: archprepare\n\t$(Q)$(MAKE) $(build)=scripts/mod\n\t$(Q)$(MAKE) $(build)=. prepare\n\n# All the preparing..\nprepare: prepare0\nifdef CONFIG_RUST\n\t$(Q)$(CONFIG_SHELL) $(srctree)/scripts/rust_is_available.sh\n\t$(Q)$(MAKE) $(build)=rust\nendif\n\nPHONY += remove-stale-files\nremove-stale-files:\n\t$(Q)$(srctree)/scripts/remove-stale-files\n\n# Support for using generic headers in asm-generic\nasm-generic := -f $(srctree)/scripts/Makefile.asm-generic obj\n\nPHONY += asm-generic uapi-asm-generic\nasm-generic: uapi-asm-generic\n\t$(Q)$(MAKE) $(asm-generic)=arch/$(SRCARCH)/include/generated/asm \\\n\tgeneric=include/asm-generic\nuapi-asm-generic:\n\t$(Q)$(MAKE) $(asm-generic)=arch/$(SRCARCH)/include/generated/uapi/asm \\\n\tgeneric=include/uapi/asm-generic\n\n# Generate some files\n# ---------------------------------------------------------------------------\n\n# KERNELRELEASE can change from a few different places, meaning version.h\n# needs to be updated, so this check is forced on all builds\n\nuts_len := 64\ndefine filechk_utsrelease.h\n\tif [ `echo -n \"$(KERNELRELEASE)\" | wc -c ` -gt $(uts_len) ]; then \\\n\t  echo '\"$(KERNELRELEASE)\" exceeds $(uts_len) characters' >&2;    \\\n\t  exit 1;                                                         \\\n\tfi;                                                               \\\n\techo \\#define UTS_RELEASE \\\"$(KERNELRELEASE)\\\"\nendef\n\ndefine filechk_version.h\n\tif [ $(SUBLEVEL) -gt 255 ]; then                                 \\\n\t\techo \\#define LINUX_VERSION_CODE $(shell                 \\\n\t\texpr $(VERSION) \\* 65536 + $(PATCHLEVEL) \\* 256 + 255); \\\n\telse                                                             \\\n\t\techo \\#define LINUX_VERSION_CODE $(shell                 \\\n\t\texpr $(VERSION) \\* 65536 + $(PATCHLEVEL) \\* 256 + $(SUBLEVEL)); \\\n\tfi;                                                              \\\n\techo '#define KERNEL_VERSION(a,b,c) (((a) << 16) + ((b) << 8) +  \\\n\t((c) > 255 ? 255 : (c)))';                                       \\\n\techo \\#define LINUX_VERSION_MAJOR $(VERSION);                    \\\n\techo \\#define LINUX_VERSION_PATCHLEVEL $(PATCHLEVEL);            \\\n\techo \\#define LINUX_VERSION_SUBLEVEL $(SUBLEVEL)\nendef\n\n$(version_h): PATCHLEVEL := $(or $(PATCHLEVEL), 0)\n$(version_h): SUBLEVEL := $(or $(SUBLEVEL), 0)\n$(version_h): FORCE\n\t$(call filechk,version.h)\n\ninclude/generated/utsrelease.h: include/config/kernel.release FORCE\n\t$(call filechk,utsrelease.h)\n\nfilechk_compile.h = $(srctree)/scripts/mkcompile_h \\\n\t\"$(UTS_MACHINE)\" \"$(CONFIG_CC_VERSION_TEXT)\" \"$(LD)\"\n\ninclude/generated/compile.h: FORCE\n\t$(call filechk,compile.h)\n\nPHONY += headerdep\nheaderdep:\n\t$(Q)find $(srctree)/include/ -name '*.h' | xargs --max-args 1 \\\n\t$(srctree)/scripts/headerdep.pl -I$(srctree)/include\n\n# ---------------------------------------------------------------------------\n# Kernel headers\n\n#Default location for installed headers\nexport INSTALL_HDR_PATH = $(objtree)/usr\n\nquiet_cmd_headers_install = INSTALL $(INSTALL_HDR_PATH)/include\n      cmd_headers_install = \\\n\tmkdir -p $(INSTALL_HDR_PATH); \\\n\trsync -mrl --include='*/' --include='*\\.h' --exclude='*' \\\n\tusr/include $(INSTALL_HDR_PATH)\n\nPHONY += headers_install\nheaders_install: headers\n\t$(call cmd,headers_install)\n\nPHONY += archheaders archscripts\n\nhdr-inst := -f $(srctree)/scripts/Makefile.headersinst obj\n\nPHONY += headers\nheaders: $(version_h) scripts_unifdef uapi-asm-generic archheaders archscripts\n\t$(if $(filter um, $(SRCARCH)), $(error Headers not exportable for UML))\n\t$(Q)$(MAKE) $(hdr-inst)=include/uapi\n\t$(Q)$(MAKE) $(hdr-inst)=arch/$(SRCARCH)/include/uapi\n\nifdef CONFIG_HEADERS_INSTALL\nprepare: headers\nendif\n\nPHONY += scripts_unifdef\nscripts_unifdef: scripts_basic\n\t$(Q)$(MAKE) $(build)=scripts scripts/unifdef\n\n# ---------------------------------------------------------------------------\n# Install\n\n# Many distributions have the custom install script, /sbin/installkernel.\n# If DKMS is installed, 'make install' will eventually recurse back\n# to this Makefile to build and install external modules.\n# Cancel sub_make_done so that options such as M=, V=, etc. are parsed.\n\nquiet_cmd_install = INSTALL $(INSTALL_PATH)\n      cmd_install = unset sub_make_done; $(srctree)/scripts/install.sh\n\n# ---------------------------------------------------------------------------\n# Tools\n\nifdef CONFIG_OBJTOOL\nprepare: tools/objtool\nendif\n\nifdef CONFIG_BPF\nifdef CONFIG_DEBUG_INFO_BTF\nprepare: tools/bpf/resolve_btfids\nendif\nendif\n\nPHONY += resolve_btfids_clean\n\nresolve_btfids_O = $(abspath $(objtree))/tools/bpf/resolve_btfids\n\n# tools/bpf/resolve_btfids directory might not exist\n# in output directory, skip its clean in that case\nresolve_btfids_clean:\nifneq ($(wildcard $(resolve_btfids_O)),)\n\t$(Q)$(MAKE) -sC $(srctree)/tools/bpf/resolve_btfids O=$(resolve_btfids_O) clean\nendif\n\n# Clear a bunch of variables before executing the submake\nifeq ($(quiet),silent_)\ntools_silent=s\nendif\n\ntools/: FORCE\n\t$(Q)mkdir -p $(objtree)/tools\n\t$(Q)$(MAKE) LDFLAGS= MAKEFLAGS=\"$(tools_silent) $(filter --j% -j,$(MAKEFLAGS))\" O=$(abspath $(objtree)) subdir=tools -C $(srctree)/tools/\n\ntools/%: FORCE\n\t$(Q)mkdir -p $(objtree)/tools\n\t$(Q)$(MAKE) LDFLAGS= MAKEFLAGS=\"$(tools_silent) $(filter --j% -j,$(MAKEFLAGS))\" O=$(abspath $(objtree)) subdir=tools -C $(srctree)/tools/ $*\n\n# ---------------------------------------------------------------------------\n# Kernel selftest\n\nPHONY += kselftest\nkselftest: headers\n\t$(Q)$(MAKE) -C $(srctree)/tools/testing/selftests run_tests\n\nkselftest-%: headers FORCE\n\t$(Q)$(MAKE) -C $(srctree)/tools/testing/selftests $*\n\nPHONY += kselftest-merge\nkselftest-merge:\n\t$(if $(wildcard $(objtree)/.config),, $(error No .config exists, config your kernel first!))\n\t$(Q)find $(srctree)/tools/testing/selftests -name config | \\\n\t\txargs $(srctree)/scripts/kconfig/merge_config.sh -m $(objtree)/.config\n\t$(Q)$(MAKE) -f $(srctree)/Makefile olddefconfig\n\n# ---------------------------------------------------------------------------\n# Devicetree files\n\nifneq ($(wildcard $(srctree)/arch/$(SRCARCH)/boot/dts/),)\ndtstree := arch/$(SRCARCH)/boot/dts\nendif\n\nifneq ($(dtstree),)\n\n%.dtb: dtbs_prepare\n\t$(Q)$(MAKE) $(build)=$(dtstree) $(dtstree)/$@\n\n%.dtbo: dtbs_prepare\n\t$(Q)$(MAKE) $(build)=$(dtstree) $(dtstree)/$@\n\nPHONY += dtbs dtbs_prepare dtbs_install dtbs_check\ndtbs: dtbs_prepare\n\t$(Q)$(MAKE) $(build)=$(dtstree)\n\n# include/config/kernel.release is actually needed when installing DTBs because\n# INSTALL_DTBS_PATH contains $(KERNELRELEASE). However, we do not want to make\n# dtbs_install depend on it as dtbs_install may run as root.\ndtbs_prepare: include/config/kernel.release scripts_dtc\n\nifneq ($(filter dtbs_check, $(MAKECMDGOALS)),)\nexport CHECK_DTBS=y\nendif\n\nifneq ($(CHECK_DTBS),)\ndtbs_prepare: dt_binding_check\nendif\n\ndtbs_check: dtbs\n\ndtbs_install:\n\t$(Q)$(MAKE) $(dtbinst)=$(dtstree) dst=$(INSTALL_DTBS_PATH)\n\nifdef CONFIG_OF_EARLY_FLATTREE\nall: dtbs\nendif\n\nendif\n\nPHONY += scripts_dtc\nscripts_dtc: scripts_basic\n\t$(Q)$(MAKE) $(build)=scripts/dtc\n\nifneq ($(filter dt_binding_check, $(MAKECMDGOALS)),)\nexport CHECK_DT_BINDING=y\nendif\n\nPHONY += dt_binding_check\ndt_binding_check: scripts_dtc\n\t$(Q)$(MAKE) $(build)=Documentation/devicetree/bindings\n\nPHONY += dt_compatible_check\ndt_compatible_check: dt_binding_check\n\t$(Q)$(MAKE) $(build)=Documentation/devicetree/bindings $@\n\n# ---------------------------------------------------------------------------\n# Modules\n\nifdef CONFIG_MODULES\n\n# By default, build modules as well\n\nall: modules\n\n# When we're building modules with modversions, we need to consider\n# the built-in objects during the descend as well, in order to\n# make sure the checksums are up to date before we record them.\nifdef CONFIG_MODVERSIONS\n  KBUILD_BUILTIN := 1\nendif\n\n# Build modules\n#\n\n# *.ko are usually independent of vmlinux, but CONFIG_DEBUG_INFO_BTF_MODULES\n# is an exception.\nifdef CONFIG_DEBUG_INFO_BTF_MODULES\nKBUILD_BUILTIN := 1\nmodules: vmlinux\nendif\n\nmodules: modules_prepare\n\n# Target to prepare building external modules\nmodules_prepare: prepare\n\t$(Q)$(MAKE) $(build)=scripts scripts/module.lds\n\nendif # CONFIG_MODULES\n\n###\n# Cleaning is done on three levels.\n# make clean     Delete most generated files\n#                Leave enough to build external modules\n# make mrproper  Delete the current configuration, and all generated files\n# make distclean Remove editor backup files, patch leftover files and the like\n\n# Directories & files removed with 'make clean'\nCLEAN_FILES += vmlinux.symvers modules-only.symvers \\\n\t       modules.builtin modules.builtin.modinfo modules.nsdeps \\\n\t       compile_commands.json .thinlto-cache rust/test \\\n\t       rust-project.json .vmlinux.objs .vmlinux.export.c\n\n# Directories & files removed with 'make mrproper'\nMRPROPER_FILES += include/config include/generated          \\\n\t\t  arch/$(SRCARCH)/include/generated .objdiff \\\n\t\t  debian snap tar-install \\\n\t\t  .config .config.old .version \\\n\t\t  Module.symvers \\\n\t\t  certs/signing_key.pem \\\n\t\t  certs/x509.genkey \\\n\t\t  vmlinux-gdb.py \\\n\t\t  kernel.spec rpmbuild \\\n\t\t  rust/libmacros.so\n\n# clean - Delete most, but leave enough to build external modules\n#\nclean: rm-files := $(CLEAN_FILES)\n\nPHONY += archclean vmlinuxclean\n\nvmlinuxclean:\n\t$(Q)$(CONFIG_SHELL) $(srctree)/scripts/link-vmlinux.sh clean\n\t$(Q)$(if $(ARCH_POSTLINK), $(MAKE) -f $(ARCH_POSTLINK) clean)\n\nclean: archclean vmlinuxclean resolve_btfids_clean\n\n# mrproper - Delete all generated files, including .config\n#\nmrproper: rm-files := $(wildcard $(MRPROPER_FILES))\nmrproper-dirs      := $(addprefix _mrproper_,scripts)\n\nPHONY += $(mrproper-dirs) mrproper\n$(mrproper-dirs):\n\t$(Q)$(MAKE) $(clean)=$(patsubst _mrproper_%,%,$@)\n\nmrproper: clean $(mrproper-dirs)\n\t$(call cmd,rmfiles)\n\t@find . $(RCS_FIND_IGNORE) \\\n\t\t\\( -name '*.rmeta' \\) \\\n\t\t-type f -print | xargs rm -f\n\n# distclean\n#\nPHONY += distclean\n\ndistclean: mrproper\n\t@find . $(RCS_FIND_IGNORE) \\\n\t\t\\( -name '*.orig' -o -name '*.rej' -o -name '*~' \\\n\t\t-o -name '*.bak' -o -name '#*#' -o -name '*%' \\\n\t\t-o -name 'core' -o -name tags -o -name TAGS -o -name 'cscope*' \\\n\t\t-o -name GPATH -o -name GRTAGS -o -name GSYMS -o -name GTAGS \\) \\\n\t\t-type f -print | xargs rm -f\n\n\n# Packaging of the kernel to various formats\n# ---------------------------------------------------------------------------\n\n%src-pkg: FORCE\n\t$(Q)$(MAKE) -f $(srctree)/scripts/Makefile.package $@\n%pkg: include/config/kernel.release FORCE\n\t$(Q)$(MAKE) -f $(srctree)/scripts/Makefile.package $@\n\n# Brief documentation of the typical targets used\n# ---------------------------------------------------------------------------\n\nboards := $(wildcard $(srctree)/arch/$(SRCARCH)/configs/*_defconfig)\nboards := $(sort $(notdir $(boards)))\nboard-dirs := $(dir $(wildcard $(srctree)/arch/$(SRCARCH)/configs/*/*_defconfig))\nboard-dirs := $(sort $(notdir $(board-dirs:/=)))\n\nPHONY += help\nhelp:\n\t@echo  'Cleaning targets:'\n\t@echo  '  clean\t\t  - Remove most generated files but keep the config and'\n\t@echo  '                    enough build support to build external modules'\n\t@echo  '  mrproper\t  - Remove all generated files + config + various backup files'\n\t@echo  '  distclean\t  - mrproper + remove editor backup and patch files'\n\t@echo  ''\n\t@$(MAKE) -f $(srctree)/scripts/kconfig/Makefile help\n\t@echo  ''\n\t@echo  'Other generic targets:'\n\t@echo  '  all\t\t  - Build all targets marked with [*]'\n\t@echo  '* vmlinux\t  - Build the bare kernel'\n\t@echo  '* modules\t  - Build all modules'\n\t@echo  '  modules_install - Install all modules to INSTALL_MOD_PATH (default: /)'\n\t@echo  '  dir/            - Build all files in dir and below'\n\t@echo  '  dir/file.[ois]  - Build specified target only'\n\t@echo  '  dir/file.ll     - Build the LLVM assembly file'\n\t@echo  '                    (requires compiler support for LLVM assembly generation)'\n\t@echo  '  dir/file.lst    - Build specified mixed source/assembly target only'\n\t@echo  '                    (requires a recent binutils and recent build (System.map))'\n\t@echo  '  dir/file.ko     - Build module including final link'\n\t@echo  '  modules_prepare - Set up for building external modules'\n\t@echo  '  tags/TAGS\t  - Generate tags file for editors'\n\t@echo  '  cscope\t  - Generate cscope index'\n\t@echo  '  gtags           - Generate GNU GLOBAL index'\n\t@echo  '  kernelrelease\t  - Output the release version string (use with make -s)'\n\t@echo  '  kernelversion\t  - Output the version stored in Makefile (use with make -s)'\n\t@echo  '  image_name\t  - Output the image name (use with make -s)'\n\t@echo  '  headers_install - Install sanitised kernel headers to INSTALL_HDR_PATH'; \\\n\t echo  '                    (default: $(INSTALL_HDR_PATH))'; \\\n\t echo  ''\n\t@echo  'Static analysers:'\n\t@echo  '  checkstack      - Generate a list of stack hogs'\n\t@echo  '  versioncheck    - Sanity check on version.h usage'\n\t@echo  '  includecheck    - Check for duplicate included header files'\n\t@echo  '  export_report   - List the usages of all exported symbols'\n\t@echo  '  headerdep       - Detect inclusion cycles in headers'\n\t@echo  '  coccicheck      - Check with Coccinelle'\n\t@echo  '  clang-analyzer  - Check with clang static analyzer'\n\t@echo  '  clang-tidy      - Check with clang-tidy'\n\t@echo  ''\n\t@echo  'Tools:'\n\t@echo  '  nsdeps          - Generate missing symbol namespace dependencies'\n\t@echo  ''\n\t@echo  'Kernel selftest:'\n\t@echo  '  kselftest         - Build and run kernel selftest'\n\t@echo  '                      Build, install, and boot kernel before'\n\t@echo  '                      running kselftest on it'\n\t@echo  '                      Run as root for full coverage'\n\t@echo  '  kselftest-all     - Build kernel selftest'\n\t@echo  '  kselftest-install - Build and install kernel selftest'\n\t@echo  '  kselftest-clean   - Remove all generated kselftest files'\n\t@echo  '  kselftest-merge   - Merge all the config dependencies of'\n\t@echo  '\t\t      kselftest to existing .config.'\n\t@echo  ''\n\t@echo  'Rust targets:'\n\t@echo  '  rustavailable   - Checks whether the Rust toolchain is'\n\t@echo  '\t\t    available and, if not, explains why.'\n\t@echo  '  rustfmt\t  - Reformat all the Rust code in the kernel'\n\t@echo  '  rustfmtcheck\t  - Checks if all the Rust code in the kernel'\n\t@echo  '\t\t    is formatted, printing a diff otherwise.'\n\t@echo  '  rustdoc\t  - Generate Rust documentation'\n\t@echo  '\t\t    (requires kernel .config)'\n\t@echo  '  rusttest        - Runs the Rust tests'\n\t@echo  '                    (requires kernel .config; downloads external repos)'\n\t@echo  '  rust-analyzer\t  - Generate rust-project.json rust-analyzer support file'\n\t@echo  '\t\t    (requires kernel .config)'\n\t@echo  '  dir/file.[os]   - Build specified target only'\n\t@echo  '  dir/file.rsi    - Build macro expanded source, similar to C preprocessing.'\n\t@echo  '                    Run with RUSTFMT=n to skip reformatting if needed.'\n\t@echo  '                    The output is not intended to be compilable.'\n\t@echo  '  dir/file.ll     - Build the LLVM assembly file'\n\t@echo  ''\n\t@$(if $(dtstree), \\\n\t\techo 'Devicetree:'; \\\n\t\techo '* dtbs             - Build device tree blobs for enabled boards'; \\\n\t\techo '  dtbs_install     - Install dtbs to $(INSTALL_DTBS_PATH)'; \\\n\t\techo '  dt_binding_check - Validate device tree binding documents'; \\\n\t\techo '  dtbs_check       - Validate device tree source files';\\\n\t\techo '')\n\n\t@echo 'Userspace tools targets:'\n\t@echo '  use \"make tools/help\"'\n\t@echo '  or  \"cd tools; make help\"'\n\t@echo  ''\n\t@echo  'Kernel packaging:'\n\t@$(MAKE) -f $(srctree)/scripts/Makefile.package help\n\t@echo  ''\n\t@echo  'Documentation targets:'\n\t@$(MAKE) -f $(srctree)/Documentation/Makefile dochelp\n\t@echo  ''\n\t@echo  'Architecture specific targets ($(SRCARCH)):'\n\t@$(or $(archhelp),\\\n\t\techo '  No architecture specific help defined for $(SRCARCH)')\n\t@echo  ''\n\t@$(if $(boards), \\\n\t\t$(foreach b, $(boards), \\\n\t\tprintf \"  %-27s - Build for %s\\\\n\" $(b) $(subst _defconfig,,$(b));) \\\n\t\techo '')\n\t@$(if $(board-dirs), \\\n\t\t$(foreach b, $(board-dirs), \\\n\t\tprintf \"  %-16s - Show %s-specific targets\\\\n\" help-$(b) $(b);) \\\n\t\tprintf \"  %-16s - Show all of the above\\\\n\" help-boards; \\\n\t\techo '')\n\n\t@echo  '  make V=n   [targets] 1: verbose build'\n\t@echo  '                       2: give reason for rebuild of target'\n\t@echo  '                       V=1 and V=2 can be combined with V=12'\n\t@echo  '  make O=dir [targets] Locate all output files in \"dir\", including .config'\n\t@echo  '  make C=1   [targets] Check re-compiled c source with $$CHECK'\n\t@echo  '                       (sparse by default)'\n\t@echo  '  make C=2   [targets] Force check of all c source with $$CHECK'\n\t@echo  '  make RECORDMCOUNT_WARN=1 [targets] Warn about ignored mcount sections'\n\t@echo  '  make W=n   [targets] Enable extra build checks, n=1,2,3 where'\n\t@echo  '\t\t1: warnings which may be relevant and do not occur too often'\n\t@echo  '\t\t2: warnings which occur quite often but may still be relevant'\n\t@echo  '\t\t3: more obscure warnings, can most likely be ignored'\n\t@echo  '\t\te: warnings are being treated as errors'\n\t@echo  '\t\tMultiple levels can be combined with W=12 or W=123'\n\t@$(if $(dtstree), \\\n\t\techo '  make CHECK_DTBS=1 [targets] Check all generated dtb files against schema'; \\\n\t\techo '         This can be applied both to \"dtbs\" and to individual \"foo.dtb\" targets' ; \\\n\t\t)\n\t@echo  ''\n\t@echo  'Execute \"make\" or \"make all\" to build all targets marked with [*] '\n\t@echo  'For further info see the ./README file'\n\n\nhelp-board-dirs := $(addprefix help-,$(board-dirs))\n\nhelp-boards: $(help-board-dirs)\n\nboards-per-dir = $(sort $(notdir $(wildcard $(srctree)/arch/$(SRCARCH)/configs/$*/*_defconfig)))\n\n$(help-board-dirs): help-%:\n\t@echo  'Architecture specific targets ($(SRCARCH) $*):'\n\t@$(if $(boards-per-dir), \\\n\t\t$(foreach b, $(boards-per-dir), \\\n\t\tprintf \"  %-24s - Build for %s\\\\n\" $*/$(b) $(subst _defconfig,,$(b));) \\\n\t\techo '')\n\n\n# Documentation targets\n# ---------------------------------------------------------------------------\nDOC_TARGETS := xmldocs latexdocs pdfdocs htmldocs epubdocs cleandocs \\\n\t       linkcheckdocs dochelp refcheckdocs texinfodocs infodocs\nPHONY += $(DOC_TARGETS)\n$(DOC_TARGETS):\n\t$(Q)$(MAKE) $(build)=Documentation $@\n\n\n# Rust targets\n# ---------------------------------------------------------------------------\n\n# \"Is Rust available?\" target\nPHONY += rustavailable\nrustavailable:\n\t$(Q)$(CONFIG_SHELL) $(srctree)/scripts/rust_is_available.sh && echo \"Rust is available!\"\n\n# Documentation target\n#\n# Using the singular to avoid running afoul of `no-dot-config-targets`.\nPHONY += rustdoc\nrustdoc: prepare\n\t$(Q)$(MAKE) $(build)=rust $@\n\n# Testing target\nPHONY += rusttest\nrusttest: prepare\n\t$(Q)$(MAKE) $(build)=rust $@\n\n# Formatting targets\nPHONY += rustfmt rustfmtcheck\n\n# We skip `rust/alloc` since we want to minimize the diff w.r.t. upstream.\n#\n# We match using absolute paths since `find` does not resolve them\n# when matching, which is a problem when e.g. `srctree` is `..`.\n# We `grep` afterwards in order to remove the directory entry itself.\nrustfmt:\n\t$(Q)find $(abs_srctree) -type f -name '*.rs' \\\n\t\t-o -path $(abs_srctree)/rust/alloc -prune \\\n\t\t-o -path $(abs_objtree)/rust/test -prune \\\n\t\t| grep -Fv $(abs_srctree)/rust/alloc \\\n\t\t| grep -Fv $(abs_objtree)/rust/test \\\n\t\t| grep -Fv generated \\\n\t\t| xargs $(RUSTFMT) $(rustfmt_flags)\n\nrustfmtcheck: rustfmt_flags = --check\nrustfmtcheck: rustfmt\n\n# Misc\n# ---------------------------------------------------------------------------\n\nPHONY += misc-check\nmisc-check:\n\t$(Q)$(srctree)/scripts/misc-check\n\nall: misc-check\n\nPHONY += scripts_gdb\nscripts_gdb: prepare0\n\t$(Q)$(MAKE) $(build)=scripts/gdb\n\t$(Q)ln -fsn $(abspath $(srctree)/scripts/gdb/vmlinux-gdb.py)\n\nifdef CONFIG_GDB_SCRIPTS\nall: scripts_gdb\nendif\n\nelse # KBUILD_EXTMOD\n\nfilechk_kernel.release = echo $(KERNELRELEASE)\n\n###\n# External module support.\n# When building external modules the kernel used as basis is considered\n# read-only, and no consistency checks are made and the make\n# system is not used on the basis kernel. If updates are required\n# in the basis kernel ordinary make commands (without M=...) must be used.\n\n# We are always building only modules.\nKBUILD_BUILTIN :=\nKBUILD_MODULES := 1\n\nbuild-dir := $(KBUILD_EXTMOD)\n\ncompile_commands.json: $(extmod_prefix)compile_commands.json\nPHONY += compile_commands.json\n\nclean-dirs := $(KBUILD_EXTMOD)\nclean: rm-files := $(KBUILD_EXTMOD)/Module.symvers $(KBUILD_EXTMOD)/modules.nsdeps \\\n\t$(KBUILD_EXTMOD)/compile_commands.json $(KBUILD_EXTMOD)/.thinlto-cache\n\nPHONY += prepare\n# now expand this into a simple variable to reduce the cost of shell evaluations\nprepare: CC_VERSION_TEXT := $(CC_VERSION_TEXT)\nprepare:\n\t@if [ \"$(CC_VERSION_TEXT)\" != \"$(CONFIG_CC_VERSION_TEXT)\" ]; then \\\n\t\techo >&2 \"warning: the compiler differs from the one used to build the kernel\"; \\\n\t\techo >&2 \"  The kernel was built by: $(CONFIG_CC_VERSION_TEXT)\"; \\\n\t\techo >&2 \"  You are using:           $(CC_VERSION_TEXT)\"; \\\n\tfi\n\nPHONY += help\nhelp:\n\t@echo  '  Building external modules.'\n\t@echo  '  Syntax: make -C path/to/kernel/src M=$$PWD target'\n\t@echo  ''\n\t@echo  '  modules         - default target, build the module(s)'\n\t@echo  '  modules_install - install the module'\n\t@echo  '  clean           - remove generated files in module directory only'\n\t@echo  '  rust-analyzer\t  - generate rust-project.json rust-analyzer support file'\n\t@echo  ''\n\nifndef CONFIG_MODULES\nmodules modules_install: __external_modules_error\n__external_modules_error:\n\t@echo >&2 '***'\n\t@echo >&2 '*** The present kernel disabled CONFIG_MODULES.'\n\t@echo >&2 '*** You cannot build or install external modules.'\n\t@echo >&2 '***'\n\t@false\nendif\n\nendif # KBUILD_EXTMOD\n\n# ---------------------------------------------------------------------------\n# Modules\n\nPHONY += modules modules_install modules_sign modules_prepare\n\nmodules_install:\n\t$(Q)$(MAKE) -f $(srctree)/scripts/Makefile.modinst \\\n\tsign-only=$(if $(filter modules_install,$(MAKECMDGOALS)),,y)\n\nifeq ($(CONFIG_MODULE_SIG),y)\n# modules_sign is a subset of modules_install.\n# 'make modules_install modules_sign' is equivalent to 'make modules_install'.\nmodules_sign: modules_install\n\t@:\nelse\nmodules_sign:\n\t@echo >&2 '***'\n\t@echo >&2 '*** CONFIG_MODULE_SIG is disabled. You cannot sign modules.'\n\t@echo >&2 '***'\n\t@false\nendif\n\nifdef CONFIG_MODULES\n\n$(MODORDER): $(build-dir)\n\t@:\n\n# KBUILD_MODPOST_NOFINAL can be set to skip the final link of modules.\n# This is solely useful to speed up test compiles.\nmodules: modpost\nifneq ($(KBUILD_MODPOST_NOFINAL),1)\n\t$(Q)$(MAKE) -f $(srctree)/scripts/Makefile.modfinal\nendif\n\nPHONY += modules_check\nmodules_check: $(MODORDER)\n\t$(Q)$(CONFIG_SHELL) $(srctree)/scripts/modules-check.sh $<\n\nelse # CONFIG_MODULES\n\nmodules:\n\t@:\n\nKBUILD_MODULES :=\n\nendif # CONFIG_MODULES\n\nPHONY += modpost\nmodpost: $(if $(single-build),, $(if $(KBUILD_BUILTIN), vmlinux.o)) \\\n\t $(if $(KBUILD_MODULES), modules_check)\n\t$(Q)$(MAKE) -f $(srctree)/scripts/Makefile.modpost\n\n# Single targets\n# ---------------------------------------------------------------------------\n# To build individual files in subdirectories, you can do like this:\n#\n#   make foo/bar/baz.s\n#\n# The supported suffixes for single-target are listed in 'single-targets'\n#\n# To build only under specific subdirectories, you can do like this:\n#\n#   make foo/bar/baz/\n\nifdef single-build\n\n# .ko is special because modpost is needed\nsingle-ko := $(sort $(filter %.ko, $(MAKECMDGOALS)))\nsingle-no-ko := $(filter-out $(single-ko), $(MAKECMDGOALS)) \\\n\t\t$(foreach x, o mod, $(patsubst %.ko, %.$x, $(single-ko)))\n\n$(single-ko): single_modules\n\t@:\n$(single-no-ko): $(build-dir)\n\t@:\n\n# Remove MODORDER when done because it is not the real one.\nPHONY += single_modules\nsingle_modules: $(single-no-ko) modules_prepare\n\t$(Q){ $(foreach m, $(single-ko), echo $(extmod_prefix)$(m:%.ko=%.o);) } > $(MODORDER)\n\t$(Q)$(MAKE) -f $(srctree)/scripts/Makefile.modpost\nifneq ($(KBUILD_MODPOST_NOFINAL),1)\n\t$(Q)$(MAKE) -f $(srctree)/scripts/Makefile.modfinal\nendif\n\t$(Q)rm -f $(MODORDER)\n\nsingle-goals := $(addprefix $(build-dir)/, $(single-no-ko))\n\nKBUILD_MODULES := 1\n\nendif\n\n# Preset locale variables to speed up the build process. Limit locale\n# tweaks to this spot to avoid wrong language settings when running\n# make menuconfig etc.\n# Error messages still appears in the original language\nPHONY += $(build-dir)\n$(build-dir): prepare\n\t$(Q)$(MAKE) $(build)=$@ need-builtin=1 need-modorder=1 $(single-goals)\n\nclean-dirs := $(addprefix _clean_, $(clean-dirs))\nPHONY += $(clean-dirs) clean\n$(clean-dirs):\n\t$(Q)$(MAKE) $(clean)=$(patsubst _clean_%,%,$@)\n\nclean: $(clean-dirs)\n\t$(call cmd,rmfiles)\n\t@find $(or $(KBUILD_EXTMOD), .) $(RCS_FIND_IGNORE) \\\n\t\t\\( -name '*.[aios]' -o -name '*.rsi' -o -name '*.ko' -o -name '.*.cmd' \\\n\t\t-o -name '*.ko.*' \\\n\t\t-o -name '*.dtb' -o -name '*.dtbo' \\\n\t\t-o -name '*.dtb.S' -o -name '*.dtbo.S' \\\n\t\t-o -name '*.dt.yaml' \\\n\t\t-o -name '*.dwo' -o -name '*.lst' \\\n\t\t-o -name '*.su' -o -name '*.mod' \\\n\t\t-o -name '.*.d' -o -name '.*.tmp' -o -name '*.mod.c' \\\n\t\t-o -name '*.lex.c' -o -name '*.tab.[ch]' \\\n\t\t-o -name '*.asn1.[ch]' \\\n\t\t-o -name '*.symtypes' -o -name 'modules.order' \\\n\t\t-o -name '*.c.[012]*.*' \\\n\t\t-o -name '*.ll' \\\n\t\t-o -name '*.gcno' \\\n\t\t-o -name '*.*.symversions' \\) -type f -print \\\n\t\t-o -name '.tmp_*' -print \\\n\t\t| xargs rm -rf\n\n# Generate tags for editors\n# ---------------------------------------------------------------------------\nquiet_cmd_tags = GEN     $@\n      cmd_tags = $(BASH) $(srctree)/scripts/tags.sh $@\n\ntags TAGS cscope gtags: FORCE\n\t$(call cmd,tags)\n\n# IDE support targets\nPHONY += rust-analyzer\nrust-analyzer:\n\t$(Q)$(MAKE) $(build)=rust $@\n\n# Script to generate missing namespace dependencies\n# ---------------------------------------------------------------------------\n\nPHONY += nsdeps\nnsdeps: export KBUILD_NSDEPS=1\nnsdeps: modules\n\t$(Q)$(CONFIG_SHELL) $(srctree)/scripts/nsdeps\n\n# Clang Tooling\n# ---------------------------------------------------------------------------\n\nquiet_cmd_gen_compile_commands = GEN     $@\n      cmd_gen_compile_commands = $(PYTHON3) $< -a $(AR) -o $@ $(filter-out $<, $(real-prereqs))\n\n$(extmod_prefix)compile_commands.json: scripts/clang-tools/gen_compile_commands.py \\\n\t$(if $(KBUILD_EXTMOD),, vmlinux.a $(KBUILD_VMLINUX_LIBS)) \\\n\t$(if $(CONFIG_MODULES), $(MODORDER)) FORCE\n\t$(call if_changed,gen_compile_commands)\n\ntargets += $(extmod_prefix)compile_commands.json\n\nPHONY += clang-tidy clang-analyzer\n\nifdef CONFIG_CC_IS_CLANG\nquiet_cmd_clang_tools = CHECK   $<\n      cmd_clang_tools = $(PYTHON3) $(srctree)/scripts/clang-tools/run-clang-tools.py $@ $<\n\nclang-tidy clang-analyzer: $(extmod_prefix)compile_commands.json\n\t$(call cmd,clang_tools)\nelse\nclang-tidy clang-analyzer:\n\t@echo \"$@ requires CC=clang\" >&2\n\t@false\nendif\n\n# Scripts to check various things for consistency\n# ---------------------------------------------------------------------------\n\nPHONY += includecheck versioncheck coccicheck export_report\n\nincludecheck:\n\tfind $(srctree)/* $(RCS_FIND_IGNORE) \\\n\t\t-name '*.[hcS]' -type f -print | sort \\\n\t\t| xargs $(PERL) -w $(srctree)/scripts/checkincludes.pl\n\nversioncheck:\n\tfind $(srctree)/* $(RCS_FIND_IGNORE) \\\n\t\t-name '*.[hcS]' -type f -print | sort \\\n\t\t| xargs $(PERL) -w $(srctree)/scripts/checkversion.pl\n\ncoccicheck:\n\t$(Q)$(BASH) $(srctree)/scripts/$@\n\nexport_report:\n\t$(PERL) $(srctree)/scripts/export_report.pl\n\nPHONY += checkstack kernelrelease kernelversion image_name\n\n# UML needs a little special treatment here.  It wants to use the host\n# toolchain, so needs $(SUBARCH) passed to checkstack.pl.  Everyone\n# else wants $(ARCH), including people doing cross-builds, which means\n# that $(SUBARCH) doesn't work here.\nifeq ($(ARCH), um)\nCHECKSTACK_ARCH := $(SUBARCH)\nelse\nCHECKSTACK_ARCH := $(ARCH)\nendif\ncheckstack:\n\t$(OBJDUMP) -d vmlinux $$(find . -name '*.ko') | \\\n\t$(PERL) $(srctree)/scripts/checkstack.pl $(CHECKSTACK_ARCH)\n\nkernelrelease:\n\t@$(filechk_kernel.release)\n\nkernelversion:\n\t@echo $(KERNELVERSION)\n\nimage_name:\n\t@echo $(KBUILD_IMAGE)\n\nPHONY += run-command\nrun-command:\n\t$(Q)$(KBUILD_RUN_COMMAND)\n\nquiet_cmd_rmfiles = $(if $(wildcard $(rm-files)),CLEAN   $(wildcard $(rm-files)))\n      cmd_rmfiles = rm -rf $(rm-files)\n\n# read saved command lines for existing targets\nexisting-targets := $(wildcard $(sort $(targets)))\n\n-include $(foreach f,$(existing-targets),$(dir $(f)).$(notdir $(f)).cmd)\n\nendif # config-build\nendif # mixed-build\nendif # need-sub-make\n\nPHONY += FORCE\nFORCE:\n\n# Declare the contents of the PHONY variable as phony.  We keep that\n# information in a variable so we can use it in if_changed and friends.\n.PHONY: $(PHONY)\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}