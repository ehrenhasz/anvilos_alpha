{
  "module_name": "opal_proto.h",
  "hash_id": "6c514f37aaa0039a6c858a7bb7db514767d0fc8d6bd77ec5529e6baadbe9b543",
  "original_prompt": "Ingested from linux-6.6.14/block/opal_proto.h",
  "human_readable_source": " \n \n#include <linux/types.h>\n\n#ifndef _OPAL_PROTO_H\n#define _OPAL_PROTO_H\n\n \nenum {\n\tTCG_SECP_00 = 0,\n\tTCG_SECP_01,\n};\n\n \nenum opal_response_token {\n\tOPAL_DTA_TOKENID_BYTESTRING = 0xe0,\n\tOPAL_DTA_TOKENID_SINT = 0xe1,\n\tOPAL_DTA_TOKENID_UINT = 0xe2,\n\tOPAL_DTA_TOKENID_TOKEN = 0xe3,  \n\tOPAL_DTA_TOKENID_INVALID = 0X0\n};\n\n#define DTAERROR_NO_METHOD_STATUS 0x89\n#define GENERIC_HOST_SESSION_NUM 0x41\n#define FIRST_TPER_SESSION_NUM\t4096\n\n#define TPER_SYNC_SUPPORTED 0x01\n \n#define LOCKING_SUPPORTED_MASK 0x01\n#define LOCKING_ENABLED_MASK 0x02\n#define LOCKED_MASK 0x04\n#define MBR_ENABLED_MASK 0x10\n#define MBR_DONE_MASK 0x20\n\n#define TINY_ATOM_DATA_MASK 0x3F\n#define TINY_ATOM_SIGNED 0x40\n\n#define SHORT_ATOM_ID 0x80\n#define SHORT_ATOM_BYTESTRING 0x20\n#define SHORT_ATOM_SIGNED 0x10\n#define SHORT_ATOM_LEN_MASK 0xF\n\n#define MEDIUM_ATOM_ID 0xC0\n#define MEDIUM_ATOM_BYTESTRING 0x10\n#define MEDIUM_ATOM_SIGNED 0x8\n#define MEDIUM_ATOM_LEN_MASK 0x7\n\n#define LONG_ATOM_ID 0xe0\n#define LONG_ATOM_BYTESTRING 0x2\n#define LONG_ATOM_SIGNED 0x1\n\n \n#define TINY_ATOM_BYTE   0x7F\n#define SHORT_ATOM_BYTE  0xBF\n#define MEDIUM_ATOM_BYTE 0xDF\n#define LONG_ATOM_BYTE   0xE3\n\n#define OPAL_INVAL_PARAM 12\n#define OPAL_MANUFACTURED_INACTIVE 0x08\n#define OPAL_DISCOVERY_COMID 0x0001\n\n#define LOCKING_RANGE_NON_GLOBAL 0x03\n \n#define OPAL_METHOD_LENGTH 8\n#define OPAL_MSID_KEYLEN 15\n#define OPAL_UID_LENGTH_HALF 4\n\n \n#define OPAL_BOOLEAN_AND 0\n#define OPAL_BOOLEAN_OR  1\n#define OPAL_BOOLEAN_NOT 2\n\n \nenum opal_uid {\n\t \n\tOPAL_SMUID_UID,\n\tOPAL_THISSP_UID,\n\tOPAL_ADMINSP_UID,\n\tOPAL_LOCKINGSP_UID,\n\tOPAL_ENTERPRISE_LOCKINGSP_UID,\n\tOPAL_ANYBODY_UID,\n\tOPAL_SID_UID,\n\tOPAL_ADMIN1_UID,\n\tOPAL_USER1_UID,\n\tOPAL_USER2_UID,\n\tOPAL_PSID_UID,\n\tOPAL_ENTERPRISE_BANDMASTER0_UID,\n\tOPAL_ENTERPRISE_ERASEMASTER_UID,\n\t \n\tOPAL_TABLE_TABLE,\n\tOPAL_LOCKINGRANGE_GLOBAL,\n\tOPAL_LOCKINGRANGE_ACE_START_TO_KEY,\n\tOPAL_LOCKINGRANGE_ACE_RDLOCKED,\n\tOPAL_LOCKINGRANGE_ACE_WRLOCKED,\n\tOPAL_MBRCONTROL,\n\tOPAL_MBR,\n\tOPAL_AUTHORITY_TABLE,\n\tOPAL_C_PIN_TABLE,\n\tOPAL_LOCKING_INFO_TABLE,\n\tOPAL_ENTERPRISE_LOCKING_INFO_TABLE,\n\tOPAL_DATASTORE,\n\t \n\tOPAL_C_PIN_MSID,\n\tOPAL_C_PIN_SID,\n\tOPAL_C_PIN_ADMIN1,\n\t \n\tOPAL_HALF_UID_AUTHORITY_OBJ_REF,\n\tOPAL_HALF_UID_BOOLEAN_ACE,\n\t \n\tOPAL_UID_HEXFF,\n};\n\n \nenum opal_method {\n\tOPAL_PROPERTIES,\n\tOPAL_STARTSESSION,\n\tOPAL_REVERT,\n\tOPAL_ACTIVATE,\n\tOPAL_EGET,\n\tOPAL_ESET,\n\tOPAL_NEXT,\n\tOPAL_EAUTHENTICATE,\n\tOPAL_GETACL,\n\tOPAL_GENKEY,\n\tOPAL_REVERTSP,\n\tOPAL_GET,\n\tOPAL_SET,\n\tOPAL_AUTHENTICATE,\n\tOPAL_RANDOM,\n\tOPAL_ERASE,\n};\n\nenum opal_token {\n\t \n\tOPAL_TRUE = 0x01,\n\tOPAL_FALSE = 0x00,\n\tOPAL_BOOLEAN_EXPR = 0x03,\n\t \n\tOPAL_TABLE = 0x00,\n\tOPAL_STARTROW = 0x01,\n\tOPAL_ENDROW = 0x02,\n\tOPAL_STARTCOLUMN = 0x03,\n\tOPAL_ENDCOLUMN = 0x04,\n\tOPAL_VALUES = 0x01,\n\t \n\tOPAL_TABLE_UID = 0x00,\n\tOPAL_TABLE_NAME = 0x01,\n\tOPAL_TABLE_COMMON = 0x02,\n\tOPAL_TABLE_TEMPLATE = 0x03,\n\tOPAL_TABLE_KIND = 0x04,\n\tOPAL_TABLE_COLUMN = 0x05,\n\tOPAL_TABLE_COLUMNS = 0x06,\n\tOPAL_TABLE_ROWS = 0x07,\n\tOPAL_TABLE_ROWS_FREE = 0x08,\n\tOPAL_TABLE_ROW_BYTES = 0x09,\n\tOPAL_TABLE_LASTID = 0x0A,\n\tOPAL_TABLE_MIN = 0x0B,\n\tOPAL_TABLE_MAX = 0x0C,\n\t \n\tOPAL_PIN = 0x03,\n\t \n\tOPAL_RANGESTART = 0x03,\n\tOPAL_RANGELENGTH = 0x04,\n\tOPAL_READLOCKENABLED = 0x05,\n\tOPAL_WRITELOCKENABLED = 0x06,\n\tOPAL_READLOCKED = 0x07,\n\tOPAL_WRITELOCKED = 0x08,\n\tOPAL_ACTIVEKEY = 0x0A,\n\t \n\tOPAL_LIFECYCLE = 0x06,\n\t \n\tOPAL_MAXRANGES = 0x04,\n\t \n\tOPAL_MBRENABLE = 0x01,\n\tOPAL_MBRDONE = 0x02,\n\t \n\tOPAL_HOSTPROPERTIES = 0x00,\n\t \n\tOPAL_STARTLIST = 0xf0,\n\tOPAL_ENDLIST = 0xf1,\n\tOPAL_STARTNAME = 0xf2,\n\tOPAL_ENDNAME = 0xf3,\n\tOPAL_CALL = 0xf8,\n\tOPAL_ENDOFDATA = 0xf9,\n\tOPAL_ENDOFSESSION = 0xfa,\n\tOPAL_STARTTRANSACTON = 0xfb,\n\tOPAL_ENDTRANSACTON = 0xfC,\n\tOPAL_EMPTYATOM = 0xff,\n\tOPAL_WHERE = 0x00,\n};\n\n \nenum opal_lockingstate {\n\tOPAL_LOCKING_READWRITE = 0x01,\n\tOPAL_LOCKING_READONLY = 0x02,\n\tOPAL_LOCKING_LOCKED = 0x03,\n};\n\nenum opal_parameter {\n\tOPAL_SUM_SET_LIST = 0x060000,\n};\n\nenum opal_revertlsp {\n\tOPAL_KEEP_GLOBAL_RANGE_KEY = 0x060000,\n};\n\n \n\n \nstruct opal_compacket {\n\t__be32 reserved0;\n\tu8 extendedComID[4];\n\t__be32 outstandingData;\n\t__be32 minTransfer;\n\t__be32 length;\n};\n\n \nstruct opal_packet {\n\t__be32 tsn;\n\t__be32 hsn;\n\t__be32 seq_number;\n\t__be16 reserved0;\n\t__be16 ack_type;\n\t__be32 acknowledgment;\n\t__be32 length;\n};\n\n \nstruct opal_data_subpacket {\n\tu8 reserved0[6];\n\t__be16 kind;\n\t__be32 length;\n};\n\n \nstruct opal_header {\n\tstruct opal_compacket cp;\n\tstruct opal_packet pkt;\n\tstruct opal_data_subpacket subpkt;\n};\n\n#define FC_TPER       0x0001\n#define FC_LOCKING    0x0002\n#define FC_GEOMETRY   0x0003\n#define FC_ENTERPRISE 0x0100\n#define FC_DATASTORE  0x0202\n#define FC_SINGLEUSER 0x0201\n#define FC_OPALV100   0x0200\n#define FC_OPALV200   0x0203\n\n \nstruct d0_header {\n\t__be32 length;  \n\t__be32 revision;  \n\t__be32 reserved01;\n\t__be32 reserved02;\n\t \n\tu8 ignored[32];\n};\n\n \nstruct d0_tper_features {\n\t \n\tu8 supported_features;\n\t \n\tu8 reserved01[3];\n\t__be32 reserved02;\n\t__be32 reserved03;\n};\n\n \nstruct d0_locking_features {\n\t \n\tu8 supported_features;\n\t \n\tu8 reserved01[3];\n\t__be32 reserved02;\n\t__be32 reserved03;\n};\n\n \nstruct d0_geometry_features {\n\t \n\tu8 header[4];\n\t \n\tu8 reserved01;\n\tu8 reserved02[7];\n\t__be32 logical_block_size;\n\t__be64 alignment_granularity;\n\t__be64 lowest_aligned_lba;\n};\n\n \nstruct d0_enterprise_ssc {\n\t__be16 baseComID;\n\t__be16 numComIDs;\n\t \n\tu8 range_crossing;\n\tu8 reserved01;\n\t__be16 reserved02;\n\t__be32 reserved03;\n\t__be32 reserved04;\n};\n\n \nstruct d0_opal_v100 {\n\t__be16 baseComID;\n\t__be16 numComIDs;\n};\n\n \nstruct d0_single_user_mode {\n\t__be32 num_locking_objects;\n\t \n\tu8 reserved01;\n\tu8 reserved02;\n\t__be16 reserved03;\n\t__be32 reserved04;\n};\n\n \nstruct d0_datastore_table {\n\t__be16 reserved01;\n\t__be16 max_tables;\n\t__be32 max_size_tables;\n\t__be32 table_size_alignment;\n};\n\n \nstruct d0_opal_v200 {\n\t__be16 baseComID;\n\t__be16 numComIDs;\n\t \n\tu8 range_crossing;\n\t \n\tu8 num_locking_admin_auth[2];\n\t \n\tu8 num_locking_user_auth[2];\n\tu8 initialPIN;\n\tu8 revertedPIN;\n\tu8 reserved01;\n\t__be32 reserved02;\n};\n\n \nstruct d0_features {\n\t__be16 code;\n\t \n\tu8 r_version;\n\tu8 length;\n\tu8 features[];\n};\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}