{
  "module_name": "elevator.h",
  "hash_id": "c2e573bc39b2305c9c97aa8ae3264ffc2e3b26236d4ede922c8c50ab600797dd",
  "original_prompt": "Ingested from linux-6.6.14/block/elevator.h",
  "human_readable_source": " \n#ifndef _ELEVATOR_H\n#define _ELEVATOR_H\n\n#include <linux/percpu.h>\n#include <linux/hashtable.h>\n#include \"blk-mq.h\"\n\nstruct io_cq;\nstruct elevator_type;\nstruct blk_mq_debugfs_attr;\n\n \nenum elv_merge {\n\tELEVATOR_NO_MERGE\t= 0,\n\tELEVATOR_FRONT_MERGE\t= 1,\n\tELEVATOR_BACK_MERGE\t= 2,\n\tELEVATOR_DISCARD_MERGE\t= 3,\n};\n\nstruct blk_mq_alloc_data;\nstruct blk_mq_hw_ctx;\n\nstruct elevator_mq_ops {\n\tint (*init_sched)(struct request_queue *, struct elevator_type *);\n\tvoid (*exit_sched)(struct elevator_queue *);\n\tint (*init_hctx)(struct blk_mq_hw_ctx *, unsigned int);\n\tvoid (*exit_hctx)(struct blk_mq_hw_ctx *, unsigned int);\n\tvoid (*depth_updated)(struct blk_mq_hw_ctx *);\n\n\tbool (*allow_merge)(struct request_queue *, struct request *, struct bio *);\n\tbool (*bio_merge)(struct request_queue *, struct bio *, unsigned int);\n\tint (*request_merge)(struct request_queue *q, struct request **, struct bio *);\n\tvoid (*request_merged)(struct request_queue *, struct request *, enum elv_merge);\n\tvoid (*requests_merged)(struct request_queue *, struct request *, struct request *);\n\tvoid (*limit_depth)(blk_opf_t, struct blk_mq_alloc_data *);\n\tvoid (*prepare_request)(struct request *);\n\tvoid (*finish_request)(struct request *);\n\tvoid (*insert_requests)(struct blk_mq_hw_ctx *hctx, struct list_head *list,\n\t\t\tblk_insert_t flags);\n\tstruct request *(*dispatch_request)(struct blk_mq_hw_ctx *);\n\tbool (*has_work)(struct blk_mq_hw_ctx *);\n\tvoid (*completed_request)(struct request *, u64);\n\tvoid (*requeue_request)(struct request *);\n\tstruct request *(*former_request)(struct request_queue *, struct request *);\n\tstruct request *(*next_request)(struct request_queue *, struct request *);\n\tvoid (*init_icq)(struct io_cq *);\n\tvoid (*exit_icq)(struct io_cq *);\n};\n\n#define ELV_NAME_MAX\t(16)\n\nstruct elv_fs_entry {\n\tstruct attribute attr;\n\tssize_t (*show)(struct elevator_queue *, char *);\n\tssize_t (*store)(struct elevator_queue *, const char *, size_t);\n};\n\n \nstruct elevator_type\n{\n\t \n\tstruct kmem_cache *icq_cache;\n\n\t \n\tstruct elevator_mq_ops ops;\n\n\tsize_t icq_size;\t \n\tsize_t icq_align;\t \n\tstruct elv_fs_entry *elevator_attrs;\n\tconst char *elevator_name;\n\tconst char *elevator_alias;\n\tconst unsigned int elevator_features;\n\tstruct module *elevator_owner;\n#ifdef CONFIG_BLK_DEBUG_FS\n\tconst struct blk_mq_debugfs_attr *queue_debugfs_attrs;\n\tconst struct blk_mq_debugfs_attr *hctx_debugfs_attrs;\n#endif\n\n\t \n\tchar icq_cache_name[ELV_NAME_MAX + 6];\t \n\tstruct list_head list;\n};\n\nstatic inline bool elevator_tryget(struct elevator_type *e)\n{\n\treturn try_module_get(e->elevator_owner);\n}\n\nstatic inline void __elevator_get(struct elevator_type *e)\n{\n\t__module_get(e->elevator_owner);\n}\n\nstatic inline void elevator_put(struct elevator_type *e)\n{\n\tmodule_put(e->elevator_owner);\n}\n\n#define ELV_HASH_BITS 6\n\nvoid elv_rqhash_del(struct request_queue *q, struct request *rq);\nvoid elv_rqhash_add(struct request_queue *q, struct request *rq);\nvoid elv_rqhash_reposition(struct request_queue *q, struct request *rq);\nstruct request *elv_rqhash_find(struct request_queue *q, sector_t offset);\n\n \nstruct elevator_queue\n{\n\tstruct elevator_type *type;\n\tvoid *elevator_data;\n\tstruct kobject kobj;\n\tstruct mutex sysfs_lock;\n\tunsigned long flags;\n\tDECLARE_HASHTABLE(hash, ELV_HASH_BITS);\n};\n\n#define ELEVATOR_FLAG_REGISTERED\t0\n#define ELEVATOR_FLAG_DISABLE_WBT\t1\n\n \nextern enum elv_merge elv_merge(struct request_queue *, struct request **,\n\t\tstruct bio *);\nextern void elv_merge_requests(struct request_queue *, struct request *,\n\t\t\t       struct request *);\nextern void elv_merged_request(struct request_queue *, struct request *,\n\t\tenum elv_merge);\nextern bool elv_attempt_insert_merge(struct request_queue *, struct request *,\n\t\t\t\t     struct list_head *);\nextern struct request *elv_former_request(struct request_queue *, struct request *);\nextern struct request *elv_latter_request(struct request_queue *, struct request *);\nvoid elevator_init_mq(struct request_queue *q);\n\n \nextern int elv_register(struct elevator_type *);\nextern void elv_unregister(struct elevator_type *);\n\n \nextern ssize_t elv_iosched_show(struct request_queue *, char *);\nextern ssize_t elv_iosched_store(struct request_queue *, const char *, size_t);\n\nextern bool elv_bio_merge_ok(struct request *, struct bio *);\nextern struct elevator_queue *elevator_alloc(struct request_queue *,\n\t\t\t\t\tstruct elevator_type *);\n\n \nextern struct request *elv_rb_former_request(struct request_queue *, struct request *);\nextern struct request *elv_rb_latter_request(struct request_queue *, struct request *);\n\n \nextern void elv_rb_add(struct rb_root *, struct request *);\nextern void elv_rb_del(struct rb_root *, struct request *);\nextern struct request *elv_rb_find(struct rb_root *, sector_t);\n\n \n#define ELEVATOR_INSERT_FRONT\t1\n#define ELEVATOR_INSERT_BACK\t2\n#define ELEVATOR_INSERT_SORT\t3\n#define ELEVATOR_INSERT_REQUEUE\t4\n#define ELEVATOR_INSERT_FLUSH\t5\n#define ELEVATOR_INSERT_SORT_MERGE\t6\n\n#define rb_entry_rq(node)\trb_entry((node), struct request, rb_node)\n\n#define rq_entry_fifo(ptr)\tlist_entry((ptr), struct request, queuelist)\n#define rq_fifo_clear(rq)\tlist_del_init(&(rq)->queuelist)\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}