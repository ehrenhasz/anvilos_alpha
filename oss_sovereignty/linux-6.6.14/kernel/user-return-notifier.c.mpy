{
  "module_name": "user-return-notifier.c",
  "hash_id": "7d811c1e2a0b03f4aa154a0d079e87f98a6db9eefd348c2991fb31fb068cc77e",
  "original_prompt": "Ingested from linux-6.6.14/kernel/user-return-notifier.c",
  "human_readable_source": "\n\n#include <linux/user-return-notifier.h>\n#include <linux/percpu.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n\nstatic DEFINE_PER_CPU(struct hlist_head, return_notifier_list);\n\n \nvoid user_return_notifier_register(struct user_return_notifier *urn)\n{\n\tset_tsk_thread_flag(current, TIF_USER_RETURN_NOTIFY);\n\thlist_add_head(&urn->link, this_cpu_ptr(&return_notifier_list));\n}\nEXPORT_SYMBOL_GPL(user_return_notifier_register);\n\n \nvoid user_return_notifier_unregister(struct user_return_notifier *urn)\n{\n\thlist_del(&urn->link);\n\tif (hlist_empty(this_cpu_ptr(&return_notifier_list)))\n\t\tclear_tsk_thread_flag(current, TIF_USER_RETURN_NOTIFY);\n}\nEXPORT_SYMBOL_GPL(user_return_notifier_unregister);\n\n \nvoid fire_user_return_notifiers(void)\n{\n\tstruct user_return_notifier *urn;\n\tstruct hlist_node *tmp2;\n\tstruct hlist_head *head;\n\n\thead = &get_cpu_var(return_notifier_list);\n\thlist_for_each_entry_safe(urn, tmp2, head, link)\n\t\turn->on_user_return(urn);\n\tput_cpu_var(return_notifier_list);\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}