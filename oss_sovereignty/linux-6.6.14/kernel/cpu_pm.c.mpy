{
  "module_name": "cpu_pm.c",
  "hash_id": "909a08a4ae8c590b0596e60c37f36f48becdd42e8aad1d88be749f8f02ea712b",
  "original_prompt": "Ingested from linux-6.6.14/kernel/cpu_pm.c",
  "human_readable_source": "\n \n\n#include <linux/kernel.h>\n#include <linux/cpu_pm.h>\n#include <linux/module.h>\n#include <linux/notifier.h>\n#include <linux/spinlock.h>\n#include <linux/syscore_ops.h>\n\n \nstatic struct {\n\tstruct raw_notifier_head chain;\n\traw_spinlock_t lock;\n} cpu_pm_notifier = {\n\t.chain = RAW_NOTIFIER_INIT(cpu_pm_notifier.chain),\n\t.lock  = __RAW_SPIN_LOCK_UNLOCKED(cpu_pm_notifier.lock),\n};\n\nstatic int cpu_pm_notify(enum cpu_pm_event event)\n{\n\tint ret;\n\n\trcu_read_lock();\n\tret = raw_notifier_call_chain(&cpu_pm_notifier.chain, event, NULL);\n\trcu_read_unlock();\n\n\treturn notifier_to_errno(ret);\n}\n\nstatic int cpu_pm_notify_robust(enum cpu_pm_event event_up, enum cpu_pm_event event_down)\n{\n\tunsigned long flags;\n\tint ret;\n\n\traw_spin_lock_irqsave(&cpu_pm_notifier.lock, flags);\n\tret = raw_notifier_call_chain_robust(&cpu_pm_notifier.chain, event_up, event_down, NULL);\n\traw_spin_unlock_irqrestore(&cpu_pm_notifier.lock, flags);\n\n\treturn notifier_to_errno(ret);\n}\n\n \nint cpu_pm_register_notifier(struct notifier_block *nb)\n{\n\tunsigned long flags;\n\tint ret;\n\n\traw_spin_lock_irqsave(&cpu_pm_notifier.lock, flags);\n\tret = raw_notifier_chain_register(&cpu_pm_notifier.chain, nb);\n\traw_spin_unlock_irqrestore(&cpu_pm_notifier.lock, flags);\n\treturn ret;\n}\nEXPORT_SYMBOL_GPL(cpu_pm_register_notifier);\n\n \nint cpu_pm_unregister_notifier(struct notifier_block *nb)\n{\n\tunsigned long flags;\n\tint ret;\n\n\traw_spin_lock_irqsave(&cpu_pm_notifier.lock, flags);\n\tret = raw_notifier_chain_unregister(&cpu_pm_notifier.chain, nb);\n\traw_spin_unlock_irqrestore(&cpu_pm_notifier.lock, flags);\n\treturn ret;\n}\nEXPORT_SYMBOL_GPL(cpu_pm_unregister_notifier);\n\n \nint cpu_pm_enter(void)\n{\n\treturn cpu_pm_notify_robust(CPU_PM_ENTER, CPU_PM_ENTER_FAILED);\n}\nEXPORT_SYMBOL_GPL(cpu_pm_enter);\n\n \nint cpu_pm_exit(void)\n{\n\treturn cpu_pm_notify(CPU_PM_EXIT);\n}\nEXPORT_SYMBOL_GPL(cpu_pm_exit);\n\n \nint cpu_cluster_pm_enter(void)\n{\n\treturn cpu_pm_notify_robust(CPU_CLUSTER_PM_ENTER, CPU_CLUSTER_PM_ENTER_FAILED);\n}\nEXPORT_SYMBOL_GPL(cpu_cluster_pm_enter);\n\n \nint cpu_cluster_pm_exit(void)\n{\n\treturn cpu_pm_notify(CPU_CLUSTER_PM_EXIT);\n}\nEXPORT_SYMBOL_GPL(cpu_cluster_pm_exit);\n\n#ifdef CONFIG_PM\nstatic int cpu_pm_suspend(void)\n{\n\tint ret;\n\n\tret = cpu_pm_enter();\n\tif (ret)\n\t\treturn ret;\n\n\tret = cpu_cluster_pm_enter();\n\treturn ret;\n}\n\nstatic void cpu_pm_resume(void)\n{\n\tcpu_cluster_pm_exit();\n\tcpu_pm_exit();\n}\n\nstatic struct syscore_ops cpu_pm_syscore_ops = {\n\t.suspend = cpu_pm_suspend,\n\t.resume = cpu_pm_resume,\n};\n\nstatic int cpu_pm_init(void)\n{\n\tregister_syscore_ops(&cpu_pm_syscore_ops);\n\treturn 0;\n}\ncore_initcall(cpu_pm_init);\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}