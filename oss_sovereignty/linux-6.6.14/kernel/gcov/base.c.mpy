{
  "module_name": "base.c",
  "hash_id": "bfec5063c5e51a7b76328da87a445a99573805f1a719c5e745d37efe22917544",
  "original_prompt": "Ingested from linux-6.6.14/kernel/gcov/base.c",
  "human_readable_source": "\n \n\n#define pr_fmt(fmt)\t\"gcov: \" fmt\n\n#include <linux/init.h>\n#include <linux/module.h>\n#include <linux/mutex.h>\n#include <linux/sched.h>\n#include \"gcov.h\"\n\nint gcov_events_enabled;\nDEFINE_MUTEX(gcov_lock);\n\n \nvoid gcov_enable_events(void)\n{\n\tstruct gcov_info *info = NULL;\n\n\tmutex_lock(&gcov_lock);\n\tgcov_events_enabled = 1;\n\n\t \n\twhile ((info = gcov_info_next(info))) {\n\t\tgcov_event(GCOV_ADD, info);\n\t\tcond_resched();\n\t}\n\n\tmutex_unlock(&gcov_lock);\n}\n\n \nsize_t store_gcov_u32(void *buffer, size_t off, u32 v)\n{\n\tu32 *data;\n\n\tif (buffer) {\n\t\tdata = buffer + off;\n\t\t*data = v;\n\t}\n\n\treturn sizeof(*data);\n}\n\n \nsize_t store_gcov_u64(void *buffer, size_t off, u64 v)\n{\n\tu32 *data;\n\n\tif (buffer) {\n\t\tdata = buffer + off;\n\n\t\tdata[0] = (v & 0xffffffffUL);\n\t\tdata[1] = (v >> 32);\n\t}\n\n\treturn sizeof(*data) * 2;\n}\n\n#ifdef CONFIG_MODULES\n \nstatic int gcov_module_notifier(struct notifier_block *nb, unsigned long event,\n\t\t\t\tvoid *data)\n{\n\tstruct module *mod = data;\n\tstruct gcov_info *info = NULL;\n\tstruct gcov_info *prev = NULL;\n\n\tif (event != MODULE_STATE_GOING)\n\t\treturn NOTIFY_OK;\n\tmutex_lock(&gcov_lock);\n\n\t \n\twhile ((info = gcov_info_next(info))) {\n\t\tif (gcov_info_within_module(info, mod)) {\n\t\t\tgcov_info_unlink(prev, info);\n\t\t\tif (gcov_events_enabled)\n\t\t\t\tgcov_event(GCOV_REMOVE, info);\n\t\t} else\n\t\t\tprev = info;\n\t}\n\n\tmutex_unlock(&gcov_lock);\n\n\treturn NOTIFY_OK;\n}\n\nstatic struct notifier_block gcov_nb = {\n\t.notifier_call\t= gcov_module_notifier,\n};\n\nstatic int __init gcov_init(void)\n{\n\treturn register_module_notifier(&gcov_nb);\n}\ndevice_initcall(gcov_init);\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}