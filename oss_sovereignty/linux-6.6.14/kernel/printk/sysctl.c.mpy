{
  "module_name": "sysctl.c",
  "hash_id": "721fbc2ceab08e96e813eead9c893c270e8dd2f91316dc7cd5c5af4bb344b6e3",
  "original_prompt": "Ingested from linux-6.6.14/kernel/printk/sysctl.c",
  "human_readable_source": "\n \n\n#include <linux/sysctl.h>\n#include <linux/printk.h>\n#include <linux/capability.h>\n#include <linux/ratelimit.h>\n#include \"internal.h\"\n\nstatic const int ten_thousand = 10000;\n\nstatic int proc_dointvec_minmax_sysadmin(struct ctl_table *table, int write,\n\t\t\t\tvoid *buffer, size_t *lenp, loff_t *ppos)\n{\n\tif (write && !capable(CAP_SYS_ADMIN))\n\t\treturn -EPERM;\n\n\treturn proc_dointvec_minmax(table, write, buffer, lenp, ppos);\n}\n\nstatic struct ctl_table printk_sysctls[] = {\n\t{\n\t\t.procname\t= \"printk\",\n\t\t.data\t\t= &console_loglevel,\n\t\t.maxlen\t\t= 4*sizeof(int),\n\t\t.mode\t\t= 0644,\n\t\t.proc_handler\t= proc_dointvec,\n\t},\n\t{\n\t\t.procname\t= \"printk_ratelimit\",\n\t\t.data\t\t= &printk_ratelimit_state.interval,\n\t\t.maxlen\t\t= sizeof(int),\n\t\t.mode\t\t= 0644,\n\t\t.proc_handler\t= proc_dointvec_jiffies,\n\t},\n\t{\n\t\t.procname\t= \"printk_ratelimit_burst\",\n\t\t.data\t\t= &printk_ratelimit_state.burst,\n\t\t.maxlen\t\t= sizeof(int),\n\t\t.mode\t\t= 0644,\n\t\t.proc_handler\t= proc_dointvec,\n\t},\n\t{\n\t\t.procname\t= \"printk_delay\",\n\t\t.data\t\t= &printk_delay_msec,\n\t\t.maxlen\t\t= sizeof(int),\n\t\t.mode\t\t= 0644,\n\t\t.proc_handler\t= proc_dointvec_minmax,\n\t\t.extra1\t\t= SYSCTL_ZERO,\n\t\t.extra2\t\t= (void *)&ten_thousand,\n\t},\n\t{\n\t\t.procname\t= \"printk_devkmsg\",\n\t\t.data\t\t= devkmsg_log_str,\n\t\t.maxlen\t\t= DEVKMSG_STR_MAX_SIZE,\n\t\t.mode\t\t= 0644,\n\t\t.proc_handler\t= devkmsg_sysctl_set_loglvl,\n\t},\n\t{\n\t\t.procname\t= \"dmesg_restrict\",\n\t\t.data\t\t= &dmesg_restrict,\n\t\t.maxlen\t\t= sizeof(int),\n\t\t.mode\t\t= 0644,\n\t\t.proc_handler\t= proc_dointvec_minmax_sysadmin,\n\t\t.extra1\t\t= SYSCTL_ZERO,\n\t\t.extra2\t\t= SYSCTL_ONE,\n\t},\n\t{\n\t\t.procname\t= \"kptr_restrict\",\n\t\t.data\t\t= &kptr_restrict,\n\t\t.maxlen\t\t= sizeof(int),\n\t\t.mode\t\t= 0644,\n\t\t.proc_handler\t= proc_dointvec_minmax_sysadmin,\n\t\t.extra1\t\t= SYSCTL_ZERO,\n\t\t.extra2\t\t= SYSCTL_TWO,\n\t},\n\t{}\n};\n\nvoid __init printk_sysctl_init(void)\n{\n\tregister_sysctl_init(\"kernel\", printk_sysctls);\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}