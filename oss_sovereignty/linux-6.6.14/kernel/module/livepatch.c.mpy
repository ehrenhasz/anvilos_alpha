{
  "module_name": "livepatch.c",
  "hash_id": "a11c4ff76b5684793e33dabd7c54a4d6061d81f580280f770f27a3c926ba08a3",
  "original_prompt": "Ingested from linux-6.6.14/kernel/module/livepatch.c",
  "human_readable_source": "\n \n\n#include <linux/module.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include \"internal.h\"\n\n \nint copy_module_elf(struct module *mod, struct load_info *info)\n{\n\tunsigned int size, symndx;\n\tint ret;\n\n\tsize = sizeof(*mod->klp_info);\n\tmod->klp_info = kmalloc(size, GFP_KERNEL);\n\tif (!mod->klp_info)\n\t\treturn -ENOMEM;\n\n\t \n\tsize = sizeof(mod->klp_info->hdr);\n\tmemcpy(&mod->klp_info->hdr, info->hdr, size);\n\n\t \n\tsize = sizeof(*info->sechdrs) * info->hdr->e_shnum;\n\tmod->klp_info->sechdrs = kmemdup(info->sechdrs, size, GFP_KERNEL);\n\tif (!mod->klp_info->sechdrs) {\n\t\tret = -ENOMEM;\n\t\tgoto free_info;\n\t}\n\n\t \n\tsize = info->sechdrs[info->hdr->e_shstrndx].sh_size;\n\tmod->klp_info->secstrings = kmemdup(info->secstrings, size, GFP_KERNEL);\n\tif (!mod->klp_info->secstrings) {\n\t\tret = -ENOMEM;\n\t\tgoto free_sechdrs;\n\t}\n\n\t \n\tsymndx = info->index.sym;\n\tmod->klp_info->symndx = symndx;\n\n\t \n\tmod->klp_info->sechdrs[symndx].sh_addr = (unsigned long)mod->core_kallsyms.symtab;\n\n\treturn 0;\n\nfree_sechdrs:\n\tkfree(mod->klp_info->sechdrs);\nfree_info:\n\tkfree(mod->klp_info);\n\treturn ret;\n}\n\nvoid free_module_elf(struct module *mod)\n{\n\tkfree(mod->klp_info->sechdrs);\n\tkfree(mod->klp_info->secstrings);\n\tkfree(mod->klp_info);\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}