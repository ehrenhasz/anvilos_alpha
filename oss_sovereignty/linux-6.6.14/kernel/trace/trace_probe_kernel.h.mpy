{
  "module_name": "trace_probe_kernel.h",
  "hash_id": "7056a3c7560176de2bdd02b3769ff40d372b5b5cf3fd942968a5e99fc67e2f1b",
  "original_prompt": "Ingested from linux-6.6.14/kernel/trace/trace_probe_kernel.h",
  "human_readable_source": " \n#ifndef __TRACE_PROBE_KERNEL_H_\n#define __TRACE_PROBE_KERNEL_H_\n\n \n \nstatic nokprobe_inline int\nfetch_store_strlen_user(unsigned long addr)\n{\n\tconst void __user *uaddr =  (__force const void __user *)addr;\n\n\treturn strnlen_user_nofault(uaddr, MAX_STRING_SIZE);\n}\n\n \nstatic nokprobe_inline int\nfetch_store_strlen(unsigned long addr)\n{\n\tint ret, len = 0;\n\tu8 c;\n\n#ifdef CONFIG_ARCH_HAS_NON_OVERLAPPING_ADDRESS_SPACE\n\tif (addr < TASK_SIZE)\n\t\treturn fetch_store_strlen_user(addr);\n#endif\n\n\tdo {\n\t\tret = copy_from_kernel_nofault(&c, (u8 *)addr + len, 1);\n\t\tlen++;\n\t} while (c && ret == 0 && len < MAX_STRING_SIZE);\n\n\treturn (ret < 0) ? ret : len;\n}\n\nstatic nokprobe_inline void set_data_loc(int ret, void *dest, void *__dest, void *base)\n{\n\tif (ret < 0)\n\t\tret = 0;\n\t*(u32 *)dest = make_data_loc(ret, __dest - base);\n}\n\n \nstatic nokprobe_inline int\nfetch_store_string_user(unsigned long addr, void *dest, void *base)\n{\n\tconst void __user *uaddr =  (__force const void __user *)addr;\n\tint maxlen = get_loc_len(*(u32 *)dest);\n\tvoid *__dest;\n\tlong ret;\n\n\tif (unlikely(!maxlen))\n\t\treturn -ENOMEM;\n\n\t__dest = get_loc_data(dest, base);\n\n\tret = strncpy_from_user_nofault(__dest, uaddr, maxlen);\n\tset_data_loc(ret, dest, __dest, base);\n\n\treturn ret;\n}\n\n \nstatic nokprobe_inline int\nfetch_store_string(unsigned long addr, void *dest, void *base)\n{\n\tint maxlen = get_loc_len(*(u32 *)dest);\n\tvoid *__dest;\n\tlong ret;\n\n#ifdef CONFIG_ARCH_HAS_NON_OVERLAPPING_ADDRESS_SPACE\n\tif ((unsigned long)addr < TASK_SIZE)\n\t\treturn fetch_store_string_user(addr, dest, base);\n#endif\n\n\tif (unlikely(!maxlen))\n\t\treturn -ENOMEM;\n\n\t__dest = get_loc_data(dest, base);\n\n\t \n\tret = strncpy_from_kernel_nofault(__dest, (void *)addr, maxlen);\n\tset_data_loc(ret, dest, __dest, base);\n\n\treturn ret;\n}\n\nstatic nokprobe_inline int\nprobe_mem_read_user(void *dest, void *src, size_t size)\n{\n\tconst void __user *uaddr =  (__force const void __user *)src;\n\n\treturn copy_from_user_nofault(dest, uaddr, size);\n}\n\nstatic nokprobe_inline int\nprobe_mem_read(void *dest, void *src, size_t size)\n{\n#ifdef CONFIG_ARCH_HAS_NON_OVERLAPPING_ADDRESS_SPACE\n\tif ((unsigned long)src < TASK_SIZE)\n\t\treturn probe_mem_read_user(dest, src, size);\n#endif\n\treturn copy_from_kernel_nofault(dest, src, size);\n}\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}