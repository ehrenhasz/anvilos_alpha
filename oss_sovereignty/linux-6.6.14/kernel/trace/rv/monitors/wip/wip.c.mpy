{
  "module_name": "wip.c",
  "hash_id": "132eed373fb7da3a6931a2e94a2c838db35a81735c8ddc1446100ebfb000f772",
  "original_prompt": "Ingested from linux-6.6.14/kernel/trace/rv/monitors/wip/wip.c",
  "human_readable_source": "\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/rv.h>\n#include <rv/instrumentation.h>\n#include <rv/da_monitor.h>\n\n#define MODULE_NAME \"wip\"\n\n#include <trace/events/rv.h>\n#include <trace/events/sched.h>\n#include <trace/events/preemptirq.h>\n\n#include \"wip.h\"\n\nstatic struct rv_monitor rv_wip;\nDECLARE_DA_MON_PER_CPU(wip, unsigned char);\n\nstatic void handle_preempt_disable(void *data, unsigned long ip, unsigned long parent_ip)\n{\n\tda_handle_event_wip(preempt_disable_wip);\n}\n\nstatic void handle_preempt_enable(void *data, unsigned long ip, unsigned long parent_ip)\n{\n\tda_handle_start_event_wip(preempt_enable_wip);\n}\n\nstatic void handle_sched_waking(void *data, struct task_struct *task)\n{\n\tda_handle_event_wip(sched_waking_wip);\n}\n\nstatic int enable_wip(void)\n{\n\tint retval;\n\n\tretval = da_monitor_init_wip();\n\tif (retval)\n\t\treturn retval;\n\n\trv_attach_trace_probe(\"wip\", preempt_enable, handle_preempt_enable);\n\trv_attach_trace_probe(\"wip\", sched_waking, handle_sched_waking);\n\trv_attach_trace_probe(\"wip\", preempt_disable, handle_preempt_disable);\n\n\treturn 0;\n}\n\nstatic void disable_wip(void)\n{\n\trv_wip.enabled = 0;\n\n\trv_detach_trace_probe(\"wip\", preempt_disable, handle_preempt_disable);\n\trv_detach_trace_probe(\"wip\", preempt_enable, handle_preempt_enable);\n\trv_detach_trace_probe(\"wip\", sched_waking, handle_sched_waking);\n\n\tda_monitor_destroy_wip();\n}\n\nstatic struct rv_monitor rv_wip = {\n\t.name = \"wip\",\n\t.description = \"wakeup in preemptive per-cpu testing monitor.\",\n\t.enable = enable_wip,\n\t.disable = disable_wip,\n\t.reset = da_monitor_reset_all_wip,\n\t.enabled = 0,\n};\n\nstatic int __init register_wip(void)\n{\n\trv_register_monitor(&rv_wip);\n\treturn 0;\n}\n\nstatic void __exit unregister_wip(void)\n{\n\trv_unregister_monitor(&rv_wip);\n}\n\nmodule_init(register_wip);\nmodule_exit(unregister_wip);\n\nMODULE_LICENSE(\"GPL\");\nMODULE_AUTHOR(\"Daniel Bristot de Oliveira <bristot@kernel.org>\");\nMODULE_DESCRIPTION(\"wip: wakeup in preemptive - per-cpu sample monitor.\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}