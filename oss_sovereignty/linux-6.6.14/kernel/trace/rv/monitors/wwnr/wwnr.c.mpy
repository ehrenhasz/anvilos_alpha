{
  "module_name": "wwnr.c",
  "hash_id": "92572927e2754537764b809d94f6894f2af64d710af4f5bf9fce0e07d12fb79a",
  "original_prompt": "Ingested from linux-6.6.14/kernel/trace/rv/monitors/wwnr/wwnr.c",
  "human_readable_source": "\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/rv.h>\n#include <rv/instrumentation.h>\n#include <rv/da_monitor.h>\n\n#define MODULE_NAME \"wwnr\"\n\n#include <trace/events/rv.h>\n#include <trace/events/sched.h>\n\n#include \"wwnr.h\"\n\nstatic struct rv_monitor rv_wwnr;\nDECLARE_DA_MON_PER_TASK(wwnr, unsigned char);\n\nstatic void handle_switch(void *data, bool preempt, struct task_struct *p,\n\t\t\t  struct task_struct *n, unsigned int prev_state)\n{\n\t \n\tif (prev_state == TASK_INTERRUPTIBLE)\n\t\tda_handle_start_event_wwnr(p, switch_out_wwnr);\n\telse\n\t\tda_handle_event_wwnr(p, switch_out_wwnr);\n\n\tda_handle_event_wwnr(n, switch_in_wwnr);\n}\n\nstatic void handle_wakeup(void *data, struct task_struct *p)\n{\n\tda_handle_event_wwnr(p, wakeup_wwnr);\n}\n\nstatic int enable_wwnr(void)\n{\n\tint retval;\n\n\tretval = da_monitor_init_wwnr();\n\tif (retval)\n\t\treturn retval;\n\n\trv_attach_trace_probe(\"wwnr\", sched_switch, handle_switch);\n\trv_attach_trace_probe(\"wwnr\", sched_wakeup, handle_wakeup);\n\n\treturn 0;\n}\n\nstatic void disable_wwnr(void)\n{\n\trv_wwnr.enabled = 0;\n\n\trv_detach_trace_probe(\"wwnr\", sched_switch, handle_switch);\n\trv_detach_trace_probe(\"wwnr\", sched_wakeup, handle_wakeup);\n\n\tda_monitor_destroy_wwnr();\n}\n\nstatic struct rv_monitor rv_wwnr = {\n\t.name = \"wwnr\",\n\t.description = \"wakeup while not running per-task testing model.\",\n\t.enable = enable_wwnr,\n\t.disable = disable_wwnr,\n\t.reset = da_monitor_reset_all_wwnr,\n\t.enabled = 0,\n};\n\nstatic int __init register_wwnr(void)\n{\n\trv_register_monitor(&rv_wwnr);\n\treturn 0;\n}\n\nstatic void __exit unregister_wwnr(void)\n{\n\trv_unregister_monitor(&rv_wwnr);\n}\n\nmodule_init(register_wwnr);\nmodule_exit(unregister_wwnr);\n\nMODULE_LICENSE(\"GPL\");\nMODULE_AUTHOR(\"Daniel Bristot de Oliveira <bristot@kernel.org>\");\nMODULE_DESCRIPTION(\"wwnr: wakeup while not running monitor\");\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}