{
  "module_name": "tracing_map.h",
  "hash_id": "d86e187dd077340659b228aa9ab7043b6ad73c0363f578eb8dee615f6154fda6",
  "original_prompt": "Ingested from linux-6.6.14/kernel/trace/tracing_map.h",
  "human_readable_source": "\n#ifndef __TRACING_MAP_H\n#define __TRACING_MAP_H\n\n#define TRACING_MAP_BITS_DEFAULT\t11\n#define TRACING_MAP_BITS_MAX\t\t17\n#define TRACING_MAP_BITS_MIN\t\t7\n\n#define TRACING_MAP_KEYS_MAX\t\t3\n#define TRACING_MAP_VALS_MAX\t\t3\n#define TRACING_MAP_FIELDS_MAX\t\t(TRACING_MAP_KEYS_MAX + \\\n\t\t\t\t\t TRACING_MAP_VALS_MAX)\n#define TRACING_MAP_VARS_MAX\t\t16\n#define TRACING_MAP_SORT_KEYS_MAX\t2\n\ntypedef int (*tracing_map_cmp_fn_t) (void *val_a, void *val_b);\n\n \n\nstruct tracing_map_field {\n\ttracing_map_cmp_fn_t\t\tcmp_fn;\n\tunion {\n\t\tatomic64_t\t\t\tsum;\n\t\tunsigned int\t\t\toffset;\n\t};\n};\n\nstruct tracing_map_elt {\n\tstruct tracing_map\t\t*map;\n\tstruct tracing_map_field\t*fields;\n\tatomic64_t\t\t\t*vars;\n\tbool\t\t\t\t*var_set;\n\tvoid\t\t\t\t*key;\n\tvoid\t\t\t\t*private_data;\n};\n\nstruct tracing_map_entry {\n\tu32\t\t\t\tkey;\n\tstruct tracing_map_elt\t\t*val;\n};\n\nstruct tracing_map_sort_key {\n\tunsigned int\t\t\tfield_idx;\n\tbool\t\t\t\tdescending;\n};\n\nstruct tracing_map_sort_entry {\n\tvoid\t\t\t\t*key;\n\tstruct tracing_map_elt\t\t*elt;\n\tbool\t\t\t\telt_copied;\n\tbool\t\t\t\tdup;\n};\n\nstruct tracing_map_array {\n\tunsigned int entries_per_page;\n\tunsigned int entry_size_shift;\n\tunsigned int entry_shift;\n\tunsigned int entry_mask;\n\tunsigned int n_pages;\n\tvoid **pages;\n};\n\n#define TRACING_MAP_ARRAY_ELT(array, idx)\t\t\t\t\\\n\t(array->pages[idx >> array->entry_shift] +\t\t\t\\\n\t ((idx & array->entry_mask) << array->entry_size_shift))\n\n#define TRACING_MAP_ENTRY(array, idx)\t\t\t\t\t\\\n\t((struct tracing_map_entry *)TRACING_MAP_ARRAY_ELT(array, idx))\n\n#define TRACING_MAP_ELT(array, idx)\t\t\t\t\t\\\n\t((struct tracing_map_elt **)TRACING_MAP_ARRAY_ELT(array, idx))\n\nstruct tracing_map {\n\tunsigned int\t\t\tkey_size;\n\tunsigned int\t\t\tmap_bits;\n\tunsigned int\t\t\tmap_size;\n\tunsigned int\t\t\tmax_elts;\n\tatomic_t\t\t\tnext_elt;\n\tstruct tracing_map_array\t*elts;\n\tstruct tracing_map_array\t*map;\n\tconst struct tracing_map_ops\t*ops;\n\tvoid\t\t\t\t*private_data;\n\tstruct tracing_map_field\tfields[TRACING_MAP_FIELDS_MAX];\n\tunsigned int\t\t\tn_fields;\n\tint\t\t\t\tkey_idx[TRACING_MAP_KEYS_MAX];\n\tunsigned int\t\t\tn_keys;\n\tstruct tracing_map_sort_key\tsort_key;\n\tunsigned int\t\t\tn_vars;\n\tatomic64_t\t\t\thits;\n\tatomic64_t\t\t\tdrops;\n};\n\n \nstruct tracing_map_ops {\n\tint\t\t\t(*elt_alloc)(struct tracing_map_elt *elt);\n\tvoid\t\t\t(*elt_free)(struct tracing_map_elt *elt);\n\tvoid\t\t\t(*elt_clear)(struct tracing_map_elt *elt);\n\tvoid\t\t\t(*elt_init)(struct tracing_map_elt *elt);\n};\n\nextern struct tracing_map *\ntracing_map_create(unsigned int map_bits,\n\t\t   unsigned int key_size,\n\t\t   const struct tracing_map_ops *ops,\n\t\t   void *private_data);\nextern int tracing_map_init(struct tracing_map *map);\n\nextern int tracing_map_add_sum_field(struct tracing_map *map);\nextern int tracing_map_add_var(struct tracing_map *map);\nextern int tracing_map_add_key_field(struct tracing_map *map,\n\t\t\t\t     unsigned int offset,\n\t\t\t\t     tracing_map_cmp_fn_t cmp_fn);\n\nextern void tracing_map_destroy(struct tracing_map *map);\nextern void tracing_map_clear(struct tracing_map *map);\n\nextern struct tracing_map_elt *\ntracing_map_insert(struct tracing_map *map, void *key);\nextern struct tracing_map_elt *\ntracing_map_lookup(struct tracing_map *map, void *key);\n\nextern tracing_map_cmp_fn_t tracing_map_cmp_num(int field_size,\n\t\t\t\t\t\tint field_is_signed);\nextern int tracing_map_cmp_string(void *val_a, void *val_b);\nextern int tracing_map_cmp_none(void *val_a, void *val_b);\n\nextern void tracing_map_update_sum(struct tracing_map_elt *elt,\n\t\t\t\t   unsigned int i, u64 n);\nextern void tracing_map_set_var(struct tracing_map_elt *elt,\n\t\t\t\tunsigned int i, u64 n);\nextern bool tracing_map_var_set(struct tracing_map_elt *elt, unsigned int i);\nextern u64 tracing_map_read_sum(struct tracing_map_elt *elt, unsigned int i);\nextern u64 tracing_map_read_var(struct tracing_map_elt *elt, unsigned int i);\nextern u64 tracing_map_read_var_once(struct tracing_map_elt *elt, unsigned int i);\n\nextern int\ntracing_map_sort_entries(struct tracing_map *map,\n\t\t\t struct tracing_map_sort_key *sort_keys,\n\t\t\t unsigned int n_sort_keys,\n\t\t\t struct tracing_map_sort_entry ***sort_entries);\n\nextern void\ntracing_map_destroy_sort_entries(struct tracing_map_sort_entry **entries,\n\t\t\t\t unsigned int n_entries);\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}