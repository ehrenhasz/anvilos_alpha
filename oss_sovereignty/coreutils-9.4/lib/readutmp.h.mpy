{
  "module_name": "readutmp.h",
  "hash_id": "53c43034cdf9e68956874def24c17c252a1b124a624f210fc3cbca49d2601a31",
  "original_prompt": "Ingested from coreutils-9.4/lib/readutmp.h",
  "human_readable_source": " \n\n#ifndef __READUTMP_H__\n#define __READUTMP_H__\n\n \n#if !_GL_CONFIG_H_INCLUDED\n# error \"Please include config.h first.\"\n#endif\n\n#include \"idx.h\"\n\n#include <stdlib.h>\n#include <sys/types.h>\n#include <time.h>\n\n \n#if (HAVE_UTMPX_H && HAVE_UTMP_H && HAVE_STRUCT_UTMP_UT_EXIT \\\n     && ! HAVE_STRUCT_UTMPX_UT_EXIT)\n# undef HAVE_UTMPX_H\n#endif\n\n \n#if HAVE_UTMP_H\n# include <utmp.h>\n#endif\n\n \n#if HAVE_UTMPX_H\n# if defined _THREAD_SAFE && defined UTMP_DATA_INIT\n     \n#  define utmp_data gl_aix_4_3_workaround_utmp_data\n# endif\n# include <utmpx.h>\n#endif\n\n\n#ifdef __cplusplus\nextern \"C\" {\n#endif\n\n\n \nstruct gl_utmp\n{\n   \n  char *ut_user;                 \n  char *ut_id;                   \n  char *ut_line;                 \n  char *ut_host;                 \n  struct timespec ut_ts;         \n  pid_t ut_pid;                  \n  pid_t ut_session;              \n  short ut_type;                 \n  struct { int e_termination; int e_exit; } ut_exit;\n};\n\n \n#define UT_USER(UT) ((UT)->ut_user)\n#define UT_TIME_MEMBER(UT) ((UT)->ut_ts.tv_sec)\n#define UT_PID(UT) ((UT)->ut_pid)\n#define UT_TYPE_EQ(UT, V) ((UT)->ut_type == (V))\n#define UT_TYPE_NOT_DEFINED 0\n#define UT_EXIT_E_TERMINATION(UT) ((UT)->ut_exit.e_termination)\n#define UT_EXIT_E_EXIT(UT) ((UT)->ut_exit.e_exit)\n\n \ntypedef struct gl_utmp STRUCT_UTMP;\n\n \nenum { UT_USER_SIZE = -1 };\n\n \nenum { UT_ID_SIZE = -1 };\n\n \nenum { UT_LINE_SIZE = -1 };\n\n \nenum { UT_HOST_SIZE = -1 };\n\n\n \n\n#if HAVE_UTMPX_H\n\n \n\n# if __GLIBC__ && _TIME_BITS == 64\n \n#define _GL_UT_USER_SIZE  sizeof (((struct utmpx *) 0)->ut_user)\n#define _GL_UT_ID_SIZE    sizeof (((struct utmpx *) 0)->ut_id)\n#define _GL_UT_LINE_SIZE  sizeof (((struct utmpx *) 0)->ut_line)\n#define _GL_UT_HOST_SIZE  sizeof (((struct utmpx *) 0)->ut_host)\nstruct utmpx32\n{\n  short int ut_type;                \n  pid_t ut_pid;                     \n  char ut_line[_GL_UT_LINE_SIZE];   \n  char ut_id[_GL_UT_ID_SIZE];       \n  char ut_user[_GL_UT_USER_SIZE];   \n  char ut_host[_GL_UT_HOST_SIZE];   \n  struct __exit_status ut_exit;     \n   \n  int ut_session;                   \n  struct\n  {\n     \n    unsigned int tv_sec;\n    int tv_usec;                    \n  } ut_tv;                          \n  int ut_addr_v6[4];                \n  char ut_reserved[20];             \n};\n#  define UTMP_STRUCT_NAME utmpx32\n# else\n#  define UTMP_STRUCT_NAME utmpx\n# endif\n# define SET_UTMP_ENT setutxent\n# define GET_UTMP_ENT getutxent\n# define END_UTMP_ENT endutxent\n# ifdef HAVE_UTMPXNAME  \n#  define UTMP_NAME_FUNCTION utmpxname\n# elif defined UTXDB_ACTIVE  \n#  define UTMP_NAME_FUNCTION(x) setutxdb (UTXDB_ACTIVE, x)\n# endif\n\n#elif HAVE_UTMP_H\n\n \n\n# define UTMP_STRUCT_NAME utmp\n# define SET_UTMP_ENT setutent\n# define GET_UTMP_ENT getutent\n# define END_UTMP_ENT endutent\n# ifdef HAVE_UTMPNAME  \n#  define UTMP_NAME_FUNCTION utmpname\n# endif\n\n#endif\n\n \n#define HAVE_STRUCT_XTMP_UT_ID \\\n  (READUTMP_USE_SYSTEMD \\\n   || (HAVE_UTMPX_H ? HAVE_STRUCT_UTMPX_UT_ID : HAVE_STRUCT_UTMP_UT_ID))\n\n \n#define HAVE_STRUCT_XTMP_UT_PID \\\n  (READUTMP_USE_SYSTEMD \\\n   || (HAVE_UTMPX_H ? HAVE_STRUCT_UTMPX_UT_PID : HAVE_STRUCT_UTMP_UT_PID))\n\n \n#define HAVE_STRUCT_XTMP_UT_HOST \\\n  (READUTMP_USE_SYSTEMD \\\n   || (HAVE_UTMPX_H ? HAVE_STRUCT_UTMPX_UT_HOST : HAVE_STRUCT_UTMP_UT_HOST))\n\n \n#if !defined UTMP_FILE && defined _PATH_UTMP\n# define UTMP_FILE _PATH_UTMP\n#endif\n#ifdef UTMPX_FILE  \n# undef UTMP_FILE\n# define UTMP_FILE UTMPX_FILE\n#endif\n#ifndef UTMP_FILE\n# define UTMP_FILE \"/etc/utmp\"\n#endif\n\n \n#if !defined WTMP_FILE && defined _PATH_WTMP\n# define WTMP_FILE _PATH_WTMP\n#endif\n#ifdef WTMPX_FILE  \n# undef WTMP_FILE\n# define WTMP_FILE WTMPX_FILE\n#endif\n#ifndef WTMP_FILE\n# define WTMP_FILE \"/etc/wtmp\"\n#endif\n\n \n#if defined __ANDROID__ && !defined BOOT_TIME\n# define BOOT_TIME 2\n#endif\n\n \n#if !(HAVE_UTMPX_H ? HAVE_STRUCT_UTMPX_UT_TYPE : HAVE_STRUCT_UTMP_UT_TYPE)\n# define BOOT_TIME 2\n# define USER_PROCESS 0\n#endif\n\n \n#ifdef BOOT_TIME\n# define UT_TYPE_BOOT_TIME(UT) ((UT)->ut_type == BOOT_TIME)\n#else\n# define UT_TYPE_BOOT_TIME(UT) 0\n#endif\n#ifdef USER_PROCESS\n# define UT_TYPE_USER_PROCESS(UT) ((UT)->ut_type == USER_PROCESS)\n#else\n# define UT_TYPE_USER_PROCESS(UT) 0\n#endif\n\n \n#define IS_USER_PROCESS(UT)                                    \\\n  ((UT)->ut_user[0] && UT_TYPE_USER_PROCESS (UT))\n\n \n#if READUTMP_USE_SYSTEMD || HAVE_UTMPX_H || HAVE_UTMP_H || defined __CYGWIN__ || defined _WIN32\n# define READ_UTMP_SUPPORTED 1\n#endif\n\n \nenum\n  {\n    READ_UTMP_CHECK_PIDS   = 1,\n    READ_UTMP_USER_PROCESS = 2,\n    READ_UTMP_BOOT_TIME    = 4,\n    READ_UTMP_NO_BOOT_TIME = 8\n  };\n\n \nchar *extract_trimmed_name (const STRUCT_UTMP *ut)\n  _GL_ATTRIBUTE_MALLOC _GL_ATTRIBUTE_DEALLOC_FREE\n  _GL_ATTRIBUTE_RETURNS_NONNULL;\n\n \nint read_utmp (char const *file, idx_t *n_entries, STRUCT_UTMP **utmp_buf,\n               int options);\n\n\n#ifdef __cplusplus\n}\n#endif\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}