{
  "module_name": "iconv_open.c",
  "hash_id": "49559679f80be3c4b739b4cdf06e10a5ce46410ac6368456765c8f79ecacff14",
  "original_prompt": "Ingested from coreutils-9.4/lib/iconv_open.c",
  "human_readable_source": " \n#include <iconv.h>\n\n#include <errno.h>\n#include <string.h>\n#include \"c-ctype.h\"\n#include \"c-strcase.h\"\n\n#define SIZEOF(a) (sizeof(a) / sizeof(a[0]))\n\n \n#define mapping_lookup rpl_iconv_open_mapping_lookup\n\n \n\n#define ICONV_FLAVOR_AIX \"iconv_open-aix.h\"\n#define ICONV_FLAVOR_HPUX \"iconv_open-hpux.h\"\n#define ICONV_FLAVOR_IRIX \"iconv_open-irix.h\"\n#define ICONV_FLAVOR_OSF \"iconv_open-osf.h\"\n#define ICONV_FLAVOR_SOLARIS \"iconv_open-solaris.h\"\n#define ICONV_FLAVOR_ZOS \"iconv_open-zos.h\"\n\n#ifdef ICONV_FLAVOR\n# include ICONV_FLAVOR\n#endif\n\niconv_t\nrpl_iconv_open (const char *tocode, const char *fromcode)\n#undef iconv_open\n{\n  char fromcode_upper[32];\n  char tocode_upper[32];\n  char *fromcode_upper_end;\n  char *tocode_upper_end;\n\n#if REPLACE_ICONV_UTF\n   \n  if (c_toupper (fromcode[0]) == 'U'\n      && c_toupper (fromcode[1]) == 'T'\n      && c_toupper (fromcode[2]) == 'F'\n      && fromcode[3] == '-')\n    {\n      if (c_toupper (tocode[0]) == 'U'\n          && c_toupper (tocode[1]) == 'T'\n          && c_toupper (tocode[2]) == 'F'\n          && tocode[3] == '-')\n        {\n          if (strcmp (fromcode + 4, \"8\") == 0)\n            {\n              if (c_strcasecmp (tocode + 4, \"16BE\") == 0)\n                return _ICONV_UTF8_UTF16BE;\n              if (c_strcasecmp (tocode + 4, \"16LE\") == 0)\n                return _ICONV_UTF8_UTF16LE;\n              if (c_strcasecmp (tocode + 4, \"32BE\") == 0)\n                return _ICONV_UTF8_UTF32BE;\n              if (c_strcasecmp (tocode + 4, \"32LE\") == 0)\n                return _ICONV_UTF8_UTF32LE;\n            }\n          else if (strcmp (tocode + 4, \"8\") == 0)\n            {\n              if (c_strcasecmp (fromcode + 4, \"16BE\") == 0)\n                return _ICONV_UTF16BE_UTF8;\n              if (c_strcasecmp (fromcode + 4, \"16LE\") == 0)\n                return _ICONV_UTF16LE_UTF8;\n              if (c_strcasecmp (fromcode + 4, \"32BE\") == 0)\n                return _ICONV_UTF32BE_UTF8;\n              if (c_strcasecmp (fromcode + 4, \"32LE\") == 0)\n                return _ICONV_UTF32LE_UTF8;\n            }\n        }\n    }\n#endif\n\n   \n\n   \n  {\n    iconv_t cd = iconv_open (tocode, fromcode);\n    if (cd != (iconv_t)(-1))\n      return cd;\n  }\n\n   \n  {\n    const char *p = fromcode;\n    char *q = fromcode_upper;\n    while ((*q = c_toupper (*p)) != '\\0')\n      {\n        p++;\n        q++;\n        if (q == &fromcode_upper[SIZEOF (fromcode_upper)])\n          {\n            errno = EINVAL;\n            return (iconv_t)(-1);\n          }\n      }\n    fromcode_upper_end = q;\n  }\n\n  {\n    const char *p = tocode;\n    char *q = tocode_upper;\n    while ((*q = c_toupper (*p)) != '\\0')\n      {\n        p++;\n        q++;\n        if (q == &tocode_upper[SIZEOF (tocode_upper)])\n          {\n            errno = EINVAL;\n            return (iconv_t)(-1);\n          }\n      }\n    tocode_upper_end = q;\n  }\n\n#ifdef ICONV_FLAVOR\n   \n  {\n    const struct mapping *m =\n      mapping_lookup (fromcode_upper, fromcode_upper_end - fromcode_upper);\n\n    fromcode = (m != NULL ? m->vendor_name : fromcode_upper);\n  }\n  {\n    const struct mapping *m =\n      mapping_lookup (tocode_upper, tocode_upper_end - tocode_upper);\n\n    tocode = (m != NULL ? m->vendor_name : tocode_upper);\n  }\n#else\n  fromcode = fromcode_upper;\n  tocode = tocode_upper;\n#endif\n\n  return iconv_open (tocode, fromcode);\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}