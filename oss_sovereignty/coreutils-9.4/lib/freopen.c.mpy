{
  "module_name": "freopen.c",
  "hash_id": "612acaa4150254c24289f779d074de30713ff6f96dfc7d2740f2a71026477390",
  "original_prompt": "Ingested from coreutils-9.4/lib/freopen.c",
  "human_readable_source": " \n\n \n#define _GL_ALREADY_INCLUDING_STDIO_H\n#include <config.h>\n\n \n#include <stdio.h>\n#undef _GL_ALREADY_INCLUDING_STDIO_H\n\n#include <errno.h>\n\nstatic FILE *\norig_freopen (const char *filename, const char *mode, FILE *stream)\n{\n  return freopen (filename, mode, stream);\n}\n\n \n \n#include \"stdio.h\"\n\n#include <fcntl.h>\n#include <string.h>\n#include <unistd.h>\n\nFILE *\nrpl_freopen (const char *filename, const char *mode, FILE *stream)\n{\n  FILE *result;\n#if defined _WIN32 && ! defined __CYGWIN__\n  char const *null_device = \"NUL\";\n  if (filename && strcmp (filename, \"/dev/null\") == 0)\n    filename = null_device;\n#else\n  char const *null_device = \"/dev/null\";\n#endif\n\n#ifdef __KLIBC__\n  errno = 0;\n#endif\n\n  result = orig_freopen (filename, mode, stream);\n\n  if (!result)\n    {\n#ifdef __KLIBC__\n       \n      if (!filename && !errno)\n        result = stream;\n#endif\n    }\n  else if (filename)\n    {\n      int fd = fileno (result);\n      if (dup2 (fd, fd) < 0 && errno == EBADF)\n        {\n          int nullfd = open (null_device, O_RDONLY | O_CLOEXEC);\n          int err = 0;\n          if (nullfd != fd)\n            {\n              if (dup2 (nullfd, fd) < 0)\n                err = 1;\n              close (nullfd);\n            }\n          if (!err)\n            result = orig_freopen (filename, mode, result);\n        }\n    }\n\n  return result;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}