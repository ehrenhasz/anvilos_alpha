{
  "module_name": "filevercmp.c",
  "hash_id": "fd7f2386d02dce19c3f16d6d9238df424a102db2af9f14543291045dcc01b00d",
  "original_prompt": "Ingested from coreutils-9.4/lib/filevercmp.c",
  "human_readable_source": " \nstatic idx_t\nfile_prefixlen (char const *s, ptrdiff_t *len)\n{\n  size_t n = *len;   \n  idx_t prefixlen = 0;\n\n  for (idx_t i = 0; ; )\n    {\n      if (*len < 0 ? !s[i] : i == n)\n        {\n          *len = i;\n          return prefixlen;\n        }\n\n      i++;\n      prefixlen = i;\n      while (i + 1 < n && s[i] == '.' && (c_isalpha (s[i + 1])\n                                          || s[i + 1] == '~'))\n        for (i += 2; i < n && (c_isalnum (s[i]) || s[i] == '~'); i++)\n          continue;\n    }\n}\n\n \n\nstatic int\norder (char const *s, idx_t pos, idx_t len)\n{\n  if (pos == len)\n    return -1;\n\n  unsigned char c = s[pos];\n  if (c_isdigit (c))\n    return 0;\n  else if (c_isalpha (c))\n    return c;\n  else if (c == '~')\n    return -2;\n  else\n    {\n      static_assert (UCHAR_MAX <= (INT_MAX - 1 - 2) / 2);\n      return c + UCHAR_MAX + 1;\n    }\n}\n\n \nint\nfilevercmp (const char *s1, const char *s2)\n{\n  return filenvercmp (s1, -1, s2, -1);\n}\n\n \nint\nfilenvercmp (char const *a, ptrdiff_t alen, char const *b, ptrdiff_t blen)\n{\n   \n  bool aempty = alen < 0 ? !a[0] : !alen;\n  bool bempty = blen < 0 ? !b[0] : !blen;\n  if (aempty)\n    return -!bempty;\n  if (bempty)\n    return 1;\n\n   \n  if (a[0] == '.')\n    {\n      if (b[0] != '.')\n        return -1;\n\n      bool adot = alen < 0 ? !a[1] : alen == 1;\n      bool bdot = blen < 0 ? !b[1] : blen == 1;\n      if (adot)\n        return -!bdot;\n      if (bdot)\n        return 1;\n\n      bool adotdot = a[1] == '.' && (alen < 0 ? !a[2] : alen == 2);\n      bool bdotdot = b[1] == '.' && (blen < 0 ? !b[2] : blen == 2);\n      if (adotdot)\n        return -!bdotdot;\n      if (bdotdot)\n        return 1;\n    }\n  else if (b[0] == '.')\n    return 1;\n\n   \n  idx_t aprefixlen = file_prefixlen (a, &alen);\n  idx_t bprefixlen = file_prefixlen (b, &blen);\n\n   \n  bool one_pass_only = aprefixlen == alen && bprefixlen == blen;\n\n  int result = verrevcmp (a, aprefixlen, b, bprefixlen);\n\n   \n  return result || one_pass_only ? result : verrevcmp (a, alen, b, blen);\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}