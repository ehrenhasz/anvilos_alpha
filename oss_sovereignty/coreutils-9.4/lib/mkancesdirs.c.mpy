{
  "module_name": "mkancesdirs.c",
  "hash_id": "7b400a7e46a6c9f158322dfd2e1130af85d507193b5b7c2f897c974deca8dcd5",
  "original_prompt": "Ingested from coreutils-9.4/lib/mkancesdirs.c",
  "human_readable_source": " \n\n \n\n#include <config.h>\n\n#include \"mkancesdirs.h\"\n\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n\n#include <errno.h>\n#include <unistd.h>\n\n#include \"filename.h\"\n#include \"savewd.h\"\n\n \n\nptrdiff_t\nmkancesdirs (char *file, struct savewd *wd,\n             int (*make_dir) (char const *, char const *, void *),\n             void *make_dir_arg)\n{\n   \n  char *sep = NULL;\n\n   \n  char *component = file;\n\n  char *p = file + FILE_SYSTEM_PREFIX_LEN (file);\n  char c;\n  bool made_dir = false;\n\n   \n\n  while ((c = *p++))\n    if (ISSLASH (*p))\n      {\n        if (! ISSLASH (c))\n          sep = p;\n      }\n    else if (ISSLASH (c) && *p && sep)\n      {\n         \n        if (! (sep - component == 1 && component[0] == '.'))\n          {\n            int make_dir_errno = 0;\n            int savewd_chdir_options = 0;\n            int chdir_result;\n\n             \n            *sep = '\\0';\n\n             \n            if (sep - component == 2\n                && component[0] == '.' && component[1] == '.')\n              made_dir = false;\n            else if (make_dir (file, component, make_dir_arg) < 0)\n              make_dir_errno = errno;\n            else\n              made_dir = true;\n\n            if (made_dir)\n              savewd_chdir_options |= SAVEWD_CHDIR_NOFOLLOW;\n\n            chdir_result =\n              savewd_chdir (wd, component, savewd_chdir_options, NULL);\n\n             \n            if (chdir_result != -1)\n              *sep = '/';\n\n            if (chdir_result != 0)\n              {\n                if (make_dir_errno != 0 && errno == ENOENT)\n                  errno = make_dir_errno;\n                return chdir_result;\n              }\n          }\n\n        component = p;\n      }\n\n  return component - file;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}