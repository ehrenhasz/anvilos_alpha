{
  "module_name": "getugroups.c",
  "hash_id": "c0585f3e93c25a76bc613f57d1e3e2b771d907a8fe869fdf809fe58358e860ca",
  "original_prompt": "Ingested from coreutils-9.4/lib/getugroups.c",
  "human_readable_source": " \n\n#include <config.h>\n\n#include \"getugroups.h\"\n\n#include <errno.h>\n#include <limits.h>\n#include <stdio.h>  \n#include <string.h>\n#include <unistd.h>\n\n#if !HAVE_GRP_H || defined __ANDROID__\n\n \n\nint\ngetugroups (_GL_UNUSED int maxcount,\n            _GL_UNUSED gid_t *grouplist,\n            _GL_UNUSED char const *username,\n            _GL_UNUSED gid_t gid)\n{\n  errno = ENOSYS;\n  return -1;\n}\n\n#else  \n# include <grp.h>\n\n# define STREQ(a, b) (strcmp (a, b) == 0)\n\n \n\nint\ngetugroups (int maxcount, gid_t *grouplist, char const *username,\n            gid_t gid)\n{\n  int count = 0;\n\n  if (gid != (gid_t) -1)\n    {\n      if (maxcount != 0)\n        grouplist[count] = gid;\n      ++count;\n    }\n\n  setgrent ();\n  while (1)\n    {\n      char **cp;\n      struct group *grp;\n\n      errno = 0;\n      grp = getgrent ();\n      if (grp == NULL)\n        break;\n\n      for (cp = grp->gr_mem; *cp; ++cp)\n        {\n          int n;\n\n          if ( ! STREQ (username, *cp))\n            continue;\n\n           \n          for (n = 0; n < count; ++n)\n            if (grouplist && grouplist[n] == grp->gr_gid)\n              break;\n\n           \n          if (n == count)\n            {\n              if (maxcount != 0)\n                {\n                  if (count >= maxcount)\n                    goto done;\n                  grouplist[count] = grp->gr_gid;\n                }\n              if (count == INT_MAX)\n                {\n                  errno = EOVERFLOW;\n                  goto done;\n                }\n              count++;\n            }\n        }\n    }\n\n  if (errno != 0)\n    count = -1;\n\n done:\n  {\n    int saved_errno = errno;\n    endgrent ();\n    errno = saved_errno;\n  }\n\n  return count;\n}\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}