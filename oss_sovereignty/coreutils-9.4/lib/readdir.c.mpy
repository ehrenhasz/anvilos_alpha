{
  "module_name": "readdir.c",
  "hash_id": "d7e2f44231f69477f139424c389a2fdb3a461fbad5262fc99c2867d2b5000435",
  "original_prompt": "Ingested from coreutils-9.4/lib/readdir.c",
  "human_readable_source": " \n#include <dirent.h>\n\n#include <errno.h>\n#include <stddef.h>\n\n#if GNULIB_defined_DIR\n# include \"dirent-private.h\"\n#endif\n\n \n#undef FindNextFile\n#define FindNextFile FindNextFileA\n\nstruct dirent *\nreaddir (DIR *dirp)\n#undef readdir\n{\n#if HAVE_DIRENT_H                        \n  return readdir (dirp->real_dirp);\n#else\n  char type;\n  struct dirent *result;\n\n   \n\n  switch (dirp->status)\n    {\n    case -2:\n       \n      return NULL;\n    case -1:\n      break;\n    case 0:\n      if (!FindNextFile (dirp->current, &dirp->entry))\n        {\n          switch (GetLastError ())\n            {\n            case ERROR_NO_MORE_FILES:\n              dirp->status = -2;\n              return NULL;\n            default:\n              errno = EIO;\n              return NULL;\n            }\n        }\n      break;\n    default:\n      errno = dirp->status;\n      return NULL;\n    }\n\n  dirp->status = 0;\n\n  if (dirp->entry.dwFileAttributes & FILE_ATTRIBUTE_DIRECTORY)\n    type = DT_DIR;\n  else if (dirp->entry.dwFileAttributes & FILE_ATTRIBUTE_REPARSE_POINT)\n    type = DT_LNK;\n  else if ((dirp->entry.dwFileAttributes\n            & ~(FILE_ATTRIBUTE_READONLY\n                | FILE_ATTRIBUTE_HIDDEN\n                | FILE_ATTRIBUTE_SYSTEM\n                | FILE_ATTRIBUTE_ARCHIVE\n                | FILE_ATTRIBUTE_NORMAL\n                | FILE_ATTRIBUTE_TEMPORARY\n                | FILE_ATTRIBUTE_SPARSE_FILE\n                | FILE_ATTRIBUTE_COMPRESSED\n                | FILE_ATTRIBUTE_NOT_CONTENT_INDEXED\n                | FILE_ATTRIBUTE_ENCRYPTED)) == 0)\n     \n    type = DT_REG;\n  else\n    type = DT_UNKNOWN;\n\n   \n  result =\n    (struct dirent *)\n    ((char *) dirp->entry.cFileName - offsetof (struct dirent, d_name[0]));\n  result->d_type = type;\n\n  return result;\n#endif\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}