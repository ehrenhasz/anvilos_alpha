{
  "module_name": "readlinkat.c",
  "hash_id": "681985b886c5cb3dd1acb1fe7507a87784d8dba79967bae9db49f0f9e99ae006",
  "original_prompt": "Ingested from coreutils-9.4/lib/readlinkat.c",
  "human_readable_source": " \n\n#include <config.h>\n\n \n#include <unistd.h>\n\n#include <errno.h>\n#include <stdlib.h>\n#include <string.h>\n#include <sys/stat.h>\n\n#if HAVE_READLINKAT\n\n# undef fstatat\n# undef readlinkat\n\nssize_t\nrpl_readlinkat (int fd, char const *file, char *buf, size_t bufsize)\n{\n# if READLINK_TRAILING_SLASH_BUG\n  size_t file_len = strlen (file);\n  if (file_len && file[file_len - 1] == '/')\n    {\n       \n      struct stat st;\n      if (fstatat (fd, file, &st, 0) == 0 || errno == EOVERFLOW)\n        errno = EINVAL;\n      return -1;\n    }\n# endif  \n\n  ssize_t r = readlinkat (fd, file, buf, bufsize);\n\n# if READLINK_TRUNCATE_BUG\n  if (r < 0 && errno == ERANGE)\n    {\n       \n      char stackbuf[4032];\n      r = readlinkat (fd, file, stackbuf, sizeof stackbuf);\n      if (r < 0)\n        {\n          if (errno == ERANGE)\n            {\n               \n              r = bufsize;\n              memset (buf, 0, r);\n            }\n        }\n      else\n        {\n          if (bufsize < r)\n            r = bufsize;\n          memcpy (buf, stackbuf, r);\n        }\n    }\n# endif\n\n  return r;\n}\n\n#else\n\n \n\n \n\n \n\n# define AT_FUNC_NAME readlinkat\n# define AT_FUNC_F1 readlink\n# define AT_FUNC_POST_FILE_PARAM_DECLS , char *buf, size_t bufsize\n# define AT_FUNC_POST_FILE_ARGS        , buf, bufsize\n# define AT_FUNC_RESULT ssize_t\n# include \"at-func.c\"\n# undef AT_FUNC_NAME\n# undef AT_FUNC_F1\n# undef AT_FUNC_POST_FILE_PARAM_DECLS\n# undef AT_FUNC_POST_FILE_ARGS\n# undef AT_FUNC_RESULT\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}