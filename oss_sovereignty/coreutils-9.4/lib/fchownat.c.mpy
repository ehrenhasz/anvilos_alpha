{
  "module_name": "fchownat.c",
  "hash_id": "d2f8d75e16a701550e45072e221f550efd70263aae2f128a44c0475d83f293e3",
  "original_prompt": "Ingested from coreutils-9.4/lib/fchownat.c",
  "human_readable_source": " \n\n#include <config.h>\n\n \n#include <unistd.h>\n\n#include <errno.h>\n#include <stdlib.h>\n#include <string.h>\n\n#include \"openat.h\"\n\n#if !HAVE_FCHOWNAT\n\n \n\n# define AT_FUNC_NAME fchownat\n# define AT_FUNC_F1 lchown\n# define AT_FUNC_F2 chown\n# define AT_FUNC_USE_F1_COND AT_SYMLINK_NOFOLLOW\n# define AT_FUNC_POST_FILE_PARAM_DECLS , uid_t owner, gid_t group, int flag\n# define AT_FUNC_POST_FILE_ARGS        , owner, group\n# include \"at-func.c\"\n# undef AT_FUNC_NAME\n# undef AT_FUNC_F1\n# undef AT_FUNC_F2\n# undef AT_FUNC_USE_F1_COND\n# undef AT_FUNC_POST_FILE_PARAM_DECLS\n# undef AT_FUNC_POST_FILE_ARGS\n\n#else  \n\n# undef fchownat\n\n# if FCHOWNAT_NOFOLLOW_BUG\n\n \nstatic int\nlocal_lchownat (int fd, char const *file, uid_t owner, gid_t group);\n\n#  define AT_FUNC_NAME local_lchownat\n#  define AT_FUNC_F1 lchown\n#  define AT_FUNC_POST_FILE_PARAM_DECLS , uid_t owner, gid_t group\n#  define AT_FUNC_POST_FILE_ARGS        , owner, group\n#  include \"at-func.c\"\n#  undef AT_FUNC_NAME\n#  undef AT_FUNC_F1\n#  undef AT_FUNC_POST_FILE_PARAM_DECLS\n#  undef AT_FUNC_POST_FILE_ARGS\n\n# endif\n\n \n\nint\nrpl_fchownat (int fd, char const *file, uid_t owner, gid_t group, int flag)\n{\n# if FCHOWNAT_NOFOLLOW_BUG\n  if (flag == AT_SYMLINK_NOFOLLOW)\n    return local_lchownat (fd, file, owner, group);\n# endif\n# if FCHOWNAT_EMPTY_FILENAME_BUG\n  if (file[0] == '\\0')\n    {\n      errno = ENOENT;\n      return -1;\n    }\n# endif\n# if CHOWN_TRAILING_SLASH_BUG\n  {\n    size_t len = strlen (file);\n    struct stat st;\n    if (len && file[len - 1] == '/')\n      {\n        if (fstatat (fd, file, &st, 0))\n          return -1;\n        if (flag == AT_SYMLINK_NOFOLLOW)\n          return fchownat (fd, file, owner, group, 0);\n      }\n  }\n# endif\n  return fchownat (fd, file, owner, group, flag);\n}\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}