{
  "module_name": "nproc.c",
  "hash_id": "0f8b1201b1ad238f7b83b004df84bf0333ca9dad8345a548301593fbe9cf2c18",
  "original_prompt": "Ingested from coreutils-9.4/src/nproc.c",
  "human_readable_source": " \n\n#include <config.h>\n#include <getopt.h>\n#include <stdio.h>\n#include <sys/types.h>\n\n#include \"system.h\"\n#include \"nproc.h\"\n#include \"quote.h\"\n#include \"xdectoint.h\"\n\n \n#define PROGRAM_NAME \"nproc\"\n\n#define AUTHORS proper_name (\"Giuseppe Scrivano\")\n\nenum\n{\n  ALL_OPTION = CHAR_MAX + 1,\n  IGNORE_OPTION\n};\n\nstatic struct option const longopts[] =\n{\n  {\"all\", no_argument, nullptr, ALL_OPTION},\n  {\"ignore\", required_argument, nullptr, IGNORE_OPTION},\n  {GETOPT_HELP_OPTION_DECL},\n  {GETOPT_VERSION_OPTION_DECL},\n  {nullptr, 0, nullptr, 0}\n};\n\nvoid\nusage (int status)\n{\n  if (status != EXIT_SUCCESS)\n    emit_try_help ();\n  else\n    {\n      printf (_(\"Usage: %s [OPTION]...\\n\"), program_name);\n      fputs (_(\"\\\nPrint the number of processing units available to the current process,\\n\\\nwhich may be less than the number of online processors\\n\\\n\\n\\\n\"), stdout);\n      fputs (_(\"\\\n      --all      print the number of installed processors\\n\\\n      --ignore=N  if possible, exclude N processing units\\n\\\n\"), stdout);\n\n      fputs (HELP_OPTION_DESCRIPTION, stdout);\n      fputs (VERSION_OPTION_DESCRIPTION, stdout);\n      emit_ancillary_info (PROGRAM_NAME);\n    }\n  exit (status);\n}\n\nint\nmain (int argc, char **argv)\n{\n  unsigned long nproc, ignore = 0;\n  initialize_main (&argc, &argv);\n  set_program_name (argv[0]);\n  setlocale (LC_ALL, \"\");\n  bindtextdomain (PACKAGE, LOCALEDIR);\n  textdomain (PACKAGE);\n\n  atexit (close_stdout);\n\n  enum nproc_query mode = NPROC_CURRENT_OVERRIDABLE;\n\n  while (true)\n    {\n      int c = getopt_long (argc, argv, \"\", longopts, nullptr);\n      if (c == -1)\n        break;\n      switch (c)\n        {\n        case_GETOPT_HELP_CHAR;\n\n        case_GETOPT_VERSION_CHAR (PROGRAM_NAME, AUTHORS);\n\n        case ALL_OPTION:\n          mode = NPROC_ALL;\n          break;\n\n        case IGNORE_OPTION:\n          ignore = xdectoumax (optarg, 0, ULONG_MAX, \"\", _(\"invalid number\"),0);\n          break;\n\n        default:\n          usage (EXIT_FAILURE);\n        }\n    }\n\n  if (argc != optind)\n    {\n      error (0, 0, _(\"extra operand %s\"), quote (argv[optind]));\n      usage (EXIT_FAILURE);\n    }\n\n  nproc = num_processors (mode);\n\n  if (ignore < nproc)\n    nproc -= ignore;\n  else\n    nproc = 1;\n\n  printf (\"%lu\\n\", nproc);\n\n  return EXIT_SUCCESS;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}