{
  "module_name": "group-list.c",
  "hash_id": "48cfc9c7417d939ac3df9f9cdf8b6e6222bfe954488c08f64e54706fff4c15e7",
  "original_prompt": "Ingested from coreutils-9.4/src/group-list.c",
  "human_readable_source": " \n\n#include <config.h>\n#include <stdio.h>\n#include <sys/types.h>\n#include <pwd.h>\n#include <grp.h>\n\n#include \"system.h\"\n#include \"mgetgroups.h\"\n#include \"quote.h\"\n#include \"group-list.h\"\n\n\n \nextern bool\nprint_group_list (char const *username,\n                  uid_t ruid, gid_t rgid, gid_t egid,\n                  bool use_names, char delim)\n{\n  bool ok = true;\n  struct passwd *pwd = nullptr;\n\n  if (username)\n    {\n      pwd = getpwuid (ruid);\n      if (pwd == nullptr)\n        ok = false;\n    }\n\n  if (!print_group (rgid, use_names))\n    ok = false;\n\n  if (egid != rgid)\n    {\n      putchar (delim);\n      if (!print_group (egid, use_names))\n        ok = false;\n    }\n\n  {\n    gid_t *groups;\n\n    int n_groups = xgetgroups (username, (pwd ? pwd->pw_gid : egid), &groups);\n    if (n_groups < 0)\n      {\n        if (username)\n          {\n            error (0, errno, _(\"failed to get groups for user %s\"),\n                   quote (username));\n          }\n        else\n          {\n            error (0, errno, _(\"failed to get groups for the current process\"));\n          }\n        return false;\n      }\n\n    for (int i = 0; i < n_groups; i++)\n      if (groups[i] != rgid && groups[i] != egid)\n        {\n          putchar (delim);\n          if (!print_group (groups[i], use_names))\n            ok = false;\n        }\n    free (groups);\n  }\n  return ok;\n}\n\n \nstatic char *\ngidtostr_ptr (gid_t const *gid)\n{\n  static char buf[INT_BUFSIZE_BOUND (uintmax_t)];\n  return umaxtostr (*gid, buf);\n}\n#define gidtostr(g) gidtostr_ptr (&(g))\n\n \nextern bool\nprint_group (gid_t gid, bool use_name)\n{\n  struct group *grp = nullptr;\n  bool ok = true;\n\n  if (use_name)\n    {\n      grp = getgrgid (gid);\n      if (grp == nullptr)\n        {\n          if (TYPE_SIGNED (gid_t))\n            {\n              intmax_t g = gid;\n              error (0, 0, _(\"cannot find name for group ID %\"PRIdMAX), g);\n            }\n          else\n            {\n              uintmax_t g = gid;\n              error (0, 0, _(\"cannot find name for group ID %\"PRIuMAX), g);\n            }\n          ok = false;\n        }\n    }\n\n  char *s = grp ? grp->gr_name : gidtostr (gid);\n  fputs (s, stdout);\n  return ok;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}