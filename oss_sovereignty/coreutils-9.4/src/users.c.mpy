{
  "module_name": "users.c",
  "hash_id": "2b9a367dd6c5741bccf3b638e6b78e81276aad1ba4586e4ad9502f47a8202d15",
  "original_prompt": "Ingested from coreutils-9.4/src/users.c",
  "human_readable_source": " \n\n \n\n#include <config.h>\n#include <stdio.h>\n\n#include <sys/types.h>\n#include \"system.h\"\n\n#include \"long-options.h\"\n#include \"quote.h\"\n#include \"readutmp.h\"\n\n \n#define PROGRAM_NAME \"users\"\n\n#define AUTHORS \\\n  proper_name (\"Joseph Arceneaux\"), \\\n  proper_name (\"David MacKenzie\")\n\nstatic int\nuserid_compare (const void *v_a, const void *v_b)\n{\n  char **a = (char **) v_a;\n  char **b = (char **) v_b;\n  return strcmp (*a, *b);\n}\n\nstatic void\nlist_entries_users (idx_t n, struct gl_utmp const *this)\n{\n  char **u = xinmalloc (n, sizeof *u);\n  idx_t i;\n  idx_t n_entries = 0;\n\n  while (n--)\n    {\n      if (IS_USER_PROCESS (this))\n        {\n          char *trimmed_name;\n\n          trimmed_name = extract_trimmed_name (this);\n\n          u[n_entries] = trimmed_name;\n          ++n_entries;\n        }\n      this++;\n    }\n\n  qsort (u, n_entries, sizeof (u[0]), userid_compare);\n\n  for (i = 0; i < n_entries; i++)\n    {\n      char c = (i < n_entries - 1 ? ' ' : '\\n');\n      fputs (u[i], stdout);\n      putchar (c);\n    }\n\n  for (i = 0; i < n_entries; i++)\n    free (u[i]);\n  free (u);\n}\n\n \n\nstatic void\nusers (char const *filename, int options)\n{\n  idx_t n_users;\n  struct gl_utmp *utmp_buf;\n  options |= READ_UTMP_USER_PROCESS;\n  if (read_utmp (filename, &n_users, &utmp_buf, options) != 0)\n    error (EXIT_FAILURE, errno, \"%s\", quotef (filename));\n\n  list_entries_users (n_users, utmp_buf);\n\n  free (utmp_buf);\n}\n\nvoid\nusage (int status)\n{\n  if (status != EXIT_SUCCESS)\n    emit_try_help ();\n  else\n    {\n      printf (_(\"Usage: %s [OPTION]... [FILE]\\n\"), program_name);\n      printf (_(\"\\\nOutput who is currently logged in according to FILE.\\n\\\nIf FILE is not specified, use %s.  %s as FILE is common.\\n\\\n\\n\\\n\"),\n              UTMP_FILE, WTMP_FILE);\n      fputs (HELP_OPTION_DESCRIPTION, stdout);\n      fputs (VERSION_OPTION_DESCRIPTION, stdout);\n      emit_ancillary_info (PROGRAM_NAME);\n    }\n  exit (status);\n}\n\nint\nmain (int argc, char **argv)\n{\n  initialize_main (&argc, &argv);\n  set_program_name (argv[0]);\n  setlocale (LC_ALL, \"\");\n  bindtextdomain (PACKAGE, LOCALEDIR);\n  textdomain (PACKAGE);\n\n  atexit (close_stdout);\n\n  parse_gnu_standard_options_only (argc, argv, PROGRAM_NAME, PACKAGE_NAME,\n                                   Version, true, usage, AUTHORS,\n                                   (char const *) nullptr);\n\n  switch (argc - optind)\n    {\n    case 0:\t\t\t/* users */\n      users (UTMP_FILE, READ_UTMP_CHECK_PIDS);\n      break;\n\n    case 1:\t\t\t/* users <utmp file> */\n      users (argv[optind], 0);\n      break;\n\n    default:\t\t\t/* lose */\n      error (0, 0, _(\"extra operand %s\"), quote (argv[optind + 1]));\n      usage (EXIT_FAILURE);\n    }\n\n  return EXIT_SUCCESS;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}