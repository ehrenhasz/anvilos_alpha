{
  "module_name": "cp-hash.c",
  "hash_id": "ffcc20153d3608f4c26ddb56c6e63a1203981db1fb8c839bc658d1928f2de24b",
  "original_prompt": "Ingested from coreutils-9.4/src/cp-hash.c",
  "human_readable_source": " \n\n#include <config.h>\n\n#include <sys/types.h>\n#include \"system.h\"\n\n#include \"hash.h\"\n#include \"cp-hash.h\"\n\n \nstruct Src_to_dest\n{\n  ino_t st_ino;\n  dev_t st_dev;\n   \n  char *name;\n};\n\n \nstatic Hash_table *src_to_dest;\n\n \n#define INITIAL_TABLE_SIZE 103\n\nstatic size_t\nsrc_to_dest_hash (void const *x, size_t table_size)\n{\n  struct Src_to_dest const *p = x;\n\n   \n   \n  return (uintmax_t) p->st_ino % table_size;\n}\n\n \nstatic bool\nsrc_to_dest_compare (void const *x, void const *y)\n{\n  struct Src_to_dest const *a = x;\n  struct Src_to_dest const *b = y;\n  return SAME_INODE (*a, *b) ? true : false;\n}\n\nstatic void\nsrc_to_dest_free (void *x)\n{\n  struct Src_to_dest *a = x;\n  free (a->name);\n  free (x);\n}\n\n \nextern void\nforget_created (ino_t ino, dev_t dev)\n{\n  struct Src_to_dest probe;\n  struct Src_to_dest *ent;\n\n  probe.st_ino = ino;\n  probe.st_dev = dev;\n  probe.name = nullptr;\n\n  ent = hash_remove (src_to_dest, &probe);\n  if (ent)\n    src_to_dest_free (ent);\n}\n\n \n\nextern char *\nsrc_to_dest_lookup (ino_t ino, dev_t dev)\n{\n  struct Src_to_dest ent;\n  struct Src_to_dest const *e;\n  ent.st_ino = ino;\n  ent.st_dev = dev;\n  e = hash_lookup (src_to_dest, &ent);\n  return e ? e->name : nullptr;\n}\n\n \n\nextern char *\nremember_copied (char const *name, ino_t ino, dev_t dev)\n{\n  struct Src_to_dest *ent;\n  struct Src_to_dest *ent_from_table;\n\n  ent = xmalloc (sizeof *ent);\n  ent->name = xstrdup (name);\n  ent->st_ino = ino;\n  ent->st_dev = dev;\n\n  ent_from_table = hash_insert (src_to_dest, ent);\n  if (ent_from_table == nullptr)\n    {\n       \n      xalloc_die ();\n    }\n\n   \n  if (ent_from_table != ent)\n    {\n      src_to_dest_free (ent);\n      return (char *) ent_from_table->name;\n    }\n\n   \n  return nullptr;\n}\n\n \nextern void\nhash_init (void)\n{\n  src_to_dest = hash_initialize (INITIAL_TABLE_SIZE, nullptr,\n                                 src_to_dest_hash,\n                                 src_to_dest_compare,\n                                 src_to_dest_free);\n  if (src_to_dest == nullptr)\n    xalloc_die ();\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}