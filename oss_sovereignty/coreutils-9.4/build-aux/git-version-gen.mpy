{
  "module_name": "git-version-gen",
  "hash_id": "6f216fa2a686c9c88558b61f461736cf8b0b64831dd9d1f7edcd0de881c8b3ae",
  "original_prompt": "Ingested from coreutils-9.4/build-aux/git-version-gen",
  "human_readable_source": "#!/bin/sh\n# Print a version string.\nscriptversion=2022-07-09.08; # UTC\n\n# Copyright (C) 2007-2023 Free Software Foundation, Inc.\n#\n# This program is free software: you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation, either version 3 of the License, or\n# (at your option) any later version.\n#\n# This program is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with this program.  If not, see <https://www.gnu.org/licenses/>.\n\n# This script is derived from GIT-VERSION-GEN from GIT: https://git-scm.com/.\n# It may be run two ways:\n# - from a git repository in which the \"git describe\" command below\n#   produces useful output (thus requiring at least one signed tag)\n# - from a non-git-repo directory containing a .tarball-version file, which\n#   presumes this script is invoked like \"./git-version-gen .tarball-version\".\n\n# In order to use intra-version strings in your project, you will need two\n# separate generated version string files:\n#\n# .tarball-version - present only in a distribution tarball, and not in\n#   a checked-out repository.  Created with contents that were learned at\n#   the last time autoconf was run, and used by git-version-gen.  Must not\n#   be present in either $(srcdir) or $(builddir) for git-version-gen to\n#   give accurate answers during normal development with a checked out tree,\n#   but must be present in a tarball when there is no version control system.\n#   Therefore, it cannot be used in any dependencies.  GNUmakefile has\n#   hooks to force a reconfigure at distribution time to get the value\n#   correct, without penalizing normal development with extra reconfigures.\n#\n# .version - present in a checked-out repository and in a distribution\n#   tarball.  Usable in dependencies, particularly for files that don't\n#   want to depend on config.h but do want to track version changes.\n#   Delete this file prior to any autoconf run where you want to rebuild\n#   files to pick up a version string change; and leave it stale to\n#   minimize rebuild time after unrelated changes to configure sources.\n#\n# As with any generated file in a VC'd directory, you should add\n# /.version to .gitignore, so that you don't accidentally commit it.\n# .tarball-version is never generated in a VC'd directory, so needn't\n# be listed there.\n#\n# Use the following line in your configure.ac, so that $(VERSION) will\n# automatically be up-to-date each time configure is run (and note that\n# since configure.ac no longer includes a version string, Makefile rules\n# should not depend on configure.ac for version updates).\n#\n# AC_INIT([GNU project],\n#         m4_esyscmd([build-aux/git-version-gen .tarball-version]),\n#         [bug-project@example])\n#\n# Then use the following lines in your Makefile.am, so that .version\n# will be present for dependencies, and so that .version and\n# .tarball-version will exist in distribution tarballs.\n#\n# EXTRA_DIST = $(top_srcdir)/.version\n# BUILT_SOURCES = $(top_srcdir)/.version\n# $(top_srcdir)/.version:\n#\techo '$(VERSION)' > $@-t\n#\tmv $@-t $@\n# dist-hook:\n#\techo '$(VERSION)' > $(distdir)/.tarball-version\n\n\nme=$0\n\nyear=`expr \"$scriptversion\" : '\\([^-]*\\)'`\nversion=\"git-version-gen $scriptversion\n\nCopyright (C) ${year} Free Software Foundation, Inc.\nLicense GPLv3+: GNU GPL version 3 or later <https://gnu.org/licenses/gpl.html>.\nThis is free software: you are free to change and redistribute it.\nThere is NO WARRANTY, to the extent permitted by law.\"\n\nusage=\"\\\nUsage: $me [OPTION]... \\$srcdir/.tarball-version [TAG-NORMALIZATION-SED-SCRIPT]\nPrint a version string.\n\nOptions:\n\n   --prefix PREFIX    prefix of git tags (default 'v')\n   --fallback VERSION\n                      fallback version to use if \\\"git --version\\\" fails\n\n   --help             display this help and exit\n   --version          output version information and exit\n\nSend patches and bug reports to <bug-gnulib@gnu.org>.\"\n\nprefix=v\nfallback=\n\nwhile test $# -gt 0; do\n  case $1 in\n    --help) echo \"$usage\"; exit 0;;\n    --version) echo \"$version\"; exit 0;;\n    --prefix) shift; prefix=${1?};;\n    --fallback) shift; fallback=${1?};;\n    -*)\n      echo \"$0: Unknown option '$1'.\" >&2\n      echo \"$0: Try '--help' for more information.\" >&2\n      exit 1;;\n    *)\n      if test \"x$tarball_version_file\" = x; then\n        tarball_version_file=\"$1\"\n      elif test \"x$tag_sed_script\" = x; then\n        tag_sed_script=\"$1\"\n      else\n        echo \"$0: extra non-option argument '$1'.\" >&2\n        exit 1\n      fi;;\n  esac\n  shift\ndone\n\nif test \"x$tarball_version_file\" = x; then\n    echo \"$usage\"\n    exit 1\nfi\n\ntag_sed_script=\"${tag_sed_script:-s/x/x/}\"\n\nnl='\n'\n\n# Avoid meddling by environment variable of the same name.\nv=\nv_from_git=\n\n# First see if there is a tarball-only version file.\n# then try \"git describe\", then default.\nif test -f $tarball_version_file\nthen\n    v=`cat $tarball_version_file` || v=\n    case $v in\n        *$nl*) v= ;; # reject multi-line output\n    esac\n    test \"x$v\" = x \\\n        && echo \"$0: WARNING: $tarball_version_file is damaged\" 1>&2\nfi\n\nif test \"x$v\" != x\nthen\n    : # use $v\n# Otherwise, if there is at least one git commit involving the working\n# directory, and \"git describe\" output looks sensible, use that to\n# derive a version string.\nelif test \"`git log -1 --pretty=format:x . 2>&1`\" = x \\\n    && v=`git describe --abbrev=4 --match=\"$prefix*\" HEAD 2>/dev/null \\\n          || git describe --abbrev=4 HEAD 2>/dev/null` \\\n    && v=`printf '%s\\n' \"$v\" | sed \"$tag_sed_script\"` \\\n    && case $v in\n         $prefix[0-9]*) ;;\n         *) (exit 1) ;;\n       esac\nthen\n    # Is this a new git that lists number of commits since the last\n    # tag or the previous older version that did not?\n    #   Newer: v6.10-77-g0f8faeb\n    #   Older: v6.10-g0f8faeb\n    vprefix=`expr \"X$v\" : 'X\\(.*\\)-g[^-]*$'` || vprefix=$v\n    case $vprefix in\n        *-*) : git describe is probably okay three part flavor ;;\n        *)\n            : git describe is older two part flavor\n            # Recreate the number of commits and rewrite such that the\n            # result is the same as if we were using the newer version\n            # of git describe.\n            vtag=`echo \"$v\" | sed 's/-.*//'`\n            commit_list=`git rev-list \"$vtag\"..HEAD 2>/dev/null` \\\n                || { commit_list=failed;\n                     echo \"$0: WARNING: git rev-list failed\" 1>&2; }\n            numcommits=`echo \"$commit_list\" | wc -l`\n            v=`echo \"$v\" | sed \"s/\\(.*\\)-\\(.*\\)/\\1-$numcommits-\\2/\"`;\n            test \"$commit_list\" = failed && v=UNKNOWN\n            ;;\n    esac\n\n    # Change the penultimate \"-\" to \".\", for version-comparing tools.\n    # Remove the \"g\" to save a byte.\n    v=`echo \"$v\" | sed 's/-\\([^-]*\\)-g\\([^-]*\\)$/.\\1-\\2/'`;\n    v_from_git=1\nelif test \"x$fallback\" = x || git --version >/dev/null 2>&1; then\n    v=UNKNOWN\nelse\n    v=$fallback\nfi\n\nv=`echo \"$v\" |sed \"s/^$prefix//\"`\n\n# Test whether to append the \"-dirty\" suffix only if the version\n# string we're using came from git.  I.e., skip the test if it's \"UNKNOWN\"\n# or if it came from .tarball-version.\nif test \"x$v_from_git\" != x; then\n  # Don't declare a version \"dirty\" merely because a timestamp has changed.\n  git update-index --refresh > /dev/null 2>&1\n\n  dirty=`exec 2>/dev/null;git diff-index --name-only HEAD` || dirty=\n  case \"$dirty\" in\n      '') ;;\n      *) # Append the suffix only if there isn't one already.\n          case $v in\n            *-dirty) ;;\n            *) v=\"$v-dirty\" ;;\n          esac ;;\n  esac\nfi\n\n# Omit the trailing newline, so that m4_esyscmd can use the result directly.\nprintf %s \"$v\"\n\n# Local variables:\n# eval: (add-hook 'before-save-hook 'time-stamp)\n# time-stamp-start: \"scriptversion=\"\n# time-stamp-format: \"%:y-%02m-%02d.%02H\"\n# time-stamp-time-zone: \"UTC0\"\n# time-stamp-end: \"; # UTC\"\n# End:\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}