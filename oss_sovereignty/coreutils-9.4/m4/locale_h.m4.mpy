{
  "module_name": "locale_h.m4",
  "hash_id": "9ac0957a3297764e066fb674eaa78cda75094899c0eac04fcab3fb14dd00585c",
  "original_prompt": "Ingested from coreutils-9.4/m4/locale_h.m4",
  "human_readable_source": "# locale_h.m4 serial 29\ndnl Copyright (C) 2007, 2009-2023 Free Software Foundation, Inc.\ndnl This file is free software; the Free Software Foundation\ndnl gives unlimited permission to copy and/or distribute it,\ndnl with or without modifications, as long as this notice is preserved.\n\nAC_DEFUN_ONCE([gl_LOCALE_H],\n[\n  dnl Ensure to expand the default settings once only, before all statements\n  dnl that occur in other macros.\n  AC_REQUIRE([gl_LOCALE_H_DEFAULTS])\n\n  dnl Persuade glibc <locale.h> to define locale_t and the int_p_*, int_n_*\n  dnl members of 'struct lconv'.\n  AC_REQUIRE([gl_USE_SYSTEM_EXTENSIONS])\n\n  dnl If <stddef.h> is replaced, then <locale.h> must also be replaced.\n  AC_REQUIRE([gl_STDDEF_H])\n\n  AC_REQUIRE([gl_LOCALE_T])\n\n  dnl Solaris 11.0 defines the int_p_*, int_n_* members of 'struct lconv'\n  dnl only if _LCONV_C99 is defined.\n  AC_REQUIRE([AC_CANONICAL_HOST])\n  case \"$host_os\" in\n    solaris*)\n      AC_DEFINE([_LCONV_C99], [1], [Define to 1 on Solaris.])\n      ;;\n  esac\n\n  AC_CACHE_CHECK([whether locale.h conforms to POSIX:2001],\n    [gl_cv_header_locale_h_posix2001],\n    [AC_COMPILE_IFELSE(\n       [AC_LANG_PROGRAM(\n          [[#include <locale.h>\n            int x = LC_MESSAGES;\n            int y = sizeof (((struct lconv *) 0)->decimal_point);]],\n          [[]])],\n       [gl_cv_header_locale_h_posix2001=yes],\n       [gl_cv_header_locale_h_posix2001=no])])\n\n  dnl Check whether 'struct lconv' is complete.\n  dnl Bionic libc's 'struct lconv' is just a dummy.\n  dnl On OpenBSD 4.9, HP-UX 11, IRIX 6.5, OSF/1 5.1, Solaris 9, Cygwin 1.5.x,\n  dnl mingw, MSVC 9, it lacks the int_p_* and int_n_* members.\n  AC_CACHE_CHECK([whether struct lconv is properly defined],\n    [gl_cv_sys_struct_lconv_ok],\n    [AC_COMPILE_IFELSE(\n       [AC_LANG_PROGRAM(\n          [[#include <locale.h>\n            struct lconv l;\n            int x = sizeof (l.decimal_point);\n            int y = sizeof (l.int_p_cs_precedes);]],\n          [[]])],\n       [gl_cv_sys_struct_lconv_ok=yes],\n       [gl_cv_sys_struct_lconv_ok=no])\n    ])\n  if test $gl_cv_sys_struct_lconv_ok = no; then\n    dnl On native Windows with MSVC, merely define these member names as macros.\n    dnl This avoids trouble in C++ mode.\n    case \"$host_os\" in\n      windows*-gnu*)\n        REPLACE_STRUCT_LCONV=1\n        ;;\n      windows*-msvc*)\n        ;;\n      mingw* | windows*)\n        AC_EGREP_CPP([Special], [\n#ifdef _MSC_VER\n Special\n#endif\n          ],\n          [],\n          [REPLACE_STRUCT_LCONV=1])\n        ;;\n      *) REPLACE_STRUCT_LCONV=1 ;;\n    esac\n  fi\n\n  dnl <locale.h> is always overridden, because of GNULIB_POSIXCHECK.\n  gl_NEXT_HEADERS([locale.h])\n\n  dnl Check for declarations of anything we want to poison if the\n  dnl corresponding gnulib module is not in use.\n  gl_WARN_ON_USE_PREPARE([[#include <locale.h>\n/* Some systems provide declarations in a non-standard header.  */\n#if HAVE_XLOCALE_H\n# include <xlocale.h>\n#endif\n    ]],\n    [setlocale newlocale duplocale freelocale])\n])\n\ndnl Checks to determine whether the system has the locale_t type,\ndnl and how to obtain it.\nAC_DEFUN([gl_LOCALE_T],\n[\n  dnl Persuade glibc and Solaris <locale.h> to define locale_t.\n  AC_REQUIRE([gl_USE_SYSTEM_EXTENSIONS])\n\n  dnl Check whether use of locale_t requires inclusion of <xlocale.h>,\n  dnl e.g. on Mac OS X 10.5. If <locale.h> does not define locale_t by\n  dnl itself, we assume that <xlocale.h> will do so.\n  AC_CACHE_CHECK([whether locale.h defines locale_t],\n    [gl_cv_header_locale_has_locale_t],\n    [AC_COMPILE_IFELSE(\n       [AC_LANG_PROGRAM(\n          [[#include <locale.h>\n            locale_t x;]],\n          [[]])],\n       [gl_cv_header_locale_has_locale_t=yes],\n       [gl_cv_header_locale_has_locale_t=no])\n    ])\n\n  dnl Check for <xlocale.h>.\n  AC_CHECK_HEADERS_ONCE([xlocale.h])\n  if test $ac_cv_header_xlocale_h = yes; then\n    HAVE_XLOCALE_H=1\n    if test $gl_cv_header_locale_has_locale_t = yes; then\n      gl_cv_header_locale_h_needs_xlocale_h=no\n    else\n      gl_cv_header_locale_h_needs_xlocale_h=yes\n    fi\n    HAVE_LOCALE_T=1\n  else\n    HAVE_XLOCALE_H=0\n    gl_cv_header_locale_h_needs_xlocale_h=no\n    if test $gl_cv_header_locale_has_locale_t = yes; then\n      HAVE_LOCALE_T=1\n    else\n      HAVE_LOCALE_T=0\n    fi\n  fi\n  AC_SUBST([HAVE_XLOCALE_H])\n])\n\n# gl_LOCALE_MODULE_INDICATOR([modulename])\n# sets the shell variable that indicates the presence of the given module\n# to a C preprocessor expression that will evaluate to 1.\n# This macro invocation must not occur in macros that are AC_REQUIREd.\nAC_DEFUN([gl_LOCALE_MODULE_INDICATOR],\n[\n  dnl Ensure to expand the default settings once only.\n  gl_LOCALE_H_REQUIRE_DEFAULTS\n  gl_MODULE_INDICATOR_SET_VARIABLE([$1])\n  dnl Define it also as a C macro, for the benefit of the unit tests.\n  gl_MODULE_INDICATOR_FOR_TESTS([$1])\n])\n\n# Initializes the default values for AC_SUBSTed shell variables.\n# This macro must not be AC_REQUIREd.  It must only be invoked, and only\n# outside of macros or in macros that are not AC_REQUIREd.\nAC_DEFUN([gl_LOCALE_H_REQUIRE_DEFAULTS],\n[\n  m4_defun(GL_MODULE_INDICATOR_PREFIX[_LOCALE_H_MODULE_INDICATOR_DEFAULTS], [\n    gl_MODULE_INDICATOR_INIT_VARIABLE([GNULIB_LOCALECONV])\n    gl_MODULE_INDICATOR_INIT_VARIABLE([GNULIB_SETLOCALE])\n    gl_MODULE_INDICATOR_INIT_VARIABLE([GNULIB_SETLOCALE_NULL])\n    gl_MODULE_INDICATOR_INIT_VARIABLE([GNULIB_DUPLOCALE])\n    gl_MODULE_INDICATOR_INIT_VARIABLE([GNULIB_LOCALENAME])\n  ])\n  m4_require(GL_MODULE_INDICATOR_PREFIX[_LOCALE_H_MODULE_INDICATOR_DEFAULTS])\n  AC_REQUIRE([gl_LOCALE_H_DEFAULTS])\n])\n\nAC_DEFUN([gl_LOCALE_H_DEFAULTS],\n[\n  dnl Assume proper GNU behavior unless another module says otherwise.\n  HAVE_NEWLOCALE=1;       AC_SUBST([HAVE_NEWLOCALE])\n  HAVE_DUPLOCALE=1;       AC_SUBST([HAVE_DUPLOCALE])\n  HAVE_FREELOCALE=1;      AC_SUBST([HAVE_FREELOCALE])\n  REPLACE_LOCALECONV=0;   AC_SUBST([REPLACE_LOCALECONV])\n  REPLACE_SETLOCALE=0;    AC_SUBST([REPLACE_SETLOCALE])\n  REPLACE_NEWLOCALE=0;    AC_SUBST([REPLACE_NEWLOCALE])\n  REPLACE_DUPLOCALE=0;    AC_SUBST([REPLACE_DUPLOCALE])\n  REPLACE_FREELOCALE=0;   AC_SUBST([REPLACE_FREELOCALE])\n  REPLACE_STRUCT_LCONV=0; AC_SUBST([REPLACE_STRUCT_LCONV])\n  LOCALENAME_ENHANCE_LOCALE_FUNCS=0; AC_SUBST([LOCALENAME_ENHANCE_LOCALE_FUNCS])\n])\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}