{
  "module_name": "mkstemp.m4",
  "hash_id": "f738f5c750dacf1dbc5bfe28ad624c78e7d3549f802ba34675413990bab726cf",
  "original_prompt": "Ingested from coreutils-9.4/m4/mkstemp.m4",
  "human_readable_source": "#serial 30\n\n# Copyright (C) 2001, 2003-2007, 2009-2023 Free Software Foundation, Inc.\n# This file is free software; the Free Software Foundation\n# gives unlimited permission to copy and/or distribute it,\n# with or without modifications, as long as this notice is preserved.\n\n# On some hosts (e.g., HP-UX 10.20, SunOS 4.1.4, Solaris 2.5.1), mkstemp has a\n# silly limit that it can create no more than 26 files from a given template.\n# Other systems lack mkstemp altogether.\n# On OSF1/Tru64 V4.0F, the system-provided mkstemp function can create\n# only 32 files per process.\n# On some hosts, mkstemp creates files with mode 0666, which is a security\n# problem and a violation of POSIX 2008.\n# On systems like the above, arrange to use the replacement function.\nAC_DEFUN([gl_FUNC_MKSTEMP],\n[\n  AC_REQUIRE([gl_STDLIB_H_DEFAULTS])\n  AC_REQUIRE([AC_CANONICAL_HOST]) dnl for cross-compiles\n\n  AC_CHECK_FUNCS_ONCE([mkstemp])\n  if test $ac_cv_func_mkstemp = yes; then\n    AC_CACHE_CHECK([for working mkstemp],\n      [gl_cv_func_working_mkstemp],\n      [\n        mkdir conftest.mkstemp\n        AC_RUN_IFELSE(\n          [AC_LANG_PROGRAM(\n            [AC_INCLUDES_DEFAULT\n             GL_MDA_DEFINES],\n            [[int result = 0;\n              int i;\n              off_t large = (off_t) 4294967295u;\n              if (large < 0)\n                large = 2147483647;\n              umask (0);\n              for (i = 0; i < 70; i++)\n                {\n                  char templ[] = \"conftest.mkstemp/coXXXXXX\";\n                  int (*mkstemp_function) (char *) = mkstemp;\n                  int fd = mkstemp_function (templ);\n                  if (fd < 0)\n                    result |= 1;\n                  else\n                    {\n                      struct stat st;\n                      if (lseek (fd, large, SEEK_SET) != large)\n                        result |= 2;\n                      if (fstat (fd, &st) < 0)\n                        result |= 4;\n                      else if (st.st_mode & 0077)\n                        result |= 8;\n                      if (close (fd))\n                        result |= 16;\n                    }\n                }\n              return result;]])],\n          [gl_cv_func_working_mkstemp=yes],\n          [gl_cv_func_working_mkstemp=no],\n          [case \"$host_os\" in\n                                 # Guess yes on glibc systems.\n             *-gnu* | gnu*)      gl_cv_func_working_mkstemp=\"guessing yes\" ;;\n                                 # Guess yes on musl systems.\n             *-musl* | midipix*) gl_cv_func_working_mkstemp=\"guessing yes\" ;;\n                                 # Guess no on native Windows.\n             mingw* | windows*)  gl_cv_func_working_mkstemp=\"guessing no\" ;;\n                                 # If we don't know, obey --enable-cross-guesses.\n             *)                  gl_cv_func_working_mkstemp=\"$gl_cross_guess_normal\" ;;\n           esac\n          ])\n        rm -rf conftest.mkstemp\n      ])\n    case \"$gl_cv_func_working_mkstemp\" in\n      *yes) ;;\n      *)\n        REPLACE_MKSTEMP=1\n        ;;\n    esac\n  else\n    HAVE_MKSTEMP=0\n  fi\n])\n\n# Prerequisites of lib/mkstemp.c.\nAC_DEFUN([gl_PREREQ_MKSTEMP],\n[\n])\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}