{
  "module_name": "socklen.m4",
  "hash_id": "c8007b5aa86f360f5415680aeb3e49c820d13b3f041fbcdbcf42983393ad227f",
  "original_prompt": "Ingested from coreutils-9.4/m4/socklen.m4",
  "human_readable_source": "# socklen.m4 serial 11\ndnl Copyright (C) 2005-2007, 2009-2023 Free Software Foundation, Inc.\ndnl This file is free software; the Free Software Foundation\ndnl gives unlimited permission to copy and/or distribute it,\ndnl with or without modifications, as long as this notice is preserved.\n\ndnl From Albert Chin, Windows fixes from Simon Josefsson.\n\ndnl Check for socklen_t: historically on BSD it is an int, and in\ndnl POSIX 1g it is a type of its own, but some platforms use different\ndnl types for the argument to getsockopt, getpeername, etc.:\ndnl HP-UX 10.20, IRIX 6.5, OSF/1 4.0, Interix 3.5, BeOS.\ndnl So we have to test to find something that will work.\n\nAC_DEFUN([gl_TYPE_SOCKLEN_T],\n  [AC_REQUIRE([gl_CHECK_SOCKET_HEADERS])dnl\n   AC_CHECK_TYPE([socklen_t], ,\n     [AC_CACHE_CHECK([for socklen_t equivalent],\n        [gl_cv_socklen_t_equiv],\n        [# Systems have either \"struct sockaddr *\" or\n         # \"void *\" as the second argument to getpeername\n         gl_cv_socklen_t_equiv=\n         for arg2 in \"struct sockaddr\" void; do\n           for t in int size_t \"unsigned int\" \"long int\" \"unsigned long int\"; do\n             AC_COMPILE_IFELSE([AC_LANG_PROGRAM(\n                 [[#include <sys/types.h>\n                   #include <sys/socket.h>\n\n                   int getpeername (int, $arg2 *, $t *);]],\n                 [[$t len;\n                  getpeername (0, 0, &len);]])],\n               [gl_cv_socklen_t_equiv=\"$t\"])\n             test \"$gl_cv_socklen_t_equiv\" != \"\" && break\n           done\n           test \"$gl_cv_socklen_t_equiv\" != \"\" && break\n         done\n         if test \"$gl_cv_socklen_t_equiv\" = \"\"; then\n           AC_MSG_ERROR([Cannot find a type to use in place of socklen_t])\n         fi\n        ])\n      AC_DEFINE_UNQUOTED([socklen_t], [$gl_cv_socklen_t_equiv],\n        [type to use in place of socklen_t if not defined])],\n     [gl_SOCKET_HEADERS])])\n\ndnl On mingw32, socklen_t is in ws2tcpip.h ('int'), so we try to find\ndnl it there too.  But on Cygwin, wc2tcpip.h must not be included.  Users\ndnl of this module should use the same include pattern as gl_SOCKET_HEADERS.\ndnl When you change this macro, keep also in sync:\ndnl   - gl_CHECK_SOCKET_HEADERS,\ndnl   - the Include section of modules/socklen.\nAC_DEFUN([gl_SOCKET_HEADERS],\n[\n/* <sys/types.h> is not needed according to POSIX, but the\n   <sys/socket.h> in i386-unknown-freebsd4.10 and\n   powerpc-apple-darwin5.5 required it. */\n#include <sys/types.h>\n#if HAVE_SYS_SOCKET_H\n# include <sys/socket.h>\n#elif HAVE_WS2TCPIP_H\n# include <ws2tcpip.h>\n#endif\n])\n\ndnl Tests for the existence of the header for socket facilities.\ndnl Defines the C macros HAVE_SYS_SOCKET_H, HAVE_WS2TCPIP_H.\ndnl This macro must match gl_SOCKET_HEADERS.\nAC_DEFUN([gl_CHECK_SOCKET_HEADERS],\n  [AC_CHECK_HEADERS_ONCE([sys/socket.h])\n   if test $ac_cv_header_sys_socket_h = no; then\n     dnl We cannot use AC_CHECK_HEADERS_ONCE here, because that would make\n     dnl the check for those headers unconditional; yet cygwin reports\n     dnl that the headers are present but cannot be compiled (since on\n     dnl cygwin, all socket information should come from sys/socket.h).\n     AC_CHECK_HEADERS([ws2tcpip.h])\n   fi\n  ])\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}