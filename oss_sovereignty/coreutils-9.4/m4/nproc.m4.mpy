{
  "module_name": "nproc.m4",
  "hash_id": "6fcbbfb4da34a890061ecf2a4879237c8be32b2f7e32d376c0d906a0c7027654",
  "original_prompt": "Ingested from coreutils-9.4/m4/nproc.m4",
  "human_readable_source": "# nproc.m4 serial 6\ndnl Copyright (C) 2009-2023 Free Software Foundation, Inc.\ndnl This file is free software; the Free Software Foundation\ndnl gives unlimited permission to copy and/or distribute it,\ndnl with or without modifications, as long as this notice is preserved.\n\nAC_DEFUN([gl_NPROC],\n[\n  gl_PREREQ_NPROC\n])\n\n# Prerequisites of lib/nproc.c.\nAC_DEFUN([gl_PREREQ_NPROC],\n[\n  dnl Persuade glibc <sched.h> to declare CPU_SETSIZE, CPU_ISSET etc.\n  AC_REQUIRE([AC_USE_SYSTEM_EXTENSIONS])\n\n  AC_CHECK_HEADERS([sys/pstat.h sys/sysmp.h sys/param.h],,,\n    [AC_INCLUDES_DEFAULT])\n  dnl <sys/sysctl.h> requires <sys/param.h> on OpenBSD 4.0.\n  AC_CHECK_HEADERS([sys/sysctl.h],,,\n    [AC_INCLUDES_DEFAULT\n     #if HAVE_SYS_PARAM_H\n     # include <sys/param.h>\n     #endif\n    ])\n\n  AC_CHECK_FUNCS([sched_getaffinity_np pstat_getdynamic sysmp sysctl])\n  gl_CHECK_FUNCS_ANDROID([sched_getaffinity], [[#include <sched.h>]])\n\n  dnl Test whether sched_getaffinity has the expected declaration.\n  dnl glibc 2.3.[0-2]:\n  dnl   int sched_getaffinity (pid_t, unsigned int, unsigned long int *);\n  dnl glibc 2.3.3:\n  dnl   int sched_getaffinity (pid_t, cpu_set_t *);\n  dnl glibc >= 2.3.4:\n  dnl   int sched_getaffinity (pid_t, size_t, cpu_set_t *);\n  if test $ac_cv_func_sched_getaffinity = yes; then\n    AC_CACHE_CHECK([for glibc compatible sched_getaffinity],\n      [gl_cv_func_sched_getaffinity3],\n      [AC_COMPILE_IFELSE(\n         [AC_LANG_PROGRAM(\n            [[#include <errno.h>\n              #include <sched.h>]],\n            [[sched_getaffinity (0, 0, (cpu_set_t *) 0);]])],\n         [gl_cv_func_sched_getaffinity3=yes],\n         [gl_cv_func_sched_getaffinity3=no])\n      ])\n    if test $gl_cv_func_sched_getaffinity3 = yes; then\n      AC_DEFINE([HAVE_SCHED_GETAFFINITY_LIKE_GLIBC], [1],\n        [Define to 1 if sched_getaffinity has a glibc compatible declaration.])\n    fi\n  fi\n])\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}