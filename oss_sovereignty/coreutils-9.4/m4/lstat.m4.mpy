{
  "module_name": "lstat.m4",
  "hash_id": "91b2f023cb046fc5c2156cea21cb28f8abda1a721c54d0ec6e7b59e7fa64ac4d",
  "original_prompt": "Ingested from coreutils-9.4/m4/lstat.m4",
  "human_readable_source": "# serial 35\n\n# Copyright (C) 1997-2001, 2003-2023 Free Software Foundation, Inc.\n#\n# This file is free software; the Free Software Foundation\n# gives unlimited permission to copy and/or distribute it,\n# with or without modifications, as long as this notice is preserved.\n\ndnl From Jim Meyering.\n\nAC_DEFUN([gl_FUNC_LSTAT],\n[\n  AC_REQUIRE([AC_CANONICAL_HOST])\n  AC_REQUIRE([gl_SYS_STAT_H_DEFAULTS])\n  dnl If lstat does not exist, the replacement <sys/stat.h> does\n  dnl \"#define lstat stat\", and lstat.c is a no-op.\n  AC_CHECK_FUNCS_ONCE([lstat])\n  if test $ac_cv_func_lstat = yes; then\n    AC_REQUIRE([gl_FUNC_LSTAT_FOLLOWS_SLASHED_SYMLINK])\n    case $host_os,$gl_cv_func_lstat_dereferences_slashed_symlink in\n      solaris* | *no)\n        REPLACE_LSTAT=1\n        ;;\n    esac\n  else\n    HAVE_LSTAT=0\n  fi\n])\n\n# Prerequisites of lib/lstat.c.\nAC_DEFUN([gl_PREREQ_LSTAT], [:])\n\nAC_DEFUN([gl_FUNC_LSTAT_FOLLOWS_SLASHED_SYMLINK],\n[\n  dnl We don't use AC_FUNC_LSTAT_FOLLOWS_SLASHED_SYMLINK any more, because it\n  dnl is no longer maintained in Autoconf and because it invokes AC_LIBOBJ.\n  AC_REQUIRE([AC_CANONICAL_HOST]) dnl for cross-compiles\n  AC_CACHE_CHECK([whether lstat correctly handles trailing slash],\n    [gl_cv_func_lstat_dereferences_slashed_symlink],\n    [rm -f conftest.sym conftest.file\n     echo >conftest.file\n     AC_RUN_IFELSE(\n       [AC_LANG_PROGRAM(\n          [AC_INCLUDES_DEFAULT],\n          [[struct stat sbuf;\n            if (symlink (\"conftest.file\", \"conftest.sym\") != 0)\n              return 1;\n            /* Linux will dereference the symlink and fail, as required by\n               POSIX.  That is better in the sense that it means we will not\n               have to compile and use the lstat wrapper.  */\n            return lstat (\"conftest.sym/\", &sbuf) == 0;\n          ]])],\n       [gl_cv_func_lstat_dereferences_slashed_symlink=yes],\n       [gl_cv_func_lstat_dereferences_slashed_symlink=no],\n       [case \"$host_os\" in\n          linux-* | linux)\n            # Guess yes on Linux systems.\n            gl_cv_func_lstat_dereferences_slashed_symlink=\"guessing yes\" ;;\n          midipix*)\n            # Guess yes on systems that emulate the Linux system calls.\n            gl_cv_func_lstat_dereferences_slashed_symlink=\"guessing yes\" ;;\n          *-gnu* | gnu*)\n            # Guess yes on glibc systems.\n            gl_cv_func_lstat_dereferences_slashed_symlink=\"guessing yes\" ;;\n          mingw* | windows*)\n            # Guess no on native Windows.\n            gl_cv_func_lstat_dereferences_slashed_symlink=\"guessing no\" ;;\n          *)\n            # If we don't know, obey --enable-cross-guesses.\n            gl_cv_func_lstat_dereferences_slashed_symlink=\"$gl_cross_guess_normal\" ;;\n        esac\n       ])\n     rm -f conftest.sym conftest.file\n    ])\n  case \"$gl_cv_func_lstat_dereferences_slashed_symlink\" in\n    *yes)\n      AC_DEFINE_UNQUOTED([LSTAT_FOLLOWS_SLASHED_SYMLINK], [1],\n        [Define to 1 if 'lstat' dereferences a symlink specified\n         with a trailing slash.])\n      ;;\n  esac\n])\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}