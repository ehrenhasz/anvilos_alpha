{
  "module_name": "c32rtomb.m4",
  "hash_id": "f0b0d43278a232643b4a3189765c50eb59d9fff03214e6a5bdbb2ddf45c20050",
  "original_prompt": "Ingested from coreutils-9.4/m4/c32rtomb.m4",
  "human_readable_source": "# c32rtomb.m4 serial 6\ndnl Copyright (C) 2020-2023 Free Software Foundation, Inc.\ndnl This file is free software; the Free Software Foundation\ndnl gives unlimited permission to copy and/or distribute it,\ndnl with or without modifications, as long as this notice is preserved.\n\nAC_DEFUN([gl_FUNC_C32RTOMB],\n[\n  AC_REQUIRE([gl_UCHAR_H_DEFAULTS])\n\n  AC_REQUIRE([gl_MBRTOC32_SANITYCHECK])\n\n  dnl Cf. gl_CHECK_FUNCS_ANDROID\n  AC_CHECK_DECL([c32rtomb], , ,\n    [[#ifdef __HAIKU__\n       #include <stdint.h>\n      #endif\n      #include <uchar.h>\n    ]])\n  if test $ac_cv_have_decl_c32rtomb = yes; then\n    dnl We can't use AC_CHECK_FUNC here, because c32rtomb() is defined as a\n    dnl static inline function on Haiku 2020.\n    AC_CACHE_CHECK([for c32rtomb], [gl_cv_func_c32rtomb],\n      [AC_LINK_IFELSE(\n         [AC_LANG_PROGRAM(\n            [[#include <stdlib.h>\n              #ifdef __HAIKU__\n               #include <stdint.h>\n              #endif\n              #include <uchar.h>\n            ]],\n            [[char buf[8];\n              return c32rtomb (buf, 0, NULL) == 0;\n            ]])\n         ],\n         [gl_cv_func_c32rtomb=yes],\n         [gl_cv_func_c32rtomb=no])\n      ])\n  else\n    gl_cv_func_c32rtomb=no\n  fi\n  if test $gl_cv_func_c32rtomb = no; then\n    HAVE_C32RTOMB=0\n  else\n    dnl When we override mbrtoc32, redefining the meaning of the char32_t\n    dnl values, we need to override c32rtomb as well, for consistency.\n    if test $HAVE_WORKING_MBRTOC32 = 0; then\n      REPLACE_C32RTOMB=1\n    fi\n    AC_CACHE_CHECK([whether c32rtomb return value is correct],\n      [gl_cv_func_c32rtomb_retval],\n      [\n        dnl Initial guess, used when cross-compiling.\nchangequote(,)dnl\n        case \"$host_os\" in\n          # Guess no on AIX.\n          aix*) gl_cv_func_c32rtomb_retval=\"guessing no\" ;;\n          # Guess yes otherwise.\n          *)    gl_cv_func_c32rtomb_retval=\"guessing yes\" ;;\n        esac\nchangequote([,])dnl\n        AC_RUN_IFELSE(\n          [AC_LANG_SOURCE([[\n#include <stddef.h>\n#ifdef __HAIKU__\n #include <stdint.h>\n#endif\n#include <uchar.h>\nint main ()\n{\n  int result = 0;\n  if (c32rtomb (NULL, 0, NULL) != 1)\n    result |= 1;\n  return result;\n}]])],\n          [gl_cv_func_c32rtomb_retval=yes],\n          [gl_cv_func_c32rtomb_retval=no],\n          [:])\n      ])\n    case \"$gl_cv_func_c32rtomb_retval\" in\n      *yes) ;;\n      *) AC_DEFINE([C32RTOMB_RETVAL_BUG], [1],\n           [Define if the c32rtomb function has an incorrect return value.])\n         REPLACE_C32RTOMB=1 ;;\n    esac\n  fi\n])\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}