{
  "module_name": "time_r.m4",
  "hash_id": "b4710cc0d09848e2598e60a30207e1550d7ae9457f3dbc09bf11112e4f2e3d19",
  "original_prompt": "Ingested from coreutils-9.4/m4/time_r.m4",
  "human_readable_source": "dnl Reentrant time functions: localtime_r, gmtime_r.\n\ndnl Copyright (C) 2003, 2006-2023 Free Software Foundation, Inc.\ndnl This file is free software; the Free Software Foundation\ndnl gives unlimited permission to copy and/or distribute it,\ndnl with or without modifications, as long as this notice is preserved.\n\ndnl Written by Paul Eggert.\n\nAC_DEFUN([gl_TIME_R],\n[\n  dnl Persuade glibc and Solaris <time.h> to declare localtime_r.\n  AC_REQUIRE([gl_USE_SYSTEM_EXTENSIONS])\n\n  AC_REQUIRE([gl_TIME_H_DEFAULTS])\n  AC_REQUIRE([AC_C_RESTRICT])\n\n  dnl Some systems don't declare localtime_r() and gmtime_r() if _REENTRANT is\n  dnl not defined.\n  AC_CHECK_DECLS([localtime_r], [], [],\n    [[/* mingw's <time.h> provides the functions asctime_r, ctime_r,\n         gmtime_r, localtime_r only if <unistd.h> or <pthread.h> has\n         been included before.  */\n      #if defined __MINGW32__\n      # include <unistd.h>\n      #endif\n      #include <time.h>\n    ]])\n  if test $ac_cv_have_decl_localtime_r = no; then\n    HAVE_DECL_LOCALTIME_R=0\n  fi\n\n  AC_CHECK_FUNCS_ONCE([localtime_r])\n  if test $ac_cv_func_localtime_r = yes; then\n    HAVE_LOCALTIME_R=1\n    AC_CACHE_CHECK([whether localtime_r is compatible with its POSIX signature],\n      [gl_cv_time_r_posix],\n      [AC_COMPILE_IFELSE(\n         [AC_LANG_PROGRAM(\n            [[/* mingw's <time.h> provides the functions asctime_r, ctime_r,\n                 gmtime_r, localtime_r only if <unistd.h> or <pthread.h> has\n                 been included before.  */\n              #if defined __MINGW32__\n              # include <unistd.h>\n              #endif\n              #include <time.h>\n            ]],\n            [[/* We don't need to append 'restrict's to the argument types,\n                 even though the POSIX signature has the 'restrict's,\n                 since C99 says they can't affect type compatibility.  */\n              struct tm * (*ptr) (time_t const *, struct tm *) = localtime_r;\n              if (ptr) return 0;\n              /* Check the return type is a pointer.\n                 On HP-UX 10 it is 'int'.  */\n              *localtime_r (0, 0);]])\n         ],\n         [gl_cv_time_r_posix=yes],\n         [gl_cv_time_r_posix=no])\n      ])\n    if test $gl_cv_time_r_posix != yes; then\n      REPLACE_LOCALTIME_R=1\n    fi\n  else\n    HAVE_LOCALTIME_R=0\n    dnl On mingw, localtime_r() is defined as an inline function; use through a\n    dnl direct function call works but the use as a function pointer leads to a\n    dnl link error.\n    AC_CACHE_CHECK([whether localtime_r exists as an inline function],\n      [gl_cv_func_localtime_r_inline],\n      [AC_LINK_IFELSE(\n         [AC_LANG_PROGRAM(\n            [[/* mingw's <time.h> provides the functions asctime_r, ctime_r,\n                 gmtime_r, localtime_r only if <unistd.h> or <pthread.h> has\n                 been included before.  */\n              #if defined __MINGW32__\n              # include <unistd.h>\n              #endif\n              #include <time.h>\n            ]],\n            [[time_t a;\n              struct tm r;\n              localtime_r (&a, &r);\n            ]])\n         ],\n         [gl_cv_func_localtime_r_inline=yes],\n         [gl_cv_func_localtime_r_inline=no])\n      ])\n    if test $gl_cv_func_localtime_r_inline = yes; then\n      REPLACE_LOCALTIME_R=1\n    fi\n  fi\n])\n\n# Prerequisites of lib/time_r.c.\nAC_DEFUN([gl_PREREQ_TIME_R], [\n  :\n])\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}