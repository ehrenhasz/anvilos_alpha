{
  "module_name": "libunistring-base.m4",
  "hash_id": "b879bd85df3249f13393a7c86a3b82a445728603ccf84f96d721025c3f8ed636",
  "original_prompt": "Ingested from coreutils-9.4/m4/libunistring-base.m4",
  "human_readable_source": "# libunistring-base.m4 serial 8\ndnl Copyright (C) 2010-2023 Free Software Foundation, Inc.\ndnl This file is free software; the Free Software Foundation\ndnl gives unlimited permission to copy and/or distribute it,\ndnl with or without modifications, as long as this notice is preserved.\n\ndnl From Paolo Bonzini and Bruno Haible.\n\ndnl gl_LIBUNISTRING_MODULE([VERSION], [Module])\ndnl Declares that the source files of Module should be compiled, unless we\ndnl are linking with libunistring and its version is >= the given VERSION.\ndnl Defines an automake conditional LIBUNISTRING_COMPILE_$MODULE that is\ndnl true if the source files of Module should be compiled.\ndnl This macro is to be used for public libunistring API, not for\ndnl undocumented API.\ndnl\ndnl You have to bump the VERSION argument to the next projected version\ndnl number each time you make a change that affects the behaviour of the\ndnl functions defined in Module (even if the sources of Module itself do not\ndnl change).\ndnl\ndnl This macro invocation must not occur in macros that are AC_REQUIREd.\n\nAC_DEFUN([gl_LIBUNISTRING_MODULE],\n[\n  AC_REQUIRE([gl_LIBUNISTRING_LIB_PREPARE])\n  dnl Use the variables HAVE_LIBUNISTRING, LIBUNISTRING_VERSION from\n  dnl gl_LIBUNISTRING_CORE if that macro has been run.\n  gl_CONDITIONAL(AS_TR_CPP([LIBUNISTRING_COMPILE_$2]),\n    [gl_LIBUNISTRING_VERSION_CMP([$1])])\n])\n\ndnl gl_LIBUNISTRING_MODULE_WITH_VARIABLE([VERSION], [Module])\ndnl is like gl_LIBUNISTRING_MODULE([VERSION], [Module]), except that it also\ndnl defines an AC_SUBSTed autoconf variable GNULIB_$MODULE_DLL_VARIABLE.\ndnl What's the expansion of this autoconf variable?\ndnl   - When building libunistring, it expands to LIBUNISTRING_DLL_VARIABLE.\ndnl     (This is necessary because this token must be present in the .h files\ndnl     when the .h files get installed.)\ndnl   - When building gnulib or application code it expands to\ndnl       - LIBUNISTRING_DLL_VARIABLE by default,\ndnl       - empty if the automake conditional LIBUNISTRING_COMPILE_$MODULE\ndnl         evaluates to true.\ndnl     (This is necessary because when the conditional evaluates to false,\ndnl     the application code expects to use the declared variable from the\ndnl     installed libunistring; it's in this case that the\ndnl     LIBUNISTRING_DLL_VARIABLE macro from the installed\ndnl     <unistring/woe32dll.h> must be used.)\ndnl\ndnl This macro invocation must not occur in macros that are AC_REQUIREd.\n\nAC_DEFUN([gl_LIBUNISTRING_MODULE_WITH_VARIABLE],\n[\n  gl_LIBUNISTRING_MODULE([$1], [$2])\n  m4_ifndef([gl_IN_LIBUNISTRING],\n    [if test -z \"${AS_TR_CPP([LIBUNISTRING_COMPILE_$2])_TRUE}\"; then\n       GL_MODULE_INDICATOR_PREFIX[]_GNULIB_[]AS_TR_CPP([$2_DLL_VARIABLE])=\n     fi\n    ])\n])\n\ndnl gl_LIBUNISTRING_LIBHEADER([VERSION], [HeaderFile])\ndnl Declares that HeaderFile should be created, unless we are linking\ndnl with libunistring and its version is >= the given VERSION.\ndnl HeaderFile should be relative to the lib directory and end in '.h'.\ndnl Prepares for substituting LIBUNISTRING_HEADERFILE (to HeaderFile or empty).\ndnl\ndnl When we are linking with the already installed libunistring and its version\ndnl is < VERSION, we create HeaderFile here, because we may compile functions\ndnl (via gl_LIBUNISTRING_MODULE above) that are not contained in the installed\ndnl version.\ndnl When we are linking with the already installed libunistring and its version\ndnl is > VERSION, we don't create HeaderFile here: it could cause compilation\ndnl errors in other libunistring header files if some types are missing.\ndnl\ndnl You have to bump the VERSION argument to the next projected version\ndnl number each time you make a non-comment change to the HeaderFile.\n\nAC_DEFUN([gl_LIBUNISTRING_LIBHEADER],\n[\n  AC_REQUIRE([gl_LIBUNISTRING_LIB_PREPARE])\n  dnl Use the variables HAVE_LIBUNISTRING, LIBUNISTRING_VERSION from\n  dnl gl_LIBUNISTRING_CORE if that macro has been run.\n  if gl_LIBUNISTRING_VERSION_CMP([$1]); then\n    dnl It is OK to use a .h file in lib/ from within tests/, but not vice\n    dnl versa.\n    if test -z \"$LIBUNISTRING_[]AS_TR_CPP([$2])\"; then\n      LIBUNISTRING_[]AS_TR_CPP([$2])=\"${gl_source_base_prefix}$2\"\n    fi\n  else\n    LIBUNISTRING_[]AS_TR_CPP([$2])=\n  fi\n  AC_SUBST([LIBUNISTRING_]AS_TR_CPP([$2]))\n])\n\ndnl Miscellaneous preparations/initializations.\n\nAC_DEFUN([gl_LIBUNISTRING_LIB_PREPARE],\n[\n  dnl Ensure that HAVE_LIBUNISTRING is fully determined at this point.\n  m4_ifdef([gl_LIBUNISTRING], [AC_REQUIRE([gl_LIBUNISTRING])])\n\n  AC_REQUIRE([AC_PROG_AWK])\n\ndnl Sed expressions to extract the parts of a version number.\nchangequote(,)\ngl_libunistring_sed_extract_major='/^[0-9]/{s/^\\([0-9]*\\).*/\\1/p;q;}\ni\\\n0\nq\n'\ngl_libunistring_sed_extract_minor='/^[0-9][0-9]*[.][0-9]/{s/^[0-9]*[.]\\([0-9]*\\).*/\\1/p;q;}\ni\\\n0\nq\n'\ngl_libunistring_sed_extract_subminor='/^[0-9][0-9]*[.][0-9][0-9]*[.][0-9]/{s/^[0-9]*[.][0-9]*[.]\\([0-9]*\\).*/\\1/p;q;}\ni\\\n0\nq\n'\nchangequote([,])\n\n  if test \"$HAVE_LIBUNISTRING\" = yes; then\n    LIBUNISTRING_VERSION_MAJOR=`echo \"$LIBUNISTRING_VERSION\" | sed -n -e \"$gl_libunistring_sed_extract_major\"`\n    LIBUNISTRING_VERSION_MINOR=`echo \"$LIBUNISTRING_VERSION\" | sed -n -e \"$gl_libunistring_sed_extract_minor\"`\n    LIBUNISTRING_VERSION_SUBMINOR=`echo \"$LIBUNISTRING_VERSION\" | sed -n -e \"$gl_libunistring_sed_extract_subminor\"`\n  fi\n\n  dnl Determine whether <unistring/woe32dll.h> from an installed libunistring\n  dnl is available.\n  m4_ifdef([gl_IN_LIBUNISTRING],\n    [dnl In libunistring, all .h files that declare variables need to\n     dnl #include <unistring/woe32dll.h>.  This references the file\n     dnl unistring/woe32dll.h in libunistring.\n     HAVE_UNISTRING_WOE32DLL_H=1\n    ],\n    [dnl In gnulib or in applications, we need a #include <unistring/woe32dll.h>\n     dnl if and only if an installed libunistring is available.\n     if test \"$HAVE_LIBUNISTRING\" = yes; then\n       AC_CHECK_HEADERS([unistring/woe32dll.h],\n         [HAVE_UNISTRING_WOE32DLL_H=1],\n         [HAVE_UNISTRING_WOE32DLL_H=0])\n     else\n       HAVE_UNISTRING_WOE32DLL_H=0\n     fi\n    ])\n  AC_SUBST([HAVE_UNISTRING_WOE32DLL_H])\n])\n\ndnl gl_LIBUNISTRING_VERSION_CMP([VERSION])\ndnl Expands to a shell statement that evaluates to true if LIBUNISTRING_VERSION\ndnl is less than the VERSION argument.\nAC_DEFUN([gl_LIBUNISTRING_VERSION_CMP],\n[ { test \"$HAVE_LIBUNISTRING\" != yes \\\n    || {\n         dnl AS_LITERAL_IF exists and works fine since autoconf-2.59 at least.\n         AS_LITERAL_IF([$1],\n           [dnl This is the optimized variant, that assumes the argument is a literal:\n            m4_pushdef([requested_version_major],\n              [gl_LIBUNISTRING_ARG_OR_ZERO(m4_bpatsubst([$1], [^\\([0-9]*\\).*], [\\1]), [])])\n            m4_pushdef([requested_version_minor],\n              [gl_LIBUNISTRING_ARG_OR_ZERO(m4_bpatsubst([$1], [^[0-9]*[.]\\([0-9]*\\).*], [\\1]), [$1])])\n            m4_pushdef([requested_version_subminor],\n              [gl_LIBUNISTRING_ARG_OR_ZERO(m4_bpatsubst([$1], [^[0-9]*[.][0-9]*[.]\\([0-9]*\\).*], [\\1]), [$1])])\n            test $LIBUNISTRING_VERSION_MAJOR -lt requested_version_major \\\n            || { test $LIBUNISTRING_VERSION_MAJOR -eq requested_version_major \\\n                 && { test $LIBUNISTRING_VERSION_MINOR -lt requested_version_minor \\\n                      || { test $LIBUNISTRING_VERSION_MINOR -eq requested_version_minor \\\n                           && test $LIBUNISTRING_VERSION_SUBMINOR -lt requested_version_subminor\n                         }\n                    }\n               }\n            m4_popdef([requested_version_subminor])\n            m4_popdef([requested_version_minor])\n            m4_popdef([requested_version_major])\n           ],\n           [dnl This is the unoptimized variant:\n            requested_version_major=`echo '$1' | sed -n -e \"$gl_libunistring_sed_extract_major\"`\n            requested_version_minor=`echo '$1' | sed -n -e \"$gl_libunistring_sed_extract_minor\"`\n            requested_version_subminor=`echo '$1' | sed -n -e \"$gl_libunistring_sed_extract_subminor\"`\n            test $LIBUNISTRING_VERSION_MAJOR -lt $requested_version_major \\\n            || { test $LIBUNISTRING_VERSION_MAJOR -eq $requested_version_major \\\n                 && { test $LIBUNISTRING_VERSION_MINOR -lt $requested_version_minor \\\n                      || { test $LIBUNISTRING_VERSION_MINOR -eq $requested_version_minor \\\n                           && test $LIBUNISTRING_VERSION_SUBMINOR -lt $requested_version_subminor\n                         }\n                    }\n               }\n           ])\n       }\n  }])\n\ndnl gl_LIBUNISTRING_ARG_OR_ZERO([ARG], [ORIG]) expands to ARG if it is not the\ndnl same as ORIG, otherwise to 0.\nm4_define([gl_LIBUNISTRING_ARG_OR_ZERO], [m4_if([$1], [$2], [0], [$1])])\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}