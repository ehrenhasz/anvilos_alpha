{
  "module_name": "iswdigit.m4",
  "hash_id": "d88dbcaf6062673c14375458c008e9c180c602bd1d578dd86bbfa25f1f28b2a3",
  "original_prompt": "Ingested from coreutils-9.4/m4/iswdigit.m4",
  "human_readable_source": "# iswdigit.m4 serial 5\ndnl Copyright (C) 2020-2023 Free Software Foundation, Inc.\ndnl This file is free software; the Free Software Foundation\ndnl gives unlimited permission to copy and/or distribute it,\ndnl with or without modifications, as long as this notice is preserved.\n\nAC_DEFUN([gl_FUNC_ISWDIGIT],\n[\n  AC_REQUIRE([gl_WCTYPE_H_DEFAULTS])\n  AC_REQUIRE([gl_WCTYPE_H])\n  AC_REQUIRE([gt_LOCALE_FR])\n  AC_REQUIRE([gt_LOCALE_JA])\n  AC_REQUIRE([gt_LOCALE_FR_UTF8])\n  AC_REQUIRE([gt_LOCALE_ZH_CN])\n\n  if test $HAVE_ISWCNTRL = 0 || test $REPLACE_ISWCNTRL = 1; then\n    dnl <wctype.h> redefines iswdigit already.\n    REPLACE_ISWDIGIT=\"$REPLACE_ISWCNTRL\"\n  else\n    AC_CACHE_CHECK([whether iswdigit is ISO C compliant],\n      [gl_cv_func_iswdigit_works],\n      [\n       dnl Initial guess, used when cross-compiling or when no suitable locale\n       dnl is present.\nchangequote(,)dnl\n       case \"$host_os\" in\n         # Guess no on FreeBSD, NetBSD, Solaris, native Windows.\n         freebsd* | dragonfly* | netbsd* | solaris* | mingw* | windows*)\n           gl_cv_func_iswdigit_works=\"guessing no\" ;;\n         # Guess yes otherwise.\n         *) gl_cv_func_iswdigit_works=\"guessing yes\" ;;\n       esac\nchangequote([,])dnl\n       if test $LOCALE_FR != none || test $LOCALE_JA != none || test $LOCALE_FR_UTF8 != none || test $LOCALE_ZH_CN != none; then\n         AC_RUN_IFELSE(\n           [AC_LANG_SOURCE([[\n#include <locale.h>\n#include <stdlib.h>\n#include <string.h>\n#include <wchar.h>\n#include <wctype.h>\n\n/* Returns the value of iswdigit for the multibyte character s[0..n-1].  */\nstatic int\nfor_character (const char *s, size_t n)\n{\n  mbstate_t state;\n  wchar_t wc;\n  size_t ret;\n\n  memset (&state, '\\0', sizeof (mbstate_t));\n  wc = (wchar_t) 0xBADFACE;\n  ret = mbrtowc (&wc, s, n, &state);\n  if (ret != n)\n    abort ();\n\n  return iswdigit (wc);\n}\n\nint\nmain (int argc, char *argv[])\n{\n  int is;\n  int result = 0;\n\n  if (strcmp (\"$LOCALE_FR\", \"none\") != 0\n      && setlocale (LC_ALL, \"$LOCALE_FR\") != NULL)\n    {\n      /* This fails on mingw, MSVC 14.  */\n      /* U+00B2 SUPERSCRIPT TWO */\n      is = for_character (\"\\262\", 1);\n      if (!(is == 0))\n        result |= 1;\n    }\n  if (strcmp (\"$LOCALE_JA\", \"none\") != 0\n      && setlocale (LC_ALL, \"$LOCALE_JA\") != NULL)\n    {\n      /* This fails on NetBSD 8.0.  */\n      /* U+FF11 FULLWIDTH DIGIT ONE */\n      is = for_character (\"\\243\\261\", 2);\n      if (!(is == 0))\n        result |= 2;\n    }\n  if (strcmp (\"$LOCALE_FR_UTF8\", \"none\") != 0\n      && setlocale (LC_ALL, \"$LOCALE_FR_UTF8\") != NULL)\n    {\n      /* This fails on FreeBSD 13.0, NetBSD 8.0, MSVC 14.  */\n      /* U+0663 ARABIC-INDIC DIGIT THREE */\n      is = for_character (\"\\331\\243\", 2);\n      if (!(is == 0))\n        result |= 4;\n      /* This fails on FreeBSD 13.0, NetBSD 8.0, MSVC 14.  */\n      /* U+FF11 FULLWIDTH DIGIT ONE */\n      is = for_character (\"\\357\\274\\221\", 3);\n      if (!(is == 0))\n        result |= 8;\n    }\n  if (strcmp (\"$LOCALE_ZH_CN\", \"none\") != 0\n      && setlocale (LC_ALL, \"$LOCALE_ZH_CN\") != NULL)\n    {\n      /* This fails on NetBSD 8.0, Solaris 10, Solaris 11.4.  */\n      /* U+FF11 FULLWIDTH DIGIT ONE */\n      is = for_character (\"\\243\\261\", 2);\n      if (!(is == 0))\n        result |= 16;\n    }\n  return result;\n}]])],\n           [gl_cv_func_iswdigit_works=yes],\n           [gl_cv_func_iswdigit_works=no],\n           [:])\n       fi\n      ])\n    case \"$gl_cv_func_iswdigit_works\" in\n      *yes) ;;\n      *) REPLACE_ISWDIGIT=1 ;;\n    esac\n  fi\n])\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}