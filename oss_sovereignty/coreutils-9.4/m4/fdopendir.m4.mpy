{
  "module_name": "fdopendir.m4",
  "hash_id": "0c7f344d1b9c3d9b41d6449a83fc1a674a067a6e1d93fefe7cd2f2eaed258378",
  "original_prompt": "Ingested from coreutils-9.4/m4/fdopendir.m4",
  "human_readable_source": "# serial 15\n# See if we need to provide fdopendir.\n\ndnl Copyright (C) 2009-2023 Free Software Foundation, Inc.\ndnl This file is free software; the Free Software Foundation\ndnl gives unlimited permission to copy and/or distribute it,\ndnl with or without modifications, as long as this notice is preserved.\n\n# Written by Eric Blake.\n\nAC_DEFUN([gl_FUNC_FDOPENDIR],\n[\n  AC_REQUIRE([gl_DIRENT_H_DEFAULTS])\n  AC_REQUIRE([AC_CANONICAL_HOST]) dnl for cross-compiles\n\n  AC_REQUIRE([gl_USE_SYSTEM_EXTENSIONS])\n\n  dnl FreeBSD 7.3 has the function, but failed to declare it.\n  AC_CHECK_DECLS([fdopendir], [], [HAVE_DECL_FDOPENDIR=0], [[\n#include <dirent.h>\n    ]])\n  AC_CHECK_FUNCS_ONCE([fdopendir])\n  if test $ac_cv_func_fdopendir = no; then\n    HAVE_FDOPENDIR=0\n  else\n    AC_CACHE_CHECK([whether fdopendir works],\n      [gl_cv_func_fdopendir_works],\n      [AC_RUN_IFELSE(\n         [AC_LANG_PROGRAM([[\n#include <dirent.h>\n#include <fcntl.h>\n#include <unistd.h>\n]GL_MDA_DEFINES[\n#if !HAVE_DECL_FDOPENDIR\nextern\n# ifdef __cplusplus\n\"C\"\n# endif\nDIR *fdopendir (int);\n#endif\n]],\n            [[int result = 0;\n              int fd = open (\"conftest.c\", O_RDONLY);\n              if (fd < 0) result |= 1;\n              if (fdopendir (fd)) result |= 2;\n              if (close (fd)) result |= 4;\n              return result;\n            ]])],\n         [gl_cv_func_fdopendir_works=yes],\n         [gl_cv_func_fdopendir_works=no],\n         [case \"$host_os\" in\n                                # Guess yes on glibc systems.\n            *-gnu*)             gl_cv_func_fdopendir_works=\"guessing yes\" ;;\n                                # Guess yes on musl systems.\n            *-musl* | midipix*) gl_cv_func_fdopendir_works=\"guessing yes\" ;;\n                                # If we don't know, obey --enable-cross-guesses.\n            *)                  gl_cv_func_fdopendir_works=\"$gl_cross_guess_normal\" ;;\n          esac\n         ])])\n    case \"$gl_cv_func_fdopendir_works\" in\n      *yes) ;;\n      *)\n        REPLACE_FDOPENDIR=1\n        ;;\n    esac\n  fi\n])\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}