{
  "module_name": "wchar_h.m4",
  "hash_id": "7a0289dadf505fb97f007385de71cab41f592385937a2c218c101ce700b86cc1",
  "original_prompt": "Ingested from coreutils-9.4/m4/wchar_h.m4",
  "human_readable_source": "dnl A placeholder for ISO C99 <wchar.h>, for platforms that have issues.\n\ndnl Copyright (C) 2007-2023 Free Software Foundation, Inc.\ndnl This file is free software; the Free Software Foundation\ndnl gives unlimited permission to copy and/or distribute it,\ndnl with or without modifications, as long as this notice is preserved.\n\ndnl Written by Eric Blake.\n\n# wchar_h.m4 serial 61\n\nAC_DEFUN_ONCE([gl_WCHAR_H],\n[\n  AC_REQUIRE([gl_WCHAR_H_DEFAULTS])\n  AC_REQUIRE([gl_WCHAR_H_INLINE_OK])\n  dnl Prepare for creating substitute <wchar.h>.\n  dnl Check for <wchar.h> (missing in Linux uClibc when built without wide\n  dnl character support).\n  dnl <wchar.h> is always overridden, because of GNULIB_POSIXCHECK.\n  gl_CHECK_NEXT_HEADERS([wchar.h])\n  if test $ac_cv_header_wchar_h = yes; then\n    HAVE_WCHAR_H=1\n  else\n    HAVE_WCHAR_H=0\n  fi\n  AC_SUBST([HAVE_WCHAR_H])\n\n  AC_REQUIRE([gl_FEATURES_H])\n\n  AC_REQUIRE([gt_TYPE_WINT_T])\n  if test $gt_cv_c_wint_t = yes; then\n    HAVE_WINT_T=1\n  else\n    HAVE_WINT_T=0\n  fi\n  AC_SUBST([HAVE_WINT_T])\n\n  AC_REQUIRE([gl_TYPE_WINT_T_PREREQ])\n\n  dnl Check for declarations of anything we want to poison if the\n  dnl corresponding gnulib module is not in use.\n  gl_WARN_ON_USE_PREPARE([[\n      #include <wchar.h>\n    ]],\n    [btowc wctob mbsinit mbrtowc mbrlen mbsrtowcs mbsnrtowcs wcrtomb\n     wcsrtombs wcsnrtombs wcwidth\n     wmemchr wmemcmp wmemcpy wmemmove wmempcpy wmemset\n     wcslen wcsnlen wcscpy wcpcpy wcsncpy wcpncpy wcscat wcsncat wcscmp\n     wcsncmp wcscasecmp wcsncasecmp wcscoll wcsxfrm wcsdup wcschr wcsrchr\n     wcscspn wcsspn wcspbrk wcsstr wcstok wcswidth wcsftime\n    ])\n\n  AC_REQUIRE([AC_C_RESTRICT])\n\n  AC_CHECK_DECLS([wcsdup], [], [], [[\n      #include <wchar.h>\n    ]])\n  if test $ac_cv_have_decl_wcsdup = no; then\n    HAVE_DECL_WCSDUP=0\n  fi\n])\n\ndnl Check whether <wchar.h> is usable at all.\nAC_DEFUN([gl_WCHAR_H_INLINE_OK],\n[\n  dnl Test whether <wchar.h> suffers due to the transition from '__inline' to\n  dnl 'gnu_inline'. See <https://sourceware.org/bugzilla/show_bug.cgi?id=4022>\n  dnl and <https://gcc.gnu.org/bugzilla/show_bug.cgi?id=42440>. In summary,\n  dnl glibc version 2.5 or older, together with gcc version 4.3 or newer and\n  dnl the option -std=c99 or -std=gnu99, leads to a broken <wchar.h>.\n  AC_REQUIRE([AC_CANONICAL_HOST])\n  AC_CACHE_CHECK([whether <wchar.h> uses 'inline' correctly],\n    [gl_cv_header_wchar_h_correct_inline],\n    [gl_cv_header_wchar_h_correct_inline=yes\n     case \"$host_os\" in\n       *-gnu* | gnu*)\n         AC_LANG_CONFTEST([\n           AC_LANG_SOURCE([[\n             #define wcstod renamed_wcstod\n             #include <wchar.h>\n             extern int zero (void);\n             int main () { return zero(); }\n           ]])])\n         dnl Do not rename the object file from conftest.$ac_objext to\n         dnl conftest1.$ac_objext, as this will cause the link to fail on\n         dnl z/OS when using the XPLINK object format (due to duplicate\n         dnl CSECT names). Instead, temporarily redefine $ac_compile so\n         dnl that the object file has the latter name from the start.\n         save_ac_compile=\"$ac_compile\"\n         ac_compile=`echo \"$save_ac_compile\" | sed s/conftest/conftest1/`\n         if echo '#include \"conftest.c\"' >conftest1.c \\\n            && AC_TRY_EVAL([ac_compile]); then\n           AC_LANG_CONFTEST([\n             AC_LANG_SOURCE([[\n               #define wcstod renamed_wcstod\n               #include <wchar.h>\n               int zero (void) { return 0; }\n             ]])])\n           dnl See note above about renaming object files.\n           ac_compile=`echo \"$save_ac_compile\" | sed s/conftest/conftest2/`\n           if echo '#include \"conftest.c\"' >conftest2.c \\\n              && AC_TRY_EVAL([ac_compile]); then\n             if $CC -o conftest$ac_exeext $CFLAGS $LDFLAGS conftest1.$ac_objext conftest2.$ac_objext $LIBS >&AS_MESSAGE_LOG_FD 2>&1; then\n               :\n             else\n               gl_cv_header_wchar_h_correct_inline=no\n             fi\n           fi\n         fi\n         ac_compile=\"$save_ac_compile\"\n         rm -f conftest[12].c conftest[12].$ac_objext conftest$ac_exeext\n         ;;\n     esac\n    ])\n  if test $gl_cv_header_wchar_h_correct_inline = no; then\n    AC_MSG_ERROR([<wchar.h> cannot be used with this compiler ($CC $CFLAGS $CPPFLAGS).\nThis is a known interoperability problem of glibc <= 2.5 with gcc >= 4.3 in\nC99 mode. You have four options:\n  - Add the flag -fgnu89-inline to CC and reconfigure, or\n  - Fix your include files, using parts of\n    <https://sourceware.org/git/?p=glibc.git;a=commitdiff;h=b037a293a48718af30d706c2e18c929d0e69a621>, or\n  - Use a gcc version older than 4.3, or\n  - Don't use the flags -std=c99 or -std=gnu99.\nConfiguration aborted.])\n  fi\n])\n\n# gl_WCHAR_MODULE_INDICATOR([modulename])\n# sets the shell variable that indicates the presence of the given module\n# to a C preprocessor expression that will evaluate to 1.\n# This macro invocation must not occur in macros that are AC_REQUIREd.\nAC_DEFUN([gl_WCHAR_MODULE_INDICATOR],\n[\n  dnl Ensure to expand the default settings once only.\n  gl_WCHAR_H_REQUIRE_DEFAULTS\n  gl_MODULE_INDICATOR_SET_VARIABLE([$1])\n  dnl Define it also as a C macro, for the benefit of the unit tests.\n  gl_MODULE_INDICATOR_FOR_TESTS([$1])\n])\n\n# Initializes the default values for AC_SUBSTed shell variables.\n# This macro must not be AC_REQUIREd.  It must only be invoked, and only\n# outside of macros or in macros that are not AC_REQUIREd.\nAC_DEFUN([gl_WCHAR_H_REQUIRE_DEFAULTS],\n[\n  m4_defun(GL_MODULE_INDICATOR_PREFIX[_WCHAR_H_MODULE_INDICATOR_DEFAULTS], [\n    gl_MODULE_INDICATOR_INIT_VARIABLE([GNULIB_BTOWC])\n    gl_MODULE_INDICATOR_INIT_VARIABLE([GNULIB_WCTOB])\n    gl_MODULE_INDICATOR_INIT_VARIABLE([GNULIB_MBSINIT])\n    gl_MODULE_INDICATOR_INIT_VARIABLE([GNULIB_MBSZERO])\n    gl_MODULE_INDICATOR_INIT_VARIABLE([GNULIB_MBRTOWC])\n    gl_MODULE_INDICATOR_INIT_VARIABLE([GNULIB_MBRLEN])\n    gl_MODULE_INDICATOR_INIT_VARIABLE([GNULIB_MBSRTOWCS])\n    gl_MODULE_INDICATOR_INIT_VARIABLE([GNULIB_MBSNRTOWCS])\n    gl_MODULE_INDICATOR_INIT_VARIABLE([GNULIB_WCRTOMB])\n    gl_MODULE_INDICATOR_INIT_VARIABLE([GNULIB_WCSRTOMBS])\n    gl_MODULE_INDICATOR_INIT_VARIABLE([GNULIB_WCSNRTOMBS])\n    gl_MODULE_INDICATOR_INIT_VARIABLE([GNULIB_WCWIDTH])\n    gl_MODULE_INDICATOR_INIT_VARIABLE([GNULIB_WMEMCHR])\n    gl_MODULE_INDICATOR_INIT_VARIABLE([GNULIB_WMEMCMP])\n    gl_MODULE_INDICATOR_INIT_VARIABLE([GNULIB_WMEMCPY])\n    gl_MODULE_INDICATOR_INIT_VARIABLE([GNULIB_WMEMMOVE])\n    gl_MODULE_INDICATOR_INIT_VARIABLE([GNULIB_WMEMPCPY])\n    gl_MODULE_INDICATOR_INIT_VARIABLE([GNULIB_WMEMSET])\n    gl_MODULE_INDICATOR_INIT_VARIABLE([GNULIB_WCSLEN])\n    gl_MODULE_INDICATOR_INIT_VARIABLE([GNULIB_WCSNLEN])\n    gl_MODULE_INDICATOR_INIT_VARIABLE([GNULIB_WCSCPY])\n    gl_MODULE_INDICATOR_INIT_VARIABLE([GNULIB_WCPCPY])\n    gl_MODULE_INDICATOR_INIT_VARIABLE([GNULIB_WCSNCPY])\n    gl_MODULE_INDICATOR_INIT_VARIABLE([GNULIB_WCPNCPY])\n    gl_MODULE_INDICATOR_INIT_VARIABLE([GNULIB_WCSCAT])\n    gl_MODULE_INDICATOR_INIT_VARIABLE([GNULIB_WCSNCAT])\n    gl_MODULE_INDICATOR_INIT_VARIABLE([GNULIB_WCSCMP])\n    gl_MODULE_INDICATOR_INIT_VARIABLE([GNULIB_WCSNCMP])\n    gl_MODULE_INDICATOR_INIT_VARIABLE([GNULIB_WCSCASECMP])\n    gl_MODULE_INDICATOR_INIT_VARIABLE([GNULIB_WCSNCASECMP])\n    gl_MODULE_INDICATOR_INIT_VARIABLE([GNULIB_WCSCOLL])\n    gl_MODULE_INDICATOR_INIT_VARIABLE([GNULIB_WCSXFRM])\n    gl_MODULE_INDICATOR_INIT_VARIABLE([GNULIB_WCSDUP])\n    gl_MODULE_INDICATOR_INIT_VARIABLE([GNULIB_WCSCHR])\n    gl_MODULE_INDICATOR_INIT_VARIABLE([GNULIB_WCSRCHR])\n    gl_MODULE_INDICATOR_INIT_VARIABLE([GNULIB_WCSCSPN])\n    gl_MODULE_INDICATOR_INIT_VARIABLE([GNULIB_WCSSPN])\n    gl_MODULE_INDICATOR_INIT_VARIABLE([GNULIB_WCSPBRK])\n    gl_MODULE_INDICATOR_INIT_VARIABLE([GNULIB_WCSSTR])\n    gl_MODULE_INDICATOR_INIT_VARIABLE([GNULIB_WCSTOK])\n    gl_MODULE_INDICATOR_INIT_VARIABLE([GNULIB_WCSWIDTH])\n    gl_MODULE_INDICATOR_INIT_VARIABLE([GNULIB_WCSFTIME])\n    dnl Support Microsoft deprecated alias function names by default.\n    gl_MODULE_INDICATOR_INIT_VARIABLE([GNULIB_MDA_WCSDUP], [1])\n  ])\n  m4_require(GL_MODULE_INDICATOR_PREFIX[_WCHAR_H_MODULE_INDICATOR_DEFAULTS])\n  dnl Make sure the shell variable for GNULIB_FREE_POSIX is initialized.\n  gl_STDLIB_H_REQUIRE_DEFAULTS\n  AC_REQUIRE([gl_WCHAR_H_DEFAULTS])\n])\n\nAC_DEFUN([gl_WCHAR_H_DEFAULTS],\n[\n  dnl Assume proper GNU behavior unless another module says otherwise.\n  HAVE_BTOWC=1;         AC_SUBST([HAVE_BTOWC])\n  HAVE_MBSINIT=1;       AC_SUBST([HAVE_MBSINIT])\n  HAVE_MBRTOWC=1;       AC_SUBST([HAVE_MBRTOWC])\n  HAVE_MBRLEN=1;        AC_SUBST([HAVE_MBRLEN])\n  HAVE_MBSRTOWCS=1;     AC_SUBST([HAVE_MBSRTOWCS])\n  HAVE_MBSNRTOWCS=1;    AC_SUBST([HAVE_MBSNRTOWCS])\n  HAVE_WCRTOMB=1;       AC_SUBST([HAVE_WCRTOMB])\n  HAVE_WCSRTOMBS=1;     AC_SUBST([HAVE_WCSRTOMBS])\n  HAVE_WCSNRTOMBS=1;    AC_SUBST([HAVE_WCSNRTOMBS])\n  HAVE_WMEMCHR=1;       AC_SUBST([HAVE_WMEMCHR])\n  HAVE_WMEMCMP=1;       AC_SUBST([HAVE_WMEMCMP])\n  HAVE_WMEMCPY=1;       AC_SUBST([HAVE_WMEMCPY])\n  HAVE_WMEMMOVE=1;      AC_SUBST([HAVE_WMEMMOVE])\n  HAVE_WMEMPCPY=1;      AC_SUBST([HAVE_WMEMPCPY])\n  HAVE_WMEMSET=1;       AC_SUBST([HAVE_WMEMSET])\n  HAVE_WCSLEN=1;        AC_SUBST([HAVE_WCSLEN])\n  HAVE_WCSNLEN=1;       AC_SUBST([HAVE_WCSNLEN])\n  HAVE_WCSCPY=1;        AC_SUBST([HAVE_WCSCPY])\n  HAVE_WCPCPY=1;        AC_SUBST([HAVE_WCPCPY])\n  HAVE_WCSNCPY=1;       AC_SUBST([HAVE_WCSNCPY])\n  HAVE_WCPNCPY=1;       AC_SUBST([HAVE_WCPNCPY])\n  HAVE_WCSCAT=1;        AC_SUBST([HAVE_WCSCAT])\n  HAVE_WCSNCAT=1;       AC_SUBST([HAVE_WCSNCAT])\n  HAVE_WCSCMP=1;        AC_SUBST([HAVE_WCSCMP])\n  HAVE_WCSNCMP=1;       AC_SUBST([HAVE_WCSNCMP])\n  HAVE_WCSCASECMP=1;    AC_SUBST([HAVE_WCSCASECMP])\n  HAVE_WCSNCASECMP=1;   AC_SUBST([HAVE_WCSNCASECMP])\n  HAVE_WCSCOLL=1;       AC_SUBST([HAVE_WCSCOLL])\n  HAVE_WCSXFRM=1;       AC_SUBST([HAVE_WCSXFRM])\n  HAVE_WCSDUP=1;        AC_SUBST([HAVE_WCSDUP])\n  HAVE_WCSCHR=1;        AC_SUBST([HAVE_WCSCHR])\n  HAVE_WCSRCHR=1;       AC_SUBST([HAVE_WCSRCHR])\n  HAVE_WCSCSPN=1;       AC_SUBST([HAVE_WCSCSPN])\n  HAVE_WCSSPN=1;        AC_SUBST([HAVE_WCSSPN])\n  HAVE_WCSPBRK=1;       AC_SUBST([HAVE_WCSPBRK])\n  HAVE_WCSSTR=1;        AC_SUBST([HAVE_WCSSTR])\n  HAVE_WCSTOK=1;        AC_SUBST([HAVE_WCSTOK])\n  HAVE_WCSWIDTH=1;      AC_SUBST([HAVE_WCSWIDTH])\n  HAVE_WCSFTIME=1;      AC_SUBST([HAVE_WCSFTIME])\n  HAVE_DECL_WCTOB=1;    AC_SUBST([HAVE_DECL_WCTOB])\n  HAVE_DECL_WCSDUP=1;   AC_SUBST([HAVE_DECL_WCSDUP])\n  HAVE_DECL_WCWIDTH=1;  AC_SUBST([HAVE_DECL_WCWIDTH])\n  REPLACE_MBSTATE_T=0;  AC_SUBST([REPLACE_MBSTATE_T])\n  REPLACE_BTOWC=0;      AC_SUBST([REPLACE_BTOWC])\n  REPLACE_WCTOB=0;      AC_SUBST([REPLACE_WCTOB])\n  REPLACE_MBSINIT=0;    AC_SUBST([REPLACE_MBSINIT])\n  REPLACE_MBRTOWC=0;    AC_SUBST([REPLACE_MBRTOWC])\n  REPLACE_MBRLEN=0;     AC_SUBST([REPLACE_MBRLEN])\n  REPLACE_MBSRTOWCS=0;  AC_SUBST([REPLACE_MBSRTOWCS])\n  REPLACE_MBSNRTOWCS=0; AC_SUBST([REPLACE_MBSNRTOWCS])\n  REPLACE_WCRTOMB=0;    AC_SUBST([REPLACE_WCRTOMB])\n  REPLACE_WCSRTOMBS=0;  AC_SUBST([REPLACE_WCSRTOMBS])\n  REPLACE_WCSNRTOMBS=0; AC_SUBST([REPLACE_WCSNRTOMBS])\n  REPLACE_WCWIDTH=0;    AC_SUBST([REPLACE_WCWIDTH])\n  REPLACE_WCSWIDTH=0;   AC_SUBST([REPLACE_WCSWIDTH])\n  REPLACE_WCSFTIME=0;   AC_SUBST([REPLACE_WCSFTIME])\n  REPLACE_WCSCMP=0;     AC_SUBST([REPLACE_WCSCMP])\n  REPLACE_WCSNCMP=0;    AC_SUBST([REPLACE_WCSNCMP])\n  REPLACE_WCSSTR=0;     AC_SUBST([REPLACE_WCSSTR])\n  REPLACE_WCSTOK=0;     AC_SUBST([REPLACE_WCSTOK])\n  REPLACE_WMEMCMP=0;    AC_SUBST([REPLACE_WMEMCMP])\n  REPLACE_WMEMPCPY=0;   AC_SUBST([REPLACE_WMEMPCPY])\n])\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}