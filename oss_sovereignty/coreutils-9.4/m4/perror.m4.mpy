{
  "module_name": "perror.m4",
  "hash_id": "b4eae6f1a3f34b9e3eccc604cf069dd907c688a36502190fbbdda5c59b5dd894",
  "original_prompt": "Ingested from coreutils-9.4/m4/perror.m4",
  "human_readable_source": "# perror.m4 serial 13\ndnl Copyright (C) 2008-2023 Free Software Foundation, Inc.\ndnl This file is free software; the Free Software Foundation\ndnl gives unlimited permission to copy and/or distribute it,\ndnl with or without modifications, as long as this notice is preserved.\n\nAC_DEFUN([gl_FUNC_PERROR],\n[\n  AC_REQUIRE([gl_STDIO_H_DEFAULTS])\n  AC_REQUIRE([gl_HEADER_ERRNO_H])\n  AC_REQUIRE([gl_FUNC_STRERROR_R])\n  AC_REQUIRE([gl_FUNC_STRERROR_0])\n  AC_REQUIRE([AC_CANONICAL_HOST])\n  dnl We intentionally do not check for the broader REPLACE_STRERROR_R,\n  dnl since on glibc systems, strerror_r is replaced only for signature\n  dnl issues, and perror is just fine.  Rather, we only want to\n  dnl replace perror if strerror_r was replaced for a content fix.\n  if test \"$GL_GENERATE_ERRNO_H:$REPLACE_STRERROR_0\" != false:0; then\n    dnl The system's perror() cannot know about the new errno values we add\n    dnl to <errno.h>, or any fix for strerror(0). Replace it.\n    REPLACE_PERROR=1\n  fi\n  case ${gl_cv_func_strerror_r_works-unset} in\n    unset|*yes)\n      AC_CACHE_CHECK([whether perror matches strerror],\n        [gl_cv_func_perror_works],\n        [AC_RUN_IFELSE(\n           [AC_LANG_PROGRAM(\n              [[#include <errno.h>\n                #include <stdio.h>\n                #include <stdlib.h>\n                #include <string.h>\n              ]],\n              [[char *str = strerror (-1);\n                if (!getenv(\"CONFTEST_OUTPUT\")) return 0;\n                if (!str) str = \"\";\n                puts (str);\n                errno = -1;\n                perror (\"\");\n                return 0;\n              ]])],\n           [if CONFTEST_OUTPUT=1 ./conftest$EXEEXT >conftest.txt1 2>conftest.txt2 \\\n               && cmp conftest.txt1 conftest.txt2 >/dev/null; then\n              gl_cv_func_perror_works=yes\n            else\n              gl_cv_func_perror_works=no\n            fi\n            rm -rf conftest.txt1 conftest.txt2],\n           [gl_cv_func_perror_works=no],\n           [case \"$host_os\" in\n                                  # Guess yes on musl systems.\n              *-musl* | midipix*) gl_cv_func_perror_works=\"guessing yes\" ;;\n                                  # Guess yes on native Windows.\n              mingw* | windows*)  gl_cv_func_perror_works=\"guessing yes\" ;;\n                                  # Otherwise obey --enable-cross-guesses.\n              *)                  gl_cv_func_perror_works=\"$gl_cross_guess_normal\" ;;\n            esac\n           ])\n        ])\n      case \"$gl_cv_func_perror_works\" in\n        *yes) ;;\n        *) REPLACE_PERROR=1 ;;\n      esac\n      ;;\n    *)\n      dnl The system's perror() probably inherits the bugs in the\n      dnl system's strerror_r(). Replace it.\n      REPLACE_PERROR=1\n      ;;\n  esac\n  dnl Does perror clobber the strerror buffer?\n  case \"$host_os\" in\n                     # Yes on Android 11.\n    linux*-android*) REPLACE_PERROR=1 ;;\n  esac\n])\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}