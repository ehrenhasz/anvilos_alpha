{
  "module_name": "setlocale_null.m4",
  "hash_id": "adb2f79e09189103424a268d6090d8497edd5742e5298f691018da85ca8b717a",
  "original_prompt": "Ingested from coreutils-9.4/m4/setlocale_null.m4",
  "human_readable_source": "# setlocale_null.m4 serial 9\ndnl Copyright (C) 2019-2023 Free Software Foundation, Inc.\ndnl This file is free software; the Free Software Foundation\ndnl gives unlimited permission to copy and/or distribute it,\ndnl with or without modifications, as long as this notice is preserved.\n\nAC_DEFUN([gl_FUNC_SETLOCALE_NULL],\n[\n  AC_REQUIRE([AC_CANONICAL_HOST])\n  AC_REQUIRE([gl_PTHREADLIB])\n  AC_CHECK_HEADERS_ONCE([threads.h])\n\n  AC_CACHE_CHECK([whether setlocale (LC_ALL, NULL) is multithread-safe],\n    [gl_cv_func_setlocale_null_all_mtsafe],\n    [case \"$host_os\" in\n       # Guess no on musl libc, macOS, FreeBSD, NetBSD, OpenBSD, AIX, Haiku.\n       *-musl* | midipix* | darwin* | freebsd* | midnightbsd* | netbsd* | openbsd* | aix* | haiku*)\n         gl_cv_func_setlocale_null_all_mtsafe=no ;;\n       # Guess no on Cygwin < 3.4.6.\n       cygwin*)\n         AC_EGREP_CPP([Lucky user],\n           [\n#if defined __CYGWIN__\n #include <cygwin/version.h>\n #if CYGWIN_VERSION_DLL_COMBINED >= CYGWIN_VERSION_DLL_MAKE_COMBINED (3004, 6)\n  Lucky user\n #endif\n#endif\n          ],\n          [gl_cv_func_setlocale_null_all_mtsafe=yes],\n          [gl_cv_func_setlocale_null_all_mtsafe=no])\n        ;;\n       # Guess yes on glibc, HP-UX, IRIX, Solaris, native Windows.\n       *-gnu* | gnu* | hpux* | irix* | solaris* | mingw* | windows*)\n         gl_cv_func_setlocale_null_all_mtsafe=yes ;;\n       # If we don't know, obey --enable-cross-guesses.\n       *)\n         gl_cv_func_setlocale_null_all_mtsafe=\"$gl_cross_guess_normal\" ;;\n     esac\n    ])\n  dnl On platforms without multithreading, there is no issue.\n  case \"$host_os\" in\n    mingw* | windows*) ;;\n    *)\n      if test $gl_pthread_api = no && test $ac_cv_header_threads_h = no; then\n        gl_cv_func_setlocale_null_all_mtsafe=\"trivially yes\"\n      fi\n      ;;\n  esac\n  case \"$gl_cv_func_setlocale_null_all_mtsafe\" in\n    *yes) SETLOCALE_NULL_ALL_MTSAFE=1 ;;\n    *)    SETLOCALE_NULL_ALL_MTSAFE=0 ;;\n  esac\n  AC_DEFINE_UNQUOTED([SETLOCALE_NULL_ALL_MTSAFE], [$SETLOCALE_NULL_ALL_MTSAFE],\n    [Define to 1 if setlocale (LC_ALL, NULL) is multithread-safe.])\n\n  dnl This is about a single category (not LC_ALL).\n  AC_CACHE_CHECK([whether setlocale (category, NULL) is multithread-safe],\n    [gl_cv_func_setlocale_null_one_mtsafe],\n    [case \"$host_os\" in\n       # Guess no on OpenBSD, AIX.\n       openbsd* | aix*)\n         gl_cv_func_setlocale_null_one_mtsafe=no ;;\n       # Guess yes on glibc, musl libc, macOS, FreeBSD, NetBSD, HP-UX, IRIX, Solaris, Haiku, Cygwin, native Windows.\n       *-gnu* | gnu* | *-musl* | midipix* | darwin* | freebsd* | midnightbsd* | netbsd* | hpux* | irix* | solaris* | haiku* | cygwin* | mingw* | windows*)\n         gl_cv_func_setlocale_null_one_mtsafe=yes ;;\n       # If we don't know, obey --enable-cross-guesses.\n       *)\n         gl_cv_func_setlocale_null_one_mtsafe=\"$gl_cross_guess_normal\" ;;\n     esac\n    ])\n  dnl On platforms without multithreading, there is no issue.\n  case \"$host_os\" in\n    mingw* | windows*) ;;\n    *)\n      if test $gl_pthread_api = no && test $ac_cv_header_threads_h = no; then\n        gl_cv_func_setlocale_null_one_mtsafe=\"trivially yes\"\n      fi\n      ;;\n  esac\n  case \"$gl_cv_func_setlocale_null_one_mtsafe\" in\n    *yes) SETLOCALE_NULL_ONE_MTSAFE=1 ;;\n    *)    SETLOCALE_NULL_ONE_MTSAFE=0 ;;\n  esac\n  AC_DEFINE_UNQUOTED([SETLOCALE_NULL_ONE_MTSAFE], [$SETLOCALE_NULL_ONE_MTSAFE],\n    [Define to 1 if setlocale (category, NULL) is multithread-safe.])\n\n  dnl Determine link dependencies of lib/setlocale_null.c and lib/setlocale-lock.c.\n  if test $SETLOCALE_NULL_ALL_MTSAFE = 0 || test $SETLOCALE_NULL_ONE_MTSAFE = 0; then\n    case \"$host_os\" in\n      mingw* | windows*)\n        SETLOCALE_NULL_LIB=\n        ;;\n      *)\n        gl_WEAK_SYMBOLS\n        case \"$gl_cv_have_weak\" in\n          *yes) SETLOCALE_NULL_LIB= ;;\n          *)    SETLOCALE_NULL_LIB=\"$LIBPTHREAD\" ;;\n        esac\n        ;;\n    esac\n  else\n    SETLOCALE_NULL_LIB=\n  fi\n  dnl SETLOCALE_NULL_LIB is expected to be '-pthread' or '-lpthread' on AIX\n  dnl with gcc or xlc, and empty otherwise.\n  AC_SUBST([SETLOCALE_NULL_LIB])\n  dnl For backward compatibility.\n  LIB_SETLOCALE_NULL=\"$SETLOCALE_NULL_LIB\"\n  AC_SUBST([LIB_SETLOCALE_NULL])\n])\n\n# Prerequisites of lib/setlocale-lock.c.\nAC_DEFUN([gl_PREREQ_SETLOCALE_LOCK],\n[\n  gl_VISIBILITY\n])\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}