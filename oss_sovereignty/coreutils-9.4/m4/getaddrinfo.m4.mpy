{
  "module_name": "getaddrinfo.m4",
  "hash_id": "4693e6f0a580d01a2a8a405af9cb875f5ce38ff06576861e3d38e80679fdffd7",
  "original_prompt": "Ingested from coreutils-9.4/m4/getaddrinfo.m4",
  "human_readable_source": "# getaddrinfo.m4 serial 34\ndnl Copyright (C) 2004-2023 Free Software Foundation, Inc.\ndnl This file is free software; the Free Software Foundation\ndnl gives unlimited permission to copy and/or distribute it,\ndnl with or without modifications, as long as this notice is preserved.\n\nAC_DEFUN([gl_GETADDRINFO],\n[\n  AC_REQUIRE([gl_SYS_SOCKET_H])dnl for HAVE_SYS_SOCKET_H, HAVE_WINSOCK2_H\n  AC_REQUIRE([gl_NETDB_H])dnl for HAVE_NETDB_H\n  GETADDRINFO_LIB=\n  gai_saved_LIBS=\"$LIBS\"\n\n  dnl Where is getaddrinfo()?\n  dnl - On Solaris, it is in libsocket.\n  dnl - On Haiku, it is in libnetwork.\n  dnl - On BeOS, it is in libnet.\n  dnl - On native Windows, it is in ws2_32.dll.\n  dnl - Otherwise it is in libc.\n  AC_SEARCH_LIBS([getaddrinfo], [socket network net],\n    [if test \"$ac_cv_search_getaddrinfo\" != \"none required\"; then\n       GETADDRINFO_LIB=\"$ac_cv_search_getaddrinfo\"\n     fi])\n  LIBS=\"$gai_saved_LIBS $GETADDRINFO_LIB\"\n\n  HAVE_GETADDRINFO=1\n  AC_CACHE_CHECK([for getaddrinfo], [gl_cv_func_getaddrinfo], [\n    AC_LINK_IFELSE([AC_LANG_PROGRAM([[\n#include <sys/types.h>\n#ifdef HAVE_SYS_SOCKET_H\n#include <sys/socket.h>\n#endif\n#ifdef HAVE_NETDB_H\n#include <netdb.h>\n#endif\n#include <stddef.h>\n]], [[getaddrinfo(\"\", \"\", NULL, NULL);]])],\n      [gl_cv_func_getaddrinfo=yes],\n      [gl_cv_func_getaddrinfo=no])])\n  if test $gl_cv_func_getaddrinfo = no; then\n    AC_CACHE_CHECK([for getaddrinfo in ws2tcpip.h and -lws2_32],\n                   gl_cv_w32_getaddrinfo, [\n      gl_cv_w32_getaddrinfo=no\n      am_save_LIBS=\"$LIBS\"\n      LIBS=\"$LIBS -lws2_32\"\n      AC_LINK_IFELSE([AC_LANG_PROGRAM([[\n#ifdef HAVE_WS2TCPIP_H\n#include <ws2tcpip.h>\n#endif\n#include <stddef.h>\n]], [[getaddrinfo(NULL, NULL, NULL, NULL);]])], [gl_cv_w32_getaddrinfo=yes])\n      LIBS=\"$am_save_LIBS\"\n    ])\n    if test \"$gl_cv_w32_getaddrinfo\" = \"yes\"; then\n      GETADDRINFO_LIB=\"-lws2_32\"\n      LIBS=\"$gai_saved_LIBS $GETADDRINFO_LIB\"\n      dnl Check for correct signature, in particular for a cdecl-compatible\n      dnl calling convention.\n      AC_CACHE_CHECK([for getaddrinfo with POSIX signature],\n        [gl_cv_func_getaddrinfo_posix_signature],\n        [AC_COMPILE_IFELSE([AC_LANG_SOURCE([[\n#include <sys/types.h>\n#ifdef HAVE_SYS_SOCKET_H\n#include <sys/socket.h>\n#endif\n#ifdef HAVE_NETDB_H\n#include <netdb.h>\n#endif\n#ifdef HAVE_WS2TCPIP_H\n#include <ws2tcpip.h>\n#endif\n#include <stddef.h>\nextern\n#ifdef __cplusplus\n\"C\"\n#endif\nint getaddrinfo (const char *, const char *, const struct addrinfo *, struct addrinfo **);\n]])],\n           [gl_cv_func_getaddrinfo_posix_signature=yes],\n           [gl_cv_func_getaddrinfo_posix_signature=no])\n        ])\n      if test $gl_cv_func_getaddrinfo_posix_signature = no; then\n        REPLACE_GETADDRINFO=1\n      fi\n    else\n      HAVE_GETADDRINFO=0\n    fi\n  fi\n  AC_DEFINE_UNQUOTED([HAVE_GETADDRINFO], [$HAVE_GETADDRINFO],\n    [Define to 1 if getaddrinfo exists, or to 0 otherwise.])\n\n  # We can't use AC_REPLACE_FUNCS here because gai_strerror may be an\n  # inline function declared in ws2tcpip.h, so we need to get that\n  # header included somehow.\n  AC_CHECK_DECLS([gai_strerror], [], [], [[\n#include <sys/types.h>\n#ifdef HAVE_SYS_SOCKET_H\n#include <sys/socket.h>\n#endif\n#ifdef HAVE_NETDB_H\n#include <netdb.h>\n#endif\n#ifdef HAVE_WS2TCPIP_H\n#include <ws2tcpip.h>\n#endif\n#include <stddef.h>\n]])\n  if test $ac_cv_have_decl_gai_strerror = yes; then\n    AC_CHECK_DECLS([gai_strerrorA], [], [], [[\n#include <sys/types.h>\n#ifdef HAVE_SYS_SOCKET_H\n#include <sys/socket.h>\n#endif\n#ifdef HAVE_NETDB_H\n#include <netdb.h>\n#endif\n#ifdef HAVE_WS2TCPIP_H\n#include <ws2tcpip.h>\n#endif\n#include <stddef.h>\n]])\n    dnl check for correct signature\n    AC_CACHE_CHECK([for gai_strerror with POSIX signature],\n     [gl_cv_func_gai_strerror_posix_signature], [\n      AC_COMPILE_IFELSE([AC_LANG_SOURCE([[\n#include <sys/types.h>\n#ifdef HAVE_SYS_SOCKET_H\n#include <sys/socket.h>\n#endif\n#ifdef HAVE_NETDB_H\n#include <netdb.h>\n#endif\n#ifdef HAVE_WS2TCPIP_H\n#include <ws2tcpip.h>\n#endif\n#include <stddef.h>\nextern\n#ifdef __cplusplus\n\"C\"\n#endif\nconst char *gai_strerror(int);]])],\n        [gl_cv_func_gai_strerror_posix_signature=yes],\n        [gl_cv_func_gai_strerror_posix_signature=no])])\n    if test $gl_cv_func_gai_strerror_posix_signature = no; then\n      REPLACE_GAI_STRERROR=1\n    fi\n  fi\n\n  LIBS=\"$gai_saved_LIBS\"\n\n  gl_PREREQ_GETADDRINFO\n\n  AC_SUBST([GETADDRINFO_LIB])\n])\n\n# Prerequisites of lib/netdb.in.h and lib/getaddrinfo.c.\nAC_DEFUN([gl_PREREQ_GETADDRINFO], [\n  AC_REQUIRE([gl_NETDB_H_DEFAULTS])\n  AC_REQUIRE([gl_SYS_SOCKET_H])dnl for HAVE_SYS_SOCKET_H, HAVE_WINSOCK2_H\n  AC_REQUIRE([gl_HOSTENT]) dnl for HOSTENT_LIB\n  AC_REQUIRE([gl_SERVENT]) dnl for SERVENT_LIB\n  AC_REQUIRE([gl_FUNC_INET_NTOP]) dnl for INET_NTOP_LIB\n  AC_REQUIRE([AC_C_RESTRICT])\n  AC_REQUIRE([gl_SOCKET_FAMILIES])\n  AC_REQUIRE([gl_SYS_SOCKET_H])\n  AC_REQUIRE([AC_USE_SYSTEM_EXTENSIONS])\n\n  dnl Including sys/socket.h is wrong for Windows, but Windows does not\n  dnl have sa_len so the result is correct anyway.\n  AC_CHECK_MEMBERS([struct sockaddr.sa_len], , , [\n#include <sys/types.h>\n#include <sys/socket.h>\n])\n\n  AC_CHECK_HEADERS_ONCE([netinet/in.h])\n\n  AC_CHECK_DECLS([getaddrinfo, freeaddrinfo, getnameinfo],,,[[\n  /* sys/types.h is not needed according to POSIX, but the\n     sys/socket.h in i386-unknown-freebsd4.10 and\n     powerpc-apple-darwin5.5 required it. */\n#include <sys/types.h>\n#ifdef HAVE_SYS_SOCKET_H\n#include <sys/socket.h>\n#endif\n#ifdef HAVE_NETDB_H\n#include <netdb.h>\n#endif\n#ifdef HAVE_WS2TCPIP_H\n#include <ws2tcpip.h>\n#endif\n]])\n  if test $ac_cv_have_decl_getaddrinfo = no; then\n    HAVE_DECL_GETADDRINFO=0\n  fi\n  if test $ac_cv_have_decl_freeaddrinfo = no; then\n    HAVE_DECL_FREEADDRINFO=0\n  fi\n  if test $ac_cv_have_decl_gai_strerror = no; then\n    HAVE_DECL_GAI_STRERROR=0\n  fi\n  if test $ac_cv_have_decl_getnameinfo = no; then\n    HAVE_DECL_GETNAMEINFO=0\n  fi\n\n  AC_CHECK_TYPES([struct addrinfo],,,[\n#include <sys/types.h>\n#ifdef HAVE_SYS_SOCKET_H\n#include <sys/socket.h>\n#endif\n#ifdef HAVE_NETDB_H\n#include <netdb.h>\n#endif\n#ifdef HAVE_WS2TCPIP_H\n#include <ws2tcpip.h>\n#endif\n])\n  if test $ac_cv_type_struct_addrinfo = no; then\n    HAVE_STRUCT_ADDRINFO=0\n  fi\n\n  dnl Append $HOSTENT_LIB to GETADDRINFO_LIB, avoiding gratuitous duplicates.\n  case \" $GETADDRINFO_LIB \" in\n    *\" $HOSTENT_LIB \"*) ;;\n    *) GETADDRINFO_LIB=\"$GETADDRINFO_LIB $HOSTENT_LIB\" ;;\n  esac\n\n  dnl Append $SERVENT_LIB to GETADDRINFO_LIB, avoiding gratuitous duplicates.\n  case \" $GETADDRINFO_LIB \" in\n    *\" $SERVENT_LIB \"*) ;;\n    *) GETADDRINFO_LIB=\"$GETADDRINFO_LIB $SERVENT_LIB\" ;;\n  esac\n\n  dnl Append $INET_NTOP_LIB to GETADDRINFO_LIB, avoiding gratuitous duplicates.\n  case \" $GETADDRINFO_LIB \" in\n    *\" $INET_NTOP_LIB \"*) ;;\n    *) GETADDRINFO_LIB=\"$GETADDRINFO_LIB $INET_NTOP_LIB\" ;;\n  esac\n])\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}