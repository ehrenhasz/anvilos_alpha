{
  "module_name": "gl-openssl.m4",
  "hash_id": "9a508a06936ba49cc7b3d4fbeaefe06ea848a6f1653dcbb6452ea343b89f5244",
  "original_prompt": "Ingested from coreutils-9.4/m4/gl-openssl.m4",
  "human_readable_source": "# gl-openssl.m4 serial 6\ndnl Copyright (C) 2013-2023 Free Software Foundation, Inc.\ndnl This file is free software; the Free Software Foundation\ndnl gives unlimited permission to copy and/or distribute it,\ndnl with or without modifications, as long as this notice is preserved.\n\nAC_DEFUN([gl_SET_CRYPTO_CHECK_DEFAULT],\n[\n  m4_define([gl_CRYPTO_CHECK_DEFAULT], [$1])\n])\ngl_SET_CRYPTO_CHECK_DEFAULT([no])\n\nAC_DEFUN([gl_CRYPTO_CHECK],\n[\n  dnl gnulib users set this before gl_INIT with gl_SET_CRYPTO_CHECK_DEFAULT()\n  m4_divert_once([DEFAULTS], [with_openssl_default='gl_CRYPTO_CHECK_DEFAULT'])\n\n  dnl Only clear once, so crypto routines can be checked for individually\n  m4_divert_once([DEFAULTS], [LIB_CRYPTO=])\n\n  AC_ARG_WITH([openssl],\n    [[  --with-openssl[=ARG]    use libcrypto hash routines for the hash functions\n                          MD5, SHA-1, SHA-224, SHA-256, SHA-384, SHA-512.\n                          Valid ARGs are:\n                            'yes',\n                            'no',\n                            'auto' => use if any version available,\n                            'auto-gpl-compat' => use if GPL compatible version\n                                                 available,\n                            'optional' => use if available\n                                          and warn if not available;\n                          Default is ']gl_CRYPTO_CHECK_DEFAULT['.]m4_ifdef([gl_AF_ALG], [\n                          Note also --with-linux-crypto, which will enable the\n                          use of Linux kernel crypto routines (if available),\n                          which has precedence for files.])],\n    [],\n    [with_openssl=$with_openssl_default])\n\n  AC_SUBST([LIB_CRYPTO])\n  if test \"x$with_openssl\" != xno; then\n    if test \"x$with_openssl\" = xauto-gpl-compat; then\n      AC_CACHE_CHECK([whether openssl is GPL compatible],\n                     [gl_cv_openssl_gpl_compat],\n        [AC_COMPILE_IFELSE(\n           [AC_LANG_PROGRAM([[\n                #include <openssl/opensslv.h>\n                #if OPENSSL_VERSION_MAJOR < 3\n                  #error \"openssl >= version 3 not found\"\n                #endif\n              ]])],\n           [gl_cv_openssl_gpl_compat=yes],\n           [gl_cv_openssl_gpl_compat=no])])\n    fi\n    if test \"x$with_openssl\" != xauto-gpl-compat ||\n       test \"x$gl_cv_openssl_gpl_compat\" = xyes; then\n      AC_CHECK_LIB([crypto], [$1],\n        [AC_CHECK_HEADERS(\n           m4_if([$1], [MD5], [openssl/md5.h], [openssl/sha.h]),\n           [LIB_CRYPTO=-lcrypto\n            AC_DEFINE([HAVE_OPENSSL_$1], [1],\n              [Define to 1 if libcrypto is used for $1.])])])\n    fi\n    if test \"x$LIB_CRYPTO\" = x; then\n      message='openssl development library not found for $1.\n  If you want to install it, first find the pre-built package name:\n    - On Debian and Debian-based systems: libssl-dev,\n    - On Red Hat distributions: openssl-devel.\n    - Other: https://repology.org/project/openssl/versions'\n      if test \"x$with_openssl\" = xyes; then\n        AC_MSG_ERROR([$message])\n      elif test \"x$with_openssl\" = xoptional; then\n        AC_MSG_WARN([$message])\n      fi\n    fi\n  fi\n])\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}