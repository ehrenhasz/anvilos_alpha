{
  "module_name": "socketlib.m4",
  "hash_id": "d99bac64fbb76bb9ba1d70bd4eec294e4a87e3bc878e8123bbb9998a993a2dae",
  "original_prompt": "Ingested from coreutils-9.4/m4/socketlib.m4",
  "human_readable_source": "# socketlib.m4 serial 3\ndnl Copyright (C) 2008-2023 Free Software Foundation, Inc.\ndnl This file is free software; the Free Software Foundation\ndnl gives unlimited permission to copy and/or distribute it,\ndnl with or without modifications, as long as this notice is preserved.\n\ndnl gl_SOCKETLIB\ndnl Determines the library to use for socket functions.\ndnl Sets and AC_SUBSTs LIBSOCKET.\n\nAC_DEFUN([gl_SOCKETLIB],\n[\n  gl_PREREQ_SYS_H_WINSOCK2 dnl for HAVE_WINSOCK2_H\n  LIBSOCKET=\n  if test $HAVE_WINSOCK2_H = 1; then\n    dnl Native Windows API (not Cygwin).\n    dnl If the function WSAStartup exists (declared in <winsock2.h> and\n    dnl defined through -lws2_32), we need to call it.\n    AC_CACHE_CHECK([for WSAStartup],\n      [gl_cv_func_wsastartup], [\n       gl_save_LIBS=\"$LIBS\"\n       LIBS=\"$LIBS -lws2_32\"\n       AC_LINK_IFELSE(\n         [AC_LANG_PROGRAM([[\n#ifdef HAVE_WINSOCK2_H\n# include <winsock2.h>\n#endif]], [[\n            WORD wVersionRequested = MAKEWORD(1, 1);\n            WSADATA wsaData;\n            int err = WSAStartup(wVersionRequested, &wsaData);\n            WSACleanup ();\n            ]])\n         ],\n         [gl_cv_func_wsastartup=yes],\n         [gl_cv_func_wsastartup=no])\n       LIBS=\"$gl_save_LIBS\"\n      ])\n    if test \"$gl_cv_func_wsastartup\" = \"yes\"; then\n      AC_DEFINE([WINDOWS_SOCKETS], [1], [Define if WSAStartup is needed.])\n      LIBSOCKET='-lws2_32'\n    fi\n  else\n    dnl Unix API.\n    dnl Solaris has most socket functions in libsocket.\n    dnl Haiku has most socket functions in libnetwork.\n    dnl BeOS has most socket functions in libnet.\n    dnl On HP-UX, do NOT link with libxnet, because in 64-bit mode this would\n    dnl break code (e.g. in libraries) that invokes accept(), getpeername(),\n    dnl getsockname(), getsockopt(), or recvfrom() with a 32-bit addrlen. See\n    dnl \"man xopen_networking\" for details.\n    AC_CACHE_CHECK([for library containing setsockopt], [gl_cv_lib_socket], [\n      gl_cv_lib_socket=\n      AC_LINK_IFELSE([AC_LANG_PROGRAM([[extern\n#ifdef __cplusplus\n\"C\"\n#endif\nchar setsockopt();]], [[setsockopt();]])],\n        [],\n        [gl_save_LIBS=\"$LIBS\"\n         LIBS=\"$gl_save_LIBS -lsocket\"\n         AC_LINK_IFELSE([AC_LANG_PROGRAM([[extern\n#ifdef __cplusplus\n\"C\"\n#endif\nchar setsockopt();]], [[setsockopt();]])],\n           [gl_cv_lib_socket=\"-lsocket\"])\n         if test -z \"$gl_cv_lib_socket\"; then\n           LIBS=\"$gl_save_LIBS -lnetwork\"\n           AC_LINK_IFELSE([AC_LANG_PROGRAM([[extern\n#ifdef __cplusplus\n\"C\"\n#endif\nchar setsockopt();]], [[setsockopt();]])],\n             [gl_cv_lib_socket=\"-lnetwork\"])\n           if test -z \"$gl_cv_lib_socket\"; then\n             LIBS=\"$gl_save_LIBS -lnet\"\n             AC_LINK_IFELSE([AC_LANG_PROGRAM([[extern\n#ifdef __cplusplus\n\"C\"\n#endif\nchar setsockopt();]], [[setsockopt();]])],\n               [gl_cv_lib_socket=\"-lnet\"])\n           fi\n         fi\n         LIBS=\"$gl_save_LIBS\"\n        ])\n      if test -z \"$gl_cv_lib_socket\"; then\n        gl_cv_lib_socket=\"none needed\"\n      fi\n    ])\n    if test \"$gl_cv_lib_socket\" != \"none needed\"; then\n      LIBSOCKET=\"$gl_cv_lib_socket\"\n    fi\n  fi\n  AC_SUBST([LIBSOCKET])\n])\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}