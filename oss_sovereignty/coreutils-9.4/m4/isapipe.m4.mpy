{
  "module_name": "isapipe.m4",
  "hash_id": "e714532bde2b09ebc5e99ae8115ec9a577e940fc13f8b4a46393ff5a11efdf1d",
  "original_prompt": "Ingested from coreutils-9.4/m4/isapipe.m4",
  "human_readable_source": "# Test whether a file descriptor is a pipe.\n\ndnl Copyright (C) 2006, 2009-2023 Free Software Foundation, Inc.\n\ndnl This file is free software; the Free Software Foundation\ndnl gives unlimited permission to copy and/or distribute it,\ndnl with or without modifications, as long as this notice is preserved.\n\ndnl Written by Paul Eggert.\n\nAC_DEFUN([gl_ISAPIPE],\n[\n  # OpenVMS has isapipe already, so check for it.\n  AC_CHECK_FUNCS([isapipe])\n  if test $ac_cv_func_isapipe = yes; then\n    HAVE_ISAPIPE=1\n  else\n    HAVE_ISAPIPE=0\n  fi\n])\n\n# Prerequisites of lib/isapipe.c.\nAC_DEFUN([gl_PREREQ_ISAPIPE],\n[\n  AC_CACHE_CHECK([whether pipes are FIFOs (and for their link count)],\n    [gl_cv_pipes_are_fifos],\n    [AC_RUN_IFELSE(\n       [AC_LANG_SOURCE(\n          [[#include <stdio.h>\n            #include <sys/types.h>\n            #include <sys/stat.h>\n            #include <unistd.h>\n            #ifndef S_ISFIFO\n             #define S_ISFIFO(m) 0\n            #endif\n            #ifndef S_ISSOCK\n             #define S_ISSOCK(m) 0\n            #endif\n            int\n            main (int argc, char **argv)\n            {\n              int fd[2];\n              struct stat st;\n              if (pipe (fd) != 0)\n                return 1;\n              if (fstat (fd[0], &st) != 0)\n                return 2;\n              if (2 <= argc && argv[1][0] == '-')\n                {\n                  char const *yesno = (S_ISFIFO (st.st_mode) ? \"yes\" : \"no\");\n                  if (st.st_nlink <= 1)\n                    {\n                      long int i = st.st_nlink;\n                      if (i != st.st_nlink)\n                        return 3;\n                      printf (\"%s (%ld)\\n\", yesno, i);\n                    }\n                  else\n                    {\n                      unsigned long int i = st.st_nlink;\n                      if (i != st.st_nlink)\n                        return 4;\n                      printf (\"%s (%lu)\\n\", yesno, i);\n                    }\n                }\n              else\n                {\n                  if (! S_ISFIFO (st.st_mode) && ! S_ISSOCK (st.st_mode))\n                    return 5;\n                }\n              return 0;\n            }]])],\n       [gl_cv_pipes_are_fifos=`./conftest$ac_exeext -`\n        test -z \"$gl_cv_pipes_are_fifos\" && gl_cv_pipes_are_fifos=no],\n       [gl_cv_pipes_are_fifos=unknown],\n       [gl_cv_pipes_are_fifos=cross-compiling])])\n\n  case $gl_cv_pipes_are_fifos in #(\n  'yes ('*')')\n    AC_DEFINE([HAVE_FIFO_PIPES], [1],\n      [Define to 1 if pipes are FIFOs, 0 if sockets.  Leave undefined\n       if not known.]);; #(\n  'no ('*')')\n    AC_DEFINE([HAVE_FIFO_PIPES], [0]);;\n  esac\n\n  case $gl_cv_pipes_are_fifos in #(\n  *'('*')')\n    AC_DEFINE_UNQUOTED([PIPE_LINK_COUNT_MAX],\n      [`expr \"$gl_cv_pipes_are_fifos\" : '.*\\((.*)\\)'`],\n      [Define to the maximum link count that a true pipe can have.]);;\n  esac\n])\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}