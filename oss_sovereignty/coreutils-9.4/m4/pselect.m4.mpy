{
  "module_name": "pselect.m4",
  "hash_id": "7fb844901056948b37bb4292bbd4033970e021b95d2058477554dad2bf423c8d",
  "original_prompt": "Ingested from coreutils-9.4/m4/pselect.m4",
  "human_readable_source": "# pselect.m4 serial 11\ndnl Copyright (C) 2011-2023 Free Software Foundation, Inc.\ndnl This file is free software; the Free Software Foundation\ndnl gives unlimited permission to copy and/or distribute it,\ndnl with or without modifications, as long as this notice is preserved.\n\nAC_DEFUN([gl_FUNC_PSELECT],\n[\n  AC_REQUIRE([gl_SYS_SELECT_H])\n  AC_REQUIRE([AC_C_RESTRICT])\n  AC_REQUIRE([AC_CANONICAL_HOST]) dnl for cross-compiles\n  AC_CHECK_FUNCS_ONCE([pselect])\n\n  if test $ac_cv_func_pselect = yes; then\n    AC_CACHE_CHECK([whether signature of pselect conforms to POSIX],\n      [gl_cv_sig_pselect],\n      [AC_LINK_IFELSE(\n         [AC_LANG_PROGRAM(\n              [[#include <sys/select.h>\n                ]],\n              [[int (*p) (int, fd_set *, fd_set *, fd_set *restrict,\n                          struct timespec const *restrict,\n                          sigset_t const *restrict) = pselect;\n                return !p;]])],\n         [gl_cv_sig_pselect=yes],\n         [gl_cv_sig_pselect=no])])\n\n    dnl On FreeBSD 8.2, pselect() doesn't always reject bad fds.\n    AC_CACHE_CHECK([whether pselect detects invalid fds],\n      [gl_cv_func_pselect_detects_ebadf],\n      [\n        AC_RUN_IFELSE([AC_LANG_PROGRAM([[\n#include <sys/types.h>\n#include <sys/time.h>\n#if HAVE_SYS_SELECT_H\n# include <sys/select.h>\n#endif\n#include <unistd.h>\n#include <errno.h>\n]GL_MDA_DEFINES],\n[[\n  fd_set set;\n  dup2(0, 16);\n  FD_ZERO(&set);\n  FD_SET(16, &set);\n  close(16);\n  struct timespec timeout;\n  timeout.tv_sec = 0;\n  timeout.tv_nsec = 5000;\n  return pselect (17, &set, NULL, NULL, &timeout, NULL) != -1 || errno != EBADF;\n]])], [gl_cv_func_pselect_detects_ebadf=yes],\n      [gl_cv_func_pselect_detects_ebadf=no],\n          [\n           case \"$host_os\" in\n                             # Guess yes on Linux systems.\n            linux-* | linux) gl_cv_func_pselect_detects_ebadf=\"guessing yes\" ;;\n                             # Guess yes on systems that emulate the Linux system calls.\n            midipix*)        gl_cv_func_pselect_detects_ebadf=\"guessing yes\" ;;\n                             # Guess yes on glibc systems.\n            *-gnu* | gnu*)   gl_cv_func_pselect_detects_ebadf=\"guessing yes\" ;;\n                             # If we don't know, obey --enable-cross-guesses.\n            *)               gl_cv_func_pselect_detects_ebadf=\"$gl_cross_guess_normal\" ;;\n           esac\n          ])\n      ])\n    case $gl_cv_func_pselect_detects_ebadf in\n      *yes) ;;\n      *) REPLACE_PSELECT=1 ;;\n    esac\n  fi\n\n  if test $ac_cv_func_pselect = no || test $gl_cv_sig_pselect = no; then\n    REPLACE_PSELECT=1\n  fi\n])\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}