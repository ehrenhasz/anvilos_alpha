{
  "module_name": "sleep.m4",
  "hash_id": "666ae2eb2938d3b7ed34ddb7d55981dc6394fa98940ecf0386434781fa5c0c69",
  "original_prompt": "Ingested from coreutils-9.4/m4/sleep.m4",
  "human_readable_source": "# sleep.m4 serial 13\ndnl Copyright (C) 2007-2023 Free Software Foundation, Inc.\ndnl This file is free software; the Free Software Foundation\ndnl gives unlimited permission to copy and/or distribute it,\ndnl with or without modifications, as long as this notice is preserved.\n\nAC_DEFUN([gl_FUNC_SLEEP],\n[\n  AC_REQUIRE([gl_UNISTD_H_DEFAULTS])\n  AC_REQUIRE([AC_CANONICAL_HOST]) dnl for cross-compiles\n  dnl We expect to see the declaration of sleep() in a header file.\n  dnl Older versions of mingw have a sleep() function that is an alias to\n  dnl _sleep() in MSVCRT. It has a different signature than POSIX sleep():\n  dnl it takes the number of milliseconds as argument and returns void.\n  dnl mingw does not declare this function.\n  AC_CHECK_DECLS([sleep], , , [[#include <unistd.h>]])\n  AC_CHECK_FUNCS_ONCE([sleep])\n  if test $ac_cv_have_decl_sleep != yes; then\n    HAVE_SLEEP=0\n  else\n    dnl Cygwin 1.5.x has a bug where sleep can't exceed 49.7 days.\n    AC_CACHE_CHECK([for working sleep], [gl_cv_func_sleep_works],\n      [AC_RUN_IFELSE([AC_LANG_PROGRAM([[\n#include <errno.h>\n#include <unistd.h>\n#include <signal.h>\nstatic void\nhandle_alarm (int sig)\n{\n  if (sig != SIGALRM)\n    _exit (2);\n}\n]], [[\n    /* Failure to compile this test due to missing alarm is okay,\n       since all such platforms (mingw) also lack sleep.  */\n    unsigned int pentecost = 50 * 24 * 60 * 60; /* 50 days.  */\n    unsigned int remaining;\n    signal (SIGALRM, handle_alarm);\n    alarm (1);\n    remaining = sleep (pentecost);\n    if (remaining > pentecost)\n      return 3;\n    if (remaining <= pentecost - 10)\n      return 4;\n    return 0;\n    ]])],\n      [gl_cv_func_sleep_works=yes], [gl_cv_func_sleep_works=no],\n      [case \"$host_os\" in\n                            # Guess yes on glibc systems.\n         *-gnu* | gnu*)     gl_cv_func_sleep_works=\"guessing yes\" ;;\n                            # Guess yes on musl systems.\n         *-musl*)           gl_cv_func_sleep_works=\"guessing yes\" ;;\n                            # Guess yes on systems that emulate the Linux system calls.\n         midipix*)          gl_cv_func_sleep_works=\"guessing yes\" ;;\n                            # Guess no on native Windows.\n         mingw* | windows*) gl_cv_func_sleep_works=\"guessing no\" ;;\n                            # If we don't know, obey --enable-cross-guesses.\n         *)                 gl_cv_func_sleep_works=\"$gl_cross_guess_normal\" ;;\n       esac\n      ])])\n    case \"$gl_cv_func_sleep_works\" in\n      *yes) ;;\n      *)\n        REPLACE_SLEEP=1\n        ;;\n    esac\n  fi\n])\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}