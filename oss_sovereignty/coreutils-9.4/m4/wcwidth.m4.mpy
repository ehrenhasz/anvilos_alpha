{
  "module_name": "wcwidth.m4",
  "hash_id": "fd4087e9f10666bfc2ec0ac1f52641015c9fa16a75534f057ff1ea74211ef65a",
  "original_prompt": "Ingested from coreutils-9.4/m4/wcwidth.m4",
  "human_readable_source": "# wcwidth.m4 serial 36\ndnl Copyright (C) 2006-2023 Free Software Foundation, Inc.\ndnl This file is free software; the Free Software Foundation\ndnl gives unlimited permission to copy and/or distribute it,\ndnl with or without modifications, as long as this notice is preserved.\n\nAC_DEFUN([gl_FUNC_WCWIDTH],\n[\n  AC_REQUIRE([gl_WCHAR_H_DEFAULTS])\n  AC_REQUIRE([AC_CANONICAL_HOST]) dnl for cross-compiles\n\n  dnl Persuade glibc <wchar.h> to declare wcwidth().\n  AC_REQUIRE([AC_USE_SYSTEM_EXTENSIONS])\n\n  AC_REQUIRE([gt_TYPE_WCHAR_T])\n  AC_REQUIRE([gt_TYPE_WINT_T])\n\n  AC_CHECK_HEADERS_ONCE([wchar.h])\n  AC_CHECK_FUNCS_ONCE([wcwidth])\n\n  AC_CHECK_DECLS([wcwidth], [], [], [[\n    #include <wchar.h>\n  ]])\n  if test $ac_cv_have_decl_wcwidth != yes; then\n    HAVE_DECL_WCWIDTH=0\n  fi\n\n  if test $ac_cv_func_wcwidth != yes; then\n    AC_CACHE_CHECK([whether wcwidth is a macro],\n      [gl_cv_func_wcwidth_macro],\n      [AC_EGREP_CPP([wchar_header_defines_wcwidth], [\n#include <wchar.h>\n#ifdef wcwidth\n wchar_header_defines_wcwidth\n#endif],\n         [gl_cv_func_wcwidth_macro=yes],\n         [gl_cv_func_wcwidth_macro=no])\n      ])\n  fi\n\n  if test $ac_cv_func_wcwidth = yes || test $gl_cv_func_wcwidth_macro = yes; then\n    HAVE_WCWIDTH=1\n    dnl On Mac OS X 10.3, wcwidth(0x0301) (COMBINING ACUTE ACCENT) returns 1.\n    dnl On macOS 12.5, NetBSD 9.0, OpenBSD 5.0, MidnightBSD 1.1,\n    dnl wcwidth(0x05B0) (HEBREW POINT SHEVA) returns 1.\n    dnl On macOS 12.5, NetBSD 9.0, MidnightBSD 1.1, OSF/1 5.1,\n    dnl wcwidth(0x200B) (ZERO WIDTH SPACE) returns 1.\n    dnl On OpenBSD 5.8, wcwidth(0xFF1A) (FULLWIDTH COLON) returns 0.\n    dnl This leads to bugs in 'ls' (coreutils).\n    dnl On Solaris 11.4, wcwidth(0x2202) (PARTIAL DIFFERENTIAL) returns 2,\n    dnl even in Western locales.\n    AC_CACHE_CHECK([whether wcwidth works reasonably in UTF-8 locales],\n      [gl_cv_func_wcwidth_works],\n      [\n        AC_RUN_IFELSE(\n          [AC_LANG_SOURCE([[\n#include <locale.h>\n#include <wchar.h>\n#if !HAVE_DECL_WCWIDTH\nextern\n# ifdef __cplusplus\n\"C\"\n# endif\nint wcwidth (int);\n#endif\nint main ()\n{\n  int result = 0;\n  if (setlocale (LC_ALL, \"en_US.UTF-8\") != NULL)\n    {\n      if (wcwidth (0x0301) > 0)\n        result |= 1;\n      if (wcwidth (0x05B0) > 0)\n        result |= 2;\n      if (wcwidth (0x200B) > 0)\n        result |= 4;\n      if (wcwidth (0xFF1A) == 0)\n        result |= 8;\n      if (wcwidth (0x2202) > 1)\n        result |= 16;\n    }\n  return result;\n}]])],\n          [gl_cv_func_wcwidth_works=yes],\n          [gl_cv_func_wcwidth_works=no],\n          [\nchangequote(,)dnl\n           case \"$host_os\" in\n                                 # Guess yes on glibc systems.\n             *-gnu* | gnu*)      gl_cv_func_wcwidth_works=\"guessing yes\";;\n                                 # Guess yes on musl systems.\n             *-musl* | midipix*) gl_cv_func_wcwidth_works=\"guessing yes\";;\n                                 # Guess yes on AIX 7 systems.\n             aix[7-9]*)          gl_cv_func_wcwidth_works=\"guessing yes\";;\n             *)                  gl_cv_func_wcwidth_works=\"$gl_cross_guess_normal\";;\n           esac\nchangequote([,])dnl\n          ])\n      ])\n    case \"$gl_cv_func_wcwidth_works\" in\n      *yes) ;;\n      *no) REPLACE_WCWIDTH=1 ;;\n    esac\n  else\n    HAVE_WCWIDTH=0\n  fi\n  dnl We don't substitute HAVE_WCWIDTH. We assume that if the system does not\n  dnl have the wcwidth function, then it does not declare it.\n])\n\n# Prerequisites of lib/wcwidth.c.\nAC_DEFUN([gl_PREREQ_WCWIDTH], [\n  AC_REQUIRE([AC_C_INLINE])\n  :\n])\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}