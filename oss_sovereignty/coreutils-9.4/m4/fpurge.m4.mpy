{
  "module_name": "fpurge.m4",
  "hash_id": "e8870d47ac30ce236786c195683c80567ef63ca9e86d776b4e9292fd1fc0e9db",
  "original_prompt": "Ingested from coreutils-9.4/m4/fpurge.m4",
  "human_readable_source": "# fpurge.m4 serial 14\ndnl Copyright (C) 2007, 2009-2023 Free Software Foundation, Inc.\ndnl This file is free software; the Free Software Foundation\ndnl gives unlimited permission to copy and/or distribute it,\ndnl with or without modifications, as long as this notice is preserved.\n\nAC_DEFUN([gl_FUNC_FPURGE],\n[\n  AC_REQUIRE([gl_STDIO_H_DEFAULTS])\n  AC_REQUIRE([AC_CANONICAL_HOST]) dnl for cross-compiles\n  AC_CHECK_HEADERS_ONCE([stdio_ext.h])\n  AC_CHECK_FUNCS_ONCE([fpurge])\n  gl_CHECK_FUNCS_ANDROID([__fpurge], [[#include <stdio_ext.h>]])\n  AC_CHECK_DECLS([fpurge], , , [[#include <stdio.h>]])\n  if test \"x$ac_cv_func_fpurge\" = xyes; then\n    HAVE_FPURGE=1\n    # Detect BSD bug.  Only cygwin 1.7 and musl are known to be immune.\n    AC_CACHE_CHECK([whether fpurge works], [gl_cv_func_fpurge_works],\n      [AC_RUN_IFELSE(\n         [AC_LANG_PROGRAM(\n            [[#include <stdio.h>\n]],\n            [[FILE *f = fopen (\"conftest.txt\", \"w+\");\n              if (!f)\n                return 1;\n              if (fputc ('a', f) != 'a')\n                { fclose (f); return 2; }\n              rewind (f);\n              if (fgetc (f) != 'a')\n                { fclose (f); return 3; }\n              if (fgetc (f) != EOF)\n                { fclose (f); return 4; }\n              if (fpurge (f) != 0)\n                { fclose (f); return 5; }\n              if (putc ('b', f) != 'b')\n                { fclose (f); return 6; }\n              if (fclose (f) != 0)\n                return 7;\n              if ((f = fopen (\"conftest.txt\", \"r\")) == NULL)\n                return 8;\n              if (fgetc (f) != 'a')\n                { fclose (f); return 9; }\n              if (fgetc (f) != 'b')\n                { fclose (f); return 10; }\n              if (fgetc (f) != EOF)\n                { fclose (f); return 11; }\n              if (fclose (f) != 0)\n                return 12;\n              if (remove (\"conftest.txt\") != 0)\n                return 13;\n              return 0;\n            ]])],\n         [gl_cv_func_fpurge_works=yes],\n         [gl_cv_func_fpurge_works=no],\n         [case \"$host_os\" in\n                                # Guess yes on musl systems.\n            *-musl* | midipix*) gl_cv_func_fpurge_works=\"guessing yes\" ;;\n                                # Otherwise obey --enable-cross-guesses.\n            *)                  gl_cv_func_fpurge_works=\"$gl_cross_guess_normal\" ;;\n          esac\n         ])\n      ])\n    case \"$gl_cv_func_fpurge_works\" in\n      *yes) ;;\n      *) REPLACE_FPURGE=1 ;;\n    esac\n  else\n    HAVE_FPURGE=0\n  fi\n  if test \"x$ac_cv_have_decl_fpurge\" = xno; then\n    HAVE_DECL_FPURGE=0\n  fi\n])\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}