{
  "module_name": "frexpl.m4",
  "hash_id": "07b2617243770a310d0283a0d55d36545afef3d14bcbc94b0375f075eeee9ecf",
  "original_prompt": "Ingested from coreutils-9.4/m4/frexpl.m4",
  "human_readable_source": "# frexpl.m4 serial 23\ndnl Copyright (C) 2007-2023 Free Software Foundation, Inc.\ndnl This file is free software; the Free Software Foundation\ndnl gives unlimited permission to copy and/or distribute it,\ndnl with or without modifications, as long as this notice is preserved.\n\nAC_DEFUN([gl_FUNC_FREXPL],\n[\n  AC_REQUIRE([gl_MATH_H_DEFAULTS])\n  AC_REQUIRE([gl_LONG_DOUBLE_VS_DOUBLE])\n\n  dnl Persuade glibc <math.h> to declare frexpl().\n  AC_REQUIRE([gl_USE_SYSTEM_EXTENSIONS])\n\n  dnl Check whether it's declared.\n  dnl Mac OS X 10.3 has frexpl() in libc but doesn't declare it in <math.h>.\n  AC_CHECK_DECL([frexpl], , [HAVE_DECL_FREXPL=0], [[#include <math.h>]])\n\n  FREXPL_LIBM=\n  if test $HAVE_DECL_FREXPL = 1; then\n    gl_CHECK_FREXPL_NO_LIBM\n    if test $gl_cv_func_frexpl_no_libm = no; then\n      AC_CACHE_CHECK([whether frexpl() can be used with libm],\n        [gl_cv_func_frexpl_in_libm],\n        [\n          save_LIBS=\"$LIBS\"\n          LIBS=\"$LIBS -lm\"\n          AC_LINK_IFELSE(\n            [AC_LANG_PROGRAM(\n               [[#include <math.h>\n                 long double x;]],\n               [[int e; return frexpl (x, &e) > 0;]])],\n            [gl_cv_func_frexpl_in_libm=yes],\n            [gl_cv_func_frexpl_in_libm=no])\n          LIBS=\"$save_LIBS\"\n        ])\n      if test $gl_cv_func_frexpl_in_libm = yes; then\n        FREXPL_LIBM=-lm\n      fi\n    fi\n    if test $gl_cv_func_frexpl_no_libm = yes \\\n       || test $gl_cv_func_frexpl_in_libm = yes; then\n      save_LIBS=\"$LIBS\"\n      LIBS=\"$LIBS $FREXPL_LIBM\"\n      gl_FUNC_FREXPL_WORKS\n      LIBS=\"$save_LIBS\"\n      case \"$gl_cv_func_frexpl_works\" in\n        *yes) gl_func_frexpl=yes ;;\n        *)    gl_func_frexpl=no; REPLACE_FREXPL=1 ;;\n      esac\n    else\n      gl_func_frexpl=no\n    fi\n    if test $gl_func_frexpl = yes; then\n      AC_DEFINE([HAVE_FREXPL], [1],\n        [Define if the frexpl() function is available.])\n    fi\n  fi\n  if test $HAVE_DECL_FREXPL = 0 || test $gl_func_frexpl = no; then\n    dnl Find libraries needed to link lib/frexpl.c.\n    if test $HAVE_SAME_LONG_DOUBLE_AS_DOUBLE = 1; then\n      AC_REQUIRE([gl_FUNC_FREXP])\n      FREXPL_LIBM=\"$FREXP_LIBM\"\n    else\n      FREXPL_LIBM=\n    fi\n  fi\n  AC_SUBST([FREXPL_LIBM])\n])\n\nAC_DEFUN([gl_FUNC_FREXPL_NO_LIBM],\n[\n  AC_REQUIRE([gl_MATH_H_DEFAULTS])\n  AC_REQUIRE([gl_LONG_DOUBLE_VS_DOUBLE])\n  dnl Check whether it's declared.\n  dnl Mac OS X 10.3 has frexpl() in libc but doesn't declare it in <math.h>.\n  AC_CHECK_DECL([frexpl], , [HAVE_DECL_FREXPL=0], [[#include <math.h>]])\n  if test $HAVE_DECL_FREXPL = 1; then\n    gl_CHECK_FREXPL_NO_LIBM\n    if test $gl_cv_func_frexpl_no_libm = yes; then\n      gl_FUNC_FREXPL_WORKS\n      case \"$gl_cv_func_frexpl_works\" in\n        *yes) gl_func_frexpl_no_libm=yes ;;\n        *)    gl_func_frexpl_no_libm=no; REPLACE_FREXPL=1 ;;\n      esac\n    else\n      gl_func_frexpl_no_libm=no\n      dnl Set REPLACE_FREXPL here because the system may have frexpl in libm.\n      REPLACE_FREXPL=1\n    fi\n    if test $gl_func_frexpl_no_libm = yes; then\n      AC_DEFINE([HAVE_FREXPL_IN_LIBC], [1],\n        [Define if the frexpl() function is available in libc.])\n    fi\n  fi\n])\n\ndnl Test whether frexpl() can be used without linking with libm.\ndnl Set gl_cv_func_frexpl_no_libm to 'yes' or 'no' accordingly.\nAC_DEFUN([gl_CHECK_FREXPL_NO_LIBM],\n[\n  AC_CACHE_CHECK([whether frexpl() can be used without linking with libm],\n    [gl_cv_func_frexpl_no_libm],\n    [\n      AC_LINK_IFELSE(\n        [AC_LANG_PROGRAM(\n           [[#include <math.h>\n             long double x;]],\n           [[int e; return frexpl (x, &e) > 0;]])],\n        [gl_cv_func_frexpl_no_libm=yes],\n        [gl_cv_func_frexpl_no_libm=no])\n    ])\n])\n\ndnl Test whether frexpl() works on finite numbers (this fails on\ndnl Mac OS X 10.4/PowerPC, on AIX 5.1, and on BeOS), on denormalized numbers\ndnl (this fails on Mac OS X 10.5/i386), and also on infinite numbers (this\ndnl fails e.g. on IRIX 6.5 and mingw).\nAC_DEFUN([gl_FUNC_FREXPL_WORKS],\n[\n  AC_REQUIRE([AC_PROG_CC])\n  AC_REQUIRE([AC_CANONICAL_HOST]) dnl for cross-compiles\n  AC_CACHE_CHECK([whether frexpl works], [gl_cv_func_frexpl_works],\n    [\n      AC_RUN_IFELSE(\n        [AC_LANG_SOURCE([[\n#include <float.h>\n#include <math.h>\n/* Override the values of <float.h>, like done in float.in.h.  */\n#if defined __i386__ && (defined __BEOS__ || defined __OpenBSD__)\n# undef LDBL_MIN_EXP\n# define LDBL_MIN_EXP    (-16381)\n#endif\n#if defined __i386__ && (defined __FreeBSD__ || defined __DragonFly__)\n# undef LDBL_MIN_EXP\n# define LDBL_MIN_EXP    (-16381)\n#endif\n#if (defined _ARCH_PPC || defined _POWER) && defined _AIX && (LDBL_MANT_DIG == 106) && defined __GNUC__\n# undef LDBL_MIN_EXP\n# define LDBL_MIN_EXP DBL_MIN_EXP\n#endif\n#if defined __sgi && (LDBL_MANT_DIG >= 106)\n# if defined __GNUC__\n#  undef LDBL_MIN_EXP\n#  define LDBL_MIN_EXP DBL_MIN_EXP\n# endif\n#endif\nextern\n#ifdef __cplusplus\n\"C\"\n#endif\nlong double frexpl (long double, int *);\nlong double zero = 0.0L;\nint main()\n{\n  int result = 0;\n  volatile long double x;\n  /* Test on finite numbers that fails on AIX 5.1.  */\n  x = 16.0L;\n  {\n    int exp = -9999;\n    frexpl (x, &exp);\n    if (exp != 5)\n      result |= 1;\n  }\n  /* Test on finite numbers that fails on Mac OS X 10.4, because its frexpl\n     function returns an invalid (incorrectly normalized) value: it returns\n               y = { 0x3fe028f5, 0xc28f5c28, 0x3c9eb851, 0xeb851eb8 }\n     but the correct result is\n          0.505L = { 0x3fe028f5, 0xc28f5c29, 0xbc547ae1, 0x47ae1480 }  */\n  x = 1.01L;\n  {\n    int exp = -9999;\n    long double y = frexpl (x, &exp);\n    if (!(exp == 1 && y == 0.505L))\n      result |= 2;\n  }\n  /* Test on large finite numbers.  This fails on BeOS at i = 16322, while\n     LDBL_MAX_EXP = 16384.\n     In the loop end test, we test x against Infinity, rather than comparing\n     i with LDBL_MAX_EXP, because BeOS <float.h> has a wrong LDBL_MAX_EXP.  */\n  {\n    int i;\n    for (i = 1, x = 1.0L; x != x + x; i++, x *= 2.0L)\n      {\n        int exp = -9999;\n        frexpl (x, &exp);\n        if (exp != i)\n          {\n            result |= 4;\n            break;\n          }\n      }\n  }\n  /* Test on denormalized numbers.  */\n  {\n    int i;\n    for (i = 1, x = 1.0L; i >= LDBL_MIN_EXP; i--, x *= 0.5L)\n      ;\n    if (x > 0.0L)\n      {\n        int exp;\n        long double y = frexpl (x, &exp);\n        /* On machines with IEEE854 arithmetic: x = 1.68105e-4932,\n           exp = -16382, y = 0.5.  On Mac OS X 10.5: exp = -16384, y = 0.5.  */\n        if (exp != LDBL_MIN_EXP - 1)\n          result |= 8;\n      }\n  }\n  /* Test on infinite numbers.  */\n  /* The Microsoft MSVC 14 compiler chokes on the expression 1.0 / 0.0.  */\n  x = 1.0L / zero;\n  {\n    int exp;\n    long double y = frexpl (x, &exp);\n    if (y != x)\n      result |= 16;\n  }\n  return result;\n}]])],\n        [gl_cv_func_frexpl_works=yes],\n        [gl_cv_func_frexpl_works=no],\n        [\nchangequote(,)dnl\n         case \"$host_os\" in\n           aix | aix[3-6]* | beos* | darwin* | irix* | mingw* | windows* | pw*)\n              gl_cv_func_frexpl_works=\"guessing no\";;\n           *) gl_cv_func_frexpl_works=\"guessing yes\";;\n         esac\nchangequote([,])dnl\n        ])\n    ])\n])\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}