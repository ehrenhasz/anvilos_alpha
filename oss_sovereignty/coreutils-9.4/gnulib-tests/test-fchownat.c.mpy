{
  "module_name": "test-fchownat.c",
  "hash_id": "7e52cb0fd50a8a55b41604f420011d9f8d0b8c470363a7f91b4653a5e2dd26b4",
  "original_prompt": "Ingested from coreutils-9.4/gnulib-tests/test-fchownat.c",
  "human_readable_source": " \n\n#include <config.h>\n\n#include <unistd.h>\n\n#include \"signature.h\"\nSIGNATURE_CHECK (fchownat, int, (int, char const *, uid_t, gid_t, int));\n\n#include <fcntl.h>\n#include <errno.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <sys/stat.h>\n\n#include \"mgetgroups.h\"\n#include \"openat.h\"\n#include \"stat-time.h\"\n#include \"ignore-value.h\"\n#include \"macros.h\"\n\n#ifndef BASE\n# define BASE \"test-fchownat.t\"\n#endif\n\n#include \"test-chown.h\"\n#include \"test-lchown.h\"\n\nstatic int dfd = AT_FDCWD;\n\n \nstatic int\ndo_chown (char const *name, uid_t user, gid_t group)\n{\n#ifdef TEST_CHOWNAT\n  return chownat (dfd, name, user, group);\n#else\n  return fchownat (dfd, name, user, group, 0);\n#endif\n}\n\n \nstatic int\ndo_lchown (char const *name, uid_t user, gid_t group)\n{\n#ifdef TEST_CHOWNAT\n  return lchownat (dfd, name, user, group);\n#else\n  return fchownat (dfd, name, user, group, AT_SYMLINK_NOFOLLOW);\n#endif\n}\n\nint\nmain (_GL_UNUSED int argc, char *argv[])\n{\n  int result1;  \n  int result2;  \n\n   \n  ignore_value (system (\"rm -rf \" BASE \"*\"));\n\n   \n  {\n    errno = 0;\n    ASSERT (fchownat (-1, \"foo\", getuid (), getgid (), 0) == -1);\n    ASSERT (errno == EBADF);\n  }\n  {\n    close (99);\n    errno = 0;\n    ASSERT (fchownat (99, \"foo\", getuid (), getgid (), 0) == -1);\n    ASSERT (errno == EBADF);\n  }\n\n   \n  result1 = test_chown (do_chown, true);\n  result2 = test_lchown (do_lchown, result1 == 0);\n  dfd = open (\".\", O_RDONLY);\n  ASSERT (0 <= dfd);\n  ASSERT (test_chown (do_chown, false) == result1);\n  ASSERT (test_lchown (do_lchown, false) == result2);\n   \n  ASSERT (result1 <= result2);\n  ASSERT (close (dfd) == 0);\n\n   \n  return result1 | result2;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}