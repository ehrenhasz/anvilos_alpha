{
  "module_name": "test-timespec.c",
  "hash_id": "2144bcd5157c215153284eeb34a019adcbe75ab01d488b9ceb54690ce671bb07",
  "original_prompt": "Ingested from coreutils-9.4/gnulib-tests/test-timespec.c",
  "human_readable_source": " \n\n#include <config.h>\n\n#include \"timespec.h\"\n\n#include \"intprops.h\"\n#include \"macros.h\"\n\n#include <limits.h>\n\nstatic struct { int s; int ns; } const prototype[] =\n  {\n    { INT_MIN, 0 },\n    { INT_MIN, 1 },\n    { INT_MIN, TIMESPEC_HZ - 1 },\n    { INT_MIN + 1, 0 },\n    { INT_MIN + 1, 1 },\n    { INT_MIN + 1, TIMESPEC_HZ - 1 },\n    { -1, 0 },\n    { -1, 1 },\n    { -1, TIMESPEC_HZ - 1 },\n    { 0, 0 },\n    { 0, 1 },\n    { 0, TIMESPEC_HZ - 1 },\n    { 1, 0 },\n    { 1, 1 },\n    { 1, TIMESPEC_HZ - 1 },\n    { 1234567890, 0 },\n    { 1234567890, 1 },\n    { 1234567890, TIMESPEC_HZ - 1 },\n    { INT_MAX - 1, 0 },\n    { INT_MAX - 1, 1 },\n    { INT_MAX - 1, TIMESPEC_HZ - 1 },\n    { INT_MAX, 0 },\n    { INT_MAX, 1 },\n    { INT_MAX, TIMESPEC_HZ - 1 },\n    { INT_MAX, 2 * TIMESPEC_HZ }\n  };\nenum { nprototypes = sizeof prototype / sizeof *prototype };\n\nstatic bool\nvalid (struct timespec a)\n{\n  return 0 <= a.tv_nsec && a.tv_nsec < TIMESPEC_HZ;\n}\n\nstatic int\nsign (int i)\n{\n  return i < 0 ? -1 : 0 < i;\n}\n\nstatic int\ncmp (struct timespec a, struct timespec b)\n{\n  return sign (timespec_cmp (a, b));\n}\n\nstatic bool\neq (struct timespec a, struct timespec b)\n{\n  return timespec_cmp (a, b) == 0;\n}\n\nstatic bool\nextremal (struct timespec a)\n{\n  return ((a.tv_sec == TYPE_MINIMUM (time_t) && a.tv_nsec == 0)\n          || (a.tv_sec == TYPE_MAXIMUM (time_t)\n              && a.tv_nsec == TIMESPEC_HZ - 1));\n}\n\nint\nmain (void)\n{\n  int i, j, k;\n  struct timespec test[nprototypes + 1];\n  int ntests;\n  int computed_hz = 1;\n  struct timespec prevroundtrip;\n\n  test[0] = make_timespec (TYPE_MINIMUM (time_t), -1);\n  ntests = 1;\n  for (i = 0; i < nprototypes; i++)\n    {\n      int s = prototype[i].s;\n      if (TYPE_SIGNED (time_t) || 0 <= s)\n        {\n          time_t t = (s <= INT_MIN + 1 ? s - INT_MIN + TYPE_MINIMUM (time_t)\n                      : INT_MAX - 1 <= s ? s - INT_MAX + TYPE_MAXIMUM (time_t)\n                      : s);\n          test[ntests++] = make_timespec (t, prototype[i].ns);\n        }\n    }\n\n  for (i = 0; i < LOG10_TIMESPEC_HZ; i++)\n    computed_hz *= 10;\n  ASSERT (computed_hz == TIMESPEC_HZ);\n\n  for (i = 0; i < ntests; i++)\n    {\n      struct timespec a = test[i];\n\n      struct timespec roundtrip = dtotimespec (timespectod (a));\n      if (i != 0)\n        ASSERT (cmp (prevroundtrip, roundtrip) <= 0);\n      prevroundtrip = roundtrip;\n\n      ASSERT (sign (timespec_sign (a)) == cmp (a, make_timespec (0, 0)));\n\n      if (valid (a))\n        for (j = 0; j < ntests; j++)\n          {\n            struct timespec b = test[j];\n            if (valid (b))\n              {\n                struct timespec sum = timespec_add (a, b);\n                struct timespec diff = timespec_sub (a, b);\n                struct timespec rdiff = timespec_sub (b, a);\n                ASSERT (cmp (a, b) == sign (i - j));\n                ASSERT (eq (sum, timespec_add (b, a)));\n                if (! extremal (sum))\n                  {\n                    ASSERT (eq (a, timespec_sub (sum, b)));\n                    ASSERT (eq (b, timespec_sub (sum, a)));\n\n                    for (k = 0; k < ntests; k++)\n                      {\n                        struct timespec c = test[k];\n                        if (valid (c))\n                          {\n                            struct timespec sumbc = timespec_add (b, c);\n                            if (! extremal (sumbc))\n                              ASSERT (eq (timespec_add (a, sumbc),\n                                          timespec_add (sum, c)));\n                          }\n                      }\n                  }\n                if (! extremal (diff))\n                  ASSERT (eq (a, timespec_add (diff, b)));\n                if (! extremal (rdiff))\n                  ASSERT (eq (b, timespec_add (rdiff, a)));\n\n              }\n          }\n    }\n\n  return 0;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}