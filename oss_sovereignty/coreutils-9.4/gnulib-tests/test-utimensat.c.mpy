{
  "module_name": "test-utimensat.c",
  "hash_id": "28eeb18751965a2f375597824dee492bc32011547d0d9fd40e8d5bb1345ef3e5",
  "original_prompt": "Ingested from coreutils-9.4/gnulib-tests/test-utimensat.c",
  "human_readable_source": " \n\n#include <config.h>\n\n#include <sys/stat.h>\n\n#include \"signature.h\"\nSIGNATURE_CHECK (utimensat, int, (int, char const *, struct timespec const[2],\n                                  int));\n\n#include <fcntl.h>\n#include <errno.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <string.h>\n#include <unistd.h>\n\n#include \"stat-time.h\"\n#include \"timespec.h\"\n#include \"utimecmp.h\"\n#include \"ignore-value.h\"\n#include \"macros.h\"\n\n#define BASE \"test-utimensat.t\"\n\n#include \"test-lutimens.h\"\n#include \"test-utimens.h\"\n\nstatic int dfd = AT_FDCWD;\n\n \nstatic int\ndo_utimensat (char const *name, struct timespec const times[2])\n{\n  return utimensat (dfd, name, times, 0);\n}\n\n \nstatic int\ndo_lutimensat (char const *name, struct timespec const times[2])\n{\n  return utimensat (dfd, name, times, AT_SYMLINK_NOFOLLOW);\n}\n\nint\nmain (void)\n{\n  int result1;  \n  int result2;  \n  int fd;\n\n   \n  ignore_value (system (\"rm -rf \" BASE \"*\"));\n\n   \n  {\n    errno = 0;\n    ASSERT (utimensat (-1, \"foo\", NULL, 0) == -1);\n    ASSERT (errno == EBADF);\n  }\n  {\n    close (99);\n    errno = 0;\n    ASSERT (utimensat (99, \"foo\", NULL, 0) == -1);\n    ASSERT (errno == EBADF);\n  }\n\n   \n  result1 = test_utimens (do_utimensat, true);\n  result2 = test_lutimens (do_lutimensat, result1 == 0);\n  dfd = open (\".\", O_RDONLY);\n  ASSERT (0 <= dfd);\n  ASSERT (test_utimens (do_utimensat, false) == result1);\n  ASSERT (test_lutimens (do_lutimensat, false) == result2);\n   \n  ASSERT (result1 <= result2);\n\n   \n  ASSERT (mkdir (BASE \"dir\", 0700) == 0);\n  ASSERT (chdir (BASE \"dir\") == 0);\n  fd = creat (\"file\", 0600);\n  ASSERT (0 <= fd);\n  errno = 0;\n  ASSERT (utimensat (fd, \".\", NULL, 0) == -1);\n  ASSERT (errno == ENOTDIR);\n  {\n    struct timespec ts[2];\n    struct stat st;\n    ts[0].tv_sec = Y2K;\n    ts[0].tv_nsec = 0;\n    ts[1].tv_sec = Y2K;\n    ts[1].tv_nsec = 0;\n    ASSERT (utimensat (dfd, BASE \"dir/file\", ts, AT_SYMLINK_NOFOLLOW) == 0);\n    ASSERT (stat (\"file\", &st) == 0);\n    ASSERT (st.st_atime == Y2K);\n    ASSERT (get_stat_atime_ns (&st) == 0);\n    ASSERT (st.st_mtime == Y2K);\n    ASSERT (get_stat_mtime_ns (&st) == 0);\n  }\n  ASSERT (close (fd) == 0);\n  ASSERT (close (dfd) == 0);\n  errno = 0;\n  ASSERT (utimensat (dfd, \".\", NULL, 0) == -1);\n  ASSERT (errno == EBADF);\n\n   \n  ASSERT (chdir (\"..\") == 0);\n  ASSERT (unlink (BASE \"dir/file\") == 0);\n  ASSERT (rmdir (BASE \"dir\") == 0);\n  return result1 | result2;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}