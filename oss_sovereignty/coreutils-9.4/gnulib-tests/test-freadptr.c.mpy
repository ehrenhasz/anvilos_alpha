{
  "module_name": "test-freadptr.c",
  "hash_id": "79937b05999457e81e2d44b01d570ea55e63a5d868bba80da62e6ebd3ea0fb85",
  "original_prompt": "Ingested from coreutils-9.4/gnulib-tests/test-freadptr.c",
  "human_readable_source": " \n\n#include <config.h>\n\n#include \"freadptr.h\"\n\n#include <stdlib.h>\n#include <string.h>\n#include <unistd.h>\n\n#include \"macros.h\"\n\nint\nmain (int argc, char **argv)\n{\n  int nbytes = atoi (argv[1]);\n  {\n    void *buf = malloc (nbytes);\n    ASSERT (fread (buf, 1, nbytes, stdin) == nbytes);\n    free (buf);\n  }\n\n  if (lseek (0, 0, SEEK_CUR) == nbytes)\n    {\n       \n      size_t size;\n      ASSERT (freadptr (stdin, &size) == NULL);\n    }\n  else\n    {\n       \n      const char stdin_contents[] =\n        \"#!/bin/sh\\n\\n${CHECKER} ./test-freadptr${EXEEXT} 5 < \\\"$srcdir/test-freadptr.sh\\\" || exit 1\\ncat \\\"$srcdir/test-freadptr.sh\\\" | ${CHECKER} ./test-freadptr${EXEEXT} 5 || exit 1\\nexit 0\\n\";\n      const char *expected = stdin_contents + nbytes;\n      size_t available1;\n      size_t available2;\n      size_t available3;\n\n       \n      {\n        const char *ptr = freadptr (stdin, &available1);\n\n        ASSERT (ptr != NULL);\n        ASSERT (available1 != 0);\n        ASSERT (available1 <= strlen (expected));\n        ASSERT (memcmp (ptr, expected, available1) == 0);\n      }\n\n       \n      ungetc (fgetc (stdin), stdin);\n      {\n        const char *ptr = freadptr (stdin, &available2);\n\n        if (ptr != NULL)\n          {\n            ASSERT (available2 == available1);\n            ASSERT (memcmp (ptr, expected, available2) == 0);\n          }\n      }\n\n       \n      fgetc (stdin);\n      ungetc ('@', stdin);\n      {\n        const char *ptr = freadptr (stdin, &available3);\n\n        if (ptr != NULL)\n          {\n            ASSERT (available3 == 1 || available3 == available1);\n            ASSERT (ptr[0] == '@');\n            if (available3 > 1)\n              {\n                ASSERT (memcmp (ptr + 1, expected + 1, available3 - 1) == 0);\n              }\n          }\n      }\n    }\n\n   \n  fclose (stdin);\n\n  return 0;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}