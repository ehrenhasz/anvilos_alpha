{
  "module_name": "test-perror2.c",
  "hash_id": "bd205a07b2b44701e04e9a3cd722f9f6afa5c0f503926d3d707bf64e6efb0871",
  "original_prompt": "Ingested from coreutils-9.4/gnulib-tests/test-perror2.c",
  "human_readable_source": " \n#if __GNUC__ >= 13\n# pragma GCC diagnostic ignored \"-Wanalyzer-fd-leak\"\n#endif\n\n \n#define BACKUP_STDERR_FILENO 10\n#define ASSERT_STREAM myerr\n#include \"macros.h\"\n\nstatic FILE *myerr;\n\n#define BASE \"test-perror2\"\n\nint\nmain (void)\n{\n   \n  if (dup2 (STDERR_FILENO, BACKUP_STDERR_FILENO) != BACKUP_STDERR_FILENO\n      || (myerr = fdopen (BACKUP_STDERR_FILENO, \"w\")) == NULL)\n    return 2;\n\n  ASSERT (freopen (BASE \".tmp\", \"w+\", stderr) == stderr);\n\n   \n  {\n    const char *msg1;\n    const char *msg2;\n    const char *msg3;\n    const char *msg4;\n    char *str1;\n    char *str2;\n    char *str3;\n    char *str4;\n\n    msg1 = strerror (ENOENT);\n    ASSERT (msg1);\n    str1 = strdup (msg1);\n    ASSERT (str1);\n\n    msg2 = strerror (ERANGE);\n    ASSERT (msg2);\n    str2 = strdup (msg2);\n    ASSERT (str2);\n\n    msg3 = strerror (-4);\n    ASSERT (msg3);\n    str3 = strdup (msg3);\n    ASSERT (str3);\n\n    msg4 = strerror (1729576);\n    ASSERT (msg4);\n    str4 = strdup (msg4);\n    ASSERT (str4);\n\n    errno = EACCES;\n    perror (\"\");\n    errno = -5;\n    perror (\"\");\n    ASSERT (!ferror (stderr));\n    ASSERT (STREQ (msg4, str4));\n\n    free (str1);\n    free (str2);\n    free (str3);\n    free (str4);\n  }\n\n   \n  {\n    int errs[] = { EACCES, 0, -3, };\n    int i;\n    for (i = 0; i < SIZEOF (errs); i++)\n      {\n        char buf[256];\n        const char *err = strerror (errs[i]);\n\n        ASSERT (err);\n        ASSERT (strlen (err) < sizeof buf);\n        rewind (stderr);\n        ASSERT (ftruncate (fileno (stderr), 0) == 0);\n        errno = errs[i];\n        perror (NULL);\n        ASSERT (!ferror (stderr));\n        rewind (stderr);\n        ASSERT (fgets (buf, sizeof buf, stderr) == buf);\n        ASSERT (strstr (buf, err));\n      }\n  }\n\n   \n  {\n    ASSERT (freopen (BASE \".tmp\", \"r\", stderr) == stderr);\n    ASSERT (setvbuf (stderr, NULL, _IONBF, BUFSIZ) == 0);\n    errno = -1;\n    ASSERT (!ferror (stderr));\n    perror (NULL);\n#if 0\n    /* Commented out until cygwin behaves:\n       https:\n    ASSERT (errno > 0);\n    /* Commented out until glibc behaves:\n       https:\n    ASSERT (ferror (stderr));\n#endif\n  }\n\n  ASSERT (fclose (stderr) == 0);\n  ASSERT (remove (BASE \".tmp\") == 0);\n\n  return 0;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}