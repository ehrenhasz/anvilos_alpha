{
  "module_name": "test-fstatat.c",
  "hash_id": "5fab0657c017c9c536dfb44c9e2e36af9f525880f986df4b5f1ae81b9bee211f",
  "original_prompt": "Ingested from coreutils-9.4/gnulib-tests/test-fstatat.c",
  "human_readable_source": " \n\n#include <config.h>\n\n#include <sys/stat.h>\n\n#include \"signature.h\"\nSIGNATURE_CHECK (fstatat, int, (int, char const *, struct stat *, int));\n\n#include <fcntl.h>\n#include <errno.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <unistd.h>\n\n#include \"openat.h\"\n#include \"same-inode.h\"\n#include \"ignore-value.h\"\n#include \"macros.h\"\n\n#ifndef BASE\n# define BASE \"test-fstatat.t\"\n#endif\n\n#include \"test-lstat.h\"\n#include \"test-stat.h\"\n\nstatic int dfd = AT_FDCWD;\n\n \nstatic int\ndo_stat (char const *name, struct stat *st)\n{\n#ifdef TEST_STATAT\n  return statat (dfd, name, st);\n#else\n  return fstatat (dfd, name, st, 0);\n#endif\n}\n\n \nstatic int\ndo_lstat (char const *name, struct stat *st)\n{\n#ifdef TEST_STATAT\n  return lstatat (dfd, name, st);\n#else\n  return fstatat (dfd, name, st, AT_SYMLINK_NOFOLLOW);\n#endif\n}\n\nint\nmain (_GL_UNUSED int argc, char *argv[])\n{\n  int result;\n\n   \n  ignore_value (system (\"rm -rf \" BASE \"*\"));\n\n   \n  {\n    struct stat statbuf;\n\n    errno = 0;\n    ASSERT (fstatat (-1, \"foo\", &statbuf, 0) == -1);\n    ASSERT (errno == EBADF);\n  }\n  {\n    struct stat statbuf;\n\n    close (99);\n    errno = 0;\n    ASSERT (fstatat (99, \"foo\", &statbuf, 0) == -1);\n    ASSERT (errno == EBADF);\n  }\n\n  result = test_stat_func (do_stat, false);\n  ASSERT (test_lstat_func (do_lstat, false) == result);\n  dfd = open (\".\", O_RDONLY);\n  ASSERT (0 <= dfd);\n  ASSERT (test_stat_func (do_stat, false) == result);\n  ASSERT (test_lstat_func (do_lstat, false) == result);\n  ASSERT (close (dfd) == 0);\n\n   \n\n  if (result == 77)\n    fputs (\"skipping test: symlinks not supported on this file system\\n\",\n           stderr);\n  return result;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}