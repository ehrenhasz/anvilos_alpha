{
  "module_name": "test-priv-set.c",
  "hash_id": "e16cad08b02dc4a18eefef934c79a604359d9c782440b37cb03447788ef46bc9",
  "original_prompt": "Ingested from coreutils-9.4/gnulib-tests/test-priv-set.c",
  "human_readable_source": " \n\n#include <config.h>\n\n#include \"priv-set.h\"\n\n#if HAVE_GETPPRIV && HAVE_PRIV_H\n# include <priv.h>\n#endif\n#include <unistd.h>\n#include <errno.h>\n#include <sys/types.h>\n\n#include \"macros.h\"\n\nint\nmain (void)\n{\n#if HAVE_GETPPRIV && HAVE_PRIV_H\n    priv_set_t *set;\n\n    ASSERT (set = priv_allocset ());\n    ASSERT (getppriv (PRIV_EFFECTIVE, set) == 0);\n    ASSERT (priv_ismember (set, PRIV_PROC_EXEC) == 1);\n\n     \n    ASSERT (priv_set_ismember (PRIV_PROC_EXEC) == 1);\n        ASSERT (getppriv (PRIV_EFFECTIVE, set) == 0);\n        ASSERT (priv_ismember (set, PRIV_PROC_EXEC) == 1);\n    ASSERT (priv_set_restore (PRIV_PROC_EXEC) == -1);\n        ASSERT (errno == EINVAL);\n    ASSERT (priv_set_ismember (PRIV_PROC_EXEC) == 1);\n        ASSERT (getppriv (PRIV_EFFECTIVE, set) == 0);\n        ASSERT (priv_ismember (set, PRIV_PROC_EXEC) == 1);\n    ASSERT (priv_set_remove (PRIV_PROC_EXEC) == 0);\n    ASSERT (priv_set_ismember (PRIV_PROC_EXEC) == 0);\n        ASSERT (getppriv (PRIV_EFFECTIVE, set) == 0);\n        ASSERT (priv_ismember (set, PRIV_PROC_EXEC) == 0);\n    ASSERT (priv_set_remove (PRIV_PROC_EXEC) == -1);\n        ASSERT (errno == EINVAL);\n    ASSERT (priv_set_ismember (PRIV_PROC_EXEC) == 0);\n        ASSERT (getppriv (PRIV_EFFECTIVE, set) == 0);\n        ASSERT (priv_ismember (set, PRIV_PROC_EXEC) == 0);\n    ASSERT (priv_set_restore (PRIV_PROC_EXEC) == 0);\n    ASSERT (priv_set_ismember (PRIV_PROC_EXEC) == 1);\n        ASSERT (getppriv (PRIV_EFFECTIVE, set) == 0);\n        ASSERT (priv_ismember (set, PRIV_PROC_EXEC) == 1);\n    ASSERT (priv_set_restore (PRIV_PROC_EXEC) == -1);\n        ASSERT (errno == EINVAL);\n    ASSERT (priv_set_ismember (PRIV_PROC_EXEC) == 1);\n        ASSERT (getppriv (PRIV_EFFECTIVE, set) == 0);\n        ASSERT (priv_ismember (set, PRIV_PROC_EXEC) == 1);\n\n     \n    ASSERT (getppriv (PRIV_EFFECTIVE, set) == 0);\n    if (priv_ismember (set, PRIV_SYS_LINKDIR))\n      {\n        ASSERT (priv_set_restore_linkdir () == -1);\n            ASSERT (errno == EINVAL);\n        ASSERT (priv_set_remove_linkdir () == 0);\n        ASSERT (priv_set_remove_linkdir () == -1);\n            ASSERT (errno == EINVAL);\n        ASSERT (priv_set_restore_linkdir () == 0);\n      }\n#else\n    ASSERT (priv_set_restore_linkdir () == -1);\n    ASSERT (priv_set_remove_linkdir () == -1);\n#endif\n\n    return 0;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}