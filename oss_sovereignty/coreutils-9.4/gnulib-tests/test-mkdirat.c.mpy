{
  "module_name": "test-mkdirat.c",
  "hash_id": "495a79cc32e62ff5dd0a856e7d0f212085c3fd678cab3aadd30425d40514cb31",
  "original_prompt": "Ingested from coreutils-9.4/gnulib-tests/test-mkdirat.c",
  "human_readable_source": " \n\n#include <config.h>\n\n#include <sys/stat.h>\n\n#include \"signature.h\"\nSIGNATURE_CHECK (mkdirat, int, (int, char const *, mode_t));\n\n#include <fcntl.h>\n#include <errno.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <unistd.h>\n\n#include \"ignore-value.h\"\n#include \"macros.h\"\n\n#define BASE \"test-mkdirat.t\"\n\n#include \"test-mkdir.h\"\n\nstatic int dfd = AT_FDCWD;\n\n \nstatic int\ndo_mkdir (char const *name, mode_t mode)\n{\n  return mkdirat (dfd, name, mode);\n}\n\nint\nmain (_GL_UNUSED int argc, char *argv[])\n{\n  int result;\n\n   \n  ignore_value (system (\"rm -rf \" BASE \"*\"));\n\n   \n  {\n    errno = 0;\n    ASSERT (mkdirat (-1, \"foo\", 0700) == -1);\n    ASSERT (errno == EBADF);\n  }\n  {\n    close (99);\n    errno = 0;\n    ASSERT (mkdirat (99, \"foo\", 0700) == -1);\n    ASSERT (errno == EBADF);\n  }\n\n   \n  result = test_mkdir (do_mkdir, false);\n  dfd = open (\".\", O_RDONLY);\n  ASSERT (0 <= dfd);\n  ASSERT (test_mkdir (do_mkdir, false) == result);\n\n   \n  ASSERT (mkdirat (dfd, BASE \"dir1\", 0700) == 0);\n  ASSERT (chdir (BASE \"dir1\") == 0);\n  ASSERT (close (dfd) == 0);\n  dfd = open (\"..\", O_RDONLY);\n  ASSERT (0 <= dfd);\n  ASSERT (mkdirat (dfd, BASE \"dir2\", 0700) == 0);\n  ASSERT (close (dfd) == 0);\n  errno = 0;\n  ASSERT (mkdirat (dfd, BASE \"dir3\", 0700) == -1);\n  ASSERT (errno == EBADF);\n  dfd = open (\"/dev/null\", O_RDONLY);\n  ASSERT (0 <= dfd);\n  errno = 0;\n  ASSERT (mkdirat (dfd, \"dir3\", 0700) == -1);\n  ASSERT (errno == ENOTDIR);\n  ASSERT (close (dfd) == 0);\n  ASSERT (chdir (\"..\") == 0);\n  ASSERT (rmdir (BASE \"dir1\") == 0);\n  ASSERT (rmdir (BASE \"dir2\") == 0);\n\n  return result;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}