{
  "module_name": "test-setlocale_null-mt-all.c",
  "hash_id": "2f37131adf7fac5cc5fe9641b4b66abd08a42e41a2272d6960a53df7b5957b1e",
  "original_prompt": "Ingested from coreutils-9.4/gnulib-tests/test-setlocale_null-mt-all.c",
  "human_readable_source": " \n\n#include <config.h>\n\n \n#if 4 < __GNUC__ + (3 <= __GNUC_MINOR__)\n# pragma GCC diagnostic ignored \"-Wreturn-type\"\n#endif\n\n#if USE_ISOC_THREADS || USE_POSIX_THREADS || USE_ISOC_AND_POSIX_THREADS || USE_WINDOWS_THREADS\n\n \n#include <locale.h>\n\n#include <stdio.h>\n#include <stdlib.h>\n#include <string.h>\n#include <time.h>\n\n#include \"glthread/thread.h\"\n\n \n#undef setlocale\n\n\n \n\n#if defined _WIN32 && !defined __CYGWIN__\n# define ENGLISH \"English_United States\"\n# define GERMAN  \"German_Germany\"\n# define FRENCH  \"French_France\"\n# define ENCODING \".1252\"\n#else\n# define ENGLISH \"en_US\"\n# define GERMAN  \"de_DE\"\n# define FRENCH  \"fr_FR\"\n# if defined __sgi\n#  define ENCODING \".ISO8859-15\"\n# elif defined __hpux\n#  define ENCODING \".utf8\"\n# else\n#  define ENCODING \".UTF-8\"\n# endif\n#endif\n\nstatic const char LOCALE1[] = ENGLISH ENCODING;\nstatic const char LOCALE2[] = GERMAN ENCODING;\nstatic const char LOCALE3[] = FRENCH ENCODING;\n\nstatic char *expected;\n\nstatic void *\nthread1_func (void *arg)\n{\n  for (;;)\n    {\n      char buf[SETLOCALE_NULL_ALL_MAX];\n\n      if (setlocale_null_r (LC_ALL, buf, sizeof (buf)))\n        abort ();\n      if (strcmp (expected, buf) != 0)\n        {\n          fprintf (stderr, \"thread1 disturbed by thread2!\\n\"); fflush (stderr);\n          abort ();\n        }\n    }\n\n   \n}\n\nstatic void *\nthread2_func (void *arg)\n{\n  for (;;)\n    {\n      char buf[SETLOCALE_NULL_ALL_MAX];\n\n      setlocale_null_r (LC_NUMERIC, buf, sizeof (buf));\n      setlocale_null_r (LC_ALL, buf, sizeof (buf));\n    }\n\n   \n}\n\nint\nmain (int argc, char *argv[])\n{\n  if (setlocale (LC_ALL, LOCALE1) == NULL)\n    {\n      fprintf (stderr, \"Skipping test: LOCALE1 not recognized\\n\");\n      return 77;\n    }\n  if (setlocale (LC_NUMERIC, LOCALE2) == NULL)\n    {\n      fprintf (stderr, \"Skipping test: LOCALE2 not recognized\\n\");\n      return 77;\n    }\n  if (setlocale (LC_TIME, LOCALE3) == NULL)\n    {\n      fprintf (stderr, \"Skipping test: LOCALE3 not recognized\\n\");\n      return 77;\n    }\n\n  expected = strdup (setlocale (LC_ALL, NULL));\n\n   \n  gl_thread_create (thread1_func, NULL);\n  gl_thread_create (thread2_func, NULL);\n\n   \n  {\n    struct timespec duration;\n    duration.tv_sec = 5;\n    duration.tv_nsec = 0;\n\n    nanosleep (&duration, NULL);\n  }\n\n  return 0;\n}\n\n#else\n\n \n\n#include <stdio.h>\n\nint\nmain ()\n{\n  fputs (\"Skipping test: multithreading not enabled\\n\", stderr);\n  return 77;\n}\n\n#endif\n\n \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}