{
  "module_name": "test-fclose.c",
  "hash_id": "0cd24bfeb1261fbc67081e2b4e9b6f154cece69e1c5714c411d60856513c089b",
  "original_prompt": "Ingested from coreutils-9.4/gnulib-tests/test-fclose.c",
  "human_readable_source": " \n\n#include <config.h>\n\n#include <stdio.h>\n\n#include \"signature.h\"\nSIGNATURE_CHECK (fclose, int, (FILE *));\n\n#include <errno.h>\n#include <fcntl.h>\n#include <stdlib.h>\n#include <string.h>\n#include <unistd.h>\n\n#include \"macros.h\"\n\n#define BASE \"test-fclose.t\"\n\nint\nmain (int argc, char **argv)\n{\n  const char buf[] = \"hello world\";\n  int fd;\n  int fd2;\n  FILE *f;\n\n   \n  fd = open (BASE, O_RDWR | O_CREAT | O_TRUNC, 0600);\n  ASSERT (0 <= fd);\n  ASSERT (write (fd, buf, sizeof buf) == sizeof buf);\n  ASSERT (lseek (fd, 1, SEEK_SET) == 1);\n\n   \n  fd2 = dup (fd);\n  ASSERT (0 <= fd2);\n  f = fdopen (fd2, \"w\");\n  ASSERT (f);\n  ASSERT (fputc (buf[1], f) == buf[1]);\n  ASSERT (fclose (f) == 0);\n  errno = 0;\n  ASSERT (lseek (fd2, 0, SEEK_CUR) == -1);\n  ASSERT (errno == EBADF);\n  ASSERT (lseek (fd, 0, SEEK_CUR) == 2);\n\n   \n  fd2 = dup (fd);\n  ASSERT (0 <= fd2);\n  f = fdopen (fd2, \"r\");\n  ASSERT (f);\n  ASSERT (fgetc (f) == buf[2]);\n  ASSERT (fclose (f) == 0);\n  errno = 0;\n  ASSERT (lseek (fd2, 0, SEEK_CUR) == -1);\n  ASSERT (errno == EBADF);\n  ASSERT (lseek (fd, 0, SEEK_CUR) == 3);\n\n   \n  #if !defined __ANDROID__  \n  {\n    FILE *fp = fdopen (fd, \"w+\");\n    ASSERT (fp != NULL);\n    ASSERT (close (fd) == 0);\n    errno = 0;\n    ASSERT (fclose (fp) == EOF);\n    ASSERT (errno == EBADF);\n  }\n  #endif\n\n   \n  {\n    FILE *fp = fdopen (-1, \"r\");\n    if (fp != NULL)\n      {\n        errno = 0;\n        ASSERT (fclose (fp) == EOF);\n        ASSERT (errno == EBADF);\n      }\n  }\n  {\n    FILE *fp;\n    close (99);\n    fp = fdopen (99, \"r\");\n    if (fp != NULL)\n      {\n        errno = 0;\n        ASSERT (fclose (fp) == EOF);\n        ASSERT (errno == EBADF);\n      }\n  }\n\n   \n  ASSERT (remove (BASE) == 0);\n\n  return 0;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}