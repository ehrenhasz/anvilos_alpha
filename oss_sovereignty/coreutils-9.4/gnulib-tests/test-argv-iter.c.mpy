{
  "module_name": "test-argv-iter.c",
  "hash_id": "a8f5693fd05b9d8168dbc251326bb00aa56fbd6c23b8e92b1d46a67eb6049866",
  "original_prompt": "Ingested from coreutils-9.4/gnulib-tests/test-argv-iter.c",
  "human_readable_source": " \n\n#include <config.h>\n\n#include \"argv-iter.h\"\n\n#include <stdio.h>\n#include <string.h>\n\n#include \"macros.h\"\n\n#define ARRAY_CARDINALITY(Array) (sizeof (Array) / sizeof *(Array))\n#define STREQ(a, b) (strcmp (a, b) == 0)\n\nstatic FILE *\nwrite_nul_delimited_argv (char **argv)\n{\n  FILE *fp = tmpfile ();\n  ASSERT (fp);\n  while (*argv)\n    {\n      size_t len = strlen (*argv) + 1;\n      ASSERT (fwrite (*argv, len, 1, fp) == 1);\n      argv++;\n    }\n  ASSERT (fflush (fp) == 0);\n  rewind (fp);\n  return fp;\n}\n\nint\nmain (void)\n{\n  static char one[] = \"1\";\n  static char two[] = \"2\";\n  static char three[] = \"3\";\n  static char *av[][4] = {\n    {NULL},\n    {one, NULL},\n    {one, two, NULL},\n    {one, two, three, NULL}\n  };\n\n  int use_stream;\n  for (use_stream = 0; use_stream < 2; use_stream++)\n    {\n      size_t i;\n      for (i = 0; i < ARRAY_CARDINALITY (av); i++)\n        {\n          FILE *fp;\n          struct argv_iterator *ai;\n          size_t n_found = 0;\n          if (use_stream)\n            {\n               \n              ASSERT ((fp = write_nul_delimited_argv (av[i])) != NULL);\n              ai = argv_iter_init_stream (fp);\n            }\n          else\n            {\n              fp = NULL;\n              ai = argv_iter_init_argv (av[i]);\n            }\n          ASSERT (ai);\n\n          while (1)\n            {\n              enum argv_iter_err ai_err;\n              char *s = argv_iter (ai, &ai_err);\n              ASSERT ((i == n_found) == (ai_err == AI_ERR_EOF));\n              ASSERT ((s == NULL) ^ (ai_err == AI_ERR_OK));\n              ASSERT (ai_err == AI_ERR_OK || ai_err == AI_ERR_EOF);\n              if (ai_err == AI_ERR_OK)\n                ++n_found;\n              if (ai_err == AI_ERR_EOF)\n                break;\n               \n              ASSERT (use_stream\n                      ? STREQ (s, av[i][n_found - 1])\n                      : s == av[i][n_found - 1]);\n            }\n          ASSERT (argv_iter_n_args (ai) == i);\n          argv_iter_free (ai);\n          if (fp)\n            ASSERT (fclose (fp) == 0);\n        }\n    }\n\n  return 0;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}