{
  "module_name": "getrusage.c",
  "hash_id": "a101feb54b03737f9dce2a2207ffcfbce10bd8bb31f95928cbd8a6ec24262cc3",
  "original_prompt": "Ingested from coreutils-9.4/gnulib-tests/getrusage.c",
  "human_readable_source": " \n\n#include <config.h>\n\n \n#include <sys/resource.h>\n\n#include <errno.h>\n#include <string.h>\n\n \n#include <stdint.h>\n\n#if defined _WIN32 && ! defined __CYGWIN__\n\n# define WIN32_LEAN_AND_MEAN\n# include <windows.h>\n\n#else\n\n# include <sys/times.h>\n# include <unistd.h>\n#endif\n\nint\ngetrusage (int who, struct rusage *usage_p)\n{\n  if (who == RUSAGE_SELF || who == RUSAGE_CHILDREN)\n    {\n       \n      memset (usage_p, '\\0', sizeof (struct rusage));\n\n#if defined _WIN32 && ! defined __CYGWIN__\n      if (who == RUSAGE_SELF)\n        {\n           \n          FILETIME creation_time;\n          FILETIME exit_time;\n          FILETIME kernel_time;\n          FILETIME user_time;\n\n          if (GetProcessTimes (GetCurrentProcess (),\n                               &creation_time, &exit_time,\n                               &kernel_time, &user_time))\n            {\n               \n              uint64_t kernel_usec =\n                ((((uint64_t) kernel_time.dwHighDateTime << 32)\n                  | (uint64_t) kernel_time.dwLowDateTime)\n                 + 5) / 10;\n              uint64_t user_usec =\n                ((((uint64_t) user_time.dwHighDateTime << 32)\n                  | (uint64_t) user_time.dwLowDateTime)\n                 + 5) / 10;\n\n              usage_p->ru_utime.tv_sec = user_usec / 1000000U;\n              usage_p->ru_utime.tv_usec = user_usec % 1000000U;\n              usage_p->ru_stime.tv_sec = kernel_usec / 1000000U;\n              usage_p->ru_stime.tv_usec = kernel_usec % 1000000U;\n            }\n        }\n#else\n       \n      {\n        struct tms time;\n\n        if (times (&time) != (clock_t) -1)\n          {\n             \n            unsigned int clocks_per_second = sysconf (_SC_CLK_TCK);\n\n            if (clocks_per_second > 0)\n              {\n                clock_t user_ticks;\n                clock_t system_ticks;\n\n                uint64_t user_usec;\n                uint64_t system_usec;\n\n                if (who == RUSAGE_CHILDREN)\n                  {\n                    user_ticks   = time.tms_cutime;\n                    system_ticks = time.tms_cstime;\n                  }\n                else\n                  {\n                    user_ticks   = time.tms_utime;\n                    system_ticks = time.tms_stime;\n                  }\n\n                user_usec =\n                  (((uint64_t) user_ticks * (uint64_t) 1000000U)\n                   + clocks_per_second / 2) / clocks_per_second;\n                system_usec =\n                  (((uint64_t) system_ticks * (uint64_t) 1000000U)\n                   + clocks_per_second / 2) / clocks_per_second;\n\n                usage_p->ru_utime.tv_sec = user_usec / 1000000U;\n                usage_p->ru_utime.tv_usec = user_usec % 1000000U;\n                usage_p->ru_stime.tv_sec = system_usec / 1000000U;\n                usage_p->ru_stime.tv_usec = system_usec % 1000000U;\n              }\n          }\n      }\n#endif\n\n      return 0;\n    }\n  else\n    {\n      errno = EINVAL;\n      return -1;\n    }\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}