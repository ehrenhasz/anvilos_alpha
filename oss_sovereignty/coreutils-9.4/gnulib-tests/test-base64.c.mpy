{
  "module_name": "test-base64.c",
  "hash_id": "bcc58c14c7b84eb4f246908099d66b66f19ddbb1ce24cb9661ccebd0c6578ab5",
  "original_prompt": "Ingested from coreutils-9.4/gnulib-tests/test-base64.c",
  "human_readable_source": " \n\n  memset (out, 0x42, sizeof (out));\n  len = 0;\n  ok = base64_decode (b64in, 4, out, &len);\n  ASSERT (ok);\n  ASSERT (len == 0);\n\n  memset (out, 0x42, sizeof (out));\n  len = 1;\n  ok = base64_decode (b64in, 4, out, &len);\n  ASSERT (ok);\n  ASSERT (len == 1);\n  ASSERT (memcmp (out, \"abcdefg\", 1) == 0);\n\n  memset (out, 0x42, sizeof (out));\n  len = 2;\n  ok = base64_decode (b64in, 4, out, &len);\n  ASSERT (ok);\n  ASSERT (len == 2);\n  ASSERT (memcmp (out, \"abcdefg\", 2) == 0);\n\n  memset (out, 0x42, sizeof (out));\n  len = 3;\n  ok = base64_decode (b64in, 4, out, &len);\n  ASSERT (ok);\n  ASSERT (len == 3);\n  ASSERT (memcmp (out, \"abcdefg\", 3) == 0);\n\n  memset (out, 0x42, sizeof (out));\n  len = 4;\n  ok = base64_decode (b64in, 4, out, &len);\n  ASSERT (ok);\n  ASSERT (len == 3);\n  ASSERT (memcmp (out, \"abcdefg\", 3) == 0);\n\n  memset (out, 0x42, sizeof (out));\n  len = 100;\n  ok = base64_decode (b64in, strlen (b64in), out, &len);\n  ASSERT (ok);\n  ASSERT (len == 7);\n  ASSERT (memcmp (out, \"abcdefg\", 7) == 0);\n\n   \n\n  len = base64_encode_alloc (in, strlen (in), &p);\n  ASSERT (len == 24);\n  ASSERT (strcmp (p, \"YWJjZGVmZ2hpamtsbW5vcA==\") == 0);\n  free (p);\n\n  len = base64_encode_alloc (in, IDX_MAX - 5, &p);\n  ASSERT (len == 0);\n\n   \n  {\n    struct base64_decode_context ctx;\n\n    base64_decode_ctx_init (&ctx);\n\n    len = sizeof (out);\n    ok = base64_decode_ctx (&ctx, b64in, strlen (b64in), out, &len);\n    ASSERT (ok);\n    ASSERT (len == 7);\n    ASSERT (memcmp (out, \"abcdefg\", len) == 0);\n  }\n\n   \n\n  ok = base64_decode_alloc_ctx (NULL, b64in, strlen (b64in), &p, &len);\n  ASSERT (ok);\n  ASSERT (len == 7);\n  ASSERT (memcmp (out, \"abcdefg\", len) == 0);\n  free (p);\n\n  {\n    struct base64_decode_context ctx;\n    const char *newlineb64 = \"YWJjZG\\nVmZ2hp\\namtsbW5vcA==\";\n\n    base64_decode_ctx_init (&ctx);\n\n    ok = base64_decode_alloc_ctx (&ctx, newlineb64, strlen (newlineb64), &p, &len);\n    ASSERT (ok);\n    ASSERT (len == strlen (in));\n    ASSERT (memcmp (p, in, len) == 0);\n    free (p);\n  }\n\n  {\n    struct base64_decode_context ctx;\n    base64_decode_ctx_init (&ctx);\n\n    ok = base64_decode_alloc_ctx (&ctx, \"YW\\nJjZGVmZ2hp\", 13, &p, &len);\n    ASSERT (ok);\n    ASSERT (len == 9);\n    ASSERT (memcmp (p, \"abcdefghi\", len) == 0);\n    free (p);\n\n    base64_decode_ctx_init (&ctx);\n\n    ok = base64_decode_alloc_ctx (&ctx, \"YW\\n\", 3, &p, &len);\n    ASSERT (ok);\n    ASSERT (len == 0);\n    free (p);\n\n    ok = base64_decode_alloc_ctx (&ctx, \"JjZGVmZ2\", 8, &p, &len);\n    ASSERT (ok);\n    ASSERT (len == 6);\n    ASSERT (memcmp (p, \"abcdef\", len) == 0);\n    free (p);\n\n    ok = base64_decode_alloc_ctx (&ctx, \"hp\", 2, &p, &len);\n    ASSERT (ok);\n    ASSERT (len == 3);\n    ASSERT (memcmp (p, \"ghi\", len) == 0);\n    free (p);\n\n    ok = base64_decode_alloc_ctx (&ctx, \"\", 0, &p, &len);\n    ASSERT (ok);\n    free (p);\n  }\n\n  {\n    struct base64_decode_context ctx;\n    const char *newlineb64 = \"\\n\\n\\n\\n\\n\";\n\n    base64_decode_ctx_init (&ctx);\n\n    ok = base64_decode_alloc_ctx (&ctx, newlineb64, strlen (newlineb64), &p, &len);\n    ASSERT (ok);\n    ASSERT (len == 0);\n    free (p);\n  }\n\n  ok = base64_decode_alloc_ctx (NULL, \" ! \", 3, &p, &len);\n  ASSERT (!ok);\n\n  ok = base64_decode_alloc_ctx (NULL, \"abc\\ndef\", 7, &p, &len);\n  ASSERT (!ok);\n\n  ok = base64_decode_alloc_ctx (NULL, \"aa\", 2, &p, &len);\n  ASSERT (!ok);\n\n  ok = base64_decode_alloc_ctx (NULL, \"aa=\", 3, &p, &len);\n  ASSERT (!ok);\n\n  ok = base64_decode_alloc_ctx (NULL, \"aax\", 3, &p, &len);\n  ASSERT (!ok);\n\n  ok = base64_decode_alloc_ctx (NULL, \"aa=X\", 4, &p, &len);\n  ASSERT (!ok);\n\n  ok = base64_decode_alloc_ctx (NULL, \"aa=X\", 4, &p, &len);\n  ASSERT (!ok);\n\n  ok = base64_decode_alloc_ctx (NULL, \"aax=X\", 5, &p, &len);\n  ASSERT (!ok);\n\n  return 0;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}