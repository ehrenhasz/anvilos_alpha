{
  "module_name": "machine_uart.c",
  "hash_id": "32ccd8bd01f8d1ba91d0fe34ebc33e1d0cc6ceadc5b30d8bed9dc83e27e6a389",
  "original_prompt": "Ingested from sys_09_Anvil/source/extmod/machine_uart.c",
  "human_readable_source": " \n\n#include \"py/runtime.h\"\n#include \"py/stream.h\"\n\n#if MICROPY_PY_MACHINE_UART\n\n#include \"extmod/modmachine.h\"\n#include \"shared/runtime/mpirq.h\"\n\n\n\nstatic void mp_machine_uart_print(const mp_print_t *print, mp_obj_t self_in, mp_print_kind_t kind);\nstatic void mp_machine_uart_init_helper(machine_uart_obj_t *self, size_t n_args, const mp_obj_t *pos_args, mp_map_t *kw_args);\nstatic mp_obj_t mp_machine_uart_make_new(const mp_obj_type_t *type, size_t n_args, size_t n_kw, const mp_obj_t *args);\nstatic void mp_machine_uart_deinit(machine_uart_obj_t *self);\nstatic mp_int_t mp_machine_uart_any(machine_uart_obj_t *self);\nstatic bool mp_machine_uart_txdone(machine_uart_obj_t *self);\n\n#if MICROPY_PY_MACHINE_UART_SENDBREAK\nstatic void mp_machine_uart_sendbreak(machine_uart_obj_t *self);\n#endif\n\n#if MICROPY_PY_MACHINE_UART_READCHAR_WRITECHAR\nstatic mp_int_t mp_machine_uart_readchar(machine_uart_obj_t *self);\nstatic void mp_machine_uart_writechar(machine_uart_obj_t *self, uint16_t data);\n#endif\n\n#if MICROPY_PY_MACHINE_UART_IRQ\nstatic mp_irq_obj_t *mp_machine_uart_irq(machine_uart_obj_t *self, bool any_args, mp_arg_val_t *args);\n#endif\n\nstatic mp_uint_t mp_machine_uart_read(mp_obj_t self_in, void *buf_in, mp_uint_t size, int *errcode);\nstatic mp_uint_t mp_machine_uart_write(mp_obj_t self_in, const void *buf_in, mp_uint_t size, int *errcode);\nstatic mp_uint_t mp_machine_uart_ioctl(mp_obj_t self_in, mp_uint_t request, uintptr_t arg, int *errcode);\n\n\n#include MICROPY_PY_MACHINE_UART_INCLUDEFILE\n\n\nstatic mp_obj_t machine_uart_init(size_t n_args, const mp_obj_t *args, mp_map_t *kw_args) {\n    mp_machine_uart_init_helper(MP_OBJ_TO_PTR(args[0]), n_args - 1, args + 1, kw_args);\n    return mp_const_none;\n}\nMP_DEFINE_CONST_FUN_OBJ_KW(machine_uart_init_obj, 1, machine_uart_init);\n\n\nstatic mp_obj_t machine_uart_deinit(mp_obj_t self_in) {\n    machine_uart_obj_t *self = MP_OBJ_TO_PTR(self_in);\n    mp_machine_uart_deinit(self);\n    return mp_const_none;\n}\nstatic MP_DEFINE_CONST_FUN_OBJ_1(machine_uart_deinit_obj, machine_uart_deinit);\n\n\nstatic mp_obj_t machine_uart_any(mp_obj_t self_in) {\n    machine_uart_obj_t *self = MP_OBJ_TO_PTR(self_in);\n    return MP_OBJ_NEW_SMALL_INT(mp_machine_uart_any(self));\n}\nstatic MP_DEFINE_CONST_FUN_OBJ_1(machine_uart_any_obj, machine_uart_any);\n\n\nstatic mp_obj_t machine_uart_txdone(mp_obj_t self_in) {\n    machine_uart_obj_t *self = MP_OBJ_TO_PTR(self_in);\n    return mp_obj_new_bool(mp_machine_uart_txdone(self));\n}\nstatic MP_DEFINE_CONST_FUN_OBJ_1(machine_uart_txdone_obj, machine_uart_txdone);\n\n#if MICROPY_PY_MACHINE_UART_SENDBREAK\n\n\nstatic mp_obj_t machine_uart_sendbreak(mp_obj_t self_in) {\n    machine_uart_obj_t *self = MP_OBJ_TO_PTR(self_in);\n    mp_machine_uart_sendbreak(self);\n    return mp_const_none;\n}\nstatic MP_DEFINE_CONST_FUN_OBJ_1(machine_uart_sendbreak_obj, machine_uart_sendbreak);\n\n#endif\n\n#if MICROPY_PY_MACHINE_UART_READCHAR_WRITECHAR\n\n\nstatic mp_obj_t machine_uart_readchar(mp_obj_t self_in) {\n    machine_uart_obj_t *self = MP_OBJ_TO_PTR(self_in);\n    return MP_OBJ_NEW_SMALL_INT(mp_machine_uart_readchar(self));\n}\nstatic MP_DEFINE_CONST_FUN_OBJ_1(machine_uart_readchar_obj, machine_uart_readchar);\n\n\nstatic mp_obj_t machine_uart_writechar(mp_obj_t self_in, mp_obj_t char_in) {\n    machine_uart_obj_t *self = MP_OBJ_TO_PTR(self_in);\n    mp_machine_uart_writechar(self, mp_obj_get_int(char_in));\n    return mp_const_none;\n}\nstatic MP_DEFINE_CONST_FUN_OBJ_2(machine_uart_writechar_obj, machine_uart_writechar);\n\n#endif\n\n#if MICROPY_PY_MACHINE_UART_IRQ\n\n\nstatic mp_obj_t machine_uart_irq(size_t n_args, const mp_obj_t *pos_args, mp_map_t *kw_args) {\n    mp_arg_val_t args[MP_IRQ_ARG_INIT_NUM_ARGS];\n    mp_arg_parse_all(n_args - 1, pos_args + 1, kw_args, MP_IRQ_ARG_INIT_NUM_ARGS, mp_irq_init_args, args);\n    machine_uart_obj_t *self = MP_OBJ_TO_PTR(pos_args[0]);\n    bool any_args = n_args > 1 || kw_args->used != 0;\n    return MP_OBJ_FROM_PTR(mp_machine_uart_irq(self, any_args, args));\n}\nstatic MP_DEFINE_CONST_FUN_OBJ_KW(machine_uart_irq_obj, 1, machine_uart_irq);\n\n#endif\n\nstatic const mp_rom_map_elem_t machine_uart_locals_dict_table[] = {\n    { MP_ROM_QSTR(MP_QSTR_init), MP_ROM_PTR(&machine_uart_init_obj) },\n    { MP_ROM_QSTR(MP_QSTR_deinit), MP_ROM_PTR(&machine_uart_deinit_obj) },\n\n    { MP_ROM_QSTR(MP_QSTR_flush), MP_ROM_PTR(&mp_stream_flush_obj) },\n    { MP_ROM_QSTR(MP_QSTR_read), MP_ROM_PTR(&mp_stream_read_obj) },\n    { MP_ROM_QSTR(MP_QSTR_readline), MP_ROM_PTR(&mp_stream_unbuffered_readline_obj) },\n    { MP_ROM_QSTR(MP_QSTR_readinto), MP_ROM_PTR(&mp_stream_readinto_obj) },\n    { MP_ROM_QSTR(MP_QSTR_write), MP_ROM_PTR(&mp_stream_write_obj) },\n\n    { MP_ROM_QSTR(MP_QSTR_any), MP_ROM_PTR(&machine_uart_any_obj) },\n    { MP_ROM_QSTR(MP_QSTR_txdone), MP_ROM_PTR(&machine_uart_txdone_obj) },\n\n    #if MICROPY_PY_MACHINE_UART_SENDBREAK\n    { MP_ROM_QSTR(MP_QSTR_sendbreak), MP_ROM_PTR(&machine_uart_sendbreak_obj) },\n    #endif\n\n    #if MICROPY_PY_MACHINE_UART_READCHAR_WRITECHAR\n    { MP_ROM_QSTR(MP_QSTR_readchar), MP_ROM_PTR(&machine_uart_readchar_obj) },\n    { MP_ROM_QSTR(MP_QSTR_writechar), MP_ROM_PTR(&machine_uart_writechar_obj) },\n    #endif\n\n    #if MICROPY_PY_MACHINE_UART_IRQ\n    { MP_ROM_QSTR(MP_QSTR_irq), MP_ROM_PTR(&machine_uart_irq_obj) },\n    #endif\n\n    \n    \n    MICROPY_PY_MACHINE_UART_CLASS_CONSTANTS\n};\nstatic MP_DEFINE_CONST_DICT(machine_uart_locals_dict, machine_uart_locals_dict_table);\n\nstatic const mp_stream_p_t uart_stream_p = {\n    .read = mp_machine_uart_read,\n    .write = mp_machine_uart_write,\n    .ioctl = mp_machine_uart_ioctl,\n    .is_text = false,\n};\n\nMP_DEFINE_CONST_OBJ_TYPE(\n    machine_uart_type,\n    MP_QSTR_UART,\n    MP_TYPE_FLAG_ITER_IS_STREAM,\n    make_new, mp_machine_uart_make_new,\n    print, mp_machine_uart_print,\n    protocol, &uart_stream_p,\n    locals_dict, &machine_uart_locals_dict\n    );\n\n#endif \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}