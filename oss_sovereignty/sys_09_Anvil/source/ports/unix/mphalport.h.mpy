{
  "module_name": "mphalport.h",
  "hash_id": "b325b318de9a5023fdd4d6062cdd3f03e224455fb072d2b46fa2865b78e15c6c",
  "original_prompt": "Ingested from sys_09_Anvil/source/ports/unix/mphalport.h",
  "human_readable_source": " \n#include <errno.h>\n#include <unistd.h>\n\n#ifndef CHAR_CTRL_C\n#define CHAR_CTRL_C (3)\n#endif\n\n\n#if MICROPY_PY_THREAD\n#define MICROPY_BEGIN_ATOMIC_SECTION() (mp_thread_unix_begin_atomic_section(), 0xffffffff)\n#define MICROPY_END_ATOMIC_SECTION(x) (void)x; mp_thread_unix_end_atomic_section()\n#endif\n\n\n\n\n\n#define MICROPY_INTERNAL_WFE(TIMEOUT_MS) mp_hal_delay_us(500)\n\nvoid mp_hal_set_interrupt_char(char c);\n\n#define mp_hal_stdio_poll unused \nvoid mp_hal_stdio_mode_raw(void);\nvoid mp_hal_stdio_mode_orig(void);\n\n#if MICROPY_PY_BUILTINS_INPUT && MICROPY_USE_READLINE == 0\n\n#include <malloc.h>\n#include \"py/misc.h\"\n#include \"input.h\"\n#define mp_hal_readline mp_hal_readline\nstatic inline int mp_hal_readline(vstr_t *vstr, const char *p) {\n    char *line = prompt((char *)p);\n    vstr_add_str(vstr, line);\n    free(line);\n    return 0;\n}\n\n#elif MICROPY_PY_BUILTINS_INPUT && MICROPY_USE_READLINE == 1\n\n#include \"py/misc.h\"\n#include \"shared/readline/readline.h\"\n\n#define mp_hal_readline mp_hal_readline\nstatic inline int mp_hal_readline(vstr_t *vstr, const char *p) {\n    mp_hal_stdio_mode_raw();\n    int ret = readline(vstr, p);\n    mp_hal_stdio_mode_orig();\n    return ret;\n}\n\n#endif\n\nstatic inline void mp_hal_delay_us(mp_uint_t us) {\n    usleep(us);\n}\n#define mp_hal_ticks_cpu() 0\n\n\n#define MP_HAL_RETRY_SYSCALL(ret, syscall, raise) { \\\n        for (;;) { \\\n            MP_THREAD_GIL_EXIT(); \\\n            ret = syscall; \\\n            MP_THREAD_GIL_ENTER(); \\\n            if (ret == -1) { \\\n                int err = errno; \\\n                if (err == EINTR) { \\\n                    mp_handle_pending(true); \\\n                    continue; \\\n                } \\\n                raise; \\\n            } \\\n            break; \\\n        } \\\n}\n\n#define RAISE_ERRNO(err_flag, error_val) \\\n    { if (err_flag == -1) \\\n      { mp_raise_OSError(error_val); } }\n\nvoid mp_hal_get_random(size_t n, void *buf);\n\n#if MICROPY_PY_BLUETOOTH\nenum {\n    MP_HAL_MAC_BDADDR,\n};\n\nvoid mp_hal_get_mac(int idx, uint8_t buf[6]);\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}