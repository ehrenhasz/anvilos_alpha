{
  "module_name": "gchelper_generic.c",
  "hash_id": "f46dc7e0c31dc72d2f7a61dfaed11f90323363533c227d3d9b5ed61820f149a3",
  "original_prompt": "Ingested from sys_09_Anvil/source/shared/runtime/gchelper_generic.c",
  "human_readable_source": " \n\n#include <stdio.h>\n\n#include \"py/mpstate.h\"\n#include \"py/gc.h\"\n#include \"shared/runtime/gchelper.h\"\n\n#if MICROPY_ENABLE_GC\n\n\n\n#if !MICROPY_GCREGS_SETJMP\n\n\n\n\n\n#if defined(__x86_64__)\n\nstatic void gc_helper_get_regs(gc_helper_regs_t arr) {\n    register long rbx asm (\"rbx\");\n    register long rbp asm (\"rbp\");\n    register long r12 asm (\"r12\");\n    register long r13 asm (\"r13\");\n    register long r14 asm (\"r14\");\n    register long r15 asm (\"r15\");\n    #ifdef __clang__\n    \n    \n    \n    \n    \n    \n    asm (\"\" : \"=r\" (rbx));\n    asm (\"\" : \"=r\" (rbp));\n    asm (\"\" : \"=r\" (r12));\n    asm (\"\" : \"=r\" (r13));\n    asm (\"\" : \"=r\" (r14));\n    asm (\"\" : \"=r\" (r15));\n    #endif\n    arr[0] = rbx;\n    arr[1] = rbp;\n    arr[2] = r12;\n    arr[3] = r13;\n    arr[4] = r14;\n    arr[5] = r15;\n}\n\n#elif defined(__i386__)\n\nstatic void gc_helper_get_regs(gc_helper_regs_t arr) {\n    register long ebx asm (\"ebx\");\n    register long esi asm (\"esi\");\n    register long edi asm (\"edi\");\n    register long ebp asm (\"ebp\");\n    #ifdef __clang__\n    \n    \n    \n    \n    \n    \n    asm (\"\" : \"=r\" (ebx));\n    asm (\"\" : \"=r\" (esi));\n    asm (\"\" : \"=r\" (edi));\n    asm (\"\" : \"=r\" (ebp));\n    #endif\n    arr[0] = ebx;\n    arr[1] = esi;\n    arr[2] = edi;\n    arr[3] = ebp;\n}\n\n#elif defined(__thumb2__) || defined(__thumb__) || defined(__arm__)\n\n\n\nstatic void gc_helper_get_regs(gc_helper_regs_t arr) {\n    register long r4 asm (\"r4\");\n    register long r5 asm (\"r5\");\n    register long r6 asm (\"r6\");\n    register long r7 asm (\"r7\");\n    register long r8 asm (\"r8\");\n    register long r9 asm (\"r9\");\n    register long r10 asm (\"r10\");\n    register long r11 asm (\"r11\");\n    register long r12 asm (\"r12\");\n    register long r13 asm (\"r13\");\n    arr[0] = r4;\n    arr[1] = r5;\n    arr[2] = r6;\n    arr[3] = r7;\n    arr[4] = r8;\n    arr[5] = r9;\n    arr[6] = r10;\n    arr[7] = r11;\n    arr[8] = r12;\n    arr[9] = r13;\n}\n\n#elif defined(__aarch64__)\n\nstatic void gc_helper_get_regs(gc_helper_regs_t arr) {\n    const register long x19 asm (\"x19\");\n    const register long x20 asm (\"x20\");\n    const register long x21 asm (\"x21\");\n    const register long x22 asm (\"x22\");\n    const register long x23 asm (\"x23\");\n    const register long x24 asm (\"x24\");\n    const register long x25 asm (\"x25\");\n    const register long x26 asm (\"x26\");\n    const register long x27 asm (\"x27\");\n    const register long x28 asm (\"x28\");\n    const register long x29 asm (\"x29\");\n    arr[0] = x19;\n    arr[1] = x20;\n    arr[2] = x21;\n    arr[3] = x22;\n    arr[4] = x23;\n    arr[5] = x24;\n    arr[6] = x25;\n    arr[7] = x26;\n    arr[8] = x27;\n    arr[9] = x28;\n    arr[10] = x29;\n}\n\n#else\n\n#error \"Architecture not supported for gc_helper_get_regs. Set MICROPY_GCREGS_SETJMP to use the fallback implementation.\"\n\n#endif\n\n#else \n\n\n\n\nstatic void gc_helper_get_regs(gc_helper_regs_t arr) {\n    setjmp(arr);\n}\n\n#endif \n\n\n\n\n\n\nMP_NOINLINE void gc_helper_collect_regs_and_stack(void) {\n    gc_helper_regs_t regs;\n    gc_helper_get_regs(regs);\n    \n    void **regs_ptr = (void **)(void *)&regs;\n    gc_collect_root(regs_ptr, ((uintptr_t)MP_STATE_THREAD(stack_top) - (uintptr_t)&regs) / sizeof(uintptr_t));\n}\n\n#endif \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}