{
  "module_name": "usermod.cmake",
  "hash_id": "07db80910832f9946ce4015f52a63731ffda0dd0ccf9519ae92509acf32f706e",
  "original_prompt": "Ingested from sys_09_Anvil/source/py/usermod.cmake",
  "human_readable_source": "# Create a target for all user modules to link against.\nadd_library(usermod INTERFACE)\n\nfunction(usermod_gather_sources SOURCES_VARNAME INCLUDE_DIRECTORIES_VARNAME INCLUDED_VARNAME LIB)\n    if (NOT ${LIB} IN_LIST ${INCLUDED_VARNAME})\n        list(APPEND ${INCLUDED_VARNAME} ${LIB})\n\n        # Gather library sources\n        get_target_property(lib_sources ${LIB} INTERFACE_SOURCES)\n        if (lib_sources)\n            list(APPEND ${SOURCES_VARNAME} ${lib_sources})\n        endif()\n\n        # Gather library includes\n        get_target_property(lib_include_directories ${LIB} INTERFACE_INCLUDE_DIRECTORIES)\n        if (lib_include_directories)\n            list(APPEND ${INCLUDE_DIRECTORIES_VARNAME} ${lib_include_directories})\n        endif()\n\n        # Recurse linked libraries\n        get_target_property(trans_depend ${LIB} INTERFACE_LINK_LIBRARIES)\n        if (trans_depend)\n            foreach(SUB_LIB ${trans_depend})\n                usermod_gather_sources(\n                    ${SOURCES_VARNAME}\n                    ${INCLUDE_DIRECTORIES_VARNAME}\n                    ${INCLUDED_VARNAME}\n                    ${SUB_LIB})\n            endforeach()\n        endif()\n\n        set(${SOURCES_VARNAME} ${${SOURCES_VARNAME}} PARENT_SCOPE)\n        set(${INCLUDE_DIRECTORIES_VARNAME} ${${INCLUDE_DIRECTORIES_VARNAME}} PARENT_SCOPE)\n        set(${INCLUDED_VARNAME} ${${INCLUDED_VARNAME}} PARENT_SCOPE)\n    endif()\nendfunction()\n\n# Include CMake files for user modules.\nif (USER_C_MODULES)\n    foreach(USER_C_MODULE_PATH ${USER_C_MODULES})\n        message(\"Including User C Module(s) from ${USER_C_MODULE_PATH}\")\n        include(${USER_C_MODULE_PATH})\n    endforeach()\nendif()\n\n# Recursively gather sources for QSTR scanning - doesn't support generator expressions.\nusermod_gather_sources(MICROPY_SOURCE_USERMOD MICROPY_INC_USERMOD found_modules usermod)\n\n# Report found modules.\nlist(REMOVE_ITEM found_modules \"usermod\")\nlist(JOIN found_modules \", \" found_modules)\nmessage(\"Found User C Module(s): ${found_modules}\")\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}