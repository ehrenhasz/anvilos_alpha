{
  "module_name": "make_root_pointers.py",
  "hash_id": "297c295df46063992363ba8f28553d7d3537e8e44388720b8ec80b026333f163",
  "original_prompt": "Ingested from sys_09_Anvil/source/py/make_root_pointers.py",
  "human_readable_source": "\"\"\"\nThis pre-processor parses a single file containing a list of\nMP_REGISTER_ROOT_POINTER(variable declaration) items.\n\nThese are used to generate a header with the required entries for\n\"struct _mp_state_vm_t\" in py/mpstate.h\n\"\"\"\n\nfrom __future__ import print_function\n\nimport argparse\nimport io\nimport re\n\n\nPATTERN = re.compile(r\"MP_REGISTER_ROOT_POINTER\\((.*?)\\);\")\n\n\ndef find_root_pointer_registrations(filename):\n    \"\"\"Find any MP_REGISTER_ROOT_POINTER definitions in the provided file.\n\n    :param str filename: path to file to check\n    :return: List[variable_declaration]\n    \"\"\"\n    with io.open(filename, encoding=\"utf-8\") as c_file_obj:\n        return set(re.findall(PATTERN, c_file_obj.read()))\n\n\ndef generate_root_pointer_header(root_pointers):\n    \"\"\"Generate header with root pointer entries.\n\n    :param List[variable_declaration] root_pointers: root pointer declarations\n    :return: None\n    \"\"\"\n\n    # Print header file for all external modules.\n    print(\"// Automatically generated by make_root_pointers.py.\")\n    print()\n\n    for item in root_pointers:\n        print(item, end=\";\")\n        print()\n\n\ndef main():\n    parser = argparse.ArgumentParser()\n    parser.add_argument(\"file\", nargs=1, help=\"file with MP_REGISTER_ROOT_POINTER definitions\")\n    args = parser.parse_args()\n\n    root_pointers = find_root_pointer_registrations(args.file[0])\n    generate_root_pointer_header(sorted(root_pointers))\n\n\nif __name__ == \"__main__\":\n    main()\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}