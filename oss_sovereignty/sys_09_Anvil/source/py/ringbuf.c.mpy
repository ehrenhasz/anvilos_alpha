{
  "module_name": "ringbuf.c",
  "hash_id": "1cc149788bf6f4d8994e261a78c849ad0143008135173a457f42607410babcc1",
  "original_prompt": "Ingested from sys_09_Anvil/source/py/ringbuf.c",
  "human_readable_source": " \n\n#include <string.h>\n\n#include \"ringbuf.h\"\n\nint ringbuf_get16(ringbuf_t *r) {\n    int v = ringbuf_peek16(r);\n    if (v == -1) {\n        return v;\n    }\n    r->iget += 2;\n    if (r->iget >= r->size) {\n        r->iget -= r->size;\n    }\n    return v;\n}\n\nint ringbuf_peek16(ringbuf_t *r) {\n    if (r->iget == r->iput) {\n        return -1;\n    }\n    uint32_t iget_a = r->iget + 1;\n    if (iget_a == r->size) {\n        iget_a = 0;\n    }\n    if (iget_a == r->iput) {\n        return -1;\n    }\n    return (r->buf[r->iget] << 8) | (r->buf[iget_a]);\n}\n\nint ringbuf_put16(ringbuf_t *r, uint16_t v) {\n    uint32_t iput_a = r->iput + 1;\n    if (iput_a == r->size) {\n        iput_a = 0;\n    }\n    if (iput_a == r->iget) {\n        return -1;\n    }\n    uint32_t iput_b = iput_a + 1;\n    if (iput_b == r->size) {\n        iput_b = 0;\n    }\n    if (iput_b == r->iget) {\n        return -1;\n    }\n    r->buf[r->iput] = (v >> 8) & 0xff;\n    r->buf[iput_a] = v & 0xff;\n    r->iput = iput_b;\n    return 0;\n}\n\n\n\n\n\nint ringbuf_get_bytes(ringbuf_t *r, uint8_t *data, size_t data_len) {\n    if (ringbuf_avail(r) < data_len) {\n        return (r->size <= data_len) ? -2 : -1;\n    }\n    uint32_t iget = r->iget;\n    uint32_t iget_a = (iget + data_len) % r->size;\n    uint8_t *datap = data;\n    if (iget_a < iget) {\n        \n        memcpy(datap, r->buf + iget, r->size - iget);\n        datap += (r->size - iget);\n        iget = 0;\n    }\n    memcpy(datap, r->buf + iget, iget_a - iget);\n    r->iget = iget_a;\n    return 0;\n}\n\n\n\n\n\nint ringbuf_put_bytes(ringbuf_t *r, const uint8_t *data, size_t data_len) {\n    if (ringbuf_free(r) < data_len) {\n        return (r->size <= data_len) ? -2 : -1;\n    }\n    uint32_t iput = r->iput;\n    uint32_t iput_a = (iput + data_len) % r->size;\n    const uint8_t *datap = data;\n    if (iput_a < iput) {\n        \n        memcpy(r->buf + iput, datap, r->size - iput);\n        datap += (r->size - iput);\n        iput = 0;\n    }\n    memcpy(r->buf + iput, datap, iput_a - iput);\n    r->iput = iput_a;\n    return 0;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}