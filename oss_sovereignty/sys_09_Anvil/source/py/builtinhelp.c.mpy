{
  "module_name": "builtinhelp.c",
  "hash_id": "eb3801c84d841df1e53d922896bae414f4c54b794c49c3e0ad45c01e924ab40f",
  "original_prompt": "Ingested from sys_09_Anvil/source/py/builtinhelp.c",
  "human_readable_source": " \n\n#include <stdio.h>\n#include <string.h>\n\n#include \"py/builtin.h\"\n#include \"py/objmodule.h\"\n\n#if MICROPY_PY_BUILTINS_HELP\n\nconst char mp_help_default_text[] =\n    \"Welcome to MicroPython!\\n\"\n    \"\\n\"\n    \"For online docs please visit http://docs.micropython.org/\\n\"\n    \"\\n\"\n    \"Control commands:\\n\"\n    \"  CTRL-A        -- on a blank line, enter raw REPL mode\\n\"\n    \"  CTRL-B        -- on a blank line, enter normal REPL mode\\n\"\n    \"  CTRL-C        -- interrupt a running program\\n\"\n    \"  CTRL-D        -- on a blank line, exit or do a soft reset\\n\"\n    \"  CTRL-E        -- on a blank line, enter paste mode\\n\"\n    \"\\n\"\n    \"For further help on a specific object, type help(obj)\\n\"\n;\n\nstatic void mp_help_print_info_about_object(mp_obj_t name_o, mp_obj_t value) {\n    mp_print_str(MP_PYTHON_PRINTER, \"  \");\n    mp_obj_print(name_o, PRINT_STR);\n    mp_print_str(MP_PYTHON_PRINTER, \" -- \");\n    mp_obj_print(value, PRINT_STR);\n    mp_print_str(MP_PYTHON_PRINTER, \"\\n\");\n}\n\n#if MICROPY_PY_BUILTINS_HELP_MODULES\nstatic void mp_help_add_from_map(mp_obj_t list, const mp_map_t *map) {\n    for (size_t i = 0; i < map->alloc; i++) {\n        if (mp_map_slot_is_filled(map, i)) {\n            mp_obj_list_append(list, map->table[i].key);\n        }\n    }\n}\n\n#if MICROPY_MODULE_FROZEN\nstatic void mp_help_add_from_names(mp_obj_t list, const char *name) {\n    while (*name) {\n        size_t len = strlen(name);\n        \n        mp_obj_list_append(list, mp_obj_new_str(name, len - 3));\n        name += len + 1;\n    }\n}\n#endif\n\nstatic void mp_help_print_modules(void) {\n    mp_obj_t list = mp_obj_new_list(0, NULL);\n\n    mp_help_add_from_map(list, &mp_builtin_module_map);\n    mp_help_add_from_map(list, &mp_builtin_extensible_module_map);\n\n    #if MICROPY_MODULE_FROZEN\n    extern const char mp_frozen_names[];\n    mp_help_add_from_names(list, mp_frozen_names);\n    #endif\n\n    \n    mp_obj_list_sort(1, &list, (mp_map_t *)&mp_const_empty_map);\n\n    \n    #define NUM_COLUMNS (4)\n    #define COLUMN_WIDTH (18)\n    size_t len;\n    mp_obj_t *items;\n    mp_obj_list_get(list, &len, &items);\n    unsigned int num_rows = (len + NUM_COLUMNS - 1) / NUM_COLUMNS;\n    for (unsigned int i = 0; i < num_rows; ++i) {\n        unsigned int j = i;\n        for (;;) {\n            int l = mp_print_str(MP_PYTHON_PRINTER, mp_obj_str_get_str(items[j]));\n            j += num_rows;\n            if (j >= len) {\n                break;\n            }\n            int gap = COLUMN_WIDTH - l;\n            while (gap < 1) {\n                gap += COLUMN_WIDTH;\n            }\n            while (gap--) {\n                mp_print_str(MP_PYTHON_PRINTER, \" \");\n            }\n        }\n        mp_print_str(MP_PYTHON_PRINTER, \"\\n\");\n    }\n\n    #if MICROPY_ENABLE_EXTERNAL_IMPORT\n    \n    mp_print_str(MP_PYTHON_PRINTER, \"Plus any modules on the filesystem\\n\");\n    #endif\n}\n#endif\n\nstatic void mp_help_print_obj(const mp_obj_t obj) {\n    #if MICROPY_PY_BUILTINS_HELP_MODULES\n    if (obj == MP_OBJ_NEW_QSTR(MP_QSTR_modules)) {\n        mp_help_print_modules();\n        return;\n    }\n    #endif\n\n    const mp_obj_type_t *type = mp_obj_get_type(obj);\n\n    \n    mp_print_str(MP_PYTHON_PRINTER, \"object \");\n    mp_obj_print(obj, PRINT_STR);\n    mp_printf(MP_PYTHON_PRINTER, \" is of type %q\\n\", type->name);\n\n    mp_map_t *map = NULL;\n    if (type == &mp_type_module) {\n        map = &mp_obj_module_get_globals(obj)->map;\n    } else {\n        if (type == &mp_type_type) {\n            type = MP_OBJ_TO_PTR(obj);\n        }\n        if (MP_OBJ_TYPE_HAS_SLOT(type, locals_dict)) {\n            map = &MP_OBJ_TYPE_GET_SLOT(type, locals_dict)->map;\n        }\n    }\n    if (map != NULL) {\n        for (uint i = 0; i < map->alloc; i++) {\n            mp_obj_t key = map->table[i].key;\n            if (key != MP_OBJ_NULL) {\n                mp_help_print_info_about_object(key, map->table[i].value);\n            }\n        }\n    }\n}\n\nstatic mp_obj_t mp_builtin_help(size_t n_args, const mp_obj_t *args) {\n    if (n_args == 0) {\n        \n        mp_print_str(MP_PYTHON_PRINTER, MICROPY_PY_BUILTINS_HELP_TEXT);\n    } else {\n        \n        mp_help_print_obj(args[0]);\n    }\n\n    return mp_const_none;\n}\nMP_DEFINE_CONST_FUN_OBJ_VAR_BETWEEN(mp_builtin_help_obj, 0, 1, mp_builtin_help);\n\n#endif \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}