{
  "module_name": "lfs2.h",
  "hash_id": "c99588876e4db0fea0547709dfacb96201e009f5027f7de39c205042134cfffe",
  "original_prompt": "Ingested from sys_09_Anvil/source/lib/littlefs/lfs2.h",
  "human_readable_source": " \n#ifndef LFS2_H\n#define LFS2_H\n\n#include \"lfs2_util.h\"\n\n#ifdef __cplusplus\nextern \"C\"\n{\n#endif\n\n\n\n\n\n\n\n#define LFS2_VERSION 0x00020008\n#define LFS2_VERSION_MAJOR (0xffff & (LFS2_VERSION >> 16))\n#define LFS2_VERSION_MINOR (0xffff & (LFS2_VERSION >>  0))\n\n\n\n\n#define LFS2_DISK_VERSION 0x00020001\n#define LFS2_DISK_VERSION_MAJOR (0xffff & (LFS2_DISK_VERSION >> 16))\n#define LFS2_DISK_VERSION_MINOR (0xffff & (LFS2_DISK_VERSION >>  0))\n\n\n\n\n\ntypedef uint32_t lfs2_size_t;\ntypedef uint32_t lfs2_off_t;\n\ntypedef int32_t  lfs2_ssize_t;\ntypedef int32_t  lfs2_soff_t;\n\ntypedef uint32_t lfs2_block_t;\n\n\n\n\n#ifndef LFS2_NAME_MAX\n#define LFS2_NAME_MAX 255\n#endif\n\n\n\n\n\n\n#ifndef LFS2_FILE_MAX\n#define LFS2_FILE_MAX 2147483647\n#endif\n\n\n\n#ifndef LFS2_ATTR_MAX\n#define LFS2_ATTR_MAX 1022\n#endif\n\n\n\nenum lfs2_error {\n    LFS2_ERR_OK          = 0,    \n    LFS2_ERR_IO          = -5,   \n    LFS2_ERR_CORRUPT     = -84,  \n    LFS2_ERR_NOENT       = -2,   \n    LFS2_ERR_EXIST       = -17,  \n    LFS2_ERR_NOTDIR      = -20,  \n    LFS2_ERR_ISDIR       = -21,  \n    LFS2_ERR_NOTEMPTY    = -39,  \n    LFS2_ERR_BADF        = -9,   \n    LFS2_ERR_FBIG        = -27,  \n    LFS2_ERR_INVAL       = -22,  \n    LFS2_ERR_NOSPC       = -28,  \n    LFS2_ERR_NOMEM       = -12,  \n    LFS2_ERR_NOATTR      = -61,  \n    LFS2_ERR_NAMETOOLONG = -36,  \n};\n\n\nenum lfs2_type {\n    \n    LFS2_TYPE_REG            = 0x001,\n    LFS2_TYPE_DIR            = 0x002,\n\n    \n    LFS2_TYPE_SPLICE         = 0x400,\n    LFS2_TYPE_NAME           = 0x000,\n    LFS2_TYPE_STRUCT         = 0x200,\n    LFS2_TYPE_USERATTR       = 0x300,\n    LFS2_TYPE_FROM           = 0x100,\n    LFS2_TYPE_TAIL           = 0x600,\n    LFS2_TYPE_GLOBALS        = 0x700,\n    LFS2_TYPE_CRC            = 0x500,\n\n    \n    LFS2_TYPE_CREATE         = 0x401,\n    LFS2_TYPE_DELETE         = 0x4ff,\n    LFS2_TYPE_SUPERBLOCK     = 0x0ff,\n    LFS2_TYPE_DIRSTRUCT      = 0x200,\n    LFS2_TYPE_CTZSTRUCT      = 0x202,\n    LFS2_TYPE_INLINESTRUCT   = 0x201,\n    LFS2_TYPE_SOFTTAIL       = 0x600,\n    LFS2_TYPE_HARDTAIL       = 0x601,\n    LFS2_TYPE_MOVESTATE      = 0x7ff,\n    LFS2_TYPE_CCRC           = 0x500,\n    LFS2_TYPE_FCRC           = 0x5ff,\n\n    \n    LFS2_FROM_NOOP           = 0x000,\n    LFS2_FROM_MOVE           = 0x101,\n    LFS2_FROM_USERATTRS      = 0x102,\n};\n\n\nenum lfs2_open_flags {\n    \n    LFS2_O_RDONLY = 1,         \n#ifndef LFS2_READONLY\n    LFS2_O_WRONLY = 2,         \n    LFS2_O_RDWR   = 3,         \n    LFS2_O_CREAT  = 0x0100,    \n    LFS2_O_EXCL   = 0x0200,    \n    LFS2_O_TRUNC  = 0x0400,    \n    LFS2_O_APPEND = 0x0800,    \n#endif\n\n    \n#ifndef LFS2_READONLY\n    LFS2_F_DIRTY   = 0x010000, \n    LFS2_F_WRITING = 0x020000, \n#endif\n    LFS2_F_READING = 0x040000, \n#ifndef LFS2_READONLY\n    LFS2_F_ERRED   = 0x080000, \n#endif\n    LFS2_F_INLINE  = 0x100000, \n};\n\n\nenum lfs2_whence_flags {\n    LFS2_SEEK_SET = 0,   \n    LFS2_SEEK_CUR = 1,   \n    LFS2_SEEK_END = 2,   \n};\n\n\n\nstruct lfs2_config {\n    \n    \n    void *context;\n\n    \n    \n    int (*read)(const struct lfs2_config *c, lfs2_block_t block,\n            lfs2_off_t off, void *buffer, lfs2_size_t size);\n\n    \n    \n    \n    int (*prog)(const struct lfs2_config *c, lfs2_block_t block,\n            lfs2_off_t off, const void *buffer, lfs2_size_t size);\n\n    \n    \n    \n    \n    int (*erase)(const struct lfs2_config *c, lfs2_block_t block);\n\n    \n    \n    int (*sync)(const struct lfs2_config *c);\n\n#ifdef LFS2_THREADSAFE\n    \n    \n    int (*lock)(const struct lfs2_config *c);\n\n    \n    \n    int (*unlock)(const struct lfs2_config *c);\n#endif\n\n    \n    \n    lfs2_size_t read_size;\n\n    \n    \n    lfs2_size_t prog_size;\n\n    \n    \n    \n    \n    lfs2_size_t block_size;\n\n    \n    lfs2_size_t block_count;\n\n    \n    \n    \n    \n    \n    \n    int32_t block_cycles;\n\n    \n    \n    \n    \n    \n    lfs2_size_t cache_size;\n\n    \n    \n    \n    \n    lfs2_size_t lookahead_size;\n\n    \n    \n    void *read_buffer;\n\n    \n    \n    void *prog_buffer;\n\n    \n    \n    \n    void *lookahead_buffer;\n\n    \n    \n    \n    \n    lfs2_size_t name_max;\n\n    \n    \n    \n    lfs2_size_t file_max;\n\n    \n    \n    \n    lfs2_size_t attr_max;\n\n    \n    \n    \n    \n    lfs2_size_t metadata_max;\n\n#ifdef LFS2_MULTIVERSION\n    \n    \n    \n    \n    uint32_t disk_version;\n#endif\n};\n\n\nstruct lfs2_info {\n    \n    uint8_t type;\n\n    \n    lfs2_size_t size;\n\n    \n    \n    \n    \n    char name[LFS2_NAME_MAX+1];\n};\n\n\nstruct lfs2_fsinfo {\n    \n    uint32_t disk_version;\n\n    \n    lfs2_size_t block_size;\n\n    \n    lfs2_size_t block_count;\n\n    \n    lfs2_size_t name_max;\n\n    \n    lfs2_size_t file_max;\n\n    \n    lfs2_size_t attr_max;\n};\n\n\n\nstruct lfs2_attr {\n    \n    \n    uint8_t type;\n\n    \n    void *buffer;\n\n    \n    lfs2_size_t size;\n};\n\n\nstruct lfs2_file_config {\n    \n    \n    void *buffer;\n\n    \n    \n    \n    \n    \n    \n    \n    \n    \n    \n    \n    struct lfs2_attr *attrs;\n\n    \n    lfs2_size_t attr_count;\n};\n\n\n\ntypedef struct lfs2_cache {\n    lfs2_block_t block;\n    lfs2_off_t off;\n    lfs2_size_t size;\n    uint8_t *buffer;\n} lfs2_cache_t;\n\ntypedef struct lfs2_mdir {\n    lfs2_block_t pair[2];\n    uint32_t rev;\n    lfs2_off_t off;\n    uint32_t etag;\n    uint16_t count;\n    bool erased;\n    bool split;\n    lfs2_block_t tail[2];\n} lfs2_mdir_t;\n\n\ntypedef struct lfs2_dir {\n    struct lfs2_dir *next;\n    uint16_t id;\n    uint8_t type;\n    lfs2_mdir_t m;\n\n    lfs2_off_t pos;\n    lfs2_block_t head[2];\n} lfs2_dir_t;\n\n\ntypedef struct lfs2_file {\n    struct lfs2_file *next;\n    uint16_t id;\n    uint8_t type;\n    lfs2_mdir_t m;\n\n    struct lfs2_ctz {\n        lfs2_block_t head;\n        lfs2_size_t size;\n    } ctz;\n\n    uint32_t flags;\n    lfs2_off_t pos;\n    lfs2_block_t block;\n    lfs2_off_t off;\n    lfs2_cache_t cache;\n\n    const struct lfs2_file_config *cfg;\n} lfs2_file_t;\n\ntypedef struct lfs2_superblock {\n    uint32_t version;\n    lfs2_size_t block_size;\n    lfs2_size_t block_count;\n    lfs2_size_t name_max;\n    lfs2_size_t file_max;\n    lfs2_size_t attr_max;\n} lfs2_superblock_t;\n\ntypedef struct lfs2_gstate {\n    uint32_t tag;\n    lfs2_block_t pair[2];\n} lfs2_gstate_t;\n\n\ntypedef struct lfs2 {\n    lfs2_cache_t rcache;\n    lfs2_cache_t pcache;\n\n    lfs2_block_t root[2];\n    struct lfs2_mlist {\n        struct lfs2_mlist *next;\n        uint16_t id;\n        uint8_t type;\n        lfs2_mdir_t m;\n    } *mlist;\n    uint32_t seed;\n\n    lfs2_gstate_t gstate;\n    lfs2_gstate_t gdisk;\n    lfs2_gstate_t gdelta;\n\n    struct lfs2_free {\n        lfs2_block_t off;\n        lfs2_block_t size;\n        lfs2_block_t i;\n        lfs2_block_t ack;\n        uint32_t *buffer;\n    } free;\n\n    const struct lfs2_config *cfg;\n    lfs2_size_t block_count;\n    lfs2_size_t name_max;\n    lfs2_size_t file_max;\n    lfs2_size_t attr_max;\n\n#ifdef LFS2_MIGRATE\n    struct lfs21 *lfs21;\n#endif\n} lfs2_t;\n\n\n\n\n#ifndef LFS2_READONLY\n\n\n\n\n\n\n\nint lfs2_format(lfs2_t *lfs2, const struct lfs2_config *config);\n#endif\n\n\n\n\n\n\n\n\n\nint lfs2_mount(lfs2_t *lfs2, const struct lfs2_config *config);\n\n\n\n\n\nint lfs2_unmount(lfs2_t *lfs2);\n\n\n\n#ifndef LFS2_READONLY\n\n\n\n\nint lfs2_remove(lfs2_t *lfs2, const char *path);\n#endif\n\n#ifndef LFS2_READONLY\n\n\n\n\n\n\nint lfs2_rename(lfs2_t *lfs2, const char *oldpath, const char *newpath);\n#endif\n\n\n\n\n\nint lfs2_stat(lfs2_t *lfs2, const char *path, struct lfs2_info *info);\n\n\n\n\n\n\n\n\n\n\n\n\n\nlfs2_ssize_t lfs2_getattr(lfs2_t *lfs2, const char *path,\n        uint8_t type, void *buffer, lfs2_size_t size);\n\n#ifndef LFS2_READONLY\n\n\n\n\n\n\n\nint lfs2_setattr(lfs2_t *lfs2, const char *path,\n        uint8_t type, const void *buffer, lfs2_size_t size);\n#endif\n\n#ifndef LFS2_READONLY\n\n\n\n\n\nint lfs2_removeattr(lfs2_t *lfs2, const char *path, uint8_t type);\n#endif\n\n\n\n\n#ifndef LFS2_NO_MALLOC\n\n\n\n\n\n\nint lfs2_file_open(lfs2_t *lfs2, lfs2_file_t *file,\n        const char *path, int flags);\n\n\n\n#endif\n\n\n\n\n\n\n\n\n\n\n\nint lfs2_file_opencfg(lfs2_t *lfs2, lfs2_file_t *file,\n        const char *path, int flags,\n        const struct lfs2_file_config *config);\n\n\n\n\n\n\n\nint lfs2_file_close(lfs2_t *lfs2, lfs2_file_t *file);\n\n\n\n\n\nint lfs2_file_sync(lfs2_t *lfs2, lfs2_file_t *file);\n\n\n\n\n\nlfs2_ssize_t lfs2_file_read(lfs2_t *lfs2, lfs2_file_t *file,\n        void *buffer, lfs2_size_t size);\n\n#ifndef LFS2_READONLY\n\n\n\n\n\n\nlfs2_ssize_t lfs2_file_write(lfs2_t *lfs2, lfs2_file_t *file,\n        const void *buffer, lfs2_size_t size);\n#endif\n\n\n\n\n\nlfs2_soff_t lfs2_file_seek(lfs2_t *lfs2, lfs2_file_t *file,\n        lfs2_soff_t off, int whence);\n\n#ifndef LFS2_READONLY\n\n\n\nint lfs2_file_truncate(lfs2_t *lfs2, lfs2_file_t *file, lfs2_off_t size);\n#endif\n\n\n\n\n\nlfs2_soff_t lfs2_file_tell(lfs2_t *lfs2, lfs2_file_t *file);\n\n\n\n\n\nint lfs2_file_rewind(lfs2_t *lfs2, lfs2_file_t *file);\n\n\n\n\n\nlfs2_soff_t lfs2_file_size(lfs2_t *lfs2, lfs2_file_t *file);\n\n\n\n\n#ifndef LFS2_READONLY\n\n\n\nint lfs2_mkdir(lfs2_t *lfs2, const char *path);\n#endif\n\n\n\n\n\nint lfs2_dir_open(lfs2_t *lfs2, lfs2_dir_t *dir, const char *path);\n\n\n\n\n\nint lfs2_dir_close(lfs2_t *lfs2, lfs2_dir_t *dir);\n\n\n\n\n\n\nint lfs2_dir_read(lfs2_t *lfs2, lfs2_dir_t *dir, struct lfs2_info *info);\n\n\n\n\n\n\n\nint lfs2_dir_seek(lfs2_t *lfs2, lfs2_dir_t *dir, lfs2_off_t off);\n\n\n\n\n\n\n\nlfs2_soff_t lfs2_dir_tell(lfs2_t *lfs2, lfs2_dir_t *dir);\n\n\n\n\nint lfs2_dir_rewind(lfs2_t *lfs2, lfs2_dir_t *dir);\n\n\n\n\n\n\n\n\nint lfs2_fs_stat(lfs2_t *lfs2, struct lfs2_fsinfo *fsinfo);\n\n\n\n\n\n\n\nlfs2_ssize_t lfs2_fs_size(lfs2_t *lfs2);\n\n\n\n\n\n\n\n\nint lfs2_fs_traverse(lfs2_t *lfs2, int (*cb)(void*, lfs2_block_t), void *data);\n\n\n\n\n\n\n\n\n\n\n\nint lfs2_fs_gc(lfs2_t *lfs2);\n\n#ifndef LFS2_READONLY\n\n\n\n\n\n\n\n\nint lfs2_fs_mkconsistent(lfs2_t *lfs2);\n#endif\n\n#ifndef LFS2_READONLY\n\n\n\n\n\n\nint lfs2_fs_grow(lfs2_t *lfs2, lfs2_size_t block_count);\n#endif\n\n#ifndef LFS2_READONLY\n#ifdef LFS2_MIGRATE\n\n\n\n\n\n\n\n\n\n\n\nint lfs2_migrate(lfs2_t *lfs2, const struct lfs2_config *cfg);\n#endif\n#endif\n\n\n#ifdef __cplusplus\n}  \n#endif\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}