{
  "module_name": "lfs1.h",
  "hash_id": "1d3e64151f981a9e02f69d07b653a15092fef6bb6aba25deee8fc285ecc46ac8",
  "original_prompt": "Ingested from sys_09_Anvil/source/lib/littlefs/lfs1.h",
  "human_readable_source": " \n#ifndef LFS1_H\n#define LFS1_H\n\n#include <stdint.h>\n#include <stdbool.h>\n\n#ifdef __cplusplus\nextern \"C\"\n{\n#endif\n\n\n\n\n\n\n\n#define LFS1_VERSION 0x00010007\n#define LFS1_VERSION_MAJOR (0xffff & (LFS1_VERSION >> 16))\n#define LFS1_VERSION_MINOR (0xffff & (LFS1_VERSION >>  0))\n\n\n\n\n#define LFS1_DISK_VERSION 0x00010001\n#define LFS1_DISK_VERSION_MAJOR (0xffff & (LFS1_DISK_VERSION >> 16))\n#define LFS1_DISK_VERSION_MINOR (0xffff & (LFS1_DISK_VERSION >>  0))\n\n\n\n\n\ntypedef uint32_t lfs1_size_t;\ntypedef uint32_t lfs1_off_t;\n\ntypedef int32_t  lfs1_ssize_t;\ntypedef int32_t  lfs1_soff_t;\n\ntypedef uint32_t lfs1_block_t;\n\n\n#ifndef LFS1_NAME_MAX\n#define LFS1_NAME_MAX 255\n#endif\n\n\n#ifndef LFS1_FILE_MAX\n#define LFS1_FILE_MAX 2147483647\n#endif\n\n\n\nenum lfs1_error {\n    LFS1_ERR_OK       = 0,    \n    LFS1_ERR_IO       = -5,   \n    LFS1_ERR_CORRUPT  = -52,  \n    LFS1_ERR_NOENT    = -2,   \n    LFS1_ERR_EXIST    = -17,  \n    LFS1_ERR_NOTDIR   = -20,  \n    LFS1_ERR_ISDIR    = -21,  \n    LFS1_ERR_NOTEMPTY = -39,  \n    LFS1_ERR_BADF     = -9,   \n    LFS1_ERR_FBIG     = -27,  \n    LFS1_ERR_INVAL    = -22,  \n    LFS1_ERR_NOSPC    = -28,  \n    LFS1_ERR_NOMEM    = -12,  \n};\n\n\nenum lfs1_type {\n    LFS1_TYPE_REG        = 0x11,\n    LFS1_TYPE_DIR        = 0x22,\n    LFS1_TYPE_SUPERBLOCK = 0x2e,\n};\n\n\nenum lfs1_open_flags {\n    \n    LFS1_O_RDONLY = 1,        \n    LFS1_O_WRONLY = 2,        \n    LFS1_O_RDWR   = 3,        \n    LFS1_O_CREAT  = 0x0100,   \n    LFS1_O_EXCL   = 0x0200,   \n    LFS1_O_TRUNC  = 0x0400,   \n    LFS1_O_APPEND = 0x0800,   \n\n    \n    LFS1_F_DIRTY   = 0x10000, \n    LFS1_F_WRITING = 0x20000, \n    LFS1_F_READING = 0x40000, \n    LFS1_F_ERRED   = 0x80000, \n};\n\n\nenum lfs1_whence_flags {\n    LFS1_SEEK_SET = 0,   \n    LFS1_SEEK_CUR = 1,   \n    LFS1_SEEK_END = 2,   \n};\n\n\n\nstruct lfs1_config {\n    \n    \n    void *context;\n\n    \n    \n    int (*read)(const struct lfs1_config *c, lfs1_block_t block,\n            lfs1_off_t off, void *buffer, lfs1_size_t size);\n\n    \n    \n    \n    int (*prog)(const struct lfs1_config *c, lfs1_block_t block,\n            lfs1_off_t off, const void *buffer, lfs1_size_t size);\n\n    \n    \n    \n    \n    int (*erase)(const struct lfs1_config *c, lfs1_block_t block);\n\n    \n    \n    int (*sync)(const struct lfs1_config *c);\n\n    \n    \n    \n    lfs1_size_t read_size;\n\n    \n    \n    \n    \n    lfs1_size_t prog_size;\n\n    \n    \n    \n    \n    lfs1_size_t block_size;\n\n    \n    lfs1_size_t block_count;\n\n    \n    \n    \n    \n    lfs1_size_t lookahead;\n\n    \n    void *read_buffer;\n\n    \n    void *prog_buffer;\n\n    \n    \n    void *lookahead_buffer;\n\n    \n    \n    void *file_buffer;\n};\n\n\nstruct lfs1_file_config {\n    \n    \n    void *buffer;\n};\n\n\nstruct lfs1_info {\n    \n    uint8_t type;\n\n    \n    lfs1_size_t size;\n\n    \n    char name[LFS1_NAME_MAX+1];\n};\n\n\n\ntypedef struct lfs1_entry {\n    lfs1_off_t off;\n\n    struct lfs1_disk_entry {\n        uint8_t type;\n        uint8_t elen;\n        uint8_t alen;\n        uint8_t nlen;\n        union {\n            struct {\n                lfs1_block_t head;\n                lfs1_size_t size;\n            } file;\n            lfs1_block_t dir[2];\n        } u;\n    } d;\n} lfs1_entry_t;\n\ntypedef struct lfs1_cache {\n    lfs1_block_t block;\n    lfs1_off_t off;\n    uint8_t *buffer;\n} lfs1_cache_t;\n\ntypedef struct lfs1_file {\n    struct lfs1_file *next;\n    lfs1_block_t pair[2];\n    lfs1_off_t poff;\n\n    lfs1_block_t head;\n    lfs1_size_t size;\n\n    const struct lfs1_file_config *cfg;\n    uint32_t flags;\n    lfs1_off_t pos;\n    lfs1_block_t block;\n    lfs1_off_t off;\n    lfs1_cache_t cache;\n} lfs1_file_t;\n\ntypedef struct lfs1_dir {\n    struct lfs1_dir *next;\n    lfs1_block_t pair[2];\n    lfs1_off_t off;\n\n    lfs1_block_t head[2];\n    lfs1_off_t pos;\n\n    struct lfs1_disk_dir {\n        uint32_t rev;\n        lfs1_size_t size;\n        lfs1_block_t tail[2];\n    } d;\n} lfs1_dir_t;\n\ntypedef struct lfs1_superblock {\n    lfs1_off_t off;\n\n    struct lfs1_disk_superblock {\n        uint8_t type;\n        uint8_t elen;\n        uint8_t alen;\n        uint8_t nlen;\n        lfs1_block_t root[2];\n        uint32_t block_size;\n        uint32_t block_count;\n        uint32_t version;\n        char magic[8];\n    } d;\n} lfs1_superblock_t;\n\ntypedef struct lfs1_free {\n    lfs1_block_t off;\n    lfs1_block_t size;\n    lfs1_block_t i;\n    lfs1_block_t ack;\n    uint32_t *buffer;\n} lfs1_free_t;\n\n\ntypedef struct lfs1 {\n    const struct lfs1_config *cfg;\n\n    lfs1_block_t root[2];\n    lfs1_file_t *files;\n    lfs1_dir_t *dirs;\n\n    lfs1_cache_t rcache;\n    lfs1_cache_t pcache;\n\n    lfs1_free_t free;\n    bool deorphaned;\n    bool moving;\n} lfs1_t;\n\n\n\n\n\n\n\n\n\n\n\nint lfs1_format(lfs1_t *lfs1, const struct lfs1_config *config);\n\n\n\n\n\n\n\n\n\nint lfs1_mount(lfs1_t *lfs1, const struct lfs1_config *config);\n\n\n\n\n\nint lfs1_unmount(lfs1_t *lfs1);\n\n\n\n\n\n\n\nint lfs1_remove(lfs1_t *lfs1, const char *path);\n\n\n\n\n\n\n\nint lfs1_rename(lfs1_t *lfs1, const char *oldpath, const char *newpath);\n\n\n\n\n\nint lfs1_stat(lfs1_t *lfs1, const char *path, struct lfs1_info *info);\n\n\n\n\n\n\n\n\n\n\nint lfs1_file_open(lfs1_t *lfs1, lfs1_file_t *file,\n        const char *path, int flags);\n\n\n\n\n\n\n\n\n\n\n\nint lfs1_file_opencfg(lfs1_t *lfs1, lfs1_file_t *file,\n        const char *path, int flags,\n        const struct lfs1_file_config *config);\n\n\n\n\n\n\n\nint lfs1_file_close(lfs1_t *lfs1, lfs1_file_t *file);\n\n\n\n\n\nint lfs1_file_sync(lfs1_t *lfs1, lfs1_file_t *file);\n\n\n\n\n\nlfs1_ssize_t lfs1_file_read(lfs1_t *lfs1, lfs1_file_t *file,\n        void *buffer, lfs1_size_t size);\n\n\n\n\n\n\n\nlfs1_ssize_t lfs1_file_write(lfs1_t *lfs1, lfs1_file_t *file,\n        const void *buffer, lfs1_size_t size);\n\n\n\n\n\nlfs1_soff_t lfs1_file_seek(lfs1_t *lfs1, lfs1_file_t *file,\n        lfs1_soff_t off, int whence);\n\n\n\n\nint lfs1_file_truncate(lfs1_t *lfs1, lfs1_file_t *file, lfs1_off_t size);\n\n\n\n\n\nlfs1_soff_t lfs1_file_tell(lfs1_t *lfs1, lfs1_file_t *file);\n\n\n\n\n\nint lfs1_file_rewind(lfs1_t *lfs1, lfs1_file_t *file);\n\n\n\n\n\nlfs1_soff_t lfs1_file_size(lfs1_t *lfs1, lfs1_file_t *file);\n\n\n\n\n\n\n\nint lfs1_mkdir(lfs1_t *lfs1, const char *path);\n\n\n\n\n\nint lfs1_dir_open(lfs1_t *lfs1, lfs1_dir_t *dir, const char *path);\n\n\n\n\n\nint lfs1_dir_close(lfs1_t *lfs1, lfs1_dir_t *dir);\n\n\n\n\n\nint lfs1_dir_read(lfs1_t *lfs1, lfs1_dir_t *dir, struct lfs1_info *info);\n\n\n\n\n\n\n\nint lfs1_dir_seek(lfs1_t *lfs1, lfs1_dir_t *dir, lfs1_off_t off);\n\n\n\n\n\n\n\nlfs1_soff_t lfs1_dir_tell(lfs1_t *lfs1, lfs1_dir_t *dir);\n\n\n\n\nint lfs1_dir_rewind(lfs1_t *lfs1, lfs1_dir_t *dir);\n\n\n\n\n\n\n\n\n\n\n\nint lfs1_traverse(lfs1_t *lfs1, int (*cb)(void*, lfs1_block_t), void *data);\n\n\n\n\n\n\n\n\nint lfs1_deorphan(lfs1_t *lfs1);\n\n\n#ifdef __cplusplus\n}  \n#endif\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}