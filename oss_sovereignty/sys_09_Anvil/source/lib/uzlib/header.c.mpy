{
  "module_name": "header.c",
  "hash_id": "597dc722bebbb486db923161f3ea7f51c23503432efdce5d25854a8df2536127",
  "original_prompt": "Ingested from sys_09_Anvil/source/lib/uzlib/header.c",
  "human_readable_source": " \n\n#include \"uzlib.h\"\n\n#define FTEXT    1\n#define FHCRC    2\n#define FEXTRA   4\n#define FNAME    8\n#define FCOMMENT 16\n\nvoid tinf_skip_bytes(uzlib_uncomp_t *d, int num);\nuint16_t tinf_get_uint16(uzlib_uncomp_t *d);\n\nvoid tinf_skip_bytes(uzlib_uncomp_t *d, int num)\n{\n    while (num--) uzlib_get_byte(d);\n}\n\nuint16_t tinf_get_uint16(uzlib_uncomp_t *d)\n{\n    unsigned int v = uzlib_get_byte(d);\n    v = (uzlib_get_byte(d) << 8) | v;\n    return v;\n}\n\nint uzlib_parse_zlib_gzip_header(uzlib_uncomp_t *d, int *wbits)\n{\n     \n    unsigned char cmf = uzlib_get_byte(d);\n    unsigned char flg = uzlib_get_byte(d);\n\n     \n    if (cmf == 0x1f && flg == 0x8b) {\n         \n        if (uzlib_get_byte(d) != 8) return UZLIB_DATA_ERROR;\n\n         \n        flg = uzlib_get_byte(d);\n\n         \n        if (flg & 0xe0) return UZLIB_DATA_ERROR;\n\n         \n\n         \n        tinf_skip_bytes(d, 6);\n\n         \n        if (flg & FEXTRA)\n        {\n           unsigned int xlen = tinf_get_uint16(d);\n           tinf_skip_bytes(d, xlen);\n        }\n\n         \n        if (flg & FNAME) { while (uzlib_get_byte(d)); }\n\n         \n        if (flg & FCOMMENT) { while (uzlib_get_byte(d)); }\n\n         \n        if (flg & FHCRC)\n        {\n             tinf_get_uint16(d);\n\n            \n    \n    \n        }\n\n         \n        d->checksum_type = UZLIB_CHKSUM_CRC;\n        d->checksum = ~0;\n\n         \n        *wbits = 15;\n\n        return UZLIB_HEADER_GZIP;\n    } else {\n        \n       if ((256*cmf + flg) % 31) return UZLIB_DATA_ERROR;\n\n        \n       if ((cmf & 0x0f) != 8) return UZLIB_DATA_ERROR;\n\n        \n       if ((cmf >> 4) > 7) return UZLIB_DATA_ERROR;\n\n        \n       if (flg & 0x20) return UZLIB_DATA_ERROR;\n\n        \n       d->checksum_type = UZLIB_CHKSUM_ADLER;\n       d->checksum = 1;\n\n       *wbits = (cmf >> 4) + 8;\n\n        return UZLIB_HEADER_ZLIB;\n    }\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}