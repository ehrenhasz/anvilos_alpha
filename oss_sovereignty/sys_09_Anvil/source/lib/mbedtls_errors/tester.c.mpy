{
  "module_name": "tester.c",
  "hash_id": "33487160f28446a7d0dbdd2cb21f13380dd2b2c5c3a7fb1edf5bf68e85f5e11f",
  "original_prompt": "Ingested from sys_09_Anvil/source/lib/mbedtls_errors/tester.c",
  "human_readable_source": "#include \"mbedtls/error.h\"\n#include <string.h>\n#include <stdio.h>\n\n\n\n\n\nint test_code(int code, char *str) {\n    char buf[100];\n    int ok = 1;\n    int res;\n\n    \n    memset(buf, -3, 100);\n    mbedtls_strerror(code, buf + 4, 0);\n    for (int i = 0; i < 10; i++) {\n        if (buf[i] != -3) {\n            printf(\"Error: guard overwritten buflen=0 i=%d buf[i]=%d\\n\", i, buf[i]);\n            ok = 0;\n        }\n    }\n\n    \n    for (size_t buflen = 1; buflen < 90; buflen++) {\n        memset(buf, -3, 100);\n        mbedtls_strerror(code, buf + 4, buflen);\n        for (int i = 0; i < 4; i++) {\n            if (buf[i] != -3) {\n                printf(\"Error: pre-guard overwritten buflen=%d i=%d buf[i]=%d\\n\", buflen, i, buf[i]);\n                ok = 0;\n            }\n        }\n        for (int i = 4 + buflen; i < 100; i++) {\n            if (buf[i] != -3) {\n                printf(\"Error: post-guard overwritten buflen=%d i=%d buf[i]=%d\\n\", buflen, i, buf[i]);\n                ok = 0;\n            }\n        }\n        char exp[100];\n        strncpy(exp, str, buflen);\n        exp[buflen - 1] = 0;\n        if (strcmp(buf + 4, exp) != 0) {\n            printf(\"Error: expected %s, got %s\\n\", exp, buf);\n            ok = 0;\n        }\n    }\n\n    printf(\"Test %x -> %s is %s\\n\", code, str, ok?\"OK\":\"*** BAD ***\");\n}\n\nint main() {\n    test_code(0x7200, \"MBEDTLS_ERR_SSL_INVALID_RECORD\");\n    test_code(0x7780, \"MBEDTLS_ERR_SSL_FATAL_ALERT_MESSAGE\");\n    test_code(0x0074, \"MBEDTLS_ERR_SHA256_BAD_INPUT_DATA\");\n    test_code(0x6600 | 0x0074, \"MBEDTLS_ERR_SSL_INVALID_VERIFY_HASH+MBEDTLS_ERR_SHA256_BAD_INPUT_DATA\");\n    test_code(103, \"MBEDTLS_ERR_UNKNOWN (0x0067)\");\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}