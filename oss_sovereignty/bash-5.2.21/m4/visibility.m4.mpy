{
  "module_name": "visibility.m4",
  "hash_id": "6de9f622521fa1677d76426e739fa7217cfae8ef851f1a070cf09ee52303d0c3",
  "original_prompt": "Ingested from bash-5.2.21/m4/visibility.m4",
  "human_readable_source": "# visibility.m4 serial 6\ndnl Copyright (C) 2005, 2008, 2010-2019 Free Software Foundation, Inc.\ndnl This file is free software; the Free Software Foundation\ndnl gives unlimited permission to copy and/or distribute it,\ndnl with or without modifications, as long as this notice is preserved.\n\ndnl From Bruno Haible.\n\ndnl Tests whether the compiler supports the command-line option\ndnl -fvisibility=hidden and the function and variable attributes\ndnl __attribute__((__visibility__(\"hidden\"))) and\ndnl __attribute__((__visibility__(\"default\"))).\ndnl Does *not* test for __visibility__(\"protected\") - which has tricky\ndnl semantics (see the 'vismain' test in glibc) and does not exist e.g. on\ndnl Mac OS X.\ndnl Does *not* test for __visibility__(\"internal\") - which has processor\ndnl dependent semantics.\ndnl Does *not* test for #pragma GCC visibility push(hidden) - which is\ndnl \"really only recommended for legacy code\".\ndnl Set the variable CFLAG_VISIBILITY.\ndnl Defines and sets the variable HAVE_VISIBILITY.\n\nAC_DEFUN([gl_VISIBILITY],\n[\n  AC_REQUIRE([AC_PROG_CC])\n  CFLAG_VISIBILITY=\n  HAVE_VISIBILITY=0\n  if test -n \"$GCC\"; then\n    dnl First, check whether -Werror can be added to the command line, or\n    dnl whether it leads to an error because of some other option that the\n    dnl user has put into $CC $CFLAGS $CPPFLAGS.\n    AC_CACHE_CHECK([whether the -Werror option is usable],\n      [gl_cv_cc_vis_werror],\n      [gl_save_CFLAGS=\"$CFLAGS\"\n       CFLAGS=\"$CFLAGS -Werror\"\n       AC_COMPILE_IFELSE(\n         [AC_LANG_PROGRAM([[]], [[]])],\n         [gl_cv_cc_vis_werror=yes],\n         [gl_cv_cc_vis_werror=no])\n       CFLAGS=\"$gl_save_CFLAGS\"\n      ])\n    dnl Now check whether visibility declarations are supported.\n    AC_CACHE_CHECK([for simple visibility declarations],\n      [gl_cv_cc_visibility],\n      [gl_save_CFLAGS=\"$CFLAGS\"\n       CFLAGS=\"$CFLAGS -fvisibility=hidden\"\n       dnl We use the option -Werror and a function dummyfunc, because on some\n       dnl platforms (Cygwin 1.7) the use of -fvisibility triggers a warning\n       dnl \"visibility attribute not supported in this configuration; ignored\"\n       dnl at the first function definition in every compilation unit, and we\n       dnl don't want to use the option in this case.\n       if test $gl_cv_cc_vis_werror = yes; then\n         CFLAGS=\"$CFLAGS -Werror\"\n       fi\n       AC_COMPILE_IFELSE(\n         [AC_LANG_PROGRAM(\n            [[extern __attribute__((__visibility__(\"hidden\"))) int hiddenvar;\n              extern __attribute__((__visibility__(\"default\"))) int exportedvar;\n              extern __attribute__((__visibility__(\"hidden\"))) int hiddenfunc (void);\n              extern __attribute__((__visibility__(\"default\"))) int exportedfunc (void);\n              void dummyfunc (void) {}\n            ]],\n            [[]])],\n         [gl_cv_cc_visibility=yes],\n         [gl_cv_cc_visibility=no])\n       CFLAGS=\"$gl_save_CFLAGS\"\n      ])\n    if test $gl_cv_cc_visibility = yes; then\n      CFLAG_VISIBILITY=\"-fvisibility=hidden\"\n      HAVE_VISIBILITY=1\n    fi\n  fi\n  AC_SUBST([CFLAG_VISIBILITY])\n  AC_SUBST([HAVE_VISIBILITY])\n  AC_DEFINE_UNQUOTED([HAVE_VISIBILITY], [$HAVE_VISIBILITY],\n    [Define to 1 or 0, depending whether the compiler supports simple visibility declarations.])\n])\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}