{
  "module_name": "trace.c",
  "hash_id": "17b883c3f5c8a74633490018fe1c0be1f4762c1f8ccea900caa6d8d941172381",
  "original_prompt": "Ingested from bash-5.2.21/lib/malloc/trace.c",
  "human_readable_source": " \n\n \n\n#ifdef HAVE_CONFIG_H\n#  include <config.h>\n#endif\n\n#include <stdio.h>\n#ifdef HAVE_UNISTD_H\n#  include <unistd.h>\n#endif\n\n#include \"imalloc.h\"\n\nextern int malloc_trace;\n\nstatic int _mtrace_verbose = 0;\n\n#ifdef MALLOC_TRACE\n\nextern FILE *_imalloc_fopen PARAMS((char *, char *, char *, char *, size_t));\n\nFILE *_mtrace_fp = NULL;\nextern char _malloc_trace_buckets[];\n\nvoid\nmtrace_alloc (tag, mem, size, file, line)\n     const char *tag;\n     PTR_T mem;\n     size_t size;\n     const char *file;\n     int line;\n{\n  if (_mtrace_fp == NULL)\n    _mtrace_fp = stderr;\n\n  if (_mtrace_verbose)\n    fprintf (_mtrace_fp, \"alloc: %s: %p (%zu bytes) from '%s:%d'\\n\",\n\t\ttag, mem, size, file ? file : \"unknown\", line);\n  else\n    fprintf (_mtrace_fp, \"alloc:%p:%zu:%s:%d\\n\",\n\t\tmem, size, file ? file : \"unknown\", line);\n}\n\nvoid\nmtrace_free (mem, size, file, line)\n     PTR_T mem;\n     int size;\n     const char *file;\n     int line;\n{\n  if (_mtrace_fp == NULL)\n    _mtrace_fp = stderr;\n\n  if (_mtrace_verbose)\n    fprintf (_mtrace_fp, \"free: %p (%d bytes) from '%s:%d'\\n\",\n\t\tmem, size, file ? file : \"unknown\", line);\n  else\n    fprintf (_mtrace_fp, \"free:%p:%d:%s:%d\\n\",\n\t\tmem, size, file ? file : \"unknown\", line);\n}\n#endif  \n\nint\nmalloc_set_trace (n)\n     int n;\n{\n  int old;\n\n  old = malloc_trace;\n  malloc_trace = n;\n  _mtrace_verbose = (n > 1);\n  return old;\n}\n\nvoid\nmalloc_set_tracefp (fp)\n     FILE *fp;\n{\n#ifdef MALLOC_TRACE\n  _mtrace_fp = fp ? fp : stderr;\n#endif\n}\n\nvoid\nmalloc_trace_bin (n)\n     int n;\n{\n#ifdef MALLOC_TRACE\n  _malloc_trace_buckets[n] = 1;\n#endif\n}\n\n#define TRACEROOT \"/var/tmp/maltrace/trace.\"\n\nvoid\nmalloc_set_tracefn (s, fn)\n     char *s;\n     char *fn;\n{\n#ifdef MALLOC_TRACE\n  FILE *fp;\n  char defname[sizeof (TRACEROOT) + 64];\n\n  fp = _imalloc_fopen (s, fn, TRACEROOT, defname, sizeof (defname));\n  if (fp)\n    malloc_set_tracefp (fp);\n#endif\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}