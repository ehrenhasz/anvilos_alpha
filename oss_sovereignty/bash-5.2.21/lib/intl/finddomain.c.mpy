{
  "module_name": "finddomain.c",
  "hash_id": "cd0d7d596b0414c502241eb22c09c7e3da311e1d606066bd4106dfc79565983d",
  "original_prompt": "Ingested from bash-5.2.21/lib/intl/finddomain.c",
  "human_readable_source": " \n\n \n\n#ifdef HAVE_CONFIG_H\n# include <config.h>\n#endif\n\n#include <stdio.h>\n#include <sys/types.h>\n#include <stdlib.h>\n#include <string.h>\n\n#if defined HAVE_UNISTD_H || defined _LIBC\n# include <unistd.h>\n#endif\n\n#include \"gettextP.h\"\n#ifdef _LIBC\n# include <libintl.h>\n#else\n# include \"libgnuintl.h\"\n#endif\n\n \n \nstatic struct loaded_l10nfile *_nl_loaded_domains;\n\n\n \nstruct loaded_l10nfile *\ninternal_function\n_nl_find_domain (dirname, locale, domainname, domainbinding)\n     const char *dirname;\n     char *locale;\n     const char *domainname;\n     struct binding *domainbinding;\n{\n  struct loaded_l10nfile *retval;\n  const char *language;\n  const char *modifier;\n  const char *territory;\n  const char *codeset;\n  const char *normalized_codeset;\n  const char *special;\n  const char *sponsor;\n  const char *revision;\n  const char *alias_value;\n  int mask;\n\n   \n\n   \n  retval = _nl_make_l10nflist (&_nl_loaded_domains, dirname,\n\t\t\t       strlen (dirname) + 1, 0, locale, NULL, NULL,\n\t\t\t       NULL, NULL, NULL, NULL, NULL, domainname, 0);\n  if (retval != NULL)\n    {\n       \n      int cnt;\n\n      if (retval->decided == 0)\n\t_nl_load_domain (retval, domainbinding);\n\n      if (retval->data != NULL)\n\treturn retval;\n\n      for (cnt = 0; retval->successor[cnt] != NULL; ++cnt)\n\t{\n\t  if (retval->successor[cnt]->decided == 0)\n\t    _nl_load_domain (retval->successor[cnt], domainbinding);\n\n\t  if (retval->successor[cnt]->data != NULL)\n\t    break;\n\t}\n      return cnt >= 0 ? retval : NULL;\n       \n    }\n\n   \n  alias_value = _nl_expand_alias (locale);\n  if (alias_value != NULL)\n    {\n#if defined _LIBC || defined HAVE_STRDUP\n      locale = strdup (alias_value);\n      if (locale == NULL)\n\treturn NULL;\n#else\n      size_t len = strlen (alias_value) + 1;\n      locale = (char *) malloc (len);\n      if (locale == NULL)\n\treturn NULL;\n\n      memcpy (locale, alias_value, len);\n#endif\n    }\n\n   \n  mask = _nl_explode_name (locale, &language, &modifier, &territory,\n\t\t\t   &codeset, &normalized_codeset, &special,\n\t\t\t   &sponsor, &revision);\n\n   \n  retval = _nl_make_l10nflist (&_nl_loaded_domains, dirname,\n\t\t\t       strlen (dirname) + 1, mask, language, territory,\n\t\t\t       codeset, normalized_codeset, modifier, special,\n\t\t\t       sponsor, revision, domainname, 1);\n  if (retval == NULL)\n     \n    return NULL;\n\n  if (retval->decided == 0)\n    _nl_load_domain (retval, domainbinding);\n  if (retval->data == NULL)\n    {\n      int cnt;\n      for (cnt = 0; retval->successor[cnt] != NULL; ++cnt)\n\t{\n\t  if (retval->successor[cnt]->decided == 0)\n\t    _nl_load_domain (retval->successor[cnt], domainbinding);\n\t  if (retval->successor[cnt]->data != NULL)\n\t    break;\n\t}\n    }\n\n   \n  if (alias_value != NULL)\n    free (locale);\n\n   \n  if (mask & XPG_NORM_CODESET)\n    free ((void *) normalized_codeset);\n\n  return retval;\n}\n\n\n#ifdef _LIBC\nlibc_freeres_fn (free_mem)\n{\n  struct loaded_l10nfile *runp = _nl_loaded_domains;\n\n  while (runp != NULL)\n    {\n      struct loaded_l10nfile *here = runp;\n      if (runp->data != NULL)\n\t_nl_unload_domain ((struct loaded_domain *) runp->data);\n      runp = runp->next;\n      free ((char *) here->filename);\n      free (here);\n    }\n}\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}