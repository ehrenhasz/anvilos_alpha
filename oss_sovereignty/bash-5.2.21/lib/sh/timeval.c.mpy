{
  "module_name": "timeval.c",
  "hash_id": "d3c137000adc0d130e48d0845ef1f321a6243c2552467504a5506f1dc78cd998",
  "original_prompt": "Ingested from bash-5.2.21/lib/sh/timeval.c",
  "human_readable_source": " \n\n \n\n#include <config.h>\n\n#if defined (HAVE_TIMEVAL)\n\n#include <sys/types.h>\n#include <posixtime.h>\n\n#include <bashintl.h>\n#include <stdc.h>\n\n#ifndef locale_decpoint\nextern int locale_decpoint PARAMS((void));\n#endif\n\n#include <stdio.h>\n\nstruct timeval *\ndifftimeval (d, t1, t2)\n     struct timeval *d, *t1, *t2;\n{\n  d->tv_sec = t2->tv_sec - t1->tv_sec;\n  d->tv_usec = t2->tv_usec - t1->tv_usec;\n  if (d->tv_usec < 0)\n    {\n      d->tv_usec += 1000000;\n      d->tv_sec -= 1;\n      if (d->tv_sec < 0)\t\t \n\t{\n\t  d->tv_sec = 0;\n\t  d->tv_usec = 0;\n\t}\n    }\n  return d;\n}\n\nstruct timeval *\naddtimeval (d, t1, t2)\n     struct timeval *d, *t1, *t2;\n{\n  d->tv_sec = t1->tv_sec + t2->tv_sec;\n  d->tv_usec = t1->tv_usec + t2->tv_usec;\n  if (d->tv_usec >= 1000000)\n    {\n      d->tv_usec -= 1000000;\n      d->tv_sec += 1;\n    }\n  return d;\n}\n\nstruct timeval *\nmultimeval (d, m)\n     struct timeval *d;\n     int m;\n{\n  time_t t;\n\n  t = d->tv_usec * m;\n  d->tv_sec = d->tv_sec * m + t / 1000000;\n  d->tv_usec = t % 1000000;\n  return d;\n}\n\nstruct timeval *\ndivtimeval (d, m)\n     struct timeval *d;\n     int m;\n{\n  time_t t;\n\n  t = d->tv_sec;\n  d->tv_sec = t / m;\n  d->tv_usec = (d->tv_usec + 1000000 * (t % m)) / m;\n  return d;\n}\n  \n \nint\ntimeval_to_cpu (rt, ut, st)\n     struct timeval *rt, *ut, *st;\t \n{\n  struct timeval t1, t2;\n  register int i;\n\n  addtimeval (&t1, ut, st);\n  t2.tv_sec = rt->tv_sec;\n  t2.tv_usec = rt->tv_usec;\n\n  for (i = 0; i < 6; i++)\n    {\n      if ((t1.tv_sec > 99999999) || (t2.tv_sec > 99999999))\n\tbreak;\n      t1.tv_sec *= 10;\n      t1.tv_sec += t1.tv_usec / 100000;\n      t1.tv_usec *= 10;\n      t1.tv_usec %= 1000000;\n      t2.tv_sec *= 10;\n      t2.tv_sec += t2.tv_usec / 100000;\n      t2.tv_usec *= 10;\n      t2.tv_usec %= 1000000;\n    }\n  for (i = 0; i < 4; i++)\n    {\n      if (t1.tv_sec < 100000000)\n\tt1.tv_sec *= 10;\n      else\n\tt2.tv_sec /= 10;\n    }\n\n  return ((t2.tv_sec == 0) ? 0 : t1.tv_sec / t2.tv_sec);\n}  \n\n \nvoid\ntimeval_to_secs (tvp, sp, sfp)\n     struct timeval *tvp;\n     time_t *sp;\n     int *sfp;\n{\n  int rest;\n\n  *sp = tvp->tv_sec;\n\n  *sfp = tvp->tv_usec % 1000000;\t \n  rest = *sfp % 1000;\n  *sfp = (*sfp * 1000) / 1000000;\n  if (rest >= 500)\n    *sfp += 1;\n\n   \n  if (*sfp >= 1000)\n    {\n      *sp += 1;\n      *sfp -= 1000;\n    }\n}\n  \n \nvoid\nprint_timeval (fp, tvp)\n     FILE *fp;\n     struct timeval *tvp;\n{\n  time_t timestamp;\n  long minutes;\n  int seconds, seconds_fraction;\n\n  timeval_to_secs (tvp, &timestamp, &seconds_fraction);\n\n  minutes = timestamp / 60;\n  seconds = timestamp % 60;\n\n  fprintf (fp, \"%ldm%d%c%03ds\",  minutes, seconds, locale_decpoint (), seconds_fraction);\n}\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}