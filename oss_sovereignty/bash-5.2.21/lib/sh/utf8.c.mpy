{
  "module_name": "utf8.c",
  "hash_id": "068910aadfd7bfcf567b722441c02b5b7b5a769266805f4ab13589988d316185",
  "original_prompt": "Ingested from bash-5.2.21/lib/sh/utf8.c",
  "human_readable_source": " \n\n \n\n#include <config.h>\n\n#ifdef HAVE_STDLIB_H\n#  include <stdlib.h>\n#endif\n\n#include \"bashansi.h\"\n#include \"shmbutil.h\"\n\nextern int locale_mb_cur_max;\nextern int locale_utf8locale;\n\n#if defined (HANDLE_MULTIBYTE)\n\nchar *\nutf8_mbschr (s, c)\n     const char *s;\n     int c;\n{\n  return strchr (s, c);\t\t \n}\n\nint\nutf8_mbscmp (s1, s2)\n     const char *s1, *s2;\n{\n   \n  return strcmp (s1, s2);\n}\n\nchar *\nutf8_mbsmbchar (str)\n     const char *str;\n{\n  register char *s;\n\n  for (s = (char *)str; *s; s++)\n    if ((*s & 0xc0) == 0x80)\n      return s;\n  return (0);\n}\n\nint\nutf8_mbsnlen(src, srclen, maxlen)\n     const char *src;\n     size_t srclen;\n     int maxlen;\n{\n  register int sind, count;\n\n  for (sind = count = 0; src[sind] && sind <= maxlen; sind++)\n    {\n      if ((src[sind] & 0xc0) != 0x80)\n\tcount++;\n    }\n  return (count);\n}\n\n \nint\nutf8_mblen (s, n)\n     const char *s;\n     size_t n;\n{\n  unsigned char c, c1, c2, c3;\n\n  if (s == 0)\n    return (0);\t \n  if (n <= 0)\n    return (-1);\n\n  c = (unsigned char)*s;\n  if (c < 0x80)\n    return (c != 0);\n  if (c >= 0xc2)\n    {\n      c1 = (unsigned char)s[1];\n      if (c < 0xe0)\n\t{\n\t  if (n == 1)\n\t    return -2;\n\n\t   \n\n\t  if (n >= 2 && (c1 ^ 0x80) < 0x40)\t\t \n\t    return 2;\n\t}\n      else if (c < 0xf0)\n\t{\n\t  if (n == 1)\n\t    return -2;\n\n\t   \n\n\t  if ((c1 ^ 0x80) < 0x40\n\t\t&& (c >= 0xe1 || c1 >= 0xa0)\n\t\t&& (c != 0xed || c1 < 0xa0))\n\t    {\n\t      if (n == 2)\n\t\treturn -2;\t\t \n\n\t      c2 = (unsigned char)s[2];\n\t      if ((c2 ^ 0x80) < 0x40)\n\t\t return 3;\n\t    }\n\t}\n      else if (c <= 0xf4)\n\t{\n\t  if (n == 1)\n\t    return -2;\n\t \n\t   \n\t  if (((c1 ^ 0x80) < 0x40) \n\t\t&& (c >= 0xf1 || c1 >= 0x90)\n\t\t&& (c < 0xf4 || (c == 0xf4 && c1 < 0x90)))\n\t    {\n\t      if (n == 2)\n\t\treturn -2;\t\t \n\n\t      c2 = (unsigned char)s[2];\n\t      if ((c2 ^ 0x80) < 0x40)\n\t\t{\n\t\t  if (n == 3)\n\t\t    return -2;\n\n\t\t  c3 = (unsigned char)s[3];\n\t \t  if ((c3 ^ 0x80) < 0x40)\n\t  \t    return 4;\n\t\t}\n\t    }\n\t}\n    }\n   \n  return -1;\n}\n\n \nsize_t\nutf8_mbstrlen(s)\n     const char *s;\n{\n  size_t clen, nc;\n  int mb_cur_max;\n\n  nc = 0;\n  mb_cur_max = MB_CUR_MAX;\n  while (*s && (clen = (size_t)utf8_mblen(s, mb_cur_max)) != 0)\n    {\n      if (MB_INVALIDCH(clen))\n\tclen = 1;\t \n\n      s += clen;\n      nc++;\n    }\n  return nc;\n}\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}