{
  "module_name": "getenv.c",
  "hash_id": "3931758d17d7242f6dcafd6bb7df8fde15c27aa780c62bbea8ab76b2a80da9bc",
  "original_prompt": "Ingested from bash-5.2.21/lib/sh/getenv.c",
  "human_readable_source": " \n\n \n\n#include <config.h>\n\n#if defined (CAN_REDEFINE_GETENV)\n\n#if defined (HAVE_UNISTD_H)\n#  include <unistd.h>\n#endif\n\n#include <bashansi.h>\n#include <errno.h>\n#include <shell.h>\n\n#ifndef errno\nextern int errno;\n#endif\n\nextern char **environ;\n\n \n\n \nstatic char *last_tempenv_value = (char *)NULL;\n\nchar *\ngetenv (name)\n     const char *name;\n{\n  SHELL_VAR *var;\n\n  if (name == 0 || *name == '\\0')\n    return ((char *)NULL);\n\n  var = find_tempenv_variable ((char *)name);\n  if (var)\n    {\n      FREE (last_tempenv_value);\n\n      last_tempenv_value = value_cell (var) ? savestring (value_cell (var)) : (char *)NULL;\n      return (last_tempenv_value);\n    }\n  else if (shell_variables)\n    {\n      var = find_variable ((char *)name);\n      if (var && exported_p (var))\n\treturn (value_cell (var));\n    }\n  else if (environ)\n    {\n      register int i, len;\n\n       \n\n      for (i = 0, len = strlen (name); environ[i]; i++)\n\t{\n\t  if ((STREQN (environ[i], name, len)) && (environ[i][len] == '='))\n\t    return (environ[i] + len + 1);\n\t}\n    }\n\n  return ((char *)NULL);\n}\n\n \nchar *\n_getenv (name)\n     const char *name;\n{\n  return (getenv (name));\n}\n\n \nint\nputenv (str)\n#ifndef HAVE_STD_PUTENV\n     const char *str;\n#else\n     char *str;\n#endif\n{\n  SHELL_VAR *var;\n  char *name, *value;\n  int offset;\n\n  if (str == 0 || *str == '\\0')\n    {\n      errno = EINVAL;\n      return -1;\n    }\n\n  offset = assignment (str, 0);\n  if (str[offset] != '=')\n    {\n      errno = EINVAL;\n      return -1;\n    }\n  name = savestring (str);\n  name[offset] = 0;\n\n  value = name + offset + 1;\n\n   \n  var = bind_variable (name, value, 0);\n  if (var == 0)\n    {\n      errno = EINVAL;\n      return -1;\n    }\n\n  VUNSETATTR (var, att_invisible);\n  VSETATTR (var, att_exported);\n\n  return 0;\n}\n\n#if 0\nint\n_putenv (name)\n#ifndef HAVE_STD_PUTENV\n     const char *name;\n#else\n     char *name;\n#endif\n{\n  return putenv (name);\n}\n#endif\n\nint\nsetenv (name, value, rewrite)\n     const char *name;\n     const char *value;\n     int rewrite;\n{\n  SHELL_VAR *var;\n  char *v;\n\n  if (name == 0 || *name == '\\0' || strchr (name, '=') != 0)\n    {\n      errno = EINVAL;\n      return -1;\n    }\n\n  var = 0;\n  v = (char *)value;\t \n   \n  if (rewrite == 0)\n    var = find_variable (name);\n\n  if (var == 0)\n    var = bind_variable (name, v, 0);\n\n  if (var == 0)\n    return -1;\n\n  VUNSETATTR (var, att_invisible);\n  VSETATTR (var, att_exported);\n\n  return 0;\n}\n\n#if 0\nint\n_setenv (name, value, rewrite)\n     const char *name;\n     const char *value;\n     int rewrite;\n{\n  return setenv (name, value, rewrite);\n}\n#endif\n\n \n\n#ifdef HAVE_STD_UNSETENV\n#define UNSETENV_RETURN(N)\treturn(N)\n#define UNSETENV_RETTYPE\tint\n#else\n#define UNSETENV_RETURN(N)\treturn\n#define UNSETENV_RETTYPE\tvoid\n#endif\n\nUNSETENV_RETTYPE\nunsetenv (name)\n     const char *name;\n{\n  if (name == 0 || *name == '\\0' || strchr (name, '=') != 0)\n    {\n      errno = EINVAL;\n      UNSETENV_RETURN(-1);\n    }\n\n   \n#if 1\n  unbind_variable (name);\n#else\n  SHELL_VAR *v;\n\n  v = find_variable (name);\n  if (v)\n    VUNSETATTR (v, att_exported);\n#endif\n\n  UNSETENV_RETURN(0);\n}\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}