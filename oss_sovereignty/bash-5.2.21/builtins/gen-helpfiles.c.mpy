{
  "module_name": "gen-helpfiles.c",
  "hash_id": "262289d38e1653a750bb0d3d8e5adae587be25440517be0fdb15822b822bb74c",
  "original_prompt": "Ingested from bash-5.2.21/builtins/gen-helpfiles.c",
  "human_readable_source": " \n\n \n\n \n\n#if !defined (CROSS_COMPILING) \n#  include <config.h>\n#else\t \n \n#  define HAVE_UNISTD_H\n#  define HAVE_STRING_H\n#  define HAVE_STDLIB_H\n\n#  define HAVE_RENAME\n#endif  \n\n#if defined (HAVE_UNISTD_H)\n#  ifdef _MINIX\n#    include <sys/types.h>\n#  endif\n#  include <unistd.h>\n#endif\n\n#ifndef _MINIX\n#  include \"../bashtypes.h\"\n#  if defined (HAVE_SYS_FILE_H)\n#    include <sys/file.h>\n#  endif\n#endif\n\n#include \"posixstat.h\"\n#include \"filecntl.h\"\n\n#include \"../bashansi.h\"\n#include <stdio.h>\n#include <errno.h>\n\n#include \"stdc.h\"\n\n#include \"../builtins.h\"\n#include \"tmpbuiltins.h\"\n\n#if defined (USING_BASH_MALLOC)\n#undef xmalloc\n#undef xrealloc\n#undef xfree\n\n#undef malloc\n#undef free\t\t \n#endif\n\n#ifndef errno\nextern int errno;\n#endif\n\n#if !defined (__STDC__) && !defined (strcpy)\nextern char *strcpy ();\n#endif  \n\n#define whitespace(c) (((c) == ' ') || ((c) == '\\t'))\n\n \n#define BUILTIN_FLAG_SPECIAL\t0x01\n#define BUILTIN_FLAG_ASSIGNMENT 0x02\n#define BUILTIN_FLAG_POSIX_BUILTIN 0x04\n\n#define BASE_INDENT\t4\n\n \nint separate_helpfiles = 0;\n\n \nint single_longdoc_strings = 1;\n\n \nchar *helpfile_directory;\n\n \n\nint write_helpfiles PARAMS((struct builtin *));\n\n \nint\nmain (argc, argv)\n     int argc;\n     char **argv;\n{\n  int arg_index = 1;\n\n  while (arg_index < argc && argv[arg_index][0] == '-')\n    {\n      char *arg = argv[arg_index++];\n\n      if (strcmp (arg, \"-noproduction\") == 0)\n\t;\n      else if (strcmp (arg, \"-H\") == 0)\n\thelpfile_directory = argv[arg_index++];\n      else if (strcmp (arg, \"-S\") == 0)\n\tsingle_longdoc_strings = 0;\n      else\n\t{\n\t  fprintf (stderr, \"%s: Unknown flag %s.\\n\", argv[0], arg);\n\t  exit (2);\n\t}\n    }\n\n  write_helpfiles(shell_builtins);\n\n  exit (0);\n}\n\n \nvoid\nwrite_documentation (stream, documentation, indentation)\n     FILE *stream;\n     char *documentation;\n     int indentation;\n{\n  if (stream == 0)\n    return;\n\n  if (documentation)\n    fprintf (stream, \"%*s%s\\n\", indentation, \" \", documentation);\n}\n\nint\nwrite_helpfiles (builtins)\n     struct builtin *builtins;\n{\n  char *helpfile, *bname, *fname;\n  FILE *helpfp;\n  int i, hdlen;\n  struct builtin b;\n\n  i = mkdir (\"helpfiles\", 0777);\n  if (i < 0 && errno != EEXIST)\n    {\n      fprintf (stderr, \"write_helpfiles: helpfiles: cannot create directory\\n\");\n      return -1;\n    }\n\n  hdlen = strlen (\"helpfiles/\");\n  for (i = 0; i < num_shell_builtins; i++)\n    {\n      b = builtins[i];\n\n      fname = (char *)b.handle;\n      helpfile = (char *)malloc (hdlen + strlen (fname) + 1);\n      if (helpfile == 0)\n\t{\n\t  fprintf (stderr, \"gen-helpfiles: cannot allocate memory\\n\");\n\t  exit (1);\n\t}\n      sprintf (helpfile, \"helpfiles/%s\", fname);\n\n      helpfp = fopen (helpfile, \"w\");\n      if (helpfp == 0)\n\t{\n\t  fprintf (stderr, \"write_helpfiles: cannot open %s\\n\", helpfile);\n\t  free (helpfile);\n\t  continue;\n\t}\n\n      write_documentation (helpfp, b.long_doc[0], 4);\n\n      fflush (helpfp);\n      fclose (helpfp);\n      free (helpfile);\n    }\n  return 0;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}