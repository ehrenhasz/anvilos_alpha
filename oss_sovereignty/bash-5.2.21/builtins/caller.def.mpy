{
  "module_name": "caller.def",
  "hash_id": "5331f9ddd365c821ad24ef6357273b955a7b952bb91f4441084c1bf3b6bf383b",
  "original_prompt": "Ingested from bash-5.2.21/builtins/caller.def",
  "human_readable_source": "This file is caller.def, from which is created caller.c.  It implements the\nbuiltin \"caller\" in Bash.\n\nCopyright (C) 2002-2008 Rocky Bernstein for Free Software Foundation, Inc.\nCopyright (C) 2008-2019 Free Software Foundation, Inc.\n\nThis file is part of GNU Bash, the Bourne Again SHell.\n\nBash is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nBash is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with Bash.  If not, see <http://www.gnu.org/licenses/>.\n\n$PRODUCES caller.c\n\n$BUILTIN caller\n$FUNCTION caller_builtin\n$DEPENDS_ON DEBUGGER\n$SHORT_DOC caller [expr]\nReturn the context of the current subroutine call.\n\nWithout EXPR, returns \"$line $filename\".  With EXPR, returns\n\"$line $subroutine $filename\"; this extra information can be used to\nprovide a stack trace.\n\nThe value of EXPR indicates how many call frames to go back before the\ncurrent one; the top frame is frame 0.\n\nExit Status:\nReturns 0 unless the shell is not executing a shell function or EXPR\nis invalid.\n$END\n\n#include <config.h>\n#include <stdio.h>\n#include \"chartypes.h\"\n#include \"bashtypes.h\"\n\n#if defined (HAVE_UNISTD_H)\n#  ifdef _MINIX\n#    include <sys/types.h>\n#  endif\n#  include <unistd.h>\n#endif\n\n#include <errno.h>\n\n#include \"../bashintl.h\"\n\n#include \"../shell.h\"\n#include \"common.h\"\n#include \"builtext.h\"\n#include \"bashgetopt.h\"\n\n#ifdef LOADABLE_BUILTIN\n#  include \"builtins.h\"\n#endif\n\n#if !defined (errno)\nextern int errno;\n#endif /* !errno */\n\nint\ncaller_builtin (list)\n     WORD_LIST *list;\n{\n#if !defined (ARRAY_VARS)\n  printf (\"1 NULL\\n\");\n  return (EXECUTION_FAILURE);\n#else\n  SHELL_VAR *funcname_v, *bash_source_v, *bash_lineno_v;\n  ARRAY *funcname_a, *bash_source_a, *bash_lineno_a;\n  char *funcname_s, *source_s, *lineno_s;\n  intmax_t num;\n\n  CHECK_HELPOPT (list);\n\n  GET_ARRAY_FROM_VAR (\"FUNCNAME\", funcname_v, funcname_a);\n  GET_ARRAY_FROM_VAR (\"BASH_SOURCE\", bash_source_v, bash_source_a);\n  GET_ARRAY_FROM_VAR (\"BASH_LINENO\", bash_lineno_v, bash_lineno_a);\n\n  if (bash_lineno_a == 0 || array_empty (bash_lineno_a))\n    return (EXECUTION_FAILURE);\n\n  if (bash_source_a == 0 || array_empty (bash_source_a))\n    return (EXECUTION_FAILURE);\n\n if (no_options (list))\n    return (EX_USAGE);\n  list = loptend;       /* skip over possible `--' */\n\n  /* If there is no argument list, then give short form: line filename. */\n  if (list == 0)\n    {\n      lineno_s = array_reference (bash_lineno_a, 0);\n      source_s = array_reference (bash_source_a, 1);\n      printf(\"%s %s\\n\", lineno_s ? lineno_s : \"NULL\", source_s ? source_s : \"NULL\");\n      return (EXECUTION_SUCCESS);\n    }\n  \n  if (funcname_a == 0 || array_empty (funcname_a))\n    return (EXECUTION_FAILURE);\n\n  if (legal_number (list->word->word, &num))\n    {\n      lineno_s = array_reference (bash_lineno_a, num);\n      source_s = array_reference (bash_source_a, num+1);\n      funcname_s = array_reference (funcname_a, num+1);\n\n      if (lineno_s == NULL|| source_s == NULL || funcname_s == NULL)\n\treturn (EXECUTION_FAILURE);\n\n      printf(\"%s %s %s\\n\", lineno_s, funcname_s, source_s);\n    }\n  else\n    {\n      sh_invalidnum (list->word->word);\n      builtin_usage ();\n      return (EX_USAGE);\n    }\n\n  return (EXECUTION_SUCCESS);\n#endif\n}\n\n#ifdef LOADABLE_BUILTIN\nstatic char *caller_doc[] = {\nN_(\"Returns the context of the current subroutine call.\\n\\\n    \\n\\\n    Without EXPR, returns \\\"$line $filename\\\".  With EXPR, returns\\n\\\n    \\\"$line $subroutine $filename\\\"; this extra information can be used to\\n\\\n    provide a stack trace.\\n\\\n    \\n\\\n    The value of EXPR indicates how many call frames to go back before the\\n\\\n    current one; the top frame is frame 0.\"),\n  (char *)NULL\n};\n\nstruct builtin caller_struct = {\n\t\"caller\",\n\tcaller_builtin,\n\tBUILTIN_ENABLED,\n\tcaller_doc,\n\t\"caller [EXPR]\",\n\t0\n};\n\n#endif /* LOADABLE_BUILTIN */\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}