{
  "module_name": "bashbug.sh.in",
  "hash_id": "22b735865ffbbbdfbce2cf034a9c3702912a0871759e1ce1940b05db3cd657f8",
  "original_prompt": "Ingested from bash-5.2.21/support/bashbug.sh.in",
  "human_readable_source": "#!/bin/sh -\n#\n# bashbug - create a bug report and mail it to the bug address\n#\n# The bug address depends on the release status of the shell.  Versions\n# with status `devel', `alpha', `beta', or `rc' mail bug reports to\n# chet.ramey@case.edu and, optionally, to bash-testers@cwru.edu.\n# Other versions send mail to bug-bash@gnu.org.\n#\n# Copyright (C) 1996-2021 Free Software Foundation, Inc.\n#\n#   This program is free software: you can redistribute it and/or modify\n#   it under the terms of the GNU General Public License as published by\n#   the Free Software Foundation, either version 3 of the License, or\n#   (at your option) any later version.\n#\n#   This program is distributed in the hope that it will be useful,\n#   but WITHOUT ANY WARRANTY; without even the implied warranty of\n#   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n#   GNU General Public License for more details.\n#\n#   You should have received a copy of the GNU General Public License\n#   along with this program.  If not, see <http://www.gnu.org/licenses/>.\n\n#\n# configuration section:\n#\tthese variables are filled in by the make target in Makefile\n#\nMACHINE=\"@host_cpu@\"\nOS=\"@host_os@\"\nCC=\"@CC@\"\nCFLAGS=\"@CFLAGS@\"\nRELEASE=\"@BASHVERS@\"\nPATCHLEVEL=\"!PATCHLEVEL!\"\nRELSTATUS=\"@RELSTATUS@\"\nMACHTYPE=\"@host@\"\n\nPATH=/bin:/usr/bin:/usr/local/bin:$PATH\nexport PATH\n\n# Check if TMPDIR is set, default to /tmp\n: ${TMPDIR:=/tmp}\n\n#Securely create a temporary directory for the temporary files\nTEMPDIR=$TMPDIR/bbug.$$\n(umask 077 && mkdir \"$TEMPDIR\") || {\n\techo \"$0: could not create temporary directory\" >&2\n\texit 1\n}\n\nTEMPFILE1=$TEMPDIR/bbug1\nTEMPFILE2=$TEMPDIR/bbug2\n        \nUSAGE=\"Usage: $0 [--help] [--version] [bug-report-email-address]\"\nVERSTR=\"GNU bashbug, version ${RELEASE}.${PATCHLEVEL}-${RELSTATUS}\"\n\ndo_help= do_version=\n\nwhile [ $# -gt 0 ]; do\n\tcase \"$1\" in\n\t--help)\t\tshift ; do_help=y ;;\n\t--version)\tshift ; do_version=y ;;\n\t--)\t\tshift ; break ;;\n\t-*)\t\techo \"bashbug: ${1}: invalid option\" >&2\n\t\t\techo \"$USAGE\" >&2\n\t\t\texit 2 ;;\n\t*)\t\tbreak ;;\n\tesac\ndone\n\nif [ -n \"$do_version\" ]; then\n\techo \"${VERSTR}\"\n\texit 0\nfi\n\nif [ -n \"$do_help\" ]; then\n\techo \"${VERSTR}\"\n\techo \"${USAGE}\"\n\techo\n\tcat << HERE_EOF\nBashbug is used to send mail to the Bash maintainers\nfor when Bash doesn't behave like you'd like, or expect.\n\nBashbug will start up your editor (as defined by the shell's\nEDITOR environment variable) with a preformatted bug report\ntemplate for you to fill in. The report will be mailed to the\nbug-bash mailing list by default. See the manual for details.\n\nIf you invoke bashbug by accident, just quit your editor without\nsaving any changes to the template, and no bug report will be sent.\nHERE_EOF\n\texit 0\nfi\n\n# Figure out how to echo a string without a trailing newline\nN=`echo 'hi there\\c'`\ncase \"$N\" in\n*c)\tn=-n c= ;;\n*)\tn= c='\\c' ;;\nesac\n\nBASHTESTERS=\"bash-testers@cwru.edu\"\n\ncase \"$RELSTATUS\" in\nalpha*|beta*|devel*|rc*)\tBUGBASH=chet.ramey@case.edu ;;\n*)\t\t\t\tBUGBASH=bug-bash@gnu.org ;;\nesac\n\ncase \"$RELSTATUS\" in\nalpha*|beta*|devel*|rc*)\n\t\techo \"$0: This is a testing release.  Would you like your bug report\"\n\t\techo \"$0: to be sent to the bash-testers mailing list?\"\n\t\techo $n \"$0: Send to bash-testers? $c\"\n\t\tread ans\n\t\tcase \"$ans\" in\n\t\ty*|Y*)\tBUGBASH=\"${BUGBASH},${BASHTESTERS}\" ;;\n\t\tesac ;;\nesac\n\nBUGADDR=\"${1-$BUGBASH}\"\n\nif [ -z \"$DEFEDITOR\" ] && [ -z \"$EDITOR\" ]; then\n\tif [ -x /usr/bin/editor ]; then\n\t\tDEFEDITOR=editor\n\telif [ -x /usr/local/bin/ce ]; then\n\t\tDEFEDITOR=ce\n\telif [ -x /usr/local/bin/emacs ]; then\n\t\tDEFEDITOR=emacs\n\telif [ -x /usr/contrib/bin/emacs ]; then\n\t\tDEFEDITOR=emacs\n\telif [ -x /usr/bin/emacs ]; then\n\t\tDEFEDITOR=emacs\n\telif [ -x /usr/bin/xemacs ]; then\n\t\tDEFEDITOR=xemacs\n\telif [ -x /usr/bin/vim; then\n\t\tDEFEDITOR=vim\n\telif [ -x /usr/bin/gvim; then\n\t\tDEFEDITOR=gvim\n\telif [ -x /usr/bin/nano ]; then\n\t\tDEFEDITOR=nano\n\telif [ -x /usr/contrib/bin/jove ]; then\n\t\tDEFEDITOR=jove\n\telif [ -x /usr/local/bin/jove ]; then\n\t\tDEFEDITOR=jove\n\telif [ -x /usr/bin/vi ]; then\n\t\tDEFEDITOR=vi\n\telse\n\t\techo \"$0: No default editor found: attempting to use vi\" >&2\n\t\tDEFEDITOR=vi\n\tfi\nfi\n\n\n: ${EDITOR=$DEFEDITOR}\n\n: ${USER=${LOGNAME-`whoami`}}\n\ntrap 'rm -rf \"$TEMPDIR\"; exit 1' 1 2 3 13 15\ntrap 'rm -rf \"$TEMPDIR\"' 0\n\nUN=\nif (uname) >/dev/null 2>&1; then\n\tUN=`uname -a`\nfi\n\nif [ -f /usr/lib/sendmail ] ; then\n\tRMAIL=\"/usr/lib/sendmail\"\n\tSMARGS=\"-i -t\"\nelif [ -f /usr/sbin/sendmail ] ; then\n\tRMAIL=\"/usr/sbin/sendmail\"\n\tSMARGS=\"-i -t\"\nelse\n\tRMAIL=rmail\n\tSMARGS=\"$BUGADDR\"\nfi\n\nINITIAL_SUBJECT='[50 character or so descriptive subject here (for reference)]'\n\ncat > \"$TEMPFILE1\" <<EOF\nFrom: ${USER}\nTo: ${BUGADDR}\nSubject: ${INITIAL_SUBJECT}\n\nConfiguration Information [Automatically generated, do not change]:\nMachine: $MACHINE\nOS: $OS\nCompiler: $CC\nCompilation CFLAGS: $CFLAGS\nuname output: $UN\nMachine Type: $MACHTYPE\n\nBash Version: $RELEASE\nPatch Level: $PATCHLEVEL\nRelease Status: $RELSTATUS\n\nDescription:\n\t[Detailed description of the problem, suggestion, or complaint.]\n\nRepeat-By:\n\t[Describe the sequence of events that causes the problem\n\tto occur.]\n\nFix:\n\t[Description of how to fix the problem.  If you don't know a\n\tfix for the problem, don't include this section.]\nEOF\n\ncp \"$TEMPFILE1\" \"$TEMPFILE2\"\nchmod u+w \"$TEMPFILE1\"\n\ntrap '' 2\t\t# ignore interrupts while in editor\n\nedstat=1\nwhile [ $edstat -ne 0 ]; do\n\t$EDITOR \"$TEMPFILE1\"\n\tedstat=$?\n\n\tif [ $edstat -ne 0 ]; then\n\t\techo \"$0: editor \\`$EDITOR' exited with nonzero status.\"\n\t\techo \"$0: Perhaps it was interrupted.\"\n\t\techo \"$0: Type \\`y' to give up, and lose your bug report;\"\n\t\techo \"$0: type \\`n' to re-enter the editor.\"\n\t\techo $n \"$0: Do you want to give up? $c\"\n\n\t\tread ans\n\t\tcase \"$ans\" in\n\t\t[Yy]*) exit 1 ;;\n\t\tesac\n\n\t\tcontinue\n\tfi\n\n\t# find the subject from the temp file and see if it's been changed\n\tCURR_SUB=`grep '^Subject: ' \"$TEMPFILE1\" | sed 's|^Subject:[ \t]*||' | sed 1q`\n\n\tcase \"$CURR_SUB\" in\n\t\"${INITIAL_SUBJECT}\")\n\t\techo\n\t\techo \"$0: You have not changed the subject from the default.\"\n\t\techo \"$0: Please use a more descriptive subject header.\"\n\t\techo \"$0: Type \\`y' to give up, and lose your bug report;\"\n\t\techo \"$0: type \\`n' to re-enter the editor.\"\n\t\techo $n \"$0: Do you want to give up? $c\"\n\n\t\tread ans\n\t\tcase \"$ans\" in\n\t\t[Yy]*) exit 1 ;;\n\t\tesac\n\n\t\techo \"$0:  The editor will be restarted in five seconds.\"\n\t\tsleep 5\n\t\tedstat=1\n\t\t;;\n\tesac\n\ndone\n\ntrap 'rm -rf \"$TEMPDIR\"; exit 1' 2\t# restore trap on SIGINT\n\nif cmp -s \"$TEMPFILE1\" \"$TEMPFILE2\"\nthen\n\techo \"File not changed, no bug report submitted.\"\n\texit\nfi\n\necho $n \"Send bug report to ${BUGADDR}? [y/n] $c\"\nread ans\ncase \"$ans\" in\n[Nn]*)\texit 0 ;;\nesac\n\n${RMAIL} $SMARGS < \"$TEMPFILE1\" || {\n\tcat \"$TEMPFILE1\" >> $HOME/dead.bashbug\n\techo \"$0: mail to ${BUGADDR} failed: report saved in $HOME/dead.bashbug\" >&2\n\techo \"$0: please send it manually to ${BUGADDR}\" >&2\n}\n\nexit 0\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}