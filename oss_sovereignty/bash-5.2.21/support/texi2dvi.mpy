{
  "module_name": "texi2dvi",
  "hash_id": "0f0a456c939940453e30668f23f5dbf9151d56088117ef03eec817d3e229f29d",
  "original_prompt": "Ingested from bash-5.2.21/support/texi2dvi",
  "human_readable_source": "#! /bin/sh\n# texi2dvi --- produce DVI (or PDF) files from Texinfo (or (La)TeX) sources.\n#\n# Copyright 1992-2019 Free Software Foundation, Inc.\n#\n# This program is free software; you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation; either version 3 of the License,\n# or (at your option) any later version.\n#\n# This program is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with this program.  If not, see <http://www.gnu.org/licenses/>.\n#\n# Originally written by Noah Friedman.\n#\n# Please send bug reports, etc. to bug-texinfo@gnu.org.\n# If possible, please send a copy of the output of the script called with\n# the `--debug' option when making a bug report.\n\ntest -f /bin/ksh && test -z \"$RUNNING_KSH\" \\\n  && { UNAMES=`uname -s`; test \"x$UNAMES\" = xULTRIX; } 2>/dev/null \\\n  && { RUNNING_KSH=true; export RUNNING_KSH; exec /bin/ksh $0 ${1+\"$@\"}; }\nunset RUNNING_KSH\n\n# No failure shall remain unpunished.\nset -e\n\n# In case the default sed doesn't suffice.\n: ${SED=sed}\n\nprogram=`echo $0 | $SED -e 's!.*/!!'`\n\nbuild_mode=${TEXI2DVI_BUILD_MODE:-local}\nbuild_dir=${TEXI2DVI_BUILD_DIRECTORY:-.}\n\norig_pwd=`pwd`\n\n# Initialize variables for option overriding and otherwise.\n# Don't use `unset' since old bourne shells don't have this command.\n# Instead, assign them an empty value.\naction=compile\ndebug=false\nescape=\"\\\\\"\nexpand=false    # true for expansion via makeinfo\nincludes=\nline_error=true # pass --file-line-error to TeX\nmax_iters=7     # when to quit\noname=          # --output\nout_lang=dvi\nquiet=false     # let the tools' message be displayed\nset_language=\nsrc_specials=\nshell_escape=\nlatex2html=hevea  # or set to tex4ht\ntextra=         # Extra TeX commands to insert in the input file.\ntxiprereq=19990129 # minimum texinfo.tex version with macro expansion\nverb=false      # true for verbose mode\ntranslate_file= # name of charset translation file\n\n# We have to initialize IFS to space tab newline since we save and\n# restore IFS and apparently POSIX allows stupid/broken behavior with\n# empty-but-set IFS.\n# http://lists.gnu.org/archive/html/automake-patches/2006-05/msg00008.html\n# We need space, tab and newline, in precisely that order.  And don't leave\n# trailing blanks.\nspace=' '\ntab='\t'\nnewline='\n'\nIFS=\"$space$tab$newline\"\n\n: ${EGREP=egrep}\n\n# Systems which define $COMSPEC or $ComSpec use semicolons to separate\n# directories in TEXINPUTS -- except for Cygwin and Msys, where COMSPEC\n# might be inherited, but : is used.\n\n# In the case of Msys, uname returns a value derived from MSYSTEM, as\n# MSYSTEM is user configurable, it is not so safe to use it to detect\n# Msys. It is safer to use OSTYPE, this is why we set MSYSTEM to\n# $OSTYPE before calling uname\nif test -n \"$COMSPEC$ComSpec\" \\\n   && MSYSTEM=$OSTYPE uname | $EGREP -iv 'cygwin|msys' >/dev/null; then\n  path_sep=\";\"\nelse\n  path_sep=\":\"\nfi\n\n\n# Pacify verbose cds.\nCDPATH=${ZSH_VERSION+.}$path_sep\n\n\n# Now we define numerous functions, with no other executable code.\n# The main program is at the end of the file.\n\n\t\n# \f Standard help and version functions.\n#\n# usage - display usage and exit successfully.\nusage ()\n{\n  cat <<EOF\nUsage: $program [OPTION]... FILE...\n  or:  texi2pdf [OPTION]... FILE...\n  or:  pdftexi2dvi [OPTION]... FILE...\n\nRun each Texinfo or (La)TeX FILE through TeX in turn until all\ncross-references are resolved, building all indices.  The directory\ncontaining each FILE is searched for included files.  The suffix of FILE\nis used to determine its language ((La)TeX or Texinfo).  To process\n(e)plain TeX files, set the environment variable LATEX=tex.\n\nWhen invoked as \\`texi2pdf' or given the option --pdf generate PDF output.\nOtherwise, generate DVI.\n\nGeneral options:\n  -D, --debug         turn on shell debugging (set -x)\n  -h, --help          display this help and exit successfully\n  -o, --output=OFILE  leave output in OFILE; only one input FILE is allowed\n  -q, --quiet         no output unless errors\n  -v, --version       display version information and exit successfully\n  -V, --verbose       report on what is done\n  --max-iterations=N  don't process files more than N times [$max_iters]\n  --mostly-clean      remove auxiliary files or directories from\n                          previous runs (but not the output)\n\nOutput format:\n      --dvi     output a DVI file [default]\n      --dvipdf  output a PDF file via DVI (using a dvi-to-pdf program)\n      --html    output an HTML file from LaTeX, using HeVeA\n      --info    output an Info file from LaTeX, using HeVeA\n  -p, --pdf     use pdftex or pdflatex for processing\n      --ps      output a PostScript file via DVI (using dvips)\n      --text    output a plain text file from LaTeX, using HeVeA\n\nTeX tuning:\n  -E, --expand               macro expansion using makeinfo\n  -I DIR                     search DIR for Texinfo files\n  -l, --language=LANG        specify LANG for FILE, either latex or texinfo\n      --no-line-error        do not pass --file-line-error to TeX\n      --shell-escape         pass --shell-escape to TeX\n      --src-specials         pass --src-specials to TeX\n      --translate-file=FILE  use given charset translation file for TeX\n  -t, --command=CMD          insert CMD in copy of input file\n\nBuild modes:\n  --build=MODE         specify the treatment of auxiliary files [$build_mode]\n      --tidy           same as --build=tidy\n  -c, --clean          same as --build=clean\n      --build-dir=DIR  specify where the tidy compilation is performed;\n                         implies --tidy;\n                         defaults to TEXI2DVI_BUILD_DIRECTORY [$build_dir]\n\nThe MODE specifies where the TeX compilation takes place, and, as a\nconsequence, how auxiliary files are treated.  The build mode can also\nbe set using the environment variable TEXI2DVI_BUILD_MODE.\n\nValid values of MODE are:\n  \\`local'      compile in the current directory, leaving all the auxiliary\n               files around.  This is the traditional TeX use.\n  \\`tidy'       compile in a local *.t2d directory, where the auxiliary files\n               are left.  Output files are copied back to the original file.\n  \\`clean'      same as \\`tidy', but remove the auxiliary directory afterwards.\n               Every compilation therefore requires the full cycle.\n\nThe values of these environment variables are used to run the\ncorresponding commands, if they are set:\n\n  BIBER BIBTEX DVIPDF DVIPS EGREP HEVEA LATEX MAKEINDEX MAKEINFO\n  PDFLATEX PDFTEX SED T4HT TEX TEX4HT TEXINDEX TEXINDY THUMBPDF_CMD\n\nRegarding --dvipdf, if DVIPDF is not set in the environment, the\nfollowing programs are looked for (in this order): dvipdfmx dvipdfm\ndvipdf dvi2pdf dvitopdf.\n\nIf Texinfo is installed on your site, then the command\n\n  info texi2dvi\n  \nshould give you access to more documentation.\n\nReport bugs to bug-texinfo@gnu.org,\ngeneral questions and discussion to help-texinfo@gnu.org.\nGNU Texinfo home page: <http://www.gnu.org/software/texinfo/>\nGeneral help using GNU software: <http://www.gnu.org/gethelp/>\nEOF\n  exit 0\n}\n\n\n# version - Display version info and exit successfully.\nversion ()\n{\n  cat <<EOF\ntexi2dvi (GNU Texinfo 6.7)\n\nCopyright (C) 2019 Free Software Foundation, Inc.\nLicense GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.html>\nThis is free software: you are free to change and redistribute it.\nThere is NO WARRANTY, to the extent permitted by law.\nEOF\n  exit 0\n}\n\n\n# \f Generic auxiliary functions.\n\n# Used to access files and directories after we have changed directory\n# (for --tidy).\nrel=\n\n# Change directory, updating some relative paths.\ncd_dir ()\n{\n  cd \"$1\"\n\n  # Check if argument or input file is absolute, and if so, make all the path \n  # variables absolute.\n  use_absolute=false\n  case $1 in\n  [\\\\/]* | ?:[\\\\/]*)  # absolute path\n    use_absolute=true ;;\n  esac\n  case $in_input in\n  [\\\\/]* | ?:[\\\\/]*)\n    use_absolute=true ;;\n  esac\n\n  if $use_absolute ; then\n    for cdd_dir in work_build workdir t2ddir work_bak in_input in_dir; do\n      eval \"$cdd_dir=\\`absolute \\$$cdd_dir\\`\"\n    done\n    return\n  fi\n\n  # Replace each path component with \"..\" and add a single trailing slash.\n  rel=`echo \"$1\" | \\$SED -e 's/[^/\\\\][^/\\\\]*/../g' -e 's/[/\\\\]*$/\\//'`\n}\n\n# cd_orig - Return to the original directory.\ncd_orig ()\n{\n  # In case $orig_pwd is on a different drive (for DOS).\n  cd /\n\n  # Return to the original directory so that\n  # - the next file is processed in correct conditions\n  # - the temporary file can be removed\n  cd \"$orig_pwd\" || exit 1\n\n  rel=\n}\n\n\n# func_dirname FILE - Return the directory part of FILE.\nfunc_dirname ()\n{\n  dirname \"$1\" 2>/dev/null \\\n  || { echo \"$1\" | $SED 's!/[^/]*$!!;s!^$!.!'; }\n}\n\n\n# noext FILE - Return FILE with one extension removed:\n#   foo.bar.baz -> foo.bar\nnoext ()\n{\n  echo \"$1\" | $SED -e 's/\\.[^/.][^/.]*$//'\n}\n\n\n# absolute NAME - Return an absolute path to NAME.\nabsolute ()\n{\n  case $1 in\n   [\\\\/]* | ?:[\\\\/]*)\n      # Absolute paths don't need to be expanded.\n      echo \"$1\"\n      ;;\n   *) absolute_slashes=`echo \"$1\" | $SED -n 's,.*[^/]\\(/*\\)$,\\1,p'`\n      absolute_rel=$orig_pwd/`func_dirname \"$1\"`\n      if test -d \"$absolute_rel\"; then\n        (cd \"$absolute_rel\" 2>/dev/null \\\n         && absolute_name=`pwd`/`basename \"$1\"`\"$absolute_slashes\"\n         echo \"$absolute_name\")\n      else\n        error 1 \"not a directory: $absolute_rel\"\n      fi\n      ;;\n  esac\n}\n\n\n# ensure_dir DIR1 DIR2... - Make sure given directories exist.\nensure_dir ()\n{\n  for dir\n  do\n    # Beware that in parallel builds we may have several concurrent\n    # attempts to create the directory.  So fail only if \"mkdir\"\n    # failed *and* the directory still does not exist.\n    test -d \"$dir\" \\\n      || mkdir \"$dir\" \\\n      || test -d \"$dir\" \\\n      || error 1 \"cannot create directory: $dir\"\n  done\n}\n\n\n# error EXIT_STATUS LINE1 LINE2... - Report an error and exit with\n#   failure if EXIT_STATUS is non-null.\nerror ()\n{\n  error_status=\"$1\"\n  shift\n  report \"$@\"\n  if test \"$error_status\" != 0; then\n    exit $error_status\n  fi\n}\n\n\n# findprog PROG - Return true if PROG is somewhere in PATH, else false.\nfindprog ()\n{\n  saveIFS=\"$IFS\"\n  IFS=$path_sep  # break path components at the path separator\n  for dir in $PATH; do\n    IFS=$saveIFS\n    # The basic test for an executable is `test -f $f && test -x $f'.\n    # (`test -x' is not enough, because it can also be true for directories.)\n    # We have to try this both for $1 and $1.exe.\n    #\n    # Note: On Cygwin and DJGPP, `test -x' also looks for .exe.  On Cygwin,\n    # also `test -f' has this enhancement, but not on DJGPP.  (Both are\n    # design decisions, so there is little chance to make them consistent.)\n    # Thusly, it seems to be difficult to make use of these enhancements.\n    #\n    if   { test -f \"$dir/$1\"     && test -x \"$dir/$1\"; } \\\n      || { test -f \"$dir/$1.exe\" && test -x \"$dir/$1.exe\"; }; then\n      return 0\n    fi\n  done\n  return 1\n}\n\n# report LINE1 LINE2... - Echo each argument to stderr.\nreport ()\n{\n  for i in \"$@\"\n  do\n    echo >&2 \"$0: $i\"\n  done\n}\n\n\n# run COMMAND-LINE - Run COMMAND-LINE verbosely, catching errors as failures.\nrun ()\n{\n  verbose \"Running $@\"\n  \"$@\" 2>&5 1>&2 \\\n  || error 1 \"$1 failed\"\n}\n\n\n# verbose WORD1 WORD2... - Echo concatenated WORDs to stderr, if $verb.\nverbose ()\n{\n  if $verb; then\n    echo >&2 \"$0: $@\"\n  fi\n}\n\n\n# \f Handling lists.\n#\n# list_append LIST-NAME ELEM - Append ELEM to (the contents of) LIST-NAME.\nlist_append ()\n{\n  list_name=\"$1\"\n  shift\n  eval set X \\$$list_name \"$@\"\n  shift\n  eval $list_name=\\\"\"$@\"\\\"\n}\n\n\n# list_concat_dirs LIST-NAME DIR-LIST - Append to LIST-NAME all the\n# components (including empty ones) from the $path_sep-separated list\n# DIR-LIST.  Make the paths absolute.\nlist_concat_dirs ()\n{\n  lcd_list=\"$1\"\n  # Empty path components are meaningful to tex.  We rewrite them as\n  # `EMPTY' so they don't get lost when we split on $path_sep.\n  # Hopefully no one will have an actual directory named EMPTY.\n  lcd_replace_EMPTY=\"-e 's/^$path_sep/EMPTY$path_sep/g' \\\n                     -e 's/$path_sep\\$/${path_sep}EMPTY/g' \\\n                     -e 's/$path_sep$path_sep/${path_sep}EMPTY${path_sep}/g'\"\n  save_IFS=$IFS\n  IFS=$path_sep\n  set x `echo \"$2\" | eval $SED $lcd_replace_EMPTY`; shift\n  IFS=$save_IFS\n  for lcd_dir\n  do\n    case $lcd_dir in\n      EMPTY)\n       list_append $lcd_list \"\"\n       ;;\n      *)\n       if test -d $lcd_dir; then\n          dir=`absolute \"$lcd_dir\"`\n         list_append $lcd_list \"$lcd_dir\"\n       fi\n       ;;\n    esac\n  done\n}\n\n\n# list_prefix LIST-NAME SEP -> STRING - Return string with each element\n# of LIST-NAME preceded by SEP.\nlist_prefix ()\n{\n  lp_separator=\"$2\"\n  eval set X \\$$1\n  shift\n  lp_result=''\n  for i\n  do\n    lp_result=\"$lp_result \\\"$lp_separator\\\" \\\"$i\\\"\"\n  done\n  echo \"$lp_result\"\n}\n\n# list_infix LIST-NAME SEP -> STRING - Same as list_prefix, but a separator.\nlist_infix ()\n{\n  eval set X \\$$1\n  shift\n  save_IFS=\"$IFS\"\n  IFS=$path_sep\n  echo \"$*\"\n  IFS=$save_IFS\n}\n\n# list_dir_to_abs LIST-NAME - Convert list to using only absolute dir names.\n# Currently unused, but should replace absolute_filenames some day.\nlist_dir_to_abs ()\n{\n  ldta_list=\"$1\"\n  eval set X \\$$ldta_list\n  shift\n  ldta_result=''\n  for dir\n  do\n    dir=`absolute \"$dir\"`\n    test -d \"$dir\" || continue\n    ldta_result=\"$ldata_result \\\"$dir\\\"\"\n  done\n  set X $ldta_result; shift\n  eval $ldta_list=\\\"$@\\\"\n}\n\n\n# \f Language auxiliary functions. \n#\n# out_lang_set LANG - set $out_lang to LANG (dvi, pdf, etc.), or error.\nout_lang_set ()\n{\n  case $1 in\n    dvi|dvipdf|html|info|pdf|ps|text) out_lang=$1;;\n    *) error 1 \"invalid output format: $1\";;\n  esac\n}\n\n# out_lang_tex - Return the tex output language (DVI or PDF) for $out_lang.\nout_lang_tex ()\n{\n  case $out_lang in\n    dvi | ps | dvipdf ) echo dvi;;\n    pdf ) echo $out_lang;;\n    html | info | text ) echo $out_lang;;\n    *)    error 1 \"invalid out_lang: $1\";;\n  esac\n}\n\n# out_lang_ext - Return the extension for $out_lang (pdf, dvi, etc.).\nout_lang_ext ()\n{\n  case $out_lang in\n    dvipdf ) echo pdf;;\n    dvi | html | info | pdf | ps | text ) echo $out_lang;;\n    *)    error 1 \"invalid out_lang: $1\";;\n  esac\n}\n\n\n# \f TeX file auxiliary functions.\n#\n# absolute_filenames TEX-PATH -> TEX-PATH - Convert relative paths to\n# absolute, so we can run in another directory (e.g., in tidy build\n# mode, or during the macro-support detection).\nabsolute_filenames ()\n{\n  # Empty path components are meaningful to tex.  We rewrite them as\n  # `EMPTY' so they don't get lost when we split on $path_sep.\n  # Hopefully no one will have an actual directory named EMPTY.\n  af_replace_empty=\"-e 's/^$path_sep/EMPTY$path_sep/g' \\\n                    -e 's/$path_sep\\$/${path_sep}EMPTY/g' \\\n                    -e 's/$path_sep$path_sep/${path_sep}EMPTY${path_sep}/g'\"\n  af_result=`echo \"$1\" | eval $SED $af_replace_empty`\n  save_IFS=$IFS\n  IFS=$path_sep\n  set x $af_result; shift\n  af_result=\n  af_path_sep=\n  for dir\n  do\n    case $dir in\n      EMPTY)\n        af_result=$af_result$af_path_sep\n        ;;\n      *)\n        if test -d \"$dir\"; then\n          af_result=$af_result$af_path_sep`absolute \"$dir\"`\n        else\n          # Even if $dir is not a directory, preserve it in the path.\n          # It might contain metacharacters that TeX will expand in\n          # turn, e.g., /some/path/{a,b,c}.  This will not get the\n          # implicit absolutification of the path, but we can't help that.\n          af_result=$af_result$af_path_sep$dir\n        fi\n        ;;\n    esac\n    af_path_sep=$path_sep\n  done\n  echo \"$af_result\"\n}\n\n\n# output_base_name FILE - Return the name of FILE, possibly renamed to\n# satisfy --output.  FILE is local, i.e., without any directory part.\noutput_base_name ()\n{\n  case $oname in\n    '') echo \"$1\";;\n     *) obn_out_noext=`noext \"$oname\"`\n        obn_file_ext=`echo \"$1\" | $SED 's/^.*\\.//'`\n        echo \"$obn_out_noext.$obn_file_ext\"\n      ;;\n  esac\n}\n\n\n# destdir - Return the directory where the output is expected.\ndestdir ()\n{\n  case $oname in\n    '')  echo \"$orig_pwd\";;\n    *)   dirname \"$oname\";;\n  esac\n}\n\n\n# move_to_dest FILE... - Move FILE(s) to the place where the user expects.\n# Truly move it, that is, it must not remain in its build location\n# unless that is also the output location.  (Otherwise it might appear\n# as an extra file in make distcheck.)\n#\n# FILE can be the principal output (in which case -o directly applies),\n# or an auxiliary file with the same base name.\nmove_to_dest ()\n{\n#  echo \"move_to_dest $*, tidy=$tidy, oname=$oname\"\n\n  # If we built in place and have no output name, there is nothing to\n  # do, so just return.\n  case $tidy:$oname in\n    false:) return;;\n  esac\n\n  for file\n  do\n    test -f \"$file\" \\\n    || error 1 \"no such file or directory: $file\"\n    case $tidy:$oname in\n      true:)  mtd_destdir=$orig_pwd\n              mtd_destfile=$mtd_destdir/$file;;\n      true:*) mtd_destfile=`output_base_name \"$file\"`\n              mtd_destdir=`dirname \"$mtd_destfile\"`;;\n      false:*) mtd_destfile=$oname\n               mtd_destdir=`dirname \"$mtd_destfile\"`;;\n    esac\n \n    # We want to compare the source location and the output location,\n    # and if they are different, do the move.  But if they are the\n    # same, we must preserve the source.  Since we can't assume\n    # stat(1) or test -ef is available, resort to comparing the\n    # directory names, canonicalized with pwd.  We can't use cmp -s\n    # since the output file might not actually change from run to run;\n    # e.g., TeX DVI output is timestamped to only the nearest minute.\n    mtd_destdir=`cd \"$mtd_destdir\" && pwd`\n    mtd_destbase=`basename \"$mtd_destfile\"`\n\n    mtd_sourcedir=`dirname \"$file\"`\n    mtd_sourcedir=`cd \"$mtd_sourcedir\" && pwd`\n    mtd_sourcebase=`basename \"$file\"`\n\n    if test \"$mtd_sourcedir/$mtd_sourcebase\" != \"$mtd_destdir/$mtd_destbase\"\n    then\n      verbose \"Moving $file to $mtd_destfile\"\n      rm -f \"$mtd_destfile\"\n      mv \"$file\" \"$mtd_destfile\"\n    fi\n  done\n}\n\n\n# \f Managing xref files.\n#\n# aux_file_p FILE - Echo FILE if FILE is an aux file.\naux_file_p ()\n{\n  test -f \"$1\" || return 0\n  case $1 in\n    *.aux) echo \"$1\";;\n    *)     return 0;;\n  esac\n}\n\n# bibaux_file_p FILE - Echo FILE if FILE contains citation requests.\nbibaux_file_p ()\n{\n  test -s \"$1\" || return 0\n  if (grep '^\\\\bibstyle[{]' \"$1\"   \\\n      && grep '^\\\\bibdata[{]' \"$1\" \\\n      ## The following line is suspicious: fails when there\n      ## are citations in sub aux files.  We need to be\n      ## smarter in this case.\n      ## && grep '^\\\\citation[{]' \"$f\"\n      ) >&6 2>&1;\n  then\n    echo \"$1\"\n  fi\n  return 0\n}\n\n# index_file_p FILE - Echo FILE if FILE is an index file.\nindex_file_p ()\n{\n  test -f \"$1\" || return 0\n  case $in_lang:$latex2html:`out_lang_tex`:`$SED '1q' \"$1\"` in\n    # When working with TeX4HT, *.idx are created by LaTeX.  They must\n    # be processed to produce *.4ix, *.4dx files.  The *.4dx file is\n    # passed to makeindex to produce the *.ind file.  This sequence is\n    # handled by run_index, so we are only interested in the *.idx\n    # files, which have each \"\\indexentry\" preceded by a\n    # \"\\beforeentry\".\n    latex:tex4ht:html:\"\\\\beforeentry {\"*) echo $1;;\n\n    # When index.sty is used, there is a space before the brace.\n    latex:*:*:\"\\\\indexentry{\"*|latex:*:*:\"\\\\indexentry {\"*) echo $1;;\n\n    texinfo:*:*:\"\\\\entry{\"*) echo $1;;\n    texinfo:*:*:\"@entry{\"*) echo $1;;\n    # @entry is output from newer versions of texinfo.tex\n  esac\n  return 0\n}\n\n########### not used currently\n# xref_file_p FILE - Return success if FILE is an xref file (indexes,\n# tables and lists).\nxref_file_p ()\n{\n  test -f \"$1\" || return 1\n  # If the file is not suitable to be an index or xref file, don't\n  # process it.  It's suitable if the first character is a\n  # backslash or right quote or at, as long as the first line isn't\n  # \\input texinfo.\n  case `$SED '1q' \"$1\"` in\n    \"\\\\input texinfo\"*) return 1;;\n    [\\\\''@]*)           return 0;;\n           *)           return 1;;\n  esac\n}\n\n\n# Used in generated_files_get\ngenerated_files_get_from_log ()\n{\n  if test -f \"$1.log\"; then\n    # Usually the output is like: \\openout1 = `foobar.tex'.\n    # (including the final period)\n    # but luatex outputs: \\openout1 = foobar.tex\n    # (no quotes, no period).\n    # So we have to make the punctuation optional.\n    grep '^\\\\openout[0-9]' \"$1.log\" \\\n      | $SED -e \"s/\\\\\\\\openout[^=]*= *[\\`']*//\" \\\n           -e \"s/'\\.$//\"\n  fi\n}\n\n# Used in generated_files_get\ngenerated_files_get_from_fls ()\n{\n  if test -f \"$1.fls\"; then\n    grep '^OUTPUT ' \"$1.fls\" | cut -b 8- \\\n      | grep -v '\\.dvi$' | grep -v '\\.log$' | grep -v '\\.pdf$' || true\n  fi\n}\n\n# generated_files_get - Output the list of files generated by the TeX \n#                       compilation.\ngenerated_files_get ()\n{\n  $generated_files_get_method \"$in_noext\"\n  if test $generated_files_get_method = generated_files_get_from_fls; then\n    if test -r \"$in_noext.fl\"; then\n      report 'WARNING!!  The fl index may typeset as garbage!' # goes to stderr\n      report 'Try upgrading your version of texinfo.tex, or else try setting'\n      report 'the environment variable TEXI2DVI_USE_RECORDER to '\\''no'\\''.'\nreport 'Once you'\\''ve done that, delete the file with an '\\''fl'\\'' extension.'\n    fi\n  fi\n}\n\n\n# xref_files_save - set xref_files_orig from xref_files_new, and save xref \n#                   files in $work_bak.\nxref_files_save ()\n{\n  # Save copies of auxiliary files for later comparison.\n  xref_files_orig=$xref_files_new\n  if test -n \"$xref_files_orig\"; then\n    verbose \"Backing up xref files: $xref_files_orig\"\n    # The following line improves `cp $xref_files_orig \"$work_bak\"'\n    # by preserving the directory parts.  Think of\n    # cp chap1/main.aux chap2/main.aux $work_bak.\n    #\n    # Users may have, e.g., --keep-old-files.  Don't let this interfere.\n    # (Don't use unset for the sake of ancient shells.)\n    TAR_OPTIONS=; export TAR_OPTIONS\n    tar cf - $xref_files_orig | (cd \"$rel$work_bak\" && tar xf -)\n  fi\n\n  # Remove auxiliary files in same directory as main input file.  Otherwise,\n  # these will likely be read instead of those in the build dir.\n  if $tidy ; then\n    secondary_xref_files=`sorted_index_files`\n    for f in $xref_files_new $secondary_xref_files ; do\n      if test -f \"$rel$in_dir/$f\" ; then\n        remove $rel$in_dir/$f\n      fi\n    done\n  fi\n}\n\n\n# xref_files_changed - Return success if the xref files have changed\n# since the previous run.\nxref_files_changed ()\n{\n  # LaTeX (and the package changebar) report in the LOG file if it\n  # should be rerun.  This is needed for files included from\n  # subdirs, since texi2dvi does not try to compare xref files in\n  # subdirs.  Performing xref files test is still good since LaTeX\n  # does not report changes in xref files.\n  if grep \"Rerun to get\" \"$in_noext.log\" >&6 2>&1; then\n    return 0\n  fi\n  # Similarly, check for biblatex report of whether rerunning is needed.\n  if grep \"biblatex.*(re)run\" \"$in_noext.log\" >&6 2>&1; then\n    return 0\n  fi\n\n  # If old and new lists don't have the same file list,\n  # then something has definitely changed.\n  xref_files_new=`generated_files_get`\n  verbose \"Original xref files = $xref_files_orig\"\n  verbose \"New xref files      = $xref_files_new\"\n  if test \"x$xref_files_orig\" != \"x$xref_files_new\"; then\n    return 0\n  fi\n\n  # Compare each file until we find a difference.\n  for this_file in $xref_files_new; do\n    verbose \"Comparing xref file `echo $this_file | $SED 's|\\./||g'` ...\"\n    # cmp -s returns nonzero exit status if files differ.\n    if cmp -s \"$this_file\" \"$rel$work_bak/$this_file\"; then :; else\n      verbose \"xref file `echo $this_file | $SED 's|\\./||g'` differed ...\"\n      if $debug; then\n        diff -u \"$rel$work_bak/$this_file\" \"$this_file\"\n      fi\n      return 0\n    fi\n  done\n\n  secondary_xref_files=`sorted_index_files`\n  verbose \"Secondary xref files = $secondary_xref_files\"\n  for this_file in $secondary_xref_files; do\n    if test -f $this_file; then :; else\n      verbose \"$this_file missing ...\"\n      return 0\n    fi\n  done\n\n  # No change.\n  return 1\n}\n\n# \f Running the TeX suite.\n#\n# Set tex_cmd variable, for running TeX.\nmake_tex_cmd ()\n{\n  case $in_lang:$latex2html:`out_lang_tex` in\n    latex:*:dvi|latex:tex4ht:html)\n        tex=${LATEX:-latex};;\n    latex:*:pdf)\n        tex=${PDFLATEX:-pdflatex};;\n    texinfo:*:dvi)\n        # MetaPost also uses the TEX environment variable.  If the user\n        # has set TEX=latex for that reason, don't bomb out.\n        case $TEX in\n          *latex) tex=tex;; # don't bother trying to find etex\n               *) tex=$TEX\n        esac;;\n    texinfo:*:pdf) tex=$PDFTEX;;\n    *) error 1 \"$out_lang not supported for $in_lang\";;\n  esac\n\n  # Beware of aux files in subdirectories that require the\n  # subdirectory to exist.\n  case $in_lang:$tidy in\n    latex:true)\n       $SED -n 's|^[ ]*\\\\include{\\(.*\\)/.*}.*|\\1|p' \"$in_input\" |\n       sort -u |\n       while read d\n       do\n         ensure_dir \"$work_build/$d\"\n       done\n       ;;\n  esac\n\n  # Note that this will be used via an eval: quote properly.\n  tex_cmd=\"$tex\"\n\n  # If possible, make TeX report error locations in GNU format.\n  if $line_error; then\n    if test \"${tex_help:+set}\" != set; then\n      # Go to a temporary directory to try --help, since old versions that\n      # don't accept --help will generate a texput.log.\n      tex_help_dir=$t2ddir/tex_help\n      ensure_dir \"$tex_help_dir\"\n      tex_help=`cd \"$tex_help_dir\" >&6 && $tex --help </dev/null 2>&1 || true`\n    fi\n    # The mk program and perhaps others want to parse TeX's\n    # original error messages.\n    case $tex_help in\n      *file-line-error*) tex_cmd=\"$tex_cmd --file-line-error\";;\n    esac\n  fi\n\n  # Tell TeX about -recorder option, if specified\n  # recorder_option_maybe is in { \" -recorder\", \"\" }\n  tex_cmd=\"$tex_cmd$recorder_option_maybe\"\n  \n  \n  # Tell TeX about TCX file, if specified.\n  test -n \"$translate_file\" \\\n                       && tex_cmd=\"$tex_cmd --translate-file=$translate_file\"\n\n  # Tell TeX to make source specials (for backtracking from output to\n  # source, given a sufficiently smart editor), if specified.\n  test -n \"$src_specials\" && tex_cmd=\"$tex_cmd $src_specials\"\n\n  # Tell TeX to allow running external executables\n  test -n \"$shell_escape\" && tex_cmd=\"$tex_cmd $shell_escape\"\n\n  # Run without interaction.\n  # \\batchmode does not show terminal output at all, so we don't\n  # want that.  And even in batch mode, TeX insists on having input\n  # from the user.  Close its stdin to make it impossible.\n  tex_cmd=\"$tex_cmd </dev/null '${escape}nonstopmode'\"\n}\n\n\n# run_tex - Run TeX, taking care of errors and logs.\nrun_tex ()\n{\n  # Check for any unusual characters in the filename.\n  # However, >, \\ and any whitespace characters are not supported\n  # filenames.\n  in_input_funnies=`echo \"$in_input\" \\\n    | $SED -e 's![^}#$%&^_{~]!!g' -e 's!\\(.\\)!\\1\\''\n!g' | uniq`\n\n  if test -n \"$in_input_funnies\" ; then\n    # Make > an end group character, as it's unlikely to appear in\n    # a filename.\n    tex_cmd=\"$tex_cmd '${escape}bgroup${escape}catcode62=2${escape}relax'\"\n\n    # If the filename has funny characters, change the TeX category codes of \n    # some characters within a group, and use \\expandafter to input the file\n    # outside of the group.\n    for w in $in_input_funnies ; do\n      tex_cmd=\"$tex_cmd '${escape}catcode\\`${escape}$w=12${escape}relax'\"\n    done\n\n    # Set \\toks0 to \"\\input FILENAME\\relax\"\n    tex_cmd=\"$tex_cmd '${escape}toks0${escape}bgroup${escape}input' '$rel$in_input' '${escape}relax>\"\n\n    # Expand \\toks0 after the end of the group\n    tex_cmd=\"$tex_cmd${escape}expandafter${escape}egroup\"\n    tex_cmd=\"$tex_cmd${escape}the${escape}toks0${escape}relax'\"\n  else\n    # In the case of a simple filename, just pass the filename\n    # with no funny tricks.\n    tex_cmd=\"$tex_cmd '${escape}input' '$rel$in_input'\"\n  fi\n\n  verbose \"$0: Running $tex_cmd ...\"\n  if (eval \"$tex_cmd\" >&5); then\n    case $out_lang in\n      dvi | pdf ) move_to_dest \"$in_noext.$out_lang\";;\n    esac\n  else\n    tex_failed=true\n  fi\n}\n\n\n# run_bibtex - Run bibtex (or biber) on current file\n# - if its input (AUX) exists,\n# - or if some citations are missing (LOG contains `Citation'),\n# - or if the LOG complains of a missing .bbl.\n#\n# Don't try to be too smart:\n# 1. Running bibtex only if the bbl file exists and is older than\n# the LaTeX file is wrong, since the document might include files\n# that have changed.\n#\n# 2. Because there can be several AUX (if there are \\include's),\n# but a single LOG, looking for missing citations in LOG is\n# easier, though we take the risk of matching false messages.\nrun_bibtex ()\n{\n  case $in_lang in\n    latex)   bibtex=${BIBTEX:-bibtex};;\n    texinfo) return;;\n  esac\n\n  # \"Citation undefined\" is for LaTeX, \"Undefined citation\" for btxmac.tex.\n  # The no .aux && \\bibdata test is also for btxmac, in case it was the\n  # first run of a bibtex-using document.  Otherwise, it's possible that\n  # bibtex would never be run.\n  if test -r \"$in_noext.aux\" \\\n     && test -r \"$in_noext.log\" \\\n     && ( (grep 'Warning:.*Citation.*undefined' \"$in_noext.log\" \\\n          || grep '.*Undefined citation' \"$in_noext.log\" \\\n          || grep 'No file .*\\.bbl\\.' \"$in_noext.log\") \\\n          || (grep 'No \\.aux file' \"$in_noext.log\" \\\n              && grep '^\\\\bibdata' \"$in_noext.aux\") ) \\\n        >&6 2>&1; \\\n  then\n    bibtex_aux=`filter_files bibaux_file_p`\n    for f in $bibtex_aux; do\n      run $bibtex \"$f\"\n    done\n  fi\n\n  # biber(+biblatex) check.\n  if test -r \"$in_noext.bcf\" \\\n     && grep '</bcf:controlfile>' \"$in_noext.bcf\" >/dev/null; then\n    run ${BIBER:-biber} \"$in_noext\"\n  fi\n}\n\n\n# filter_file PREDICATE - Go through the list of files in xref_files_new\n# and use PREDICATE on each one to optionally print it or print other files \n# based on the filename.\nfilter_files ()\n{\n  test -n \"$xref_files_new\" || return 0\n  echo \"$xref_files_new\" |\n  # Filter existing files matching the criterion.\n  #\n  while read file; do\n    $1 \"$file\"\n  done |\n  sort |\n  # Some files are opened several times, e.g., listings.sty's *.vrb.\n  uniq\n}\n\n# run_index - Run texindex (or makeindex or texindy) on current index\n# files.  If they already exist, and after running TeX a first time the\n# index files don't change, then there's no reason to run TeX again.\n# But we won't know that if the index files are out of date or nonexistent.\nrun_index ()\n{\n  index_files=`filter_files index_file_p`\n  test -n \"$index_files\" \\\n  || return 0\n\n  : ${MAKEINDEX:=makeindex}\n  : ${TEXINDEX:=texindex}\n  : ${TEXINDY:=texindy}\n\n  case $in_lang:$latex2html:`out_lang_tex` in\n    latex:tex4ht:html)\n      for index_file in $index_files\n      do\n        index_noext=`noext \"$index_file\"`\n        run tex \\\n            '\\def\\filename{{'\"$index_noext\"'}{idx}{4dx}{ind}}\n             \\input idxmake.4ht'\n        run $MAKEINDEX -o $index_noext.ind $index_noext.4dx\n      done\n      ;;\n\n    latex:*)\n      if $TEXINDY --version >&6 2>&1; then\n        run $TEXINDY $index_files\n      else\n        run $MAKEINDEX $index_files\n      fi\n      ;;\n\n    texinfo:*)\n      run $TEXINDEX $index_files\n      ;;\n  esac\n}\n\n\n# run_tex4ht - Run the last two phases of TeX4HT: tex4ht extracts the\n# HTML from the instrumented DVI file, and t4ht converts the figures and\n# installs the files when given -d.\n#\n# Because knowing exactly which files are created is complex (in\n# addition the names are not simple to compute), which makes it\n# difficult to install the output files in a second step, we\n# tell t4ht to install the output files.\nrun_tex4ht ()\n{\n  case $in_lang:$latex2html:`out_lang_tex` in\n    latex:tex4ht:html)\n      : ${TEX4HT:=tex4ht} ${T4HT:=t4ht}\n      run \"$TEX4HT\" \"-f/$in_noext\"\n      # Do not remove the / after the destdir.\n      run \"$T4HT\" \"-d`destdir`/\" \"-f/$in_noext\"\n      ;;\n  esac\n}\n\n\n# run_thumbpdf - Run thumbpdf.\nrun_thumbpdf ()\n{\n  if test `out_lang_tex` = pdf \\\n     && test -r \"$in_noext.log\" \\\n     && grep 'thumbpdf\\.sty'  \"$in_noext.log\" >&6 2>&1; \\\n  then\n    thumbpdf=${THUMBPDF_CMD:-thumbpdf}\n    thumbcmd=\"$thumbpdf $in_dir/$in_noext\"\n    verbose \"Running $thumbcmd ...\"\n    if $thumbcmd >&5; then\n      run_tex\n    else\n      report \"$thumbpdf exited with bad status.\" \\\n             \"Ignoring its output.\"\n    fi\n  fi\n}\n\n\n# run_dvipdf FILE.dvi - Convert FILE.dvi to FILE.pdf.\nrun_dvipdf ()\n{\n  # Find which dvi->pdf program is available.\n  if test -n \"$DVIPDF\"; then\n    dvipdf=$DVIPDF  # user envvar, use it without checking\n\n  elif test -z \"$dvipdf\"; then\n    for i in dvipdfmx dvipdfm dvipdf dvi2pdf dvitopdf; do\n      if findprog $i; then\n        dvipdf=$i\n      fi\n    done\n  fi\n  # These tools have varying interfaces, some 'input output', others\n  # 'input -o output'.  They all seem to accept 'input' only,\n  # outputting using the expected file name.\n  run $dvipdf \"$1\"\n  if test ! -f `echo \"$1\" | $SED -e 's/\\.dvi$/.pdf/'`; then\n    error 1 \"cannot find output file\"\n  fi\n}\n\n# run_tex_suite - Run the TeX tools until a stable point is reached.\nrun_tex_suite ()\n{\n  make_tex_cmd\n\n  # Move to the working directory.\n  if $tidy; then\n    verbose \"cd $work_build\"\n    cd_dir \"$work_build\" || exit 1\n  fi\n\n  # Count the number of cycles.\n  suite_cycle=0\n\n  # Start by checking the log files for what files were created last\n  # time.  This will mean that if they don't change, we finish in 1 cycle.\n  xref_files_new=`generated_files_get`\n  xref_files_save\n\n  while :; do\n    # check for (probably) LaTeX loop (e.g. varioref)\n    if test $suite_cycle -eq \"$max_iters\"; then\n      error 0 \"Maximum of $max_iters cycles exceeded\"\n      break\n    fi\n\n    # report progress\n    suite_cycle=`expr $suite_cycle + 1`\n    verbose \"Cycle $suite_cycle for $command_line_filename\"\n\n    tex_failed=false\n    run_core_conversion\n    xref_files_changed || break\n    xref_files_save\n\n    # We run bibtex first, because it's more likely for the indexes\n    # to change after bibtex is run than the reverse, though either\n    # would be rare.\n    run_bibtex\n    run_index\n  done\n\n  if $tex_failed ; then\n    # TeX failed, and the xref files did not change.\n    error 1 \"$tex exited with bad status, quitting.\"\n  fi\n\n  # If we were using thumbpdf and producing PDF, then run thumbpdf\n  # and TeX one last time.\n  run_thumbpdf\n\n  # If we are using tex4ht, call it.\n  run_tex4ht\n\n  # Install the result if we didn't already (i.e., if the output is\n  # dvipdf or ps).\n  case $latex2html:$out_lang in\n    *:dvipdf)\n      run_dvipdf \"$in_noext.`out_lang_tex`\"\n      move_to_dest \"$in_noext.`out_lang_ext`\"\n      ;;\n    *:ps)\n      : ${DVIPS:=dvips}\n      run $DVIPS -o \"$in_noext.`out_lang_ext`\" \"$in_noext.`out_lang_tex`\"\n      move_to_dest \"$in_noext.`out_lang_ext`\"\n      ;;\n  esac\n\n  cd_orig\n}\n\n\n# \f TeX processing auxiliary tools.\n#\n# run_makeinfo - Expand macro commands in the original source file using\n# Makeinfo.  Always use `end' footnote style, since the `separate' style\n# generates different output (arguably this is a bug in -E).  Discard\n# main info output, the user asked to run TeX, not makeinfo.\nrun_makeinfo ()\n{\n  test $in_lang = texinfo \\\n    || return 0\n\n  # Unless required by the user, makeinfo expansion is wanted only\n  # if texinfo.tex is too old.\n  if $expand; then\n    makeinfo=${MAKEINFO:-makeinfo}\n  else\n    # Check if texinfo.tex performs macro expansion by looking for\n    # its version.  The version is a date of the form YEAR-MO-DA.\n    # We don't need to use [0-9] to match the digits since anyway\n    # the comparison with $txiprereq, a number, will fail with non-digits.\n    # Run in a temporary directory to avoid leaving files.\n    version_test_dir=$t2ddir/version_test\n    ensure_dir \"$version_test_dir\"\n    if (\n       cd \"$version_test_dir\"\n       echo '\\input texinfo.tex @bye' >txiversion.tex\n       # Be sure that if tex wants to fail, it is not interactive:\n       # close stdin.\n       $TEX txiversion.tex </dev/null >txiversion.out 2>txiversion.err\n    ); then :; else\n      report \"texinfo.tex appears to be broken.\nThis may be due to the environment variable TEX set to something\nother than (plain) tex, a corrupt texinfo.tex file, or \nto tex itself simply not working.\"\n      cat \"$version_test_dir/txiversion.out\"\n      cat \"$version_test_dir/txiversion.err\" >&2\n      error 1 \"quitting.\"\n    fi\n    eval `$SED -n 's/^.*\\[\\(.*\\)version \\(....\\)-\\(..\\)-\\(..\\).*$/txiformat=\\1 txiversion=\"\\2\\3\\4\"/p' \"$version_test_dir/txiversion.out\"`\n    verbose \"texinfo.tex preloaded as \\`$txiformat', version is \\`$txiversion' ...\"\n    if test \"$txiprereq\" -le \"$txiversion\" >&6 2>&1; then\n      makeinfo=\n    else\n      makeinfo=${MAKEINFO:-makeinfo}\n    fi\n    # If TeX is preloaded, offer the user this convenience:\n    if test \"$txiformat\" = Texinfo; then\n      escape=@\n    fi\n  fi\n\n  if test -n \"$makeinfo\"; then\n    # in_src: the file with macros expanded.\n    # Use the same basename to generate the same aux file names.\n    work_src=$workdir/src\n    ensure_dir \"$work_src\"\n    in_src=$work_src/$in_base\n    run_mi_includes=`list_prefix includes -I`\n    verbose \"Macro-expanding $command_line_filename to $in_src ...\"\n    # eval $makeinfo because it might be defined as something complex\n    # (running missing) and then we end up with things like '\"-I\"',\n    # and \"-I\" (including the quotes) is not an option name.  This\n    # happens with gettext 0.14.5, at least.\n    $SED \"$comment_iftex\" \"$command_line_filename\" \\\n      | eval $makeinfo --footnote-style=end -I \"$in_dir\" $run_mi_includes \\\n        -o /dev/null --macro-expand=- \\\n      | $SED \"$uncomment_iftex\" >\"$in_src\"\n    # Continue only if everything succeeded.\n    if test $? -ne 0 \\\n       || test ! -r \"$in_src\"; then\n      verbose \"Expansion failed, ignored...\";\n    else\n      in_input=$in_src\n    fi\n  fi\n}\n\n# Unfortunately, makeinfo --iftex --no-ifinfo doesn't work well enough\n# in versions before 5.0, as makeinfo can't parse the TeX commands\n# inside @tex blocks, so work around with sed.\n#\n# This sed script preprocesses Texinfo sources in order to keep the\n# iftex sections only.  We want to remove non-TeX sections, and comment\n# (with `@c _texi2dvi') TeX sections so that makeinfo does not try to\n# parse them.  Nevertheless, while commenting TeX sections, don't\n# comment @macro/@end macro so that makeinfo does propagate them.\n# Similarly, preserve the @top node to avoid makeinfo complaining about\n# it being missed.  Comment it out after preprocessing, so that it does\n# not appear in the generated document.\n#\n# We assume that `@c _texi2dvi' or `@c (_texi2dvi)' starting a line is\n# not present in the document.  Additionally, conditionally defined\n# macros inside the @top node may end up with the wrong value, although\n# this is unlikely in practice.\n#\ncomment_iftex=\\\n'/^@tex/,/^@end tex/{\n  s/^/@c _texi2dvi/\n}\n/^@iftex/,/^@end iftex/{\n  s/^/@c _texi2dvi/\n  /^@c _texi2dvi@macro/,/^@c _texi2dvi@end macro/{\n    s/^@c _texi2dvi//\n  }\n}\n/^@ifnottex/,/^@end ifnottex/{\n  s/^/@c (_texi2dvi)/\n  /^@c (_texi2dvi)@node Top/,/^@c (_texi2dvi)@end ifnottex/ {\n    /^@c (_texi2dvi)@end ifnottex/b\n    s/^@c (_texi2dvi)//\n  }\n}\n/^@ifinfo/,/^@end ifinfo/{\n  /^@node/p\n  /^@menu/,/^@end menu/p\n  t\n  s/^/@c (_texi2dvi)/\n}\ns/^@ifnotinfo/@c _texi2dvi@ifnotinfo/\ns/^@end ifnotinfo/@c _texi2dvi@end ifnotinfo/'\n\n# Uncomment @iftex blocks by removing any leading `@c texi2dvi' (repeated\n# copies can sneak in via macro invocations).  Likewise, comment out\n# the @top node inside a @ifnottex block.\nuncomment_iftex=\\\n's/^@c _texi2dvi\\(@c _texi2dvi\\)*//\n/^@c (_texi2dvi)@ifnottex/,/^@c (_texi2dvi)@end ifnottex/{\n  s/^/@c (_texi2dvi)/\n}'\n\n\n# insert_commands - Insert $textra commands at the beginning of the file. \n# Recommended to be used for @finalout, @smallbook, etc.\ninsert_commands ()\n{\n  if test -n \"$textra\"; then\n    # _xtr.  The file with the user's extra commands.\n    work_xtr=$workdir/xtr\n    in_xtr=$work_xtr/$in_base\n    ensure_dir \"$work_xtr\"\n    verbose \"Inserting extra commands: $textra\"\n    case $in_lang in\n      latex)   textra_cmd=1i;;\n      texinfo)\n        textra_cmd='/^\\\\input texinfo/a'\n        # insert after @setfilename line if present\n        if head -n 10 $in_input | grep '^@setfilename' ; then\n          textra_cmd='/^@setfilename/a'\n        fi\n        ;;\n      *)       error 1 \"internal error, unknown language: $in_lang\";;\n    esac\n    $SED \"$textra_cmd\\\\\n$textra\" \"$in_input\" >\"$in_xtr\"\n    in_input=$in_xtr\n  fi\n\n  case $in_lang:$latex2html:`out_lang_tex` in\n    latex:tex4ht:html)\n      # _tex4ht.  The file with the added \\usepackage{tex4ht}.\n      work_tex4ht=$workdir/tex4ht\n      in_tex4ht=$work_tex4ht/$in_base\n      ensure_dir \"$work_tex4ht\"\n      verbose \"Inserting \\\\usepackage{tex4ht}\"\n      perl -pe 's<\\\\documentclass(?:\\[.*\\])?{.*}>\n                 <$&\\\\usepackage[xhtml]{tex4ht}>' \\\n        \"$in_input\" >\"$in_tex4ht\"\n      in_input=$in_tex4ht\n      ;;\n  esac\n}\n\n\n# compute_language FILENAME - Return the short string for the language\n# in which FILENAME is written: `texinfo' or `latex'.\ncompute_language ()\n{\n  # If the user explicitly specified the language, use that.\n  # Otherwise, if the first line is \\input texinfo, assume it's texinfo.\n  # Otherwise, guess from the file extension.\n  if test -n \"$set_language\"; then\n    echo $set_language\n  elif $SED 1q \"$1\" | grep 'input texinfo' >&6; then\n    echo texinfo\n  else\n    # Get the type of the file (latex or texinfo) from the given language\n    # we just guessed, or from the file extension if not set yet.\n    case $1 in\n      *.ltx | *.tex | *.drv | *.dtx) echo latex;;\n      *)                             echo texinfo;;\n    esac\n  fi\n}\n\n\n# run_hevea (MODE) - Convert to HTML/INFO/TEXT.\n#\n# Don't pass `-noiso' to hevea: it's useless in HTML since anyway the\n# charset is set to latin1, and troublesome in other modes since\n# accented characters loose their accents.\n#\n# Don't pass `-o DEST' to hevea because in that case it leaves all its\n# auxiliary files there too...  Too bad, because it means we will need\n# to handle images some day.\nrun_hevea ()\n{\n  run_hevea_name=\"${HEVEA:-hevea}\"\n  run_hevea_cmd=\"$run_hevea_name\"\n\n  case $1 in\n    html) ;;\n    text|info) run_hevea_cmd=\"$run_hevea_cmd -$1\";;\n    *) error 1 \"run_hevea_cmd: invalid argument: $1\";;\n  esac\n\n  # Compiling to the tmp directory enables to preserve a previous\n  # successful compilation.\n  run_hevea_cmd=\"$run_hevea_cmd -fix -O -o '$out_base'\"\n  run_hevea_cmd=\"$run_hevea_cmd `list_prefix includes -I` -I '$orig_pwd' \"\n  run_hevea_cmd=\"$run_hevea_cmd '$rel$in_input'\"\n\n  if $debug; then\n    run_hevea_cmd=\"$run_hevea_cmd -v -v\"\n  fi\n\n  verbose \"running $run_hevea_cmd\"\n  if eval \"$run_hevea_cmd\" >&5; then\n    # hevea leaves trailing white spaces, this is annoying.\n    case $1 in text|info)\n      perl -pi -e 's/[ \\t]+$//g' \"$out_base\"*;;\n    esac\n    case $1 in\n    html|text) move_to_dest \"$out_base\";;\n    info) # There can be foo.info-1, foo.info-2 etc.\n               move_to_dest \"$out_base\"*;;\n    esac\n  else\n    error 1 \"$run_hevea_name exited with bad status, quitting.\"\n  fi\n}\n\n\n# run_core_conversion - Run TeX (or HeVeA).\nrun_core_conversion ()\n{\n  case $in_lang:$latex2html:`out_lang_tex` in\n    *:dvi|*:pdf|latex:tex4ht:html)\n        run_tex;;\n    latex:*:html|latex:*:text|latex:*:info)\n        run_hevea $out_lang;;\n    *)\n        error 1 \"invalid input/output combination: $in_lang/$out_lang\";;\n  esac\n}\n\n\n# compile - Run the full compilation chain, from pre-processing to\n# installation of the output at its expected location.\ncompile ()\n{\n  # Set include path for tools:\n  #   .  Include current directory in case there are files there already, so\n  #     we don't have more TeX runs than necessary.  orig_pwd is used in case \n  #     we are in clean build mode, where we have cd'd to a temp directory.\n  #   .  Include directory containing file, in case there are other\n  #     files @include'd.\n  #   .  Keep a final path_sep to get the default (system) TeX\n  #     directories included.\n  #   .  If we have any includes, put those at the end.\n\n  common=\"$orig_pwd$path_sep$in_dir$path_sep\"\n  #\n  txincludes=`list_infix includes $path_sep`\n  test -n \"$txincludes\" && common=\"$common$txincludes$path_sep\"\n  #\n  for var in $tex_envvars; do\n    eval val=\"\\$common\\$${var}_orig\"\n    # Convert relative paths to absolute paths, so we can run in another\n    # directory (e.g., in clean build mode, or during the macro-support\n    # detection).\n    val=`absolute_filenames \"$val\"`\n    eval $var=\"\\\"$val\\\"\"\n    export $var\n    eval verbose \\\"$var=\\'\\$${var}\\'\\\"\n  done\n\n  # --expand\n  run_makeinfo\n\n  # --command, --texinfo\n  insert_commands\n\n  # Run until a fixed point is reached.\n  run_tex_suite\n}\n\n# make_openout_test FLAGS EXTENSION\n# - Run TeX with an input file that performs an \\openout.  Pass FLAGS to TeX.\n#\nmake_openout_test ()\n{\n    recorder_option_maybe=\"$1\"\n    make_tex_cmd\n\n    ensure_dir \"$workdir\"/check_recorder\n    cd_dir \"$workdir\"/check_recorder\n\n    cat > openout.tex <<EOF\n\\newwrite\\ourwrite\n\\immediate\\openout\\ourwrite dum.dum\n\\bye\nEOF\n    # \\bye doesn't work for LaTeX, but it will cause latex\n    # to exit with an input error.\n    tex_cmd=\"$tex_cmd '${escape}input' ./openout.tex\"\n    # ./ in case . isn't in path\n    verbose \"$0: running $tex_cmd ...\"\n    rm -fr \"openout.$2\"\n    (eval \"$tex_cmd\" >/dev/null 2>&1)\n}\n\n# Check tex supports -recorder option\ncheck_recorder_support ()\n{\n  verbose \"Checking TeX recorder support...\"\n  make_openout_test \" -recorder\" fls\n  if test -f openout.fls && grep '^OUTPUT dum.dum$' openout.fls > /dev/null\n  then\n    cd_orig\n    verbose \"Checking TeX recorder support... yes\"\n    return 0\n  else\n    cd_orig\n    verbose \"Checking TeX recorder support... no\"\n    return 1\n  fi\n}\n\n# Check tex supports \\openout traces in log\ncheck_openout_in_log_support ()\n{\n  verbose \"Checking TeX \\openout in log support...\"\n  make_openout_test \"\" log\n  if test -f openout.log \\\n     && grep '^\\\\openout..\\? *= *`\\?dum\\.dum'\\''\\?' openout.log >/dev/null\n  then\n    cd_orig\n    verbose \"Checking TeX \\openout in log support... yes\"\n    return 0\n  else\n    cd_orig\n    verbose \"Checking TeX \\openout in log support... no\"\n    return 1\n  fi\n}\n\n# Set that output auxiliary files are detected with the -recorder option,\n# which creates a file JOBNAME.fls which is a machine-readable listing of\n# files read and written during the job.\nset_aux_files_from_fls ()\n{\n  recorder_option_maybe=\" -recorder\"\n  generated_files_get_method=generated_files_get_from_fls\n}\n\n# Set that output auxiliary files are detected with searching for \\openout\n# in the log file.\nset_aux_files_from_log ()\n{\n  recorder_option_maybe=''\n  generated_files_get_method=generated_files_get_from_log\n}\n\n# Decide whether output auxiliary files are detected with the -recorder\n# option, or by searching for \\openout in the log file.\ndecide_aux_files_method ()\n{\n  # Select output file detection method\n  # Valid values of TEXI2DVI_USE_RECORDER are:\n  #   yes           use the -recorder option, no checks.\n  #   no            scan for \\openout in the log file, no checks.\n  #   yesmaybe      check whether -recorder option is supported, and if yes\n  #                use it, otherwise check for tracing \\openout in the\n  #                log file is supported, and if yes use it, else it is an \n  #                error.\n  #   nomaybe      same as `yesmaybe', except that the \\openout trace in\n  #                log file is checked first.\n  #\n  #  The default behaviour is `nomaybe'.\n\n  test -n \"$TEXI2DVI_USE_RECORDER\" || TEXI2DVI_USE_RECORDER=nomaybe\n\n  case $TEXI2DVI_USE_RECORDER in\n    yes) set_aux_files_from_fls;;\n\n    no)\tset_aux_files_from_log;;\n\n    yesmaybe)\n      if check_recorder_support; then\n        set_aux_files_from_fls\n      elif check_openout_in_log_support; then\n        set_aux_files_from_log\n      else\n        error 1 \"TeX neither supports -recorder nor outputs \\\\openout lines in its log file\"\n      fi\n      ;;\n\n    nomaybe)\n      if check_openout_in_log_support; then\n        set_aux_files_from_log\n      elif check_recorder_support; then\n        set_aux_files_from_fls\n      else\n        error 1 \"TeX neither supports -recorder nor outputs \\\\openout lines in its log file\"\n      fi\n      ;;\n    \n    *) error 1 \"Invalid value of TEXI2DVI_USE_RECORDER environment variable : $TEXI2DVI_USE_RECORDER.\";;\n\n  esac\n}\n\n# remove FILE...\nremove ()\n{\n  verbose \"Removing\" \"$@\"\n  rm -rf \"$@\"\n}\n\n\n# all_files - Echo the names of all files generated, including those by\n#             auxiliary tools like texindex.\nall_files ()\n{\n  echo $in_noext.log\n  echo $in_noext.fls\n  echo $xref_files_new\n  echo `sorted_index_files`\n}\n\nsorted_index_files ()\n{\n  filter_files sorted_index_filter\n}\n\n# Print the name of a generated file based on FILE if there is one.\nsorted_index_filter ()\n{\n  case $in_lang in\n    texinfo)\n      # texindex: texinfo.cp -> texinfo.cps\n      if test -n \"`index_file_p $1`\" ; then\n        echo $1s\n      fi\n      ;;\n  esac\n}\n\n\n# Not currently used - use with filter_files to add secondary files created by \n# bibtex\nbibtex_secondary_files ()\n{\n  case $in_lang in\n    latex)\n      if test -n \"`aux_file_p $1`\"; then\n        # bibtex: *.aux -> *.bbl and *.blg.\n        echo $1 | $SED 's/^\\(.*\\)\\.aux$/\\1.bbl/'\n        echo $1 | $SED 's/^\\(.*\\)\\.aux$/\\1.blg/'\n      fi\n      ;;\n  esac\n}\n\n# mostly_clean - Remove auxiliary files and directories.  Changes back to\n# the original directory.\nmostly_clean ()\n{\n  cd_orig\n  set X \"$t2ddir\"\n  shift\n  $tidy || {\n    set X ${1+\"$@\"} `all_files`\n    shift\n  }\n  remove ${1+\"$@\"}\n}\n\n\n# cleanup - Remove what should be removed according to options.\n# Called at the end of each compilation cycle, and at the end of\n# the script.  Changes the current directory.\ncleanup ()\n{\n  case $clean:$tidy in\n    true:true) mostly_clean ;;                # build mode is \"clean\"\n    false:false) cd_orig; remove \"$t2ddir\";;  # build mode is \"local\"\n  esac\n}\n\n\n# \f input_file_name_decode - Decode COMMAND_LINE_FILENAME, and set the\n# following shell variables:\n#\n# - COMMAND_LINE_FILENAME\n#   The filename given on the commmand line, but cleaned of TeX commands.\n# - IN_DIR\n#   The directory containing the input file.\n# - IN_BASE\n#   The input file base name (no directory part).\n# - IN_NOEXT\n#   The input file name with neither file extensions nor directory part.\n# - IN_INPUT\n#   The path to the input file for passing as a command-line argument\n#   to TeX.  Defaults to COMMAND_LINE_FILENAME, but might change if the\n#   input is preprocessed.\ninput_file_name_decode ()\n{\n  case $command_line_filename in\n    *\\\\input{*}*)\n      # Let AUC-TeX error parser deal with line numbers.\n      line_error=false\n      command_line_filename=`\\\n        expr X\"$command_line_filename\" : X'.*input{\\([^}]*\\)}'`\n      ;;\n  esac\n\n  # If the COMMAND_LINE_FILENAME is not absolute (e.g., --debug.tex),\n  # prepend `./' in order to avoid that the tools take it as an option.\n  echo \"$command_line_filename\" | LC_ALL=C $EGREP '^(/|[A-Za-z]:/)' >&6 \\\n  || command_line_filename=\"./$command_line_filename\"\n\n  # See if the file exists.  If it doesn't we're in trouble since, even\n  # though the user may be able to reenter a valid filename at the tex\n  # prompt (assuming they're attending the terminal), this script won't\n  # be able to find the right xref files and so forth.\n  test -r \"$command_line_filename\" \\\n  || error 1 \"cannot read $command_line_filename, skipping.\"\n\n  # Get the name of the current directory.\n  in_dir=`func_dirname \"$command_line_filename\"`\n\n  # Strip directory part but leave extension.\n  in_base=`basename \"$command_line_filename\"`\n  # Strip extension.\n  in_noext=`noext \"$in_base\"`\n\n  # The normalized file name to compile.  Must always point to the\n  # file to actually compile (in case of recoding, macro-expansion etc.).\n  in_input=$in_dir/$in_base\n\n\n  # Compute the output file name.\n  if test x\"$oname\" != x; then\n    out_name=$oname\n  else\n    out_name=$in_noext.`out_lang_ext`\n  fi\n  out_dir=`func_dirname \"$out_name\"`\n  out_dir_abs=`absolute \"$out_dir\"`\n  out_base=`basename \"$out_name\"`\n  out_noext=`noext \"$out_base\"`\n}\n\n\n# \f\n#################### Main program starts ##########################\n\n# Initialize more variables.\n#\n# Save TEXINPUTS so we can construct a new TEXINPUTS path for each file.\n# Likewise for bibtex and makeindex.\ntex_envvars=\"BIBINPUTS BSTINPUTS DVIPSHEADERS INDEXSTYLE MFINPUTS MPINPUTS \\\nTEXINPUTS TFMFONTS\"\nfor var in $tex_envvars; do\n  eval ${var}_orig=\\$$var\n  export $var\ndone\n\n# Push a token among the arguments that will be used to notice when we\n# ended options/arguments parsing.\n# Use \"set dummy ...; shift\" rather than 'set - ...\" because on\n# Solaris set - turns off set -x (but keeps set -e).\n# Use ${1+\"$@\"} rather than \"$@\" because Digital Unix and Ultrix 4.3\n# still expand \"$@\" to a single argument (the empty string) rather\n# than nothing at all.\narg_sep=\"$$--$$\"\nset dummy ${1+\"$@\"} \"$arg_sep\"; shift\n\nwhile test x\"$1\" != x\"$arg_sep\"; do\n  # Handle --option=value by splitting apart and putting back on argv.\n  case \"$1\" in\n    --*=*)\n      opt=`echo \"$1\" | $SED -e 's/=.*//'`\n      val=`echo \"$1\" | $SED -e 's/[^=]*=//'`\n      shift\n      set dummy \"$opt\" \"$val\" ${1+\"$@\"}; shift\n      ;;\n  esac\n\n  case \"$1\" in\n    -@ ) escape=@;;\n    -~ ) verbose \"Option -~ is obsolete: texi2dvi ignores it.\";;\n    -b | --batch) ;; # Obsolete\n         --build)      shift; build_mode=$1;;\n         --build-dir)  shift; build_dir=$1; build_mode=tidy;;\n    -c | --clean) build_mode=clean;;\n    -D | --debug) debug=true;;\n    -e | -E | --expand) expand=true;;\n    -h | --help) usage;;\n    -I)   shift; list_concat_dirs includes \"$1\";;\n    -l | --lang | --language) shift; set_language=$1;;\n    --mostly-clean) action=mostly-clean;;\n    --no-line-error) line_error=false;;\n    --max-iterations) shift; max_iters=$1;;\n    -o | --out  | --output)\n      shift\n      # Make it absolute, just in case we also have --clean, or whatever.\n      oname=`absolute \"$1\"`;;\n\n    # Output formats.\n    -O|--output-format) shift; out_lang_set \"$1\";;\n       --dvi|--dvipdf|--html|--info|--pdf|--ps|--text)\n       out_lang_set `echo \"x$1\" | $SED 's/^x--//'`;;\n\n    -p) out_lang_set pdf;;\n    -q | -s | --quiet | --silent) quiet=true;;\n    --src-specials) src_specials=--src-specials;;\n    --shell-escape) shell_escape=--shell-escape;;  \n    --tex4ht) latex2html=tex4ht;;\n    -t | --texinfo | --command ) shift; textra=\"$textra\\\\\n\"`echo \"$1\" | $SED 's/\\\\\\\\/\\\\\\\\\\\\\\\\/g'`;;\n    --translate-file ) shift; translate_file=\"$1\";;\n    --tidy) build_mode=tidy;;\n    -v | --vers*) version;;\n    -V | --verb*) verb=true;;\n    --) # What remains are not options.\n      shift\n      while test x\"$1\" != x\"$arg_sep\"; do\n        set dummy ${1+\"$@\"} \"$1\"; shift\n        shift\n      done\n      break;;\n    -*)\n      error 1 \"Unknown or ambiguous option \\`$1'.\" \\\n              \"Try \\`--help' for more information.\"\n      ;;\n    *) set dummy ${1+\"$@\"} \"$1\"; shift;;\n   esac\n   shift\ndone\n# Pop the token\nshift\n\n# $tidy:  compile in a t2d directory.\n# $clean: remove all the aux files.\ncase $build_mode in\n  local) clean=false; tidy=false;;\n  tidy)  clean=false; tidy=true;;\n  clean) clean=true;  tidy=true;;\n      *) error 1 \"invalid build mode: $build_mode\";;\nesac\n\n# Interpret remaining command line args as filenames.\ncase $# in\n 0)\n  error 2 \"Missing file arguments.\" \"Try \\`--help' for more information.\"\n  ;;\n 1) ;;\n *)\n  if test -n \"$oname\"; then\n    error 2 \"Can't use option \\`--output' with more than one argument.\"\n  fi\n  ;;\nesac\n\n\n# We can't do much without tex.\n# End up with the TEX and PDFTEX variables set to what we are going to use.\n#\n# If $TEX is set to a directory, don't use it.\ntest -n \"$TEX\" && test -d \"$TEX\" && unset TEX\n\n# But otherwise, use $TEX if it is set.\nif test -z \"$TEX\"; then\n  if findprog tex; then :; else cat <<EOM >&2\nYou don't have a working TeX binary (tex) installed anywhere in\nyour PATH, and texi2dvi cannot proceed without one.  If you want to use\nthis script, you'll need to install TeX (if you don't have it) or change\nyour PATH or TEX environment variable (if you do).  See the --help\noutput for more details.\n\nFor information about obtaining TeX, please see http://tug.org/texlive,\nor do a web search for TeX and your operating system or distro.\nEOM\n    exit 1\n  fi\n\n  # We want to use etex (or pdftex) if they are available, and the user\n  # didn't explicitly specify.  We don't check for elatex and pdfelatex\n  # because (as of 2003), the LaTeX team has asked that new distributions\n  # use etex by default anyway.\n  #\n  if findprog etex; then TEX=etex; else TEX=tex; fi\nfi\n\n# For many years, the pdftex binary has included the e-tex extensions,\n# but for those people with ancient TeX distributions ...\nif test -z \"$PDFTEX\"; then\n  if findprog pdfetex; then PDFTEX=pdfetex; else PDFTEX=pdftex; fi\nfi\n\n\n# File descriptor usage:\n# 0 standard input\n# 1 standard output (--verbose messages)\n# 2 standard error\n# 5 tools output (turned off by --quiet)\n# 6 tracing/debugging (set -x output, etc.)\n\n# Main tools' output (TeX, etc.) that TeX users are used to seeing.\n#\n# If quiet, discard, else redirect to the message flow.\nif $quiet; then\n  exec 5>/dev/null\nelse\n  exec 5>&1\nfi\n\n\n# Enable tracing, and auxiliary tools output.\n# \n# This fd should be used where you'd typically use /dev/null to throw\n# output away.  But sometimes it is convenient to see that output (e.g.,\n# from a grep) to aid debugging.  Especially debugging at distance, via\n# the user.\n# \nif $debug; then\n  exec 6>&1\n  set -vx\nelse\n  exec 6>/dev/null\nfi\n\n\n# \f Main program main loop - TeXify each file in turn.\nfor command_line_filename\ndo\n  verbose \"Processing $command_line_filename ...\"\n\n  input_file_name_decode\n\n  # `texinfo' or `latex'?\n  in_lang=`compute_language \"$command_line_filename\"`\n\n  # An auxiliary directory used for all the auxiliary tasks involved\n  # in compiling this document.\n  case $build_dir in\n      '' | . ) t2ddir=$out_noext.t2d ;;\n      *) # Avoid collisions between multiple occurrences of the same\n         # file, so depend on the output path.  Remove leading `./',\n         # at least to avoid creating a file starting with `.!', i.e.,\n         # an invisible file. The sed expression is fragile if the cwd\n         # has active characters.  Transform / into ! so that we don't\n         # need `mkdir -p'.  It might be something to reconsider.\n         t2ddir=$build_dir/`echo \"$out_dir_abs/$out_noext.t2d\" |\n             $SED \"s,^$orig_pwd/,,;s,^\\./,,;s,/,!,g\"`\n  esac\n  # Remove it at exit if clean mode.\n  trap \"cleanup\" 0 1 2 15\n\n  ensure_dir \"$build_dir\" \"$t2ddir\"\n\n  # Sometimes there are incompatibilities between auxiliary files for\n  # DVI and PDF.  The contents can also change whether we work on PDF\n  # and/or DVI.  So keep separate spaces for each.\n  workdir=$t2ddir/`out_lang_tex`\n  ensure_dir \"$workdir\"\n\n  # _build.  In a tidy build, where the auxiliary files are output.\n  if $tidy; then\n    work_build=$workdir/build\n  else\n    work_build=.\n  fi\n\n  # _bak.  Copies of the previous auxiliary files (another round is\n  # run if they differ from the new ones).\n  work_bak=$workdir/bak\n\n  # Make those directories.\n  ensure_dir \"$work_build\" \"$work_bak\"\n\n  # Decide how to find auxiliary files created by TeX.\n  decide_aux_files_method\n  \n  case $action in\n    compile)\n      # Compile the document.\n      compile\n      cleanup\n      ;;\n\n    mostly-clean)\n      xref_files_new=`generated_files_get`\n      mostly_clean\n      ;;\n  esac\ndone\n\nverbose \"done.\"\nexit 0 # exit successfully, not however we ended the loop.\n# Local Variables:\n# sh-basic-offset: 2\n# sh-indentation: 2\n# End:\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}