{
  "module_name": "ed25519.sh",
  "hash_id": "58f29d5169c702147f04c0d66811009179ed3730bc7edc2ed27c87198d8eb478",
  "original_prompt": "Ingested from openssh-9.6p1/ed25519.sh",
  "human_readable_source": "#!/bin/sh\n#       $OpenBSD: ed25519.sh,v 1.1 2023/01/15 23:05:32 djm Exp $\n#       Placed in the Public Domain.\n#\nAUTHOR=\"supercop-20221122/crypto_sign/ed25519/ref/implementors\"\nFILES=\"\n\tsupercop-20221122/crypto_verify/32/ref/verify.c\n\tsupercop-20221122/crypto_sign/ed25519/ref/fe25519.h\n\tsupercop-20221122/crypto_sign/ed25519/ref/fe25519.c\n\tsupercop-20221122/crypto_sign/ed25519/ref/sc25519.h\n\tsupercop-20221122/crypto_sign/ed25519/ref/sc25519.c\n\tsupercop-20221122/crypto_sign/ed25519/ref/ge25519.h\n\tsupercop-20221122/crypto_sign/ed25519/ref/ge25519.c\n\tsupercop-20221122/crypto_sign/ed25519/ref/keypair.c\n\tsupercop-20221122/crypto_sign/ed25519/ref/sign.c\n\tsupercop-20221122/crypto_sign/ed25519/ref/open.c\n\"\n###\n\nDATA=\"supercop-20221122/crypto_sign/ed25519/ref/ge25519_base.data\"\n\nset -e\ncd $1\necho -n '/*  $'\necho 'OpenBSD: $ */'\necho\necho '/*'\necho ' * Public Domain, Authors:'\nsed -e '/Alphabetical order:/d' -e 's/^/ * - /' < $AUTHOR\necho ' */'\necho\necho '#include <string.h>'\necho\necho '#include \"crypto_api.h\"'\necho\n# Map the types used in this code to the ones in crypto_api.h.  We use #define\n# instead of typedef since some systems have existing intXX types and do not\n# permit multiple typedefs even if they do not conflict.\nfor t in int8 uint8 int16 uint16 int32 uint32 int64 uint64; do\n\techo \"#define $t crypto_${t}\"\ndone\necho\nfor i in $FILES; do\n\techo \"/* from $i */\"\n\t# Changes to all files:\n\t#  - inline ge25519_base.data where it is included\n\t#  - expand CRYPTO_NAMESPACE() namespacing define\n\t#  - remove all includes, we inline everything required.\n\t#  - make functions not required elsewhere static.\n\t#  - rename the functions we do use.\n\tsed \\\n\t    -e \"/#include \\\"ge25519_base.data\\\"/r $DATA\" \\\n\t    -e \"/#include/d\" \\\n\t    -e \"s/^void /static void /g\" \\\n\t    -e 's/CRYPTO_NAMESPACE[(]\\([a-zA-Z0-9_]*\\)[)]/crypto_sign_ed25519_ref_\\1/g' \\\n\t    $i | \\\n\tcase \"$i\" in\n\t*/crypto_verify/32/ref/verify.c)\n\t    # rename crypto_verify() to the name that the ed25519 code expects.\n\t    sed -e \"/^#include.*/d\" \\\n\t        -e \"s/crypto_verify/crypto_verify_32/g\" \\\n\t        -e \"s/^int /static int /g\"\n\t    ;;\n\t*/crypto_sign/ed25519/ref/sign.c)\n\t    # rename signing function to the name OpenSSH expects\n\t    sed -e \"s/crypto_sign/crypto_sign_ed25519/g\"\n\t    ;;\n\t*/crypto_sign/ed25519/ref/keypair.c)\n\t    # rename key generation function to the name OpenSSH expects\n\t    sed -e \"s/crypto_sign_keypair/crypto_sign_ed25519_keypair/g\"\n\t    ;;\n\t*/crypto_sign/ed25519/ref/open.c)\n\t    # rename verification function to the name OpenSSH expects\n\t    sed -e \"s/crypto_sign_open/crypto_sign_ed25519_open/g\"\n\t    ;;\n\t*/crypto_sign/ed25519/ref/fe25519.*)\n\t    # avoid a couple of name collions with other files\n\t    sed -e \"s/reduce_add_sub/fe25519_reduce_add_sub/g\" \\\n\t        -e \"s/ equal[(]/ fe25519_equal(/g\" \\\n\t        -e \"s/^int /static int /g\"\n\t    ;;\n\t*/crypto_sign/ed25519/ref/sc25519.h)\n\t    # Lots of unused prototypes to remove\n\t    sed -e \"s/^int /static int /g\" \\\n\t        -e '/shortsc25519_from16bytes/d' \\\n\t        -e '/sc25519_iszero_vartime/d' \\\n\t        -e '/sc25519_isshort_vartime/d' \\\n\t        -e '/sc25519_lt_vartime/d' \\\n\t        -e '/sc25519_sub_nored/d' \\\n\t        -e '/sc25519_mul_shortsc/d' \\\n\t        -e '/sc25519_from_shortsc/d' \\\n\t        -e '/sc25519_window5/d'\n\t    ;;\n\t*/crypto_sign/ed25519/ref/sc25519.c)\n\t    # Lots of unused code to remove, some name collisions to avoid\n\t    sed -e \"s/reduce_add_sub/sc25519_reduce_add_sub/g\" \\\n\t        -e \"s/ equal[(]/ sc25519_equal(/g\" \\\n\t        -e \"s/^int /static int /g\" \\\n\t        -e \"s/m[[]/sc25519_m[/g\" \\\n\t        -e \"s/mu[[]/sc25519_mu[/g\" \\\n\t        -e '/shortsc25519_from16bytes/,/^}$/d' \\\n\t        -e '/sc25519_iszero_vartime/,/^}$/d' \\\n\t        -e '/sc25519_isshort_vartime/,/^}$/d' \\\n\t        -e '/sc25519_lt_vartime/,/^}$/d' \\\n\t        -e '/sc25519_sub_nored/,/^}$/d' \\\n\t        -e '/sc25519_mul_shortsc/,/^}$/d' \\\n\t        -e '/sc25519_from_shortsc/,/^}$/d' \\\n\t        -e '/sc25519_window5/,/^}$/d'\n\t    ;;\n\t*/crypto_sign/ed25519/ref//ge25519.*)\n\t    sed -e \"s/^int /static int /g\"\n\t    ;;\n\t# Default: pass through.\n\t*)\n\t    cat\n\t    ;;\n\tesac | \\\n\tsed -e 's/[\t ]*$//'\ndone\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}