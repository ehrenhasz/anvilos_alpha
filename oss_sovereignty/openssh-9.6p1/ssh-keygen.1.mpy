{
  "module_name": "ssh-keygen.1",
  "hash_id": "331f843a8cb6effc498cdb1cfb0ef1e95b5cd15ecefdae9f8607d965777c6eb6",
  "original_prompt": "Ingested from openssh-9.6p1/ssh-keygen.1",
  "human_readable_source": ".\\\"\t$OpenBSD: ssh-keygen.1,v 1.230 2023/09/04 10:29:58 job Exp $\n.\\\"\n.\\\" Author: Tatu Ylonen <ylo@cs.hut.fi>\n.\\\" Copyright (c) 1995 Tatu Ylonen <ylo@cs.hut.fi>, Espoo, Finland\n.\\\"                    All rights reserved\n.\\\"\n.\\\" As far as I am concerned, the code I have written for this software\n.\\\" can be used freely for any purpose.  Any derived versions of this\n.\\\" software must be clearly marked as such, and if the derived work is\n.\\\" incompatible with the protocol description in the RFC file, it must be\n.\\\" called by a name other than \"ssh\" or \"Secure Shell\".\n.\\\"\n.\\\"\n.\\\" Copyright (c) 1999,2000 Markus Friedl.  All rights reserved.\n.\\\" Copyright (c) 1999 Aaron Campbell.  All rights reserved.\n.\\\" Copyright (c) 1999 Theo de Raadt.  All rights reserved.\n.\\\"\n.\\\" Redistribution and use in source and binary forms, with or without\n.\\\" modification, are permitted provided that the following conditions\n.\\\" are met:\n.\\\" 1. Redistributions of source code must retain the above copyright\n.\\\"    notice, this list of conditions and the following disclaimer.\n.\\\" 2. Redistributions in binary form must reproduce the above copyright\n.\\\"    notice, this list of conditions and the following disclaimer in the\n.\\\"    documentation and/or other materials provided with the distribution.\n.\\\"\n.\\\" THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS OR\n.\\\" IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES\n.\\\" OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.\n.\\\" IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT, INDIRECT,\n.\\\" INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT\n.\\\" NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n.\\\" DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\n.\\\" THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n.\\\" (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF\n.\\\" THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n.\\\"\n.Dd $Mdocdate: September 4 2023 $\n.Dt SSH-KEYGEN 1\n.Os\n.Sh NAME\n.Nm ssh-keygen\n.Nd OpenSSH authentication key utility\n.Sh SYNOPSIS\n.Nm ssh-keygen\n.Op Fl q\n.Op Fl a Ar rounds\n.Op Fl b Ar bits\n.Op Fl C Ar comment\n.Op Fl f Ar output_keyfile\n.Op Fl m Ar format\n.Op Fl N Ar new_passphrase\n.Op Fl O Ar option\n.Op Fl t Cm dsa | ecdsa | ecdsa-sk | ed25519 | ed25519-sk | rsa\n.Op Fl w Ar provider\n.Op Fl Z Ar cipher\n.Nm ssh-keygen\n.Fl p\n.Op Fl a Ar rounds\n.Op Fl f Ar keyfile\n.Op Fl m Ar format\n.Op Fl N Ar new_passphrase\n.Op Fl P Ar old_passphrase\n.Op Fl Z Ar cipher\n.Nm ssh-keygen\n.Fl i\n.Op Fl f Ar input_keyfile\n.Op Fl m Ar key_format\n.Nm ssh-keygen\n.Fl e\n.Op Fl f Ar input_keyfile\n.Op Fl m Ar key_format\n.Nm ssh-keygen\n.Fl y\n.Op Fl f Ar input_keyfile\n.Nm ssh-keygen\n.Fl c\n.Op Fl a Ar rounds\n.Op Fl C Ar comment\n.Op Fl f Ar keyfile\n.Op Fl P Ar passphrase\n.Nm ssh-keygen\n.Fl l\n.Op Fl v\n.Op Fl E Ar fingerprint_hash\n.Op Fl f Ar input_keyfile\n.Nm ssh-keygen\n.Fl B\n.Op Fl f Ar input_keyfile\n.Nm ssh-keygen\n.Fl D Ar pkcs11\n.Nm ssh-keygen\n.Fl F Ar hostname\n.Op Fl lv\n.Op Fl f Ar known_hosts_file\n.Nm ssh-keygen\n.Fl H\n.Op Fl f Ar known_hosts_file\n.Nm ssh-keygen\n.Fl K\n.Op Fl a Ar rounds\n.Op Fl w Ar provider\n.Nm ssh-keygen\n.Fl R Ar hostname\n.Op Fl f Ar known_hosts_file\n.Nm ssh-keygen\n.Fl r Ar hostname\n.Op Fl g\n.Op Fl f Ar input_keyfile\n.Nm ssh-keygen\n.Fl M Cm generate\n.Op Fl O Ar option\n.Ar output_file\n.Nm ssh-keygen\n.Fl M Cm screen\n.Op Fl f Ar input_file\n.Op Fl O Ar option\n.Ar output_file\n.Nm ssh-keygen\n.Fl I Ar certificate_identity\n.Fl s Ar ca_key\n.Op Fl hU\n.Op Fl D Ar pkcs11_provider\n.Op Fl n Ar principals\n.Op Fl O Ar option\n.Op Fl V Ar validity_interval\n.Op Fl z Ar serial_number\n.Ar\n.Nm ssh-keygen\n.Fl L\n.Op Fl f Ar input_keyfile\n.Nm ssh-keygen\n.Fl A\n.Op Fl a Ar rounds\n.Op Fl f Ar prefix_path\n.Nm ssh-keygen\n.Fl k\n.Fl f Ar krl_file\n.Op Fl u\n.Op Fl s Ar ca_public\n.Op Fl z Ar version_number\n.Ar\n.Nm ssh-keygen\n.Fl Q\n.Op Fl l\n.Fl f Ar krl_file\n.Ar\n.Nm ssh-keygen\n.Fl Y Cm find-principals\n.Op Fl O Ar option\n.Fl s Ar signature_file\n.Fl f Ar allowed_signers_file\n.Nm ssh-keygen\n.Fl Y Cm match-principals\n.Fl I Ar signer_identity\n.Fl f Ar allowed_signers_file\n.Nm ssh-keygen\n.Fl Y Cm check-novalidate\n.Op Fl O Ar option\n.Fl n Ar namespace\n.Fl s Ar signature_file\n.Nm ssh-keygen\n.Fl Y Cm sign\n.Op Fl O Ar option\n.Fl f Ar key_file\n.Fl n Ar namespace\n.Ar\n.Nm ssh-keygen\n.Fl Y Cm verify\n.Op Fl O Ar option\n.Fl f Ar allowed_signers_file\n.Fl I Ar signer_identity\n.Fl n Ar namespace\n.Fl s Ar signature_file\n.Op Fl r Ar revocation_file\n.Sh DESCRIPTION\n.Nm\ngenerates, manages and converts authentication keys for\n.Xr ssh 1 .\n.Nm\ncan create keys for use by SSH protocol version 2.\n.Pp\nThe type of key to be generated is specified with the\n.Fl t\noption.\nIf invoked without any arguments,\n.Nm\nwill generate an Ed25519 key.\n.Pp\n.Nm\nis also used to generate groups for use in Diffie-Hellman group\nexchange (DH-GEX).\nSee the\n.Sx MODULI GENERATION\nsection for details.\n.Pp\nFinally,\n.Nm\ncan be used to generate and update Key Revocation Lists, and to test whether\ngiven keys have been revoked by one.\nSee the\n.Sx KEY REVOCATION LISTS\nsection for details.\n.Pp\nNormally each user wishing to use SSH\nwith public key authentication runs this once to create the authentication\nkey in\n.Pa ~/.ssh/id_dsa ,\n.Pa ~/.ssh/id_ecdsa ,\n.Pa ~/.ssh/id_ecdsa_sk ,\n.Pa ~/.ssh/id_ed25519 ,\n.Pa ~/.ssh/id_ed25519_sk\nor\n.Pa ~/.ssh/id_rsa .\nAdditionally, the system administrator may use this to generate host keys,\nas seen in\n.Pa /etc/rc .\n.Pp\nNormally this program generates the key and asks for a file in which\nto store the private key.\nThe public key is stored in a file with the same name but\n.Dq .pub\nappended.\nThe program also asks for a passphrase.\nThe passphrase may be empty to indicate no passphrase\n(host keys must have an empty passphrase), or it may be a string of\narbitrary length.\nA passphrase is similar to a password, except it can be a phrase with a\nseries of words, punctuation, numbers, whitespace, or any string of\ncharacters you want.\nGood passphrases are 10-30 characters long, are\nnot simple sentences or otherwise easily guessable (English\nprose has only 1-2 bits of entropy per character, and provides very bad\npassphrases), and contain a mix of upper and lowercase letters,\nnumbers, and non-alphanumeric characters.\nThe passphrase can be changed later by using the\n.Fl p\noption.\n.Pp\nThere is no way to recover a lost passphrase.\nIf the passphrase is lost or forgotten, a new key must be generated\nand the corresponding public key copied to other machines.\n.Pp\n.Nm\nwill by default write keys in an OpenSSH-specific format.\nThis format is preferred as it offers better protection for\nkeys at rest as well as allowing storage of key comments within\nthe private key file itself.\nThe key comment may be useful to help identify the key.\nThe comment is initialized to\n.Dq user@host\nwhen the key is created, but can be changed using the\n.Fl c\noption.\n.Pp\nIt is still possible for\n.Nm\nto write the previously-used PEM format private keys using the\n.Fl m\nflag.\nThis may be used when generating new keys, and existing new-format\nkeys may be converted using this option in conjunction with the\n.Fl p\n(change passphrase) flag.\n.Pp\nAfter a key is generated,\n.Nm\nwill ask where the keys\nshould be placed to be activated.\n.Pp\nThe options are as follows:\n.Bl -tag -width Ds\n.It Fl A\nGenerate host keys of all default key types (rsa, ecdsa, and\ned25519) if they do not already exist.\nThe host keys are generated with the default key file path,\nan empty passphrase, default bits for the key type, and default comment.\nIf\n.Fl f\nhas also been specified, its argument is used as a prefix to the\ndefault path for the resulting host key files.\nThis is used by\n.Pa /etc/rc\nto generate new host keys.\n.It Fl a Ar rounds\nWhen saving a private key, this option specifies the number of KDF\n(key derivation function, currently\n.Xr bcrypt_pbkdf 3 )\nrounds used.\nHigher numbers result in slower passphrase verification and increased\nresistance to brute-force password cracking (should the keys be stolen).\nThe default is 16 rounds.\n.It Fl B\nShow the bubblebabble digest of specified private or public key file.\n.It Fl b Ar bits\nSpecifies the number of bits in the key to create.\nFor RSA keys, the minimum size is 1024 bits and the default is 3072 bits.\nGenerally, 3072 bits is considered sufficient.\nDSA keys must be exactly 1024 bits as specified by FIPS 186-2.\nFor ECDSA keys, the\n.Fl b\nflag determines the key length by selecting from one of three elliptic\ncurve sizes: 256, 384 or 521 bits.\nAttempting to use bit lengths other than these three values for ECDSA keys\nwill fail.\nECDSA-SK, Ed25519 and Ed25519-SK keys have a fixed length and the\n.Fl b\nflag will be ignored.\n.It Fl C Ar comment\nProvides a new comment.\n.It Fl c\nRequests changing the comment in the private and public key files.\nThe program will prompt for the file containing the private keys, for\nthe passphrase if the key has one, and for the new comment.\n.It Fl D Ar pkcs11\nDownload the public keys provided by the PKCS#11 shared library\n.Ar pkcs11 .\nWhen used in combination with\n.Fl s ,\nthis option indicates that a CA key resides in a PKCS#11 token (see the\n.Sx CERTIFICATES\nsection for details).\n.It Fl E Ar fingerprint_hash\nSpecifies the hash algorithm used when displaying key fingerprints.\nValid options are:\n.Dq md5\nand\n.Dq sha256 .\nThe default is\n.Dq sha256 .\n.It Fl e\nThis option will read a private or public OpenSSH key file and\nprint to stdout a public key in one of the formats specified by the\n.Fl m\noption.\nThe default export format is\n.Dq RFC4716 .\nThis option allows exporting OpenSSH keys for use by other programs, including\nseveral commercial SSH implementations.\n.It Fl F Ar hostname | [hostname]:port\nSearch for the specified\n.Ar hostname\n(with optional port number)\nin a\n.Pa known_hosts\nfile, listing any occurrences found.\nThis option is useful to find hashed host names or addresses and may also be\nused in conjunction with the\n.Fl H\noption to print found keys in a hashed format.\n.It Fl f Ar filename\nSpecifies the filename of the key file.\n.It Fl g\nUse generic DNS format when printing fingerprint resource records using the\n.Fl r\ncommand.\n.It Fl H\nHash a\n.Pa known_hosts\nfile.\nThis replaces all hostnames and addresses with hashed representations\nwithin the specified file; the original content is moved to a file with\na .old suffix.\nThese hashes may be used normally by\n.Nm ssh\nand\n.Nm sshd ,\nbut they do not reveal identifying information should the file's contents\nbe disclosed.\nThis option will not modify existing hashed hostnames and is therefore safe\nto use on files that mix hashed and non-hashed names.\n.It Fl h\nWhen signing a key, create a host certificate instead of a user\ncertificate.\nSee the\n.Sx CERTIFICATES\nsection for details.\n.It Fl I Ar certificate_identity\nSpecify the key identity when signing a public key.\nSee the\n.Sx CERTIFICATES\nsection for details.\n.It Fl i\nThis option will read an unencrypted private (or public) key file\nin the format specified by the\n.Fl m\noption and print an OpenSSH compatible private\n(or public) key to stdout.\nThis option allows importing keys from other software, including several\ncommercial SSH implementations.\nThe default import format is\n.Dq RFC4716 .\n.It Fl K\nDownload resident keys from a FIDO authenticator.\nPublic and private key files will be written to the current directory for\neach downloaded key.\nIf multiple FIDO authenticators are attached, keys will be downloaded from\nthe first touched authenticator.\nSee the\n.Sx FIDO AUTHENTICATOR\nsection for more information.\n.It Fl k\nGenerate a KRL file.\nIn this mode,\n.Nm\nwill generate a KRL file at the location specified via the\n.Fl f\nflag that revokes every key or certificate presented on the command line.\nKeys/certificates to be revoked may be specified by public key file or\nusing the format described in the\n.Sx KEY REVOCATION LISTS\nsection.\n.It Fl L\nPrints the contents of one or more certificates.\n.It Fl l\nShow fingerprint of specified public key file.\nFor RSA and DSA keys\n.Nm\ntries to find the matching public key file and prints its fingerprint.\nIf combined with\n.Fl v ,\na visual ASCII art representation of the key is supplied with the\nfingerprint.\n.It Fl M Cm generate\nGenerate candidate Diffie-Hellman Group Exchange (DH-GEX) parameters for\neventual use by the\n.Sq diffie-hellman-group-exchange-*\nkey exchange methods.\nThe numbers generated by this operation must be further screened before\nuse.\nSee the\n.Sx MODULI GENERATION\nsection for more information.\n.It Fl M Cm screen\nScreen candidate parameters for Diffie-Hellman Group Exchange.\nThis will accept a list of candidate numbers and test that they are\nsafe (Sophie Germain) primes with acceptable group generators.\nThe results of this operation may be added to the\n.Pa /etc/moduli\nfile.\nSee the\n.Sx MODULI GENERATION\nsection for more information.\n.It Fl m Ar key_format\nSpecify a key format for key generation, the\n.Fl i\n(import),\n.Fl e\n(export) conversion options, and the\n.Fl p\nchange passphrase operation.\nThe latter may be used to convert between OpenSSH private key and PEM\nprivate key formats.\nThe supported key formats are:\n.Dq RFC4716\n(RFC 4716/SSH2 public or private key),\n.Dq PKCS8\n(PKCS8 public or private key)\nor\n.Dq PEM\n(PEM public key).\nBy default OpenSSH will write newly-generated private keys in its own\nformat, but when converting public keys for export the default format is\n.Dq RFC4716 .\nSetting a format of\n.Dq PEM\nwhen generating or updating a supported private key type will cause the\nkey to be stored in the legacy PEM private key format.\n.It Fl N Ar new_passphrase\nProvides the new passphrase.\n.It Fl n Ar principals\nSpecify one or more principals (user or host names) to be included in\na certificate when signing a key.\nMultiple principals may be specified, separated by commas.\nSee the\n.Sx CERTIFICATES\nsection for details.\n.It Fl O Ar option\nSpecify a key/value option.\nThese are specific to the operation that\n.Nm\nhas been requested to perform.\n.Pp\nWhen signing certificates, one of the options listed in the\n.Sx CERTIFICATES\nsection may be specified here.\n.Pp\nWhen performing moduli generation or screening, one of the options\nlisted in the\n.Sx MODULI GENERATION\nsection may be specified.\n.Pp\nWhen generating FIDO authenticator-backed keys, the options listed in the\n.Sx FIDO AUTHENTICATOR\nsection may be specified.\n.Pp\nWhen performing signature-related options using the\n.Fl Y\nflag, the following options are accepted:\n.Bl -tag -width Ds\n.It Cm hashalg Ns = Ns Ar algorithm\nSelects the hash algorithm to use for hashing the message to be signed.\nValid algorithms are\n.Dq sha256\nand\n.Dq sha512.\nThe default is\n.Dq sha512.\n.It Cm print-pubkey\nPrint the full public key to standard output after signature verification.\n.It Cm verify-time Ns = Ns Ar timestamp\nSpecifies a time to use when validating signatures instead of the current\ntime.\nThe time may be specified as a date or time in the YYYYMMDD[Z] or\nin YYYYMMDDHHMM[SS][Z] formats.\nDates and times will be interpreted in the current system time zone unless\nsuffixed with a Z character, which causes them to be interpreted in the\nUTC time zone.\n.El\n.Pp\nWhen generating SSHFP DNS records from public keys using the\n.Fl r\nflag, the following options are accepted:\n.Bl -tag -width Ds\n.It Cm hashalg Ns = Ns Ar algorithm\nSelects a hash algorithm to use when printing SSHFP records using the\n.Fl D\nflag.\nValid algorithms are\n.Dq sha1\nand\n.Dq sha256 .\nThe default is to print both.\n.El\n.Pp\nThe\n.Fl O\noption may be specified multiple times.\n.It Fl P Ar passphrase\nProvides the (old) passphrase.\n.It Fl p\nRequests changing the passphrase of a private key file instead of\ncreating a new private key.\nThe program will prompt for the file\ncontaining the private key, for the old passphrase, and twice for the\nnew passphrase.\n.It Fl Q\nTest whether keys have been revoked in a KRL.\nIf the\n.Fl l\noption is also specified then the contents of the KRL will be printed.\n.It Fl q\nSilence\n.Nm ssh-keygen .\n.It Fl R Ar hostname | [hostname]:port\nRemoves all keys belonging to the specified\n.Ar hostname\n(with optional port number)\nfrom a\n.Pa known_hosts\nfile.\nThis option is useful to delete hashed hosts (see the\n.Fl H\noption above).\n.It Fl r Ar hostname\nPrint the SSHFP fingerprint resource record named\n.Ar hostname\nfor the specified public key file.\n.It Fl s Ar ca_key\nCertify (sign) a public key using the specified CA key.\nSee the\n.Sx CERTIFICATES\nsection for details.\n.Pp\nWhen generating a KRL,\n.Fl s\nspecifies a path to a CA public key file used to revoke certificates directly\nby key ID or serial number.\nSee the\n.Sx KEY REVOCATION LISTS\nsection for details.\n.It Fl t Cm dsa | ecdsa | ecdsa-sk | ed25519 | ed25519-sk | rsa\nSpecifies the type of key to create.\nThe possible values are\n.Dq dsa ,\n.Dq ecdsa ,\n.Dq ecdsa-sk ,\n.Dq ed25519 ,\n.Dq ed25519-sk ,\nor\n.Dq rsa .\n.Pp\nThis flag may also be used to specify the desired signature type when\nsigning certificates using an RSA CA key.\nThe available RSA signature variants are\n.Dq ssh-rsa\n(SHA1 signatures, not recommended),\n.Dq rsa-sha2-256 ,\nand\n.Dq rsa-sha2-512\n(the default).\n.It Fl U\nWhen used in combination with\n.Fl s\nor\n.Fl Y Cm sign ,\nthis option indicates that a CA key resides in a\n.Xr ssh-agent 1 .\nSee the\n.Sx CERTIFICATES\nsection for more information.\n.It Fl u\nUpdate a KRL.\nWhen specified with\n.Fl k ,\nkeys listed via the command line are added to the existing KRL rather than\na new KRL being created.\n.It Fl V Ar validity_interval\nSpecify a validity interval when signing a certificate.\nA validity interval may consist of a single time, indicating that the\ncertificate is valid beginning now and expiring at that time, or may consist\nof two times separated by a colon to indicate an explicit time interval.\n.Pp\nThe start time may be specified as:\n.Bl -bullet -compact\n.It\nThe string\n.Dq always\nto indicate the certificate has no specified start time.\n.It\nA date or time in the system time zone formatted as YYYYMMDD or\nYYYYMMDDHHMM[SS].\n.It\nA date or time in the UTC time zone as YYYYMMDDZ or YYYYMMDDHHMM[SS]Z.\n.It\nA relative time before the current system time consisting of a minus sign\nfollowed by an interval in the format described in the\nTIME FORMATS section of\n.Xr sshd_config 5 .\n.It\nA raw seconds since epoch (Jan 1 1970 00:00:00 UTC) as a hexadecimal\nnumber beginning with\n.Dq 0x .\n.El\n.Pp\nThe end time may be specified similarly to the start time:\n.Bl -bullet -compact\n.It\nThe string\n.Dq forever\nto indicate the certificate has no specified end time.\n.It\nA date or time in the system time zone formatted as YYYYMMDD or\nYYYYMMDDHHMM[SS].\n.It\nA date or time in the UTC time zone as YYYYMMDDZ or YYYYMMDDHHMM[SS]Z.\n.It\nA relative time after the current system time consisting of a plus sign\nfollowed by an interval in the format described in the\nTIME FORMATS section of\n.Xr sshd_config 5 .\n.It\nA raw seconds since epoch (Jan 1 1970 00:00:00 UTC) as a hexadecimal\nnumber beginning with\n.Dq 0x .\n.El\n.Pp\nFor example:\n.Bl -tag -width Ds\n.It +52w1d\nValid from now to 52 weeks and one day from now.\n.It -4w:+4w\nValid from four weeks ago to four weeks from now.\n.It 20100101123000:20110101123000\nValid from 12:30 PM, January 1st, 2010 to 12:30 PM, January 1st, 2011.\n.It 20100101123000Z:20110101123000Z\nSimilar, but interpreted in the UTC time zone rather than the system time zone.\n.It -1d:20110101\nValid from yesterday to midnight, January 1st, 2011.\n.It 0x1:0x2000000000\nValid from roughly early 1970 to May 2033.\n.It -1m:forever\nValid from one minute ago and never expiring.\n.El\n.It Fl v\nVerbose mode.\nCauses\n.Nm\nto print debugging messages about its progress.\nThis is helpful for debugging moduli generation.\nMultiple\n.Fl v\noptions increase the verbosity.\nThe maximum is 3.\n.It Fl w Ar provider\nSpecifies a path to a library that will be used when creating\nFIDO authenticator-hosted keys, overriding the default of using\nthe internal USB HID support.\n.It Fl Y Cm find-principals\nFind the principal(s) associated with the public key of a signature,\nprovided using the\n.Fl s\nflag in an authorized signers file provided using the\n.Fl f\nflag.\nThe format of the allowed signers file is documented in the\n.Sx ALLOWED SIGNERS\nsection below.\nIf one or more matching principals are found, they are returned on\nstandard output.\n.It Fl Y Cm match-principals\nFind principal matching the principal name provided using the\n.Fl I\nflag in the authorized signers file specified using the\n.Fl f\nflag.\nIf one or more matching principals are found, they are returned on\nstandard output.\n.It Fl Y Cm check-novalidate\nChecks that a signature generated using\n.Nm\n.Fl Y Cm sign\nhas a valid structure.\nThis does not validate if a signature comes from an authorized signer.\nWhen testing a signature,\n.Nm\naccepts a message on standard input and a signature namespace using\n.Fl n .\nA file containing the corresponding signature must also be supplied using the\n.Fl s\nflag.\nSuccessful testing of the signature is signalled by\n.Nm\nreturning a zero exit status.\n.It Fl Y Cm sign\nCryptographically sign a file or some data using an SSH key.\nWhen signing,\n.Nm\naccepts zero or more files to sign on the command-line - if no files\nare specified then\n.Nm\nwill sign data presented on standard input.\nSignatures are written to the path of the input file with\n.Dq .sig\nappended, or to standard output if the message to be signed was read from\nstandard input.\n.Pp\nThe key used for signing is specified using the\n.Fl f\noption and may refer to either a private key, or a public key with the private\nhalf available via\n.Xr ssh-agent 1 .\nAn additional signature namespace, used to prevent signature confusion across\ndifferent domains of use (e.g. file signing vs email signing) must be provided\nvia the\n.Fl n\nflag.\nNamespaces are arbitrary strings, and may include:\n.Dq file\nfor file signing,\n.Dq email\nfor email signing.\nFor custom uses, it is recommended to use names following a\nNAMESPACE@YOUR.DOMAIN pattern to generate unambiguous namespaces.\n.It Fl Y Cm verify\nRequest to verify a signature generated using\n.Nm\n.Fl Y Cm sign\nas described above.\nWhen verifying a signature,\n.Nm\naccepts a message on standard input and a signature namespace using\n.Fl n .\nA file containing the corresponding signature must also be supplied using the\n.Fl s\nflag, along with the identity of the signer using\n.Fl I\nand a list of allowed signers via the\n.Fl f\nflag.\nThe format of the allowed signers file is documented in the\n.Sx ALLOWED SIGNERS\nsection below.\nA file containing revoked keys can be passed using the\n.Fl r\nflag.\nThe revocation file may be a KRL or a one-per-line list of public keys.\nSuccessful verification by an authorized signer is signalled by\n.Nm\nreturning a zero exit status.\n.It Fl y\nThis option will read a private\nOpenSSH format file and print an OpenSSH public key to stdout.\n.It Fl Z Ar cipher\nSpecifies the cipher to use for encryption when writing an OpenSSH-format\nprivate key file.\nThe list of available ciphers may be obtained using\n.Qq ssh -Q cipher .\nThe default is\n.Dq aes256-ctr .\n.It Fl z Ar serial_number\nSpecifies a serial number to be embedded in the certificate to distinguish\nthis certificate from others from the same CA.\nIf the\n.Ar serial_number\nis prefixed with a\n.Sq +\ncharacter, then the serial number will be incremented for each certificate\nsigned on a single command-line.\nThe default serial number is zero.\n.Pp\nWhen generating a KRL, the\n.Fl z\nflag is used to specify a KRL version number.\n.El\n.Sh MODULI GENERATION\n.Nm\nmay be used to generate groups for the Diffie-Hellman Group Exchange\n(DH-GEX) protocol.\nGenerating these groups is a two-step process: first, candidate\nprimes are generated using a fast, but memory intensive process.\nThese candidate primes are then tested for suitability (a CPU-intensive\nprocess).\n.Pp\nGeneration of primes is performed using the\n.Fl M Cm generate\noption.\nThe desired length of the primes may be specified by the\n.Fl O Cm bits\noption.\nFor example:\n.Pp\n.Dl # ssh-keygen -M generate -O bits=2048 moduli-2048.candidates\n.Pp\nBy default, the search for primes begins at a random point in the\ndesired length range.\nThis may be overridden using the\n.Fl O Cm start\noption, which specifies a different start point (in hex).\n.Pp\nOnce a set of candidates have been generated, they must be screened for\nsuitability.\nThis may be performed using the\n.Fl M Cm screen\noption.\nIn this mode\n.Nm\nwill read candidates from standard input (or a file specified using the\n.Fl f\noption).\nFor example:\n.Pp\n.Dl # ssh-keygen -M screen -f moduli-2048.candidates moduli-2048\n.Pp\nBy default, each candidate will be subjected to 100 primality tests.\nThis may be overridden using the\n.Fl O Cm prime-tests\noption.\nThe DH generator value will be chosen automatically for the\nprime under consideration.\nIf a specific generator is desired, it may be requested using the\n.Fl O Cm generator\noption.\nValid generator values are 2, 3, and 5.\n.Pp\nScreened DH groups may be installed in\n.Pa /etc/moduli .\nIt is important that this file contains moduli of a range of bit lengths.\n.Pp\nA number of options are available for moduli generation and screening via the\n.Fl O\nflag:\n.Bl -tag -width Ds\n.It Ic lines Ns = Ns Ar number\nExit after screening the specified number of lines while performing DH\ncandidate screening.\n.It Ic start-line Ns = Ns Ar line-number\nStart screening at the specified line number while performing DH candidate\nscreening.\n.It Ic checkpoint Ns = Ns Ar filename\nWrite the last line processed to the specified file while performing DH\ncandidate screening.\nThis will be used to skip lines in the input file that have already been\nprocessed if the job is restarted.\n.It Ic memory Ns = Ns Ar mbytes\nSpecify the amount of memory to use (in megabytes) when generating\ncandidate moduli for DH-GEX.\n.It Ic start Ns = Ns Ar hex-value\nSpecify start point (in hex) when generating candidate moduli for DH-GEX.\n.It Ic generator Ns = Ns Ar value\nSpecify desired generator (in decimal) when testing candidate moduli for DH-GEX.\n.El\n.Sh CERTIFICATES\n.Nm\nsupports signing of keys to produce certificates that may be used for\nuser or host authentication.\nCertificates consist of a public key, some identity information, zero or\nmore principal (user or host) names and a set of options that\nare signed by a Certification Authority (CA) key.\nClients or servers may then trust only the CA key and verify its signature\non a certificate rather than trusting many user/host keys.\nNote that OpenSSH certificates are a different, and much simpler, format to\nthe X.509 certificates used in\n.Xr ssl 8 .\n.Pp\n.Nm\nsupports two types of certificates: user and host.\nUser certificates authenticate users to servers, whereas host certificates\nauthenticate server hosts to users.\nTo generate a user certificate:\n.Pp\n.Dl $ ssh-keygen -s /path/to/ca_key -I key_id /path/to/user_key.pub\n.Pp\nThe resultant certificate will be placed in\n.Pa /path/to/user_key-cert.pub .\nA host certificate requires the\n.Fl h\noption:\n.Pp\n.Dl $ ssh-keygen -s /path/to/ca_key -I key_id -h /path/to/host_key.pub\n.Pp\nThe host certificate will be output to\n.Pa /path/to/host_key-cert.pub .\n.Pp\nIt is possible to sign using a CA key stored in a PKCS#11 token by\nproviding the token library using\n.Fl D\nand identifying the CA key by providing its public half as an argument\nto\n.Fl s :\n.Pp\n.Dl $ ssh-keygen -s ca_key.pub -D libpkcs11.so -I key_id user_key.pub\n.Pp\nSimilarly, it is possible for the CA key to be hosted in a\n.Xr ssh-agent 1 .\nThis is indicated by the\n.Fl U\nflag and, again, the CA key must be identified by its public half.\n.Pp\n.Dl $ ssh-keygen -Us ca_key.pub -I key_id user_key.pub\n.Pp\nIn all cases,\n.Ar key_id\nis a \"key identifier\" that is logged by the server when the certificate\nis used for authentication.\n.Pp\nCertificates may be limited to be valid for a set of principal (user/host)\nnames.\nBy default, generated certificates are valid for all users or hosts.\nTo generate a certificate for a specified set of principals:\n.Pp\n.Dl $ ssh-keygen -s ca_key -I key_id -n user1,user2 user_key.pub\n.Dl \"$ ssh-keygen -s ca_key -I key_id -h -n host.domain host_key.pub\"\n.Pp\nAdditional limitations on the validity and use of user certificates may\nbe specified through certificate options.\nA certificate option may disable features of the SSH session, may be\nvalid only when presented from particular source addresses or may\nforce the use of a specific command.\n.Pp\nThe options that are valid for user certificates are:\n.Pp\n.Bl -tag -width Ds -compact\n.It Ic clear\nClear all enabled permissions.\nThis is useful for clearing the default set of permissions so permissions may\nbe added individually.\n.Pp\n.It Ic critical : Ns Ar name Ns Op Ns = Ns Ar contents\n.It Ic extension : Ns Ar name Ns Op Ns = Ns Ar contents\nIncludes an arbitrary certificate critical option or extension.\nThe specified\n.Ar name\nshould include a domain suffix, e.g.\\&\n.Dq name@example.com .\nIf\n.Ar contents\nis specified then it is included as the contents of the extension/option\nencoded as a string, otherwise the extension/option is created with no\ncontents (usually indicating a flag).\nExtensions may be ignored by a client or server that does not recognise them,\nwhereas unknown critical options will cause the certificate to be refused.\n.Pp\n.It Ic force-command Ns = Ns Ar command\nForces the execution of\n.Ar command\ninstead of any shell or command specified by the user when\nthe certificate is used for authentication.\n.Pp\n.It Ic no-agent-forwarding\nDisable\n.Xr ssh-agent 1\nforwarding (permitted by default).\n.Pp\n.It Ic no-port-forwarding\nDisable port forwarding (permitted by default).\n.Pp\n.It Ic no-pty\nDisable PTY allocation (permitted by default).\n.Pp\n.It Ic no-user-rc\nDisable execution of\n.Pa ~/.ssh/rc\nby\n.Xr sshd 8\n(permitted by default).\n.Pp\n.It Ic no-x11-forwarding\nDisable X11 forwarding (permitted by default).\n.Pp\n.It Ic permit-agent-forwarding\nAllows\n.Xr ssh-agent 1\nforwarding.\n.Pp\n.It Ic permit-port-forwarding\nAllows port forwarding.\n.Pp\n.It Ic permit-pty\nAllows PTY allocation.\n.Pp\n.It Ic permit-user-rc\nAllows execution of\n.Pa ~/.ssh/rc\nby\n.Xr sshd 8 .\n.Pp\n.It Ic permit-X11-forwarding\nAllows X11 forwarding.\n.Pp\n.It Ic no-touch-required\nDo not require signatures made using this key include demonstration\nof user presence (e.g. by having the user touch the authenticator).\nThis option only makes sense for the FIDO authenticator algorithms\n.Cm ecdsa-sk\nand\n.Cm ed25519-sk .\n.Pp\n.It Ic source-address Ns = Ns Ar address_list\nRestrict the source addresses from which the certificate is considered valid.\nThe\n.Ar address_list\nis a comma-separated list of one or more address/netmask pairs in CIDR\nformat.\n.Pp\n.It Ic verify-required\nRequire signatures made using this key indicate that the user was first\nverified.\nThis option only makes sense for the FIDO authenticator algorithms\n.Cm ecdsa-sk\nand\n.Cm ed25519-sk .\nCurrently PIN authentication is the only supported verification method,\nbut other methods may be supported in the future.\n.El\n.Pp\nAt present, no standard options are valid for host keys.\n.Pp\nFinally, certificates may be defined with a validity lifetime.\nThe\n.Fl V\noption allows specification of certificate start and end times.\nA certificate that is presented at a time outside this range will not be\nconsidered valid.\nBy default, certificates are valid from the\n.Ux\nEpoch to the distant future.\n.Pp\nFor certificates to be used for user or host authentication, the CA\npublic key must be trusted by\n.Xr sshd 8\nor\n.Xr ssh 1 .\nRefer to those manual pages for details.\n.Sh FIDO AUTHENTICATOR\n.Nm\nis able to generate FIDO authenticator-backed keys, after which\nthey may be used much like any other key type supported by OpenSSH, so\nlong as the hardware authenticator is attached when the keys are used.\nFIDO authenticators generally require the user to explicitly authorise\noperations by touching or tapping them.\nFIDO keys consist of two parts: a key handle part stored in the\nprivate key file on disk, and a per-device private key that is unique\nto each FIDO authenticator and that cannot be exported from the\nauthenticator hardware.\nThese are combined by the hardware at authentication time to derive\nthe real key that is used to sign authentication challenges.\nSupported key types are\n.Cm ecdsa-sk\nand\n.Cm ed25519-sk .\n.Pp\nThe options that are valid for FIDO keys are:\n.Bl -tag -width Ds\n.It Cm application\nOverride the default FIDO application/origin string of\n.Dq ssh: .\nThis may be useful when generating host or domain-specific resident keys.\nThe specified application string must begin with\n.Dq ssh: .\n.It Cm challenge Ns = Ns Ar path\nSpecifies a path to a challenge string that will be passed to the\nFIDO authenticator during key generation.\nThe challenge string may be used as part of an out-of-band\nprotocol for key enrollment\n(a random challenge is used by default).\n.It Cm device\nExplicitly specify a\n.Xr fido 4\ndevice to use, rather than letting the authenticator middleware select one.\n.It Cm no-touch-required\nIndicate that the generated private key should not require touch\nevents (user presence) when making signatures.\nNote that\n.Xr sshd 8\nwill refuse such signatures by default, unless overridden via\nan authorized_keys option.\n.It Cm resident\nIndicate that the key handle should be stored on the FIDO\nauthenticator itself.\nThis makes it easier to use the authenticator on multiple computers.\nResident keys may be supported on FIDO2 authenticators and typically\nrequire that a PIN be set on the authenticator prior to generation.\nResident keys may be loaded off the authenticator using\n.Xr ssh-add 1 .\nStoring both parts of a key on a FIDO authenticator increases the likelihood\nof an attacker being able to use a stolen authenticator device.\n.It Cm user\nA username to be associated with a resident key,\noverriding the empty default username.\nSpecifying a username may be useful when generating multiple resident keys\nfor the same application name.\n.It Cm verify-required\nIndicate that this private key should require user verification for\neach signature.\nNot all FIDO authenticators support this option.\nCurrently PIN authentication is the only supported verification method,\nbut other methods may be supported in the future.\n.It Cm write-attestation Ns = Ns Ar path\nMay be used at key generation time to record the attestation data\nreturned from FIDO authenticators during key generation.\nThis information is potentially sensitive.\nBy default, this information is discarded.\n.El\n.Sh KEY REVOCATION LISTS\n.Nm\nis able to manage OpenSSH format Key Revocation Lists (KRLs).\nThese binary files specify keys or certificates to be revoked using a\ncompact format, taking as little as one bit per certificate if they are being\nrevoked by serial number.\n.Pp\nKRLs may be generated using the\n.Fl k\nflag.\nThis option reads one or more files from the command line and generates a new\nKRL.\nThe files may either contain a KRL specification (see below) or public keys,\nlisted one per line.\nPlain public keys are revoked by listing their hash or contents in the KRL and\ncertificates revoked by serial number or key ID (if the serial is zero or\nnot available).\n.Pp\nRevoking keys using a KRL specification offers explicit control over the\ntypes of record used to revoke keys and may be used to directly revoke\ncertificates by serial number or key ID without having the complete original\ncertificate on hand.\nA KRL specification consists of lines containing one of the following directives\nfollowed by a colon and some directive-specific information.\n.Bl -tag -width Ds\n.It Cm serial : Ar serial_number Ns Op - Ns Ar serial_number\nRevokes a certificate with the specified serial number.\nSerial numbers are 64-bit values, not including zero and may be expressed\nin decimal, hex or octal.\nIf two serial numbers are specified separated by a hyphen, then the range\nof serial numbers including and between each is revoked.\nThe CA key must have been specified on the\n.Nm\ncommand line using the\n.Fl s\noption.\n.It Cm id : Ar key_id\nRevokes a certificate with the specified key ID string.\nThe CA key must have been specified on the\n.Nm\ncommand line using the\n.Fl s\noption.\n.It Cm key : Ar public_key\nRevokes the specified key.\nIf a certificate is listed, then it is revoked as a plain public key.\n.It Cm sha1 : Ar public_key\nRevokes the specified key by including its SHA1 hash in the KRL.\n.It Cm sha256 : Ar public_key\nRevokes the specified key by including its SHA256 hash in the KRL.\nKRLs that revoke keys by SHA256 hash are not supported by OpenSSH versions\nprior to 7.9.\n.It Cm hash : Ar fingerprint\nRevokes a key using a fingerprint hash, as obtained from a\n.Xr sshd 8\nauthentication log message or the\n.Nm\n.Fl l\nflag.\nOnly SHA256 fingerprints are supported here and resultant KRLs are\nnot supported by OpenSSH versions prior to 7.9.\n.El\n.Pp\nKRLs may be updated using the\n.Fl u\nflag in addition to\n.Fl k .\nWhen this option is specified, keys listed via the command line are merged into\nthe KRL, adding to those already there.\n.Pp\nIt is also possible, given a KRL, to test whether it revokes a particular key\n(or keys).\nThe\n.Fl Q\nflag will query an existing KRL, testing each key specified on the command line.\nIf any key listed on the command line has been revoked (or an error encountered)\nthen\n.Nm\nwill exit with a non-zero exit status.\nA zero exit status will only be returned if no key was revoked.\n.Sh ALLOWED SIGNERS\nWhen verifying signatures,\n.Nm\nuses a simple list of identities and keys to determine whether a signature\ncomes from an authorized source.\nThis \"allowed signers\" file uses a format patterned after the\nAUTHORIZED_KEYS FILE FORMAT described in\n.Xr sshd 8 .\nEach line of the file contains the following space-separated fields:\nprincipals, options, keytype, base64-encoded key.\nEmpty lines and lines starting with a\n.Ql #\nare ignored as comments.\n.Pp\nThe principals field is a pattern-list (see PATTERNS in\n.Xr ssh_config 5 )\nconsisting of one or more comma-separated USER@DOMAIN identity patterns\nthat are accepted for signing.\nWhen verifying, the identity presented via the\n.Fl I\noption must match a principals pattern in order for the corresponding key to be\nconsidered acceptable for verification.\n.Pp\nThe options (if present) consist of comma-separated option specifications.\nNo spaces are permitted, except within double quotes.\nThe following option specifications are supported (note that option keywords\nare case-insensitive):\n.Bl -tag -width Ds\n.It Cm cert-authority\nIndicates that this key is accepted as a certificate authority (CA) and\nthat certificates signed by this CA may be accepted for verification.\n.It Cm namespaces Ns = Ns \"namespace-list\"\nSpecifies a pattern-list of namespaces that are accepted for this key.\nIf this option is present, the signature namespace embedded in the\nsignature object and presented on the verification command-line must\nmatch the specified list before the key will be considered acceptable.\n.It Cm valid-after Ns = Ns \"timestamp\"\nIndicates that the key is valid for use at or after the specified timestamp,\nwhich may be a date or time in the YYYYMMDD[Z] or YYYYMMDDHHMM[SS][Z] formats.\nDates and times will be interpreted in the current system time zone unless\nsuffixed with a Z character, which causes them to be interpreted in the UTC\ntime zone.\n.It Cm valid-before Ns = Ns \"timestamp\"\nIndicates that the key is valid for use at or before the specified timestamp.\n.El\n.Pp\nWhen verifying signatures made by certificates, the expected principal\nname must match both the principals pattern in the allowed signers file and\nthe principals embedded in the certificate itself.\n.Pp\nAn example allowed signers file:\n.Bd -literal -offset 3n\n# Comments allowed at start of line\nuser1@example.com,user2@example.com ssh-rsa AAAAX1...\n# A certificate authority, trusted for all principals in a domain.\n*@example.com cert-authority ssh-ed25519 AAAB4...\n# A key that is accepted only for file signing.\nuser2@example.com namespaces=\"file\" ssh-ed25519 AAA41...\n.Ed\n.Sh ENVIRONMENT\n.Bl -tag -width Ds\n.It Ev SSH_SK_PROVIDER\nSpecifies a path to a library that will be used when loading any\nFIDO authenticator-hosted keys, overriding the default of using\nthe built-in USB HID support.\n.El\n.Sh FILES\n.Bl -tag -width Ds -compact\n.It Pa ~/.ssh/id_dsa\n.It Pa ~/.ssh/id_ecdsa\n.It Pa ~/.ssh/id_ecdsa_sk\n.It Pa ~/.ssh/id_ed25519\n.It Pa ~/.ssh/id_ed25519_sk\n.It Pa ~/.ssh/id_rsa\nContains the DSA, ECDSA, authenticator-hosted ECDSA, Ed25519,\nauthenticator-hosted Ed25519 or RSA authentication identity of the user.\nThis file should not be readable by anyone but the user.\nIt is possible to\nspecify a passphrase when generating the key; that passphrase will be\nused to encrypt the private part of this file using 128-bit AES.\nThis file is not automatically accessed by\n.Nm\nbut it is offered as the default file for the private key.\n.Xr ssh 1\nwill read this file when a login attempt is made.\n.Pp\n.It Pa ~/.ssh/id_dsa.pub\n.It Pa ~/.ssh/id_ecdsa.pub\n.It Pa ~/.ssh/id_ecdsa_sk.pub\n.It Pa ~/.ssh/id_ed25519.pub\n.It Pa ~/.ssh/id_ed25519_sk.pub\n.It Pa ~/.ssh/id_rsa.pub\nContains the DSA, ECDSA, authenticator-hosted ECDSA, Ed25519,\nauthenticator-hosted Ed25519 or RSA public key for authentication.\nThe contents of this file should be added to\n.Pa ~/.ssh/authorized_keys\non all machines\nwhere the user wishes to log in using public key authentication.\nThere is no need to keep the contents of this file secret.\n.Pp\n.It Pa /etc/moduli\nContains Diffie-Hellman groups used for DH-GEX.\nThe file format is described in\n.Xr moduli 5 .\n.El\n.Sh SEE ALSO\n.Xr ssh 1 ,\n.Xr ssh-add 1 ,\n.Xr ssh-agent 1 ,\n.Xr moduli 5 ,\n.Xr sshd 8\n.Rs\n.%R RFC 4716\n.%T \"The Secure Shell (SSH) Public Key File Format\"\n.%D 2006\n.Re\n.Sh AUTHORS\nOpenSSH is a derivative of the original and free\nssh 1.2.12 release by Tatu Ylonen.\nAaron Campbell, Bob Beck, Markus Friedl, Niels Provos,\nTheo de Raadt and Dug Song\nremoved many bugs, re-added newer features and\ncreated OpenSSH.\nMarkus Friedl contributed the support for SSH\nprotocol versions 1.5 and 2.0.\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}