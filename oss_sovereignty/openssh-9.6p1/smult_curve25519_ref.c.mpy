{
  "module_name": "smult_curve25519_ref.c",
  "hash_id": "1dd902930f4038bfad45074530e02a9bd11d00434ac317095800e652147438ae",
  "original_prompt": "Ingested from openssh-9.6p1/smult_curve25519_ref.c",
  "human_readable_source": " \n \n\nint crypto_scalarmult_curve25519(unsigned char *, const unsigned char *, const unsigned char *);\n\nstatic void add(unsigned int out[32],const unsigned int a[32],const unsigned int b[32])\n{\n  unsigned int j;\n  unsigned int u;\n  u = 0;\n  for (j = 0;j < 31;++j) { u += a[j] + b[j]; out[j] = u & 255; u >>= 8; }\n  u += a[31] + b[31]; out[31] = u;\n}\n\nstatic void sub(unsigned int out[32],const unsigned int a[32],const unsigned int b[32])\n{\n  unsigned int j;\n  unsigned int u;\n  u = 218;\n  for (j = 0;j < 31;++j) {\n    u += a[j] + 65280 - b[j];\n    out[j] = u & 255;\n    u >>= 8;\n  }\n  u += a[31] - b[31];\n  out[31] = u;\n}\n\nstatic void squeeze(unsigned int a[32])\n{\n  unsigned int j;\n  unsigned int u;\n  u = 0;\n  for (j = 0;j < 31;++j) { u += a[j]; a[j] = u & 255; u >>= 8; }\n  u += a[31]; a[31] = u & 127;\n  u = 19 * (u >> 7);\n  for (j = 0;j < 31;++j) { u += a[j]; a[j] = u & 255; u >>= 8; }\n  u += a[31]; a[31] = u;\n}\n\nstatic const unsigned int minusp[32] = {\n 19, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 128\n} ;\n\nstatic void freeze(unsigned int a[32])\n{\n  unsigned int aorig[32];\n  unsigned int j;\n  unsigned int negative;\n\n  for (j = 0;j < 32;++j) aorig[j] = a[j];\n  add(a,a,minusp);\n  negative = -((a[31] >> 7) & 1);\n  for (j = 0;j < 32;++j) a[j] ^= negative & (aorig[j] ^ a[j]);\n}\n\nstatic void mult(unsigned int out[32],const unsigned int a[32],const unsigned int b[32])\n{\n  unsigned int i;\n  unsigned int j;\n  unsigned int u;\n\n  for (i = 0;i < 32;++i) {\n    u = 0;\n    for (j = 0;j <= i;++j) u += a[j] * b[i - j];\n    for (j = i + 1;j < 32;++j) u += 38 * a[j] * b[i + 32 - j];\n    out[i] = u;\n  }\n  squeeze(out);\n}\n\nstatic void mult121665(unsigned int out[32],const unsigned int a[32])\n{\n  unsigned int j;\n  unsigned int u;\n\n  u = 0;\n  for (j = 0;j < 31;++j) { u += 121665 * a[j]; out[j] = u & 255; u >>= 8; }\n  u += 121665 * a[31]; out[31] = u & 127;\n  u = 19 * (u >> 7);\n  for (j = 0;j < 31;++j) { u += out[j]; out[j] = u & 255; u >>= 8; }\n  u += out[j]; out[j] = u;\n}\n\nstatic void square(unsigned int out[32],const unsigned int a[32])\n{\n  unsigned int i;\n  unsigned int j;\n  unsigned int u;\n\n  for (i = 0;i < 32;++i) {\n    u = 0;\n    for (j = 0;j < i - j;++j) u += a[j] * a[i - j];\n    for (j = i + 1;j < i + 32 - j;++j) u += 38 * a[j] * a[i + 32 - j];\n    u *= 2;\n    if ((i & 1) == 0) {\n      u += a[i / 2] * a[i / 2];\n      u += 38 * a[i / 2 + 16] * a[i / 2 + 16];\n    }\n    out[i] = u;\n  }\n  squeeze(out);\n}\n\nstatic void select(unsigned int p[64],unsigned int q[64],const unsigned int r[64],const unsigned int s[64],unsigned int b)\n{\n  unsigned int j;\n  unsigned int t;\n  unsigned int bminus1;\n\n  bminus1 = b - 1;\n  for (j = 0;j < 64;++j) {\n    t = bminus1 & (r[j] ^ s[j]);\n    p[j] = s[j] ^ t;\n    q[j] = r[j] ^ t;\n  }\n}\n\nstatic void mainloop(unsigned int work[64],const unsigned char e[32])\n{\n  unsigned int xzm1[64];\n  unsigned int xzm[64];\n  unsigned int xzmb[64];\n  unsigned int xzm1b[64];\n  unsigned int xznb[64];\n  unsigned int xzn1b[64];\n  unsigned int a0[64];\n  unsigned int a1[64];\n  unsigned int b0[64];\n  unsigned int b1[64];\n  unsigned int c1[64];\n  unsigned int r[32];\n  unsigned int s[32];\n  unsigned int t[32];\n  unsigned int u[32];\n  unsigned int j;\n  unsigned int b;\n  int pos;\n\n  for (j = 0;j < 32;++j) xzm1[j] = work[j];\n  xzm1[32] = 1;\n  for (j = 33;j < 64;++j) xzm1[j] = 0;\n\n  xzm[0] = 1;\n  for (j = 1;j < 64;++j) xzm[j] = 0;\n\n  for (pos = 254;pos >= 0;--pos) {\n    b = e[pos / 8] >> (pos & 7);\n    b &= 1;\n    select(xzmb,xzm1b,xzm,xzm1,b);\n    add(a0,xzmb,xzmb + 32);\n    sub(a0 + 32,xzmb,xzmb + 32);\n    add(a1,xzm1b,xzm1b + 32);\n    sub(a1 + 32,xzm1b,xzm1b + 32);\n    square(b0,a0);\n    square(b0 + 32,a0 + 32);\n    mult(b1,a1,a0 + 32);\n    mult(b1 + 32,a1 + 32,a0);\n    add(c1,b1,b1 + 32);\n    sub(c1 + 32,b1,b1 + 32);\n    square(r,c1 + 32);\n    sub(s,b0,b0 + 32);\n    mult121665(t,s);\n    add(u,t,b0);\n    mult(xznb,b0,b0 + 32);\n    mult(xznb + 32,s,u);\n    square(xzn1b,c1);\n    mult(xzn1b + 32,r,work);\n    select(xzm,xzm1,xznb,xzn1b,b);\n  }\n\n  for (j = 0;j < 64;++j) work[j] = xzm[j];\n}\n\nstatic void recip(unsigned int out[32],const unsigned int z[32])\n{\n  unsigned int z2[32];\n  unsigned int z9[32];\n  unsigned int z11[32];\n  unsigned int z2_5_0[32];\n  unsigned int z2_10_0[32];\n  unsigned int z2_20_0[32];\n  unsigned int z2_50_0[32];\n  unsigned int z2_100_0[32];\n  unsigned int t0[32];\n  unsigned int t1[32];\n  int i;\n\n    square(z2,z);\n    square(t1,z2);\n    square(t0,t1);\n    mult(z9,t0,z);\n    mult(z11,z9,z2);\n    square(t0,z11);\n    mult(z2_5_0,t0,z9);\n\n    square(t0,z2_5_0);\n    square(t1,t0);\n    square(t0,t1);\n    square(t1,t0);\n    square(t0,t1);\n    mult(z2_10_0,t0,z2_5_0);\n\n    square(t0,z2_10_0);\n    square(t1,t0);\n    for (i = 2;i < 10;i += 2) { square(t0,t1); square(t1,t0); }\n    mult(z2_20_0,t1,z2_10_0);\n\n    square(t0,z2_20_0);\n    square(t1,t0);\n    for (i = 2;i < 20;i += 2) { square(t0,t1); square(t1,t0); }\n    mult(t0,t1,z2_20_0);\n\n    square(t1,t0);\n    square(t0,t1);\n    for (i = 2;i < 10;i += 2) { square(t1,t0); square(t0,t1); }\n    mult(z2_50_0,t0,z2_10_0);\n\n    square(t0,z2_50_0);\n    square(t1,t0);\n    for (i = 2;i < 50;i += 2) { square(t0,t1); square(t1,t0); }\n    mult(z2_100_0,t1,z2_50_0);\n\n    square(t1,z2_100_0);\n    square(t0,t1);\n    for (i = 2;i < 100;i += 2) { square(t1,t0); square(t0,t1); }\n    mult(t1,t0,z2_100_0);\n\n    square(t0,t1);\n    square(t1,t0);\n    for (i = 2;i < 50;i += 2) { square(t0,t1); square(t1,t0); }\n    mult(t0,t1,z2_50_0);\n\n    square(t1,t0);\n    square(t0,t1);\n    square(t1,t0);\n    square(t0,t1);\n    square(t1,t0);\n    mult(out,t1,z11);\n}\n\nint crypto_scalarmult_curve25519(unsigned char *q,\n  const unsigned char *n,\n  const unsigned char *p)\n{\n  unsigned int work[96];\n  unsigned char e[32];\n  unsigned int i;\n  for (i = 0;i < 32;++i) e[i] = n[i];\n  e[0] &= 248;\n  e[31] &= 127;\n  e[31] |= 64;\n  for (i = 0;i < 32;++i) work[i] = p[i];\n  mainloop(work,e);\n  recip(work + 32,work + 32);\n  mult(work + 64,work,work + 32);\n  freeze(work + 64);\n  for (i = 0;i < 32;++i) q[i] = work[64 + i];\n  return 0;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}