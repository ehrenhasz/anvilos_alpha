{
  "module_name": "servconf.h",
  "hash_id": "0a84399938ec413c723c914c031766edcec89410c177b13d1676d8c8903e2bea",
  "original_prompt": "Ingested from openssh-9.6p1/servconf.h",
  "human_readable_source": " \n\n \n\n#ifndef SERVCONF_H\n#define SERVCONF_H\n\n#include <openbsd-compat/sys-queue.h>\n\n#define MAX_PORTS\t\t256\t \n\n \n#define\tPERMIT_NOT_SET\t\t-1\n#define\tPERMIT_NO\t\t0\n#define\tPERMIT_FORCED_ONLY\t1\n#define\tPERMIT_NO_PASSWD\t2\n#define\tPERMIT_YES\t\t3\n\n \n#define PRIVSEP_OFF\t\t0\n#define PRIVSEP_ON\t\t1\n#define PRIVSEP_NOSANDBOX\t2\n\n \n#define PERMITOPEN_ANY\t\t0\n#define PERMITOPEN_NONE\t\t-2\n\n \n#define IGNORE_RHOSTS_NO\t0\n#define IGNORE_RHOSTS_YES\t1\n#define IGNORE_RHOSTS_SHOSTS\t2\n\n#define DEFAULT_AUTH_FAIL_MAX\t6\t \n#define DEFAULT_SESSIONS_MAX\t10\t \n\n \n#define INTERNAL_SFTP_NAME\t\"internal-sftp\"\n\n \n#define PUBKEYAUTH_TOUCH_REQUIRED\t(1)\n#define PUBKEYAUTH_VERIFY_REQUIRED\t(1<<1)\n\nstruct ssh;\nstruct fwd_perm_list;\n\n \nstruct queued_listenaddr {\n\tchar *addr;\n\tint port;  \n\tchar *rdomain;\n};\n\n \nstruct listenaddr {\n\tchar *rdomain;\n\tstruct addrinfo *addrs;\n};\n\ntypedef struct {\n\tu_int\tnum_ports;\n\tu_int\tports_from_cmdline;\n\tint\tports[MAX_PORTS];\t \n\tstruct queued_listenaddr *queued_listen_addrs;\n\tu_int\tnum_queued_listens;\n\tstruct listenaddr *listen_addrs;\n\tu_int\tnum_listen_addrs;\n\tint\taddress_family;\t\t \n\n\tchar\t*routing_domain;\t \n\n\tchar   **host_key_files;\t \n\tint\t*host_key_file_userprovided;  \n\tu_int\tnum_host_key_files;      \n\tchar   **host_cert_files;\t \n\tu_int\tnum_host_cert_files;\t \n\n\tchar   *host_key_agent;\t\t \n\tchar   *pid_file;\t\t \n\tchar   *moduli_file;\t\t \n\tint     login_grace_time;\t \n\tint     permit_root_login;\t \n\tint     ignore_rhosts;\t \n\tint     ignore_user_known_hosts;\t \n\tint     print_motd;\t \n\tint\tprint_lastlog;\t \n\tint     x11_forwarding;\t \n\tint     x11_display_offset;\t \n\tint     x11_use_localhost;\t \n\tchar   *xauth_location;\t \n\tint\tpermit_tty;\t \n\tint\tpermit_user_rc;\t \n\tint     strict_modes;\t \n\tint     tcp_keep_alive;\t \n\tint\tip_qos_interactive;\t \n\tint\tip_qos_bulk;\t\t \n\tchar   *ciphers;\t \n\tchar   *macs;\t\t \n\tchar   *kex_algorithms;\t \n\tstruct ForwardOptions fwd_opts;\t \n\tSyslogFacility log_facility;\t \n\tLogLevel log_level;\t \n\tu_int\tnum_log_verbose;\t \n\tchar\t**log_verbose;\n\tint     hostbased_authentication;\t \n\tint     hostbased_uses_name_from_packet_only;  \n\tchar   *hostbased_accepted_algos;  \n\tchar   *hostkeyalgorithms;\t \n\tchar   *ca_sign_algorithms;\t \n\tint     pubkey_authentication;\t \n\tchar   *pubkey_accepted_algos;\t \n\tint\tpubkey_auth_options;\t \n\tint     kerberos_authentication;\t \n\tint     kerberos_or_local_passwd;\t \n\tint     kerberos_ticket_cleanup;\t \n\tint     kerberos_get_afs_token;\t\t \n\tint     gss_authentication;\t \n\tint     gss_cleanup_creds;\t \n\tint     gss_strict_acceptor;\t \n\tint     password_authentication;\t \n\tint     kbd_interactive_authentication;\t \n\tint     permit_empty_passwd;\t \n\tint     permit_user_env;\t \n\tchar   *permit_user_env_allowlist;  \n\tint     compression;\t \n\tint\tallow_tcp_forwarding;  \n\tint\tallow_streamlocal_forwarding;  \n\tint\tallow_agent_forwarding;\n\tint\tdisable_forwarding;\n\tu_int num_allow_users;\n\tchar   **allow_users;\n\tu_int num_deny_users;\n\tchar   **deny_users;\n\tu_int num_allow_groups;\n\tchar   **allow_groups;\n\tu_int num_deny_groups;\n\tchar   **deny_groups;\n\n\tu_int num_subsystems;\n\tchar   **subsystem_name;\n\tchar   **subsystem_command;\n\tchar   **subsystem_args;\n\n\tu_int num_accept_env;\n\tchar   **accept_env;\n\tu_int num_setenv;\n\tchar   **setenv;\n\n\tint\tmax_startups_begin;\n\tint\tmax_startups_rate;\n\tint\tmax_startups;\n\tint\tper_source_max_startups;\n\tint\tper_source_masklen_ipv4;\n\tint\tper_source_masklen_ipv6;\n\tint\tmax_authtries;\n\tint\tmax_sessions;\n\tchar   *banner;\t\t\t \n\tint\tuse_dns;\n\tint\tclient_alive_interval;\t \n\tint\tclient_alive_count_max;\t \n\n\tu_int\tnum_authkeys_files;\t \n\tchar   **authorized_keys_files;\n\n\tchar   *adm_forced_command;\n\n\tint\tuse_pam;\t\t \n\n\tint\tpermit_tun;\n\n\tchar   **permitted_opens;\t \n\tu_int   num_permitted_opens;\n\tchar   **permitted_listens;  \n\tu_int   num_permitted_listens;\n\n\tchar   *chroot_directory;\n\tchar   *revoked_keys_file;\n\tchar   *trusted_user_ca_keys;\n\tchar   *authorized_keys_command;\n\tchar   *authorized_keys_command_user;\n\tchar   *authorized_principals_file;\n\tchar   *authorized_principals_command;\n\tchar   *authorized_principals_command_user;\n\n\tint64_t rekey_limit;\n\tint\trekey_interval;\n\n\tchar   *version_addendum;\t \n\n\tu_int\tnum_auth_methods;\n\tchar   **auth_methods;\n\n\tint\tfingerprint_hash;\n\tint\texpose_userauth_info;\n\tu_int64_t timing_secret;\n\tchar   *sk_provider;\n\tint\trequired_rsa_size;\t \n\n\tchar\t**channel_timeouts;\t \n\tu_int\tnum_channel_timeouts;\n\n\tint\tunused_connection_timeout;\n}       ServerOptions;\n\n \nstruct connection_info {\n\tconst char *user;\n\tconst char *host;\t \n\tconst char *address;\t \n\tconst char *laddress;\t \n\tint lport;\t\t \n\tconst char *rdomain;\t \n\tint test;\t\t \n};\n\n \nstruct include_item {\n\tchar *selector;\n\tchar *filename;\n\tstruct sshbuf *contents;\n\tTAILQ_ENTRY(include_item) entry;\n};\nTAILQ_HEAD(include_list, include_item);\n\n\n \n#define COPY_MATCH_STRING_OPTS() do { \\\n\t\tM_CP_STROPT(banner); \\\n\t\tM_CP_STROPT(trusted_user_ca_keys); \\\n\t\tM_CP_STROPT(revoked_keys_file); \\\n\t\tM_CP_STROPT(authorized_keys_command); \\\n\t\tM_CP_STROPT(authorized_keys_command_user); \\\n\t\tM_CP_STROPT(authorized_principals_file); \\\n\t\tM_CP_STROPT(authorized_principals_command); \\\n\t\tM_CP_STROPT(authorized_principals_command_user); \\\n\t\tM_CP_STROPT(hostbased_accepted_algos); \\\n\t\tM_CP_STROPT(pubkey_accepted_algos); \\\n\t\tM_CP_STROPT(ca_sign_algorithms); \\\n\t\tM_CP_STROPT(routing_domain); \\\n\t\tM_CP_STROPT(permit_user_env_allowlist); \\\n\t\tM_CP_STRARRAYOPT(authorized_keys_files, num_authkeys_files); \\\n\t\tM_CP_STRARRAYOPT(allow_users, num_allow_users); \\\n\t\tM_CP_STRARRAYOPT(deny_users, num_deny_users); \\\n\t\tM_CP_STRARRAYOPT(allow_groups, num_allow_groups); \\\n\t\tM_CP_STRARRAYOPT(deny_groups, num_deny_groups); \\\n\t\tM_CP_STRARRAYOPT(accept_env, num_accept_env); \\\n\t\tM_CP_STRARRAYOPT(setenv, num_setenv); \\\n\t\tM_CP_STRARRAYOPT(auth_methods, num_auth_methods); \\\n\t\tM_CP_STRARRAYOPT(permitted_opens, num_permitted_opens); \\\n\t\tM_CP_STRARRAYOPT(permitted_listens, num_permitted_listens); \\\n\t\tM_CP_STRARRAYOPT(channel_timeouts, num_channel_timeouts); \\\n\t\tM_CP_STRARRAYOPT(log_verbose, num_log_verbose); \\\n\t\tM_CP_STRARRAYOPT(subsystem_name, num_subsystems); \\\n\t\tM_CP_STRARRAYOPT(subsystem_command, num_subsystems); \\\n\t\tM_CP_STRARRAYOPT(subsystem_args, num_subsystems); \\\n\t} while (0)\n\nstruct connection_info *get_connection_info(struct ssh *, int, int);\nvoid\t initialize_server_options(ServerOptions *);\nvoid\t fill_default_server_options(ServerOptions *);\nint\t process_server_config_line(ServerOptions *, char *, const char *, int,\n\t    int *, struct connection_info *, struct include_list *includes);\nvoid\t process_permitopen(struct ssh *ssh, ServerOptions *options);\nvoid\t process_channel_timeouts(struct ssh *ssh, ServerOptions *);\nvoid\t load_server_config(const char *, struct sshbuf *);\nvoid\t parse_server_config(ServerOptions *, const char *, struct sshbuf *,\n\t    struct include_list *includes, struct connection_info *, int);\nvoid\t parse_server_match_config(ServerOptions *,\n\t    struct include_list *includes, struct connection_info *);\nint\t parse_server_match_testspec(struct connection_info *, char *);\nint\t server_match_spec_complete(struct connection_info *);\nvoid\t servconf_merge_subsystems(ServerOptions *, ServerOptions *);\nvoid\t copy_set_server_options(ServerOptions *, ServerOptions *, int);\nvoid\t dump_config(ServerOptions *);\nchar\t*derelativise_path(const char *);\nvoid\t servconf_add_hostkey(const char *, const int,\n\t    ServerOptions *, const char *path, int);\nvoid\t servconf_add_hostcert(const char *, const int,\n\t    ServerOptions *, const char *path);\n\n#endif\t\t\t\t \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}