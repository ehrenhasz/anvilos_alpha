{
  "module_name": "misc.h",
  "hash_id": "3c98bdb325126192ad81abbaf61d4405c4d984b40189bf620ba1dfd23f4a45b1",
  "original_prompt": "Ingested from openssh-9.6p1/misc.h",
  "human_readable_source": " \n\n \n\n#ifndef _MISC_H\n#define _MISC_H\n\n#include <sys/time.h>\n#include <sys/types.h>\n#include <sys/socket.h>\n#include <stdio.h>\n#include <signal.h>\n\n \nstruct Forward {\n\tchar\t *listen_host;\t\t \n\tint\t  listen_port;\t\t \n\tchar\t *listen_path;\t\t \n\tchar\t *connect_host;\t\t \n\tint\t  connect_port;\t\t \n\tchar\t *connect_path;\t\t \n\tint\t  allocated_port;\t \n\tint\t  handle;\t\t \n};\n\nint forward_equals(const struct Forward *, const struct Forward *);\nint daemonized(void);\n\n \nstruct ForwardOptions {\n\tint\t gateway_ports;  \n\tmode_t\t streamlocal_bind_mask;  \n\tint\t streamlocal_bind_unlink;  \n};\n\n \n\nchar\t*chop(char *);\nvoid\t rtrim(char *);\nvoid\tskip_space(char **);\nchar\t*strdelim(char **);\nchar\t*strdelimw(char **);\nint\t set_nonblock(int);\nint\t unset_nonblock(int);\nvoid\t set_nodelay(int);\nint\t set_reuseaddr(int);\nchar\t*get_rdomain(int);\nint\t set_rdomain(int, const char *);\nint\t get_sock_af(int);\nvoid\t set_sock_tos(int, int);\nint\t waitrfd(int, int *, volatile sig_atomic_t *);\nint\t timeout_connect(int, const struct sockaddr *, socklen_t, int *);\nint\t a2port(const char *);\nint\t a2tun(const char *, int *);\nchar\t*put_host_port(const char *, u_short);\nchar\t*hpdelim2(char **, char *);\nchar\t*hpdelim(char **);\nchar\t*cleanhostname(char *);\nchar\t*colon(char *);\nint\t parse_user_host_path(const char *, char **, char **, char **);\nint\t parse_user_host_port(const char *, char **, char **, int *);\nint\t parse_uri(const char *, const char *, char **, char **, int *, char **);\nint\t convtime(const char *);\nconst char *fmt_timeframe(time_t t);\nint\t tilde_expand(const char *, uid_t, char **);\nchar\t*tilde_expand_filename(const char *, uid_t);\n\nchar\t*dollar_expand(int *, const char *string, ...);\nchar\t*percent_expand(const char *, ...) __attribute__((__sentinel__));\nchar\t*percent_dollar_expand(const char *, ...) __attribute__((__sentinel__));\nchar\t*tohex(const void *, size_t);\nvoid\t xextendf(char **s, const char *sep, const char *fmt, ...)\n    __attribute__((__format__ (printf, 3, 4))) __attribute__((__nonnull__ (3)));\nvoid\t sanitise_stdfd(void);\nvoid\t ms_subtract_diff(struct timeval *, int *);\nvoid\t ms_to_timespec(struct timespec *, int);\nvoid\t monotime_ts(struct timespec *);\nvoid\t monotime_tv(struct timeval *);\ntime_t\t monotime(void);\ndouble\t monotime_double(void);\nvoid\t lowercase(char *s);\nint\t unix_listener(const char *, int, int);\nint\t valid_domain(char *, int, const char **);\nint\t valid_env_name(const char *);\nconst char *atoi_err(const char *, int *);\nint\t parse_absolute_time(const char *, uint64_t *);\nvoid\t format_absolute_time(uint64_t, char *, size_t);\nint\t parse_pattern_interval(const char *, char **, int *);\nint\t path_absolute(const char *);\nint\t stdfd_devnull(int, int, int);\nint\t lib_contains_symbol(const char *, const char *);\n\nvoid\t sock_set_v6only(int);\n\nstruct passwd *pwcopy(struct passwd *);\nconst char *ssh_gai_strerror(int);\n\ntypedef void privdrop_fn(struct passwd *);\ntypedef void privrestore_fn(void);\n#define\tSSH_SUBPROCESS_STDOUT_DISCARD\t(1)      \n#define\tSSH_SUBPROCESS_STDOUT_CAPTURE\t(1<<1)   \n#define\tSSH_SUBPROCESS_STDERR_DISCARD\t(1<<2)   \n#define\tSSH_SUBPROCESS_UNSAFE_PATH\t(1<<3)\t \n#define\tSSH_SUBPROCESS_PRESERVE_ENV\t(1<<4)\t \npid_t subprocess(const char *, const char *, int, char **, FILE **, u_int,\n    struct passwd *, privdrop_fn *, privrestore_fn *);\n\ntypedef struct arglist arglist;\nstruct arglist {\n\tchar    **list;\n\tu_int   num;\n\tu_int   nalloc;\n};\nvoid\t addargs(arglist *, char *, ...)\n\t    __attribute__((format(printf, 2, 3)));\nvoid\t replacearg(arglist *, u_int, char *, ...)\n\t    __attribute__((format(printf, 3, 4)));\nvoid\t freeargs(arglist *);\n\nint\t tun_open(int, int, char **);\n\n \n#define SSH_TUNMODE_NO\t\t0x00\n#define SSH_TUNMODE_POINTOPOINT\t0x01\n#define SSH_TUNMODE_ETHERNET\t0x02\n#define SSH_TUNMODE_DEFAULT\tSSH_TUNMODE_POINTOPOINT\n#define SSH_TUNMODE_YES\t\t(SSH_TUNMODE_POINTOPOINT|SSH_TUNMODE_ETHERNET)\n\n#define SSH_TUNID_ANY\t\t0x7fffffff\n#define SSH_TUNID_ERR\t\t(SSH_TUNID_ANY - 1)\n#define SSH_TUNID_MAX\t\t(SSH_TUNID_ANY - 2)\n\n \n#define PORT_STREAMLOCAL\t-2\n\n \nu_int64_t\tget_u64(const void *)\n    __attribute__((__bounded__( __minbytes__, 1, 8)));\nu_int32_t\tget_u32(const void *)\n    __attribute__((__bounded__( __minbytes__, 1, 4)));\nu_int16_t\tget_u16(const void *)\n    __attribute__((__bounded__( __minbytes__, 1, 2)));\nvoid\t\tput_u64(void *, u_int64_t)\n    __attribute__((__bounded__( __minbytes__, 1, 8)));\nvoid\t\tput_u32(void *, u_int32_t)\n    __attribute__((__bounded__( __minbytes__, 1, 4)));\nvoid\t\tput_u16(void *, u_int16_t)\n    __attribute__((__bounded__( __minbytes__, 1, 2)));\n\n \nu_int32_t\tget_u32_le(const void *)\n    __attribute__((__bounded__(__minbytes__, 1, 4)));\nvoid\t\tput_u32_le(void *, u_int32_t)\n    __attribute__((__bounded__(__minbytes__, 1, 4)));\n\nstruct bwlimit {\n\tsize_t buflen;\n\tu_int64_t rate;\t\t \n\tu_int64_t thresh;\t \n\tu_int64_t lamt;\t\t \n\tstruct timeval bwstart, bwend;\n};\n\nvoid bandwidth_limit_init(struct bwlimit *, u_int64_t, size_t);\nvoid bandwidth_limit(struct bwlimit *, size_t);\n\nint parse_ipqos(const char *);\nconst char *iptos2str(int);\nvoid mktemp_proto(char *, size_t);\n\nvoid\t child_set_env(char ***envp, u_int *envsizep, const char *name,\n\t    const char *value);\nconst char *lookup_env_in_list(const char *env,\n\t    char * const *envs, size_t nenvs);\nconst char *lookup_setenv_in_list(const char *env,\n\t    char * const *envs, size_t nenvs);\n\nint\t argv_split(const char *, int *, char ***, int);\nchar\t*argv_assemble(int, char **argv);\nchar\t*argv_next(int *, char ***);\nvoid\t argv_consume(int *);\nvoid\t argv_free(char **, int);\n\nint\t exited_cleanly(pid_t, const char *, const char *, int);\n\nstruct stat;\nint\t safe_path(const char *, struct stat *, const char *, uid_t,\n\t    char *, size_t);\nint\t safe_path_fd(int, const char *, struct passwd *,\n\t    char *err, size_t errlen);\n\n \nint\topt_flag(const char *opt, int allow_negate, const char **optsp);\nchar\t*opt_dequote(const char **sp, const char **errstrp);\nint\topt_match(const char **opts, const char *term);\n\n \nvoid\topt_array_append(const char *file, const int line,\n\t    const char *directive, char ***array, u_int *lp, const char *s);\nvoid\topt_array_append2(const char *file, const int line,\n\t    const char *directive, char ***array, int **iarray, u_int *lp,\n\t    const char *s, int i);\n\nstruct timespec;\nvoid ptimeout_init(struct timespec *pt);\nvoid ptimeout_deadline_sec(struct timespec *pt, long sec);\nvoid ptimeout_deadline_ms(struct timespec *pt, long ms);\nvoid ptimeout_deadline_monotime_tsp(struct timespec *pt, struct timespec *when);\nvoid ptimeout_deadline_monotime(struct timespec *pt, time_t when);\nint ptimeout_get_ms(struct timespec *pt);\nstruct timespec *ptimeout_get_tsp(struct timespec *pt);\nint ptimeout_isset(struct timespec *pt);\n\n \n\n#define RP_ECHO\t\t\t0x0001\n#define RP_ALLOW_STDIN\t\t0x0002\n#define RP_ALLOW_EOF\t\t0x0004\n#define RP_USE_ASKPASS\t\t0x0008\n\nstruct notifier_ctx;\n\nchar\t*read_passphrase(const char *, int);\nint\t ask_permission(const char *, ...) __attribute__((format(printf, 1, 2)));\nstruct notifier_ctx *notify_start(int, const char *, ...)\n\t__attribute__((format(printf, 2, 3)));\nvoid\tnotify_complete(struct notifier_ctx *, const char *, ...)\n\t__attribute__((format(printf, 2, 3)));\n\n#define MINIMUM(a, b)\t(((a) < (b)) ? (a) : (b))\n#define MAXIMUM(a, b)\t(((a) > (b)) ? (a) : (b))\n#define ROUNDUP(x, y)   ((((x)+((y)-1))/(y))*(y))\n\ntypedef void (*sshsig_t)(int);\nsshsig_t ssh_signal(int, sshsig_t);\n\n \n \n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}