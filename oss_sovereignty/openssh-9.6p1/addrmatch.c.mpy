{
  "module_name": "addrmatch.c",
  "hash_id": "f7ccdd95c26281335a86c7650359cb9dc1870cb99afa61b2cf8374c8a219697e",
  "original_prompt": "Ingested from openssh-9.6p1/addrmatch.c",
  "human_readable_source": " \n\n \n\n#include \"includes.h\"\n\n#include <sys/types.h>\n#include <sys/socket.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n\n#include <netdb.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n\n#include \"addr.h\"\n#include \"match.h\"\n#include \"log.h\"\n\n \nint\naddr_match_list(const char *addr, const char *_list)\n{\n\tchar *list, *cp, *o;\n\tstruct xaddr try_addr, match_addr;\n\tu_int masklen, neg;\n\tint ret = 0, r;\n\n\tif (addr != NULL && addr_pton(addr, &try_addr) != 0) {\n\t\tdebug2_f(\"couldn't parse address %.100s\", addr);\n\t\treturn 0;\n\t}\n\tif ((o = list = strdup(_list)) == NULL)\n\t\treturn -1;\n\twhile ((cp = strsep(&list, \",\")) != NULL) {\n\t\tneg = *cp == '!';\n\t\tif (neg)\n\t\t\tcp++;\n\t\tif (*cp == '\\0') {\n\t\t\tret = -2;\n\t\t\tbreak;\n\t\t}\n\t\t \n\t\tr = addr_pton_cidr(cp, &match_addr, &masklen);\n\t\tif (r == -2) {\n\t\t\tdebug2_f(\"inconsistent mask length for \"\n\t\t\t    \"match network \\\"%.100s\\\"\", cp);\n\t\t\tret = -2;\n\t\t\tbreak;\n\t\t} else if (r == 0) {\n\t\t\tif (addr != NULL && addr_netmatch(&try_addr,\n\t\t\t    &match_addr, masklen) == 0) {\n foundit:\n\t\t\t\tif (neg) {\n\t\t\t\t\tret = -1;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tret = 1;\n\t\t\t}\n\t\t\tcontinue;\n\t\t} else {\n\t\t\t \n\t\t\tif (addr != NULL && match_pattern(addr, cp) == 1)\n\t\t\t\tgoto foundit;\n\t\t}\n\t}\n\tfree(o);\n\n\treturn ret;\n}\n\n \nint\naddr_match_cidr_list(const char *addr, const char *_list)\n{\n\tchar *list, *cp, *o;\n\tstruct xaddr try_addr, match_addr;\n\tu_int masklen;\n\tint ret = 0, r;\n\n\tif (addr != NULL && addr_pton(addr, &try_addr) != 0) {\n\t\tdebug2_f(\"couldn't parse address %.100s\", addr);\n\t\treturn 0;\n\t}\n\tif ((o = list = strdup(_list)) == NULL)\n\t\treturn -1;\n\twhile ((cp = strsep(&list, \",\")) != NULL) {\n\t\tif (*cp == '\\0') {\n\t\t\terror_f(\"empty entry in list \\\"%.100s\\\"\", o);\n\t\t\tret = -1;\n\t\t\tbreak;\n\t\t}\n\n\t\t \n\n\t\t \n\t\tif (strlen(cp) > INET6_ADDRSTRLEN + 3) {\n\t\t\terror_f(\"list entry \\\"%.100s\\\" too long\", cp);\n\t\t\tret = -1;\n\t\t\tbreak;\n\t\t}\n#define VALID_CIDR_CHARS \"0123456789abcdefABCDEF.:/\"\n\t\tif (strspn(cp, VALID_CIDR_CHARS) != strlen(cp)) {\n\t\t\terror_f(\"list entry \\\"%.100s\\\" contains invalid \"\n\t\t\t    \"characters\", cp);\n\t\t\tret = -1;\n\t\t}\n\n\t\t \n\t\tr = addr_pton_cidr(cp, &match_addr, &masklen);\n\t\tif (r == -1) {\n\t\t\terror(\"Invalid network entry \\\"%.100s\\\"\", cp);\n\t\t\tret = -1;\n\t\t\tbreak;\n\t\t} else if (r == -2) {\n\t\t\terror(\"Inconsistent mask length for \"\n\t\t\t    \"network \\\"%.100s\\\"\", cp);\n\t\t\tret = -1;\n\t\t\tbreak;\n\t\t} else if (r == 0 && addr != NULL) {\n\t\t\tif (addr_netmatch(&try_addr, &match_addr,\n\t\t\t    masklen) == 0)\n\t\t\t\tret = 1;\n\t\t\tcontinue;\n\t\t}\n\t}\n\tfree(o);\n\n\treturn ret;\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}