{
  "module_name": "sntrup761.sh",
  "hash_id": "6f399a62ae4e5b276a5d84ec1f1fd088ae73ada231ee0100065c907fab4bed17",
  "original_prompt": "Ingested from openssh-9.6p1/sntrup761.sh",
  "human_readable_source": "#!/bin/sh\n#       $OpenBSD: sntrup761.sh,v 1.7 2023/01/11 02:13:52 djm Exp $\n#       Placed in the Public Domain.\n#\nAUTHOR=\"supercop-20201130/crypto_kem/sntrup761/ref/implementors\"\nFILES=\"\n\tsupercop-20201130/crypto_sort/int32/portable4/int32_minmax.inc\n\tsupercop-20201130/crypto_sort/int32/portable4/sort.c\n\tsupercop-20201130/crypto_sort/uint32/useint32/sort.c\n\tsupercop-20201130/crypto_kem/sntrup761/ref/uint32.c\n\tsupercop-20201130/crypto_kem/sntrup761/ref/int32.c\n\tsupercop-20201130/crypto_kem/sntrup761/ref/paramsmenu.h\n\tsupercop-20201130/crypto_kem/sntrup761/ref/params.h\n\tsupercop-20201130/crypto_kem/sntrup761/ref/Decode.h\n\tsupercop-20201130/crypto_kem/sntrup761/ref/Decode.c\n\tsupercop-20201130/crypto_kem/sntrup761/ref/Encode.h\n\tsupercop-20201130/crypto_kem/sntrup761/ref/Encode.c\n\tsupercop-20201130/crypto_kem/sntrup761/ref/kem.c\n\"\n###\n\nset -e\ncd $1\necho -n '/*  $'\necho 'OpenBSD: $ */'\necho\necho '/*'\necho ' * Public Domain, Authors:'\nsed -e '/Alphabetical order:/d' -e 's/^/ * - /' < $AUTHOR\necho ' */'\necho\necho '#include <string.h>'\necho '#include \"crypto_api.h\"'\necho\n# Map the types used in this code to the ones in crypto_api.h.  We use #define\n# instead of typedef since some systems have existing intXX types and do not\n# permit multiple typedefs even if they do not conflict.\nfor t in int8 uint8 int16 uint16 int32 uint32 int64 uint64; do\n\techo \"#define $t crypto_${t}\"\ndone\necho\nfor i in $FILES; do\n\techo \"/* from $i */\"\n\t# Changes to all files:\n\t#  - remove all includes, we inline everything required.\n\t#  - make functions not required elsewhere static.\n\t#  - rename the functions we do use.\n\t#  - remove unnecessary defines and externs.\n\tsed -e \"/#include/d\" \\\n\t    -e \"s/crypto_kem_/crypto_kem_sntrup761_/g\" \\\n\t    -e \"s/^void /static void /g\" \\\n\t    -e \"s/^int16 /static int16 /g\" \\\n\t    -e \"s/^uint16 /static uint16 /g\" \\\n\t    -e \"/^extern /d\" \\\n\t    -e '/CRYPTO_NAMESPACE/d' \\\n\t    -e \"/^#define int32 crypto_int32/d\" \\\n\t    -e 's/[\t ]*$//' \\\n\t    $i | \\\n\tcase \"$i\" in\n\t# Use int64_t for intermediate values in int32_MINMAX to prevent signed\n\t# 32-bit integer overflow when called by crypto_sort_uint32.\n\t*/int32_minmax.inc)\n\t    sed -e \"s/int32 ab = b ^ a/int64_t ab = (int64_t)b ^ (int64_t)a/\" \\\n\t        -e \"s/int32 c = b - a/int64_t c = (int64_t)b - (int64_t)a/\"\n\t    ;;\n\t*/int32/portable4/sort.c)\n\t    sed -e \"s/void crypto_sort/void crypto_sort_int32/g\"\n\t    ;;\n\t*/uint32/useint32/sort.c)\n\t    sed -e \"s/void crypto_sort/void crypto_sort_uint32/g\"\n\t    ;;\n\t# Remove unused function to prevent warning.\n\t*/crypto_kem/sntrup761/ref/int32.c)\n\t    sed -e '/ int32_div_uint14/,/^}$/d'\n\t    ;;\n\t# Remove unused function to prevent warning.\n\t*/crypto_kem/sntrup761/ref/uint32.c)\n\t    sed -e '/ uint32_div_uint14/,/^}$/d'\n\t    ;;\n\t# Default: pass through.\n\t*)\n\t    cat\n\t    ;;\n\tesac\n\techo\ndone\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}