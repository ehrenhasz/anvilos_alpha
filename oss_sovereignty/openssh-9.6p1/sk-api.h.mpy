{
  "module_name": "sk-api.h",
  "hash_id": "90886ba64922ddd08b7c5755af6960971100c31a8d9fe299e1d216152be47e93",
  "original_prompt": "Ingested from openssh-9.6p1/sk-api.h",
  "human_readable_source": " \n \n\n#ifndef _SK_API_H\n#define _SK_API_H 1\n\n#include <stddef.h>\n#ifdef HAVE_STDINT_H\n#include <stdint.h>\n#endif\n\n \n#define SSH_SK_USER_PRESENCE_REQD\t0x01\n#define SSH_SK_USER_VERIFICATION_REQD\t0x04\n#define SSH_SK_FORCE_OPERATION\t\t0x10\n#define SSH_SK_RESIDENT_KEY\t\t0x20\n\n \n#define SSH_SK_ECDSA\t\t\t0x00\n#define SSH_SK_ED25519\t\t\t0x01\n\n \n#define SSH_SK_ERR_GENERAL\t\t-1\n#define SSH_SK_ERR_UNSUPPORTED\t\t-2\n#define SSH_SK_ERR_PIN_REQUIRED\t\t-3\n#define SSH_SK_ERR_DEVICE_NOT_FOUND\t-4\n#define SSH_SK_ERR_CREDENTIAL_EXISTS\t-5\n\nstruct sk_enroll_response {\n\tuint8_t flags;\n\tuint8_t *public_key;\n\tsize_t public_key_len;\n\tuint8_t *key_handle;\n\tsize_t key_handle_len;\n\tuint8_t *signature;\n\tsize_t signature_len;\n\tuint8_t *attestation_cert;\n\tsize_t attestation_cert_len;\n\tuint8_t *authdata;\n\tsize_t authdata_len;\n};\n\nstruct sk_sign_response {\n\tuint8_t flags;\n\tuint32_t counter;\n\tuint8_t *sig_r;\n\tsize_t sig_r_len;\n\tuint8_t *sig_s;\n\tsize_t sig_s_len;\n};\n\nstruct sk_resident_key {\n\tuint32_t alg;\n\tsize_t slot;\n\tchar *application;\n\tstruct sk_enroll_response key;\n\tuint8_t flags;\n\tuint8_t *user_id;\n\tsize_t user_id_len;\n};\n\nstruct sk_option {\n\tchar *name;\n\tchar *value;\n\tuint8_t required;\n};\n\n#define SSH_SK_VERSION_MAJOR\t\t0x000a0000  \n#define SSH_SK_VERSION_MAJOR_MASK\t0xffff0000\n\n \nuint32_t sk_api_version(void);\n\n \nint sk_enroll(uint32_t alg, const uint8_t *challenge, size_t challenge_len,\n    const char *application, uint8_t flags, const char *pin,\n    struct sk_option **options, struct sk_enroll_response **enroll_response);\n\n \nint sk_sign(uint32_t alg, const uint8_t *data, size_t data_len,\n    const char *application, const uint8_t *key_handle, size_t key_handle_len,\n    uint8_t flags, const char *pin, struct sk_option **options,\n    struct sk_sign_response **sign_response);\n\n \nint sk_load_resident_keys(const char *pin, struct sk_option **options,\n    struct sk_resident_key ***rks, size_t *nrks);\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}