{
  "module_name": "PROTOCOL.krl",
  "hash_id": "4656a4e7cb213f8c1c29d4659852c6bd2f25dd3d111aa7ca76c485a2a31b2eae",
  "original_prompt": "Ingested from openssh-9.6p1/PROTOCOL.krl",
  "human_readable_source": "This describes the key/certificate revocation list format for OpenSSH.\n\n1. Overall format\n\nThe KRL consists of a header and zero or more sections. The header is:\n\n#define KRL_MAGIC\t\t0x5353484b524c0a00ULL  /* \"SSHKRL\\n\\0\" */\n#define KRL_FORMAT_VERSION\t1\n\n\tuint64\tKRL_MAGIC\n\tuint32\tKRL_FORMAT_VERSION\n\tuint64\tkrl_version\n\tuint64\tgenerated_date\n\tuint64\tflags\n\tstring\treserved\n\tstring\tcomment\n\nWhere \"krl_version\" is a version number that increases each time the KRL\nis modified, \"generated_date\" is the time in seconds since 1970-01-01\n00:00:00 UTC that the KRL was generated, \"comment\" is an optional comment\nand \"reserved\" an extension field whose contents are currently ignored.\nNo \"flags\" are currently defined.\n\nFollowing the header are zero or more sections, each consisting of:\n\n\tbyte\tsection_type\n\tstring\tsection_data\n\nWhere \"section_type\" indicates the type of the \"section_data\". An exception\nto this is the KRL_SECTION_SIGNATURE section, that has a slightly different\nformat (see below).\n\nThe available section types are:\n\n#define KRL_SECTION_CERTIFICATES\t\t1\n#define KRL_SECTION_EXPLICIT_KEY\t\t2\n#define KRL_SECTION_FINGERPRINT_SHA1\t\t3\n#define KRL_SECTION_SIGNATURE\t\t\t4\n#define KRL_SECTION_FINGERPRINT_SHA256\t\t5\n#define KRL_SECTION_EXTENSION\t\t\t255\n\n2. Certificate section\n\nThese sections use type KRL_SECTION_CERTIFICATES to revoke certificates by\nserial number or key ID. The consist of the CA key that issued the\ncertificates to be revoked and a reserved field whose contents is currently\nignored.\n\n\tstring ca_key\n\tstring reserved\n\nWhere \"ca_key\" is the standard SSH wire serialisation of the CA's\npublic key. Alternately, \"ca_key\" may be an empty string to indicate\nthe certificate section applies to all CAs (this is most useful when\nrevoking key IDs).\n\nFollowed by one or more sections:\n\n\tbyte\tcert_section_type\n\tstring\tcert_section_data\n\nThe certificate section types are:\n\n#define KRL_SECTION_CERT_SERIAL_LIST\t0x20\n#define KRL_SECTION_CERT_SERIAL_RANGE\t0x21\n#define KRL_SECTION_CERT_SERIAL_BITMAP\t0x22\n#define KRL_SECTION_CERT_KEY_ID\t\t0x23\n#define KRL_SECTION_CERT_EXTENSION\t0x39\n\n2.1 Certificate serial list section\n\nThis section is identified as KRL_SECTION_CERT_SERIAL_LIST. It revokes\ncertificates by listing their serial numbers. The cert_section_data in this\ncase contains:\n\n\tuint64\trevoked_cert_serial\n\tuint64\t...\n\nThis section may appear multiple times.\n\n2.2. Certificate serial range section\n\nThese sections use type KRL_SECTION_CERT_SERIAL_RANGE and hold\na range of serial numbers of certificates:\n\n\tuint64\tserial_min\n\tuint64\tserial_max\n\nAll certificates in the range serial_min <= serial <= serial_max are\nrevoked.\n\nThis section may appear multiple times.\n\n2.3. Certificate serial bitmap section\n\nBitmap sections use type KRL_SECTION_CERT_SERIAL_BITMAP and revoke keys\nby listing their serial number in a bitmap.\n\n\tuint64\tserial_offset\n\tmpint\trevoked_keys_bitmap\n\nA bit set at index N in the bitmap corresponds to revocation of a keys with\nserial number (serial_offset + N).\n\nThis section may appear multiple times.\n\n2.4. Revoked key ID sections\n\nKRL_SECTION_CERT_KEY_ID sections revoke particular certificate \"key\nID\" strings. This may be useful in revoking all certificates\nassociated with a particular identity, e.g. a host or a user.\n\n\tstring\tkey_id[0]\n\t...\n\nThis section must contain at least one \"key_id\". This section may appear\nmultiple times.\n\n2.5. Certificate Extension subsections\n\nThis subsection type provides a generic extension mechanism to the\ncertificates KRL section that may be used to provide optional or critical\ndata.\n\nExtensions are stored in subsections of type\nKRL_SECTION_CERT_EXTENSION with the following contents:\n\n\tstring\textension_name\n\tboolean is_critical\n\tstring\textension_contents.\n\nWhere \"extension_name\" describes the type of extension. It is\nrecommended that user extensions follow \"cert-name@domain.org\" naming.\n\nThe \"is_critical\" indicates whether this extension is mandatory or\noptional. If true, then any unsupported extension encountered should\nresult in KRL parsing failure. If false, then it may be safely be\nignored.\n\nThe \"extension_contents\" contains the body of the extension.\n\n3. Explicit key sections\n\nThese sections, identified as KRL_SECTION_EXPLICIT_KEY, revoke keys\n(not certificates). They are less space efficient than serial numbers,\nbut are able to revoke plain keys.\n\n\tstring\tpublic_key_blob[0]\n\t....\n\nThis section must contain at least one \"public_key_blob\". The blob\nmust be a raw key (i.e. not a certificate).\n\nThis section may appear multiple times.\n\n4. SHA1/SHA256 fingerprint sections\n\nThese sections, identified as KRL_SECTION_FINGERPRINT_SHA1 and\nKRL_SECTION_FINGERPRINT_SHA256, revoke plain keys (i.e. not\ncertificates) by listing their hashes:\n\n\tstring\tpublic_key_hash[0]\n\t....\n\nThis section must contain at least one \"public_key_hash\". The hash blob\nis obtained by taking the SHA1 or SHA256 hash of the public key blob.\nHashes in this section must appear in numeric order, treating each hash\nas a big-endian integer.\n\nThis section may appear multiple times.\n\n5. Extension sections\n\nThis section type provides a generic extension mechanism to the KRL\nformat that may be used to provide optional or critical data.\n\nExtensions are recorded in sections of type KRL_SECTION_EXTENSION\nwith the following contents:\n\n\tstring\textension_name\n\tboolean is_critical\n\tstring\textension_contents.\n\nWhere \"extension_name\" describes the type of extension. It is\nrecommended that user extensions follow \"name@domain.org\" naming.\n\nThe \"is_critical\" indicates whether this extension is mandatory or\noptional. If true, then any unsupported extension encountered should\nresult in KRL parsing failure. If false, then it may be safely be\nignored.\n\nThe \"extension_contents\" contains the body of the extension.\n\n6. KRL signature sections\n\nNote: KRL signatures are not supported by OpenSSH. OpenSSH >= 9.4 will\nrefuse to load KRLs that contain signatures. We recommend the use\nof SSHSIG (`ssh-keygen -Y sign ...`) style signatures for KRLs instead.\n\nThe KRL_SECTION_SIGNATURE section serves a different purpose to the\npreceding ones: to provide cryptographic authentication of a KRL that\nis retrieved over a channel that does not provide integrity protection.\nIts format is slightly different to the previously-described sections:\nin order to simplify the signature generation, it includes as a \"body\"\ntwo string components instead of one.\n\n\tbyte\tKRL_SECTION_SIGNATURE\n\tstring\tsignature_key\n\tstring\tsignature\n\nThe signature is calculated over the entire KRL from the KRL_MAGIC\nto this subsection's \"signature_key\", including both and using the\nsignature generation rules appropriate for the type of \"signature_key\".\n\nThis section must appear last in the KRL. If multiple signature sections\nappear, they must appear consecutively at the end of the KRL file.\n\nImplementations that retrieve KRLs over untrusted channels must verify\nsignatures. Signature sections are optional for KRLs distributed by\ntrusted means.\n\n$OpenBSD: PROTOCOL.krl,v 1.7 2023/07/17 04:01:10 djm Exp $\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}