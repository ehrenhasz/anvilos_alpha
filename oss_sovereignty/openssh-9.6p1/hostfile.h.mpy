{
  "module_name": "hostfile.h",
  "hash_id": "d95d4c3a5cd6e800b949eb07d9aaa0df13aa35780457371d1d890e83af9a99f3",
  "original_prompt": "Ingested from openssh-9.6p1/hostfile.h",
  "human_readable_source": " \n\n \n#ifndef HOSTFILE_H\n#define HOSTFILE_H\n\ntypedef enum {\n\tHOST_OK, HOST_NEW, HOST_CHANGED, HOST_REVOKED, HOST_FOUND\n}       HostStatus;\n\ntypedef enum {\n\tMRK_ERROR, MRK_NONE, MRK_REVOKE, MRK_CA\n}\tHostkeyMarker;\n\nstruct hostkey_entry {\n\tchar *host;\n\tchar *file;\n\tu_long line;\n\tstruct sshkey *key;\n\tHostkeyMarker marker;\n\tu_int note;  \n};\nstruct hostkeys {\n\tstruct hostkey_entry *entries;\n\tu_int num_entries;\n};\n\nstruct hostkeys *init_hostkeys(void);\nvoid\t load_hostkeys(struct hostkeys *, const char *,\n    const char *, u_int);\nvoid\t load_hostkeys_file(struct hostkeys *, const char *,\n    const char *, FILE *, u_int note);\nvoid\t free_hostkeys(struct hostkeys *);\n\nHostStatus check_key_in_hostkeys(struct hostkeys *, struct sshkey *,\n    const struct hostkey_entry **);\nint\t lookup_key_in_hostkeys_by_type(struct hostkeys *, int, int,\n    const struct hostkey_entry **);\nint\t lookup_marker_in_hostkeys(struct hostkeys *, int);\n\nint\t hostfile_read_key(char **, u_int *, struct sshkey *);\nint\t add_host_to_hostfile(const char *, const char *,\n    const struct sshkey *, int);\n\nint\t hostfile_replace_entries(const char *filename,\n    const char *host, const char *ip, struct sshkey **keys, size_t nkeys,\n    int store_hash, int quiet, int hash_alg);\n\n#define HASH_MAGIC\t\"|1|\"\n#define HASH_DELIM\t'|'\n\n#define CA_MARKER\t\"@cert-authority\"\n#define REVOKE_MARKER\t\"@revoked\"\n\nchar\t*host_hash(const char *, const char *, u_int);\n\n \n#define HKF_WANT_MATCH\t\t(1)\t \n#define HKF_WANT_PARSE_KEY\t(1<<1)\t \n\n#define HKF_STATUS_OK\t\t0\t \n#define HKF_STATUS_INVALID\t1\t \n#define HKF_STATUS_COMMENT\t2\t \n#define HKF_STATUS_MATCHED\t3\t \n\n#define HKF_MATCH_HOST\t\t(1)\t \n#define HKF_MATCH_IP\t\t(1<<1)\t \n#define HKF_MATCH_HOST_HASHED\t(1<<2)\t \n#define HKF_MATCH_IP_HASHED\t(1<<3)\t \n \n\n \nstruct hostkey_foreach_line {\n\tconst char *path;  \n\tu_long linenum;\t \n\tu_int status;\t \n\tu_int match;\t \n\tchar *line;\t \n\tint marker;\t \n\tconst char *hosts;  \n\tconst char *rawkey;  \n\tint keytype;\t \n\tstruct sshkey *key;  \n\tconst char *comment;  \n\tu_int note;\t \n};\n\n \ntypedef int hostkeys_foreach_fn(struct hostkey_foreach_line *l, void *ctx);\n\n \nint hostkeys_foreach(const char *path,\n    hostkeys_foreach_fn *callback, void *ctx,\n    const char *host, const char *ip, u_int options, u_int note);\nint hostkeys_foreach_file(const char *path, FILE *f,\n    hostkeys_foreach_fn *callback, void *ctx,\n    const char *host, const char *ip, u_int options, u_int note);\n\nvoid hostfile_create_user_ssh_dir(const char *, int);\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}