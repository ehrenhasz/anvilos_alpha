{
  "module_name": "audit-linux.c",
  "hash_id": "7b2c1eb97ab1fab10f07382073fea4fe45fc9a383bf97f44892735ebba89889f",
  "original_prompt": "Ingested from openssh-9.6p1/audit-linux.c",
  "human_readable_source": " \n\n#include \"includes.h\"\n#if defined(USE_LINUX_AUDIT)\n#include <libaudit.h>\n#include <unistd.h>\n#include <string.h>\n\n#include \"log.h\"\n#include \"audit.h\"\n#include \"canohost.h\"\n#include \"packet.h\"\n\nconst char *audit_username(void);\n\nint\nlinux_audit_record_event(int uid, const char *username, const char *hostname,\n    const char *ip, const char *ttyn, int success)\n{\n\tint audit_fd, rc, saved_errno;\n\n\tif ((audit_fd = audit_open()) < 0) {\n\t\tif (errno == EINVAL || errno == EPROTONOSUPPORT ||\n\t\t    errno == EAFNOSUPPORT)\n\t\t\treturn 1;  \n\t\telse\n\t\t\treturn 0;  \n\t}\n\trc = audit_log_acct_message(audit_fd, AUDIT_USER_LOGIN,\n\t    NULL, \"login\", username ? username : \"(unknown)\",\n\t    username == NULL ? uid : -1, hostname, ip, ttyn, success);\n\tsaved_errno = errno;\n\tclose(audit_fd);\n\n\t \n\tif ((rc == -EPERM) && (geteuid() != 0))\n\t\trc = 0;\n\terrno = saved_errno;\n\n\treturn rc >= 0;\n}\n\n \n\nvoid\naudit_connection_from(const char *host, int port)\n{\n\t \n}\n\nvoid\naudit_run_command(const char *command)\n{\n\t \n}\n\nvoid\naudit_session_open(struct logininfo *li)\n{\n\tif (linux_audit_record_event(li->uid, NULL, li->hostname, NULL,\n\t    li->line, 1) == 0)\n\t\tfatal(\"linux_audit_write_entry failed: %s\", strerror(errno));\n}\n\nvoid\naudit_session_close(struct logininfo *li)\n{\n\t \n}\n\nvoid\naudit_event(struct ssh *ssh, ssh_audit_event_t event)\n{\n\tswitch(event) {\n\tcase SSH_AUTH_SUCCESS:\n\tcase SSH_CONNECTION_CLOSE:\n\tcase SSH_NOLOGIN:\n\tcase SSH_LOGIN_EXCEED_MAXTRIES:\n\tcase SSH_LOGIN_ROOT_DENIED:\n\t\tbreak;\n\tcase SSH_AUTH_FAIL_NONE:\n\tcase SSH_AUTH_FAIL_PASSWD:\n\tcase SSH_AUTH_FAIL_KBDINT:\n\tcase SSH_AUTH_FAIL_PUBKEY:\n\tcase SSH_AUTH_FAIL_HOSTBASED:\n\tcase SSH_AUTH_FAIL_GSSAPI:\n\tcase SSH_INVALID_USER:\n\t\tlinux_audit_record_event(-1, audit_username(), NULL,\n\t\t    ssh_remote_ipaddr(ssh), \"sshd\", 0);\n\t\tbreak;\n\tdefault:\n\t\tdebug(\"%s: unhandled event %d\", __func__, event);\n\t\tbreak;\n\t}\n}\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}