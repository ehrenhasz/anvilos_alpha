{
  "module_name": "kexgex.c",
  "hash_id": "d386ae28989ec44226b01469fd0bcec9602bf14ff799bfde79c6905fd1a02a53",
  "original_prompt": "Ingested from openssh-9.6p1/kexgex.c",
  "human_readable_source": " \n \n\n#include \"includes.h\"\n\n#ifdef WITH_OPENSSL\n\n#include <sys/types.h>\n\n#include <openssl/evp.h>\n#include <signal.h>\n\n#include \"openbsd-compat/openssl-compat.h\"\n\n#include \"sshkey.h\"\n#include \"cipher.h\"\n#include \"kex.h\"\n#include \"ssh2.h\"\n#include \"ssherr.h\"\n#include \"sshbuf.h\"\n#include \"digest.h\"\n\nint\nkexgex_hash(\n    int hash_alg,\n    const struct sshbuf *client_version,\n    const struct sshbuf *server_version,\n    const struct sshbuf *client_kexinit,\n    const struct sshbuf *server_kexinit,\n    const struct sshbuf *server_host_key_blob,\n    int min, int wantbits, int max,\n    const BIGNUM *prime,\n    const BIGNUM *gen,\n    const BIGNUM *client_dh_pub,\n    const BIGNUM *server_dh_pub,\n    const u_char *shared_secret, size_t secretlen,\n    u_char *hash, size_t *hashlen)\n{\n\tstruct sshbuf *b;\n\tint r;\n\n\tif (*hashlen < ssh_digest_bytes(SSH_DIGEST_SHA1))\n\t\treturn SSH_ERR_INVALID_ARGUMENT;\n\tif ((b = sshbuf_new()) == NULL)\n\t\treturn SSH_ERR_ALLOC_FAIL;\n\tif ((r = sshbuf_put_stringb(b, client_version)) < 0 ||\n\t    (r = sshbuf_put_stringb(b, server_version)) < 0 ||\n\t     \n\t    (r = sshbuf_put_u32(b, sshbuf_len(client_kexinit) + 1)) != 0 ||\n\t    (r = sshbuf_put_u8(b, SSH2_MSG_KEXINIT)) != 0 ||\n\t    (r = sshbuf_putb(b, client_kexinit)) != 0 ||\n\t    (r = sshbuf_put_u32(b, sshbuf_len(server_kexinit) + 1)) != 0 ||\n\t    (r = sshbuf_put_u8(b, SSH2_MSG_KEXINIT)) != 0 ||\n\t    (r = sshbuf_putb(b, server_kexinit)) != 0 ||\n\t    (r = sshbuf_put_stringb(b, server_host_key_blob)) != 0 ||\n\t    (min != -1 && (r = sshbuf_put_u32(b, min)) != 0) ||\n\t    (r = sshbuf_put_u32(b, wantbits)) != 0 ||\n\t    (max != -1 && (r = sshbuf_put_u32(b, max)) != 0) ||\n\t    (r = sshbuf_put_bignum2(b, prime)) != 0 ||\n\t    (r = sshbuf_put_bignum2(b, gen)) != 0 ||\n\t    (r = sshbuf_put_bignum2(b, client_dh_pub)) != 0 ||\n\t    (r = sshbuf_put_bignum2(b, server_dh_pub)) != 0 ||\n\t    (r = sshbuf_put(b, shared_secret, secretlen)) != 0) {\n\t\tsshbuf_free(b);\n\t\treturn r;\n\t}\n#ifdef DEBUG_KEXDH\n\tsshbuf_dump(b, stderr);\n#endif\n\tif (ssh_digest_buffer(hash_alg, b, hash, *hashlen) != 0) {\n\t\tsshbuf_free(b);\n\t\treturn SSH_ERR_LIBCRYPTO_ERROR;\n\t}\n\tsshbuf_free(b);\n\t*hashlen = ssh_digest_bytes(hash_alg);\n#ifdef DEBUG_KEXDH\n\tdump_digest(\"hash\", hash, *hashlen);\n#endif\n\treturn 0;\n}\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}