{
  "module_name": "dh.c",
  "hash_id": "89f2d0d9749870b217253acfdcd5b961f49d3353f0a628732d42f963db5f9e0c",
  "original_prompt": "Ingested from openssh-9.6p1/dh.c",
  "human_readable_source": " \n \n\n#include \"includes.h\"\n\n#ifdef WITH_OPENSSL\n\n#include <errno.h>\n#include <stdarg.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <string.h>\n#include <limits.h>\n\n#include <openssl/bn.h>\n#include <openssl/dh.h>\n\n#include \"dh.h\"\n#include \"pathnames.h\"\n#include \"log.h\"\n#include \"misc.h\"\n#include \"ssherr.h\"\n\n#include \"openbsd-compat/openssl-compat.h\"\n\nstatic const char *moduli_filename;\n\nvoid dh_set_moduli_file(const char *filename)\n{\n\tmoduli_filename = filename;\n}\n\nstatic const char * get_moduli_filename(void)\n{\n\treturn moduli_filename ? moduli_filename : _PATH_DH_MODULI;\n}\n\nstatic int\nparse_prime(int linenum, char *line, struct dhgroup *dhg)\n{\n\tchar *cp, *arg;\n\tchar *strsize, *gen, *prime;\n\tconst char *errstr = NULL;\n\tlong long n;\n\n\tdhg->p = dhg->g = NULL;\n\tcp = line;\n\tif ((arg = strdelim(&cp)) == NULL)\n\t\treturn 0;\n\t \n\tif (*arg == '\\0')\n\t\targ = strdelim(&cp);\n\tif (!arg || !*arg || *arg == '#')\n\t\treturn 0;\n\n\t \n\tif (cp == NULL || *arg == '\\0')\n\t\tgoto truncated;\n\targ = strsep(&cp, \" \");  \n\tif (cp == NULL || *arg == '\\0')\n\t\tgoto truncated;\n\t \n\tn = strtonum(arg, 0, 5, &errstr);\n\tif (errstr != NULL || n != MODULI_TYPE_SAFE) {\n\t\terror(\"moduli:%d: type is not %d\", linenum, MODULI_TYPE_SAFE);\n\t\tgoto fail;\n\t}\n\targ = strsep(&cp, \" \");  \n\tif (cp == NULL || *arg == '\\0')\n\t\tgoto truncated;\n\t \n\tn = strtonum(arg, 0, 0x1f, &errstr);\n\tif (errstr != NULL ||\n\t    (n & MODULI_TESTS_COMPOSITE) || !(n & ~MODULI_TESTS_COMPOSITE)) {\n\t\terror(\"moduli:%d: invalid moduli tests flag\", linenum);\n\t\tgoto fail;\n\t}\n\targ = strsep(&cp, \" \");  \n\tif (cp == NULL || *arg == '\\0')\n\t\tgoto truncated;\n\tn = strtonum(arg, 0, 1<<30, &errstr);\n\tif (errstr != NULL || n == 0) {\n\t\terror(\"moduli:%d: invalid primality trial count\", linenum);\n\t\tgoto fail;\n\t}\n\tstrsize = strsep(&cp, \" \");  \n\tif (cp == NULL || *strsize == '\\0' ||\n\t    (dhg->size = (int)strtonum(strsize, 0, 64*1024, &errstr)) == 0 ||\n\t    errstr) {\n\t\terror(\"moduli:%d: invalid prime length\", linenum);\n\t\tgoto fail;\n\t}\n\t \n\tdhg->size++;\n\tgen = strsep(&cp, \" \");  \n\tif (cp == NULL || *gen == '\\0')\n\t\tgoto truncated;\n\tprime = strsep(&cp, \" \");  \n\tif (cp != NULL || *prime == '\\0') {\n truncated:\n\t\terror(\"moduli:%d: truncated\", linenum);\n\t\tgoto fail;\n\t}\n\n\tif ((dhg->g = BN_new()) == NULL ||\n\t    (dhg->p = BN_new()) == NULL) {\n\t\terror(\"parse_prime: BN_new failed\");\n\t\tgoto fail;\n\t}\n\tif (BN_hex2bn(&dhg->g, gen) == 0) {\n\t\terror(\"moduli:%d: could not parse generator value\", linenum);\n\t\tgoto fail;\n\t}\n\tif (BN_hex2bn(&dhg->p, prime) == 0) {\n\t\terror(\"moduli:%d: could not parse prime value\", linenum);\n\t\tgoto fail;\n\t}\n\tif (BN_num_bits(dhg->p) != dhg->size) {\n\t\terror(\"moduli:%d: prime has wrong size: actual %d listed %d\",\n\t\t    linenum, BN_num_bits(dhg->p), dhg->size - 1);\n\t\tgoto fail;\n\t}\n\tif (BN_cmp(dhg->g, BN_value_one()) <= 0) {\n\t\terror(\"moduli:%d: generator is invalid\", linenum);\n\t\tgoto fail;\n\t}\n\treturn 1;\n\n fail:\n\tBN_clear_free(dhg->g);\n\tBN_clear_free(dhg->p);\n\tdhg->g = dhg->p = NULL;\n\treturn 0;\n}\n\nDH *\nchoose_dh(int min, int wantbits, int max)\n{\n\tFILE *f;\n\tchar *line = NULL;\n\tsize_t linesize = 0;\n\tint best, bestcount, which, linenum;\n\tstruct dhgroup dhg;\n\n\tif ((f = fopen(get_moduli_filename(), \"r\")) == NULL) {\n\t\tlogit(\"WARNING: could not open %s (%s), using fixed modulus\",\n\t\t    get_moduli_filename(), strerror(errno));\n\t\treturn (dh_new_group_fallback(max));\n\t}\n\n\tlinenum = 0;\n\tbest = bestcount = 0;\n\twhile (getline(&line, &linesize, f) != -1) {\n\t\tlinenum++;\n\t\tif (!parse_prime(linenum, line, &dhg))\n\t\t\tcontinue;\n\t\tBN_clear_free(dhg.g);\n\t\tBN_clear_free(dhg.p);\n\n\t\tif (dhg.size > max || dhg.size < min)\n\t\t\tcontinue;\n\n\t\tif ((dhg.size > wantbits && dhg.size < best) ||\n\t\t    (dhg.size > best && best < wantbits)) {\n\t\t\tbest = dhg.size;\n\t\t\tbestcount = 0;\n\t\t}\n\t\tif (dhg.size == best)\n\t\t\tbestcount++;\n\t}\n\tfree(line);\n\tline = NULL;\n\tlinesize = 0;\n\trewind(f);\n\n\tif (bestcount == 0) {\n\t\tfclose(f);\n\t\tlogit(\"WARNING: no suitable primes in %s\",\n\t\t    get_moduli_filename());\n\t\treturn (dh_new_group_fallback(max));\n\t}\n\twhich = arc4random_uniform(bestcount);\n\n\tlinenum = 0;\n\tbestcount = 0;\n\twhile (getline(&line, &linesize, f) != -1) {\n\t\tlinenum++;\n\t\tif (!parse_prime(linenum, line, &dhg))\n\t\t\tcontinue;\n\t\tif ((dhg.size > max || dhg.size < min) ||\n\t\t    dhg.size != best ||\n\t\t    bestcount++ != which) {\n\t\t\tBN_clear_free(dhg.g);\n\t\t\tBN_clear_free(dhg.p);\n\t\t\tcontinue;\n\t\t}\n\t\tbreak;\n\t}\n\tfree(line);\n\tline = NULL;\n\tfclose(f);\n\tif (bestcount != which + 1) {\n\t\tlogit(\"WARNING: selected prime disappeared in %s, giving up\",\n\t\t    get_moduli_filename());\n\t\treturn (dh_new_group_fallback(max));\n\t}\n\n\treturn (dh_new_group(dhg.g, dhg.p));\n}\n\n \n\nint\ndh_pub_is_valid(const DH *dh, const BIGNUM *dh_pub)\n{\n\tint i;\n\tint n = BN_num_bits(dh_pub);\n\tint bits_set = 0;\n\tBIGNUM *tmp;\n\tconst BIGNUM *dh_p;\n\n\tDH_get0_pqg(dh, &dh_p, NULL, NULL);\n\n\tif (BN_is_negative(dh_pub)) {\n\t\tlogit(\"invalid public DH value: negative\");\n\t\treturn 0;\n\t}\n\tif (BN_cmp(dh_pub, BN_value_one()) != 1) {\t \n\t\tlogit(\"invalid public DH value: <= 1\");\n\t\treturn 0;\n\t}\n\n\tif ((tmp = BN_new()) == NULL) {\n\t\terror_f(\"BN_new failed\");\n\t\treturn 0;\n\t}\n\tif (!BN_sub(tmp, dh_p, BN_value_one()) ||\n\t    BN_cmp(dh_pub, tmp) != -1) {\t\t \n\t\tBN_clear_free(tmp);\n\t\tlogit(\"invalid public DH value: >= p-1\");\n\t\treturn 0;\n\t}\n\tBN_clear_free(tmp);\n\n\tfor (i = 0; i <= n; i++)\n\t\tif (BN_is_bit_set(dh_pub, i))\n\t\t\tbits_set++;\n\tdebug2(\"bits set: %d/%d\", bits_set, BN_num_bits(dh_p));\n\n\t \n\tif (bits_set < 4) {\n\t\tlogit(\"invalid public DH value (%d/%d)\",\n\t\t    bits_set, BN_num_bits(dh_p));\n\t\treturn 0;\n\t}\n\treturn 1;\n}\n\nint\ndh_gen_key(DH *dh, int need)\n{\n\tint pbits;\n\tconst BIGNUM *dh_p, *pub_key;\n\n\tDH_get0_pqg(dh, &dh_p, NULL, NULL);\n\n\tif (need < 0 || dh_p == NULL ||\n\t    (pbits = BN_num_bits(dh_p)) <= 0 ||\n\t    need > INT_MAX / 2 || 2 * need > pbits)\n\t\treturn SSH_ERR_INVALID_ARGUMENT;\n\tif (need < 256)\n\t\tneed = 256;\n\t \n\tif (!DH_set_length(dh, MINIMUM(need * 2, pbits - 1)))\n\t\treturn SSH_ERR_LIBCRYPTO_ERROR;\n\n\tif (DH_generate_key(dh) == 0)\n\t\treturn SSH_ERR_LIBCRYPTO_ERROR;\n\tDH_get0_key(dh, &pub_key, NULL);\n\tif (!dh_pub_is_valid(dh, pub_key))\n\t\treturn SSH_ERR_INVALID_FORMAT;\n\treturn 0;\n}\n\nDH *\ndh_new_group_asc(const char *gen, const char *modulus)\n{\n\tDH *dh;\n\tBIGNUM *dh_p = NULL, *dh_g = NULL;\n\n\tif ((dh = DH_new()) == NULL)\n\t\treturn NULL;\n\tif (BN_hex2bn(&dh_p, modulus) == 0 ||\n\t    BN_hex2bn(&dh_g, gen) == 0)\n\t\tgoto fail;\n\tif (!DH_set0_pqg(dh, dh_p, NULL, dh_g))\n\t\tgoto fail;\n\treturn dh;\n fail:\n\tDH_free(dh);\n\tBN_clear_free(dh_p);\n\tBN_clear_free(dh_g);\n\treturn NULL;\n}\n\n \nDH *\ndh_new_group(BIGNUM *gen, BIGNUM *modulus)\n{\n\tDH *dh;\n\n\tif ((dh = DH_new()) == NULL)\n\t\treturn NULL;\n\tif (!DH_set0_pqg(dh, modulus, NULL, gen)) {\n\t\tDH_free(dh);\n\t\treturn NULL;\n\t}\n\n\treturn dh;\n}\n\n \nDH *\ndh_new_group1(void)\n{\n\tstatic char *gen = \"2\", *group1 =\n\t    \"FFFFFFFF\" \"FFFFFFFF\" \"C90FDAA2\" \"2168C234\" \"C4C6628B\" \"80DC1CD1\"\n\t    \"29024E08\" \"8A67CC74\" \"020BBEA6\" \"3B139B22\" \"514A0879\" \"8E3404DD\"\n\t    \"EF9519B3\" \"CD3A431B\" \"302B0A6D\" \"F25F1437\" \"4FE1356D\" \"6D51C245\"\n\t    \"E485B576\" \"625E7EC6\" \"F44C42E9\" \"A637ED6B\" \"0BFF5CB6\" \"F406B7ED\"\n\t    \"EE386BFB\" \"5A899FA5\" \"AE9F2411\" \"7C4B1FE6\" \"49286651\" \"ECE65381\"\n\t    \"FFFFFFFF\" \"FFFFFFFF\";\n\n\treturn (dh_new_group_asc(gen, group1));\n}\n\n \nDH *\ndh_new_group14(void)\n{\n\tstatic char *gen = \"2\", *group14 =\n\t    \"FFFFFFFF\" \"FFFFFFFF\" \"C90FDAA2\" \"2168C234\" \"C4C6628B\" \"80DC1CD1\"\n\t    \"29024E08\" \"8A67CC74\" \"020BBEA6\" \"3B139B22\" \"514A0879\" \"8E3404DD\"\n\t    \"EF9519B3\" \"CD3A431B\" \"302B0A6D\" \"F25F1437\" \"4FE1356D\" \"6D51C245\"\n\t    \"E485B576\" \"625E7EC6\" \"F44C42E9\" \"A637ED6B\" \"0BFF5CB6\" \"F406B7ED\"\n\t    \"EE386BFB\" \"5A899FA5\" \"AE9F2411\" \"7C4B1FE6\" \"49286651\" \"ECE45B3D\"\n\t    \"C2007CB8\" \"A163BF05\" \"98DA4836\" \"1C55D39A\" \"69163FA8\" \"FD24CF5F\"\n\t    \"83655D23\" \"DCA3AD96\" \"1C62F356\" \"208552BB\" \"9ED52907\" \"7096966D\"\n\t    \"670C354E\" \"4ABC9804\" \"F1746C08\" \"CA18217C\" \"32905E46\" \"2E36CE3B\"\n\t    \"E39E772C\" \"180E8603\" \"9B2783A2\" \"EC07A28F\" \"B5C55DF0\" \"6F4C52C9\"\n\t    \"DE2BCBF6\" \"95581718\" \"3995497C\" \"EA956AE5\" \"15D22618\" \"98FA0510\"\n\t    \"15728E5A\" \"8AACAA68\" \"FFFFFFFF\" \"FFFFFFFF\";\n\n\treturn (dh_new_group_asc(gen, group14));\n}\n\n \nDH *\ndh_new_group16(void)\n{\n\tstatic char *gen = \"2\", *group16 =\n\t    \"FFFFFFFF\" \"FFFFFFFF\" \"C90FDAA2\" \"2168C234\" \"C4C6628B\" \"80DC1CD1\"\n\t    \"29024E08\" \"8A67CC74\" \"020BBEA6\" \"3B139B22\" \"514A0879\" \"8E3404DD\"\n\t    \"EF9519B3\" \"CD3A431B\" \"302B0A6D\" \"F25F1437\" \"4FE1356D\" \"6D51C245\"\n\t    \"E485B576\" \"625E7EC6\" \"F44C42E9\" \"A637ED6B\" \"0BFF5CB6\" \"F406B7ED\"\n\t    \"EE386BFB\" \"5A899FA5\" \"AE9F2411\" \"7C4B1FE6\" \"49286651\" \"ECE45B3D\"\n\t    \"C2007CB8\" \"A163BF05\" \"98DA4836\" \"1C55D39A\" \"69163FA8\" \"FD24CF5F\"\n\t    \"83655D23\" \"DCA3AD96\" \"1C62F356\" \"208552BB\" \"9ED52907\" \"7096966D\"\n\t    \"670C354E\" \"4ABC9804\" \"F1746C08\" \"CA18217C\" \"32905E46\" \"2E36CE3B\"\n\t    \"E39E772C\" \"180E8603\" \"9B2783A2\" \"EC07A28F\" \"B5C55DF0\" \"6F4C52C9\"\n\t    \"DE2BCBF6\" \"95581718\" \"3995497C\" \"EA956AE5\" \"15D22618\" \"98FA0510\"\n\t    \"15728E5A\" \"8AAAC42D\" \"AD33170D\" \"04507A33\" \"A85521AB\" \"DF1CBA64\"\n\t    \"ECFB8504\" \"58DBEF0A\" \"8AEA7157\" \"5D060C7D\" \"B3970F85\" \"A6E1E4C7\"\n\t    \"ABF5AE8C\" \"DB0933D7\" \"1E8C94E0\" \"4A25619D\" \"CEE3D226\" \"1AD2EE6B\"\n\t    \"F12FFA06\" \"D98A0864\" \"D8760273\" \"3EC86A64\" \"521F2B18\" \"177B200C\"\n\t    \"BBE11757\" \"7A615D6C\" \"770988C0\" \"BAD946E2\" \"08E24FA0\" \"74E5AB31\"\n\t    \"43DB5BFC\" \"E0FD108E\" \"4B82D120\" \"A9210801\" \"1A723C12\" \"A787E6D7\"\n\t    \"88719A10\" \"BDBA5B26\" \"99C32718\" \"6AF4E23C\" \"1A946834\" \"B6150BDA\"\n\t    \"2583E9CA\" \"2AD44CE8\" \"DBBBC2DB\" \"04DE8EF9\" \"2E8EFC14\" \"1FBECAA6\"\n\t    \"287C5947\" \"4E6BC05D\" \"99B2964F\" \"A090C3A2\" \"233BA186\" \"515BE7ED\"\n\t    \"1F612970\" \"CEE2D7AF\" \"B81BDD76\" \"2170481C\" \"D0069127\" \"D5B05AA9\"\n\t    \"93B4EA98\" \"8D8FDDC1\" \"86FFB7DC\" \"90A6C08F\" \"4DF435C9\" \"34063199\"\n\t    \"FFFFFFFF\" \"FFFFFFFF\";\n\n\treturn (dh_new_group_asc(gen, group16));\n}\n\n \nDH *\ndh_new_group18(void)\n{\n\tstatic char *gen = \"2\", *group18 =\n\t    \"FFFFFFFF\" \"FFFFFFFF\" \"C90FDAA2\" \"2168C234\" \"C4C6628B\" \"80DC1CD1\"\n\t    \"29024E08\" \"8A67CC74\" \"020BBEA6\" \"3B139B22\" \"514A0879\" \"8E3404DD\"\n\t    \"EF9519B3\" \"CD3A431B\" \"302B0A6D\" \"F25F1437\" \"4FE1356D\" \"6D51C245\"\n\t    \"E485B576\" \"625E7EC6\" \"F44C42E9\" \"A637ED6B\" \"0BFF5CB6\" \"F406B7ED\"\n\t    \"EE386BFB\" \"5A899FA5\" \"AE9F2411\" \"7C4B1FE6\" \"49286651\" \"ECE45B3D\"\n\t    \"C2007CB8\" \"A163BF05\" \"98DA4836\" \"1C55D39A\" \"69163FA8\" \"FD24CF5F\"\n\t    \"83655D23\" \"DCA3AD96\" \"1C62F356\" \"208552BB\" \"9ED52907\" \"7096966D\"\n\t    \"670C354E\" \"4ABC9804\" \"F1746C08\" \"CA18217C\" \"32905E46\" \"2E36CE3B\"\n\t    \"E39E772C\" \"180E8603\" \"9B2783A2\" \"EC07A28F\" \"B5C55DF0\" \"6F4C52C9\"\n\t    \"DE2BCBF6\" \"95581718\" \"3995497C\" \"EA956AE5\" \"15D22618\" \"98FA0510\"\n\t    \"15728E5A\" \"8AAAC42D\" \"AD33170D\" \"04507A33\" \"A85521AB\" \"DF1CBA64\"\n\t    \"ECFB8504\" \"58DBEF0A\" \"8AEA7157\" \"5D060C7D\" \"B3970F85\" \"A6E1E4C7\"\n\t    \"ABF5AE8C\" \"DB0933D7\" \"1E8C94E0\" \"4A25619D\" \"CEE3D226\" \"1AD2EE6B\"\n\t    \"F12FFA06\" \"D98A0864\" \"D8760273\" \"3EC86A64\" \"521F2B18\" \"177B200C\"\n\t    \"BBE11757\" \"7A615D6C\" \"770988C0\" \"BAD946E2\" \"08E24FA0\" \"74E5AB31\"\n\t    \"43DB5BFC\" \"E0FD108E\" \"4B82D120\" \"A9210801\" \"1A723C12\" \"A787E6D7\"\n\t    \"88719A10\" \"BDBA5B26\" \"99C32718\" \"6AF4E23C\" \"1A946834\" \"B6150BDA\"\n\t    \"2583E9CA\" \"2AD44CE8\" \"DBBBC2DB\" \"04DE8EF9\" \"2E8EFC14\" \"1FBECAA6\"\n\t    \"287C5947\" \"4E6BC05D\" \"99B2964F\" \"A090C3A2\" \"233BA186\" \"515BE7ED\"\n\t    \"1F612970\" \"CEE2D7AF\" \"B81BDD76\" \"2170481C\" \"D0069127\" \"D5B05AA9\"\n\t    \"93B4EA98\" \"8D8FDDC1\" \"86FFB7DC\" \"90A6C08F\" \"4DF435C9\" \"34028492\"\n\t    \"36C3FAB4\" \"D27C7026\" \"C1D4DCB2\" \"602646DE\" \"C9751E76\" \"3DBA37BD\"\n\t    \"F8FF9406\" \"AD9E530E\" \"E5DB382F\" \"413001AE\" \"B06A53ED\" \"9027D831\"\n\t    \"179727B0\" \"865A8918\" \"DA3EDBEB\" \"CF9B14ED\" \"44CE6CBA\" \"CED4BB1B\"\n\t    \"DB7F1447\" \"E6CC254B\" \"33205151\" \"2BD7AF42\" \"6FB8F401\" \"378CD2BF\"\n\t    \"5983CA01\" \"C64B92EC\" \"F032EA15\" \"D1721D03\" \"F482D7CE\" \"6E74FEF6\"\n\t    \"D55E702F\" \"46980C82\" \"B5A84031\" \"900B1C9E\" \"59E7C97F\" \"BEC7E8F3\"\n\t    \"23A97A7E\" \"36CC88BE\" \"0F1D45B7\" \"FF585AC5\" \"4BD407B2\" \"2B4154AA\"\n\t    \"CC8F6D7E\" \"BF48E1D8\" \"14CC5ED2\" \"0F8037E0\" \"A79715EE\" \"F29BE328\"\n\t    \"06A1D58B\" \"B7C5DA76\" \"F550AA3D\" \"8A1FBFF0\" \"EB19CCB1\" \"A313D55C\"\n\t    \"DA56C9EC\" \"2EF29632\" \"387FE8D7\" \"6E3C0468\" \"043E8F66\" \"3F4860EE\"\n\t    \"12BF2D5B\" \"0B7474D6\" \"E694F91E\" \"6DBE1159\" \"74A3926F\" \"12FEE5E4\"\n\t    \"38777CB6\" \"A932DF8C\" \"D8BEC4D0\" \"73B931BA\" \"3BC832B6\" \"8D9DD300\"\n\t    \"741FA7BF\" \"8AFC47ED\" \"2576F693\" \"6BA42466\" \"3AAB639C\" \"5AE4F568\"\n\t    \"3423B474\" \"2BF1C978\" \"238F16CB\" \"E39D652D\" \"E3FDB8BE\" \"FC848AD9\"\n\t    \"22222E04\" \"A4037C07\" \"13EB57A8\" \"1A23F0C7\" \"3473FC64\" \"6CEA306B\"\n\t    \"4BCBC886\" \"2F8385DD\" \"FA9D4B7F\" \"A2C087E8\" \"79683303\" \"ED5BDD3A\"\n\t    \"062B3CF5\" \"B3A278A6\" \"6D2A13F8\" \"3F44F82D\" \"DF310EE0\" \"74AB6A36\"\n\t    \"4597E899\" \"A0255DC1\" \"64F31CC5\" \"0846851D\" \"F9AB4819\" \"5DED7EA1\"\n\t    \"B1D510BD\" \"7EE74D73\" \"FAF36BC3\" \"1ECFA268\" \"359046F4\" \"EB879F92\"\n\t    \"4009438B\" \"481C6CD7\" \"889A002E\" \"D5EE382B\" \"C9190DA6\" \"FC026E47\"\n\t    \"9558E447\" \"5677E9AA\" \"9E3050E2\" \"765694DF\" \"C81F56E8\" \"80B96E71\"\n\t    \"60C980DD\" \"98EDD3DF\" \"FFFFFFFF\" \"FFFFFFFF\";\n\n\treturn (dh_new_group_asc(gen, group18));\n}\n\n \nDH *\ndh_new_group_fallback(int max)\n{\n\tdebug3_f(\"requested max size %d\", max);\n\tif (max < 3072) {\n\t\tdebug3(\"using 2k bit group 14\");\n\t\treturn dh_new_group14();\n\t} else if (max < 6144) {\n\t\tdebug3(\"using 4k bit group 16\");\n\t\treturn dh_new_group16();\n\t}\n\tdebug3(\"using 8k bit group 18\");\n\treturn dh_new_group18();\n}\n\n \nu_int\ndh_estimate(int bits)\n{\n\tif (bits <= 112)\n\t\treturn 2048;\n\tif (bits <= 128)\n\t\treturn 3072;\n\tif (bits <= 192)\n\t\treturn 7680;\n\treturn 8192;\n}\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}