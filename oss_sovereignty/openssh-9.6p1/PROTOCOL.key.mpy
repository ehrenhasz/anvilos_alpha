{
  "module_name": "PROTOCOL.key",
  "hash_id": "62360d783d1b04b44a54cbb2d655d80429c554bcf3cac9aa1546a1abe336c413",
  "original_prompt": "Ingested from openssh-9.6p1/PROTOCOL.key",
  "human_readable_source": "This document describes the private key format for OpenSSH.\n\n1. Overall format\n\nThe key consists of a header, a list of public keys, and\nan encrypted list of matching private keys.\n\n#define AUTH_MAGIC      \"openssh-key-v1\"\n\n\tbyte[]\tAUTH_MAGIC\n\tstring\tciphername\n\tstring\tkdfname\n\tstring\tkdfoptions\n\tuint32\tnumber of keys N\n\tstring\tpublickey1\n\tstring\tpublickey2\n\t...\n\tstring\tpublickeyN\n\tstring\tencrypted, padded list of private keys\n\n2. KDF options for kdfname \"bcrypt\"\n\nThe options:\n\n\tstring salt\n\tuint32 rounds\n\nare concatenated and represented as a string.\n\n3. Unencrypted list of N private keys\n\nThe list of privatekey/comment pairs is padded with the\nbytes 1, 2, 3, ... until the total length is a multiple\nof the cipher block size.\n\n\tuint32\tcheckint\n\tuint32\tcheckint\n\tbyte[]\tprivatekey1\n\tstring\tcomment1\n\tbyte[]\tprivatekey2\n\tstring\tcomment2\n\t...\n\tstring\tprivatekeyN\n\tstring\tcommentN\n\tbyte\t1\n\tbyte\t2\n\tbyte\t3\n\t...\n\tbyte\tpadlen % 255\n\nwhere each private key is encoded using the same rules as used for\nSSH agent.\n\nBefore the key is encrypted, a random integer is assigned\nto both checkint fields so successful decryption can be\nquickly checked by verifying that both checkint fields\nhold the same value.\n\n4. Encryption\n\nThe KDF is used to derive a key, IV (and other values required by\nthe cipher) from the passphrase. These values are then used to\nencrypt the unencrypted list of private keys.\n\n5. No encryption\n\nFor unencrypted keys the cipher \"none\" and the KDF \"none\"\nare used with empty passphrases. The options if the KDF \"none\"\nare the empty string.\n\n$OpenBSD: PROTOCOL.key,v 1.3 2022/07/01 04:45:50 djm Exp $\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}