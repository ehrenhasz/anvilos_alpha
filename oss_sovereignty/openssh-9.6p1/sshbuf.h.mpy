{
  "module_name": "sshbuf.h",
  "hash_id": "d0dd5f1a65d1dbdf14e2b300b312db6354451a9345318f9bb901614274be415b",
  "original_prompt": "Ingested from openssh-9.6p1/sshbuf.h",
  "human_readable_source": " \n \n\n#ifndef _SSHBUF_H\n#define _SSHBUF_H\n\n#include <sys/types.h>\n#include <stdarg.h>\n#include <stdio.h>\n#ifdef WITH_OPENSSL\n# include <openssl/bn.h>\n# ifdef OPENSSL_HAS_ECC\n#  include <openssl/ec.h>\n# endif  \n#endif  \n\n#define SSHBUF_SIZE_MAX\t\t0x8000000\t \n#define SSHBUF_REFS_MAX\t\t0x100000\t \n#define SSHBUF_MAX_BIGNUM\t(16384 / 8)\t \n#define SSHBUF_MAX_ECPOINT\t((528 * 2 / 8) + 1)  \n\nstruct sshbuf;\n\n \nstruct sshbuf *sshbuf_new(void);\n\n \nstruct sshbuf *sshbuf_from(const void *blob, size_t len);\n\n \nstruct sshbuf *sshbuf_fromb(struct sshbuf *buf);\n\n \nint\tsshbuf_froms(struct sshbuf *buf, struct sshbuf **bufp);\n\n \nvoid\tsshbuf_free(struct sshbuf *buf);\n\n \nvoid\tsshbuf_reset(struct sshbuf *buf);\n\n \nsize_t\tsshbuf_max_size(const struct sshbuf *buf);\n\n \nint\tsshbuf_set_max_size(struct sshbuf *buf, size_t max_size);\n\n \nsize_t\tsshbuf_len(const struct sshbuf *buf);\n\n \nsize_t\tsshbuf_avail(const struct sshbuf *buf);\n\n \nconst u_char *sshbuf_ptr(const struct sshbuf *buf);\n\n \nu_char *sshbuf_mutable_ptr(const struct sshbuf *buf);\n\n \nint\tsshbuf_check_reserve(const struct sshbuf *buf, size_t len);\n\n \nint\tsshbuf_allocate(struct sshbuf *buf, size_t len);\n\n \nint\tsshbuf_reserve(struct sshbuf *buf, size_t len, u_char **dpp);\n\n \nint\tsshbuf_consume(struct sshbuf *buf, size_t len);\n\n \nint\tsshbuf_consume_end(struct sshbuf *buf, size_t len);\n\n \nint\tsshbuf_get(struct sshbuf *buf, void *v, size_t len);\nint\tsshbuf_put(struct sshbuf *buf, const void *v, size_t len);\nint\tsshbuf_putb(struct sshbuf *buf, const struct sshbuf *v);\n\n \nint\tsshbuf_putf(struct sshbuf *buf, const char *fmt, ...)\n\t    __attribute__((format(printf, 2, 3)));\nint\tsshbuf_putfv(struct sshbuf *buf, const char *fmt, va_list ap);\n\n \nint\tsshbuf_get_u64(struct sshbuf *buf, u_int64_t *valp);\nint\tsshbuf_get_u32(struct sshbuf *buf, u_int32_t *valp);\nint\tsshbuf_get_u16(struct sshbuf *buf, u_int16_t *valp);\nint\tsshbuf_get_u8(struct sshbuf *buf, u_char *valp);\nint\tsshbuf_put_u64(struct sshbuf *buf, u_int64_t val);\nint\tsshbuf_put_u32(struct sshbuf *buf, u_int32_t val);\nint\tsshbuf_put_u16(struct sshbuf *buf, u_int16_t val);\nint\tsshbuf_put_u8(struct sshbuf *buf, u_char val);\n\n \nint\tsshbuf_peek_u64(const struct sshbuf *buf, size_t offset,\n    u_int64_t *valp);\nint\tsshbuf_peek_u32(const struct sshbuf *buf, size_t offset,\n    u_int32_t *valp);\nint\tsshbuf_peek_u16(const struct sshbuf *buf, size_t offset,\n    u_int16_t *valp);\nint\tsshbuf_peek_u8(const struct sshbuf *buf, size_t offset,\n    u_char *valp);\n\n \nint sshbuf_poke_u64(struct sshbuf *buf, size_t offset, u_int64_t val);\nint sshbuf_poke_u32(struct sshbuf *buf, size_t offset, u_int32_t val);\nint sshbuf_poke_u16(struct sshbuf *buf, size_t offset, u_int16_t val);\nint sshbuf_poke_u8(struct sshbuf *buf, size_t offset, u_char val);\nint sshbuf_poke(struct sshbuf *buf, size_t offset, void *v, size_t len);\n\n \nint\tsshbuf_get_string(struct sshbuf *buf, u_char **valp, size_t *lenp);\nint\tsshbuf_get_cstring(struct sshbuf *buf, char **valp, size_t *lenp);\nint\tsshbuf_get_stringb(struct sshbuf *buf, struct sshbuf *v);\nint\tsshbuf_put_string(struct sshbuf *buf, const void *v, size_t len);\nint\tsshbuf_put_cstring(struct sshbuf *buf, const char *v);\nint\tsshbuf_put_stringb(struct sshbuf *buf, const struct sshbuf *v);\n\n \nint\tsshbuf_get_string_direct(struct sshbuf *buf, const u_char **valp,\n\t    size_t *lenp);\n\n \n#define sshbuf_skip_string(buf) sshbuf_get_string_direct(buf, NULL, NULL)\n\n \nint\tsshbuf_peek_string_direct(const struct sshbuf *buf, const u_char **valp,\n\t    size_t *lenp);\n\n \nint\tsshbuf_put_bignum2_bytes(struct sshbuf *buf, const void *v, size_t len);\nint\tsshbuf_get_bignum2_bytes_direct(struct sshbuf *buf,\n\t    const u_char **valp, size_t *lenp);\n#ifdef WITH_OPENSSL\nint\tsshbuf_get_bignum2(struct sshbuf *buf, BIGNUM **valp);\nint\tsshbuf_put_bignum2(struct sshbuf *buf, const BIGNUM *v);\n# ifdef OPENSSL_HAS_ECC\nint\tsshbuf_get_ec(struct sshbuf *buf, EC_POINT *v, const EC_GROUP *g);\nint\tsshbuf_get_eckey(struct sshbuf *buf, EC_KEY *v);\nint\tsshbuf_put_ec(struct sshbuf *buf, const EC_POINT *v, const EC_GROUP *g);\nint\tsshbuf_put_eckey(struct sshbuf *buf, const EC_KEY *v);\n# endif  \n#endif  \n\n \nvoid\tsshbuf_dump(const struct sshbuf *buf, FILE *f);\n\n \nvoid\tsshbuf_dump_data(const void *s, size_t len, FILE *f);\n\n \nchar\t*sshbuf_dtob16(struct sshbuf *buf);\n\n \nchar\t*sshbuf_dtob64_string(const struct sshbuf *buf, int wrap);\nint\tsshbuf_dtob64(const struct sshbuf *d, struct sshbuf *b64, int wrap);\n \nint\tsshbuf_dtourlb64(const struct sshbuf *d, struct sshbuf *b64, int wrap);\n\n \nint\tsshbuf_b64tod(struct sshbuf *buf, const char *b64);\n\n \nint\tsshbuf_cmp(const struct sshbuf *b, size_t offset,\n    const void *s, size_t len);\n\n \nint\nsshbuf_find(const struct sshbuf *b, size_t start_offset,\n    const void *s, size_t len, size_t *offsetp);\n\n \nchar *sshbuf_dup_string(struct sshbuf *buf);\n\n \nint sshbuf_load_fd(int, struct sshbuf **)\n    __attribute__((__nonnull__ (2)));\nint sshbuf_load_file(const char *, struct sshbuf **)\n    __attribute__((__nonnull__ (2)));\n\n \nint sshbuf_write_file(const char *path, struct sshbuf *buf)\n    __attribute__((__nonnull__ (2)));\n\n \nint sshbuf_read(int, struct sshbuf *, size_t, size_t *)\n    __attribute__((__nonnull__ (2)));\n\n \n#define PEEK_U64(p) \\\n\t(((u_int64_t)(((const u_char *)(p))[0]) << 56) | \\\n\t ((u_int64_t)(((const u_char *)(p))[1]) << 48) | \\\n\t ((u_int64_t)(((const u_char *)(p))[2]) << 40) | \\\n\t ((u_int64_t)(((const u_char *)(p))[3]) << 32) | \\\n\t ((u_int64_t)(((const u_char *)(p))[4]) << 24) | \\\n\t ((u_int64_t)(((const u_char *)(p))[5]) << 16) | \\\n\t ((u_int64_t)(((const u_char *)(p))[6]) << 8) | \\\n\t  (u_int64_t)(((const u_char *)(p))[7]))\n#define PEEK_U32(p) \\\n\t(((u_int32_t)(((const u_char *)(p))[0]) << 24) | \\\n\t ((u_int32_t)(((const u_char *)(p))[1]) << 16) | \\\n\t ((u_int32_t)(((const u_char *)(p))[2]) << 8) | \\\n\t  (u_int32_t)(((const u_char *)(p))[3]))\n#define PEEK_U16(p) \\\n\t(((u_int16_t)(((const u_char *)(p))[0]) << 8) | \\\n\t  (u_int16_t)(((const u_char *)(p))[1]))\n\n#define POKE_U64(p, v) \\\n\tdo { \\\n\t\tconst u_int64_t __v = (v); \\\n\t\t((u_char *)(p))[0] = (__v >> 56) & 0xff; \\\n\t\t((u_char *)(p))[1] = (__v >> 48) & 0xff; \\\n\t\t((u_char *)(p))[2] = (__v >> 40) & 0xff; \\\n\t\t((u_char *)(p))[3] = (__v >> 32) & 0xff; \\\n\t\t((u_char *)(p))[4] = (__v >> 24) & 0xff; \\\n\t\t((u_char *)(p))[5] = (__v >> 16) & 0xff; \\\n\t\t((u_char *)(p))[6] = (__v >> 8) & 0xff; \\\n\t\t((u_char *)(p))[7] = __v & 0xff; \\\n\t} while (0)\n#define POKE_U32(p, v) \\\n\tdo { \\\n\t\tconst u_int32_t __v = (v); \\\n\t\t((u_char *)(p))[0] = (__v >> 24) & 0xff; \\\n\t\t((u_char *)(p))[1] = (__v >> 16) & 0xff; \\\n\t\t((u_char *)(p))[2] = (__v >> 8) & 0xff; \\\n\t\t((u_char *)(p))[3] = __v & 0xff; \\\n\t} while (0)\n#define POKE_U16(p, v) \\\n\tdo { \\\n\t\tconst u_int16_t __v = (v); \\\n\t\t((u_char *)(p))[0] = (__v >> 8) & 0xff; \\\n\t\t((u_char *)(p))[1] = __v & 0xff; \\\n\t} while (0)\n\n \n#ifdef SSHBUF_INTERNAL\n\n \nsize_t\tsshbuf_alloc(const struct sshbuf *buf);\n\n \nint\tsshbuf_set_parent(struct sshbuf *child, struct sshbuf *parent);\n\n \nconst struct sshbuf *sshbuf_parent(const struct sshbuf *buf);\n\n \nu_int\tsshbuf_refcount(const struct sshbuf *buf);\n\n# define SSHBUF_SIZE_INIT\t256\t\t \n# define SSHBUF_SIZE_INC\t256\t\t \n# define SSHBUF_PACK_MIN\t8192\t\t \n\n \n \n\n# ifndef SSHBUF_ABORT\n#  define SSHBUF_ABORT()\n# endif\n\n# ifdef SSHBUF_DEBUG\n#  define SSHBUF_DBG(x) do { \\\n\t\tprintf(\"%s:%d %s: \", __FILE__, __LINE__, __func__); \\\n\t\tprintf x; \\\n\t\tprintf(\"\\n\"); \\\n\t\tfflush(stdout); \\\n\t} while (0)\n# else\n#  define SSHBUF_DBG(x)\n# endif\n#endif  \n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}