{
  "module_name": "sshd.8",
  "hash_id": "18d116531f63871eafdba0b132da162787ad51e66475e2a2a2d7fb297c8528f8",
  "original_prompt": "Ingested from openssh-9.6p1/sshd.8",
  "human_readable_source": ".\\\"\n.\\\" Author: Tatu Ylonen <ylo@cs.hut.fi>\n.\\\" Copyright (c) 1995 Tatu Ylonen <ylo@cs.hut.fi>, Espoo, Finland\n.\\\"                    All rights reserved\n.\\\"\n.\\\" As far as I am concerned, the code I have written for this software\n.\\\" can be used freely for any purpose.  Any derived versions of this\n.\\\" software must be clearly marked as such, and if the derived work is\n.\\\" incompatible with the protocol description in the RFC file, it must be\n.\\\" called by a name other than \"ssh\" or \"Secure Shell\".\n.\\\"\n.\\\" Copyright (c) 1999,2000 Markus Friedl.  All rights reserved.\n.\\\" Copyright (c) 1999 Aaron Campbell.  All rights reserved.\n.\\\" Copyright (c) 1999 Theo de Raadt.  All rights reserved.\n.\\\"\n.\\\" Redistribution and use in source and binary forms, with or without\n.\\\" modification, are permitted provided that the following conditions\n.\\\" are met:\n.\\\" 1. Redistributions of source code must retain the above copyright\n.\\\"    notice, this list of conditions and the following disclaimer.\n.\\\" 2. Redistributions in binary form must reproduce the above copyright\n.\\\"    notice, this list of conditions and the following disclaimer in the\n.\\\"    documentation and/or other materials provided with the distribution.\n.\\\"\n.\\\" THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS OR\n.\\\" IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES\n.\\\" OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.\n.\\\" IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT, INDIRECT,\n.\\\" INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT\n.\\\" NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n.\\\" DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\n.\\\" THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n.\\\" (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF\n.\\\" THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n.\\\"\n.\\\" $OpenBSD: sshd.8,v 1.325 2023/09/19 20:37:07 deraadt Exp $\n.Dd $Mdocdate: September 19 2023 $\n.Dt SSHD 8\n.Os\n.Sh NAME\n.Nm sshd\n.Nd OpenSSH daemon\n.Sh SYNOPSIS\n.Nm sshd\n.Bk -words\n.Op Fl 46DdeGiqTtV\n.Op Fl C Ar connection_spec\n.Op Fl c Ar host_certificate_file\n.Op Fl E Ar log_file\n.Op Fl f Ar config_file\n.Op Fl g Ar login_grace_time\n.Op Fl h Ar host_key_file\n.Op Fl o Ar option\n.Op Fl p Ar port\n.Op Fl u Ar len\n.Ek\n.Sh DESCRIPTION\n.Nm\n(OpenSSH Daemon) is the daemon program for\n.Xr ssh 1 .\nIt provides secure encrypted communications between two untrusted hosts\nover an insecure network.\n.Pp\n.Nm\nlistens for connections from clients.\nIt is normally started at boot from\n.Pa /etc/rc .\nIt forks a new\ndaemon for each incoming connection.\nThe forked daemons handle\nkey exchange, encryption, authentication, command execution,\nand data exchange.\n.Pp\n.Nm\ncan be configured using command-line options or a configuration file\n(by default\n.Xr sshd_config 5 ) ;\ncommand-line options override values specified in the\nconfiguration file.\n.Nm\nrereads its configuration file when it receives a hangup signal,\n.Dv SIGHUP ,\nby executing itself with the name and options it was started with, e.g.\\&\n.Pa /usr/sbin/sshd .\n.Pp\nThe options are as follows:\n.Bl -tag -width Ds\n.It Fl 4\nForces\n.Nm\nto use IPv4 addresses only.\n.It Fl 6\nForces\n.Nm\nto use IPv6 addresses only.\n.It Fl C Ar connection_spec\nSpecify the connection parameters to use for the\n.Fl T\nextended test mode.\nIf provided, any\n.Cm Match\ndirectives in the configuration file that would apply are applied before the\nconfiguration is written to standard output.\nThe connection parameters are supplied as keyword=value pairs and may be\nsupplied in any order, either with multiple\n.Fl C\noptions or as a comma-separated list.\nThe keywords are\n.Dq addr ,\n.Dq user ,\n.Dq host ,\n.Dq laddr ,\n.Dq lport ,\nand\n.Dq rdomain\nand correspond to source address, user, resolved source host name,\nlocal address, local port number and routing domain respectively.\n.It Fl c Ar host_certificate_file\nSpecifies a path to a certificate file to identify\n.Nm\nduring key exchange.\nThe certificate file must match a host key file specified using the\n.Fl h\noption or the\n.Cm HostKey\nconfiguration directive.\n.It Fl D\nWhen this option is specified,\n.Nm\nwill not detach and does not become a daemon.\nThis allows easy monitoring of\n.Nm sshd .\n.It Fl d\nDebug mode.\nThe server sends verbose debug output to standard error,\nand does not put itself in the background.\nThe server also will not\n.Xr fork 2\nand will only process one connection.\nThis option is only intended for debugging for the server.\nMultiple\n.Fl d\noptions increase the debugging level.\nMaximum is 3.\n.It Fl E Ar log_file\nAppend debug logs to\n.Ar log_file\ninstead of the system log.\n.It Fl e\nWrite debug logs to standard error instead of the system log.\n.It Fl f Ar config_file\nSpecifies the name of the configuration file.\nThe default is\n.Pa /etc/ssh/sshd_config .\n.Nm\nrefuses to start if there is no configuration file.\n.It Fl G\nParse and print configuration file.\nCheck the validity of the configuration file, output the effective configuration\nto stdout and then exit.\nOptionally,\n.Cm Match\nrules may be applied by specifying the connection parameters using one or more\n.Fl C\noptions.\n.It Fl g Ar login_grace_time\nGives the grace time for clients to authenticate themselves (default\n120 seconds).\nIf the client fails to authenticate the user within\nthis many seconds, the server disconnects and exits.\nA value of zero indicates no limit.\n.It Fl h Ar host_key_file\nSpecifies a file from which a host key is read.\nThis option must be given if\n.Nm\nis not run as root (as the normal\nhost key files are normally not readable by anyone but root).\nThe default is\n.Pa /etc/ssh/ssh_host_ecdsa_key ,\n.Pa /etc/ssh/ssh_host_ed25519_key\nand\n.Pa /etc/ssh/ssh_host_rsa_key .\nIt is possible to have multiple host key files for\nthe different host key algorithms.\n.It Fl i\nSpecifies that\n.Nm\nis being run from\n.Xr inetd 8 .\n.It Fl o Ar option\nCan be used to give options in the format used in the configuration file.\nThis is useful for specifying options for which there is no separate\ncommand-line flag.\nFor full details of the options, and their values, see\n.Xr sshd_config 5 .\n.It Fl p Ar port\nSpecifies the port on which the server listens for connections\n(default 22).\nMultiple port options are permitted.\nPorts specified in the configuration file with the\n.Cm Port\noption are ignored when a command-line port is specified.\nPorts specified using the\n.Cm ListenAddress\noption override command-line ports.\n.It Fl q\nQuiet mode.\nNothing is sent to the system log.\nNormally the beginning,\nauthentication, and termination of each connection is logged.\n.It Fl T\nExtended test mode.\nCheck the validity of the configuration file, output the effective configuration\nto stdout and then exit.\nOptionally,\n.Cm Match\nrules may be applied by specifying the connection parameters using one or more\n.Fl C\noptions.\nThis is similar to the\n.Fl G\nflag, but it includes the additional testing performed by the\n.Fl t\nflag.\n.It Fl t\nTest mode.\nOnly check the validity of the configuration file and sanity of the keys.\nThis is useful for updating\n.Nm\nreliably as configuration options may change.\n.It Fl u Ar len\nThis option is used to specify the size of the field\nin the\n.Vt utmp\nstructure that holds the remote host name.\nIf the resolved host name is longer than\n.Ar len ,\nthe dotted decimal value will be used instead.\nThis allows hosts with very long host names that\noverflow this field to still be uniquely identified.\nSpecifying\n.Fl u0\nindicates that only dotted decimal addresses\nshould be put into the\n.Pa utmp\nfile.\n.Fl u0\nmay also be used to prevent\n.Nm\nfrom making DNS requests unless the authentication\nmechanism or configuration requires it.\nAuthentication mechanisms that may require DNS include\n.Cm HostbasedAuthentication\nand using a\n.Cm from=\"pattern-list\"\noption in a key file.\nConfiguration options that require DNS include using a\nUSER@HOST pattern in\n.Cm AllowUsers\nor\n.Cm DenyUsers .\n.It Fl V\nDisplay the version number and exit.\n.El\n.Sh AUTHENTICATION\nThe OpenSSH SSH daemon supports SSH protocol 2 only.\nEach host has a host-specific key,\nused to identify the host.\nWhenever a client connects, the daemon responds with its public\nhost key.\nThe client compares the\nhost key against its own database to verify that it has not changed.\nForward secrecy is provided through a Diffie-Hellman key agreement.\nThis key agreement results in a shared session key.\nThe rest of the session is encrypted using a symmetric cipher.\nThe client selects the encryption algorithm\nto use from those offered by the server.\nAdditionally, session integrity is provided\nthrough a cryptographic message authentication code (MAC).\n.Pp\nFinally, the server and the client enter an authentication dialog.\nThe client tries to authenticate itself using\nhost-based authentication,\npublic key authentication,\nchallenge-response authentication,\nor password authentication.\n.Pp\nRegardless of the authentication type, the account is checked to\nensure that it is accessible.  An account is not accessible if it is\nlocked, listed in\n.Cm DenyUsers\nor its group is listed in\n.Cm DenyGroups\n\\&.  The definition of a locked account is system dependent. Some platforms\nhave their own account database (eg AIX) and some modify the passwd field (\n.Ql \\&*LK\\&*\non Solaris and UnixWare,\n.Ql \\&*\non HP-UX, containing\n.Ql Nologin\non Tru64,\na leading\n.Ql \\&*LOCKED\\&*\non FreeBSD and a leading\n.Ql \\&!\non most Linuxes).\nIf there is a requirement to disable password authentication\nfor the account while allowing still public-key, then the passwd field\nshould be set to something other than these values (eg\n.Ql NP\nor\n.Ql \\&*NP\\&*\n).\n.Pp\nIf the client successfully authenticates itself, a dialog for\npreparing the session is entered.\nAt this time the client may request\nthings like allocating a pseudo-tty, forwarding X11 connections,\nforwarding TCP connections, or forwarding the authentication agent\nconnection over the secure channel.\n.Pp\nAfter this, the client either requests an interactive shell or execution\nof a non-interactive command, which\n.Nm\nwill execute via the user's shell using its\n.Fl c\noption.\nThe sides then enter session mode.\nIn this mode, either side may send\ndata at any time, and such data is forwarded to/from the shell or\ncommand on the server side, and the user terminal in the client side.\n.Pp\nWhen the user program terminates and all forwarded X11 and other\nconnections have been closed, the server sends command exit status to\nthe client, and both sides exit.\n.Sh LOGIN PROCESS\nWhen a user successfully logs in,\n.Nm\ndoes the following:\n.Bl -enum -offset indent\n.It\nIf the login is on a tty, and no command has been specified,\nprints last login time and\n.Pa /etc/motd\n(unless prevented in the configuration file or by\n.Pa ~/.hushlogin ;\nsee the\n.Sx FILES\nsection).\n.It\nIf the login is on a tty, records login time.\n.It\nChecks\n.Pa /etc/nologin ;\nif it exists, prints contents and quits\n(unless root).\n.It\nChanges to run with normal user privileges.\n.It\nSets up basic environment.\n.It\nReads the file\n.Pa ~/.ssh/environment ,\nif it exists, and users are allowed to change their environment.\nSee the\n.Cm PermitUserEnvironment\noption in\n.Xr sshd_config 5 .\n.It\nChanges to user's home directory.\n.It\nIf\n.Pa ~/.ssh/rc\nexists and the\n.Xr sshd_config 5\n.Cm PermitUserRC\noption is set, runs it; else if\n.Pa /etc/ssh/sshrc\nexists, runs\nit; otherwise runs\n.Xr xauth 1 .\nThe\n.Dq rc\nfiles are given the X11\nauthentication protocol and cookie in standard input.\nSee\n.Sx SSHRC ,\nbelow.\n.It\nRuns user's shell or command.\nAll commands are run under the user's login shell as specified in the\nsystem password database.\n.El\n.Sh SSHRC\nIf the file\n.Pa ~/.ssh/rc\nexists,\n.Xr sh 1\nruns it after reading the\nenvironment files but before starting the user's shell or command.\nIt must not produce any output on stdout; stderr must be used\ninstead.\nIf X11 forwarding is in use, it will receive the \"proto cookie\" pair in\nits standard input (and\n.Ev DISPLAY\nin its environment).\nThe script must call\n.Xr xauth 1\nbecause\n.Nm\nwill not run xauth automatically to add X11 cookies.\n.Pp\nThe primary purpose of this file is to run any initialization routines\nwhich may be needed before the user's home directory becomes\naccessible; AFS is a particular example of such an environment.\n.Pp\nThis file will probably contain some initialization code followed by\nsomething similar to:\n.Bd -literal -offset 3n\nif read proto cookie && [ -n \"$DISPLAY\" ]; then\n\tif [ `echo $DISPLAY | cut -c1-10` = 'localhost:' ]; then\n\t\t# X11UseLocalhost=yes\n\t\techo add unix:`echo $DISPLAY |\n\t\t    cut -c11-` $proto $cookie\n\telse\n\t\t# X11UseLocalhost=no\n\t\techo add $DISPLAY $proto $cookie\n\tfi | xauth -q -\nfi\n.Ed\n.Pp\nIf this file does not exist,\n.Pa /etc/ssh/sshrc\nis run, and if that\ndoes not exist either, xauth is used to add the cookie.\n.Sh AUTHORIZED_KEYS FILE FORMAT\n.Cm AuthorizedKeysFile\nspecifies the files containing public keys for\npublic key authentication;\nif this option is not specified, the default is\n.Pa ~/.ssh/authorized_keys\nand\n.Pa ~/.ssh/authorized_keys2 .\nEach line of the file contains one\nkey (empty lines and lines starting with a\n.Ql #\nare ignored as\ncomments).\nPublic keys consist of the following space-separated fields:\noptions, keytype, base64-encoded key, comment.\nThe options field is optional.\nThe supported key types are:\n.Pp\n.Bl -item -compact -offset indent\n.It\nsk-ecdsa-sha2-nistp256@openssh.com\n.It\necdsa-sha2-nistp256\n.It\necdsa-sha2-nistp384\n.It\necdsa-sha2-nistp521\n.It\nsk-ssh-ed25519@openssh.com\n.It\nssh-ed25519\n.It\nssh-dss\n.It\nssh-rsa\n.El\n.Pp\nThe comment field is not used for anything (but may be convenient for the\nuser to identify the key).\n.Pp\nNote that lines in this file can be several hundred bytes long\n(because of the size of the public key encoding) up to a limit of\n8 kilobytes, which permits RSA keys up to 16 kilobits.\nYou don't want to type them in; instead, copy the\n.Pa id_dsa.pub ,\n.Pa id_ecdsa.pub ,\n.Pa id_ecdsa_sk.pub ,\n.Pa id_ed25519.pub ,\n.Pa id_ed25519_sk.pub ,\nor the\n.Pa id_rsa.pub\nfile and edit it.\n.Pp\n.Nm\nenforces a minimum RSA key modulus size of 1024 bits.\n.Pp\nThe options (if present) consist of comma-separated option\nspecifications.\nNo spaces are permitted, except within double quotes.\nThe following option specifications are supported (note\nthat option keywords are case-insensitive):\n.Bl -tag -width Ds\n.It Cm agent-forwarding\nEnable authentication agent forwarding previously disabled by the\n.Cm restrict\noption.\n.It Cm cert-authority\nSpecifies that the listed key is a certification authority (CA) that is\ntrusted to validate signed certificates for user authentication.\n.Pp\nCertificates may encode access restrictions similar to these key options.\nIf both certificate restrictions and key options are present, the most\nrestrictive union of the two is applied.\n.It Cm command=\"command\"\nSpecifies that the command is executed whenever this key is used for\nauthentication.\nThe command supplied by the user (if any) is ignored.\nThe command is run on a pty if the client requests a pty;\notherwise it is run without a tty.\nIf an 8-bit clean channel is required,\none must not request a pty or should specify\n.Cm no-pty .\nA quote may be included in the command by quoting it with a backslash.\n.Pp\nThis option might be useful\nto restrict certain public keys to perform just a specific operation.\nAn example might be a key that permits remote backups but nothing else.\nNote that the client may specify TCP and/or X11\nforwarding unless they are explicitly prohibited, e.g. using the\n.Cm restrict\nkey option.\n.Pp\nThe command originally supplied by the client is available in the\n.Ev SSH_ORIGINAL_COMMAND\nenvironment variable.\nNote that this option applies to shell, command or subsystem execution.\nAlso note that this command may be superseded by a\n.Xr sshd_config 5\n.Cm ForceCommand\ndirective.\n.Pp\nIf a command is specified and a forced-command is embedded in a certificate\nused for authentication, then the certificate will be accepted only if the\ntwo commands are identical.\n.It Cm environment=\"NAME=value\"\nSpecifies that the string is to be added to the environment when\nlogging in using this key.\nEnvironment variables set this way\noverride other default environment values.\nMultiple options of this type are permitted.\nEnvironment processing is disabled by default and is\ncontrolled via the\n.Cm PermitUserEnvironment\noption.\n.It Cm expiry-time=\"timespec\"\nSpecifies a time after which the key will not be accepted.\nThe time may be specified as a YYYYMMDD[Z] date or a YYYYMMDDHHMM[SS][Z] time.\nDates and times will be interpreted in the system time zone unless suffixed\nby a Z character, in which case they will be interpreted in the UTC time zone.\n.It Cm from=\"pattern-list\"\nSpecifies that in addition to public key authentication, either the canonical\nname of the remote host or its IP address must be present in the\ncomma-separated list of patterns.\nSee PATTERNS in\n.Xr ssh_config 5\nfor more information on patterns.\n.Pp\nIn addition to the wildcard matching that may be applied to hostnames or\naddresses, a\n.Cm from\nstanza may match IP addresses using CIDR address/masklen notation.\n.Pp\nThe purpose of this option is to optionally increase security: public key\nauthentication by itself does not trust the network or name servers or\nanything (but the key); however, if somebody somehow steals the key, the key\npermits an intruder to log in from anywhere in the world.\nThis additional option makes using a stolen key more difficult (name\nservers and/or routers would have to be compromised in addition to\njust the key).\n.It Cm no-agent-forwarding\nForbids authentication agent forwarding when this key is used for\nauthentication.\n.It Cm no-port-forwarding\nForbids TCP forwarding when this key is used for authentication.\nAny port forward requests by the client will return an error.\nThis might be used, e.g. in connection with the\n.Cm command\noption.\n.It Cm no-pty\nPrevents tty allocation (a request to allocate a pty will fail).\n.It Cm no-user-rc\nDisables execution of\n.Pa ~/.ssh/rc .\n.It Cm no-X11-forwarding\nForbids X11 forwarding when this key is used for authentication.\nAny X11 forward requests by the client will return an error.\n.It Cm permitlisten=\"[host:]port\"\nLimit remote port forwarding with the\n.Xr ssh 1\n.Fl R\noption such that it may only listen on the specified host (optional) and port.\nIPv6 addresses can be specified by enclosing the address in square brackets.\nMultiple\n.Cm permitlisten\noptions may be applied separated by commas.\nHostnames may include wildcards as described in the PATTERNS section in\n.Xr ssh_config 5 .\nA port specification of\n.Cm *\nmatches any port.\nNote that the setting of\n.Cm GatewayPorts\nmay further restrict listen addresses.\nNote that\n.Xr ssh 1\nwill send a hostname of\n.Dq localhost\nif a listen host was not specified when the forwarding was requested, and\nthat this name is treated differently to the explicit localhost addresses\n.Dq 127.0.0.1\nand\n.Dq ::1 .\n.It Cm permitopen=\"host:port\"\nLimit local port forwarding with the\n.Xr ssh 1\n.Fl L\noption such that it may only connect to the specified host and port.\nIPv6 addresses can be specified by enclosing the address in square brackets.\nMultiple\n.Cm permitopen\noptions may be applied separated by commas.\nNo pattern matching or name lookup is performed on the\nspecified hostnames, they must be literal host names and/or addresses.\nA port specification of\n.Cm *\nmatches any port.\n.It Cm port-forwarding\nEnable port forwarding previously disabled by the\n.Cm restrict\noption.\n.It Cm principals=\"principals\"\nOn a\n.Cm cert-authority\nline, specifies allowed principals for certificate authentication as a\ncomma-separated list.\nAt least one name from the list must appear in the certificate's\nlist of principals for the certificate to be accepted.\nThis option is ignored for keys that are not marked as trusted certificate\nsigners using the\n.Cm cert-authority\noption.\n.It Cm pty\nPermits tty allocation previously disabled by the\n.Cm restrict\noption.\n.It Cm no-touch-required\nDo not require demonstration of user presence\nfor signatures made using this key.\nThis option only makes sense for the FIDO authenticator algorithms\n.Cm ecdsa-sk\nand\n.Cm ed25519-sk .\n.It Cm verify-required\nRequire that signatures made using this key attest that they verified\nthe user, e.g. via a PIN.\nThis option only makes sense for the FIDO authenticator algorithms\n.Cm ecdsa-sk\nand\n.Cm ed25519-sk .\n.It Cm restrict\nEnable all restrictions, i.e. disable port, agent and X11 forwarding,\nas well as disabling PTY allocation\nand execution of\n.Pa ~/.ssh/rc .\nIf any future restriction capabilities are added to authorized_keys files,\nthey will be included in this set.\n.It Cm tunnel=\"n\"\nForce a\n.Xr tun 4\ndevice on the server.\nWithout this option, the next available device will be used if\nthe client requests a tunnel.\n.It Cm user-rc\nEnables execution of\n.Pa ~/.ssh/rc\npreviously disabled by the\n.Cm restrict\noption.\n.It Cm X11-forwarding\nPermits X11 forwarding previously disabled by the\n.Cm restrict\noption.\n.El\n.Pp\nAn example authorized_keys file:\n.Bd -literal -offset 3n\n# Comments are allowed at start of line. Blank lines are allowed.\n# Plain key, no restrictions\nssh-rsa ...\n# Forced command, disable PTY and all forwarding\nrestrict,command=\"dump /home\" ssh-rsa ...\n# Restriction of ssh -L forwarding destinations\npermitopen=\"192.0.2.1:80\",permitopen=\"192.0.2.2:25\" ssh-rsa ...\n# Restriction of ssh -R forwarding listeners\npermitlisten=\"localhost:8080\",permitlisten=\"[::1]:22000\" ssh-rsa ...\n# Configuration for tunnel forwarding\ntunnel=\"0\",command=\"sh /etc/netstart tun0\" ssh-rsa ...\n# Override of restriction to allow PTY allocation\nrestrict,pty,command=\"nethack\" ssh-rsa ...\n# Allow FIDO key without requiring touch\nno-touch-required sk-ecdsa-sha2-nistp256@openssh.com ...\n# Require user-verification (e.g. PIN or biometric) for FIDO key\nverify-required sk-ecdsa-sha2-nistp256@openssh.com ...\n# Trust CA key, allow touch-less FIDO if requested in certificate\ncert-authority,no-touch-required,principals=\"user_a\" ssh-rsa ...\n.Ed\n.Sh SSH_KNOWN_HOSTS FILE FORMAT\nThe\n.Pa /etc/ssh/ssh_known_hosts\nand\n.Pa ~/.ssh/known_hosts\nfiles contain host public keys for all known hosts.\nThe global file should\nbe prepared by the administrator (optional), and the per-user file is\nmaintained automatically: whenever the user connects to an unknown host,\nits key is added to the per-user file.\n.Pp\nEach line in these files contains the following fields: marker (optional),\nhostnames, keytype, base64-encoded key, comment.\nThe fields are separated by spaces.\n.Pp\nThe marker is optional, but if it is present then it must be one of\n.Dq @cert-authority ,\nto indicate that the line contains a certification authority (CA) key,\nor\n.Dq @revoked ,\nto indicate that the key contained on the line is revoked and must not ever\nbe accepted.\nOnly one marker should be used on a key line.\n.Pp\nHostnames is a comma-separated list of patterns\n.Pf ( Ql *\nand\n.Ql \\&?\nact as\nwildcards); each pattern in turn is matched against the host name.\nWhen\n.Nm sshd\nis authenticating a client, such as when using\n.Cm HostbasedAuthentication ,\nthis will be the canonical client host name.\nWhen\n.Xr ssh 1\nis authenticating a server, this will be the host name\ngiven by the user, the value of the\n.Xr ssh 1\n.Cm HostkeyAlias\nif it was specified, or the canonical server hostname if the\n.Xr ssh 1\n.Cm CanonicalizeHostname\noption was used.\n.Pp\nA pattern may also be preceded by\n.Ql \\&!\nto indicate negation: if the host name matches a negated\npattern, it is not accepted (by that line) even if it matched another\npattern on the line.\nA hostname or address may optionally be enclosed within\n.Ql \\&[\nand\n.Ql \\&]\nbrackets then followed by\n.Ql \\&:\nand a non-standard port number.\n.Pp\nAlternately, hostnames may be stored in a hashed form which hides host names\nand addresses should the file's contents be disclosed.\nHashed hostnames start with a\n.Ql |\ncharacter.\nOnly one hashed hostname may appear on a single line and none of the above\nnegation or wildcard operators may be applied.\n.Pp\nThe keytype and base64-encoded key are taken directly from the host key; they\ncan be obtained, for example, from\n.Pa /etc/ssh/ssh_host_rsa_key.pub .\nThe optional comment field continues to the end of the line, and is not used.\n.Pp\nLines starting with\n.Ql #\nand empty lines are ignored as comments.\n.Pp\nWhen performing host authentication, authentication is accepted if any\nmatching line has the proper key; either one that matches exactly or,\nif the server has presented a certificate for authentication, the key\nof the certification authority that signed the certificate.\nFor a key to be trusted as a certification authority, it must use the\n.Dq @cert-authority\nmarker described above.\n.Pp\nThe known hosts file also provides a facility to mark keys as revoked,\nfor example when it is known that the associated private key has been\nstolen.\nRevoked keys are specified by including the\n.Dq @revoked\nmarker at the beginning of the key line, and are never accepted for\nauthentication or as certification authorities, but instead will\nproduce a warning from\n.Xr ssh 1\nwhen they are encountered.\n.Pp\nIt is permissible (but not\nrecommended) to have several lines or different host keys for the same\nnames.\nThis will inevitably happen when short forms of host names\nfrom different domains are put in the file.\nIt is possible\nthat the files contain conflicting information; authentication is\naccepted if valid information can be found from either file.\n.Pp\nNote that the lines in these files are typically hundreds of characters\nlong, and you definitely don't want to type in the host keys by hand.\nRather, generate them by a script,\n.Xr ssh-keyscan 1\nor by taking, for example,\n.Pa /etc/ssh/ssh_host_rsa_key.pub\nand adding the host names at the front.\n.Xr ssh-keygen 1\nalso offers some basic automated editing for\n.Pa ~/.ssh/known_hosts\nincluding removing hosts matching a host name and converting all host\nnames to their hashed representations.\n.Pp\nAn example ssh_known_hosts file:\n.Bd -literal -offset 3n\n# Comments allowed at start of line\ncvs.example.net,192.0.2.10 ssh-rsa AAAA1234.....=\n# A hashed hostname\n|1|JfKTdBh7rNbXkVAQCRp4OQoPfmI=|USECr3SWf1JUPsms5AqfD5QfxkM= ssh-rsa\nAAAA1234.....=\n# A revoked key\n@revoked * ssh-rsa AAAAB5W...\n# A CA key, accepted for any host in *.mydomain.com or *.mydomain.org\n@cert-authority *.mydomain.org,*.mydomain.com ssh-rsa AAAAB5W...\n.Ed\n.Sh FILES\n.Bl -tag -width Ds -compact\n.It Pa ~/.hushlogin\nThis file is used to suppress printing the last login time and\n.Pa /etc/motd ,\nif\n.Cm PrintLastLog\nand\n.Cm PrintMotd ,\nrespectively,\nare enabled.\nIt does not suppress printing of the banner specified by\n.Cm Banner .\n.Pp\n.It Pa ~/.rhosts\nThis file is used for host-based authentication (see\n.Xr ssh 1\nfor more information).\nOn some machines this file may need to be\nworld-readable if the user's home directory is on an NFS partition,\nbecause\n.Nm\nreads it as root.\nAdditionally, this file must be owned by the user,\nand must not have write permissions for anyone else.\nThe recommended\npermission for most machines is read/write for the user, and not\naccessible by others.\n.Pp\n.It Pa ~/.shosts\nThis file is used in exactly the same way as\n.Pa .rhosts ,\nbut allows host-based authentication without permitting login with\nrlogin/rsh.\n.Pp\n.It Pa ~/.ssh/\nThis directory is the default location for all user-specific configuration\nand authentication information.\nThere is no general requirement to keep the entire contents of this directory\nsecret, but the recommended permissions are read/write/execute for the user,\nand not accessible by others.\n.Pp\n.It Pa ~/.ssh/authorized_keys\nLists the public keys (DSA, ECDSA, Ed25519, RSA)\nthat can be used for logging in as this user.\nThe format of this file is described above.\nThe content of the file is not highly sensitive, but the recommended\npermissions are read/write for the user, and not accessible by others.\n.Pp\nIf this file, the\n.Pa ~/.ssh\ndirectory, or the user's home directory are writable\nby other users, then the file could be modified or replaced by unauthorized\nusers.\nIn this case,\n.Nm\nwill not allow it to be used unless the\n.Cm StrictModes\noption has been set to\n.Dq no .\n.Pp\n.It Pa ~/.ssh/environment\nThis file is read into the environment at login (if it exists).\nIt can only contain empty lines, comment lines (that start with\n.Ql # ) ,\nand assignment lines of the form name=value.\nThe file should be writable\nonly by the user; it need not be readable by anyone else.\nEnvironment processing is disabled by default and is\ncontrolled via the\n.Cm PermitUserEnvironment\noption.\n.Pp\n.It Pa ~/.ssh/known_hosts\nContains a list of host keys for all hosts the user has logged into\nthat are not already in the systemwide list of known host keys.\nThe format of this file is described above.\nThis file should be writable only by root/the owner and\ncan, but need not be, world-readable.\n.Pp\n.It Pa ~/.ssh/rc\nContains initialization routines to be run before\nthe user's home directory becomes accessible.\nThis file should be writable only by the user, and need not be\nreadable by anyone else.\n.Pp\n.It Pa /etc/hosts.equiv\nThis file is for host-based authentication (see\n.Xr ssh 1 ) .\nIt should only be writable by root.\n.Pp\n.It Pa /etc/moduli\nContains Diffie-Hellman groups used for the \"Diffie-Hellman Group Exchange\"\nkey exchange method.\nThe file format is described in\n.Xr moduli 5 .\nIf no usable groups are found in this file then fixed internal groups will\nbe used.\n.Pp\n.It Pa /etc/motd\nSee\n.Xr motd 5 .\n.Pp\n.It Pa /etc/nologin\nIf this file exists,\n.Nm\nrefuses to let anyone except root log in.\nThe contents of the file\nare displayed to anyone trying to log in, and non-root connections are\nrefused.\nThe file should be world-readable.\n.Pp\n.It Pa /etc/shosts.equiv\nThis file is used in exactly the same way as\n.Pa hosts.equiv ,\nbut allows host-based authentication without permitting login with\nrlogin/rsh.\n.Pp\n.It Pa /etc/ssh/ssh_host_ecdsa_key\n.It Pa /etc/ssh/ssh_host_ed25519_key\n.It Pa /etc/ssh/ssh_host_rsa_key\nThese files contain the private parts of the host keys.\nThese files should only be owned by root, readable only by root, and not\naccessible to others.\nNote that\n.Nm\ndoes not start if these files are group/world-accessible.\n.Pp\n.It Pa /etc/ssh/ssh_host_ecdsa_key.pub\n.It Pa /etc/ssh/ssh_host_ed25519_key.pub\n.It Pa /etc/ssh/ssh_host_rsa_key.pub\nThese files contain the public parts of the host keys.\nThese files should be world-readable but writable only by\nroot.\nTheir contents should match the respective private parts.\nThese files are not\nreally used for anything; they are provided for the convenience of\nthe user so their contents can be copied to known hosts files.\nThese files are created using\n.Xr ssh-keygen 1 .\n.Pp\n.It Pa /etc/ssh/ssh_known_hosts\nSystemwide list of known host keys.\nThis file should be prepared by the\nsystem administrator to contain the public host keys of all machines in the\norganization.\nThe format of this file is described above.\nThis file should be writable only by root/the owner and\nshould be world-readable.\n.Pp\n.It Pa /etc/ssh/sshd_config\nContains configuration data for\n.Nm sshd .\nThe file format and configuration options are described in\n.Xr sshd_config 5 .\n.Pp\n.It Pa /etc/ssh/sshrc\nSimilar to\n.Pa ~/.ssh/rc ,\nit can be used to specify\nmachine-specific login-time initializations globally.\nThis file should be writable only by root, and should be world-readable.\n.Pp\n.It Pa /var/empty\n.Xr chroot 2\ndirectory used by\n.Nm\nduring privilege separation in the pre-authentication phase.\nThe directory should not contain any files and must be owned by root\nand not group or world-writable.\n.Pp\n.It Pa /var/run/sshd.pid\nContains the process ID of the\n.Nm\nlistening for connections (if there are several daemons running\nconcurrently for different ports, this contains the process ID of the one\nstarted last).\nThe content of this file is not sensitive; it can be world-readable.\n.El\n.Sh SEE ALSO\n.Xr scp 1 ,\n.Xr sftp 1 ,\n.Xr ssh 1 ,\n.Xr ssh-add 1 ,\n.Xr ssh-agent 1 ,\n.Xr ssh-keygen 1 ,\n.Xr ssh-keyscan 1 ,\n.Xr chroot 2 ,\n.Xr login.conf 5 ,\n.Xr moduli 5 ,\n.Xr sshd_config 5 ,\n.Xr inetd 8 ,\n.Xr sftp-server 8\n.Sh AUTHORS\nOpenSSH is a derivative of the original and free\nssh 1.2.12 release by Tatu Ylonen.\nAaron Campbell, Bob Beck, Markus Friedl, Niels Provos,\nTheo de Raadt and Dug Song\nremoved many bugs, re-added newer features and\ncreated OpenSSH.\nMarkus Friedl contributed the support for SSH\nprotocol versions 1.5 and 2.0.\nNiels Provos and Markus Friedl contributed support\nfor privilege separation.\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}