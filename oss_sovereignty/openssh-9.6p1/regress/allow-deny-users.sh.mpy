{
  "module_name": "allow-deny-users.sh",
  "hash_id": "8d1da215bd777139365a93dd2146f816fbc8182ae78363342de99c7f3bd6426d",
  "original_prompt": "Ingested from openssh-9.6p1/regress/allow-deny-users.sh",
  "human_readable_source": "# Public Domain\n# Zev Weiss, 2016\n# $OpenBSD: allow-deny-users.sh,v 1.6 2021/06/07 00:00:50 djm Exp $\n\ntid=\"AllowUsers/DenyUsers\"\n\nme=\"$LOGNAME\"\nif [ \"x$me\" = \"x\" ]; then\n\tme=`whoami`\nfi\nother=\"nobody\"\n\ncp $OBJ/sshd_proxy $OBJ/sshd_proxy.orig\n\ntest_auth()\n{\n\tdeny=\"$1\"\n\tallow=\"$2\"\n\tshould_succeed=\"$3\"\n\tfailmsg=\"$4\"\n\n\tcp $OBJ/sshd_proxy.orig $OBJ/sshd_proxy\n\ttest -z \"$deny\" || echo DenyUsers=\"$deny\" >> $OBJ/sshd_proxy\n\ttest -z \"$allow\" || echo AllowUsers=\"$allow\" >> $OBJ/sshd_proxy\n\n\t${SSH} -F $OBJ/ssh_proxy \"$me@somehost\" true\n\tstatus=$?\n\n\tif (test $status -eq 0 && ! $should_succeed) \\\n\t    || (test $status -ne 0 && $should_succeed); then\n\t\tfail \"$failmsg\"\n\tfi\n}\n\n#         DenyUsers     AllowUsers    should_succeed  failure_message\ntest_auth \"\"            \"\"            true            \"user in neither DenyUsers nor AllowUsers denied\"\ntest_auth \"$other $me\"  \"\"            false           \"user in DenyUsers allowed\"\ntest_auth \"$me $other\"  \"\"            false           \"user in DenyUsers allowed\"\ntest_auth \"\"            \"$other\"      false           \"user not in AllowUsers allowed\"\ntest_auth \"\"            \"$other $me\"  true            \"user in AllowUsers denied\"\ntest_auth \"\"            \"$me $other\"  true            \"user in AllowUsers denied\"\ntest_auth \"$me $other\"  \"$me $other\"  false           \"user in both DenyUsers and AllowUsers allowed\"\ntest_auth \"$other $me\"  \"$other $me\"  false           \"user in both DenyUsers and AllowUsers allowed\"\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}