{
  "module_name": "scp3.sh",
  "hash_id": "7fd4021d7658603af2dd8995887576ae6f1e8fa2e5de777b36ed2d52b4301f03",
  "original_prompt": "Ingested from openssh-9.6p1/regress/scp3.sh",
  "human_readable_source": "#\t$OpenBSD: scp3.sh,v 1.5 2023/09/08 06:10:57 djm Exp $\n#\tPlaced in the Public Domain.\n\ntid=\"scp3\"\n\nCOPY2=${OBJ}/copy2\nDIR=${COPY}.dd\nDIR2=${COPY}.dd2\n\nmaybe_add_scp_path_to_sshd\n\nSRC=`dirname ${SCRIPT}`\ncp ${SRC}/scp-ssh-wrapper.sh ${OBJ}/scp-ssh-wrapper.scp\nchmod 755 ${OBJ}/scp-ssh-wrapper.scp\nexport SCP # used in scp-ssh-wrapper.scp\n\nscpclean() {\n\trm -rf ${COPY} ${COPY2} ${DIR} ${DIR2}\n\tmkdir ${DIR} ${DIR2}\n\tchmod 755 ${DIR} ${DIR2}\n}\n\n# Create directory structure for recursive copy tests.\nforest() {\n\tscpclean\n\trm -rf ${DIR2}\n\tcp ${DATA} ${DIR}/copy\n\tln -s ${DIR}/copy ${DIR}/copy-sym\n\tmkdir ${DIR}/subdir\n\tcp ${DATA} ${DIR}/subdir/copy\n\tln -s ${DIR}/subdir ${DIR}/subdir-sym\n}\n\nfor mode in scp sftp ; do\n\tscpopts=\"-F${OBJ}/ssh_proxy -S ${SSH} -q\"\n\ttag=\"$tid: $mode mode\"\n\tif test $mode = scp ; then\n\t\tscpopts=\"$scpopts -O\"\n\telse\n\t\tscpopts=\"-s -D ${SFTPSERVER}\"\n\tfi\n\n\tverbose \"$tag: simple copy remote file to remote file\"\n\tscpclean\n\t$SCP $scpopts -3 hostA:${DATA} hostB:${COPY} || fail \"copy failed\"\n\tcmp ${DATA} ${COPY} || fail \"corrupted copy\"\n\n\tverbose \"$tag: simple copy remote file to remote dir\"\n\tscpclean\n\tcp ${DATA} ${COPY}\n\t$SCP $scpopts -3 hostA:${COPY} hostB:${DIR} || fail \"copy failed\"\n\tcmp ${COPY} ${DIR}/copy || fail \"corrupted copy\"\n\n\tverbose \"$tag: recursive remote dir to remote dir\"\n\tforest\n\t$SCP $scpopts -3r hostA:${DIR} hostB:${DIR2} || fail \"copy failed\"\n\tdiff -r ${DIR} ${DIR2} || fail \"corrupted copy\"\n\tdiff -r ${DIR2} ${DIR} || fail \"corrupted copy\"\n\n\tverbose \"$tag: detect non-directory target\"\n\tscpclean\n\techo a > ${COPY}\n\techo b > ${COPY2}\n\t$SCP $scpopts -3 hostA:${DATA} hostA:${COPY} hostB:${COPY2}\n\tcmp ${COPY} ${COPY2} >/dev/null && fail \"corrupt target\"\ndone\n\nscpclean\nrm -f ${OBJ}/scp-ssh-wrapper.exe\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}