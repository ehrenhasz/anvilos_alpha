{
  "module_name": "test_helper.h",
  "hash_id": "044ddd2d0457c2d4513df648e68f2e6f50602009dcb7ad7d36d01a4ad84b57ac",
  "original_prompt": "Ingested from openssh-9.6p1/regress/unittests/test_helper/test_helper.h",
  "human_readable_source": " \n \n\n \n\n#ifndef _TEST_HELPER_H\n#define _TEST_HELPER_H\n\n#include \"includes.h\"\n\n#include <sys/types.h>\n#ifdef HAVE_STDINT_H\n# include <stdint.h>\n#endif\n\n#ifdef WITH_OPENSSL\n#include <openssl/bn.h>\n#include <openssl/err.h>\n#endif\n\nenum test_predicate {\n\tTEST_EQ, TEST_NE, TEST_LT, TEST_LE, TEST_GT, TEST_GE\n};\ntypedef void (test_onerror_func_t)(void *);\n\n \nvoid tests(void);\n\nconst char *test_data_file(const char *name);\nvoid test_start(const char *n);\nvoid test_info(char *s, size_t len);\nvoid set_onerror_func(test_onerror_func_t *f, void *ctx);\nvoid test_done(void);\nint test_is_verbose(void);\nint test_is_quiet(void);\nint test_is_fast(void);\nint test_is_slow(void);\nvoid test_subtest_info(const char *fmt, ...)\n    __attribute__((format(printf, 1, 2)));\nvoid ssl_err_check(const char *file, int line);\n#ifdef WITH_OPENSSL\nvoid assert_bignum(const char *file, int line,\n    const char *a1, const char *a2,\n    const BIGNUM *aa1, const BIGNUM *aa2, enum test_predicate pred);\n#endif\nvoid assert_string(const char *file, int line,\n    const char *a1, const char *a2,\n    const char *aa1, const char *aa2, enum test_predicate pred);\nvoid assert_mem(const char *file, int line,\n    const char *a1, const char *a2,\n    const void *aa1, const void *aa2, size_t l, enum test_predicate pred);\nvoid assert_mem_filled(const char *file, int line,\n    const char *a1,\n    const void *aa1, u_char v, size_t l, enum test_predicate pred);\nvoid assert_int(const char *file, int line,\n    const char *a1, const char *a2,\n    int aa1, int aa2, enum test_predicate pred);\nvoid assert_size_t(const char *file, int line,\n    const char *a1, const char *a2,\n    size_t aa1, size_t aa2, enum test_predicate pred);\nvoid assert_u_int(const char *file, int line,\n    const char *a1, const char *a2,\n    u_int aa1, u_int aa2, enum test_predicate pred);\nvoid assert_long(const char *file, int line,\n    const char *a1, const char *a2,\n    long aa1, long aa2, enum test_predicate pred);\nvoid assert_long_long(const char *file, int line,\n    const char *a1, const char *a2,\n    long long aa1, long long aa2, enum test_predicate pred);\nvoid assert_char(const char *file, int line,\n    const char *a1, const char *a2,\n    char aa1, char aa2, enum test_predicate pred);\nvoid assert_ptr(const char *file, int line,\n    const char *a1, const char *a2,\n    const void *aa1, const void *aa2, enum test_predicate pred);\nvoid assert_u8(const char *file, int line,\n    const char *a1, const char *a2,\n    u_int8_t aa1, u_int8_t aa2, enum test_predicate pred);\nvoid assert_u16(const char *file, int line,\n    const char *a1, const char *a2,\n    u_int16_t aa1, u_int16_t aa2, enum test_predicate pred);\nvoid assert_u32(const char *file, int line,\n    const char *a1, const char *a2,\n    u_int32_t aa1, u_int32_t aa2, enum test_predicate pred);\nvoid assert_u64(const char *file, int line,\n    const char *a1, const char *a2,\n    u_int64_t aa1, u_int64_t aa2, enum test_predicate pred);\n\n#define TEST_START(n)\t\t\ttest_start(n)\n#define TEST_DONE()\t\t\ttest_done()\n#define TEST_ONERROR(f, c)\t\tset_onerror_func(f, c)\n#define SSL_ERR_CHECK() \t\tssl_err_check(__FILE__, __LINE__)\n\n#define ASSERT_BIGNUM_EQ(a1, a2) \\\n\tassert_bignum(__FILE__, __LINE__, #a1, #a2, a1, a2, TEST_EQ)\n#define ASSERT_STRING_EQ(a1, a2) \\\n\tassert_string(__FILE__, __LINE__, #a1, #a2, a1, a2, TEST_EQ)\n#define ASSERT_MEM_EQ(a1, a2, l) \\\n\tassert_mem(__FILE__, __LINE__, #a1, #a2, a1, a2, l, TEST_EQ)\n#define ASSERT_MEM_FILLED_EQ(a1, c, l) \\\n\tassert_mem_filled(__FILE__, __LINE__, #a1, a1, c, l, TEST_EQ)\n#define ASSERT_MEM_ZERO_EQ(a1, l) \\\n\tassert_mem_filled(__FILE__, __LINE__, #a1, a1, '\\0', l, TEST_EQ)\n#define ASSERT_INT_EQ(a1, a2) \\\n\tassert_int(__FILE__, __LINE__, #a1, #a2, a1, a2, TEST_EQ)\n#define ASSERT_SIZE_T_EQ(a1, a2) \\\n\tassert_size_t(__FILE__, __LINE__, #a1, #a2, a1, a2, TEST_EQ)\n#define ASSERT_U_INT_EQ(a1, a2) \\\n\tassert_u_int(__FILE__, __LINE__, #a1, #a2, a1, a2, TEST_EQ)\n#define ASSERT_LONG_EQ(a1, a2) \\\n\tassert_long(__FILE__, __LINE__, #a1, #a2, a1, a2, TEST_EQ)\n#define ASSERT_LONG_LONG_EQ(a1, a2) \\\n\tassert_long_long(__FILE__, __LINE__, #a1, #a2, a1, a2, TEST_EQ)\n#define ASSERT_CHAR_EQ(a1, a2) \\\n\tassert_char(__FILE__, __LINE__, #a1, #a2, a1, a2, TEST_EQ)\n#define ASSERT_PTR_EQ(a1, a2) \\\n\tassert_ptr(__FILE__, __LINE__, #a1, #a2, a1, a2, TEST_EQ)\n#define ASSERT_U8_EQ(a1, a2) \\\n\tassert_u8(__FILE__, __LINE__, #a1, #a2, a1, a2, TEST_EQ)\n#define ASSERT_U16_EQ(a1, a2) \\\n\tassert_u16(__FILE__, __LINE__, #a1, #a2, a1, a2, TEST_EQ)\n#define ASSERT_U32_EQ(a1, a2) \\\n\tassert_u32(__FILE__, __LINE__, #a1, #a2, a1, a2, TEST_EQ)\n#define ASSERT_U64_EQ(a1, a2) \\\n\tassert_u64(__FILE__, __LINE__, #a1, #a2, a1, a2, TEST_EQ)\n\n#define ASSERT_BIGNUM_NE(a1, a2) \\\n\tassert_bignum(__FILE__, __LINE__, #a1, #a2, a1, a2, TEST_NE)\n#define ASSERT_STRING_NE(a1, a2) \\\n\tassert_string(__FILE__, __LINE__, #a1, #a2, a1, a2, TEST_NE)\n#define ASSERT_MEM_NE(a1, a2, l) \\\n\tassert_mem(__FILE__, __LINE__, #a1, #a2, a1, a2, l, TEST_NE)\n#define ASSERT_MEM_ZERO_NE(a1, l) \\\n\tassert_mem_filled(__FILE__, __LINE__, #a1, a1, '\\0', l, TEST_NE)\n#define ASSERT_INT_NE(a1, a2) \\\n\tassert_int(__FILE__, __LINE__, #a1, #a2, a1, a2, TEST_NE)\n#define ASSERT_SIZE_T_NE(a1, a2) \\\n\tassert_size_t(__FILE__, __LINE__, #a1, #a2, a1, a2, TEST_NE)\n#define ASSERT_U_INT_NE(a1, a2) \\\n\tassert_u_int(__FILE__, __LINE__, #a1, #a2, a1, a2, TEST_NE)\n#define ASSERT_LONG_NE(a1, a2) \\\n\tassert_long(__FILE__, __LINE__, #a1, #a2, a1, a2, TEST_NE)\n#define ASSERT_LONG_LONG_NE(a1, a2) \\\n\tassert_long_long(__FILE__, __LINE__, #a1, #a2, a1, a2, TEST_NE)\n#define ASSERT_CHAR_NE(a1, a2) \\\n\tassert_char(__FILE__, __LINE__, #a1, #a2, a1, a2, TEST_NE)\n#define ASSERT_PTR_NE(a1, a2) \\\n\tassert_ptr(__FILE__, __LINE__, #a1, #a2, a1, a2, TEST_NE)\n#define ASSERT_U8_NE(a1, a2) \\\n\tassert_u8(__FILE__, __LINE__, #a1, #a2, a1, a2, TEST_NE)\n#define ASSERT_U16_NE(a1, a2) \\\n\tassert_u16(__FILE__, __LINE__, #a1, #a2, a1, a2, TEST_NE)\n#define ASSERT_U32_NE(a1, a2) \\\n\tassert_u32(__FILE__, __LINE__, #a1, #a2, a1, a2, TEST_NE)\n#define ASSERT_U64_NE(a1, a2) \\\n\tassert_u64(__FILE__, __LINE__, #a1, #a2, a1, a2, TEST_NE)\n\n#define ASSERT_BIGNUM_LT(a1, a2) \\\n\tassert_bignum(__FILE__, __LINE__, #a1, #a2, a1, a2, TEST_LT)\n#define ASSERT_STRING_LT(a1, a2) \\\n\tassert_string(__FILE__, __LINE__, #a1, #a2, a1, a2, TEST_LT)\n#define ASSERT_MEM_LT(a1, a2, l) \\\n\tassert_mem(__FILE__, __LINE__, #a1, #a2, a1, a2, l, TEST_LT)\n#define ASSERT_INT_LT(a1, a2) \\\n\tassert_int(__FILE__, __LINE__, #a1, #a2, a1, a2, TEST_LT)\n#define ASSERT_SIZE_T_LT(a1, a2) \\\n\tassert_size_t(__FILE__, __LINE__, #a1, #a2, a1, a2, TEST_LT)\n#define ASSERT_U_INT_LT(a1, a2) \\\n\tassert_u_int(__FILE__, __LINE__, #a1, #a2, a1, a2, TEST_LT)\n#define ASSERT_LONG_LT(a1, a2) \\\n\tassert_long(__FILE__, __LINE__, #a1, #a2, a1, a2, TEST_LT)\n#define ASSERT_LONG_LONG_LT(a1, a2) \\\n\tassert_long_long(__FILE__, __LINE__, #a1, #a2, a1, a2, TEST_LT)\n#define ASSERT_CHAR_LT(a1, a2) \\\n\tassert_char(__FILE__, __LINE__, #a1, #a2, a1, a2, TEST_LT)\n#define ASSERT_PTR_LT(a1, a2) \\\n\tassert_ptr(__FILE__, __LINE__, #a1, #a2, a1, a2, TEST_LT)\n#define ASSERT_U8_LT(a1, a2) \\\n\tassert_u8(__FILE__, __LINE__, #a1, #a2, a1, a2, TEST_LT)\n#define ASSERT_U16_LT(a1, a2) \\\n\tassert_u16(__FILE__, __LINE__, #a1, #a2, a1, a2, TEST_LT)\n#define ASSERT_U32_LT(a1, a2) \\\n\tassert_u32(__FILE__, __LINE__, #a1, #a2, a1, a2, TEST_LT)\n#define ASSERT_U64_LT(a1, a2) \\\n\tassert_u64(__FILE__, __LINE__, #a1, #a2, a1, a2, TEST_LT)\n\n#define ASSERT_BIGNUM_LE(a1, a2) \\\n\tassert_bignum(__FILE__, __LINE__, #a1, #a2, a1, a2, TEST_LE)\n#define ASSERT_STRING_LE(a1, a2) \\\n\tassert_string(__FILE__, __LINE__, #a1, #a2, a1, a2, TEST_LE)\n#define ASSERT_MEM_LE(a1, a2, l) \\\n\tassert_mem(__FILE__, __LINE__, #a1, #a2, a1, a2, l, TEST_LE)\n#define ASSERT_INT_LE(a1, a2) \\\n\tassert_int(__FILE__, __LINE__, #a1, #a2, a1, a2, TEST_LE)\n#define ASSERT_SIZE_T_LE(a1, a2) \\\n\tassert_size_t(__FILE__, __LINE__, #a1, #a2, a1, a2, TEST_LE)\n#define ASSERT_U_INT_LE(a1, a2) \\\n\tassert_u_int(__FILE__, __LINE__, #a1, #a2, a1, a2, TEST_LE)\n#define ASSERT_LONG_LE(a1, a2) \\\n\tassert_long(__FILE__, __LINE__, #a1, #a2, a1, a2, TEST_LE)\n#define ASSERT_LONG_LONG_LE(a1, a2) \\\n\tassert_long_long(__FILE__, __LINE__, #a1, #a2, a1, a2, TEST_LE)\n#define ASSERT_CHAR_LE(a1, a2) \\\n\tassert_char(__FILE__, __LINE__, #a1, #a2, a1, a2, TEST_LE)\n#define ASSERT_PTR_LE(a1, a2) \\\n\tassert_ptr(__FILE__, __LINE__, #a1, #a2, a1, a2, TEST_LE)\n#define ASSERT_U8_LE(a1, a2) \\\n\tassert_u8(__FILE__, __LINE__, #a1, #a2, a1, a2, TEST_LE)\n#define ASSERT_U16_LE(a1, a2) \\\n\tassert_u16(__FILE__, __LINE__, #a1, #a2, a1, a2, TEST_LE)\n#define ASSERT_U32_LE(a1, a2) \\\n\tassert_u32(__FILE__, __LINE__, #a1, #a2, a1, a2, TEST_LE)\n#define ASSERT_U64_LE(a1, a2) \\\n\tassert_u64(__FILE__, __LINE__, #a1, #a2, a1, a2, TEST_LE)\n\n#define ASSERT_BIGNUM_GT(a1, a2) \\\n\tassert_bignum(__FILE__, __LINE__, #a1, #a2, a1, a2, TEST_GT)\n#define ASSERT_STRING_GT(a1, a2) \\\n\tassert_string(__FILE__, __LINE__, #a1, #a2, a1, a2, TEST_GT)\n#define ASSERT_MEM_GT(a1, a2, l) \\\n\tassert_mem(__FILE__, __LINE__, #a1, #a2, a1, a2, l, TEST_GT)\n#define ASSERT_INT_GT(a1, a2) \\\n\tassert_int(__FILE__, __LINE__, #a1, #a2, a1, a2, TEST_GT)\n#define ASSERT_SIZE_T_GT(a1, a2) \\\n\tassert_size_t(__FILE__, __LINE__, #a1, #a2, a1, a2, TEST_GT)\n#define ASSERT_U_INT_GT(a1, a2) \\\n\tassert_u_int(__FILE__, __LINE__, #a1, #a2, a1, a2, TEST_GT)\n#define ASSERT_LONG_GT(a1, a2) \\\n\tassert_long(__FILE__, __LINE__, #a1, #a2, a1, a2, TEST_GT)\n#define ASSERT_LONG_LONG_GT(a1, a2) \\\n\tassert_long_long(__FILE__, __LINE__, #a1, #a2, a1, a2, TEST_GT)\n#define ASSERT_CHAR_GT(a1, a2) \\\n\tassert_char(__FILE__, __LINE__, #a1, #a2, a1, a2, TEST_GT)\n#define ASSERT_PTR_GT(a1, a2) \\\n\tassert_ptr(__FILE__, __LINE__, #a1, #a2, a1, a2, TEST_GT)\n#define ASSERT_U8_GT(a1, a2) \\\n\tassert_u8(__FILE__, __LINE__, #a1, #a2, a1, a2, TEST_GT)\n#define ASSERT_U16_GT(a1, a2) \\\n\tassert_u16(__FILE__, __LINE__, #a1, #a2, a1, a2, TEST_GT)\n#define ASSERT_U32_GT(a1, a2) \\\n\tassert_u32(__FILE__, __LINE__, #a1, #a2, a1, a2, TEST_GT)\n#define ASSERT_U64_GT(a1, a2) \\\n\tassert_u64(__FILE__, __LINE__, #a1, #a2, a1, a2, TEST_GT)\n\n#define ASSERT_BIGNUM_GE(a1, a2) \\\n\tassert_bignum(__FILE__, __LINE__, #a1, #a2, a1, a2, TEST_GE)\n#define ASSERT_STRING_GE(a1, a2) \\\n\tassert_string(__FILE__, __LINE__, #a1, #a2, a1, a2, TEST_GE)\n#define ASSERT_MEM_GE(a1, a2, l) \\\n\tassert_mem(__FILE__, __LINE__, #a1, #a2, a1, a2, l, TEST_GE)\n#define ASSERT_INT_GE(a1, a2) \\\n\tassert_int(__FILE__, __LINE__, #a1, #a2, a1, a2, TEST_GE)\n#define ASSERT_SIZE_T_GE(a1, a2) \\\n\tassert_size_t(__FILE__, __LINE__, #a1, #a2, a1, a2, TEST_GE)\n#define ASSERT_U_INT_GE(a1, a2) \\\n\tassert_u_int(__FILE__, __LINE__, #a1, #a2, a1, a2, TEST_GE)\n#define ASSERT_LONG_GE(a1, a2) \\\n\tassert_long(__FILE__, __LINE__, #a1, #a2, a1, a2, TEST_GE)\n#define ASSERT_LONG_LONG_GE(a1, a2) \\\n\tassert_long_long(__FILE__, __LINE__, #a1, #a2, a1, a2, TEST_GE)\n#define ASSERT_CHAR_GE(a1, a2) \\\n\tassert_char(__FILE__, __LINE__, #a1, #a2, a1, a2, TEST_GE)\n#define ASSERT_PTR_GE(a1, a2) \\\n\tassert_ptr(__FILE__, __LINE__, #a1, #a2, a1, a2, TEST_GE)\n#define ASSERT_U8_GE(a1, a2) \\\n\tassert_u8(__FILE__, __LINE__, #a1, #a2, a1, a2, TEST_GE)\n#define ASSERT_U16_GE(a1, a2) \\\n\tassert_u16(__FILE__, __LINE__, #a1, #a2, a1, a2, TEST_GE)\n#define ASSERT_U32_GE(a1, a2) \\\n\tassert_u32(__FILE__, __LINE__, #a1, #a2, a1, a2, TEST_GE)\n#define ASSERT_U64_GE(a1, a2) \\\n\tassert_u64(__FILE__, __LINE__, #a1, #a2, a1, a2, TEST_GE)\n\n \n\nstruct fuzz;\n#define FUZZ_1_BIT_FLIP\t\t0x00000001\t \n#define FUZZ_2_BIT_FLIP\t\t0x00000002\t \n#define FUZZ_1_BYTE_FLIP\t0x00000004\t \n#define FUZZ_2_BYTE_FLIP\t0x00000008\t \n#define FUZZ_TRUNCATE_START\t0x00000010\t \n#define FUZZ_TRUNCATE_END\t0x00000020\t \n#define FUZZ_BASE64\t\t0x00000040\t \n#define FUZZ_MAX\t\tFUZZ_BASE64\n\n \nstruct fuzz *fuzz_begin(u_int strategies, const void *p, size_t l);\n\n \nvoid fuzz_cleanup(struct fuzz *fuzz);\n\n \nvoid fuzz_next(struct fuzz *fuzz);\n\n \nint fuzz_matches_original(struct fuzz *fuzz);\n\n \nint fuzz_done(struct fuzz *fuzz);\n\n \nsize_t fuzz_len(struct fuzz *fuzz);\nu_char *fuzz_ptr(struct fuzz *fuzz);\n\n \nvoid fuzz_dump(struct fuzz *fuzz);\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}