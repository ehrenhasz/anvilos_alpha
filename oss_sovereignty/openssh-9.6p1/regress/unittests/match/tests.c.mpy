{
  "module_name": "tests.c",
  "hash_id": "62d31bd263ac9c2d6d98904ad117edb2053e2eb1fa2b8ffdaee1eb1d6961712e",
  "original_prompt": "Ingested from openssh-9.6p1/regress/unittests/match/tests.c",
  "human_readable_source": " \n \n\n#include \"includes.h\"\n\n#include <sys/types.h>\n#include <stdio.h>\n#ifdef HAVE_STDINT_H\n#include <stdint.h>\n#endif\n#include <stdlib.h>\n#include <string.h>\n\n#include \"../test_helper/test_helper.h\"\n\n#include \"match.h\"\n\nvoid\ntests(void)\n{\n\tTEST_START(\"match_pattern\");\n\tASSERT_INT_EQ(match_pattern(\"\", \"\"), 1);\n\tASSERT_INT_EQ(match_pattern(\"\", \"aaa\"), 0);\n\tASSERT_INT_EQ(match_pattern(\"aaa\", \"\"), 0);\n\tASSERT_INT_EQ(match_pattern(\"aaa\", \"aaaa\"), 0);\n\tASSERT_INT_EQ(match_pattern(\"aaaa\", \"aaa\"), 0);\n\tTEST_DONE();\n\n\tTEST_START(\"match_pattern wildcard\");\n\tASSERT_INT_EQ(match_pattern(\"\", \"*\"), 1);\n\tASSERT_INT_EQ(match_pattern(\"a\", \"?\"), 1);\n\tASSERT_INT_EQ(match_pattern(\"aa\", \"a?\"), 1);\n\tASSERT_INT_EQ(match_pattern(\"a\", \"*\"), 1);\n\tASSERT_INT_EQ(match_pattern(\"aa\", \"a*\"), 1);\n\tASSERT_INT_EQ(match_pattern(\"aa\", \"?*\"), 1);\n\tASSERT_INT_EQ(match_pattern(\"aa\", \"**\"), 1);\n\tASSERT_INT_EQ(match_pattern(\"aa\", \"?a\"), 1);\n\tASSERT_INT_EQ(match_pattern(\"aa\", \"*a\"), 1);\n\tASSERT_INT_EQ(match_pattern(\"ba\", \"a?\"), 0);\n\tASSERT_INT_EQ(match_pattern(\"ba\", \"a*\"), 0);\n\tASSERT_INT_EQ(match_pattern(\"ab\", \"?a\"), 0);\n\tASSERT_INT_EQ(match_pattern(\"ab\", \"*a\"), 0);\n\tTEST_DONE();\n\n\tTEST_START(\"match_pattern_list\");\n\tASSERT_INT_EQ(match_pattern_list(\"\", \"\", 0), 0);  \n\tASSERT_INT_EQ(match_pattern_list(\"\", \"*\", 0), 1);\n\tASSERT_INT_EQ(match_pattern_list(\"\", \"!*\", 0), -1);\n\tASSERT_INT_EQ(match_pattern_list(\"\", \"!a,*\", 0), 1);\n\tASSERT_INT_EQ(match_pattern_list(\"\", \"*,!a\", 0), 1);\n\tASSERT_INT_EQ(match_pattern_list(\"\", \"a,!*\", 0), -1);\n\tASSERT_INT_EQ(match_pattern_list(\"\", \"!*,a\", 0), -1);\n\tASSERT_INT_EQ(match_pattern_list(\"a\", \"\", 0), 0);\n\tASSERT_INT_EQ(match_pattern_list(\"a\", \"*\", 0), 1);\n\tASSERT_INT_EQ(match_pattern_list(\"a\", \"!*\", 0), -1);\n\tASSERT_INT_EQ(match_pattern_list(\"a\", \"!a\", 0), -1);\n\t \n\tASSERT_INT_EQ(match_pattern_list(\"a\", \"!a,*\", 0), -1);\n\tASSERT_INT_EQ(match_pattern_list(\"b\", \"!a,*\", 0), 1);\n\tASSERT_INT_EQ(match_pattern_list(\"a\", \"*,!a\", 0), -1);\n\tASSERT_INT_EQ(match_pattern_list(\"b\", \"*,!a\", 0), 1);\n\tASSERT_INT_EQ(match_pattern_list(\"a\", \"a,!*\", 0), -1);\n\tASSERT_INT_EQ(match_pattern_list(\"b\", \"a,!*\", 0), -1);\n\tASSERT_INT_EQ(match_pattern_list(\"a\", \"a,!a\", 0), -1);\n\t \n\tASSERT_INT_EQ(match_pattern_list(\"a\", \"!*,a\", 0), -1);\n\tASSERT_INT_EQ(match_pattern_list(\"b\", \"!*,a\", 0), -1);\n\tTEST_DONE();\n\n\tTEST_START(\"match_pattern_list lowercase\");\n\tASSERT_INT_EQ(match_pattern_list(\"abc\", \"ABC\", 0), 0);\n\tASSERT_INT_EQ(match_pattern_list(\"ABC\", \"abc\", 0), 0);\n\tASSERT_INT_EQ(match_pattern_list(\"abc\", \"ABC\", 1), 1);\n\tASSERT_INT_EQ(match_pattern_list(\"ABC\", \"abc\", 1), 0);\n\tTEST_DONE();\n\n\tTEST_START(\"addr_match_list\");\n\tASSERT_INT_EQ(addr_match_list(\"127.0.0.1\", \"127.0.0.1/44\"), -2);\n\tASSERT_INT_EQ(addr_match_list(NULL, \"127.0.0.1/44\"), -2);\n\tASSERT_INT_EQ(addr_match_list(\"a\", \"*\"), 0);\n\tASSERT_INT_EQ(addr_match_list(\"127.0.0.1\", \"*\"), 1);\n\tASSERT_INT_EQ(addr_match_list(NULL, \"*\"), 0);\n\tASSERT_INT_EQ(addr_match_list(\"127.0.0.1\", \"127.0.0.1\"), 1);\n\tASSERT_INT_EQ(addr_match_list(\"127.0.0.1\", \"127.0.0.2\"), 0);\n\tASSERT_INT_EQ(addr_match_list(\"127.0.0.1\", \"!127.0.0.1\"), -1);\n\t \n\tASSERT_INT_EQ(addr_match_list(\"127.0.0.255\", \"127.0.0.0/24\"), 1);\n\tASSERT_INT_EQ(addr_match_list(\"127.0.1.1\", \"127.0.0.0/24\"), 0);\n\tASSERT_INT_EQ(addr_match_list(\"127.0.0.1\", \"127.0.0.0/24\"), 1);\n\tASSERT_INT_EQ(addr_match_list(\"127.0.0.1\", \"127.0.1.0/24\"), 0);\n\tASSERT_INT_EQ(addr_match_list(\"127.0.0.1\", \"!127.0.0.0/24\"), -1);\n\t \n\tASSERT_INT_EQ(addr_match_list(\"127.0.0.1\", \"10.0.0.1,!127.0.0.1\"), -1);\n\tASSERT_INT_EQ(addr_match_list(\"127.0.0.1\", \"!127.0.0.1,10.0.0.1\"), -1);\n\tASSERT_INT_EQ(addr_match_list(\"127.0.0.1\", \"10.0.0.1,127.0.0.2\"), 0);\n\tASSERT_INT_EQ(addr_match_list(\"127.0.0.1\", \"127.0.0.2,10.0.0.1\"), 0);\n\t \n\t \n\tTEST_DONE();\n\n#define CHECK_FILTER(string,filter,expected) \\\n\tdo { \\\n\t\tchar *result = match_filter_denylist((string), (filter)); \\\n\t\tASSERT_STRING_EQ(result, expected); \\\n\t\tfree(result); \\\n\t} while (0)\n\n\tTEST_START(\"match_filter_list\");\n\tCHECK_FILTER(\"a,b,c\", \"\", \"a,b,c\");\n\tCHECK_FILTER(\"a,b,c\", \"a\", \"b,c\");\n\tCHECK_FILTER(\"a,b,c\", \"b\", \"a,c\");\n\tCHECK_FILTER(\"a,b,c\", \"c\", \"a,b\");\n\tCHECK_FILTER(\"a,b,c\", \"a,b\", \"c\");\n\tCHECK_FILTER(\"a,b,c\", \"a,c\", \"b\");\n\tCHECK_FILTER(\"a,b,c\", \"b,c\", \"a\");\n\tCHECK_FILTER(\"a,b,c\", \"a,b,c\", \"\");\n\tCHECK_FILTER(\"a,b,c\", \"b,c\", \"a\");\n\tCHECK_FILTER(\"\", \"a,b,c\", \"\");\n\tTEST_DONE();\n \n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}