{
  "module_name": "test_file.c",
  "hash_id": "9609e8f41ffacbd5f7b51a765cc3d3d05e2b9ea42a3650da8edbe3f213be05d4",
  "original_prompt": "Ingested from openssh-9.6p1/regress/unittests/sshkey/test_file.c",
  "human_readable_source": " \n \n\n#include \"includes.h\"\n\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <stdio.h>\n#ifdef HAVE_STDINT_H\n#include <stdint.h>\n#endif\n#include <stdlib.h>\n#include <string.h>\n#include <unistd.h>\n\n#ifdef WITH_OPENSSL\n#include <openssl/bn.h>\n#include <openssl/rsa.h>\n#include <openssl/dsa.h>\n#include <openssl/objects.h>\n#ifdef OPENSSL_HAS_NISTP256\n# include <openssl/ec.h>\n#endif  \n#endif  \n\n#include \"../test_helper/test_helper.h\"\n\n#include \"ssherr.h\"\n#include \"authfile.h\"\n#include \"sshkey.h\"\n#include \"sshbuf.h\"\n#include \"digest.h\"\n\n#include \"common.h\"\n\nvoid sshkey_file_tests(void);\n\nvoid\nsshkey_file_tests(void)\n{\n\tstruct sshkey *k1, *k2;\n\tstruct sshbuf *buf, *pw;\n#ifdef WITH_OPENSSL\n\tBIGNUM *a, *b, *c;\n#endif\n\tchar *cp;\n\n\tTEST_START(\"load passphrase\");\n\tpw = load_text_file(\"pw\");\n\tTEST_DONE();\n\n\n#ifdef WITH_OPENSSL\n\tTEST_START(\"parse RSA from private\");\n\tbuf = load_file(\"rsa_1\");\n\tASSERT_INT_EQ(sshkey_parse_private_fileblob(buf, \"\", &k1, NULL), 0);\n\tsshbuf_free(buf);\n\tASSERT_PTR_NE(k1, NULL);\n\ta = load_bignum(\"rsa_1.param.n\");\n\tb = load_bignum(\"rsa_1.param.p\");\n\tc = load_bignum(\"rsa_1.param.q\");\n\tASSERT_BIGNUM_EQ(rsa_n(k1), a);\n\tASSERT_BIGNUM_EQ(rsa_p(k1), b);\n\tASSERT_BIGNUM_EQ(rsa_q(k1), c);\n\tBN_free(a);\n\tBN_free(b);\n\tBN_free(c);\n\tTEST_DONE();\n\n\tTEST_START(\"parse RSA from private w/ passphrase\");\n\tbuf = load_file(\"rsa_1_pw\");\n\tASSERT_INT_EQ(sshkey_parse_private_fileblob(buf,\n\t    (const char *)sshbuf_ptr(pw), &k2, NULL), 0);\n\tsshbuf_free(buf);\n\tASSERT_PTR_NE(k2, NULL);\n\tASSERT_INT_EQ(sshkey_equal(k1, k2), 1);\n\tsshkey_free(k2);\n\tTEST_DONE();\n\n\tTEST_START(\"parse RSA from new-format\");\n\tbuf = load_file(\"rsa_n\");\n\tASSERT_INT_EQ(sshkey_parse_private_fileblob(buf, \"\", &k2, NULL), 0);\n\tsshbuf_free(buf);\n\tASSERT_PTR_NE(k2, NULL);\n\tASSERT_INT_EQ(sshkey_equal(k1, k2), 1);\n\tsshkey_free(k2);\n\tTEST_DONE();\n\n\tTEST_START(\"parse RSA from new-format w/ passphrase\");\n\tbuf = load_file(\"rsa_n_pw\");\n\tASSERT_INT_EQ(sshkey_parse_private_fileblob(buf,\n\t    (const char *)sshbuf_ptr(pw), &k2, NULL), 0);\n\tsshbuf_free(buf);\n\tASSERT_PTR_NE(k2, NULL);\n\tASSERT_INT_EQ(sshkey_equal(k1, k2), 1);\n\tsshkey_free(k2);\n\tTEST_DONE();\n\n\tTEST_START(\"load RSA from public\");\n\tASSERT_INT_EQ(sshkey_load_public(test_data_file(\"rsa_1.pub\"), &k2,\n\t    NULL), 0);\n\tASSERT_PTR_NE(k2, NULL);\n\tASSERT_INT_EQ(sshkey_equal(k1, k2), 1);\n\tsshkey_free(k2);\n\tTEST_DONE();\n\n\tTEST_START(\"load RSA cert with SHA1 signature\");\n\tASSERT_INT_EQ(sshkey_load_cert(test_data_file(\"rsa_1_sha1\"), &k2), 0);\n\tASSERT_PTR_NE(k2, NULL);\n\tASSERT_INT_EQ(k2->type, KEY_RSA_CERT);\n\tASSERT_INT_EQ(sshkey_equal_public(k1, k2), 1);\n\tASSERT_STRING_EQ(k2->cert->signature_type, \"ssh-rsa\");\n\tsshkey_free(k2);\n\tTEST_DONE();\n\n\tTEST_START(\"load RSA cert with SHA512 signature\");\n\tASSERT_INT_EQ(sshkey_load_cert(test_data_file(\"rsa_1_sha512\"), &k2), 0);\n\tASSERT_PTR_NE(k2, NULL);\n\tASSERT_INT_EQ(k2->type, KEY_RSA_CERT);\n\tASSERT_INT_EQ(sshkey_equal_public(k1, k2), 1);\n\tASSERT_STRING_EQ(k2->cert->signature_type, \"rsa-sha2-512\");\n\tsshkey_free(k2);\n\tTEST_DONE();\n\n\tTEST_START(\"load RSA cert\");\n\tASSERT_INT_EQ(sshkey_load_cert(test_data_file(\"rsa_1\"), &k2), 0);\n\tASSERT_PTR_NE(k2, NULL);\n\tASSERT_INT_EQ(k2->type, KEY_RSA_CERT);\n\tASSERT_INT_EQ(sshkey_equal(k1, k2), 0);\n\tASSERT_INT_EQ(sshkey_equal_public(k1, k2), 1);\n\tTEST_DONE();\n\n\tTEST_START(\"RSA key hex fingerprint\");\n\tbuf = load_text_file(\"rsa_1.fp\");\n\tcp = sshkey_fingerprint(k1, SSH_DIGEST_SHA256, SSH_FP_BASE64);\n\tASSERT_PTR_NE(cp, NULL);\n\tASSERT_STRING_EQ(cp, (const char *)sshbuf_ptr(buf));\n\tsshbuf_free(buf);\n\tfree(cp);\n\tTEST_DONE();\n\n\tTEST_START(\"RSA cert hex fingerprint\");\n\tbuf = load_text_file(\"rsa_1-cert.fp\");\n\tcp = sshkey_fingerprint(k2, SSH_DIGEST_SHA256, SSH_FP_BASE64);\n\tASSERT_PTR_NE(cp, NULL);\n\tASSERT_STRING_EQ(cp, (const char *)sshbuf_ptr(buf));\n\tsshbuf_free(buf);\n\tfree(cp);\n\tsshkey_free(k2);\n\tTEST_DONE();\n\n\tTEST_START(\"RSA key bubblebabble fingerprint\");\n\tbuf = load_text_file(\"rsa_1.fp.bb\");\n\tcp = sshkey_fingerprint(k1, SSH_DIGEST_SHA1, SSH_FP_BUBBLEBABBLE);\n\tASSERT_PTR_NE(cp, NULL);\n\tASSERT_STRING_EQ(cp, (const char *)sshbuf_ptr(buf));\n\tsshbuf_free(buf);\n\tfree(cp);\n\tTEST_DONE();\n\n\tsshkey_free(k1);\n\n\tTEST_START(\"parse DSA from private\");\n\tbuf = load_file(\"dsa_1\");\n\tASSERT_INT_EQ(sshkey_parse_private_fileblob(buf, \"\", &k1, NULL), 0);\n\tsshbuf_free(buf);\n\tASSERT_PTR_NE(k1, NULL);\n\ta = load_bignum(\"dsa_1.param.g\");\n\tb = load_bignum(\"dsa_1.param.priv\");\n\tc = load_bignum(\"dsa_1.param.pub\");\n\tASSERT_BIGNUM_EQ(dsa_g(k1), a);\n\tASSERT_BIGNUM_EQ(dsa_priv_key(k1), b);\n\tASSERT_BIGNUM_EQ(dsa_pub_key(k1), c);\n\tBN_free(a);\n\tBN_free(b);\n\tBN_free(c);\n\tTEST_DONE();\n\n\tTEST_START(\"parse DSA from private w/ passphrase\");\n\tbuf = load_file(\"dsa_1_pw\");\n\tASSERT_INT_EQ(sshkey_parse_private_fileblob(buf,\n\t    (const char *)sshbuf_ptr(pw), &k2, NULL), 0);\n\tsshbuf_free(buf);\n\tASSERT_PTR_NE(k2, NULL);\n\tASSERT_INT_EQ(sshkey_equal(k1, k2), 1);\n\tsshkey_free(k2);\n\tTEST_DONE();\n\n\tTEST_START(\"parse DSA from new-format\");\n\tbuf = load_file(\"dsa_n\");\n\tASSERT_INT_EQ(sshkey_parse_private_fileblob(buf, \"\", &k2, NULL), 0);\n\tsshbuf_free(buf);\n\tASSERT_PTR_NE(k2, NULL);\n\tASSERT_INT_EQ(sshkey_equal(k1, k2), 1);\n\tsshkey_free(k2);\n\tTEST_DONE();\n\n\tTEST_START(\"parse DSA from new-format w/ passphrase\");\n\tbuf = load_file(\"dsa_n_pw\");\n\tASSERT_INT_EQ(sshkey_parse_private_fileblob(buf,\n\t    (const char *)sshbuf_ptr(pw), &k2, NULL), 0);\n\tsshbuf_free(buf);\n\tASSERT_PTR_NE(k2, NULL);\n\tASSERT_INT_EQ(sshkey_equal(k1, k2), 1);\n\tsshkey_free(k2);\n\tTEST_DONE();\n\n\tTEST_START(\"load DSA from public\");\n\tASSERT_INT_EQ(sshkey_load_public(test_data_file(\"dsa_1.pub\"), &k2,\n\t    NULL), 0);\n\tASSERT_PTR_NE(k2, NULL);\n\tASSERT_INT_EQ(sshkey_equal(k1, k2), 1);\n\tsshkey_free(k2);\n\tTEST_DONE();\n\n\tTEST_START(\"load DSA cert\");\n\tASSERT_INT_EQ(sshkey_load_cert(test_data_file(\"dsa_1\"), &k2), 0);\n\tASSERT_PTR_NE(k2, NULL);\n\tASSERT_INT_EQ(k2->type, KEY_DSA_CERT);\n\tASSERT_INT_EQ(sshkey_equal(k1, k2), 0);\n\tASSERT_INT_EQ(sshkey_equal_public(k1, k2), 1);\n\tTEST_DONE();\n\n\tTEST_START(\"DSA key hex fingerprint\");\n\tbuf = load_text_file(\"dsa_1.fp\");\n\tcp = sshkey_fingerprint(k1, SSH_DIGEST_SHA256, SSH_FP_BASE64);\n\tASSERT_PTR_NE(cp, NULL);\n\tASSERT_STRING_EQ(cp, (const char *)sshbuf_ptr(buf));\n\tsshbuf_free(buf);\n\tfree(cp);\n\tTEST_DONE();\n\n\tTEST_START(\"DSA cert hex fingerprint\");\n\tbuf = load_text_file(\"dsa_1-cert.fp\");\n\tcp = sshkey_fingerprint(k2, SSH_DIGEST_SHA256, SSH_FP_BASE64);\n\tASSERT_PTR_NE(cp, NULL);\n\tASSERT_STRING_EQ(cp, (const char *)sshbuf_ptr(buf));\n\tsshbuf_free(buf);\n\tfree(cp);\n\tsshkey_free(k2);\n\tTEST_DONE();\n\n\tTEST_START(\"DSA key bubblebabble fingerprint\");\n\tbuf = load_text_file(\"dsa_1.fp.bb\");\n\tcp = sshkey_fingerprint(k1, SSH_DIGEST_SHA1, SSH_FP_BUBBLEBABBLE);\n\tASSERT_PTR_NE(cp, NULL);\n\tASSERT_STRING_EQ(cp, (const char *)sshbuf_ptr(buf));\n\tsshbuf_free(buf);\n\tfree(cp);\n\tTEST_DONE();\n\n\tsshkey_free(k1);\n\n#ifdef OPENSSL_HAS_ECC\n\tTEST_START(\"parse ECDSA from private\");\n\tbuf = load_file(\"ecdsa_1\");\n\tASSERT_INT_EQ(sshkey_parse_private_fileblob(buf, \"\", &k1, NULL), 0);\n\tsshbuf_free(buf);\n\tASSERT_PTR_NE(k1, NULL);\n\tbuf = load_text_file(\"ecdsa_1.param.curve\");\n\tASSERT_STRING_EQ((const char *)sshbuf_ptr(buf),\n\t    OBJ_nid2sn(k1->ecdsa_nid));\n\tsshbuf_free(buf);\n#ifndef OPENSSL_IS_BORINGSSL  \n\ta = load_bignum(\"ecdsa_1.param.priv\");\n\tb = load_bignum(\"ecdsa_1.param.pub\");\n\tc = EC_POINT_point2bn(EC_KEY_get0_group(k1->ecdsa),\n\t    EC_KEY_get0_public_key(k1->ecdsa), POINT_CONVERSION_UNCOMPRESSED,\n\t    NULL, NULL);\n\tASSERT_PTR_NE(c, NULL);\n\tASSERT_BIGNUM_EQ(EC_KEY_get0_private_key(k1->ecdsa), a);\n\tASSERT_BIGNUM_EQ(b, c);\n\tBN_free(a);\n\tBN_free(b);\n\tBN_free(c);\n#endif  \n\tTEST_DONE();\n\n\tTEST_START(\"parse ECDSA from private w/ passphrase\");\n\tbuf = load_file(\"ecdsa_1_pw\");\n\tASSERT_INT_EQ(sshkey_parse_private_fileblob(buf,\n\t    (const char *)sshbuf_ptr(pw), &k2, NULL), 0);\n\tsshbuf_free(buf);\n\tASSERT_PTR_NE(k2, NULL);\n\tASSERT_INT_EQ(sshkey_equal(k1, k2), 1);\n\tsshkey_free(k2);\n\tTEST_DONE();\n\n\tTEST_START(\"parse ECDSA from new-format\");\n\tbuf = load_file(\"ecdsa_n\");\n\tASSERT_INT_EQ(sshkey_parse_private_fileblob(buf, \"\", &k2, NULL), 0);\n\tsshbuf_free(buf);\n\tASSERT_PTR_NE(k2, NULL);\n\tASSERT_INT_EQ(sshkey_equal(k1, k2), 1);\n\tsshkey_free(k2);\n\tTEST_DONE();\n\n\tTEST_START(\"parse ECDSA from new-format w/ passphrase\");\n\tbuf = load_file(\"ecdsa_n_pw\");\n\tASSERT_INT_EQ(sshkey_parse_private_fileblob(buf,\n\t    (const char *)sshbuf_ptr(pw), &k2, NULL), 0);\n\tsshbuf_free(buf);\n\tASSERT_PTR_NE(k2, NULL);\n\tASSERT_INT_EQ(sshkey_equal(k1, k2), 1);\n\tsshkey_free(k2);\n\tTEST_DONE();\n\n\tTEST_START(\"load ECDSA from public\");\n\tASSERT_INT_EQ(sshkey_load_public(test_data_file(\"ecdsa_1.pub\"), &k2,\n\t    NULL), 0);\n\tASSERT_PTR_NE(k2, NULL);\n\tASSERT_INT_EQ(sshkey_equal(k1, k2), 1);\n\tsshkey_free(k2);\n\tTEST_DONE();\n\n\tTEST_START(\"load ECDSA cert\");\n\tASSERT_INT_EQ(sshkey_load_cert(test_data_file(\"ecdsa_1\"), &k2), 0);\n\tASSERT_PTR_NE(k2, NULL);\n\tASSERT_INT_EQ(k2->type, KEY_ECDSA_CERT);\n\tASSERT_INT_EQ(sshkey_equal(k1, k2), 0);\n\tASSERT_INT_EQ(sshkey_equal_public(k1, k2), 1);\n\tTEST_DONE();\n\n\tTEST_START(\"ECDSA key hex fingerprint\");\n\tbuf = load_text_file(\"ecdsa_1.fp\");\n\tcp = sshkey_fingerprint(k1, SSH_DIGEST_SHA256, SSH_FP_BASE64);\n\tASSERT_PTR_NE(cp, NULL);\n\tASSERT_STRING_EQ(cp, (const char *)sshbuf_ptr(buf));\n\tsshbuf_free(buf);\n\tfree(cp);\n\tTEST_DONE();\n\n\tTEST_START(\"ECDSA cert hex fingerprint\");\n\tbuf = load_text_file(\"ecdsa_1-cert.fp\");\n\tcp = sshkey_fingerprint(k2, SSH_DIGEST_SHA256, SSH_FP_BASE64);\n\tASSERT_PTR_NE(cp, NULL);\n\tASSERT_STRING_EQ(cp, (const char *)sshbuf_ptr(buf));\n\tsshbuf_free(buf);\n\tfree(cp);\n\tsshkey_free(k2);\n\tTEST_DONE();\n\n\tTEST_START(\"ECDSA key bubblebabble fingerprint\");\n\tbuf = load_text_file(\"ecdsa_1.fp.bb\");\n\tcp = sshkey_fingerprint(k1, SSH_DIGEST_SHA1, SSH_FP_BUBBLEBABBLE);\n\tASSERT_PTR_NE(cp, NULL);\n\tASSERT_STRING_EQ(cp, (const char *)sshbuf_ptr(buf));\n\tsshbuf_free(buf);\n\tfree(cp);\n\tTEST_DONE();\n\n\tsshkey_free(k1);\n#endif  \n#endif  \n\n\tTEST_START(\"parse Ed25519 from private\");\n\tbuf = load_file(\"ed25519_1\");\n\tASSERT_INT_EQ(sshkey_parse_private_fileblob(buf, \"\", &k1, NULL), 0);\n\tsshbuf_free(buf);\n\tASSERT_PTR_NE(k1, NULL);\n\tASSERT_INT_EQ(k1->type, KEY_ED25519);\n\t \n\tTEST_DONE();\n\n\tTEST_START(\"parse Ed25519 from private w/ passphrase\");\n\tbuf = load_file(\"ed25519_1_pw\");\n\tASSERT_INT_EQ(sshkey_parse_private_fileblob(buf,\n\t    (const char *)sshbuf_ptr(pw), &k2, NULL), 0);\n\tsshbuf_free(buf);\n\tASSERT_PTR_NE(k2, NULL);\n\tASSERT_INT_EQ(sshkey_equal(k1, k2), 1);\n\tsshkey_free(k2);\n\tTEST_DONE();\n\n\tTEST_START(\"load Ed25519 from public\");\n\tASSERT_INT_EQ(sshkey_load_public(test_data_file(\"ed25519_1.pub\"), &k2,\n\t    NULL), 0);\n\tASSERT_PTR_NE(k2, NULL);\n\tASSERT_INT_EQ(sshkey_equal(k1, k2), 1);\n\tsshkey_free(k2);\n\tTEST_DONE();\n\n\tTEST_START(\"load Ed25519 cert\");\n\tASSERT_INT_EQ(sshkey_load_cert(test_data_file(\"ed25519_1\"), &k2), 0);\n\tASSERT_PTR_NE(k2, NULL);\n\tASSERT_INT_EQ(k2->type, KEY_ED25519_CERT);\n\tASSERT_INT_EQ(sshkey_equal(k1, k2), 0);\n\tASSERT_INT_EQ(sshkey_equal_public(k1, k2), 1);\n\tTEST_DONE();\n\n\tTEST_START(\"Ed25519 key hex fingerprint\");\n\tbuf = load_text_file(\"ed25519_1.fp\");\n\tcp = sshkey_fingerprint(k1, SSH_DIGEST_SHA256, SSH_FP_BASE64);\n\tASSERT_PTR_NE(cp, NULL);\n\tASSERT_STRING_EQ(cp, (const char *)sshbuf_ptr(buf));\n\tsshbuf_free(buf);\n\tfree(cp);\n\tTEST_DONE();\n\n\tTEST_START(\"Ed25519 cert hex fingerprint\");\n\tbuf = load_text_file(\"ed25519_1-cert.fp\");\n\tcp = sshkey_fingerprint(k2, SSH_DIGEST_SHA256, SSH_FP_BASE64);\n\tASSERT_PTR_NE(cp, NULL);\n\tASSERT_STRING_EQ(cp, (const char *)sshbuf_ptr(buf));\n\tsshbuf_free(buf);\n\tfree(cp);\n\tsshkey_free(k2);\n\tTEST_DONE();\n\n\tTEST_START(\"Ed25519 key bubblebabble fingerprint\");\n\tbuf = load_text_file(\"ed25519_1.fp.bb\");\n\tcp = sshkey_fingerprint(k1, SSH_DIGEST_SHA1, SSH_FP_BUBBLEBABBLE);\n\tASSERT_PTR_NE(cp, NULL);\n\tASSERT_STRING_EQ(cp, (const char *)sshbuf_ptr(buf));\n\tsshbuf_free(buf);\n\tfree(cp);\n\tTEST_DONE();\n\n\tsshkey_free(k1);\n\n#ifdef ENABLE_SK\n#if defined(WITH_OPENSSL) && defined(OPENSSL_HAS_ECC)\n\tTEST_START(\"parse ECDSA-SK from private\");\n\tbuf = load_file(\"ecdsa_sk1\");\n\tASSERT_INT_EQ(sshkey_parse_private_fileblob(buf, \"\", &k1, NULL), 0);\n\tsshbuf_free(buf);\n\tASSERT_PTR_NE(k1, NULL);\n\tASSERT_INT_EQ(k1->type, KEY_ECDSA_SK);\n\tTEST_DONE();\n\n\tTEST_START(\"parse ECDSA-SK from private w/ passphrase\");\n\tbuf = load_file(\"ecdsa_sk1_pw\");\n\tASSERT_INT_EQ(sshkey_parse_private_fileblob(buf,\n\t    (const char *)sshbuf_ptr(pw), &k2, NULL), 0);\n\tsshbuf_free(buf);\n\tASSERT_PTR_NE(k2, NULL);\n\tASSERT_INT_EQ(sshkey_equal(k1, k2), 1);\n\tsshkey_free(k2);\n\tTEST_DONE();\n\n\tTEST_START(\"load ECDSA-SK from public\");\n\tASSERT_INT_EQ(sshkey_load_public(test_data_file(\"ecdsa_sk1.pub\"), &k2,\n\t    NULL), 0);\n\tASSERT_PTR_NE(k2, NULL);\n\tASSERT_INT_EQ(sshkey_equal(k1, k2), 1);\n\tsshkey_free(k2);\n\tTEST_DONE();\n\n\tTEST_START(\"load ECDSA-SK cert\");\n\tASSERT_INT_EQ(sshkey_load_cert(test_data_file(\"ecdsa_sk1\"), &k2), 0);\n\tASSERT_PTR_NE(k2, NULL);\n\tASSERT_INT_EQ(k2->type, KEY_ECDSA_SK_CERT);\n\tASSERT_INT_EQ(sshkey_equal(k1, k2), 0);\n\tASSERT_INT_EQ(sshkey_equal_public(k1, k2), 1);\n\tTEST_DONE();\n\n\tTEST_START(\"ECDSA-SK key hex fingerprint\");\n\tbuf = load_text_file(\"ecdsa_sk1.fp\");\n\tcp = sshkey_fingerprint(k1, SSH_DIGEST_SHA256, SSH_FP_BASE64);\n\tASSERT_PTR_NE(cp, NULL);\n\tASSERT_STRING_EQ(cp, (const char *)sshbuf_ptr(buf));\n\tsshbuf_free(buf);\n\tfree(cp);\n\tTEST_DONE();\n\n\tTEST_START(\"ECDSA-SK cert hex fingerprint\");\n\tbuf = load_text_file(\"ecdsa_sk1-cert.fp\");\n\tcp = sshkey_fingerprint(k2, SSH_DIGEST_SHA256, SSH_FP_BASE64);\n\tASSERT_PTR_NE(cp, NULL);\n\tASSERT_STRING_EQ(cp, (const char *)sshbuf_ptr(buf));\n\tsshbuf_free(buf);\n\tfree(cp);\n\tsshkey_free(k2);\n\tTEST_DONE();\n\n\tTEST_START(\"ECDSA-SK key bubblebabble fingerprint\");\n\tbuf = load_text_file(\"ecdsa_sk1.fp.bb\");\n\tcp = sshkey_fingerprint(k1, SSH_DIGEST_SHA1, SSH_FP_BUBBLEBABBLE);\n\tASSERT_PTR_NE(cp, NULL);\n\tASSERT_STRING_EQ(cp, (const char *)sshbuf_ptr(buf));\n\tsshbuf_free(buf);\n\tfree(cp);\n\tTEST_DONE();\n\n\tsshkey_free(k1);\n#endif\n\n\tTEST_START(\"parse Ed25519-SK from private\");\n\tbuf = load_file(\"ed25519_sk1\");\n\tASSERT_INT_EQ(sshkey_parse_private_fileblob(buf, \"\", &k1, NULL), 0);\n\tsshbuf_free(buf);\n\tASSERT_PTR_NE(k1, NULL);\n\tASSERT_INT_EQ(k1->type, KEY_ED25519_SK);\n\t \n\tTEST_DONE();\n\n\tTEST_START(\"parse Ed25519-SK from private w/ passphrase\");\n\tbuf = load_file(\"ed25519_sk1_pw\");\n\tASSERT_INT_EQ(sshkey_parse_private_fileblob(buf,\n\t    (const char *)sshbuf_ptr(pw), &k2, NULL), 0);\n\tsshbuf_free(buf);\n\tASSERT_PTR_NE(k2, NULL);\n\tASSERT_INT_EQ(sshkey_equal(k1, k2), 1);\n\tsshkey_free(k2);\n\tTEST_DONE();\n\n\tTEST_START(\"load Ed25519-SK from public\");\n\tASSERT_INT_EQ(sshkey_load_public(test_data_file(\"ed25519_sk1.pub\"),\n\t    &k2, NULL), 0);\n\tASSERT_PTR_NE(k2, NULL);\n\tASSERT_INT_EQ(sshkey_equal(k1, k2), 1);\n\tsshkey_free(k2);\n\tTEST_DONE();\n\n\tTEST_START(\"load Ed25519-SK cert\");\n\tASSERT_INT_EQ(sshkey_load_cert(test_data_file(\"ed25519_sk1\"), &k2), 0);\n\tASSERT_PTR_NE(k2, NULL);\n\tASSERT_INT_EQ(k2->type, KEY_ED25519_SK_CERT);\n\tASSERT_INT_EQ(sshkey_equal(k1, k2), 0);\n\tASSERT_INT_EQ(sshkey_equal_public(k1, k2), 1);\n\tTEST_DONE();\n\n\tTEST_START(\"Ed25519-SK key hex fingerprint\");\n\tbuf = load_text_file(\"ed25519_sk1.fp\");\n\tcp = sshkey_fingerprint(k1, SSH_DIGEST_SHA256, SSH_FP_BASE64);\n\tASSERT_PTR_NE(cp, NULL);\n\tASSERT_STRING_EQ(cp, (const char *)sshbuf_ptr(buf));\n\tsshbuf_free(buf);\n\tfree(cp);\n\tTEST_DONE();\n\n\tTEST_START(\"Ed25519-SK cert hex fingerprint\");\n\tbuf = load_text_file(\"ed25519_sk1-cert.fp\");\n\tcp = sshkey_fingerprint(k2, SSH_DIGEST_SHA256, SSH_FP_BASE64);\n\tASSERT_PTR_NE(cp, NULL);\n\tASSERT_STRING_EQ(cp, (const char *)sshbuf_ptr(buf));\n\tsshbuf_free(buf);\n\tfree(cp);\n\tsshkey_free(k2);\n\tTEST_DONE();\n\n\tTEST_START(\"Ed25519-SK key bubblebabble fingerprint\");\n\tbuf = load_text_file(\"ed25519_sk1.fp.bb\");\n\tcp = sshkey_fingerprint(k1, SSH_DIGEST_SHA1, SSH_FP_BUBBLEBABBLE);\n\tASSERT_PTR_NE(cp, NULL);\n\tASSERT_STRING_EQ(cp, (const char *)sshbuf_ptr(buf));\n\tsshbuf_free(buf);\n\tfree(cp);\n\tTEST_DONE();\n\n\tsshkey_free(k1);\n#endif  \n\n\tsshbuf_free(pw);\n\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}