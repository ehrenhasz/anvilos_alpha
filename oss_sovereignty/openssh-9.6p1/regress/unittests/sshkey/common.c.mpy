{
  "module_name": "common.c",
  "hash_id": "8e0f2c66dd1832a8e9562f289a0c49d68fb7388ad0a7a38a5a618764ddec5fa9",
  "original_prompt": "Ingested from openssh-9.6p1/regress/unittests/sshkey/common.c",
  "human_readable_source": " \n \n\n#include \"includes.h\"\n\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <stdio.h>\n#ifdef HAVE_STDINT_H\n#include <stdint.h>\n#endif\n#include <stdlib.h>\n#include <string.h>\n#include <unistd.h>\n\n#ifdef WITH_OPENSSL\n#include <openssl/bn.h>\n#include <openssl/rsa.h>\n#include <openssl/dsa.h>\n#include <openssl/objects.h>\n#ifdef OPENSSL_HAS_NISTP256\n# include <openssl/ec.h>\n#endif  \n#endif  \n\n#include \"openbsd-compat/openssl-compat.h\"\n\n#include \"../test_helper/test_helper.h\"\n\n#include \"ssherr.h\"\n#include \"authfile.h\"\n#include \"sshkey.h\"\n#include \"sshbuf.h\"\n\n#include \"common.h\"\n\nstruct sshbuf *\nload_file(const char *name)\n{\n\tstruct sshbuf *ret = NULL;\n\n\tASSERT_INT_EQ(sshbuf_load_file(test_data_file(name), &ret), 0);\n\tASSERT_PTR_NE(ret, NULL);\n\treturn ret;\n}\n\nstruct sshbuf *\nload_text_file(const char *name)\n{\n\tstruct sshbuf *ret = load_file(name);\n\tconst u_char *p;\n\n\t \n\tfor (p = sshbuf_ptr(ret); sshbuf_len(ret) > 0;) {\n\t\tif (p[sshbuf_len(ret) - 1] == '\\r' ||\n\t\t    p[sshbuf_len(ret) - 1] == '\\t' ||\n\t\t    p[sshbuf_len(ret) - 1] == ' ' ||\n\t\t    p[sshbuf_len(ret) - 1] == '\\n')\n\t\t\tASSERT_INT_EQ(sshbuf_consume_end(ret, 1), 0);\n\t\telse\n\t\t\tbreak;\n\t}\n\t \n\tASSERT_INT_EQ(sshbuf_put_u8(ret, 0), 0);\n\treturn ret;\n}\n\n#ifdef WITH_OPENSSL\nBIGNUM *\nload_bignum(const char *name)\n{\n\tBIGNUM *ret = NULL;\n\tstruct sshbuf *buf;\n\n\tbuf = load_text_file(name);\n\tASSERT_INT_NE(BN_hex2bn(&ret, (const char *)sshbuf_ptr(buf)), 0);\n\tsshbuf_free(buf);\n\treturn ret;\n}\n\nconst BIGNUM *\nrsa_n(struct sshkey *k)\n{\n\tconst BIGNUM *n = NULL;\n\n\tASSERT_PTR_NE(k, NULL);\n\tASSERT_PTR_NE(k->rsa, NULL);\n\tRSA_get0_key(k->rsa, &n, NULL, NULL);\n\treturn n;\n}\n\nconst BIGNUM *\nrsa_e(struct sshkey *k)\n{\n\tconst BIGNUM *e = NULL;\n\n\tASSERT_PTR_NE(k, NULL);\n\tASSERT_PTR_NE(k->rsa, NULL);\n\tRSA_get0_key(k->rsa, NULL, &e, NULL);\n\treturn e;\n}\n\nconst BIGNUM *\nrsa_p(struct sshkey *k)\n{\n\tconst BIGNUM *p = NULL;\n\n\tASSERT_PTR_NE(k, NULL);\n\tASSERT_PTR_NE(k->rsa, NULL);\n\tRSA_get0_factors(k->rsa, &p, NULL);\n\treturn p;\n}\n\nconst BIGNUM *\nrsa_q(struct sshkey *k)\n{\n\tconst BIGNUM *q = NULL;\n\n\tASSERT_PTR_NE(k, NULL);\n\tASSERT_PTR_NE(k->rsa, NULL);\n\tRSA_get0_factors(k->rsa, NULL, &q);\n\treturn q;\n}\n\nconst BIGNUM *\ndsa_g(struct sshkey *k)\n{\n\tconst BIGNUM *g = NULL;\n\n\tASSERT_PTR_NE(k, NULL);\n\tASSERT_PTR_NE(k->dsa, NULL);\n\tDSA_get0_pqg(k->dsa, NULL, NULL, &g);\n\treturn g;\n}\n\nconst BIGNUM *\ndsa_pub_key(struct sshkey *k)\n{\n\tconst BIGNUM *pub_key = NULL;\n\n\tASSERT_PTR_NE(k, NULL);\n\tASSERT_PTR_NE(k->dsa, NULL);\n\tDSA_get0_key(k->dsa, &pub_key, NULL);\n\treturn pub_key;\n}\n\nconst BIGNUM *\ndsa_priv_key(struct sshkey *k)\n{\n\tconst BIGNUM *priv_key = NULL;\n\n\tASSERT_PTR_NE(k, NULL);\n\tASSERT_PTR_NE(k->dsa, NULL);\n\tDSA_get0_key(k->dsa, NULL, &priv_key);\n\treturn priv_key;\n}\n#endif  \n\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}