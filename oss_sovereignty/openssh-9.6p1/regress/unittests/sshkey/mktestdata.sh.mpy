{
  "module_name": "mktestdata.sh",
  "hash_id": "8f46e0e7ee7d19fa29b484cb45800017e608a997654a9a1efffb9c72e6e2a130",
  "original_prompt": "Ingested from openssh-9.6p1/regress/unittests/sshkey/mktestdata.sh",
  "human_readable_source": "#!/bin/sh\n# $OpenBSD: mktestdata.sh,v 1.11 2020/06/19 03:48:49 djm Exp $\n\nPW=mekmitasdigoat\n\nrsa_params() {\n\t_in=\"$1\"\n\t_outbase=\"$2\"\n\tset -e\n\topenssl rsa -noout -text -in $_in | \\\n\t    awk '/^modulus:$/,/^publicExponent:/' | \\\n\t    grep -v '^[a-zA-Z]' | tr -d ' \\n:' > ${_outbase}.n\n\topenssl rsa -noout -text -in $_in | \\\n\t    awk '/^prime1:$/,/^prime2:/' | \\\n\t    grep -v '^[a-zA-Z]' | tr -d ' \\n:' > ${_outbase}.p\n\topenssl rsa -noout -text -in $_in | \\\n\t    awk '/^prime2:$/,/^exponent1:/' | \\\n\t    grep -v '^[a-zA-Z]' | tr -d ' \\n:' > ${_outbase}.q\n\tfor x in n p q ; do\n\t\techo \"\" >> ${_outbase}.$x\n\t\techo ============ ${_outbase}.$x\n\t\tcat ${_outbase}.$x\n\t\techo ============\n\tdone\n}\n\ndsa_params() {\n\t_in=\"$1\"\n\t_outbase=\"$2\"\n\tset -e\n\topenssl dsa -noout -text -in $_in | \\\n\t    awk '/^priv:$/,/^pub:/' | \\\n\t    grep -v '^[a-zA-Z]' | tr -d ' \\n:' > ${_outbase}.priv\n\topenssl dsa -noout -text -in $_in | \\\n\t    awk '/^pub:/,/^P:/' | #\\\n\t    grep -v '^[a-zA-Z]' | tr -d ' \\n:' > ${_outbase}.pub\n\topenssl dsa -noout -text -in $_in | \\\n\t    awk '/^G:/,0' | \\\n\t    grep -v '^[a-zA-Z]' | tr -d ' \\n:' > ${_outbase}.g\n\tfor x in priv pub g ; do\n\t\techo \"\" >> ${_outbase}.$x\n\t\techo ============ ${_outbase}.$x\n\t\tcat ${_outbase}.$x\n\t\techo ============\n\tdone\n}\n\necdsa_params() {\n\t_in=\"$1\"\n\t_outbase=\"$2\"\n\tset -e\n\topenssl ec -noout -text -in $_in | \\\n\t    awk '/^priv:$/,/^pub:/' | \\\n\t    grep -v '^[a-zA-Z]' | tr -d ' \\n:' > ${_outbase}.priv\n\topenssl ec -noout -text -in $_in | \\\n\t    awk '/^pub:/,/^ASN1 OID:/' | #\\\n\t    grep -v '^[a-zA-Z]' | tr -d ' \\n:' > ${_outbase}.pub\n\topenssl ec -noout -text -in $_in | \\\n\t    grep \"ASN1 OID:\" | \\\n\t    sed 's/.*: //;s/ *$//' | tr -d '\\n' > ${_outbase}.curve\n\tfor x in priv pub curve ; do\n\t\techo \"\" >> ${_outbase}.$x\n\t\techo ============ ${_outbase}.$x\n\t\tcat ${_outbase}.$x\n\t\techo ============\n\tdone\n}\n\nset -ex\n\ncd testdata\n\nif [ -f ../../../misc/sk-dummy/sk-dummy.so ] ; then\n\tSK_DUMMY=../../../misc/sk-dummy/sk-dummy.so\nelif [ -f ../../../misc/sk-dummy/obj/sk-dummy.so ] ; then\n\tSK_DUMMY=../../../misc/sk-dummy/obj/sk-dummy.so\nelse\n\techo \"Can't find sk-dummy.so\" 1>&2\n\texit 1\nfi\n\nrm -f rsa_1 dsa_1 ecdsa_1 ed25519_1\nrm -f rsa_2 dsa_2 ecdsa_2 ed25519_2\nrm -f rsa_n dsa_n ecdsa_n # new-format keys\nrm -f rsa_1_pw dsa_1_pw ecdsa_1_pw ed25519_1_pw\nrm -f rsa_n_pw dsa_n_pw ecdsa_n_pw\nrm -f pw *.pub *.bn.* *.param.* *.fp *.fp.bb\n\nssh-keygen -t rsa -b 1024 -C \"RSA test key #1\" -N \"\" -f rsa_1 -m PEM\nssh-keygen -t dsa -b 1024 -C \"DSA test key #1\" -N \"\" -f dsa_1 -m PEM\nssh-keygen -t ecdsa -b 256 -C \"ECDSA test key #1\" -N \"\" -f ecdsa_1 -m PEM\nssh-keygen -t ed25519 -C \"ED25519 test key #1\" -N \"\" -f ed25519_1\nssh-keygen -w \"$SK_DUMMY\" -t ecdsa-sk -C \"ECDSA-SK test key #1\" \\\n    -N \"\" -f ecdsa_sk1\nssh-keygen -w \"$SK_DUMMY\" -t ed25519-sk -C \"ED25519-SK test key #1\" \\\n    -N \"\" -f ed25519_sk1\n\n\nssh-keygen -t rsa -b 2048 -C \"RSA test key #2\" -N \"\" -f rsa_2 -m PEM\nssh-keygen -t dsa -b 1024 -C \"DSA test key #2\" -N \"\" -f dsa_2 -m PEM\nssh-keygen -t ecdsa -b 521 -C \"ECDSA test key #2\" -N \"\" -f ecdsa_2 -m PEM\nssh-keygen -t ed25519 -C \"ED25519 test key #2\" -N \"\" -f ed25519_2\nssh-keygen -w \"$SK_DUMMY\" -t ecdsa-sk -C \"ECDSA-SK test key #2\" \\\n    -N \"\" -f ecdsa_sk2\nssh-keygen -w \"$SK_DUMMY\" -t ed25519-sk -C \"ED25519-SK test key #2\" \\\n    -N \"\" -f ed25519_sk2\n\ncp rsa_1 rsa_n\ncp dsa_1 dsa_n\ncp ecdsa_1 ecdsa_n\n\nssh-keygen -pf rsa_n -N \"\"\nssh-keygen -pf dsa_n -N \"\"\nssh-keygen -pf ecdsa_n -N \"\"\n\ncp rsa_1 rsa_1_pw\ncp dsa_1 dsa_1_pw\ncp ecdsa_1 ecdsa_1_pw\ncp ed25519_1 ed25519_1_pw\ncp ecdsa_sk1 ecdsa_sk1_pw\ncp ed25519_sk1 ed25519_sk1_pw\ncp rsa_1 rsa_n_pw\ncp dsa_1 dsa_n_pw\ncp ecdsa_1 ecdsa_n_pw\n\nssh-keygen -pf rsa_1_pw -m PEM -N \"$PW\"\nssh-keygen -pf dsa_1_pw -m PEM -N \"$PW\"\nssh-keygen -pf ecdsa_1_pw -m PEM -N \"$PW\"\nssh-keygen -pf ed25519_1_pw -N \"$PW\"\nssh-keygen -pf ecdsa_sk1_pw -m PEM -N \"$PW\"\nssh-keygen -pf ed25519_sk1_pw -N \"$PW\"\nssh-keygen -pf rsa_n_pw -N \"$PW\"\nssh-keygen -pf dsa_n_pw -N \"$PW\"\nssh-keygen -pf ecdsa_n_pw -N \"$PW\"\n\nrsa_params rsa_1 rsa_1.param\nrsa_params rsa_2 rsa_2.param\ndsa_params dsa_1 dsa_1.param\ndsa_params dsa_1 dsa_1.param\necdsa_params ecdsa_1 ecdsa_1.param\necdsa_params ecdsa_2 ecdsa_2.param\n# XXX ed25519, *sk params\n\nssh-keygen -s rsa_2 -I hugo -n user1,user2 \\\n    -Oforce-command=/bin/ls -Ono-port-forwarding -Osource-address=10.0.0.0/8 \\\n    -V 19990101:20110101 -z 1 rsa_1.pub\nssh-keygen -s rsa_2 -I hugo -n user1,user2 \\\n    -Oforce-command=/bin/ls -Ono-port-forwarding -Osource-address=10.0.0.0/8 \\\n    -V 19990101:20110101 -z 2 dsa_1.pub\nssh-keygen -s rsa_2 -I hugo -n user1,user2 \\\n    -Oforce-command=/bin/ls -Ono-port-forwarding -Osource-address=10.0.0.0/8 \\\n    -V 19990101:20110101 -z 3 ecdsa_1.pub\nssh-keygen -s rsa_2 -I hugo -n user1,user2 \\\n    -Oforce-command=/bin/ls -Ono-port-forwarding -Osource-address=10.0.0.0/8 \\\n    -V 19990101:20110101 -z 4 ed25519_1.pub\nssh-keygen -s rsa_2 -I hugo -n user1,user2 \\\n    -Oforce-command=/bin/ls -Ono-port-forwarding -Osource-address=10.0.0.0/8 \\\n    -V 19990101:20110101 -z 4 ecdsa_sk1.pub\nssh-keygen -s rsa_2 -I hugo -n user1,user2 \\\n    -Oforce-command=/bin/ls -Ono-port-forwarding -Osource-address=10.0.0.0/8 \\\n    -V 19990101:20110101 -z 4 ed25519_sk1.pub\n\n\n# Make a few RSA variant signature too.\ncp rsa_1 rsa_1_sha1\ncp rsa_1 rsa_1_sha512\ncp rsa_1.pub rsa_1_sha1.pub\ncp rsa_1.pub rsa_1_sha512.pub\nssh-keygen -s rsa_2 -I hugo -n user1,user2 -t ssh-rsa \\\n    -Oforce-command=/bin/ls -Ono-port-forwarding -Osource-address=10.0.0.0/8 \\\n    -V 19990101:20110101 -z 1 rsa_1_sha1.pub\nssh-keygen -s rsa_2 -I hugo -n user1,user2 -t rsa-sha2-512 \\\n    -Oforce-command=/bin/ls -Ono-port-forwarding -Osource-address=10.0.0.0/8 \\\n    -V 19990101:20110101 -z 1 rsa_1_sha512.pub\n\nssh-keygen -s ed25519_1 -I julius -n host1,host2 -h \\\n    -V 19990101:20110101 -z 5 rsa_1.pub\nssh-keygen -s ed25519_1 -I julius -n host1,host2 -h \\\n    -V 19990101:20110101 -z 6 dsa_1.pub\nssh-keygen -s ecdsa_1 -I julius -n host1,host2 -h \\\n    -V 19990101:20110101 -z 7 ecdsa_1.pub\nssh-keygen -s ed25519_1 -I julius -n host1,host2 -h \\\n    -V 19990101:20110101 -z 8 ed25519_1.pub\nssh-keygen -s ecdsa_1 -I julius -n host1,host2 -h \\\n    -V 19990101:20110101 -z 7 ecdsa_sk1.pub\nssh-keygen -s ed25519_1 -I julius -n host1,host2 -h \\\n    -V 19990101:20110101 -z 8 ed25519_sk1.pub\n\nssh-keygen -lf rsa_1 | awk '{print $2}' > rsa_1.fp\nssh-keygen -lf dsa_1 | awk '{print $2}' > dsa_1.fp\nssh-keygen -lf ecdsa_1 | awk '{print $2}' > ecdsa_1.fp\nssh-keygen -lf ed25519_1 | awk '{print $2}' > ed25519_1.fp\nssh-keygen -lf ecdsa_sk1 | awk '{print $2}' > ecdsa_sk1.fp\nssh-keygen -lf ed25519_sk1 | awk '{print $2}' > ed25519_sk1.fp\nssh-keygen -lf rsa_2 | awk '{print $2}' > rsa_2.fp\nssh-keygen -lf dsa_2 | awk '{print $2}' > dsa_2.fp\nssh-keygen -lf ecdsa_2 | awk '{print $2}' > ecdsa_2.fp\nssh-keygen -lf ed25519_2 | awk '{print $2}' > ed25519_2.fp\nssh-keygen -lf ecdsa_sk2 | awk '{print $2}' > ecdsa_sk2.fp\nssh-keygen -lf ed25519_sk2 | awk '{print $2}' > ed25519_sk2.fp\n\nssh-keygen -lf rsa_1-cert.pub  | awk '{print $2}' > rsa_1-cert.fp\nssh-keygen -lf dsa_1-cert.pub  | awk '{print $2}' > dsa_1-cert.fp\nssh-keygen -lf ecdsa_1-cert.pub  | awk '{print $2}' > ecdsa_1-cert.fp\nssh-keygen -lf ed25519_1-cert.pub  | awk '{print $2}' > ed25519_1-cert.fp\nssh-keygen -lf ecdsa_sk1-cert.pub  | awk '{print $2}' > ecdsa_sk1-cert.fp\nssh-keygen -lf ed25519_sk1-cert.pub  | awk '{print $2}' > ed25519_sk1-cert.fp\n\nssh-keygen -Bf rsa_1 | awk '{print $2}' > rsa_1.fp.bb\nssh-keygen -Bf dsa_1 | awk '{print $2}' > dsa_1.fp.bb\nssh-keygen -Bf ecdsa_1 | awk '{print $2}' > ecdsa_1.fp.bb\nssh-keygen -Bf ed25519_1 | awk '{print $2}' > ed25519_1.fp.bb\nssh-keygen -Bf ecdsa_sk1 | awk '{print $2}' > ecdsa_sk1.fp.bb\nssh-keygen -Bf ed25519_sk1 | awk '{print $2}' > ed25519_sk1.fp.bb\nssh-keygen -Bf rsa_2 | awk '{print $2}' > rsa_2.fp.bb\nssh-keygen -Bf dsa_2 | awk '{print $2}' > dsa_2.fp.bb\nssh-keygen -Bf ecdsa_2 | awk '{print $2}' > ecdsa_2.fp.bb\nssh-keygen -Bf ed25519_2 | awk '{print $2}' > ed25519_2.fp.bb\nssh-keygen -Bf ecdsa_sk2 | awk '{print $2}' > ecdsa_sk2.fp.bb\nssh-keygen -Bf ed25519_sk2 | awk '{print $2}' > ed25519_sk2.fp.bb\n\necho \"$PW\" > pw\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}