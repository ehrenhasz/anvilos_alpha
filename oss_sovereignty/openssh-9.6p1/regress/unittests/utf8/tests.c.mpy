{
  "module_name": "tests.c",
  "hash_id": "668dfa9dcc2201f1735b7d29358e40cfba65207f92ccaa95a6e4810b26f51bab",
  "original_prompt": "Ingested from openssh-9.6p1/regress/unittests/utf8/tests.c",
  "human_readable_source": " \n \n\n#include \"includes.h\"\n\n#include <locale.h>\n#include <stdarg.h>\n#include <string.h>\n#include <stdio.h>\n\n#include \"../test_helper/test_helper.h\"\n\n#include \"utf8.h\"\n\nstatic void\nbadarg(void)\n{\n\tchar\t buf[16];\n\tint\t len, width;\n\n\twidth = 1;\n\tTEST_START(\"utf8_badarg\");\n\tlen = snmprintf(buf, sizeof(buf), &width, \"\\377\");\n\tASSERT_INT_EQ(len, -1);\n\tASSERT_STRING_EQ(buf, \"\");\n\tASSERT_INT_EQ(width, 0);\n\tTEST_DONE();\n}\n\nstatic void\none(int utf8, const char *name, const char *mbs, int width,\n    int wantwidth, int wantlen, const char *wants)\n{\n\tchar\t buf[16];\n\tint\t*wp;\n\tint\t len;\n\n\tif (wantlen == -2)\n\t\twantlen = strlen(wants);\n\t(void)strlcpy(buf, utf8 ? \"utf8_\" : \"c_\", sizeof(buf));\n\t(void)strlcat(buf, name, sizeof(buf));\n\tTEST_START(buf);\n\twp = wantwidth == -2 ? NULL : &width;\n\tlen = snmprintf(buf, sizeof(buf), wp, \"%s\", mbs);\n\tASSERT_INT_EQ(len, wantlen);\n\tASSERT_STRING_EQ(buf, wants);\n\tASSERT_INT_EQ(width, wantwidth);\n\tTEST_DONE();\n}\n\nvoid\ntests(void)\n{\n\tchar\t*loc;\n\n\tTEST_START(\"utf8_setlocale\");\n\tloc = setlocale(LC_CTYPE, \"en_US.UTF-8\");\n\tASSERT_PTR_NE(loc, NULL);\n\tTEST_DONE();\n\n\tbadarg();\n\tone(1, \"empty\", \"\", 2, 0, 0, \"\");\n\tone(1, \"ascii\", \"x\", -2, -2, -2, \"x\");\n\tone(1, \"newline\", \"a\\nb\", -2, -2, -2, \"a\\nb\");\n\tone(1, \"cr\", \"a\\rb\", -2, -2, -2, \"a\\rb\");\n\tone(1, \"tab\", \"a\\tb\", -2, -2, -2, \"a\\tb\");\n\tone(1, \"esc\", \"\\033x\", -2, -2, -2, \"\\\\033x\");\n\tone(1, \"inv_badbyte\", \"\\377x\", -2, -2, -2, \"\\\\377x\");\n\tone(1, \"inv_nocont\", \"\\341x\", -2, -2, -2, \"\\\\341x\");\n\tone(1, \"inv_nolead\", \"a\\200b\", -2, -2, -2, \"a\\\\200b\");\n\tone(1, \"sz_ascii\", \"1234567890123456\", -2, -2, 16, \"123456789012345\");\n\tone(1, \"sz_esc\", \"123456789012\\033\", -2, -2, 16, \"123456789012\");\n\tone(1, \"width_ascii\", \"123\", 2, 2, -1, \"12\");\n\tone(1, \"width_double\", \"a\\343\\201\\201\", 2, 1, -1, \"a\");\n\tone(1, \"double_fit\", \"a\\343\\201\\201\", 3, 3, 4, \"a\\343\\201\\201\");\n\tone(1, \"double_spc\", \"a\\343\\201\\201\", 4, 3, 4, \"a\\343\\201\\201\");\n\n\tTEST_START(\"C_setlocale\");\n\tloc = setlocale(LC_CTYPE, \"C\");\n\tASSERT_PTR_NE(loc, NULL);\n\tTEST_DONE();\n\n\tbadarg();\n\tone(0, \"empty\", \"\", 2, 0, 0, \"\");\n\tone(0, \"ascii\", \"x\", -2, -2, -2, \"x\");\n\tone(0, \"newline\", \"a\\nb\", -2, -2, -2, \"a\\nb\");\n\tone(0, \"cr\", \"a\\rb\", -2, -2, -2, \"a\\rb\");\n\tone(0, \"tab\", \"a\\tb\", -2, -2, -2, \"a\\tb\");\n\tone(0, \"esc\", \"\\033x\", -2, -2, -2, \"\\\\033x\");\n\tone(0, \"inv_badbyte\", \"\\377x\", -2, -2, -2, \"\\\\377x\");\n\tone(0, \"inv_nocont\", \"\\341x\", -2, -2, -2, \"\\\\341x\");\n\tone(0, \"inv_nolead\", \"a\\200b\", -2, -2, -2, \"a\\\\200b\");\n\tone(0, \"sz_ascii\", \"1234567890123456\", -2, -2, 16, \"123456789012345\");\n\tone(0, \"sz_esc\", \"123456789012\\033\", -2, -2, 16, \"123456789012\");\n\tone(0, \"width_ascii\", \"123\", 2, 2, -1, \"12\");\n\tone(0, \"width_double\", \"a\\343\\201\\201\", 2, 1, -1, \"a\");\n\tone(0, \"double_fit\", \"a\\343\\201\\201\", 7, 5, -1, \"a\\\\343\");\n\tone(0, \"double_spc\", \"a\\343\\201\\201\", 13, 13, 13, \"a\\\\343\\\\201\\\\201\");\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}