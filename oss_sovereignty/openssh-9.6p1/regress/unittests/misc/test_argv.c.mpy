{
  "module_name": "test_argv.c",
  "hash_id": "028b4d39c721124c3af2d018ee498c8db44232b80197a9b8466ee66c32917214",
  "original_prompt": "Ingested from openssh-9.6p1/regress/unittests/misc/test_argv.c",
  "human_readable_source": " \n \n\n#include \"includes.h\"\n\n#include <sys/types.h>\n#include <stdio.h>\n#ifdef HAVE_STDINT_H\n#include <stdint.h>\n#endif\n#include <stdlib.h>\n#include <string.h>\n\n#include \"../test_helper/test_helper.h\"\n\n#include \"log.h\"\n#include \"misc.h\"\n\nvoid test_argv(void);\n\nvoid\ntest_argv(void)\n{\n\tchar **av = NULL;\n\tint ac = 0;\n\n#define RESET_ARGV() \\\n\tdo { \\\n\t\targv_free(av, ac); \\\n\t\tav = NULL; \\\n\t\tac = -1; \\\n\t} while (0)\n\n\tTEST_START(\"empty args\");\n\tASSERT_INT_EQ(argv_split(\"\", &ac, &av, 0), 0);\n\tASSERT_INT_EQ(ac, 0);\n\tASSERT_PTR_NE(av, NULL);\n\tASSERT_PTR_EQ(av[0], NULL);\n\tRESET_ARGV();\n\tASSERT_INT_EQ(argv_split(\"    \", &ac, &av, 0), 0);\n\tASSERT_INT_EQ(ac, 0);\n\tASSERT_PTR_NE(av, NULL);\n\tASSERT_PTR_EQ(av[0], NULL);\n\tRESET_ARGV();\n\tTEST_DONE();\n\n\tTEST_START(\"trivial args\");\n\tASSERT_INT_EQ(argv_split(\"leamas\", &ac, &av, 0), 0);\n\tASSERT_INT_EQ(ac, 1);\n\tASSERT_PTR_NE(av, NULL);\n\tASSERT_STRING_EQ(av[0], \"leamas\");\n\tASSERT_PTR_EQ(av[1], NULL);\n\tRESET_ARGV();\n\tASSERT_INT_EQ(argv_split(\"smiley leamas\", &ac, &av, 0), 0);\n\tASSERT_INT_EQ(ac, 2);\n\tASSERT_PTR_NE(av, NULL);\n\tASSERT_STRING_EQ(av[0], \"smiley\");\n\tASSERT_STRING_EQ(av[1], \"leamas\");\n\tASSERT_PTR_EQ(av[2], NULL);\n\tRESET_ARGV();\n\tTEST_DONE();\n\n\tTEST_START(\"quoted\");\n\tASSERT_INT_EQ(argv_split(\"\\\"smiley\\\"\", &ac, &av, 0), 0);\n\tASSERT_INT_EQ(ac, 1);\n\tASSERT_PTR_NE(av, NULL);\n\tASSERT_STRING_EQ(av[0], \"smiley\");\n\tASSERT_PTR_EQ(av[1], NULL);\n\tRESET_ARGV();\n\tASSERT_INT_EQ(argv_split(\"leamas \\\" smiley \\\"\", &ac, &av, 0), 0);\n\tASSERT_INT_EQ(ac, 2);\n\tASSERT_PTR_NE(av, NULL);\n\tASSERT_STRING_EQ(av[0], \"leamas\");\n\tASSERT_STRING_EQ(av[1], \" smiley \");\n\tASSERT_PTR_EQ(av[2], NULL);\n\tRESET_ARGV();\n\tASSERT_INT_EQ(argv_split(\"\\\"smiley leamas\\\"\", &ac, &av, 0), 0);\n\tASSERT_INT_EQ(ac, 1);\n\tASSERT_PTR_NE(av, NULL);\n\tASSERT_STRING_EQ(av[0], \"smiley leamas\");\n\tASSERT_PTR_EQ(av[1], NULL);\n\tRESET_ARGV();\n\tASSERT_INT_EQ(argv_split(\"smiley\\\" leamas\\\" liz\", &ac, &av, 0), 0);\n\tASSERT_INT_EQ(ac, 2);\n\tASSERT_PTR_NE(av, NULL);\n\tASSERT_STRING_EQ(av[0], \"smiley leamas\");\n\tASSERT_STRING_EQ(av[1], \"liz\");\n\tASSERT_PTR_EQ(av[2], NULL);\n\tRESET_ARGV();\n\tTEST_DONE();\n\n\tTEST_START(\"escaped\");\n\tASSERT_INT_EQ(argv_split(\"\\\\\\\"smiley\\\\'\", &ac, &av, 0), 0);\n\tASSERT_INT_EQ(ac, 1);\n\tASSERT_PTR_NE(av, NULL);\n\tASSERT_STRING_EQ(av[0], \"\\\"smiley'\");\n\tASSERT_PTR_EQ(av[1], NULL);\n\tRESET_ARGV();\n\tASSERT_INT_EQ(argv_split(\"'\\\\'smiley\\\\\\\"'\", &ac, &av, 0), 0);\n\tASSERT_INT_EQ(ac, 1);\n\tASSERT_PTR_NE(av, NULL);\n\tASSERT_STRING_EQ(av[0], \"'smiley\\\"\");\n\tASSERT_PTR_EQ(av[1], NULL);\n\tRESET_ARGV();\n\tASSERT_INT_EQ(argv_split(\"smiley\\\\'s leamas\\\\'\", &ac, &av, 0), 0);\n\tASSERT_INT_EQ(ac, 2);\n\tASSERT_PTR_NE(av, NULL);\n\tASSERT_STRING_EQ(av[0], \"smiley's\");\n\tASSERT_STRING_EQ(av[1], \"leamas'\");\n\tASSERT_PTR_EQ(av[2], NULL);\n\tRESET_ARGV();\n\tASSERT_INT_EQ(argv_split(\"leamas\\\\\\\\smiley\", &ac, &av, 0), 0);\n\tASSERT_INT_EQ(ac, 1);\n\tASSERT_PTR_NE(av, NULL);\n\tASSERT_STRING_EQ(av[0], \"leamas\\\\smiley\");\n\tASSERT_PTR_EQ(av[1], NULL);\n\tRESET_ARGV();\n\tASSERT_INT_EQ(argv_split(\"leamas\\\\\\\\ \\\\\\\\smiley\", &ac, &av, 0), 0);\n\tASSERT_INT_EQ(ac, 2);\n\tASSERT_PTR_NE(av, NULL);\n\tASSERT_STRING_EQ(av[0], \"leamas\\\\\");\n\tASSERT_STRING_EQ(av[1], \"\\\\smiley\");\n\tASSERT_PTR_EQ(av[2], NULL);\n\tRESET_ARGV();\n\tASSERT_INT_EQ(argv_split(\"smiley\\\\ leamas\", &ac, &av, 0), 0);\n\tASSERT_INT_EQ(ac, 1);\n\tASSERT_PTR_NE(av, NULL);\n\tASSERT_STRING_EQ(av[0], \"smiley leamas\");\n\tASSERT_PTR_EQ(av[1], NULL);\n\tRESET_ARGV();\n\tTEST_DONE();\n\n\tTEST_START(\"quoted escaped\");\n\tASSERT_INT_EQ(argv_split(\"'smiley\\\\ leamas'\", &ac, &av, 0), 0);\n\tASSERT_INT_EQ(ac, 1);\n\tASSERT_PTR_NE(av, NULL);\n\tASSERT_STRING_EQ(av[0], \"smiley\\\\ leamas\");\n\tASSERT_PTR_EQ(av[1], NULL);\n\tRESET_ARGV();\n\tASSERT_INT_EQ(argv_split(\"\\\"smiley\\\\ leamas\\\"\", &ac, &av, 0), 0);\n\tASSERT_INT_EQ(ac, 1);\n\tASSERT_PTR_NE(av, NULL);\n\tASSERT_STRING_EQ(av[0], \"smiley\\\\ leamas\");\n\tASSERT_PTR_EQ(av[1], NULL);\n\tRESET_ARGV();\n\tTEST_DONE();\n\n\tTEST_START(\"comments\");\n\tASSERT_INT_EQ(argv_split(\"# gold\", &ac, &av, 0), 0);\n\tASSERT_INT_EQ(ac, 2);\n\tASSERT_PTR_NE(av, NULL);\n\tASSERT_STRING_EQ(av[0], \"#\");\n\tASSERT_STRING_EQ(av[1], \"gold\");\n\tASSERT_PTR_EQ(av[2], NULL);\n\tRESET_ARGV();\n\tASSERT_INT_EQ(argv_split(\"# gold\", &ac, &av, 1), 0);\n\tASSERT_INT_EQ(ac, 0);\n\tASSERT_PTR_NE(av, NULL);\n\tASSERT_PTR_EQ(av[0], NULL);\n\tRESET_ARGV();\n\tASSERT_INT_EQ(argv_split(\"leamas#gold\", &ac, &av, 1), 0);\n\tASSERT_INT_EQ(ac, 1);\n\tASSERT_PTR_NE(av, NULL);\n\tASSERT_STRING_EQ(av[0], \"leamas#gold\");\n\tASSERT_PTR_EQ(av[1], NULL);\n\tRESET_ARGV();\n\tASSERT_INT_EQ(argv_split(\"\\\"leamas # gold\\\"\", &ac, &av, 1), 0);\n\tASSERT_INT_EQ(ac, 1);\n\tASSERT_PTR_NE(av, NULL);\n\tASSERT_STRING_EQ(av[0], \"leamas # gold\");\n\tASSERT_PTR_EQ(av[1], NULL);\n\tRESET_ARGV();\n\tASSERT_INT_EQ(argv_split(\"\\\"leamas\\\"#gold\", &ac, &av, 1), 0);\n\tASSERT_INT_EQ(ac, 1);\n\tASSERT_PTR_NE(av, NULL);\n\tASSERT_STRING_EQ(av[0], \"leamas#gold\");\n\tASSERT_PTR_EQ(av[1], NULL);\n\tRESET_ARGV();\n\tTEST_DONE();\n\n\t \n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}