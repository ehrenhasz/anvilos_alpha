{
  "module_name": "test_convtime.c",
  "hash_id": "51636e2003708872887761fcf835453269cb93fccb89a16e187172d5e47edeb7",
  "original_prompt": "Ingested from openssh-9.6p1/regress/unittests/misc/test_convtime.c",
  "human_readable_source": " \n \n\n#include \"includes.h\"\n\n#include <sys/types.h>\n#include <limits.h>\n#include <stdio.h>\n#ifdef HAVE_STDINT_H\n#include <stdint.h>\n#endif\n#include <stdlib.h>\n#include <string.h>\n\n#include \"../test_helper/test_helper.h\"\n\n#include \"log.h\"\n#include \"misc.h\"\n#include \"ssherr.h\"\n\nvoid test_convtime(void);\n\nvoid\ntest_convtime(void)\n{\n\tchar buf[1024];\n\tuint64_t t;\n\n\tTEST_START(\"misc_convtime\");\n\tASSERT_INT_EQ(convtime(\"0\"), 0);\n\tASSERT_INT_EQ(convtime(\"1\"), 1);\n\tASSERT_INT_EQ(convtime(\"2s\"), 2);\n\tASSERT_INT_EQ(convtime(\"3m\"), 180);\n\tASSERT_INT_EQ(convtime(\"1m30\"), 90);\n\tASSERT_INT_EQ(convtime(\"1m30s\"), 90);\n\tASSERT_INT_EQ(convtime(\"1h1s\"), 3601);\n\tASSERT_INT_EQ(convtime(\"1h30m\"), 90 * 60);\n\tASSERT_INT_EQ(convtime(\"1d\"), 24 * 60 * 60);\n\tASSERT_INT_EQ(convtime(\"1w\"), 7 * 24 * 60 * 60);\n\tASSERT_INT_EQ(convtime(\"1w2d3h4m5\"), 788645);\n\tASSERT_INT_EQ(convtime(\"1w2d3h4m5s\"), 788645);\n\t \n\tASSERT_INT_EQ(convtime(\"-1\"),  -1);\n\tASSERT_INT_EQ(convtime(\"\"),  -1);\n\tASSERT_INT_EQ(convtime(\"trout\"),  -1);\n\tASSERT_INT_EQ(convtime(\"-77\"),  -1);\n\t \n\tsnprintf(buf, sizeof buf, \"%llu\", (long long unsigned)INT_MAX);\n\tASSERT_INT_EQ(convtime(buf), INT_MAX);\n\tsnprintf(buf, sizeof buf, \"%llu\", (long long unsigned)INT_MAX + 1);\n\tASSERT_INT_EQ(convtime(buf), -1);\n\tASSERT_INT_EQ(convtime(\"3550w5d3h14m7s\"), 2147483647);\n#if INT_MAX == 2147483647\n\tASSERT_INT_EQ(convtime(\"3550w5d3h14m8s\"), -1);\n#endif\n\tTEST_DONE();\n\n\t \n\t \n\tTEST_START(\"misc_parse_absolute_time\");\n\tASSERT_INT_EQ(parse_absolute_time(\"20000101\", &t), 0);\n\tASSERT_INT_EQ(parse_absolute_time(\"200001011223\", &t), 0);\n\tASSERT_INT_EQ(parse_absolute_time(\"20000101122345\", &t), 0);\n\n\t \n\tASSERT_INT_EQ(parse_absolute_time(\"20000101Z\", &t), 0);\n\tASSERT_U64_EQ(t, 946684800);\n\tASSERT_INT_EQ(parse_absolute_time(\"200001011223Z\", &t), 0);\n\tASSERT_U64_EQ(t, 946729380);\n\tASSERT_INT_EQ(parse_absolute_time(\"20000101122345Z\", &t), 0);\n\tASSERT_U64_EQ(t, 946729425);\n\tASSERT_INT_EQ(parse_absolute_time(\"20000101UTC\", &t), 0);\n\tASSERT_U64_EQ(t, 946684800);\n\tASSERT_INT_EQ(parse_absolute_time(\"200001011223UTC\", &t), 0);\n\tASSERT_U64_EQ(t, 946729380);\n\tASSERT_INT_EQ(parse_absolute_time(\"20000101122345UTC\", &t), 0);\n\tASSERT_U64_EQ(t, 946729425);\n\n\t \n\tASSERT_INT_EQ(parse_absolute_time(\"20001301\", &t),\n\t    SSH_ERR_INVALID_FORMAT);\n\tASSERT_INT_EQ(parse_absolute_time(\"20000001\", &t),\n\t    SSH_ERR_INVALID_FORMAT);\n\t \n\tASSERT_INT_EQ(parse_absolute_time(\"2\", &t),\n\t    SSH_ERR_INVALID_FORMAT);\n\tASSERT_INT_EQ(parse_absolute_time(\"2000\", &t),\n\t    SSH_ERR_INVALID_FORMAT);\n\tASSERT_INT_EQ(parse_absolute_time(\"20000\", &t),\n\t    SSH_ERR_INVALID_FORMAT);\n\tASSERT_INT_EQ(parse_absolute_time(\"200001\", &t),\n\t    SSH_ERR_INVALID_FORMAT);\n\tASSERT_INT_EQ(parse_absolute_time(\"2000010\", &t),\n\t    SSH_ERR_INVALID_FORMAT);\n\tASSERT_INT_EQ(parse_absolute_time(\"200001010\", &t),\n\t    SSH_ERR_INVALID_FORMAT);\n\t \n\tASSERT_INT_EQ(parse_absolute_time(\"20000199\", &t),\n\t    SSH_ERR_INVALID_FORMAT);\n\tASSERT_INT_EQ(parse_absolute_time(\"200001019900\", &t),\n\t    SSH_ERR_INVALID_FORMAT);\n\tASSERT_INT_EQ(parse_absolute_time(\"200001010099\", &t),\n\t    SSH_ERR_INVALID_FORMAT);\n\tASSERT_INT_EQ(parse_absolute_time(\"20000101000099\", &t),\n\t    SSH_ERR_INVALID_FORMAT);\n\t \n\tASSERT_INT_EQ(parse_absolute_time(\"20000101ZZ\", &t),\n\t    SSH_ERR_INVALID_FORMAT);\n\tASSERT_INT_EQ(parse_absolute_time(\"20000101PDT\", &t),\n\t    SSH_ERR_INVALID_FORMAT);\n\tASSERT_INT_EQ(parse_absolute_time(\"20000101U\", &t),\n\t    SSH_ERR_INVALID_FORMAT);\n\tASSERT_INT_EQ(parse_absolute_time(\"20000101UTCUTC\", &t),\n\t    SSH_ERR_INVALID_FORMAT);\n\n\tTEST_DONE();\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}