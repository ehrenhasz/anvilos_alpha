{
  "module_name": "test_hpdelim.c",
  "hash_id": "bf1fc20166cad47581f6ac928a66a2828d77d99f7e59c55220b14c244f067c67",
  "original_prompt": "Ingested from openssh-9.6p1/regress/unittests/misc/test_hpdelim.c",
  "human_readable_source": " \n \n\n#include \"includes.h\"\n\n#include <sys/types.h>\n#include <stdio.h>\n#ifdef HAVE_STDINT_H\n#include <stdint.h>\n#endif\n#include <stdlib.h>\n#include <string.h>\n\n#include \"../test_helper/test_helper.h\"\n\n#include \"log.h\"\n#include \"misc.h\"\n#include \"xmalloc.h\"\n\nvoid test_hpdelim(void);\n\nvoid\ntest_hpdelim(void)\n{\n\tchar *orig, *str, *cp, *port;\n\n#define START_STRING(x)\torig = str = xstrdup(x)\n#define DONE_STRING()\tfree(orig)\n\n\tTEST_START(\"hpdelim host only\");\n\tSTART_STRING(\"host\");\n\tcp = hpdelim(&str);\n\tASSERT_STRING_EQ(cp, \"host\");\n\tASSERT_PTR_EQ(str, NULL);\n\tDONE_STRING();\n\tTEST_DONE();\n\n\tTEST_START(\"hpdelim :port\");\n\tSTART_STRING(\":1234\");\n\tcp = hpdelim(&str);\n\tASSERT_STRING_EQ(cp, \"\");\n\tASSERT_PTR_NE(str, NULL);\n\tport = hpdelim(&str);\n\tASSERT_STRING_EQ(port, \"1234\");\n\tASSERT_PTR_EQ(str, NULL);\n\tDONE_STRING();\n\tTEST_DONE();\n\n\tTEST_START(\"hpdelim host:port\");\n\tSTART_STRING(\"host:1234\");\n\tcp = hpdelim(&str);\n\tASSERT_STRING_EQ(cp, \"host\");\n\tASSERT_PTR_NE(str, NULL);\n\tport = hpdelim(&str);\n\tASSERT_STRING_EQ(port, \"1234\");\n\tASSERT_PTR_EQ(str, NULL);\n\tDONE_STRING();\n\tTEST_DONE();\n\n\tTEST_START(\"hpdelim [host]:port\");\n\tSTART_STRING(\"[::1]:1234\");\n\tcp = hpdelim(&str);\n\tASSERT_STRING_EQ(cp, \"[::1]\");\n\tASSERT_PTR_NE(str, NULL);\n\tport = hpdelim(&str);\n\tASSERT_STRING_EQ(port, \"1234\");\n\tASSERT_PTR_EQ(str, NULL);\n\tDONE_STRING();\n\tTEST_DONE();\n\n\tTEST_START(\"hpdelim missing ] error\");\n\tSTART_STRING(\"[::1:1234\");\n\tcp = hpdelim(&str);\n\tASSERT_PTR_EQ(cp, NULL);\n\tDONE_STRING();\n\tTEST_DONE();\n\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}