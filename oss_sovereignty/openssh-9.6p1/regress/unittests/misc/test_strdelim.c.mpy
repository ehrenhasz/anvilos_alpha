{
  "module_name": "test_strdelim.c",
  "hash_id": "cdd2d8990d2c3bb3fb85bf1b093523460141723180b4c97dca8ffa2f20100f89",
  "original_prompt": "Ingested from openssh-9.6p1/regress/unittests/misc/test_strdelim.c",
  "human_readable_source": " \n \n\n#include \"includes.h\"\n\n#include <sys/types.h>\n#include <stdio.h>\n#ifdef HAVE_STDINT_H\n#include <stdint.h>\n#endif\n#include <stdlib.h>\n#include <string.h>\n\n#include \"../test_helper/test_helper.h\"\n\n#include \"log.h\"\n#include \"misc.h\"\n#include \"xmalloc.h\"\n\nvoid test_strdelim(void);\n\nvoid\ntest_strdelim(void)\n{\n\tchar *orig, *str, *cp;\n\n#define START_STRING(x)\torig = str = xstrdup(x)\n#define DONE_STRING()\tfree(orig)\n\n\tTEST_START(\"empty\");\n\tSTART_STRING(\"\");\n\tcp = strdelim(&str);\n\tASSERT_STRING_EQ(cp, \"\");\t \n\tcp = strdelim(&str);\n\tASSERT_PTR_EQ(cp, NULL);\n\tDONE_STRING();\n\tTEST_DONE();\n\n\tTEST_START(\"whitespace\");\n\tSTART_STRING(\"\t\");\n\tcp = strdelim(&str);\n\tASSERT_STRING_EQ(cp, \"\");\t \n\tASSERT_STRING_EQ(str, \"\");\n\tDONE_STRING();\n\tTEST_DONE();\n\n\tTEST_START(\"trivial\");\n\tSTART_STRING(\"blob\");\n\tcp = strdelim(&str);\n\tASSERT_STRING_EQ(cp, \"blob\");\n\tcp = strdelim(&str);\n\tASSERT_PTR_EQ(cp, NULL);\n\tASSERT_PTR_EQ(str, NULL);\n\tDONE_STRING();\n\tTEST_DONE();\n\n\tTEST_START(\"trivial whitespace\");\n\tSTART_STRING(\"blob   \");\n\tcp = strdelim(&str);\n\tASSERT_STRING_EQ(cp, \"blob\");\n\tASSERT_STRING_EQ(str, \"\");\n\tcp = strdelim(&str);\n\tASSERT_STRING_EQ(cp, \"\");\t \n\tASSERT_PTR_EQ(str, NULL);\n\tDONE_STRING();\n\tTEST_DONE();\n\n\tTEST_START(\"multi\");\n\tSTART_STRING(\"blob1 blob2\");\n\tcp = strdelim(&str);\n\tASSERT_STRING_EQ(cp, \"blob1\");\n\tASSERT_STRING_EQ(str, \"blob2\");\n\tcp = strdelim(&str);\n\tASSERT_STRING_EQ(cp, \"blob2\");\n\tASSERT_PTR_EQ(str, NULL);\n\tcp = strdelim(&str);\n\tASSERT_PTR_EQ(cp, NULL);\n\tDONE_STRING();\n\tTEST_DONE();\n\n\tTEST_START(\"multi whitespace\");\n\tSTART_STRING(\"blob1\t \tblob2  \t \t\");\n\tcp = strdelim(&str);\n\tASSERT_STRING_EQ(cp, \"blob1\");\n\tASSERT_STRING_EQ(str, \"blob2  \t \t\");\n\tcp = strdelim(&str);\n\tASSERT_STRING_EQ(cp, \"blob2\");\n\tcp = strdelim(&str);\n\tASSERT_STRING_EQ(cp, \"\");\t \n\tASSERT_PTR_EQ(str, NULL);\n\tDONE_STRING();\n\tTEST_DONE();\n\n\tTEST_START(\"multi equals\");\n\tSTART_STRING(\"blob1=blob2\");\n\tcp = strdelim(&str);\n\tASSERT_STRING_EQ(cp, \"blob1\");\n\tASSERT_STRING_EQ(str, \"blob2\");\n\tcp = strdelim(&str);\n\tASSERT_STRING_EQ(cp, \"blob2\");\n\tASSERT_PTR_EQ(str, NULL);\n\tcp = strdelim(&str);\n\tASSERT_PTR_EQ(cp, NULL);\n\tDONE_STRING();\n\tTEST_DONE();\n\n\tTEST_START(\"multi too many equals\");\n\tSTART_STRING(\"blob1==blob2\");\n\tcp = strdelim(&str);\n\tASSERT_STRING_EQ(cp, \"blob1\");\t \n\tASSERT_STRING_EQ(str, \"=blob2\");\n\tcp = strdelim(&str);\n\tASSERT_STRING_EQ(cp, \"\");\n\tASSERT_STRING_EQ(str, \"blob2\");\n\tcp = strdelim(&str);\n\tASSERT_STRING_EQ(cp, \"blob2\");\t \n\tASSERT_PTR_EQ(str, NULL);\n\tDONE_STRING();\n\tTEST_DONE();\n\n\tTEST_START(\"multi equals strdelimw\");\n\tSTART_STRING(\"blob1=blob2\");\n\tcp = strdelimw(&str);\n\tASSERT_STRING_EQ(cp, \"blob1=blob2\");\n\tASSERT_PTR_EQ(str, NULL);\n\tcp = strdelimw(&str);\n\tASSERT_PTR_EQ(cp, NULL);\n\tDONE_STRING();\n\tTEST_DONE();\n\n\tTEST_START(\"quoted\");\n\tSTART_STRING(\"\\\"blob\\\"\");\n\tcp = strdelim(&str);\n\tASSERT_STRING_EQ(cp, \"blob\");\n\tcp = strdelim(&str);\n\tASSERT_STRING_EQ(cp, \"\");\t \n\tASSERT_PTR_EQ(str, NULL);\n\tDONE_STRING();\n\tTEST_DONE();\n\n\tTEST_START(\"quoted multi\");\n\tSTART_STRING(\"\\\"blob1\\\" blob2\");\n\tcp = strdelim(&str);\n\tASSERT_STRING_EQ(cp, \"blob1\");\n\tASSERT_STRING_EQ(str, \"blob2\");\n\tcp = strdelim(&str);\n\tASSERT_STRING_EQ(cp, \"blob2\");\n\tASSERT_PTR_EQ(str, NULL);\n\tcp = strdelim(&str);\n\tASSERT_PTR_EQ(cp, NULL);\n\tDONE_STRING();\n\tTEST_DONE();\n\n\tTEST_START(\"quoted multi reverse\");\n\tSTART_STRING(\"blob1 \\\"blob2\\\"\");\n\tcp = strdelim(&str);\n\tASSERT_STRING_EQ(cp, \"blob1\");\n\tASSERT_STRING_EQ(str, \"\\\"blob2\\\"\");\n\tcp = strdelim(&str);\n\tASSERT_STRING_EQ(cp, \"blob2\");\n\tASSERT_STRING_EQ(str, \"\");\n\tcp = strdelim(&str);\n\tASSERT_STRING_EQ(cp, \"\");\t \n\tASSERT_PTR_EQ(str, NULL);\n\tDONE_STRING();\n\tTEST_DONE();\n\n\tTEST_START(\"quoted multi middle\");\n\tSTART_STRING(\"blob1 \\\"blob2\\\" blob3\");\n\tcp = strdelim(&str);\n\tASSERT_STRING_EQ(cp, \"blob1\");\n\tcp = strdelim(&str);\n\tASSERT_STRING_EQ(cp, \"blob2\");\n\tcp = strdelim(&str);\n\tASSERT_STRING_EQ(cp, \"blob3\");\n\tcp = strdelim(&str);\n\tASSERT_PTR_EQ(cp, NULL);\n\tDONE_STRING();\n\tTEST_DONE();\n\n\tTEST_START(\"badquote\");\n\tSTART_STRING(\"\\\"blob\");\n\tcp = strdelim(&str);\n\tASSERT_PTR_EQ(cp, NULL);\n\tDONE_STRING();\n\tTEST_DONE();\n\n\tTEST_START(\"oops quote\");\n\tSTART_STRING(\"\\\"blob\\\\\\\"\");\n\tcp = strdelim(&str);\n\tASSERT_STRING_EQ(cp, \"blob\\\\\");\t \n\tcp = strdelim(&str);\n\tASSERT_STRING_EQ(cp, \"\");\n\tDONE_STRING();\n\tTEST_DONE();\n\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}