{
  "module_name": "test_expand.c",
  "hash_id": "4664686c8905de0f5fdf8cf48dca47d3950ababa0a6eee6f24610d14b723ed54",
  "original_prompt": "Ingested from openssh-9.6p1/regress/unittests/misc/test_expand.c",
  "human_readable_source": " \n \n\n#include \"includes.h\"\n\n#include <sys/types.h>\n#include <stdio.h>\n#ifdef HAVE_STDINT_H\n#include <stdint.h>\n#endif\n#include <stdlib.h>\n#include <string.h>\n\n#include \"../test_helper/test_helper.h\"\n\n#include \"log.h\"\n#include \"misc.h\"\n\nvoid test_expand(void);\n\nvoid\ntest_expand(void)\n{\n\tint parseerr;\n\tchar *ret;\n\n\tTEST_START(\"dollar_expand\");\n\tASSERT_INT_EQ(setenv(\"FOO\", \"bar\", 1), 0);\n\tASSERT_INT_EQ(setenv(\"BAR\", \"baz\", 1), 0);\n\t(void)unsetenv(\"BAZ\");\n#define ASSERT_DOLLAR_EQ(x, y) do { \\\n\tchar *str = dollar_expand(NULL, (x)); \\\n\tASSERT_STRING_EQ(str, (y)); \\\n\tfree(str); \\\n} while(0)\n\tASSERT_DOLLAR_EQ(\"${FOO}\", \"bar\");\n\tASSERT_DOLLAR_EQ(\" ${FOO}\", \" bar\");\n\tASSERT_DOLLAR_EQ(\"${FOO} \", \"bar \");\n\tASSERT_DOLLAR_EQ(\" ${FOO} \", \" bar \");\n\tASSERT_DOLLAR_EQ(\"${FOO}${BAR}\", \"barbaz\");\n\tASSERT_DOLLAR_EQ(\" ${FOO} ${BAR}\", \" bar baz\");\n\tASSERT_DOLLAR_EQ(\"${FOO}${BAR} \", \"barbaz \");\n\tASSERT_DOLLAR_EQ(\" ${FOO} ${BAR} \", \" bar baz \");\n\tASSERT_DOLLAR_EQ(\"$\", \"$\");\n\tASSERT_DOLLAR_EQ(\" $\", \" $\");\n\tASSERT_DOLLAR_EQ(\"$ \", \"$ \");\n\n\t \n\tlog_init(\"test_misc\", SYSLOG_LEVEL_QUIET, SYSLOG_FACILITY_AUTH, 1);\n\t \n\tret = dollar_expand(&parseerr, \"a${BAZ}\");\n\tASSERT_PTR_EQ(ret, NULL); ASSERT_INT_EQ(parseerr, 0);\n\tret = dollar_expand(&parseerr, \"${BAZ}b\");\n\tASSERT_PTR_EQ(ret, NULL); ASSERT_INT_EQ(parseerr, 0);\n\tret = dollar_expand(&parseerr, \"a${BAZ}b\");\n\tASSERT_PTR_EQ(ret, NULL); ASSERT_INT_EQ(parseerr, 0);\n\t \n\tret = dollar_expand(&parseerr, \"${\");\n\tASSERT_PTR_EQ(ret, NULL); ASSERT_INT_EQ(parseerr, 1);\n\tret = dollar_expand(&parseerr, \"${F\");\n\tASSERT_PTR_EQ(ret, NULL); ASSERT_INT_EQ(parseerr, 1);\n\tret = dollar_expand(&parseerr, \"${FO\");\n\tASSERT_PTR_EQ(ret, NULL); ASSERT_INT_EQ(parseerr, 1);\n\t \n\tret = dollar_expand(&parseerr, \"${}\");\n\tASSERT_PTR_EQ(ret, NULL); ASSERT_INT_EQ(parseerr, 1);\n\t \n\tlog_init(\"test_misc\", SYSLOG_LEVEL_INFO, SYSLOG_FACILITY_AUTH, 1);\n\tTEST_DONE();\n\n\tTEST_START(\"percent_expand\");\n\tASSERT_STRING_EQ(percent_expand(\"%%\", \"%h\", \"foo\", NULL), \"%\");\n\tASSERT_STRING_EQ(percent_expand(\"%h\", \"h\", \"foo\", NULL), \"foo\");\n\tASSERT_STRING_EQ(percent_expand(\"%h \", \"h\", \"foo\", NULL), \"foo \");\n\tASSERT_STRING_EQ(percent_expand(\" %h\", \"h\", \"foo\", NULL), \" foo\");\n\tASSERT_STRING_EQ(percent_expand(\" %h \", \"h\", \"foo\", NULL), \" foo \");\n\tASSERT_STRING_EQ(percent_expand(\" %a%b \", \"a\", \"foo\", \"b\", \"bar\", NULL),\n\t    \" foobar \");\n\tTEST_DONE();\n\n\tTEST_START(\"percent_dollar_expand\");\n\tASSERT_STRING_EQ(percent_dollar_expand(\"%h${FOO}\", \"h\", \"foo\", NULL),\n\t    \"foobar\");\n\tTEST_DONE();\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}