{
  "module_name": "tests.c",
  "hash_id": "88ab23c14ff67055c2e33443ce2bc658e9d01824fe443da4400e3cee3d5fe474",
  "original_prompt": "Ingested from openssh-9.6p1/regress/unittests/bitmap/tests.c",
  "human_readable_source": " \n \n\n#include \"includes.h\"\n\n#include <sys/types.h>\n#include <stdio.h>\n#ifdef HAVE_STDINT_H\n#include <stdint.h>\n#endif\n#include <stdlib.h>\n#include <string.h>\n\n#ifdef WITH_OPENSSL\n#include <openssl/bn.h>\n#endif\n\n#include \"../test_helper/test_helper.h\"\n\n#include \"bitmap.h\"\n\n#define NTESTS 131\n\nvoid\ntests(void)\n{\n#ifdef WITH_OPENSSL\n\tstruct bitmap *b;\n\tBIGNUM *bn;\n\tsize_t len;\n\tint i, j, k, n;\n\tu_char bbuf[1024], bnbuf[1024];\n\tint r;\n\n\tTEST_START(\"bitmap_new\");\n\tb = bitmap_new();\n\tASSERT_PTR_NE(b, NULL);\n\tbn = BN_new();\n\tASSERT_PTR_NE(bn, NULL);\n\tTEST_DONE();\n\n\tTEST_START(\"bitmap_set_bit / bitmap_test_bit\");\n\tfor (i = -1; i < NTESTS; i++) {\n\t\tfor (j = -1; j < NTESTS; j++) {\n\t\t\tfor (k = -1; k < NTESTS; k++) {\n\t\t\t\tbitmap_zero(b);\n\t\t\t\tBN_clear(bn);\n\n\t\t\t\ttest_subtest_info(\"set %d/%d/%d\", i, j, k);\n\t\t\t\t \n\t\t\t\tif (i >= 0) {\n\t\t\t\t\tASSERT_INT_EQ(bitmap_set_bit(b, i), 0);\n\t\t\t\t\tASSERT_INT_EQ(BN_set_bit(bn, i), 1);\n\t\t\t\t}\n\t\t\t\tif (j >= 0) {\n\t\t\t\t\tASSERT_INT_EQ(bitmap_set_bit(b, j), 0);\n\t\t\t\t\tASSERT_INT_EQ(BN_set_bit(bn, j), 1);\n\t\t\t\t}\n\t\t\t\tif (k >= 0) {\n\t\t\t\t\tASSERT_INT_EQ(bitmap_set_bit(b, k), 0);\n\t\t\t\t\tASSERT_INT_EQ(BN_set_bit(bn, k), 1);\n\t\t\t\t}\n\n\t\t\t\t \n\t\t\t\ttest_subtest_info(\"match %d/%d/%d\", i, j, k);\n\t\t\t\tfor (n = 0; n < NTESTS; n++) {\n\t\t\t\t\tASSERT_INT_EQ(BN_is_bit_set(bn, n),\n\t\t\t\t\t    bitmap_test_bit(b, n));\n\t\t\t\t}\n\n\t\t\t\t \n\t\t\t\ttest_subtest_info(\"length %d/%d/%d\", i, j, k);\n\t\t\t\tASSERT_INT_EQ(BN_num_bits(bn),\n\t\t\t\t    (int)bitmap_nbits(b));\n\t\t\t\tASSERT_INT_EQ(BN_num_bytes(bn),\n\t\t\t\t    (int)bitmap_nbytes(b));\n\n\t\t\t\t \n\t\t\t\ttest_subtest_info(\"serialise %d/%d/%d\",\n\t\t\t\t    i, j, k);\n\t\t\t\tlen = bitmap_nbytes(b);\n\t\t\t\tmemset(bbuf, 0xfc, sizeof(bbuf));\n\t\t\t\tASSERT_INT_EQ(bitmap_to_string(b, bbuf,\n\t\t\t\t    sizeof(bbuf)), 0);\n\t\t\t\tfor (n = len; n < (int)sizeof(bbuf); n++)\n\t\t\t\t\tASSERT_U8_EQ(bbuf[n], 0xfc);\n\t\t\t\tr = BN_bn2bin(bn, bnbuf);\n\t\t\t\tASSERT_INT_GE(r, 0);\n\t\t\t\tASSERT_INT_EQ(r, (int)len);\n\t\t\t\tASSERT_MEM_EQ(bbuf, bnbuf, len);\n\n\t\t\t\t \n\t\t\t\ttest_subtest_info(\"deserialise %d/%d/%d\",\n\t\t\t\t    i, j, k);\n\t\t\t\tbitmap_zero(b);\n\t\t\t\tASSERT_INT_EQ(bitmap_from_string(b, bnbuf,\n\t\t\t\t    len), 0);\n\t\t\t\tfor (n = 0; n < NTESTS; n++) {\n\t\t\t\t\tASSERT_INT_EQ(BN_is_bit_set(bn, n),\n\t\t\t\t\t    bitmap_test_bit(b, n));\n\t\t\t\t}\n\n\t\t\t\t \n\t\t\t\ttest_subtest_info(\"clear %d/%d/%d\",\n\t\t\t\t    i, j, k);\n\t\t\t\tfor (n = 0; n < NTESTS; n++) {\n\t\t\t\t\tASSERT_INT_EQ(bitmap_set_bit(b, n), 0);\n\t\t\t\t\tASSERT_INT_EQ(BN_set_bit(bn, n), 1);\n\t\t\t\t}\n\t\t\t\tif (i >= 0) {\n\t\t\t\t\tbitmap_clear_bit(b, i);\n\t\t\t\t\tBN_clear_bit(bn, i);\n\t\t\t\t}\n\t\t\t\tif (j >= 0) {\n\t\t\t\t\tbitmap_clear_bit(b, j);\n\t\t\t\t\tBN_clear_bit(bn, j);\n\t\t\t\t}\n\t\t\t\tif (k >= 0) {\n\t\t\t\t\tbitmap_clear_bit(b, k);\n\t\t\t\t\tBN_clear_bit(bn, k);\n\t\t\t\t}\n\t\t\t\tfor (n = 0; n < NTESTS; n++) {\n\t\t\t\t\tASSERT_INT_EQ(BN_is_bit_set(bn, n),\n\t\t\t\t\t    bitmap_test_bit(b, n));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tbitmap_free(b);\n\tBN_free(bn);\n\tTEST_DONE();\n#endif\n}\n\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}