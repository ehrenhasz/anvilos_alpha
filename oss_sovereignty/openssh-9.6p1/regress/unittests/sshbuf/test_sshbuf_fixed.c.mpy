{
  "module_name": "test_sshbuf_fixed.c",
  "hash_id": "b6eb5b61cc030e60a8f0afca273a7d02cbc19d7d17993d1c2f081a5d9b3ffd90",
  "original_prompt": "Ingested from openssh-9.6p1/regress/unittests/sshbuf/test_sshbuf_fixed.c",
  "human_readable_source": " \n \n\n#define SSHBUF_INTERNAL 1   \n#include \"includes.h\"\n\n#include <sys/types.h>\n#include <stdio.h>\n#ifdef HAVE_STDINT_H\n# include <stdint.h>\n#endif\n#include <stdlib.h>\n#include <string.h>\n\n#include \"../test_helper/test_helper.h\"\n\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n\nvoid sshbuf_fixed(void);\n\nconst u_char test_buf[] = \"\\x01\\x12\\x34\\x56\\x78\\x00\\x00\\x00\\x05hello\";\n\nvoid\nsshbuf_fixed(void)\n{\n\tstruct sshbuf *p1, *p2, *p3;\n\tu_char c;\n\tchar *s;\n\tu_int i;\n\tsize_t l;\n\n\tTEST_START(\"sshbuf_from\");\n\tp1 = sshbuf_from(test_buf, sizeof(test_buf));\n\tASSERT_PTR_NE(p1, NULL);\n\tASSERT_PTR_EQ(sshbuf_mutable_ptr(p1), NULL);\n\tASSERT_INT_EQ(sshbuf_check_reserve(p1, 1), SSH_ERR_BUFFER_READ_ONLY);\n\tASSERT_INT_EQ(sshbuf_reserve(p1, 1, NULL), SSH_ERR_BUFFER_READ_ONLY);\n\tASSERT_INT_EQ(sshbuf_set_max_size(p1, 200), SSH_ERR_BUFFER_READ_ONLY);\n\tASSERT_INT_EQ(sshbuf_put_u32(p1, 0x12345678), SSH_ERR_BUFFER_READ_ONLY);\n\tASSERT_SIZE_T_EQ(sshbuf_avail(p1), 0);\n\tASSERT_PTR_EQ(sshbuf_ptr(p1), test_buf);\n\tsshbuf_free(p1);\n\tTEST_DONE();\n\n\tTEST_START(\"sshbuf_from data\");\n\tp1 = sshbuf_from(test_buf, sizeof(test_buf) - 1);\n\tASSERT_PTR_NE(p1, NULL);\n\tASSERT_PTR_EQ(sshbuf_ptr(p1), test_buf);\n\tASSERT_INT_EQ(sshbuf_get_u8(p1, &c), 0);\n\tASSERT_PTR_EQ(sshbuf_ptr(p1), test_buf + 1);\n\tASSERT_U8_EQ(c, 1);\n\tASSERT_INT_EQ(sshbuf_get_u32(p1, &i), 0);\n\tASSERT_PTR_EQ(sshbuf_ptr(p1), test_buf + 5);\n\tASSERT_U32_EQ(i, 0x12345678);\n\tASSERT_INT_EQ(sshbuf_get_cstring(p1, &s, &l), 0);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), 0);\n\tASSERT_STRING_EQ(s, \"hello\");\n\tASSERT_SIZE_T_EQ(l, 5);\n\tsshbuf_free(p1);\n\tfree(s);\n\tTEST_DONE();\n\n\tTEST_START(\"sshbuf_fromb \");\n\tp1 = sshbuf_new();\n\tASSERT_PTR_NE(p1, NULL);\n\tASSERT_U_INT_EQ(sshbuf_refcount(p1), 1);\n\tASSERT_PTR_EQ(sshbuf_parent(p1), NULL);\n\tASSERT_INT_EQ(sshbuf_put(p1, test_buf, sizeof(test_buf) - 1), 0);\n\tp2 = sshbuf_fromb(p1);\n\tASSERT_PTR_NE(p2, NULL);\n\tASSERT_U_INT_EQ(sshbuf_refcount(p1), 2);\n\tASSERT_PTR_EQ(sshbuf_parent(p1), NULL);\n\tASSERT_PTR_EQ(sshbuf_parent(p2), p1);\n\tASSERT_PTR_EQ(sshbuf_ptr(p2), sshbuf_ptr(p1));\n\tASSERT_PTR_NE(sshbuf_ptr(p1), NULL);\n\tASSERT_PTR_NE(sshbuf_ptr(p2), NULL);\n\tASSERT_PTR_EQ(sshbuf_mutable_ptr(p1), NULL);\n\tASSERT_PTR_EQ(sshbuf_mutable_ptr(p2), NULL);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), sshbuf_len(p2));\n\tASSERT_INT_EQ(sshbuf_get_u8(p2, &c), 0);\n\tASSERT_PTR_EQ(sshbuf_ptr(p2), sshbuf_ptr(p1) + 1);\n\tASSERT_U8_EQ(c, 1);\n\tASSERT_INT_EQ(sshbuf_get_u32(p2, &i), 0);\n\tASSERT_PTR_EQ(sshbuf_ptr(p2), sshbuf_ptr(p1) + 5);\n\tASSERT_U32_EQ(i, 0x12345678);\n\tASSERT_INT_EQ(sshbuf_get_cstring(p2, &s, &l), 0);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p2), 0);\n\tASSERT_STRING_EQ(s, \"hello\");\n\tASSERT_SIZE_T_EQ(l, 5);\n\tsshbuf_free(p1);\n\tASSERT_U_INT_EQ(sshbuf_refcount(p1), 1);\n\tsshbuf_free(p2);\n\tfree(s);\n\tTEST_DONE();\n\n\tTEST_START(\"sshbuf_froms\");\n\tp1 = sshbuf_new();\n\tASSERT_PTR_NE(p1, NULL);\n\tASSERT_INT_EQ(sshbuf_put_u8(p1, 0x01), 0);\n\tASSERT_INT_EQ(sshbuf_put_u32(p1, 0x12345678), 0);\n\tASSERT_INT_EQ(sshbuf_put_cstring(p1, \"hello\"), 0);\n\tp2 = sshbuf_new();\n\tASSERT_PTR_NE(p2, NULL);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), sizeof(test_buf) - 1);\n\tASSERT_INT_EQ(sshbuf_put_stringb(p2, p1), 0);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p2), sizeof(test_buf) + 4 - 1);\n\tASSERT_INT_EQ(sshbuf_froms(p2, &p3), 0);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p2), 0);\n\tASSERT_PTR_NE(p3, NULL);\n\tASSERT_PTR_NE(sshbuf_ptr(p3), NULL);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p3), sizeof(test_buf) - 1);\n\tASSERT_MEM_EQ(sshbuf_ptr(p3), test_buf, sizeof(test_buf) - 1);\n\tsshbuf_free(p3);\n\tASSERT_INT_EQ(sshbuf_put_stringb(p2, p1), 0);\n\tASSERT_INT_EQ(sshbuf_consume_end(p2, 1), 0);\n\tASSERT_INT_EQ(sshbuf_froms(p2, &p3), SSH_ERR_MESSAGE_INCOMPLETE);\n\tASSERT_PTR_EQ(p3, NULL);\n\tsshbuf_free(p2);\n\tsshbuf_free(p1);\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}