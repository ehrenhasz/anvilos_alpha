{
  "module_name": "test_sshbuf_getput_basic.c",
  "hash_id": "b946f7b0d2055943c670a852bb580667602b8db7dd09945edbed72b99fb18a71",
  "original_prompt": "Ingested from openssh-9.6p1/regress/unittests/sshbuf/test_sshbuf_getput_basic.c",
  "human_readable_source": " \n \n\n#include \"includes.h\"\n\n#include <sys/types.h>\n#include <stdio.h>\n#ifdef HAVE_STDINT_H\n# include <stdint.h>\n#endif\n#include <stdlib.h>\n#include <string.h>\n\n#include \"../test_helper/test_helper.h\"\n#include \"ssherr.h\"\n#include \"sshbuf.h\"\n\nvoid sshbuf_getput_basic_tests(void);\n\nvoid\nsshbuf_getput_basic_tests(void)\n{\n\tstruct sshbuf *p1, *p2;\n\tconst u_char *cd;\n\tu_char *d, d2[32], x[] = {\n\t\t0x11, 0x22, 0x33, 0x44, 0x55, 0x66, 0x77, 0x88, 0x00, 0x99\n\t};\n\tu_int64_t v64;\n\tu_int32_t v32;\n\tu_int16_t v16;\n\tu_char v8;\n\tsize_t s;\n\tchar *s2;\n\tint r;\n\tu_char bn1[] = { 0x00, 0x00, 0x00 };\n\tu_char bn2[] = { 0x00, 0x00, 0x01, 0x02 };\n\tu_char bn3[] = { 0x00, 0x80, 0x09 };\n\tu_char bn_exp1[] = { 0x00, 0x00, 0x00, 0x00 };\n\tu_char bn_exp2[] = { 0x00, 0x00, 0x00, 0x02, 0x01, 0x02 };\n\tu_char bn_exp3[] = { 0x00, 0x00, 0x00, 0x03, 0x00, 0x80, 0x09 };\n\n\tTEST_START(\"PEEK_U64\");\n\tASSERT_U64_EQ(PEEK_U64(x), 0x1122334455667788ULL);\n\tTEST_DONE();\n\n\tTEST_START(\"PEEK_U32\");\n\tASSERT_U32_EQ(PEEK_U32(x), 0x11223344);\n\tTEST_DONE();\n\n\tTEST_START(\"PEEK_U16\");\n\tASSERT_U16_EQ(PEEK_U16(x), 0x1122);\n\tTEST_DONE();\n\n\tTEST_START(\"POKE_U64\");\n\tbzero(d2, sizeof(d2));\n\tPOKE_U64(d2, 0x1122334455667788ULL);\n\tASSERT_MEM_EQ(d2, x, 8);\n\tTEST_DONE();\n\t\n\tTEST_START(\"POKE_U32\");\n\tbzero(d2, sizeof(d2));\n\tPOKE_U32(d2, 0x11223344);\n\tASSERT_MEM_EQ(d2, x, 4);\n\tTEST_DONE();\n\t\n\tTEST_START(\"POKE_U16\");\n\tbzero(d2, sizeof(d2));\n\tPOKE_U16(d2, 0x1122);\n\tASSERT_MEM_EQ(d2, x, 2);\n\tTEST_DONE();\n\n\tTEST_START(\"sshbuf_put\");\n\tp1 = sshbuf_new();\n\tASSERT_PTR_NE(p1, NULL);\n\tASSERT_INT_EQ(sshbuf_put(p1, x, 5), 0);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), 5);\n\tcd = sshbuf_ptr(p1);\n\tASSERT_PTR_NE(cd, NULL);\n\tASSERT_U8_EQ(cd[0], 0x11);\n\tASSERT_U8_EQ(cd[1], 0x22);\n\tASSERT_U8_EQ(cd[2], 0x33);\n\tASSERT_U8_EQ(cd[3], 0x44);\n\tASSERT_U8_EQ(cd[4], 0x55);\n\tTEST_DONE();\n\n\tTEST_START(\"sshbuf_get\");\n\tASSERT_INT_EQ(sshbuf_get(p1, d2, 4), 0);\n\tASSERT_MEM_EQ(d2, x, 4);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), 1);\n\tASSERT_U8_EQ(*(sshbuf_ptr(p1)), 0x55);\n\tTEST_DONE();\n\n\tTEST_START(\"sshbuf_get truncated\");\n\tr = sshbuf_get(p1, d2, 4);\n\tASSERT_INT_EQ(r, SSH_ERR_MESSAGE_INCOMPLETE);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), 1);\n\tASSERT_U8_EQ(*(sshbuf_ptr(p1)), 0x55);\n\tTEST_DONE();\n\n\tTEST_START(\"sshbuf_put truncated\");\n\tASSERT_INT_EQ(sshbuf_set_max_size(p1, 4), 0);\n\tr = sshbuf_put(p1, x, 5);\n\tASSERT_INT_EQ(r, SSH_ERR_NO_BUFFER_SPACE);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), 1);\n\tsshbuf_free(p1);\n\tTEST_DONE();\n\n\tTEST_START(\"sshbuf_get_u64\");\n\tp1 = sshbuf_new();\n\tASSERT_PTR_NE(p1, NULL);\n\tASSERT_INT_EQ(sshbuf_put(p1, x, 10), 0);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), 10);\n\tASSERT_INT_EQ(sshbuf_get_u64(p1, &v64), 0);\n\tASSERT_U64_EQ(v64, 0x1122334455667788ULL);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), 2);\n\tTEST_DONE();\n\n\tTEST_START(\"sshbuf_get_u64 truncated\");\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), 2);\n\tr = sshbuf_get_u64(p1, &v64);\n\tASSERT_INT_EQ(r, SSH_ERR_MESSAGE_INCOMPLETE);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), 2);\n\tsshbuf_free(p1);\n\tTEST_DONE();\n\n\tTEST_START(\"sshbuf_get_u32\");\n\tp1 = sshbuf_new();\n\tASSERT_PTR_NE(p1, NULL);\n\tASSERT_INT_EQ(sshbuf_put(p1, x, 10), 0);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), 10);\n\tASSERT_INT_EQ(sshbuf_get_u32(p1, &v32), 0);\n\tASSERT_U32_EQ(v32, 0x11223344);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), 6);\n\tASSERT_INT_EQ(sshbuf_get_u32(p1, &v32), 0);\n\tASSERT_U32_EQ(v32, 0x55667788);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), 2);\n\tTEST_DONE();\n\n\tTEST_START(\"sshbuf_get_u32 truncated\");\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), 2);\n\tr = sshbuf_get_u32(p1, &v32);\n\tASSERT_INT_EQ(r, SSH_ERR_MESSAGE_INCOMPLETE);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), 2);\n\tsshbuf_free(p1);\n\tTEST_DONE();\n\n\tTEST_START(\"sshbuf_get_u16\");\n\tp1 = sshbuf_new();\n\tASSERT_PTR_NE(p1, NULL);\n\tASSERT_INT_EQ(sshbuf_put(p1, x, 9), 0);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), 9);\n\tASSERT_INT_EQ(sshbuf_get_u16(p1, &v16), 0);\n\tASSERT_U16_EQ(v16, 0x1122);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), 7);\n\tASSERT_INT_EQ(sshbuf_get_u16(p1, &v16), 0);\n\tASSERT_U16_EQ(v16, 0x3344);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), 5);\n\tASSERT_INT_EQ(sshbuf_get_u16(p1, &v16), 0);\n\tASSERT_U16_EQ(v16, 0x5566);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), 3);\n\tASSERT_INT_EQ(sshbuf_get_u16(p1, &v16), 0);\n\tASSERT_U16_EQ(v16, 0x7788);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), 1);\n\tTEST_DONE();\n\n\tTEST_START(\"sshbuf_get_u16 truncated\");\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), 1);\n\tr = sshbuf_get_u16(p1, &v16);\n\tASSERT_INT_EQ(r, SSH_ERR_MESSAGE_INCOMPLETE);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), 1);\n\tsshbuf_free(p1);\n\tTEST_DONE();\n\n\tTEST_START(\"sshbuf_get_u8\");\n\tp1 = sshbuf_new();\n\tASSERT_PTR_NE(p1, NULL);\n\tASSERT_INT_EQ(sshbuf_put(p1, x, 2), 0);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), 2);\n\tASSERT_INT_EQ(sshbuf_get_u8(p1, &v8), 0);\n\tASSERT_U8_EQ(v8, 0x11);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), 1);\n\tASSERT_INT_EQ(sshbuf_get_u8(p1, &v8), 0);\n\tASSERT_U8_EQ(v8, 0x22);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), 0);\n\tTEST_DONE();\n\n\tTEST_START(\"sshbuf_get_u8 truncated\");\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), 0);\n\tr = sshbuf_get_u8(p1, &v8);\n\tASSERT_INT_EQ(r, SSH_ERR_MESSAGE_INCOMPLETE);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), 0);\n\tsshbuf_free(p1);\n\tTEST_DONE();\n\n\tTEST_START(\"sshbuf_put_u64\");\n\tp1 = sshbuf_new();\n\tASSERT_PTR_NE(p1, NULL);\n\tASSERT_INT_EQ(sshbuf_put_u64(p1, 0x1122334455667788ULL), 0);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), 8);\n\tASSERT_MEM_EQ(sshbuf_ptr(p1), x, 8);\n\tsshbuf_free(p1);\n\tTEST_DONE();\n\n\tTEST_START(\"sshbuf_put_u64 exact\");\n\tp1 = sshbuf_new();\n\tASSERT_PTR_NE(p1, NULL);\n\tASSERT_INT_EQ(sshbuf_set_max_size(p1, 8), 0);\n\tASSERT_INT_EQ(sshbuf_put_u64(p1, 0x1122334455667788ULL), 0);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), 8);\n\tASSERT_MEM_EQ(sshbuf_ptr(p1), x, 8);\n\tsshbuf_free(p1);\n\tTEST_DONE();\n\n\tTEST_START(\"sshbuf_put_u64 limited\");\n\tp1 = sshbuf_new();\n\tASSERT_PTR_NE(p1, NULL);\n\tASSERT_INT_EQ(sshbuf_set_max_size(p1, 7), 0);\n\tr = sshbuf_put_u64(p1, 0x1122334455667788ULL);\n\tASSERT_INT_EQ(r, SSH_ERR_NO_BUFFER_SPACE);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), 0);\n\tsshbuf_free(p1);\n\tTEST_DONE();\n\t\n\tTEST_START(\"sshbuf_put_u32\");\n\tp1 = sshbuf_new();\n\tASSERT_PTR_NE(p1, NULL);\n\tASSERT_INT_EQ(sshbuf_put_u32(p1, 0x11223344), 0);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), 4);\n\tASSERT_MEM_EQ(sshbuf_ptr(p1), x, 4);\n\tsshbuf_free(p1);\n\tTEST_DONE();\n\n\tTEST_START(\"sshbuf_put_u32 exact\");\n\tp1 = sshbuf_new();\n\tASSERT_PTR_NE(p1, NULL);\n\tASSERT_INT_EQ(sshbuf_set_max_size(p1, 4), 0);\n\tASSERT_INT_EQ(sshbuf_put_u32(p1, 0x11223344), 0);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), 4);\n\tASSERT_MEM_EQ(sshbuf_ptr(p1), x, 4);\n\tsshbuf_free(p1);\n\tTEST_DONE();\n\n\tTEST_START(\"sshbuf_put_u32 limited\");\n\tp1 = sshbuf_new();\n\tASSERT_PTR_NE(p1, NULL);\n\tASSERT_INT_EQ(sshbuf_set_max_size(p1, 3), 0);\n\tr = sshbuf_put_u32(p1, 0x11223344);\n\tASSERT_INT_EQ(r, SSH_ERR_NO_BUFFER_SPACE);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), 0);\n\tsshbuf_free(p1);\n\tTEST_DONE();\n\t\n\tTEST_START(\"sshbuf_put_u16\");\n\tp1 = sshbuf_new();\n\tASSERT_PTR_NE(p1, NULL);\n\tASSERT_INT_EQ(sshbuf_put_u16(p1, 0x1122), 0);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), 2);\n\tASSERT_MEM_EQ(sshbuf_ptr(p1), x, 2);\n\tsshbuf_free(p1);\n\tTEST_DONE();\n\n\tTEST_START(\"sshbuf_put_u16\");\n\tp1 = sshbuf_new();\n\tASSERT_PTR_NE(p1, NULL);\n\tASSERT_INT_EQ(sshbuf_set_max_size(p1, 2), 0);\n\tASSERT_INT_EQ(sshbuf_put_u16(p1, 0x1122), 0);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), 2);\n\tASSERT_MEM_EQ(sshbuf_ptr(p1), x, 2);\n\tsshbuf_free(p1);\n\tTEST_DONE();\n\n\tTEST_START(\"sshbuf_put_u16 limited\");\n\tp1 = sshbuf_new();\n\tASSERT_PTR_NE(p1, NULL);\n\tASSERT_INT_EQ(sshbuf_set_max_size(p1, 1), 0);\n\tr = sshbuf_put_u16(p1, 0x1122);\n\tASSERT_INT_EQ(r, SSH_ERR_NO_BUFFER_SPACE);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), 0);\n\tsshbuf_free(p1);\n\tTEST_DONE();\n\n\tTEST_START(\"sshbuf_get_string\");\n\tp1 = sshbuf_new();\n\tASSERT_PTR_NE(p1, NULL);\n\tASSERT_INT_EQ(sshbuf_put_u32(p1, sizeof(x)), 0);\n\tASSERT_INT_EQ(sshbuf_put(p1, x, sizeof(x)), 0);\n\tASSERT_INT_EQ(sshbuf_put_u32(p1, sizeof(x)), 0);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), sizeof(x) + 4 + 4);\n\tASSERT_INT_EQ(sshbuf_get_string(p1, &d, &s), 0);\n\tASSERT_SIZE_T_EQ(s, sizeof(x));\n\tASSERT_MEM_EQ(d, x, sizeof(x));\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), 4);\n\tfree(d);\n\tsshbuf_free(p1);\n\tTEST_DONE();\n\n\tTEST_START(\"sshbuf_get_string exact\");\n\tp1 = sshbuf_new();\n\tASSERT_PTR_NE(p1, NULL);\n\tASSERT_INT_EQ(sshbuf_set_max_size(p1, sizeof(x) + 4), 0);\n\tASSERT_INT_EQ(sshbuf_put_u32(p1, sizeof(x)), 0);\n\tASSERT_INT_EQ(sshbuf_put(p1, x, sizeof(x)), 0);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), sizeof(x) + 4);\n\tASSERT_INT_EQ(sshbuf_get_string(p1, &d, &s), 0);\n\tASSERT_SIZE_T_EQ(s, sizeof(x));\n\tASSERT_MEM_EQ(d, x, sizeof(x));\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), 0);\n\tfree(d);\n\tsshbuf_free(p1);\n\tTEST_DONE();\n\n\tTEST_START(\"sshbuf_get_string truncated\");\n\tp1 = sshbuf_new();\n\tASSERT_PTR_NE(p1, NULL);\n\tASSERT_INT_EQ(sshbuf_put_u32(p1, sizeof(x)), 0);\n\tASSERT_INT_EQ(sshbuf_put(p1, x, sizeof(x)), 0);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), sizeof(x) + 4);\n\tASSERT_INT_EQ(sshbuf_consume_end(p1, 1), 0);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), sizeof(x) + 3);\n\tr = sshbuf_get_string(p1, &d, &s);\n\tASSERT_INT_EQ(r, SSH_ERR_MESSAGE_INCOMPLETE);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), sizeof(x) + 3);\n\tsshbuf_free(p1);\n\tTEST_DONE();\n\n\tTEST_START(\"sshbuf_get_string giant\");\n\tp1 = sshbuf_new();\n\tASSERT_PTR_NE(p1, NULL);\n\tASSERT_INT_EQ(sshbuf_put_u32(p1, 0xffffffff), 0);\n\tASSERT_INT_EQ(sshbuf_put(p1, x, sizeof(x)), 0);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), sizeof(x) + 4);\n\tr = sshbuf_get_string(p1, &d, &s);\n\tASSERT_INT_EQ(r, SSH_ERR_STRING_TOO_LARGE);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), sizeof(x) + 4);\n\tsshbuf_free(p1);\n\tTEST_DONE();\n\n\tTEST_START(\"sshbuf_get_cstring giant\");\n\tp1 = sshbuf_new();\n\tASSERT_PTR_NE(p1, NULL);\n\tASSERT_INT_EQ(sshbuf_put_u32(p1, 0xffffffff), 0);\n\tASSERT_INT_EQ(sshbuf_put(p1, x, sizeof(x)), 0);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), sizeof(x) + 4);\n\tr = sshbuf_get_cstring(p1, &s2, &s);\n\tASSERT_INT_EQ(r, SSH_ERR_STRING_TOO_LARGE);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), sizeof(x) + 4);\n\tsshbuf_free(p1);\n\tTEST_DONE();\n\n\tTEST_START(\"sshbuf_get_cstring embedded \\\\0\");\n\tp1 = sshbuf_new();\n\tASSERT_PTR_NE(p1, NULL);\n\tASSERT_INT_EQ(sshbuf_put_u32(p1, sizeof(x)), 0);\n\tASSERT_INT_EQ(sshbuf_put(p1, x, sizeof(x)), 0);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), sizeof(x) + 4);\n\tr = sshbuf_get_cstring(p1, &s2, NULL);\n\tASSERT_INT_EQ(r, SSH_ERR_INVALID_FORMAT);\n\tsshbuf_free(p1);\n\tTEST_DONE();\n\n\tTEST_START(\"sshbuf_get_cstring trailing \\\\0\");\n\tp1 = sshbuf_new();\n\tASSERT_PTR_NE(p1, NULL);\n\tASSERT_INT_EQ(sshbuf_put_u32(p1, sizeof(x) - 1), 0);\n\tASSERT_INT_EQ(sshbuf_put(p1, x, sizeof(x) - 1), 0);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), sizeof(x) + 4 - 1);\n\tASSERT_INT_EQ(sshbuf_get_cstring(p1, &s2, &s), 0);\n\tASSERT_SIZE_T_EQ(s, sizeof(x) - 1);\n\tASSERT_MEM_EQ(s2, x, s);\n\tfree(s2);\n\tsshbuf_free(p1);\n\tTEST_DONE();\n\n\tTEST_START(\"sshbuf_put_string\");\n\tp1 = sshbuf_new();\n\tASSERT_PTR_NE(p1, NULL);\n\tASSERT_INT_EQ(sshbuf_put_string(p1, x, sizeof(x)), 0);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), sizeof(x) + 4);\n\tASSERT_U32_EQ(PEEK_U32(sshbuf_ptr(p1)), sizeof(x));\n\tASSERT_MEM_EQ(sshbuf_ptr(p1) + 4, x, sizeof(x));\n\tsshbuf_free(p1);\n\tTEST_DONE();\n\n\tTEST_START(\"sshbuf_put_string limited\");\n\tp1 = sshbuf_new();\n\tASSERT_PTR_NE(p1, NULL);\n\tASSERT_INT_EQ(sshbuf_set_max_size(p1, sizeof(x) + 4 - 1), 0);\n\tr = sshbuf_put_string(p1, x, sizeof(x));\n\tASSERT_INT_EQ(r, SSH_ERR_NO_BUFFER_SPACE);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), 0);\n\tsshbuf_free(p1);\n\tTEST_DONE();\n\n\tTEST_START(\"sshbuf_put_string giant\");\n\tp1 = sshbuf_new();\n\tASSERT_PTR_NE(p1, NULL);\n\tr = sshbuf_put_string(p1, (void *)0x01, 0xfffffffc);\n\tASSERT_INT_EQ(r, SSH_ERR_NO_BUFFER_SPACE);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), 0);\n\tsshbuf_free(p1);\n\tTEST_DONE();\n\n\tTEST_START(\"sshbuf_putf\");\n\tp1 = sshbuf_new();\n\tASSERT_PTR_NE(p1, NULL);\n\tr = sshbuf_putf(p1, \"%s %d %x\", \"hello\", 23, 0x5f);\n\tASSERT_INT_EQ(r, 0);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), 11);\n\tASSERT_MEM_EQ(sshbuf_ptr(p1), \"hello 23 5f\", 11);\n\tsshbuf_free(p1);\n\tTEST_DONE();\n\n\tTEST_START(\"sshbuf_putb\");\n\tp1 = sshbuf_new();\n\tASSERT_PTR_NE(p1, NULL);\n\tp2 = sshbuf_new();\n\tASSERT_PTR_NE(p2, NULL);\n\tASSERT_INT_EQ(sshbuf_put(p1, \"blahblahblah\", 12), 0);\n\tASSERT_INT_EQ(sshbuf_putb(p2, p1), 0);\n\tsshbuf_free(p1);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p2), 12);\n\tASSERT_MEM_EQ(sshbuf_ptr(p2), \"blahblahblah\", 12);\n\tsshbuf_free(p2);\n\tTEST_DONE();\n\n\tTEST_START(\"sshbuf_put_bignum2_bytes empty buf\");\n\tp1 = sshbuf_new();\n\tASSERT_PTR_NE(p1, NULL);\n\tASSERT_INT_EQ(sshbuf_put_bignum2_bytes(p1, NULL, 0), 0);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), sizeof(bn_exp1));\n\tASSERT_MEM_EQ(sshbuf_ptr(p1), bn_exp1, sizeof(bn_exp1));\n\tsshbuf_free(p1);\n\tTEST_DONE();\n\n\tTEST_START(\"sshbuf_put_bignum2_bytes all zeroes\");\n\tp1 = sshbuf_new();\n\tASSERT_PTR_NE(p1, NULL);\n\tASSERT_INT_EQ(sshbuf_put_bignum2_bytes(p1, bn1, sizeof(bn1)), 0);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), sizeof(bn_exp1));\n\tASSERT_MEM_EQ(sshbuf_ptr(p1), bn_exp1, sizeof(bn_exp1));\n\tsshbuf_free(p1);\n\tTEST_DONE();\n\n\tTEST_START(\"sshbuf_put_bignum2_bytes simple\");\n\tp1 = sshbuf_new();\n\tASSERT_PTR_NE(p1, NULL);\n\tASSERT_INT_EQ(sshbuf_put_bignum2_bytes(p1, bn2+2, sizeof(bn2)-2), 0);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), sizeof(bn_exp2));\n\tASSERT_MEM_EQ(sshbuf_ptr(p1), bn_exp2, sizeof(bn_exp2));\n\tsshbuf_free(p1);\n\tTEST_DONE();\n\n\tTEST_START(\"sshbuf_put_bignum2_bytes leading zero\");\n\tp1 = sshbuf_new();\n\tASSERT_PTR_NE(p1, NULL);\n\tASSERT_INT_EQ(sshbuf_put_bignum2_bytes(p1, bn2, sizeof(bn2)), 0);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), sizeof(bn_exp2));\n\tASSERT_MEM_EQ(sshbuf_ptr(p1), bn_exp2, sizeof(bn_exp2));\n\tsshbuf_free(p1);\n\tTEST_DONE();\n\n\tTEST_START(\"sshbuf_put_bignum2_bytes neg\");\n\tp1 = sshbuf_new();\n\tASSERT_PTR_NE(p1, NULL);\n\tASSERT_INT_EQ(sshbuf_put_bignum2_bytes(p1, bn3+1, sizeof(bn3)-1), 0);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), sizeof(bn_exp3));\n\tASSERT_MEM_EQ(sshbuf_ptr(p1), bn_exp3, sizeof(bn_exp3));\n\tsshbuf_free(p1);\n\tTEST_DONE();\n\n\tTEST_START(\"sshbuf_put_bignum2_bytes neg and leading zero\");\n\tp1 = sshbuf_new();\n\tASSERT_PTR_NE(p1, NULL);\n\tASSERT_INT_EQ(sshbuf_put_bignum2_bytes(p1, bn3, sizeof(bn3)), 0);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), sizeof(bn_exp3));\n\tASSERT_MEM_EQ(sshbuf_ptr(p1), bn_exp3, sizeof(bn_exp3));\n\tsshbuf_free(p1);\n\tTEST_DONE();\n\n\tTEST_START(\"sshbuf_peek_u64\");\n\tp1 = sshbuf_new();\n\tASSERT_PTR_NE(p1, NULL);\n\tASSERT_INT_EQ(sshbuf_put(p1, x, sizeof(x)), 0);\n\tASSERT_INT_EQ(sshbuf_peek_u64(p1, 0, &v64), 0);\n\tASSERT_U64_EQ(v64, 0x1122334455667788ULL);\n\tASSERT_INT_EQ(sshbuf_peek_u64(p1, 2, &v64), 0);\n\tASSERT_U64_EQ(v64, 0x3344556677880099ULL);\n\tASSERT_INT_EQ(sshbuf_peek_u64(p1, 3, &v64), SSH_ERR_MESSAGE_INCOMPLETE);\n\tASSERT_INT_EQ(sshbuf_peek_u64(p1, sizeof(x), &v64),\n\t    SSH_ERR_MESSAGE_INCOMPLETE);\n\tASSERT_INT_EQ(sshbuf_peek_u64(p1, 1000, &v64),\n\t    SSH_ERR_MESSAGE_INCOMPLETE);\n\tsshbuf_free(p1);\n\tTEST_DONE();\n\n\tTEST_START(\"sshbuf_peek_u32\");\n\tp1 = sshbuf_new();\n\tASSERT_PTR_NE(p1, NULL);\n\tASSERT_INT_EQ(sshbuf_put(p1, x, sizeof(x)), 0);\n\tASSERT_INT_EQ(sshbuf_peek_u32(p1, 0, &v32), 0);\n\tASSERT_U32_EQ(v32, 0x11223344);\n\tASSERT_INT_EQ(sshbuf_peek_u32(p1, 6, &v32), 0);\n\tASSERT_U32_EQ(v32, 0x77880099);\n\tASSERT_INT_EQ(sshbuf_peek_u32(p1, 7, &v32), SSH_ERR_MESSAGE_INCOMPLETE);\n\tASSERT_INT_EQ(sshbuf_peek_u32(p1, sizeof(x), &v32),\n\t    SSH_ERR_MESSAGE_INCOMPLETE);\n\tASSERT_INT_EQ(sshbuf_peek_u32(p1, 1000, &v32),\n\t    SSH_ERR_MESSAGE_INCOMPLETE);\n\tsshbuf_free(p1);\n\tTEST_DONE();\n\n\tTEST_START(\"sshbuf_peek_u16\");\n\tp1 = sshbuf_new();\n\tASSERT_PTR_NE(p1, NULL);\n\tASSERT_INT_EQ(sshbuf_put(p1, x, sizeof(x)), 0);\n\tASSERT_INT_EQ(sshbuf_peek_u16(p1, 0, &v16), 0);\n\tASSERT_U16_EQ(v16, 0x1122);\n\tASSERT_INT_EQ(sshbuf_peek_u16(p1, 8, &v16), 0);\n\tASSERT_U16_EQ(v16, 0x99);\n\tASSERT_INT_EQ(sshbuf_peek_u16(p1, 9, &v16), SSH_ERR_MESSAGE_INCOMPLETE);\n\tASSERT_INT_EQ(sshbuf_peek_u16(p1, sizeof(x), &v16),\n\t    SSH_ERR_MESSAGE_INCOMPLETE);\n\tASSERT_INT_EQ(sshbuf_peek_u16(p1, 1000, &v16),\n\t    SSH_ERR_MESSAGE_INCOMPLETE);\n\tsshbuf_free(p1);\n\tTEST_DONE();\n\n\tTEST_START(\"sshbuf_peek_u8\");\n\tp1 = sshbuf_new();\n\tASSERT_PTR_NE(p1, NULL);\n\tASSERT_INT_EQ(sshbuf_put(p1, x, sizeof(x)), 0);\n\tASSERT_INT_EQ(sshbuf_peek_u8(p1, 0, &v8), 0);\n\tASSERT_U8_EQ(v8, 0x11);\n\tASSERT_INT_EQ(sshbuf_peek_u8(p1, 9, &v8), 0);\n\tASSERT_U8_EQ(v8, 0x99);\n\tASSERT_INT_EQ(sshbuf_peek_u8(p1, sizeof(x), &v8),\n\t    SSH_ERR_MESSAGE_INCOMPLETE);\n\tASSERT_INT_EQ(sshbuf_peek_u8(p1, 1000, &v8),\n\t    SSH_ERR_MESSAGE_INCOMPLETE);\n\tsshbuf_free(p1);\n\tTEST_DONE();\n\n\tTEST_START(\"sshbuf_poke_u64\");\n\tp1 = sshbuf_new();\n\tASSERT_PTR_NE(p1, NULL);\n\tASSERT_INT_EQ(sshbuf_reserve(p1, 10, NULL), 0);\n\t \n\tASSERT_INT_EQ(sshbuf_poke_u64(p1, 0, 0xa1b2c3d4e5f60718ULL), 0);\n\ts2 = sshbuf_dtob16(p1);\n\tASSERT_PTR_NE(s2, NULL);\n\tASSERT_STRING_EQ(s2, \"a1b2c3d4e5f607180000\");\n\tfree(s2);\n\tsshbuf_reset(p1);\n\tASSERT_INT_EQ(sshbuf_reserve(p1, 10, NULL), 0);\n\t \n\tASSERT_INT_EQ(sshbuf_poke_u64(p1, 2, 0xa1b2c3d4e5f60718ULL), 0);\n\ts2 = sshbuf_dtob16(p1);\n\tASSERT_PTR_NE(s2, NULL);\n\tASSERT_STRING_EQ(s2, \"0000a1b2c3d4e5f60718\");\n\tfree(s2);\n\tsshbuf_reset(p1);\n\tASSERT_INT_EQ(sshbuf_reserve(p1, 10, NULL), 0);\n\t \n\tASSERT_INT_EQ(sshbuf_poke_u64(p1, 3, 0xa1b2c3d4e5f60718ULL),\n\t    SSH_ERR_NO_BUFFER_SPACE);\n\tASSERT_INT_EQ(sshbuf_poke_u64(p1, 10, 0xa1b2c3d4e5f60718ULL),\n\t    SSH_ERR_NO_BUFFER_SPACE);\n\tASSERT_INT_EQ(sshbuf_poke_u64(p1, 1000, 0xa1b2c3d4e5f60718ULL),\n\t    SSH_ERR_NO_BUFFER_SPACE);\n\t \n\ts2 = sshbuf_dtob16(p1);\n\tASSERT_PTR_NE(s2, NULL);\n\tASSERT_STRING_EQ(s2, \"00000000000000000000\");\n\tsshbuf_free(p1);\n\tTEST_DONE();\n\n\tTEST_START(\"sshbuf_poke_u32\");\n\tp1 = sshbuf_new();\n\tASSERT_PTR_NE(p1, NULL);\n\tASSERT_INT_EQ(sshbuf_reserve(p1, 10, NULL), 0);\n\t \n\tASSERT_INT_EQ(sshbuf_poke_u32(p1, 0, 0xa1b2c3d4), 0);\n\ts2 = sshbuf_dtob16(p1);\n\tASSERT_PTR_NE(s2, NULL);\n\tASSERT_STRING_EQ(s2, \"a1b2c3d4000000000000\");\n\tfree(s2);\n\tsshbuf_reset(p1);\n\tASSERT_INT_EQ(sshbuf_reserve(p1, 10, NULL), 0);\n\t \n\tASSERT_INT_EQ(sshbuf_poke_u32(p1, 6, 0xa1b2c3d4), 0);\n\ts2 = sshbuf_dtob16(p1);\n\tASSERT_PTR_NE(s2, NULL);\n\tASSERT_STRING_EQ(s2, \"000000000000a1b2c3d4\");\n\tfree(s2);\n\tsshbuf_reset(p1);\n\tASSERT_INT_EQ(sshbuf_reserve(p1, 10, NULL), 0);\n\t \n\tASSERT_INT_EQ(sshbuf_poke_u32(p1, 7, 0xa1b2c3d4),\n\t    SSH_ERR_NO_BUFFER_SPACE);\n\tASSERT_INT_EQ(sshbuf_poke_u32(p1, 10, 0xa1b2c3d4),\n\t    SSH_ERR_NO_BUFFER_SPACE);\n\tASSERT_INT_EQ(sshbuf_poke_u32(p1, 1000, 0xa1b2c3d4),\n\t    SSH_ERR_NO_BUFFER_SPACE);\n\t \n\ts2 = sshbuf_dtob16(p1);\n\tASSERT_PTR_NE(s2, NULL);\n\tASSERT_STRING_EQ(s2, \"00000000000000000000\");\n\tsshbuf_free(p1);\n\tTEST_DONE();\n\n\tTEST_START(\"sshbuf_poke_u16\");\n\tp1 = sshbuf_new();\n\tASSERT_PTR_NE(p1, NULL);\n\tASSERT_INT_EQ(sshbuf_reserve(p1, 10, NULL), 0);\n\t \n\tASSERT_INT_EQ(sshbuf_poke_u16(p1, 0, 0xa1b2), 0);\n\ts2 = sshbuf_dtob16(p1);\n\tASSERT_PTR_NE(s2, NULL);\n\tASSERT_STRING_EQ(s2, \"a1b20000000000000000\");\n\tfree(s2);\n\tsshbuf_reset(p1);\n\tASSERT_INT_EQ(sshbuf_reserve(p1, 10, NULL), 0);\n\t \n\tASSERT_INT_EQ(sshbuf_poke_u16(p1, 8, 0xa1b2), 0);\n\ts2 = sshbuf_dtob16(p1);\n\tASSERT_PTR_NE(s2, NULL);\n\tASSERT_STRING_EQ(s2, \"0000000000000000a1b2\");\n\tfree(s2);\n\tsshbuf_reset(p1);\n\tASSERT_INT_EQ(sshbuf_reserve(p1, 10, NULL), 0);\n\t \n\tASSERT_INT_EQ(sshbuf_poke_u16(p1, 9, 0xa1b2),\n\t    SSH_ERR_NO_BUFFER_SPACE);\n\tASSERT_INT_EQ(sshbuf_poke_u16(p1, 10, 0xa1b2),\n\t    SSH_ERR_NO_BUFFER_SPACE);\n\tASSERT_INT_EQ(sshbuf_poke_u16(p1, 1000, 0xa1b2),\n\t    SSH_ERR_NO_BUFFER_SPACE);\n\t \n\ts2 = sshbuf_dtob16(p1);\n\tASSERT_PTR_NE(s2, NULL);\n\tASSERT_STRING_EQ(s2, \"00000000000000000000\");\n\tsshbuf_free(p1);\n\tTEST_DONE();\n\n\tTEST_START(\"sshbuf_poke_u8\");\n\tp1 = sshbuf_new();\n\tASSERT_PTR_NE(p1, NULL);\n\tASSERT_INT_EQ(sshbuf_reserve(p1, 10, NULL), 0);\n\t \n\tASSERT_INT_EQ(sshbuf_poke_u8(p1, 0, 0xa1), 0);\n\ts2 = sshbuf_dtob16(p1);\n\tASSERT_PTR_NE(s2, NULL);\n\tASSERT_STRING_EQ(s2, \"a1000000000000000000\");\n\tfree(s2);\n\tsshbuf_reset(p1);\n\tASSERT_INT_EQ(sshbuf_reserve(p1, 10, NULL), 0);\n\t \n\tASSERT_INT_EQ(sshbuf_poke_u8(p1, 9, 0xa1), 0);\n\ts2 = sshbuf_dtob16(p1);\n\tASSERT_PTR_NE(s2, NULL);\n\tASSERT_STRING_EQ(s2, \"000000000000000000a1\");\n\tfree(s2);\n\tsshbuf_reset(p1);\n\tASSERT_INT_EQ(sshbuf_reserve(p1, 10, NULL), 0);\n\t \n\tASSERT_INT_EQ(sshbuf_poke_u8(p1, 10, 0xa1), SSH_ERR_NO_BUFFER_SPACE);\n\tASSERT_INT_EQ(sshbuf_poke_u8(p1, 1000, 0xa1), SSH_ERR_NO_BUFFER_SPACE);\n\t \n\ts2 = sshbuf_dtob16(p1);\n\tASSERT_PTR_NE(s2, NULL);\n\tASSERT_STRING_EQ(s2, \"00000000000000000000\");\n\tsshbuf_free(p1);\n\tTEST_DONE();\n\n\tTEST_START(\"sshbuf_poke\");\n\tp1 = sshbuf_new();\n\tASSERT_PTR_NE(p1, NULL);\n\tASSERT_INT_EQ(sshbuf_reserve(p1, 10, NULL), 0);\n\t \n\tASSERT_INT_EQ(sshbuf_poke(p1, 0, \"hello!\", 6), 0);\n\ts2 = sshbuf_dtob16(p1);\n\tASSERT_PTR_NE(s2, NULL);\n\tASSERT_STRING_EQ(s2, \"68656c6c6f2100000000\");\n\tfree(s2);\n\tsshbuf_reset(p1);\n\tASSERT_INT_EQ(sshbuf_reserve(p1, 10, NULL), 0);\n\t \n\tASSERT_INT_EQ(sshbuf_poke(p1, 4, \"hello!\", 6), 0);\n\ts2 = sshbuf_dtob16(p1);\n\tASSERT_PTR_NE(s2, NULL);\n\tASSERT_STRING_EQ(s2, \"0000000068656c6c6f21\");\n\tfree(s2);\n\tsshbuf_reset(p1);\n\tASSERT_INT_EQ(sshbuf_reserve(p1, 10, NULL), 0);\n\t \n\tASSERT_INT_EQ(sshbuf_poke(p1, 7, \"hello!\", 6),\n\t    SSH_ERR_NO_BUFFER_SPACE);\n\tASSERT_INT_EQ(sshbuf_poke(p1, 10, \"hello!\", 6),\n\t    SSH_ERR_NO_BUFFER_SPACE);\n\tASSERT_INT_EQ(sshbuf_poke(p1, 1000, \"hello!\", 6),\n\t    SSH_ERR_NO_BUFFER_SPACE);\n\t \n\ts2 = sshbuf_dtob16(p1);\n\tASSERT_PTR_NE(s2, NULL);\n\tASSERT_STRING_EQ(s2, \"00000000000000000000\");\n\tsshbuf_free(p1);\n\tTEST_DONE();\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}