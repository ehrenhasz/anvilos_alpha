{
  "module_name": "mktestdata.sh",
  "hash_id": "cb457bbe2df4f1d4ad7e99783ae4f6d03a29da923251648bfeebdf4a53da2348",
  "original_prompt": "Ingested from openssh-9.6p1/regress/unittests/hostkeys/mktestdata.sh",
  "human_readable_source": "#!/bin/sh\n# $OpenBSD: mktestdata.sh,v 1.2 2017/04/30 23:33:48 djm Exp $\n\nset -ex\n\ncd testdata\n\nrm -f rsa* dsa* ecdsa* ed25519*\nrm -f known_hosts*\n\ngen_all() {\n\t_n=$1\n\t_ecdsa_bits=256\n\ttest \"x$_n\" = \"x1\" && _ecdsa_bits=384\n\ttest \"x$_n\" = \"x2\" && _ecdsa_bits=521\n\tssh-keygen -qt rsa -b 1024 -C \"RSA #$_n\" -N \"\" -f rsa_$_n\n\tssh-keygen -qt dsa -b 1024 -C \"DSA #$_n\" -N \"\" -f dsa_$_n\n\tssh-keygen -qt ecdsa -b $_ecdsa_bits -C \"ECDSA #$_n\" -N \"\" -f ecdsa_$_n\n\tssh-keygen -qt ed25519 -C \"ED25519 #$_n\" -N \"\" -f ed25519_$_n\n\t# Don't need private keys\n\trm -f rsa_$_n dsa_$_n ecdsa_$_n ed25519_$_n\n}\n\nhentries() {\n\t_preamble=$1\n\t_kspec=$2\n\tfor k in `ls -1 $_kspec | sort` ; do\n\t\tprintf \"$_preamble \"\n\t\tcat $k\n\tdone\n\techo\n}\n\ngen_all 1\ngen_all 2\ngen_all 3\ngen_all 4\ngen_all 5\ngen_all 6\n\n# A section of known_hosts with hashed hostnames.\n(\n\thentries \"sisyphus.example.com\" \"*_5.pub\"\n\thentries \"prometheus.example.com,192.0.2.1,2001:db8::1\" \"*_6.pub\"\n) > known_hosts_hash_frag\nssh-keygen -Hf known_hosts_hash_frag\nrm -f known_hosts_hash_frag.old\n\n# Populated known_hosts, including comments, hashed names and invalid lines\n(\n\techo \"# Plain host keys, plain host names\"\n\thentries \"sisyphus.example.com\" \"*_1.pub\"\n\n\techo \"# Plain host keys, hostnames + addresses\"\n\thentries \"prometheus.example.com,192.0.2.1,2001:db8::1\" \"*_2.pub\"\n\n\techo \"# Some hosts with wildcard names / IPs\"\n\thentries \"*.example.com,192.0.2.*,2001:*\" \"*_3.pub\"\n\n\techo \"# Hashed hostname and address entries\"\n\tcat known_hosts_hash_frag\n\trm -f known_hosts_hash_frag\n\techo\n\n\techo \"# Revoked and CA keys\"\n\tprintf \"@revoked sisyphus.example.com \" ; cat ed25519_4.pub\n\tprintf \"@cert-authority prometheus.example.com \" ; cat ecdsa_4.pub\n\tprintf \"@cert-authority *.example.com \" ; cat dsa_4.pub\n\n\tprintf \"\\n\"\n\techo \"# Some invalid lines\"\n\t# Invalid marker\n\tprintf \"@what sisyphus.example.com \" ; cat dsa_1.pub\n\t# Key missing\n\techo \"sisyphus.example.com      \"\n\t# Key blob missing\n\techo \"prometheus.example.com ssh-ed25519 \"\n\t# Key blob truncated\n\techo \"sisyphus.example.com ssh-dsa AAAATgAAAAdz\"\n\t# Invalid type\n\techo \"sisyphus.example.com ssh-XXX AAAATgAAAAdzc2gtWFhYAAAAP0ZVQ0tPRkZGVUNLT0ZGRlVDS09GRkZVQ0tPRkZGVUNLT0ZGRlVDS09GRkZVQ0tPRkZGVUNLT0ZGRlVDS09GRg==\"\n\t# Type mismatch with blob\n\techo \"prometheus.example.com ssh-rsa AAAATgAAAAdzc2gtWFhYAAAAP0ZVQ0tPRkZGVUNLT0ZGRlVDS09GRkZVQ0tPRkZGVUNLT0ZGRlVDS09GRkZVQ0tPRkZGVUNLT0ZGRlVDS09GRg==\"\n) > known_hosts\n\necho OK\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}