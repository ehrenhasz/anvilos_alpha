{
  "module_name": "dropbear-kex.sh",
  "hash_id": "5b423800802045ec1b93e0428b204c4570ba9d9d7dcd7704220fc67814b0516e",
  "original_prompt": "Ingested from openssh-9.6p1/regress/dropbear-kex.sh",
  "human_readable_source": "#\t$OpenBSD: dropbear-kex.sh,v 1.1 2023/10/20 06:56:45 dtucker Exp $\n#\tPlaced in the Public Domain.\n\ntid=\"dropbear kex\"\n\nif test \"x$REGRESS_INTEROP_DROPBEAR\" != \"xyes\" ; then\n\tskip \"dropbear interop tests not enabled\"\nfi\n\ncat >>$OBJ/sshd_proxy <<EOD\nPubkeyAcceptedAlgorithms +ssh-rsa,ssh-dss\nHostkeyAlgorithms +ssh-rsa,ssh-dss\nEOD\ncp $OBJ/sshd_proxy $OBJ/sshd_proxy.bak\n\nkex=\"curve25519-sha256 curve25519-sha256@libssh.org\n    diffie-hellman-group14-sha256 diffie-hellman-group14-sha1\"\n\nfor k in $kex; do\n\tverbose \"$tid: kex $k\"\n\trm -f ${COPY}\n\t# dbclient doesn't have switch for kex, so force in server\n\t(cat $OBJ/sshd_proxy.bak; echo \"KexAlgorithms $k\") >$OBJ/sshd_proxy\n\tenv HOME=$OBJ dbclient -y -i $OBJ/.dropbear/id_rsa 2>$OBJ/dbclient.log \\\n\t    -J \"$OBJ/ssh_proxy.sh\" somehost cat ${DATA} > ${COPY}\n\tif [ $? -ne 0 ]; then\n\t\tfail \"ssh cat $DATA failed\"\n\tfi\n\tcmp ${DATA} ${COPY}\t\t|| fail \"corrupted copy\"\ndone\nrm -f ${COPY}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}