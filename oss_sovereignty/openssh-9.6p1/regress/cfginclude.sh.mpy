{
  "module_name": "cfginclude.sh",
  "hash_id": "2503dd0f45a5b8a60e8aec9fa6dab7bac01d5a1d91063457bffb95c826ab350e",
  "original_prompt": "Ingested from openssh-9.6p1/regress/cfginclude.sh",
  "human_readable_source": "#\t$OpenBSD: cfginclude.sh,v 1.3 2021/06/08 06:52:43 djm Exp $\n#\tPlaced in the Public Domain.\n\ntid=\"config include\"\n\n# to appease StrictModes\numask 022\n\ncat > $OBJ/ssh_config.i << _EOF\nMatch host a\n\tHostname aa\n\nMatch host b # comment\n\tHostname bb\n\tInclude $OBJ/ssh_config.i.*\n\nMatch host c\n\tInclude $OBJ/ssh_config.i.*\n\tHostname cc\n\nMatch host m\n\tInclude $OBJ/ssh_config.i.* # comment\n\nHost d\n\tHostname dd # comment\n\nHost e\n\tHostname ee\n\tInclude $OBJ/ssh_config.i.*\n\nHost f\n\tInclude $OBJ/ssh_config.i.*\n\tHostname ff\n\nHost n\n\tInclude $OBJ/ssh_config.i.*\n_EOF\n\ncat > $OBJ/ssh_config.i.0 << _EOF\nMatch host xxxxxx\n_EOF\n\ncat > $OBJ/ssh_config.i.1 << _EOF\nMatch host a\n\tHostname aaa\n\nMatch host b\n\tHostname bbb\n\nMatch host c # comment\n\tHostname ccc\n\nHost d # comment\n\tHostname ddd\n\nHost e\n\tHostname eee\n\nHost f\n\tHostname fff # comment\n_EOF\n\ncat > $OBJ/ssh_config.i.2 << _EOF\nMatch host a\n\tHostname aaaa\n\nMatch host b\n\tHostname bbbb\n\nMatch host c\n\tHostname cccc\n\nHost d\n\tHostname dddd\n\nHost e\n\tHostname eeee\n\nHost f\n\tHostname ffff\n\nMatch all\n\tHostname xxxx\n_EOF\n\ntrial() {\n\t_host=\"$1\"\n\t_exp=\"$2\"\n\t${REAL_SSH} -F $OBJ/ssh_config.i -G \"$_host\" > $OBJ/ssh_config.out ||\n\t\tfatal \"ssh config parse failed\"\n\t_got=`grep -i '^hostname ' $OBJ/ssh_config.out | awk '{print $2}'`\n\tif test \"x$_exp\" != \"x$_got\" ; then\n\t\tfail \"host $_host include fail: expected $_exp got $_got\"\n\tfi\n}\n\ntrial a aa\ntrial b bb\ntrial c ccc\ntrial d dd\ntrial e ee\ntrial f fff\ntrial m xxxx\ntrial n xxxx\ntrial x x\n\n# Prepare an included config with an error.\n\ncat > $OBJ/ssh_config.i.3 << _EOF\nHostname xxxx\n\tJunk\n_EOF\n\n${REAL_SSH} -F $OBJ/ssh_config.i -G a 2>/dev/null && \\\n\tfail \"ssh include allowed invalid config\"\n\n${REAL_SSH} -F $OBJ/ssh_config.i -G x 2>/dev/null && \\\n\tfail \"ssh include allowed invalid config\"\n\nrm -f $OBJ/ssh_config.i.*\n\n# Ensure that a missing include is not fatal.\ncat > $OBJ/ssh_config.i << _EOF\nInclude $OBJ/ssh_config.i.*\nHostname aa\n_EOF\n\ntrial a aa\n\n# Ensure that Match/Host in an included config does not affect parent.\ncat > $OBJ/ssh_config.i.x << _EOF\nMatch host x\n_EOF\n\ntrial a aa\n\ncat > $OBJ/ssh_config.i.x << _EOF\nHost x\n_EOF\n\ntrial a aa\n\n# cleanup\nrm -f $OBJ/ssh_config.i $OBJ/ssh_config.i.* $OBJ/ssh_config.out\n#\t$OpenBSD: cfginclude.sh,v 1.3 2021/06/08 06:52:43 djm Exp $\n#\tPlaced in the Public Domain.\n\ntid=\"config include\"\n\ncat > $OBJ/ssh_config.i << _EOF\nMatch host a\n\tHostname aa\n\nMatch host b\n\tHostname bb\n\tInclude $OBJ/ssh_config.i.*\n\nMatch host c\n\tInclude $OBJ/ssh_config.i.*\n\tHostname cc\n\nMatch host m\n\tInclude $OBJ/ssh_config.i.*\n\nHost d\n\tHostname dd\n\nHost e\n\tHostname ee\n\tInclude $OBJ/ssh_config.i.*\n\nHost f\n\tInclude $OBJ/ssh_config.i.*\n\tHostname ff\n\nHost n\n\tInclude $OBJ/ssh_config.i.*\n_EOF\n\ncat > $OBJ/ssh_config.i.0 << _EOF\nMatch host xxxxxx\n_EOF\n\ncat > $OBJ/ssh_config.i.1 << _EOF\nMatch host a\n\tHostname aaa\n\nMatch host b # comment\n\tHostname bbb\n\nMatch host c\n\tHostname ccc # comment\n\nHost d\n\tHostname ddd\n\nHost e\n\tHostname eee\n\nHost f\n\tHostname fff\n_EOF\n\ncat > $OBJ/ssh_config.i.2 << _EOF\nMatch host a\n\tHostname aaaa\n\nMatch host b\n\tHostname bbbb\n\nMatch host c\n\tHostname cccc\n\nHost d\n\tHostname dddd\n\nHost e\n\tHostname eeee\n\nHost f\n\tHostname ffff\n\nMatch all # comment\n\tHostname xxxx # comment\n_EOF\n\ntrial() {\n\t_host=\"$1\"\n\t_exp=\"$2\"\n\t${REAL_SSH} -F $OBJ/ssh_config.i -G \"$_host\" > $OBJ/ssh_config.out ||\n\t\tfatal \"ssh config parse failed\"\n\t_got=`grep -i '^hostname ' $OBJ/ssh_config.out | awk '{print $2}'`\n\tif test \"x$_exp\" != \"x$_got\" ; then\n\t\tfail \"host $_host include fail: expected $_exp got $_got\"\n\tfi\n}\n\ntrial a aa\ntrial b bb\ntrial c ccc\ntrial d dd\ntrial e ee\ntrial f fff\ntrial m xxxx\ntrial n xxxx\ntrial x x\n\n# Prepare an included config with an error.\n\ncat > $OBJ/ssh_config.i.3 << _EOF\nHostname xxxx\n\tJunk\n_EOF\n\n${REAL_SSH} -F $OBJ/ssh_config.i -G a 2>/dev/null && \\\n\tfail \"ssh include allowed invalid config\"\n\n${REAL_SSH} -F $OBJ/ssh_config.i -G x 2>/dev/null && \\\n\tfail \"ssh include allowed invalid config\"\n\nrm -f $OBJ/ssh_config.i.*\n\n# Ensure that a missing include is not fatal.\ncat > $OBJ/ssh_config.i << _EOF\nInclude $OBJ/ssh_config.i.*\nHostname aa\n_EOF\n\ntrial a aa\n\n# Ensure that Match/Host in an included config does not affect parent.\ncat > $OBJ/ssh_config.i.x << _EOF\nMatch host x\n_EOF\n\ntrial a aa\n\ncat > $OBJ/ssh_config.i.x << _EOF\nHost x\n_EOF\n\ntrial a aa\n\n# Ensure that recursive includes are bounded.\ncat > $OBJ/ssh_config.i << _EOF\nInclude $OBJ/ssh_config.i\n_EOF\n\n${REAL_SSH} -F $OBJ/ssh_config.i -G a 2>/dev/null && \\\n\tfail \"ssh include allowed infinite recursion?\" # or hang...\n\n# cleanup\nrm -f $OBJ/ssh_config.i $OBJ/ssh_config.i.* $OBJ/ssh_config.out\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}