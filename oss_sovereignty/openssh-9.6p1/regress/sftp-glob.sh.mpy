{
  "module_name": "sftp-glob.sh",
  "hash_id": "5dac6413adfdad7593545e69ae85703bc192c557b0f7544233effae290468cce",
  "original_prompt": "Ingested from openssh-9.6p1/regress/sftp-glob.sh",
  "human_readable_source": "#\t$OpenBSD: sftp-glob.sh,v 1.4 2009/08/13 01:11:55 djm Exp $\n#\tPlaced in the Public Domain.\n\ntid=\"sftp glob\"\n\nconfig_defined FILESYSTEM_NO_BACKSLASH && nobs=\"not supported on this platform\"\n\nsftp_ls() {\n\ttarget=$1\n\terrtag=$2\n\texpected=$3\n\tunexpected=$4\n\tskip=$5\n\tif test \"x$skip\" != \"x\" ; then\n\t\tverbose \"$tid: $errtag (skipped: $skip)\"\n\t\treturn\n\tfi\n\tverbose \"$tid: $errtag\"\n\tprintf \"ls -l %s\" \"${target}\" | \\\n\t\t${SFTP} -b - -D ${SFTPSERVER} 2>/dev/null | \\\n\t\tgrep -v \"^sftp>\" > ${RESULTS}\n\tif [ $? -ne 0 ]; then\n\t\tfail \"$errtag failed\"\n\tfi\n\tif test \"x$expected\" != \"x\" ; then\n\t    if fgrep \"$expected\" ${RESULTS} >/dev/null 2>&1 ; then\n\t\t:\n\t    else\n\t\tfail \"$expected missing from $errtag results\"\n\t    fi\n\tfi\n\tif test \"x$unexpected\" != \"x\" && \\\n\t   fgrep \"$unexpected\" ${RESULTS} >/dev/null 2>&1 ; then\n\t\tfail \"$unexpected present in $errtag results\"\n\tfi\n\trm -f ${RESULTS}\n}\n\nBASE=${OBJ}/glob\nRESULTS=${OBJ}/results\nDIR=${BASE}/dir\nDATA=${DIR}/file\n\nGLOB1=\"${DIR}/g-wild*\"\nGLOB2=\"${DIR}/g-wildx\"\nQUOTE=\"${DIR}/g-quote\\\"\"\nSLASH=\"${DIR}/g-sl\\\\ash\"\nESLASH=\"${DIR}/g-slash\\\\\"\nQSLASH=\"${DIR}/g-qs\\\\\\\"\"\nSPACE=\"${DIR}/g-q space\"\n\nrm -rf ${BASE}\nmkdir -p ${DIR}\ntouch \"${DATA}\" \"${GLOB1}\" \"${GLOB2}\" \"${QUOTE}\" \"${SPACE}\"\ntest \"x$nobs\" = \"x\" && touch \"${QSLASH}\" \"${ESLASH}\" \"${SLASH}\"\n\n#       target                   message                expected     unexpected\nsftp_ls \"${DIR}/fil*\"            \"file glob\"            \"${DATA}\"    \"\"\nsftp_ls \"${BASE}/d*\"             \"dir glob\"             \"`basename ${DATA}`\" \"\"\nsftp_ls \"${DIR}/g-wild\\\"*\\\"\"     \"quoted glob\"          \"g-wild*\"    \"g-wildx\"\nsftp_ls \"${DIR}/g-wild\\*\"        \"escaped glob\"         \"g-wild*\"    \"g-wildx\"\nsftp_ls \"${DIR}/g-quote\\\\\\\"\"     \"escaped quote\"        \"g-quote\\\"\"  \"\"\nsftp_ls \"\\\"${DIR}/g-quote\\\\\\\"\\\"\" \"quoted quote\"         \"g-quote\\\"\"  \"\"\nsftp_ls \"'${DIR}/g-quote\\\"'\"     \"single-quoted quote\"  \"g-quote\\\"\"  \"\"\nsftp_ls \"${DIR}/g-q\\\\ space\"     \"escaped space\"        \"g-q space\"  \"\"\nsftp_ls \"'${DIR}/g-q space'\"     \"quoted space\"         \"g-q space\"  \"\"\nsftp_ls \"${DIR}/g-sl\\\\\\\\ash\"     \"escaped slash\"        \"g-sl\\\\ash\"  \"\" \"$nobs\"\nsftp_ls \"'${DIR}/g-sl\\\\\\\\ash'\"   \"quoted slash\"         \"g-sl\\\\ash\"  \"\" \"$nobs\"\nsftp_ls \"${DIR}/g-slash\\\\\\\\\"     \"escaped slash at EOL\" \"g-slash\\\\\"  \"\" \"$nobs\"\nsftp_ls \"'${DIR}/g-slash\\\\\\\\'\"   \"quoted slash at EOL\"  \"g-slash\\\\\"  \"\" \"$nobs\"\nsftp_ls \"${DIR}/g-qs\\\\\\\\\\\\\\\"\"    \"escaped slash+quote\"  \"g-qs\\\\\\\"\"   \"\" \"$nobs\"\nsftp_ls \"'${DIR}/g-qs\\\\\\\\\\\"'\"    \"quoted slash+quote\"   \"g-qs\\\\\\\"\"   \"\" \"$nobs\"\n\nrm -rf ${BASE}\n\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}