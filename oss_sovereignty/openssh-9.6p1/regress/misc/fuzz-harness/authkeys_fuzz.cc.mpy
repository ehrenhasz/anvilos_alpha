{
  "module_name": "authkeys_fuzz.cc",
  "hash_id": "01f566abde59335c74387c8c37f667c7f065750909d3fd9d29bf74962ae54ad3",
  "original_prompt": "Ingested from openssh-9.6p1/regress/misc/fuzz-harness/authkeys_fuzz.cc",
  "human_readable_source": "#include <stddef.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pwd.h>\n#include <unistd.h>\n\nextern \"C\" {\n\n#include \"hostfile.h\"\n#include \"auth.h\"\n#include \"auth-options.h\"\n#include \"sshkey.h\"\n\n\nconst char *pubkey = \"ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIDPQXmEVMVLmeFRyafKMVWgPDkv8/uRBTwmcEDatZzMD\"; \nconst char *certtext = \"ssh-ed25519-cert-v01@openssh.com AAAAIHNzaC1lZDI1NTE5LWNlcnQtdjAxQG9wZW5zc2guY29tAAAAIMDQjYH6XRzH3j3MW1DdjCoAfvrHfgjnVGF+sLK0pBfqAAAAIDPQXmEVMVLmeFRyafKMVWgPDkv8/uRBTwmcEDatZzMDAAAAAAAAA+sAAAABAAAAB3VseXNzZXMAAAAXAAAAB3VseXNzZXMAAAAIb2R5c3NldXMAAAAAAAAAAP//////////AAAAAAAAAIIAAAAVcGVybWl0LVgxMS1mb3J3YXJkaW5nAAAAAAAAABdwZXJtaXQtYWdlbnQtZm9yd2FyZGluZwAAAAAAAAAWcGVybWl0LXBvcnQtZm9yd2FyZGluZwAAAAAAAAAKcGVybWl0LXB0eQAAAAAAAAAOcGVybWl0LXVzZXItcmMAAAAAAAAAAAAAADMAAAALc3NoLWVkMjU1MTkAAAAgM9BeYRUxUuZ4VHJp8oxVaA8OS/z+5EFPCZwQNq1nMwMAAABTAAAAC3NzaC1lZDI1NTE5AAAAQBj0og+s09/HpwdHZbzN0twooKPDWWrxGfnP1Joy6cDnY2BCSQ7zg9vbq11kLF8H/sKOTZWAQrUZ7LlChOu9Ogw= id_ed25519.pub\";\n\n\nvoid auth_debug_add(const char *fmt,...)\n{\n}\n\nvoid\nauth_log_authopts(const char *loc, const struct sshauthopt *opts, int do_remote)\n{\n}\n\nint LLVMFuzzerTestOneInput(const uint8_t* data, size_t size)\n{\n\tchar *tmp, *o, *cp = (char *)malloc(size + 1 + strlen(pubkey) + 1);\n\tstruct sshauthopt *opts = NULL;\n\tstruct passwd *pw = getpwuid(getuid());\n\tstatic struct sshkey *key, *cert;\n\n\tif (key == NULL) {\n\t\tif ((key = sshkey_new(KEY_UNSPEC)) == NULL ||\n\t\t    (cert = sshkey_new(KEY_UNSPEC)) == NULL)\n\t\t\tabort();\n\t\tif ((o = tmp = strdup(pubkey)) == NULL ||\n\t\t    sshkey_read(key, &tmp) != 0)\n\t\t\tabort();\n\t\tfree(o);\n\t\tif ((o = tmp = strdup(certtext)) == NULL ||\n\t\t    sshkey_read(cert, &tmp) != 0)\n\t\t\tabort();\n\t\tfree(o);\n\t}\n\tif (cp == NULL || pw == NULL || key == NULL || cert == NULL)\n\t\tabort();\n\n\t\n\tfor (; size > 0 && strchr(\" \\t\\r\\n\", data[size - 1]) != NULL; size--) ;\n\n\t\n\tmemcpy(cp, data, size);\n\tcp[size] = ' ';\n\tmemcpy(cp + size + 1, pubkey, strlen(pubkey) + 1);\n\n\t\n\tif ((tmp = strdup(cp)) == NULL)\n\t\tabort();\n\t(void) auth_check_authkey_line(pw, key, tmp, \"127.0.0.1\", \"localhost\",\n\t    \"fuzz\", &opts);\n\tfree(tmp);\n\tsshauthopt_free(opts);\n\n\t\n\tif ((tmp = strdup(cp)) == NULL)\n\t\tabort();\n\t(void) auth_check_authkey_line(pw, cert, tmp, \"127.0.0.1\", \"localhost\",\n\t    \"fuzz\", &opts);\n\tfree(tmp);\n\tsshauthopt_free(opts);\n\n\tfree(cp);\n\treturn 0;\n}\n\n} \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}