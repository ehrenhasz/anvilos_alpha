{
  "module_name": "sig_fuzz.cc",
  "hash_id": "4542c7018e1c5f41154c6967d4e6314a9a7cd16d5ae9b0bce8775eb8238f0cb7",
  "original_prompt": "Ingested from openssh-9.6p1/regress/misc/fuzz-harness/sig_fuzz.cc",
  "human_readable_source": "\n\n#include <stddef.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <stdlib.h>\n#include <string.h>\n\nextern \"C\" {\n\n#include \"includes.h\"\n#include \"sshkey.h\"\n#include \"ssherr.h\"\n\nstatic struct sshkey *generate_or_die(int type, unsigned bits) {\n  int r;\n  struct sshkey *ret;\n  if ((r = sshkey_generate(type, bits, &ret)) != 0) {\n    fprintf(stderr, \"generate(%d, %u): %s\", type, bits, ssh_err(r));\n    abort();\n  }\n  return ret;\n}\n\nint LLVMFuzzerTestOneInput(const uint8_t* sig, size_t slen)\n{\n#ifdef WITH_OPENSSL\n  static struct sshkey *rsa = generate_or_die(KEY_RSA, 2048);\n  static struct sshkey *dsa = generate_or_die(KEY_DSA, 1024);\n  static struct sshkey *ecdsa256 = generate_or_die(KEY_ECDSA, 256);\n  static struct sshkey *ecdsa384 = generate_or_die(KEY_ECDSA, 384);\n  static struct sshkey *ecdsa521 = generate_or_die(KEY_ECDSA, 521);\n#endif\n  struct sshkey_sig_details *details = NULL;\n  static struct sshkey *ed25519 = generate_or_die(KEY_ED25519, 0);\n  static const char *data = \"If everyone started announcing his nose had \"\n      \"run away, I don\u2019t know how it would all end\";\n  static const size_t dlen = strlen(data);\n\n#ifdef WITH_OPENSSL\n  sshkey_verify(rsa, sig, slen, (const u_char *)data, dlen, NULL, 0, &details);\n  sshkey_sig_details_free(details);\n  details = NULL;\n  sshkey_verify(dsa, sig, slen, (const u_char *)data, dlen, NULL, 0, &details);\n  sshkey_sig_details_free(details);\n  details = NULL;\n  sshkey_verify(ecdsa256, sig, slen, (const u_char *)data, dlen, NULL, 0, &details);\n  sshkey_sig_details_free(details);\n  details = NULL;\n  sshkey_verify(ecdsa384, sig, slen, (const u_char *)data, dlen, NULL, 0, &details);\n  sshkey_sig_details_free(details);\n  details = NULL;\n  sshkey_verify(ecdsa521, sig, slen, (const u_char *)data, dlen, NULL, 0, &details);\n  sshkey_sig_details_free(details);\n  details = NULL;\n#endif\n  sshkey_verify(ed25519, sig, slen, (const u_char *)data, dlen, NULL, 0, &details);\n  sshkey_sig_details_free(details);\n  return 0;\n}\n\n} \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}