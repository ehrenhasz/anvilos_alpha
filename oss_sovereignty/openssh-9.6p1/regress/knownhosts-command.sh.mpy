{
  "module_name": "knownhosts-command.sh",
  "hash_id": "7c3fcdfcaa86f65eb62c5d298db7c25f0b01d60003498aff7cc1bc606109d09d",
  "original_prompt": "Ingested from openssh-9.6p1/regress/knownhosts-command.sh",
  "human_readable_source": "#\t$OpenBSD: knownhosts-command.sh,v 1.3 2021/08/30 01:15:45 djm Exp $\n#\tPlaced in the Public Domain.\n\ntid=\"known hosts command \"\n\nrm -f $OBJ/knownhosts_command $OBJ/ssh_proxy_khc\ncp $OBJ/ssh_proxy $OBJ/ssh_proxy_orig\n\n( grep -vi GlobalKnownHostsFile $OBJ/ssh_proxy_orig | \\\n    grep -vi UserKnownHostsFile;\n  echo \"GlobalKnownHostsFile none\" ;\n  echo \"UserKnownHostsFile none\" ;\n  echo \"KnownHostsCommand $OBJ/knownhosts_command '%t' '%K' '%u'\" ;\n) > $OBJ/ssh_proxy\n\nverbose \"simple connection\"\ncat > $OBJ/knownhosts_command << _EOF\n#!/bin/sh\ncat $OBJ/known_hosts\n_EOF\nchmod a+x $OBJ/knownhosts_command\n${SSH} -F $OBJ/ssh_proxy x true || fail \"ssh connect failed\"\n\nverbose \"no keys\"\ncat > $OBJ/knownhosts_command << _EOF\n#!/bin/sh\nexit 0\n_EOF\nchmod a+x $OBJ/knownhosts_command\n${SSH} -F $OBJ/ssh_proxy x true && fail \"ssh connect succeeded with no keys\"\n\nverbose \"bad exit status\"\ncat > $OBJ/knownhosts_command << _EOF\n#!/bin/sh\ncat $OBJ/known_hosts\nexit 1\n_EOF\nchmod a+x $OBJ/knownhosts_command\n${SSH} -F $OBJ/ssh_proxy x true && fail \"ssh connect succeeded with bad exit\"\n\nfor keytype in ${SSH_HOSTKEY_TYPES} ; do\n\talgs=$keytype\n\ttest \"x$keytype\" = \"xssh-dss\" && continue\n\ttest \"x$keytype\" = \"xssh-rsa\" && algs=ssh-rsa,rsa-sha2-256,rsa-sha2-512\n\tverbose \"keytype $keytype\"\n\tcat > $OBJ/knownhosts_command << _EOF\n#!/bin/sh\ndie() { echo \"\\$@\" 1>&2 ; exit 1; }\ntest \"x\\$1\" = \"x$keytype\" || die \"wrong keytype \\$1 (expected $keytype)\"\ntest \"x\\$3\" = \"x$LOGNAME\" || die \"wrong username \\$3 (expected $LOGNAME)\"\ngrep -- \"\\$1.*\\$2\" $OBJ/known_hosts\n_EOF\n\t${SSH} -F $OBJ/ssh_proxy -oHostKeyAlgorithms=$algs x true ||\n\t    fail \"ssh connect failed for keytype $x\"\ndone\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}