{
  "module_name": "scp-uri.sh",
  "hash_id": "46076a100c2ba586591120c3c17b4bcead2aeb3afa240f471336845d1dc115e1",
  "original_prompt": "Ingested from openssh-9.6p1/regress/scp-uri.sh",
  "human_readable_source": "#\t$OpenBSD: scp-uri.sh,v 1.5 2023/01/13 04:47:34 dtucker Exp $\n#\tPlaced in the Public Domain.\n\ntid=\"scp-uri\"\n\n#set -x\n\nCOPY2=${OBJ}/copy2\nDIR=${COPY}.dd\nDIR2=${COPY}.dd2\n\nmaybe_add_scp_path_to_sshd\n\nSRC=`dirname ${SCRIPT}`\ncp ${SRC}/scp-ssh-wrapper.sh ${OBJ}/scp-ssh-wrapper.scp\nchmod 755 ${OBJ}/scp-ssh-wrapper.scp\nexport SCP # used in scp-ssh-wrapper.scp\n\nscpclean() {\n\trm -rf ${COPY} ${COPY2} ${DIR} ${DIR2}\n\tmkdir ${DIR} ${DIR2}\n}\n\n# Remove Port and User from ssh_config, we want to rely on the URI\ncp $OBJ/ssh_config $OBJ/ssh_config.orig\negrep -v '^\t+(Port|User)\t+.*$' $OBJ/ssh_config.orig > $OBJ/ssh_config\n\nfor mode in scp sftp ; do\n\ttag=\"$tid: $mode mode\"\n\tif test $mode = scp ; then\n\t\tscpopts=\"-O -q -S ${OBJ}/scp-ssh-wrapper.scp\"\n\telse\n\t\tscpopts=\"-s -D ${SFTPSERVER}\"\n\tfi\n\tverbose \"$tag: simple copy local file to remote file\"\n\tscpclean\n\t$SCP $scpopts ${DATA} \"scp://${USER}@somehost:${PORT}/${COPY}\" || fail \"copy failed\"\n\tcmp ${DATA} ${COPY} || fail \"corrupted copy\"\n\n\tverbose \"$tag: simple copy remote file to local file\"\n\tscpclean\n\t$SCP $scpopts \"scp://${USER}@somehost:${PORT}/${DATA}\" ${COPY} || fail \"copy failed\"\n\tcmp ${DATA} ${COPY} || fail \"corrupted copy\"\n\n\tverbose \"$tag: simple copy local file to remote dir\"\n\tscpclean\n\tcp ${DATA} ${COPY}\n\t$SCP $scpopts ${COPY} \"scp://${USER}@somehost:${PORT}/${DIR}\" || fail \"copy failed\"\n\tcmp ${COPY} ${DIR}/copy || fail \"corrupted copy\"\n\n\tverbose \"$tag: simple copy remote file to local dir\"\n\tscpclean\n\tcp ${DATA} ${COPY}\n\t$SCP $scpopts \"scp://${USER}@somehost:${PORT}/${COPY}\" ${DIR} || fail \"copy failed\"\n\tcmp ${COPY} ${DIR}/copy || fail \"corrupted copy\"\n\n\tverbose \"$tag: recursive local dir to remote dir\"\n\tscpclean\n\trm -rf ${DIR2}\n\tcp ${DATA} ${DIR}/copy\n\t$SCP $scpopts -r ${DIR} \"scp://${USER}@somehost:${PORT}/${DIR2}\" || fail \"copy failed\"\n\tfor i in $(cd ${DIR} && echo *); do\n\t\tcmp ${DIR}/$i ${DIR2}/$i || fail \"corrupted copy\"\n\tdone\n\n\tverbose \"$tag: recursive remote dir to local dir\"\n\tscpclean\n\trm -rf ${DIR2}\n\tcp ${DATA} ${DIR}/copy\n\t$SCP $scpopts -r \"scp://${USER}@somehost:${PORT}/${DIR}\" ${DIR2} || fail \"copy failed\"\n\tfor i in $(cd ${DIR} && echo *); do\n\t\tcmp ${DIR}/$i ${DIR2}/$i || fail \"corrupted copy\"\n\tdone\n\n\t# TODO: scp -3\ndone\n\nscpclean\nrm -f ${OBJ}/scp-ssh-wrapper.exe\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}