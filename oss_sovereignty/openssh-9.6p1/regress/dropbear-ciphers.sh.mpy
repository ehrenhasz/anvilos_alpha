{
  "module_name": "dropbear-ciphers.sh",
  "hash_id": "c8bc4609c33cd578b22a1b51343b177d320bd0fad12b09407473f0de4e19f7a9",
  "original_prompt": "Ingested from openssh-9.6p1/regress/dropbear-ciphers.sh",
  "human_readable_source": "#\t$OpenBSD: dropbear-ciphers.sh,v 1.1 2023/10/20 06:56:45 dtucker Exp $\n#\tPlaced in the Public Domain.\n\ntid=\"dropbear ciphers\"\n\nif test \"x$REGRESS_INTEROP_DROPBEAR\" != \"xyes\" ; then\n\tskip \"dropbear interop tests not enabled\"\nfi\n\ncat >>$OBJ/sshd_proxy <<EOD\nPubkeyAcceptedAlgorithms +ssh-rsa,ssh-dss\nHostkeyAlgorithms +ssh-rsa,ssh-dss\nEOD\n\nciphers=`$DBCLIENT -c help 2>&1 | awk '/ ciphers: /{print $4}' | tr ',' ' '`\nmacs=`$DBCLIENT -m help 2>&1 | awk '/ MACs: /{print $4}' | tr ',' ' '`\nkeytype=`(cd $OBJ/.dropbear && ls id_*)`\n\nfor c in $ciphers ; do\n  for m in $macs; do\n    for kt in $keytype; do\n\tverbose \"$tid: cipher $c mac $m kt $kt\"\n\trm -f ${COPY}\n\tenv HOME=$OBJ dbclient -y -i $OBJ/.dropbear/$kt 2>$OBJ/dbclient.log \\\n\t    -c $c -m $m -J \"$OBJ/ssh_proxy.sh\" somehost cat ${DATA} > ${COPY}\n\tif [ $? -ne 0 ]; then\n\t\tfail \"ssh cat $DATA failed\"\n\tfi\n\tcmp ${DATA} ${COPY}\t\t|| fail \"corrupted copy\"\n    done\n  done\ndone\nrm -f ${COPY}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}