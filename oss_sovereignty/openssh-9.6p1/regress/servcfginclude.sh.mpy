{
  "module_name": "servcfginclude.sh",
  "hash_id": "dabd3f1091b36935f9120e9f9284d986fb88da0a29e83ab67da33a3025ca29c4",
  "original_prompt": "Ingested from openssh-9.6p1/regress/servcfginclude.sh",
  "human_readable_source": "#\tPlaced in the Public Domain.\n\ntid=\"server config include\"\n\ncat > $OBJ/sshd_config.i << _EOF\nHostKey $OBJ/host.ssh-ed25519\nMatch host a\n\tBanner /aa\n\nMatch host b\n\tBanner /bb\n\tInclude $OBJ/sshd_config.i.* # comment\n\nMatch host c\n\tInclude $OBJ/sshd_config.i.* # comment\n\tBanner /cc\n\nMatch host m\n\tInclude $OBJ/sshd_config.i.*\n\nMatch Host d\n\tBanner /dd # comment\n\nMatch Host e\n\tBanner /ee\n\tInclude $OBJ/sshd_config.i.*\n\nMatch Host f\n\tInclude $OBJ/sshd_config.i.*\n\tBanner /ff\n\nMatch Host n\n\tInclude $OBJ/sshd_config.i.*\n_EOF\n\ncat > $OBJ/sshd_config.i.0 << _EOF\nMatch host xxxxxx\n_EOF\n\ncat > $OBJ/sshd_config.i.1 << _EOF\nMatch host a\n\tBanner /aaa\n\nMatch host b\n\tBanner /bbb\n\nMatch host c\n\tBanner /ccc\n\nMatch Host d\n\tBanner /ddd\n\nMatch Host e\n\tBanner /eee\n\nMatch Host f\n\tBanner /fff\n_EOF\n\ncat > $OBJ/sshd_config.i.2 << _EOF\nMatch host a\n\tBanner /aaaa\n\nMatch host b\n\tBanner /bbbb\n\nMatch host c # comment\n\tBanner /cccc\n\nMatch Host d\n\tBanner /dddd\n\nMatch Host e\n\tBanner /eeee\n\nMatch Host f\n\tBanner /ffff\n\nMatch all\n\tBanner /xxxx\n_EOF\n\ntrial() {\n\t_host=\"$1\"\n\t_exp=\"$2\"\n\t_desc=\"$3\"\n\ttest -z \"$_desc\" && _desc=\"test match\"\n\ttrace \"$_desc host=$_host expect=$_exp\"\n\t${SUDO} ${REAL_SSHD} -f $OBJ/sshd_config.i -T \\\n\t    -C \"host=$_host,user=test,addr=127.0.0.1\" > $OBJ/sshd_config.out ||\n\t\tfatal \"ssh config parse failed: $_desc host=$_host expect=$_exp\"\n\t_got=`grep -i '^banner ' $OBJ/sshd_config.out | awk '{print $2}'`\n\tif test \"x$_exp\" != \"x$_got\" ; then\n\t\tfail \"$desc_ host $_host include fail: expected $_exp got $_got\"\n\tfi\n}\n\ntrial a /aa\ntrial b /bb\ntrial c /ccc\ntrial d /dd\ntrial e /ee\ntrial f /fff\ntrial m /xxxx\ntrial n /xxxx\ntrial x none\n\n# Prepare an included config with an error.\n\ncat > $OBJ/sshd_config.i.3 << _EOF\nBanner xxxx\n\tJunk\n_EOF\n\ntrace \"disallow invalid config host=a\"\n${SUDO} ${REAL_SSHD} -f $OBJ/sshd_config.i \\\n    -C \"host=a,user=test,addr=127.0.0.1\" 2>/dev/null && \\\n\tfail \"sshd include allowed invalid config\"\n\ntrace \"disallow invalid config host=x\"\n${SUDO} ${REAL_SSHD} -f $OBJ/sshd_config.i \\\n    -C \"host=x,user=test,addr=127.0.0.1\" 2>/dev/null && \\\n\tfail \"sshd include allowed invalid config\"\n\nrm -f $OBJ/sshd_config.i.*\n\n# Ensure that a missing include is not fatal.\ncat > $OBJ/sshd_config.i << _EOF\nHostKey $OBJ/host.ssh-ed25519\nInclude $OBJ/sshd_config.i.*\nBanner /aa\n_EOF\n\ntrial a /aa \"missing include non-fatal\"\n\n# Ensure that Match/Host in an included config does not affect parent.\ncat > $OBJ/sshd_config.i.x << _EOF\nMatch host x\n_EOF\n\ntrial a /aa \"included file does not affect match state\"\n\n# Ensure the empty include directive is not accepted\ncat > $OBJ/sshd_config.i.x << _EOF\nInclude\n_EOF\n\ntrace \"disallow invalid with no argument\"\n${SUDO} ${REAL_SSHD} -f $OBJ/sshd_config.i.x -T \\\n    -C \"host=x,user=test,addr=127.0.0.1\" 2>/dev/null && \\\n\tfail \"sshd allowed Include with no argument\"\n\n# Ensure the Include before any Match block works as expected (bug #3122)\ncat > $OBJ/sshd_config.i << _EOF\nBanner /xx\nHostKey $OBJ/host.ssh-ed25519\nInclude $OBJ/sshd_config.i.2\nMatch host a\n\tBanner /aaaa\n_EOF\ncat > $OBJ/sshd_config.i.2 << _EOF\nMatch host a\n\tBanner /aa\n_EOF\n\ntrace \"Include before match blocks\"\ntrial a /aa \"included file before match blocks is properly evaluated\"\n\n# Port in included file is correctly interpretted (bug #3169)\ncat > $OBJ/sshd_config.i << _EOF\nInclude $OBJ/sshd_config.i.2\nPort 7722\n_EOF\ncat > $OBJ/sshd_config.i.2 << _EOF\nHostKey $OBJ/host.ssh-ed25519\n_EOF\n\ntrace \"Port after included files\"\n${SUDO} ${REAL_SSHD} -f $OBJ/sshd_config.i -T \\\n    -C \"host=x,user=test,addr=127.0.0.1\" > $OBJ/sshd_config.out || \\\n\tfail \"failed to parse Port after included files\"\n_port=`grep -i '^port ' $OBJ/sshd_config.out | awk '{print $2}'`\nif test \"x7722\" != \"x$_port\" ; then\n\tfail \"The Port in included file was intertepretted wrongly. Expected 7722, got $_port\"\nfi\n\n# cleanup\nrm -f $OBJ/sshd_config.i $OBJ/sshd_config.i.* $OBJ/sshd_config.out\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}