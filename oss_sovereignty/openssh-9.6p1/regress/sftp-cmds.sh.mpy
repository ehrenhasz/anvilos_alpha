{
  "module_name": "sftp-cmds.sh",
  "hash_id": "99f7f401461729890f7071cd012fa0d1dcda5c61274e0f5766e5ff3c8e4ecb51",
  "original_prompt": "Ingested from openssh-9.6p1/regress/sftp-cmds.sh",
  "human_readable_source": "#\t$OpenBSD: sftp-cmds.sh,v 1.15 2022/03/31 03:07:33 djm Exp $\n#\tPlaced in the Public Domain.\n\n# XXX - TODO: \n# - chmod / chown / chgrp\n# - -p flag for get & put\n\ntid=\"sftp commands\"\n\n# test that these files are readable!\nfor i in `(cd /bin;echo l*)`\ndo\n\tif [ -r $i ]; then\n\t\tGLOBFILES=\"$GLOBFILES $i\"\n\tfi\ndone\n\n# Path with embedded quote\nQUOTECOPY=${COPY}\".\\\"blah\\\"\"\nQUOTECOPY_ARG=${COPY}'.\\\"blah\\\"'\n# File with spaces\nSPACECOPY=\"${COPY} this has spaces.txt\"\nSPACECOPY_ARG=\"${COPY}\\ this\\ has\\ spaces.txt\"\n# File with glob metacharacters\nGLOBMETACOPY=\"${COPY} [metachar].txt\"\n\nrm -rf ${COPY} ${COPY}.1 ${COPY}.2 ${COPY}.dd ${COPY}.dd2\nmkdir ${COPY}.dd\n\nverbose \"$tid: lls\"\n(echo \"lcd ${OBJ}\" ; echo \"lls\") | ${SFTP} -D ${SFTPSERVER} 2>&1 | \\\n\tgrep copy.dd >/dev/null 2>&1 || fail \"lls failed\"\n\nverbose \"$tid: lls w/path\"\necho \"lls ${OBJ}\" | ${SFTP} -D ${SFTPSERVER} 2>&1 | \\\n\tgrep copy.dd >/dev/null 2>&1 || fail \"lls w/path failed\"\n\nverbose \"$tid: ls\"\necho \"ls ${OBJ}\" | ${SFTP} -D ${SFTPSERVER} >/dev/null 2>&1 \\\n\t|| fail \"ls failed\"\n# XXX always successful\n\nverbose \"$tid: shell\"\necho \"!echo hi there\" | ${SFTP} -D ${SFTPSERVER} >/dev/null 2>&1 \\\n\t|| fail \"shell failed\"\n# XXX always successful\n\nverbose \"$tid: pwd\"\necho \"pwd\" | ${SFTP} -D ${SFTPSERVER} >/dev/null 2>&1 \\\n\t|| fail \"pwd failed\"\n# XXX always successful\n\nverbose \"$tid: lpwd\"\necho \"lpwd\" | ${SFTP} -D ${SFTPSERVER} >/dev/null 2>&1 \\\n\t|| fail \"lpwd failed\"\n# XXX always successful\n\nverbose \"$tid: quit\"\necho \"quit\" | ${SFTP} -D ${SFTPSERVER} >/dev/null 2>&1 \\\n\t|| fail \"quit failed\"\n# XXX always successful\n\nverbose \"$tid: help\"\necho \"help\" | ${SFTP} -D ${SFTPSERVER} >/dev/null 2>&1 \\\n\t|| fail \"help failed\"\n# XXX always successful\n\nrm -f ${COPY}\nverbose \"$tid: get\"\necho \"get $DATA $COPY\" | ${SFTP} -D ${SFTPSERVER} >/dev/null 2>&1 \\\n\t|| fail \"get failed\"\ncmp $DATA ${COPY} || fail \"corrupted copy after get\"\n\nrm -f ${COPY}\nverbose \"$tid: get quoted\"\necho \"get \\\"$DATA\\\" $COPY\" | ${SFTP} -D ${SFTPSERVER} >/dev/null 2>&1 \\\n\t|| fail \"get failed\"\ncmp $DATA ${COPY} || fail \"corrupted copy after get\"\n\nrm -f ${QUOTECOPY}\ncp $DATA ${QUOTECOPY}\nverbose \"$tid: get filename with quotes\"\necho \"get \\\"$QUOTECOPY_ARG\\\" ${COPY}\" | ${SFTP} -D ${SFTPSERVER} >/dev/null 2>&1 \\\n\t|| fail \"get failed\"\ncmp ${COPY} ${QUOTECOPY} || fail \"corrupted copy after get with quotes\"\nrm -f ${QUOTECOPY} ${COPY}\n\nrm -f \"$SPACECOPY\" ${COPY}\ncp $DATA \"$SPACECOPY\"\nverbose \"$tid: get filename with spaces\"\necho \"get ${SPACECOPY_ARG} ${COPY}\" | ${SFTP} -D ${SFTPSERVER} >/dev/null 2>&1 \\\n        || fail \"get failed\"\ncmp ${COPY} \"$SPACECOPY\" || fail \"corrupted copy after get with spaces\"\n\nrm -f \"$GLOBMETACOPY\" ${COPY}\ncp $DATA \"$GLOBMETACOPY\"\nverbose \"$tid: get filename with glob metacharacters\"\necho \"get \\\"${GLOBMETACOPY}\\\" ${COPY}\" | \\\n\t${SFTP} -D ${SFTPSERVER} >/dev/null 2>&1 || fail \"get failed\"\ncmp ${COPY} \"$GLOBMETACOPY\" || \\\n\tfail \"corrupted copy after get with glob metacharacters\"\n\nrm -f ${COPY}.dd/*\nverbose \"$tid: get to directory\"\necho \"get $DATA ${COPY}.dd\" | ${SFTP} -D ${SFTPSERVER} >/dev/null 2>&1 \\\n        || fail \"get failed\"\ncmp $DATA ${COPY}.dd/$DATANAME || fail \"corrupted copy after get\"\n\nrm -f ${COPY}.dd/*\nverbose \"$tid: glob get to directory\"\necho \"get /bin/l* ${COPY}.dd\" | ${SFTP} -D ${SFTPSERVER} >/dev/null 2>&1 \\\n        || fail \"get failed\"\nfor x in $GLOBFILES; do\n        cmp /bin/$x ${COPY}.dd/$x || fail \"corrupted copy after get\"\ndone\n\nrm -f ${COPY}.dd/*\nverbose \"$tid: get to local dir\"\n(echo \"lcd ${COPY}.dd\"; echo \"get $DATA\" ) | ${SFTP} -D ${SFTPSERVER} >/dev/null 2>&1 \\\n        || fail \"get failed\"\ncmp $DATA ${COPY}.dd/$DATANAME || fail \"corrupted copy after get\"\n\nrm -f ${COPY}.dd/*\nverbose \"$tid: glob get to local dir\"\n(echo \"lcd ${COPY}.dd\"; echo \"get /bin/l*\") | ${SFTP} -D ${SFTPSERVER} >/dev/null 2>&1 \\\n        || fail \"get failed\"\nfor x in $GLOBFILES; do\n        cmp /bin/$x ${COPY}.dd/$x || fail \"corrupted copy after get\"\ndone\n\nrm -f ${COPY}\nverbose \"$tid: put\"\necho \"put $DATA $COPY\" | \\\n\t${SFTP} -D ${SFTPSERVER} >/dev/null 2>&1 || fail \"put failed\"\ncmp $DATA ${COPY} || fail \"corrupted copy after put\"\n\nrm -f ${QUOTECOPY}\nverbose \"$tid: put filename with quotes\"\necho \"put $DATA \\\"$QUOTECOPY_ARG\\\"\" | \\\n\t${SFTP} -D ${SFTPSERVER} >/dev/null 2>&1 || fail \"put failed\"\ncmp $DATA ${QUOTECOPY} || fail \"corrupted copy after put with quotes\"\n\nrm -f \"$SPACECOPY\"\nverbose \"$tid: put filename with spaces\"\necho \"put $DATA ${SPACECOPY_ARG}\" | \\\n\t${SFTP} -D ${SFTPSERVER} >/dev/null 2>&1 || fail \"put failed\"\ncmp $DATA \"$SPACECOPY\" || fail \"corrupted copy after put with spaces\"\n\nrm -f ${COPY}.dd/*\nverbose \"$tid: put to directory\"\necho \"put $DATA ${COPY}.dd\" | ${SFTP} -D ${SFTPSERVER} >/dev/null 2>&1 \\\n\t|| fail \"put failed\"\ncmp $DATA ${COPY}.dd/$DATANAME || fail \"corrupted copy after put\"\n\nrm -f ${COPY}.dd/*\nverbose \"$tid: glob put to directory\"\necho \"put /bin/l? ${COPY}.dd\" | ${SFTP} -D ${SFTPSERVER} >/dev/null 2>&1 \\\n\t|| fail \"put failed\"\nfor x in $GLOBFILES; do\n\tcmp /bin/$x ${COPY}.dd/$x || fail \"corrupted copy after put\"\ndone\n\nrm -f ${COPY}.dd/*\nverbose \"$tid: put to local dir\"\n(echo \"cd ${COPY}.dd\"; echo \"put $DATA\") | ${SFTP} -D ${SFTPSERVER} >/dev/null 2>&1 \\\n\t|| fail \"put failed\"\ncmp $DATA ${COPY}.dd/$DATANAME || fail \"corrupted copy after put\"\n\nrm -f ${COPY}.dd/*\nverbose \"$tid: glob put to local dir\"\n(echo \"cd ${COPY}.dd\"; echo \"put /bin/l?\") | ${SFTP} -D ${SFTPSERVER} >/dev/null 2>&1 \\\n\t|| fail \"put failed\"\nfor x in $GLOBFILES; do\n        cmp /bin/$x ${COPY}.dd/$x || fail \"corrupted copy after put\"\ndone\n\nverbose \"$tid: rename\"\necho \"rename $COPY ${COPY}.1\" | ${SFTP} -D ${SFTPSERVER} >/dev/null 2>&1 \\\n\t|| fail \"rename failed\"\ntest -f ${COPY}.1 || fail \"missing file after rename\"\ncmp $DATA ${COPY}.1 >/dev/null 2>&1 || fail \"corrupted copy after rename\"\n\nverbose \"$tid: rename directory\"\necho \"rename ${COPY}.dd ${COPY}.dd2\" | \\\n\t${SFTP} -D ${SFTPSERVER} >/dev/null 2>&1 || \\\n\tfail \"rename directory failed\"\ntest -d ${COPY}.dd && fail \"oldname exists after rename directory\"\ntest -d ${COPY}.dd2 || fail \"missing newname after rename directory\"\n\nverbose \"$tid: ln\"\necho \"ln ${COPY}.1 ${COPY}.2\" | ${SFTP} -D ${SFTPSERVER} >/dev/null 2>&1 || fail \"ln failed\"\ntest -f ${COPY}.2 || fail \"missing file after ln\"\ncmp ${COPY}.1 ${COPY}.2 || fail \"created file is not equal after ln\"\n\nverbose \"$tid: ln -s\"\nrm -f ${COPY}.2\necho \"ln -s ${COPY}.1 ${COPY}.2\" | ${SFTP} -D ${SFTPSERVER} >/dev/null 2>&1 || fail \"ln -s failed\"\ntest -h ${COPY}.2 || fail \"missing file after ln -s\"\n\nverbose \"$tid: cp\"\nrm -f ${COPY}.2\necho \"cp ${COPY}.1 ${COPY}.2\" | ${SFTP} -D ${SFTPSERVER} >/dev/null 2>&1 || fail \"cp failed\"\ncmp ${COPY}.1 ${COPY}.2 || fail \"created file is not equal after cp\"\n\nverbose \"$tid: mkdir\"\necho \"mkdir ${COPY}.dd\" | ${SFTP} -D ${SFTPSERVER} >/dev/null 2>&1 \\\n\t|| fail \"mkdir failed\"\ntest -d ${COPY}.dd || fail \"missing directory after mkdir\"\n\n# XXX do more here\nverbose \"$tid: chdir\"\necho \"chdir ${COPY}.dd\" | ${SFTP} -D ${SFTPSERVER} >/dev/null 2>&1 \\\n\t|| fail \"chdir failed\"\n\nverbose \"$tid: rmdir\"\necho \"rmdir ${COPY}.dd\" | ${SFTP} -D ${SFTPSERVER} >/dev/null 2>&1 \\\n\t|| fail \"rmdir failed\"\ntest -d ${COPY}.1 && fail \"present directory after rmdir\"\n\nverbose \"$tid: lmkdir\"\necho \"lmkdir ${COPY}.dd\" | ${SFTP} -D ${SFTPSERVER} >/dev/null 2>&1 \\\n\t|| fail \"lmkdir failed\"\ntest -d ${COPY}.dd || fail \"missing directory after lmkdir\"\n\n# XXX do more here\nverbose \"$tid: lchdir\"\necho \"lchdir ${COPY}.dd\" | ${SFTP} -D ${SFTPSERVER} >/dev/null 2>&1 \\\n\t|| fail \"lchdir failed\"\n\nrm -rf ${COPY} ${COPY}.1 ${COPY}.2 ${COPY}.dd ${COPY}.dd2\nrm -rf ${QUOTECOPY} \"$SPACECOPY\" \"$GLOBMETACOPY\"\n\n\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}