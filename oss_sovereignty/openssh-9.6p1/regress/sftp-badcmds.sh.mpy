{
  "module_name": "sftp-badcmds.sh",
  "hash_id": "e9105b684e6bdc68650814ee475f5153422828ca33079767fb917a6ba98c8774",
  "original_prompt": "Ingested from openssh-9.6p1/regress/sftp-badcmds.sh",
  "human_readable_source": "#\t$OpenBSD: sftp-badcmds.sh,v 1.7 2020/03/13 03:18:45 djm Exp $\n#\tPlaced in the Public Domain.\n\ntid=\"sftp invalid commands\"\n\nDATA2=/bin/sh${EXEEXT}\nNONEXIST=/NONEXIST.$$\nGLOBFILES=`(cd /bin;echo l*)`\n\nrm -rf ${COPY} ${COPY}.1 ${COPY}.2 ${COPY}.dd\n\nrm -f ${COPY}\nverbose \"$tid: get nonexistent\"\necho \"get $NONEXIST $COPY\" | ${SFTP} -D ${SFTPSERVER} >/dev/null 2>&1 \\\n\t|| fail \"get nonexistent failed\"\ntest -f ${COPY} && fail \"existing copy after get nonexistent\"\n\nrm -f ${COPY}.dd/*\nverbose \"$tid: glob get to nonexistent directory\"\necho \"get /bin/l* $NONEXIST\" | ${SFTP} -D ${SFTPSERVER} >/dev/null 2>&1 \\\n        || fail \"get nonexistent failed\"\nfor x in $GLOBFILES; do\n        test -f ${COPY}.dd/$x && fail \"existing copy after get nonexistent\"\ndone\n\nrm -f ${COPY}\nverbose \"$tid: put nonexistent\"\necho \"put $NONEXIST $COPY\" | ${SFTP} -D ${SFTPSERVER} >/dev/null 2>&1 \\\n\t|| fail \"put nonexistent failed\"\ntest -f ${COPY} && fail \"existing copy after put nonexistent\"\n\nrm -f ${COPY}.dd/*\nverbose \"$tid: glob put to nonexistent directory\"\necho \"put /bin/l* ${COPY}.dd\" | ${SFTP} -D ${SFTPSERVER} >/dev/null 2>&1 \\\n        || fail \"put nonexistent failed\"\nfor x in $GLOBFILES; do\n        test -f ${COPY}.dd/$x && fail \"existing copy after nonexistent\"\ndone\n\nrm -f ${COPY}\nverbose \"$tid: rename nonexistent\"\necho \"rename $NONEXIST ${COPY}.1\" | ${SFTP} -D ${SFTPSERVER} >/dev/null 2>&1 \\\n\t|| fail \"rename nonexist failed\"\ntest -f ${COPY}.1 && fail \"file exists after rename nonexistent\"\n\nrm -rf ${COPY} ${COPY}.dd\ncp $DATA $COPY\nmkdir ${COPY}.dd\nverbose \"$tid: rename target exists (directory)\"\necho \"rename $COPY ${COPY}.dd\" | ${SFTP} -D ${SFTPSERVER} >/dev/null 2>&1 \\\n\t|| fail \"rename target exists (directory) failed\"\ntest -f ${COPY} || fail \"oldname missing after rename target exists (directory)\"\ntest -d ${COPY}.dd || fail \"newname missing after rename target exists (directory)\"\ncmp $DATA ${COPY} >/dev/null 2>&1 || fail \"corrupted oldname after rename target exists (directory)\"\n\nrm -f ${COPY}.dd/*\nrm -rf ${COPY}\ncp ${DATA2} ${COPY}\nverbose \"$tid: glob put files to local file\"\necho \"put /bin/l* $COPY\" | ${SFTP} -D ${SFTPSERVER} >/dev/null 2>&1 \ncmp ${DATA2} ${COPY} || fail \"put succeeded when it should have failed\"\n\nrm -rf ${COPY} ${COPY}.1 ${COPY}.2 ${COPY}.dd\n\n\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}