{
  "module_name": "keygen-sshfp.sh",
  "hash_id": "f27ea9d80a5967c402a01c807dee40995742f37a6d900ce88059e2bd299b9c67",
  "original_prompt": "Ingested from openssh-9.6p1/regress/keygen-sshfp.sh",
  "human_readable_source": "#\t$OpenBSD: keygen-sshfp.sh,v 1.3 2023/02/10 05:06:03 djm Exp $\n#\tPlaced in the Public Domain.\n\ntid=\"keygen-sshfp\"\n\ntrace \"keygen fingerprints\"\nfp=`${SSHKEYGEN} -r test -f ${SRC}/ed25519_openssh.pub | \\\n    awk '$5==\"1\"{print $6}'`\nif [ \"$fp\" != \"8a8647a7567e202ce317e62606c799c53d4c121f\" ]; then\n\tfail \"keygen fingerprint sha1\"\nfi\nfp=`${SSHKEYGEN} -r test -f ${SRC}/ed25519_openssh.pub | \\\n    awk '$5==\"2\"{print $6}'`\nif [ \"$fp\" != \\\n    \"54a506fb849aafb9f229cf78a94436c281efcb4ae67c8a430e8c06afcb5ee18f\" ]; then\n\tfail \"keygen fingerprint sha256\"\nfi\n\n# Expect two lines of output without an explicit algorithm\nfp=`${SSHKEYGEN} -r test -f ${SRC}/ed25519_openssh.pub | wc -l`\nif [ $(($fp + 0)) -ne 2 ] ; then\n\tfail \"incorrect number of SSHFP records $fp (expected 2)\"\nfi\n\n# Test explicit algorithm selection\nexp=\"test IN SSHFP 4 1 8a8647a7567e202ce317e62606c799c53d4c121f\"\nfp=`${SSHKEYGEN} -Ohashalg=sha1 -r test -f ${SRC}/ed25519_openssh.pub`\nif [ \"x$exp\" != \"x$fp\" ] ; then\n\tfail \"incorrect SHA1 SSHFP output\"\nfi\n\nexp=\"test IN SSHFP 4 2 54a506fb849aafb9f229cf78a94436c281efcb4ae67c8a430e8c06afcb5ee18f\"\nfp=`${SSHKEYGEN} -Ohashalg=sha256 -r test -f ${SRC}/ed25519_openssh.pub`\nif [ \"x$exp\" != \"x$fp\" ] ; then\n\tfail \"incorrect SHA256 SSHFP output\"\nfi\n\nif ${SSH} -Q key-plain | grep ssh-rsa >/dev/null; then\n\tfp=`${SSHKEYGEN} -r test -f ${SRC}/rsa_openssh.pub | awk '$5==\"1\"{print $6}'`\n\tif [ \"$fp\" != \"99c79cc09f5f81069cc017cdf9552cfc94b3b929\" ]; then\n\t\tfail \"keygen fingerprint sha1\"\n\tfi\n\tfp=`${SSHKEYGEN} -r test -f ${SRC}/rsa_openssh.pub | awk '$5==\"2\"{print $6}'`\n\tif [ \"$fp\" != \\\n\t    \"e30d6b9eb7a4de495324e4d5870b8220577993ea6af417e8e4a4f1c5bf01a9b6\" ]; then\n\t\tfail \"keygen fingerprint sha256\"\n\tfi\nfi\n\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}