{
  "module_name": "channels.h",
  "hash_id": "69404bbe9b42b14fe99c3a23311e2dfb8b0f97a7986249a983df1c37c3e30b36",
  "original_prompt": "Ingested from openssh-9.6p1/channels.h",
  "human_readable_source": " \n\n \n \n\n#ifndef CHANNEL_H\n#define CHANNEL_H\n\n \n#define SSH_CHANNEL_X11_LISTENER\t1\t \n#define SSH_CHANNEL_PORT_LISTENER\t2\t \n#define SSH_CHANNEL_OPENING\t\t3\t \n#define SSH_CHANNEL_OPEN\t\t4\t \n#define SSH_CHANNEL_CLOSED\t\t5\t \n#define SSH_CHANNEL_AUTH_SOCKET\t\t6\t \n#define SSH_CHANNEL_X11_OPEN\t\t7\t \n#define SSH_CHANNEL_LARVAL\t\t10\t \n#define SSH_CHANNEL_RPORT_LISTENER\t11\t \n#define SSH_CHANNEL_CONNECTING\t\t12\n#define SSH_CHANNEL_DYNAMIC\t\t13\n#define SSH_CHANNEL_ZOMBIE\t\t14\t \n#define SSH_CHANNEL_MUX_LISTENER\t15\t \n#define SSH_CHANNEL_MUX_CLIENT\t\t16\t \n#define SSH_CHANNEL_ABANDONED\t\t17\t \n#define SSH_CHANNEL_UNIX_LISTENER\t18\t \n#define SSH_CHANNEL_RUNIX_LISTENER\t19\t \n#define SSH_CHANNEL_MUX_PROXY\t\t20\t \n#define SSH_CHANNEL_RDYNAMIC_OPEN\t21\t \n#define SSH_CHANNEL_RDYNAMIC_FINISH\t22\t \n#define SSH_CHANNEL_MAX_TYPE\t\t23\n\n#define CHANNEL_CANCEL_PORT_STATIC\t-1\n\n \n#define CHANNEL_NONBLOCK_LEAVE\t0  \n#define CHANNEL_NONBLOCK_SET\t1  \n#define CHANNEL_NONBLOCK_STDIO\t2  \n\n \n#define CHANNEL_RESTORE_RFD\t0x01\n#define CHANNEL_RESTORE_WFD\t0x02\n#define CHANNEL_RESTORE_EFD\t0x04\n\n \n#define FORWARD_DENY\t\t0\n#define FORWARD_REMOTE\t\t(1)\n#define FORWARD_LOCAL\t\t(1<<1)\n#define FORWARD_ALLOW\t\t(FORWARD_REMOTE|FORWARD_LOCAL)\n\n#define FORWARD_ADM\t\t0x100\n#define FORWARD_USER\t\t0x101\n\nstruct ssh;\nstruct Channel;\ntypedef struct Channel Channel;\nstruct fwd_perm_list;\n\ntypedef void channel_open_fn(struct ssh *, int, int, void *);\ntypedef void channel_callback_fn(struct ssh *, int, int, void *);\ntypedef int channel_infilter_fn(struct ssh *, struct Channel *, char *, int);\ntypedef void channel_filter_cleanup_fn(struct ssh *, int, void *);\ntypedef u_char *channel_outfilter_fn(struct ssh *, struct Channel *,\n    u_char **, size_t *);\n\n \ntypedef void channel_confirm_cb(struct ssh *, int, struct Channel *, void *);\ntypedef void channel_confirm_abandon_cb(struct ssh *, struct Channel *, void *);\nstruct channel_confirm {\n\tTAILQ_ENTRY(channel_confirm) entry;\n\tchannel_confirm_cb *cb;\n\tchannel_confirm_abandon_cb *abandon_cb;\n\tvoid *ctx;\n};\nTAILQ_HEAD(channel_confirms, channel_confirm);\n\n \nstruct channel_connect {\n\tchar *host;\n\tint port;\n\tstruct addrinfo *ai, *aitop;\n};\n\n \ntypedef int mux_callback_fn(struct ssh *, struct Channel *);\n\n \n\nstruct Channel {\n\tint     type;\t\t \n\n\tint     self;\t\t \n\tuint32_t remote_id;\t \n\tint\thave_remote_id;\t \n\n\tu_int   istate;\t\t \n\tu_int   ostate;\t\t \n\tint     flags;\t\t \n\tint     rfd;\t\t \n\tint     wfd;\t\t \n\tint     efd;\t\t \n\tint     sock;\t\t \n\tu_int\tio_want;\t \n\tu_int\tio_ready;\t \n\tint\tpfds[4];\t \n\tint     ctl_chan;\t \n\tint     isatty;\t\t \n#ifdef _AIX\n\tint     wfd_isatty;\t \n#endif\n\tint\tclient_tty;\t \n\tint     force_drain;\t \n\ttime_t\tnotbefore;\t \n\tint     delayed;\t \n\tint\trestore_block;\t \n\tint\trestore_flags[3]; \n\tstruct sshbuf *input;\t \n\tstruct sshbuf *output;\t \n\tstruct sshbuf *extended;\n\n\tchar    *path;\n\t\t \n\tint     listening_port;\t \n\tchar   *listening_addr;\t \n\tint     host_port;\t \n\tchar   *remote_name;\t \n\n\tu_int\tremote_window;\n\tu_int\tremote_maxpacket;\n\tu_int\tlocal_window;\n\tu_int\tlocal_window_exceeded;\n\tu_int\tlocal_window_max;\n\tu_int\tlocal_consumed;\n\tu_int\tlocal_maxpacket;\n\tint     extended_usage;\n\tint\tsingle_connection;\n\n\tchar   *ctype;\t\t \n\tchar   *xctype;\t\t \n\n\t \n\tchannel_open_fn\t\t*open_confirm;\n\tvoid\t\t\t*open_confirm_ctx;\n\tchannel_callback_fn\t*detach_user;\n\tint\t\t\tdetach_close;\n\tstruct channel_confirms\tstatus_confirms;\n\n\t \n\tchannel_infilter_fn\t*input_filter;\n\tchannel_outfilter_fn\t*output_filter;\n\tvoid\t\t\t*filter_ctx;\n\tchannel_filter_cleanup_fn *filter_cleanup;\n\n\t \n\tint\t\t\tdatagram;\n\n\t \n\t \n\tstruct channel_connect\tconnect_ctx;\n\n\t \n\tmux_callback_fn\t\t*mux_rcb;\n\tvoid\t\t\t*mux_ctx;\n\tint\t\t\tmux_pause;\n\tint\t\t\tmux_downstream_id;\n\n\t \n\n\t \n\ttime_t\t\t\tlastused;\n\t \n\tint\t\t\tinactive_deadline;\n};\n\n#define CHAN_EXTENDED_IGNORE\t\t0\n#define CHAN_EXTENDED_READ\t\t1\n#define CHAN_EXTENDED_WRITE\t\t2\n\n \n#define CHAN_SES_PACKET_DEFAULT\t(32*1024)\n#define CHAN_SES_WINDOW_DEFAULT\t(64*CHAN_SES_PACKET_DEFAULT)\n#define CHAN_TCP_PACKET_DEFAULT\t(32*1024)\n#define CHAN_TCP_WINDOW_DEFAULT\t(64*CHAN_TCP_PACKET_DEFAULT)\n#define CHAN_X11_PACKET_DEFAULT\t(16*1024)\n#define CHAN_X11_WINDOW_DEFAULT\t(4*CHAN_X11_PACKET_DEFAULT)\n\n \n#define CHAN_INPUT_OPEN\t\t\t0\n#define CHAN_INPUT_WAIT_DRAIN\t\t1\n#define CHAN_INPUT_WAIT_OCLOSE\t\t2\n#define CHAN_INPUT_CLOSED\t\t3\n\n \n#define CHAN_OUTPUT_OPEN\t\t0\n#define CHAN_OUTPUT_WAIT_DRAIN\t\t1\n#define CHAN_OUTPUT_WAIT_IEOF\t\t2\n#define CHAN_OUTPUT_CLOSED\t\t3\n\n#define CHAN_CLOSE_SENT\t\t\t0x01\n#define CHAN_CLOSE_RCVD\t\t\t0x02\n#define CHAN_EOF_SENT\t\t\t0x04\n#define CHAN_EOF_RCVD\t\t\t0x08\n#define CHAN_LOCAL\t\t\t0x10\n\n \n#define SSH_CHAN_IO_RFD\t\t\t0x01\n#define SSH_CHAN_IO_WFD\t\t\t0x02\n#define SSH_CHAN_IO_EFD_R\t\t0x04\n#define SSH_CHAN_IO_EFD_W\t\t0x08\n#define SSH_CHAN_IO_EFD\t\t\t(SSH_CHAN_IO_EFD_R|SSH_CHAN_IO_EFD_W)\n#define SSH_CHAN_IO_SOCK_R\t\t0x10\n#define SSH_CHAN_IO_SOCK_W\t\t0x20\n#define SSH_CHAN_IO_SOCK\t\t(SSH_CHAN_IO_SOCK_R|SSH_CHAN_IO_SOCK_W)\n\n \n#define CHAN_RBUF\t(16*1024)\n\n \n#define CHANNEL_MAX_READ\tCHAN_SES_PACKET_DEFAULT\n\n \n#define CHAN_INPUT_MAX\t(16*1024*1024)\n\n \n#define CHANNELS_MAX_CHANNELS\t(16*1024)\n\n \n#define CHANNEL_EFD_INPUT_ACTIVE(c) \\\n\t(c->extended_usage == CHAN_EXTENDED_READ && \\\n\t(c->efd != -1 || \\\n\tsshbuf_len(c->extended) > 0))\n#define CHANNEL_EFD_OUTPUT_ACTIVE(c) \\\n\t(c->extended_usage == CHAN_EXTENDED_WRITE && \\\n\tc->efd != -1 && (!(c->flags & (CHAN_EOF_RCVD|CHAN_CLOSE_RCVD)) || \\\n\tsshbuf_len(c->extended) > 0))\n\n \nvoid channel_init_channels(struct ssh *ssh);\n\n \n\nChannel\t*channel_by_id(struct ssh *, int);\nChannel\t*channel_by_remote_id(struct ssh *, u_int);\nChannel\t*channel_lookup(struct ssh *, int);\nChannel *channel_new(struct ssh *, char *, int, int, int, int,\n\t    u_int, u_int, int, const char *, int);\nvoid\t channel_set_fds(struct ssh *, int, int, int, int, int,\n\t    int, int, u_int);\nvoid\t channel_free(struct ssh *, Channel *);\nvoid\t channel_free_all(struct ssh *);\nvoid\t channel_stop_listening(struct ssh *);\nvoid\t channel_force_close(struct ssh *, Channel *, int);\nvoid\t channel_set_xtype(struct ssh *, int, const char *);\n\nvoid\t channel_send_open(struct ssh *, int);\nvoid\t channel_request_start(struct ssh *, int, char *, int);\nvoid\t channel_register_cleanup(struct ssh *, int,\n\t    channel_callback_fn *, int);\nvoid\t channel_register_open_confirm(struct ssh *, int,\n\t    channel_open_fn *, void *);\nvoid\t channel_register_filter(struct ssh *, int, channel_infilter_fn *,\n\t    channel_outfilter_fn *, channel_filter_cleanup_fn *, void *);\nvoid\t channel_register_status_confirm(struct ssh *, int,\n\t    channel_confirm_cb *, channel_confirm_abandon_cb *, void *);\nvoid\t channel_cancel_cleanup(struct ssh *, int);\nint\t channel_close_fd(struct ssh *, Channel *, int *);\nvoid\t channel_send_window_changes(struct ssh *);\n\n \nvoid channel_add_timeout(struct ssh *, const char *, int);\nvoid channel_clear_timeouts(struct ssh *);\n\n \n\nint\t channel_proxy_downstream(struct ssh *, Channel *mc);\nint\t channel_proxy_upstream(Channel *, int, u_int32_t, struct ssh *);\n\n \n\nint\t channel_input_data(int, u_int32_t, struct ssh *);\nint\t channel_input_extended_data(int, u_int32_t, struct ssh *);\nint\t channel_input_ieof(int, u_int32_t, struct ssh *);\nint\t channel_input_oclose(int, u_int32_t, struct ssh *);\nint\t channel_input_open_confirmation(int, u_int32_t, struct ssh *);\nint\t channel_input_open_failure(int, u_int32_t, struct ssh *);\nint\t channel_input_port_open(int, u_int32_t, struct ssh *);\nint\t channel_input_window_adjust(int, u_int32_t, struct ssh *);\nint\t channel_input_status_confirm(int, u_int32_t, struct ssh *);\n\n \nstruct pollfd;\nstruct timespec;\n\nvoid\t channel_prepare_poll(struct ssh *, struct pollfd **,\n\t    u_int *, u_int *, u_int, struct timespec *);\nvoid\t channel_after_poll(struct ssh *, struct pollfd *, u_int);\nint\t channel_output_poll(struct ssh *);\n\nint      channel_not_very_much_buffered_data(struct ssh *);\nvoid     channel_close_all(struct ssh *);\nint      channel_still_open(struct ssh *);\nint\t channel_tty_open(struct ssh *);\nconst char *channel_format_extended_usage(const Channel *);\nchar\t*channel_open_message(struct ssh *);\nint\t channel_find_open(struct ssh *);\n\n \nstruct Forward;\nstruct ForwardOptions;\nvoid\t channel_set_af(struct ssh *, int af);\nvoid     channel_permit_all(struct ssh *, int);\nvoid\t channel_add_permission(struct ssh *, int, int, char *, int);\nvoid\t channel_clear_permission(struct ssh *, int, int);\nvoid\t channel_disable_admin(struct ssh *, int);\nvoid\t channel_update_permission(struct ssh *, int, int);\nChannel\t*channel_connect_to_port(struct ssh *, const char *, u_short,\n\t    char *, char *, int *, const char **);\nChannel *channel_connect_to_path(struct ssh *, const char *, char *, char *);\nChannel\t*channel_connect_stdio_fwd(struct ssh *, const char*,\n\t    int, int, int, int);\nChannel\t*channel_connect_by_listen_address(struct ssh *, const char *,\n\t    u_short, char *, char *);\nChannel\t*channel_connect_by_listen_path(struct ssh *, const char *,\n\t    char *, char *);\nint\t channel_request_remote_forwarding(struct ssh *, struct Forward *);\nint\t channel_setup_local_fwd_listener(struct ssh *, struct Forward *,\n\t    struct ForwardOptions *);\nint\t channel_request_rforward_cancel(struct ssh *, struct Forward *);\nint\t channel_setup_remote_fwd_listener(struct ssh *, struct Forward *,\n\t    int *, struct ForwardOptions *);\nint\t channel_cancel_rport_listener(struct ssh *, struct Forward *);\nint\t channel_cancel_lport_listener(struct ssh *, struct Forward *,\n\t    int, struct ForwardOptions *);\nint\t permitopen_port(const char *);\n\n \n\nvoid\t channel_set_x11_refuse_time(struct ssh *, time_t);\nint\t x11_connect_display(struct ssh *);\nint\t x11_create_display_inet(struct ssh *, int, int, int, u_int *, int **);\nvoid\t x11_request_forwarding_with_spoofing(struct ssh *, int,\n\t    const char *, const char *, const char *, int);\n\n \n\nint\t chan_is_dead(struct ssh *, Channel *, int);\nvoid\t chan_mark_dead(struct ssh *, Channel *);\n\n \n\nvoid\t chan_rcvd_oclose(struct ssh *, Channel *);\nvoid\t chan_rcvd_eow(struct ssh *, Channel *);\nvoid\t chan_read_failed(struct ssh *, Channel *);\nvoid\t chan_ibuf_empty(struct ssh *, Channel *);\nvoid\t chan_rcvd_ieof(struct ssh *, Channel *);\nvoid\t chan_write_failed(struct ssh *, Channel *);\nvoid\t chan_obuf_empty(struct ssh *, Channel *);\n\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}