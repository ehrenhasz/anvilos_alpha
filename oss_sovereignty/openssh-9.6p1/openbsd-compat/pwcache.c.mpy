{
  "module_name": "pwcache.c",
  "hash_id": "8fd9c0ccba4c9d5de47c11b5e577d0572a2784457c68d7bb5a851a538f0f3bbb",
  "original_prompt": "Ingested from openssh-9.6p1/openbsd-compat/pwcache.c",
  "human_readable_source": " \n \n\n \n\n#include \"includes.h\"\n\n#include <sys/types.h>\n\n#include <grp.h>\n#include <pwd.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <string.h>\n\n#define\tNCACHE\t64\t\t\t \n#define\tMASK\t(NCACHE - 1)\t\t \n\n#ifndef HAVE_USER_FROM_UID\nchar *\nuser_from_uid(uid_t uid, int nouser)\n{\n\tstatic struct ncache {\n\t\tuid_t\tuid;\n\t\tchar\t*name;\n\t} c_uid[NCACHE];\n\tstatic int pwopen;\n\tstatic char nbuf[15];\t\t \n\tstruct passwd *pw;\n\tstruct ncache *cp;\n\n\tcp = c_uid + (uid & MASK);\n\tif (cp->uid != uid || cp->name == NULL) {\n\t\tif (pwopen == 0) {\n#ifdef HAVE_SETPASSENT\n\t\t\tsetpassent(1);\n#endif\n\t\t\tpwopen = 1;\n\t\t}\n\t\tif ((pw = getpwuid(uid)) == NULL) {\n\t\t\tif (nouser)\n\t\t\t\treturn (NULL);\n\t\t\t(void)snprintf(nbuf, sizeof(nbuf), \"%lu\", (u_long)uid);\n\t\t}\n\t\tcp->uid = uid;\n\t\tif (cp->name != NULL)\n\t\t\tfree(cp->name);\n\t\tcp->name = strdup(pw ? pw->pw_name : nbuf);\n\t}\n\treturn (cp->name);\n}\n#endif\n\n#ifndef HAVE_GROUP_FROM_GID\nchar *\ngroup_from_gid(gid_t gid, int nogroup)\n{\n\tstatic struct ncache {\n\t\tgid_t\tgid;\n\t\tchar\t*name;\n\t} c_gid[NCACHE];\n\tstatic int gropen;\n\tstatic char nbuf[15];\t\t \n\tstruct group *gr;\n\tstruct ncache *cp;\n\n\tcp = c_gid + (gid & MASK);\n\tif (cp->gid != gid || cp->name == NULL) {\n\t\tif (gropen == 0) {\n#ifdef HAVE_SETGROUPENT\n\t\t\tsetgroupent(1);\n#endif\n\t\t\tgropen = 1;\n\t\t}\n\t\tif ((gr = getgrgid(gid)) == NULL) {\n\t\t\tif (nogroup)\n\t\t\t\treturn (NULL);\n\t\t\t(void)snprintf(nbuf, sizeof(nbuf), \"%lu\", (u_long)gid);\n\t\t}\n\t\tcp->gid = gid;\n\t\tif (cp->name != NULL)\n\t\t\tfree(cp->name);\n\t\tcp->name = strdup(gr ? gr->gr_name : nbuf);\n\t}\n\treturn (cp->name);\n}\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}