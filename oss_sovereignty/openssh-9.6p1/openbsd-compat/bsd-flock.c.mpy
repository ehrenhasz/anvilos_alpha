{
  "module_name": "bsd-flock.c",
  "hash_id": "5d75e25149a0a074c0fb30afd7abba4250f293a46f70f0e5a73c91d2ac981418",
  "original_prompt": "Ingested from openssh-9.6p1/openbsd-compat/bsd-flock.c",
  "human_readable_source": " \n\n \n\n \n\n#include \"includes.h\"\n\n#ifndef HAVE_FLOCK\n#include <errno.h>\n#include <fcntl.h>\n\nint\nflock(int fd, int op)\n{\n\tint rc = 0;\n\n#if defined(F_SETLK) && defined(F_SETLKW)\n\tstruct flock fl = {0};\n\n\tswitch (op & (LOCK_EX|LOCK_SH|LOCK_UN)) {\n\tcase LOCK_EX:\n\t\tfl.l_type = F_WRLCK;\n\t\tbreak;\n\n\tcase LOCK_SH:\n\t\tfl.l_type = F_RDLCK;\n\t\tbreak;\n\n\tcase LOCK_UN:\n\t\tfl.l_type = F_UNLCK;\n\t\tbreak;\n\n\tdefault:\n\t\terrno = EINVAL;\n\t\treturn -1;\n\t}\n\n\tfl.l_whence = SEEK_SET;\n\trc = fcntl(fd, op & LOCK_NB ? F_SETLK : F_SETLKW, &fl);\n\n\tif (rc && (errno == EAGAIN))\n\t\terrno = EWOULDBLOCK;\n#else\n\trc = -1;\n\terrno = ENOSYS;\n#endif\n\n\treturn rc;\n}\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}