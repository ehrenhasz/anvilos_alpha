{
  "module_name": "utimensattest.c",
  "hash_id": "d35bf19e1d6b9f90da882732e16228c4904749329143d0f8fca6597c1c52d905",
  "original_prompt": "Ingested from openssh-9.6p1/openbsd-compat/regress/utimensattest.c",
  "human_readable_source": " \n\n#include \"includes.h\"\n\n#include <sys/types.h>\n#include <sys/stat.h>\n\n#include <errno.h>\n#include <fcntl.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <string.h>\n#include <unistd.h>\n\n#define TMPFILE \"utimensat.tmp\"\n#define TMPFILE2 \"utimensat.tmp2\"\n\n#ifndef AT_SYMLINK_NOFOLLOW\n# define AT_SYMLINK_NOFOLLOW 0x80000000\n#endif\n\nint utimensat(int, const char *, const struct timespec[2], int);\n\nstatic void\ncleanup(void)\n{\n\t(void)unlink(TMPFILE);\n\t(void)unlink(TMPFILE2);\n}\n\nstatic void\nfail(char *msg, long expect, long got)\n{\n\tint saved_errno = errno;\n\n\tif (expect == got && got == 0)\n\t\tfprintf(stderr, \"utimensat: %s: %s\\n\", msg,\n\t\t     strerror(saved_errno));\n\telse\n\t\tfprintf(stderr, \"utimensat: %s: expected %ld got %ld\\n\",\n\t\t     msg, expect, got);\n\tcleanup();\n\texit(1);\n}\n\nint\nmain(void)\n{\n\tint fd;\n\tstruct stat sb;\n\tstruct timespec ts[2];\n\n\tcleanup();\n\tif ((fd = open(TMPFILE, O_CREAT, 0600)) == -1)\n\t\tfail(\"open\", 0, 0);\n\tclose(fd);\n\n\tts[0].tv_sec = 12345678;\n\tts[0].tv_nsec = 23456789;\n\tts[1].tv_sec = 34567890;\n\tts[1].tv_nsec = 45678901;\n\tif (utimensat(AT_FDCWD, TMPFILE, ts, AT_SYMLINK_NOFOLLOW) == -1)\n\t\tfail(\"utimensat\", 0, 0);\n\n\tif (stat(TMPFILE, &sb) == -1)\n\t\tfail(\"stat\", 0, 0 );\n\tif (sb.st_atime != 12345678)\n\t\tfail(\"st_atime\", 0, 0 );\n\tif (sb.st_mtime != 34567890)\n\t\tfail(\"st_mtime\", 0, 0 );\n#if 0\n\t \n\tif (sb.st_atim.tv_nsec != 23456000)\n\t\tfail(\"atim.tv_nsec\", 23456000, sb.st_atim.tv_nsec);\n\tif (sb.st_mtim.tv_nsec != 45678000)\n\t\tfail(\"mtim.tv_nsec\", 45678000, sb.st_mtim.tv_nsec);\n#endif\n\n\t \n\tif (rename(TMPFILE, TMPFILE2) == -1)\n\t\tfail(\"rename\", 0, 0);\n\tif (symlink(TMPFILE2, TMPFILE) == -1)\n\t\tfail(\"symlink\", 0, 0);\n\tts[0].tv_sec = 11223344;\n\tts[1].tv_sec = 55667788;\n\t(void)utimensat(AT_FDCWD, TMPFILE, ts, AT_SYMLINK_NOFOLLOW);\n\tif (stat(TMPFILE2, &sb) == -1)\n\t\tfail(\"stat\", 0, 0 );\n\tif (sb.st_atime == 11223344)\n\t\tfail(\"utimensat symlink st_atime\", 0, 0 );\n\tif (sb.st_mtime == 55667788)\n\t\tfail(\"utimensat symlink st_mtime\", 0, 0 );\n\n\tcleanup();\n\texit(0);\n}\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}