{
  "module_name": "port-uw.c",
  "hash_id": "dc832a211ffd3f639848d6aa613ad632017dab10c130eebfcadf1d5e6ac06535",
  "original_prompt": "Ingested from openssh-9.6p1/openbsd-compat/port-uw.c",
  "human_readable_source": " \n\n#include \"includes.h\"\n\n#if defined(HAVE_LIBIAF)  &&  !defined(HAVE_SECUREWARE)\n#include <sys/types.h>\n#ifdef HAVE_CRYPT_H\n# include <crypt.h>\n#endif\n#include <pwd.h>\n#include <stdarg.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <string.h>\n\n#include \"xmalloc.h\"\n#include \"packet.h\"\n#include \"auth-options.h\"\n#include \"log.h\"\n#include \"misc.h\"\t \n#include \"servconf.h\"\n#include \"hostfile.h\"\n#include \"auth.h\"\n#include \"ssh.h\"\n#include \"ssh_api.h\"\n\nint nischeck(char *);\n\nint\nsys_auth_passwd(struct ssh *ssh, const char *password)\n{\n\tAuthctxt *authctxt = ssh->authctxt;\n\tstruct passwd *pw = authctxt->pw;\n\tchar *salt;\n\tint result;\n\n\t \n\tchar *pw_password = authctxt->valid ? shadow_pw(pw) : pw->pw_passwd;\n\n\tif (pw_password == NULL)\n\t\treturn 0;\n\n\t \n\tif (strcmp(pw_password, \"\") == 0 && strcmp(password, \"\") == 0)\n\t\treturn (1);\n\n\t \n\tsalt = (pw_password[0] && pw_password[1]) ? pw_password : \"xx\";\n\n\t \n#ifdef UNIXWARE_LONG_PASSWORDS\n\tif (!nischeck(pw->pw_name)) {\n\t\tresult = ((strcmp(bigcrypt(password, salt), pw_password) == 0)\n\t\t||  (strcmp(osr5bigcrypt(password, salt), pw_password) == 0));\n\t}\n\telse\n#endif  \n\t\tresult = (strcmp(xcrypt(password, salt), pw_password) == 0);\n\n#ifdef USE_LIBIAF\n\tif (authctxt->valid)\n\t\tfree(pw_password);\n#endif\n\treturn(result);\n}\n\n#ifdef UNIXWARE_LONG_PASSWORDS\nint\nnischeck(char *namep)\n{\n\tchar password_file[] = \"/etc/passwd\";\n\tFILE *fd;\n\tstruct passwd *ent = NULL;\n\n\tif ((fd = fopen (password_file, \"r\")) == NULL) {\n\t\t \n\t\treturn(0);\n\t}\n\n\t \n\twhile (ent = fgetpwent(fd)) {\n\t\tif (strcmp (ent->pw_name, namep) == 0) {\n\t\t\t \n\t\t\tfclose (fd);\n\t\t\treturn(0);\n\t\t}\n\t}\n\n\tfclose (fd);\n\treturn (1);\n}\n\n#endif  \n\n \n\n#ifdef USE_LIBIAF\nchar *\nget_iaf_password(struct passwd *pw)\n{\n\tchar *pw_password = NULL;\n\n\tuinfo_t uinfo;\n\tif (!ia_openinfo(pw->pw_name,&uinfo)) {\n\t\tia_get_logpwd(uinfo, &pw_password);\n\t\tif (pw_password == NULL)\n\t\t\tfatal(\"ia_get_logpwd: Unable to get the shadow passwd\");\n\t\tia_closeinfo(uinfo);\n\t\treturn pw_password;\n\t}\n\telse\n\t\tfatal(\"ia_openinfo: Unable to open the shadow passwd file\");\n}\n#endif  \n#endif  \n\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}