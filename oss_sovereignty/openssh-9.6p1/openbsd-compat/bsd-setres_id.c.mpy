{
  "module_name": "bsd-setres_id.c",
  "hash_id": "a73d5639025f409a8a361f642a7fc04553312426edfa58a216b5ed8a23b0ec8b",
  "original_prompt": "Ingested from openssh-9.6p1/openbsd-compat/bsd-setres_id.c",
  "human_readable_source": " \n\n#include \"includes.h\"\n\n#include <sys/types.h>\n\n#include <stdarg.h>\n#include <unistd.h>\n#include <string.h>\n\n#include \"log.h\"\n\n#if !defined(HAVE_SETRESGID) || defined(BROKEN_SETRESGID)\nint\nsetresgid(gid_t rgid, gid_t egid, gid_t sgid)\n{\n\tint ret = 0, saved_errno;\n\n\tif (rgid != sgid) {\n\t\terrno = ENOSYS;\n\t\treturn -1;\n\t}\n#if defined(HAVE_SETREGID) && !defined(BROKEN_SETREGID)\n\tif (setregid(rgid, egid) < 0) {\n\t\tsaved_errno = errno;\n\t\terror(\"setregid %lu: %.100s\", (u_long)rgid, strerror(errno));\n\t\terrno = saved_errno;\n\t\tret = -1;\n\t}\n#else\n\tif (setegid(egid) < 0) {\n\t\tsaved_errno = errno;\n\t\terror(\"setegid %lu: %.100s\", (u_long)egid, strerror(errno));\n\t\terrno = saved_errno;\n\t\tret = -1;\n\t}\n\tif (setgid(rgid) < 0) {\n\t\tsaved_errno = errno;\n\t\terror(\"setgid %lu: %.100s\", (u_long)rgid, strerror(errno));\n\t\terrno = saved_errno;\n\t\tret = -1;\n\t}\n#endif\n\treturn ret;\n}\n#endif\n\n#if !defined(HAVE_SETRESUID) || defined(BROKEN_SETRESUID)\nint\nsetresuid(uid_t ruid, uid_t euid, uid_t suid)\n{\n\tint ret = 0, saved_errno;\n\n\tif (ruid != suid) {\n\t\terrno = ENOSYS;\n\t\treturn -1;\n\t}\n#if defined(HAVE_SETREUID) && !defined(BROKEN_SETREUID)\n\tif (setreuid(ruid, euid) < 0) {\n\t\tsaved_errno = errno;\n\t\terror(\"setreuid %lu: %.100s\", (u_long)ruid, strerror(errno));\n\t\terrno = saved_errno;\n\t\tret = -1;\n\t}\n#else\n\n# ifndef SETEUID_BREAKS_SETUID\n\tif (seteuid(euid) < 0) {\n\t\tsaved_errno = errno;\n\t\terror(\"seteuid %lu: %.100s\", (u_long)euid, strerror(errno));\n\t\terrno = saved_errno;\n\t\tret = -1;\n\t}\n# endif\n\tif (setuid(ruid) < 0) {\n\t\tsaved_errno = errno;\n\t\terror(\"setuid %lu: %.100s\", (u_long)ruid, strerror(errno));\n\t\terrno = saved_errno;\n\t\tret = -1;\n\t}\n#endif\n\treturn ret;\n}\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}