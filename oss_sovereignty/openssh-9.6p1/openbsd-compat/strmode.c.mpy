{
  "module_name": "strmode.c",
  "hash_id": "d55efa1c07464b86786a14c6df16c648f3a060743076a1669a8fbec570c6f944",
  "original_prompt": "Ingested from openssh-9.6p1/openbsd-compat/strmode.c",
  "human_readable_source": " \n \n\n \n\n#include \"includes.h\"\n#ifndef HAVE_STRMODE\n\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <string.h>\n\n \n\nvoid\nstrmode(int mode, char *p)\n{\n\t  \n\tswitch (mode & S_IFMT) {\n\tcase S_IFDIR:\t\t\t \n\t\t*p++ = 'd';\n\t\tbreak;\n\tcase S_IFCHR:\t\t\t \n\t\t*p++ = 'c';\n\t\tbreak;\n\tcase S_IFBLK:\t\t\t \n\t\t*p++ = 'b';\n\t\tbreak;\n\tcase S_IFREG:\t\t\t \n\t\t*p++ = '-';\n\t\tbreak;\n\tcase S_IFLNK:\t\t\t \n\t\t*p++ = 'l';\n\t\tbreak;\n#ifdef S_IFSOCK\n\tcase S_IFSOCK:\t\t\t \n\t\t*p++ = 's';\n\t\tbreak;\n#endif\n#ifdef S_IFIFO\n\tcase S_IFIFO:\t\t\t \n\t\t*p++ = 'p';\n\t\tbreak;\n#endif\n\tdefault:\t\t\t \n\t\t*p++ = '?';\n\t\tbreak;\n\t}\n\t \n\tif (mode & S_IRUSR)\n\t\t*p++ = 'r';\n\telse\n\t\t*p++ = '-';\n\tif (mode & S_IWUSR)\n\t\t*p++ = 'w';\n\telse\n\t\t*p++ = '-';\n\tswitch (mode & (S_IXUSR | S_ISUID)) {\n\tcase 0:\n\t\t*p++ = '-';\n\t\tbreak;\n\tcase S_IXUSR:\n\t\t*p++ = 'x';\n\t\tbreak;\n\tcase S_ISUID:\n\t\t*p++ = 'S';\n\t\tbreak;\n\tcase S_IXUSR | S_ISUID:\n\t\t*p++ = 's';\n\t\tbreak;\n\t}\n\t \n\tif (mode & S_IRGRP)\n\t\t*p++ = 'r';\n\telse\n\t\t*p++ = '-';\n\tif (mode & S_IWGRP)\n\t\t*p++ = 'w';\n\telse\n\t\t*p++ = '-';\n\tswitch (mode & (S_IXGRP | S_ISGID)) {\n\tcase 0:\n\t\t*p++ = '-';\n\t\tbreak;\n\tcase S_IXGRP:\n\t\t*p++ = 'x';\n\t\tbreak;\n\tcase S_ISGID:\n\t\t*p++ = 'S';\n\t\tbreak;\n\tcase S_IXGRP | S_ISGID:\n\t\t*p++ = 's';\n\t\tbreak;\n\t}\n\t \n\tif (mode & S_IROTH)\n\t\t*p++ = 'r';\n\telse\n\t\t*p++ = '-';\n\tif (mode & S_IWOTH)\n\t\t*p++ = 'w';\n\telse\n\t\t*p++ = '-';\n\tswitch (mode & (S_IXOTH | S_ISVTX)) {\n\tcase 0:\n\t\t*p++ = '-';\n\t\tbreak;\n\tcase S_IXOTH:\n\t\t*p++ = 'x';\n\t\tbreak;\n\tcase S_ISVTX:\n\t\t*p++ = 'T';\n\t\tbreak;\n\tcase S_IXOTH | S_ISVTX:\n\t\t*p++ = 't';\n\t\tbreak;\n\t}\n\t*p++ = ' ';\t\t \n\t*p = '\\0';\n}\n#endif\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}