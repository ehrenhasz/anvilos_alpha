{
  "module_name": "openbsd-compat.h",
  "hash_id": "cf9a54d7ad1fa7834750e0ca6b50b098e7f4e57db57ad640c349e867a57d1153",
  "original_prompt": "Ingested from openssh-9.6p1/openbsd-compat/openbsd-compat.h",
  "human_readable_source": " \n\n#ifndef _OPENBSD_COMPAT_H\n#define _OPENBSD_COMPAT_H\n\n#include \"includes.h\"\n\n#include <sys/types.h>\n#include <pwd.h>\n\n#include <sys/socket.h>\n\n#include <stddef.h>   \n\n \n#include \"base64.h\"\n#include \"sigact.h\"\n#include \"readpassphrase.h\"\n#include \"vis.h\"\n#include \"getrrsetbyname.h\"\n#include \"sha1.h\"\n#include \"sha2.h\"\n#include \"md5.h\"\n#include \"blf.h\"\n#include \"fnmatch.h\"\n\n#if defined(HAVE_LOGIN_CAP) && !defined(HAVE_LOGIN_GETPWCLASS)\n# include <login_cap.h>\n# define login_getpwclass(pw) login_getclass(pw->pw_class)\n#endif\n\n#ifndef HAVE_BASENAME\nchar *basename(const char *path);\n#endif\n\n#ifndef HAVE_BINDRESVPORT_SA\nint bindresvport_sa(int sd, struct sockaddr *sa);\n#endif\n\n#ifndef HAVE_CLOSEFROM\nvoid closefrom(int);\n#endif\n\n#if defined(HAVE_DECL_FTRUNCATE) && HAVE_DECL_FTRUNCATE == 0\nint ftruncate(int filedes, off_t length);\n#endif\n\n#ifndef HAVE_GETLINE\n#include <stdio.h>\nssize_t getline(char **, size_t *, FILE *);\n#endif\n\n#ifndef HAVE_GETPAGESIZE\nint getpagesize(void);\n#endif\n\n#ifndef HAVE_GETCWD\nchar *getcwd(char *pt, size_t size);\n#endif\n\n#ifndef HAVE_KILLPG\nint killpg(pid_t, int);\n#endif\n\n#if defined(HAVE_DECL_MEMMEM) && HAVE_DECL_MEMMEM == 0\nvoid *memmem(const void *, size_t, const void *, size_t);\n#endif\n\n#ifndef HAVE_REALLOCARRAY\nvoid *reallocarray(void *, size_t, size_t);\n#endif\n\n#ifndef HAVE_RECALLOCARRAY\nvoid *recallocarray(void *, size_t, size_t, size_t);\n#endif\n\n#ifndef HAVE_RRESVPORT_AF\nint rresvport_af(int *alport, sa_family_t af);\n#endif\n\n#ifndef HAVE_STRLCPY\nsize_t strlcpy(char *dst, const char *src, size_t siz);\n#endif\n\n#ifndef HAVE_STRLCAT\nsize_t strlcat(char *dst, const char *src, size_t siz);\n#endif\n\n#ifndef HAVE_STRCASESTR\nchar *strcasestr(const char *, const char *);\n#endif\n\n#ifndef HAVE_STRNLEN\nsize_t strnlen(const char *, size_t);\n#endif\n\n#ifndef HAVE_STRNDUP\nchar *strndup(const char *s, size_t n);\n#endif\n\n#ifndef HAVE_SETENV\nint setenv(register const char *name, register const char *value, int rewrite);\n#endif\n\n#ifndef HAVE_STRMODE\nvoid strmode(int mode, char *p);\n#endif\n\n#ifndef HAVE_STRPTIME\n#include  <time.h>\nchar *strptime(const char *buf, const char *fmt, struct tm *tm);\n#endif\n\n#if !defined(HAVE_MKDTEMP)\nint mkstemps(char *path, int slen);\nint mkstemp(char *path);\nchar *mkdtemp(char *path);\n#endif\n\n#define mkstemp(x) _ssh_mkstemp(x)\nint _ssh_mkstemp(char *);\n\n#ifndef HAVE_DAEMON\nint daemon(int nochdir, int noclose);\n#endif\n\n#ifndef HAVE_DIRNAME\nchar *dirname(const char *path);\n#endif\n\n#ifndef HAVE_FMT_SCALED\n#define\tFMT_SCALED_STRSIZE\t7\nint\tfmt_scaled(long long number, char *result);\n#endif\n\n#ifndef HAVE_SCAN_SCALED\nint\tscan_scaled(char *, long long *);\n#endif\n\n#if defined(BROKEN_INET_NTOA) || !defined(HAVE_INET_NTOA)\nchar *inet_ntoa(struct in_addr in);\n#endif\n\n#ifndef HAVE_INET_NTOP\nconst char *inet_ntop(int af, const void *src, char *dst, socklen_t size);\n#endif\n\n#ifndef HAVE_INET_ATON\nint inet_aton(const char *cp, struct in_addr *addr);\n#endif\n\n#ifndef HAVE_STRSEP\nchar *strsep(char **stringp, const char *delim);\n#endif\n\n#ifndef HAVE_SETPROCTITLE\nvoid setproctitle(const char *fmt, ...);\nvoid compat_init_setproctitle(int argc, char *argv[]);\n#endif\n\n#ifndef HAVE_GETGROUPLIST\nint getgrouplist(const char *, gid_t, gid_t *, int *);\n#endif\n\n#if !defined(HAVE_GETOPT) || !defined(HAVE_GETOPT_OPTRESET)\nint BSDgetopt(int argc, char * const *argv, const char *opts);\n#include \"openbsd-compat/getopt.h\"\n#endif\n\n#if ((defined(HAVE_DECL_READV) && HAVE_DECL_READV == 0) || \\\n    (defined(HAVE_DECL_WRITEV) && HAVE_DECL_WRITEV == 0))\n# include <sys/types.h>\n# include <sys/uio.h>\n\n# if defined(HAVE_DECL_READV) && HAVE_DECL_READV == 0\nint readv(int, struct iovec *, int);\n# endif\n\n# if defined(HAVE_DECL_WRITEV) && HAVE_DECL_WRITEV == 0\nint writev(int, struct iovec *, int);\n# endif\n#endif\n\n \n#include \"bsd-signal.h\"\n#include \"bsd-misc.h\"\n#include \"bsd-setres_id.h\"\n#include \"bsd-statvfs.h\"\n#include \"bsd-waitpid.h\"\n#include \"bsd-poll.h\"\n\n#if defined(HAVE_DECL_GETPEEREID) && HAVE_DECL_GETPEEREID == 0\nint getpeereid(int , uid_t *, gid_t *);\n#endif\n\n#ifndef HAVE_ARC4RANDOM\nuint32_t arc4random(void);\n#endif  \n\n#ifndef HAVE_ARC4RANDOM_BUF\nvoid arc4random_buf(void *, size_t);\n#endif\n\n#ifndef HAVE_ARC4RANDOM_STIR\n# define arc4random_stir()\n#endif\n\n#ifndef HAVE_ARC4RANDOM_UNIFORM\nuint32_t arc4random_uniform(uint32_t);\n#endif\n\n#ifndef HAVE_ASPRINTF\nint asprintf(char **, const char *, ...);\n#endif\n\n#ifndef HAVE_OPENPTY\n# include <sys/ioctl.h>\t \nint openpty(int *, int *, char *, struct termios *, struct winsize *);\n#endif  \n\n#ifndef HAVE_SNPRINTF\nint snprintf(char *, size_t, SNPRINTF_CONST char *, ...);\n#endif\n\n#ifndef HAVE_STRTOLL\nlong long strtoll(const char *, char **, int);\n#endif\n\n#ifndef HAVE_STRTOUL\nunsigned long strtoul(const char *, char **, int);\n#endif\n\n#ifndef HAVE_STRTOULL\nunsigned long long strtoull(const char *, char **, int);\n#endif\n\n#ifndef HAVE_STRTONUM\nlong long strtonum(const char *, long long, long long, const char **);\n#endif\n\n \n#ifndef HAVE_MBLEN\n# define mblen(x, y)\t(1)\n#endif\n\n#ifndef HAVE_WCWIDTH\n# define wcwidth(x)\t(((x) >= 0x20 && (x) <= 0x7e) ? 1 : -1)\n \n# undef HAVE_NL_LANGINFO\n# undef HAVE_MBTOWC\n# undef HAVE_LANGINFO_H\n#endif\n\n#ifndef HAVE_NL_LANGINFO\n# define nl_langinfo(x)\t\"\"\n#endif\n\n#ifndef HAVE_MBTOWC\nint mbtowc(wchar_t *, const char*, size_t);\n#endif\n\n#if !defined(HAVE_VASPRINTF) || !defined(HAVE_VSNPRINTF)\n# include <stdarg.h>\n#endif\n\n \n#ifndef VA_COPY\n# ifdef HAVE_VA_COPY\n#  define VA_COPY(dest, src) va_copy(dest, src)\n# else\n#  ifdef HAVE___VA_COPY\n#   define VA_COPY(dest, src) __va_copy(dest, src)\n#  else\n#   define VA_COPY(dest, src) (dest) = (src)\n#  endif\n# endif\n#endif\n\n#ifndef HAVE_VASPRINTF\nint vasprintf(char **, const char *, va_list);\n#endif\n\n#ifndef HAVE_VSNPRINTF\nint vsnprintf(char *, size_t, const char *, va_list);\n#endif\n\n#ifndef HAVE_USER_FROM_UID\nchar *user_from_uid(uid_t, int);\n#endif\n\n#ifndef HAVE_GROUP_FROM_GID\nchar *group_from_gid(gid_t, int);\n#endif\n\n#ifndef HAVE_TIMINGSAFE_BCMP\nint timingsafe_bcmp(const void *, const void *, size_t);\n#endif\n\n#ifndef HAVE_BCRYPT_PBKDF\nint\tbcrypt_pbkdf(const char *, size_t, const uint8_t *, size_t,\n    uint8_t *, size_t, unsigned int);\n#endif\n\n#ifndef HAVE_EXPLICIT_BZERO\nvoid explicit_bzero(void *p, size_t n);\n#endif\n\n#ifndef HAVE_FREEZERO\nvoid freezero(void *, size_t);\n#endif\n\n#ifndef HAVE_LOCALTIME_R\nstruct tm *localtime_r(const time_t *, struct tm *);\n#endif\n\n#ifndef HAVE_TIMEGM\n#include <time.h>\ntime_t timegm(struct tm *);\n#endif\n\nchar *xcrypt(const char *password, const char *salt);\nchar *shadow_pw(struct passwd *pw);\n\n \n#include \"fake-rfc2553.h\"\n\n \n#include \"bsd-cygwin_util.h\"\n\n#include \"port-aix.h\"\n#include \"port-irix.h\"\n#include \"port-linux.h\"\n#include \"port-solaris.h\"\n#include \"port-net.h\"\n#include \"port-uw.h\"\n\n \n#if defined(HAVE_FEATURES_H) && defined(_FORTIFY_SOURCE)\n# include <features.h>\n# if defined(__GNU_LIBRARY__) && defined(__GLIBC_PREREQ)\n#  if __GLIBC_PREREQ(2, 15) && (_FORTIFY_SOURCE > 0)\n#   include <sys/socket.h>   \n#   undef FD_SET\n#   undef FD_ISSET\n#   define FD_SET(n, set)\tkludge_FD_SET(n, set)\n#   define FD_ISSET(n, set)\tkludge_FD_ISSET(n, set)\nvoid kludge_FD_SET(int, fd_set *);\nint kludge_FD_ISSET(int, fd_set *);\n#  endif  \n# endif  \n#endif  \n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}