{
  "module_name": "inet_aton.c",
  "hash_id": "c931481cbc582603dfdfca4dbb89e1c3826dd4700b9b91da7ce055178f5b81c9",
  "original_prompt": "Ingested from openssh-9.6p1/openbsd-compat/inet_aton.c",
  "human_readable_source": " \n\n \n\n \n\n#include \"includes.h\"\n\n#if !defined(HAVE_INET_ATON)\n\n#include <sys/types.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <ctype.h>\n\n#if 0\n \nin_addr_t\ninet_addr(const char *cp)\n{\n\tstruct in_addr val;\n\n\tif (inet_aton(cp, &val))\n\t\treturn (val.s_addr);\n\treturn (INADDR_NONE);\n}\n#endif\n\n \nint\ninet_aton(const char *cp, struct in_addr *addr)\n{\n\tu_int32_t val;\n\tint base, n;\n\tchar c;\n\tu_int parts[4];\n\tu_int *pp = parts;\n\n\tc = *cp;\n\tfor (;;) {\n\t\t \n\t\tif (!isdigit(c))\n\t\t\treturn (0);\n\t\tval = 0; base = 10;\n\t\tif (c == '0') {\n\t\t\tc = *++cp;\n\t\t\tif (c == 'x' || c == 'X')\n\t\t\t\tbase = 16, c = *++cp;\n\t\t\telse\n\t\t\t\tbase = 8;\n\t\t}\n\t\tfor (;;) {\n\t\t\tif (isascii(c) && isdigit(c)) {\n\t\t\t\tval = (val * base) + (c - '0');\n\t\t\t\tc = *++cp;\n\t\t\t} else if (base == 16 && isascii(c) && isxdigit(c)) {\n\t\t\t\tval = (val << 4) |\n\t\t\t\t\t(c + 10 - (islower(c) ? 'a' : 'A'));\n\t\t\t\tc = *++cp;\n\t\t\t} else\n\t\t\t\tbreak;\n\t\t}\n\t\tif (c == '.') {\n\t\t\t \n\t\t\tif (pp >= parts + 3)\n\t\t\t\treturn (0);\n\t\t\t*pp++ = val;\n\t\t\tc = *++cp;\n\t\t} else\n\t\t\tbreak;\n\t}\n\t \n\tif (c != '\\0' && (!isascii(c) || !isspace(c)))\n\t\treturn (0);\n\t \n\tn = pp - parts + 1;\n\tswitch (n) {\n\n\tcase 0:\n\t\treturn (0);\t\t \n\n\tcase 1:\t\t\t\t \n\t\tbreak;\n\n\tcase 2:\t\t\t\t \n\t\tif ((val > 0xffffff) || (parts[0] > 0xff))\n\t\t\treturn (0);\n\t\tval |= parts[0] << 24;\n\t\tbreak;\n\n\tcase 3:\t\t\t\t \n\t\tif ((val > 0xffff) || (parts[0] > 0xff) || (parts[1] > 0xff))\n\t\t\treturn (0);\n\t\tval |= (parts[0] << 24) | (parts[1] << 16);\n\t\tbreak;\n\n\tcase 4:\t\t\t\t \n\t\tif ((val > 0xff) || (parts[0] > 0xff) || (parts[1] > 0xff) || (parts[2] > 0xff))\n\t\t\treturn (0);\n\t\tval |= (parts[0] << 24) | (parts[1] << 16) | (parts[2] << 8);\n\t\tbreak;\n\t}\n\tif (addr)\n\t\taddr->s_addr = htonl(val);\n\treturn (1);\n}\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}