{
  "module_name": "strtoul.c",
  "hash_id": "840ab95416d212255f9e844e2cf2bdcb321d6c1384c48d032ab25d975dba397f",
  "original_prompt": "Ingested from openssh-9.6p1/openbsd-compat/strtoul.c",
  "human_readable_source": " \n \n\n \n\n#include \"includes.h\"\n#ifndef HAVE_STRTOUL\n\n#include <ctype.h>\n#include <errno.h>\n#include <limits.h>\n#include <stdlib.h>\n\n \nunsigned long\nstrtoul(const char *nptr, char **endptr, int base)\n{\n\tconst char *s;\n\tunsigned long acc, cutoff;\n\tint c;\n\tint neg, any, cutlim;\n\n\t \n\ts = nptr;\n\tdo {\n\t\tc = (unsigned char) *s++;\n\t} while (isspace(c));\n\tif (c == '-') {\n\t\tneg = 1;\n\t\tc = *s++;\n\t} else {\n\t\tneg = 0;\n\t\tif (c == '+')\n\t\t\tc = *s++;\n\t}\n\tif ((base == 0 || base == 16) &&\n\t    c == '0' && (*s == 'x' || *s == 'X')) {\n\t\tc = s[1];\n\t\ts += 2;\n\t\tbase = 16;\n\t}\n\tif (base == 0)\n\t\tbase = c == '0' ? 8 : 10;\n\n\tcutoff = ULONG_MAX / (unsigned long)base;\n\tcutlim = ULONG_MAX % (unsigned long)base;\n\tfor (acc = 0, any = 0;; c = (unsigned char) *s++) {\n\t\tif (isdigit(c))\n\t\t\tc -= '0';\n\t\telse if (isalpha(c))\n\t\t\tc -= isupper(c) ? 'A' - 10 : 'a' - 10;\n\t\telse\n\t\t\tbreak;\n\t\tif (c >= base)\n\t\t\tbreak;\n\t\tif (any < 0)\n\t\t\tcontinue;\n\t\tif (acc > cutoff || acc == cutoff && c > cutlim) {\n\t\t\tany = -1;\n\t\t\tacc = ULONG_MAX;\n\t\t\terrno = ERANGE;\n\t\t} else {\n\t\t\tany = 1;\n\t\t\tacc *= (unsigned long)base;\n\t\t\tacc += c;\n\t\t}\n\t}\n\tif (neg && any > 0)\n\t\tacc = -acc;\n\tif (endptr != 0)\n\t\t*endptr = (char *) (any ? s - 1 : nptr);\n\treturn (acc);\n}\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}