{
  "module_name": "ssh-keyscan.1",
  "hash_id": "9e8a2f33b165ccb589067253b21226af2fbba9f519bf866da95f8c348b83bcd5",
  "original_prompt": "Ingested from openssh-9.6p1/ssh-keyscan.1",
  "human_readable_source": ".\\\"\t$OpenBSD: ssh-keyscan.1,v 1.49 2023/02/10 06:41:53 jmc Exp $\n.\\\"\n.\\\" Copyright 1995, 1996 by David Mazieres <dm@lcs.mit.edu>.\n.\\\"\n.\\\" Modification and redistribution in source and binary forms is\n.\\\" permitted provided that due credit is given to the author and the\n.\\\" OpenBSD project by leaving this copyright notice intact.\n.\\\"\n.Dd $Mdocdate: February 10 2023 $\n.Dt SSH-KEYSCAN 1\n.Os\n.Sh NAME\n.Nm ssh-keyscan\n.Nd gather SSH public keys from servers\n.Sh SYNOPSIS\n.Nm ssh-keyscan\n.Op Fl 46cDHv\n.Op Fl f Ar file\n.Op Fl O Ar option\n.Op Fl p Ar port\n.Op Fl T Ar timeout\n.Op Fl t Ar type\n.Op Ar host | addrlist namelist\n.Sh DESCRIPTION\n.Nm\nis a utility for gathering the public SSH host keys of a number of\nhosts.\nIt was designed to aid in building and verifying\n.Pa ssh_known_hosts\nfiles,\nthe format of which is documented in\n.Xr sshd 8 .\n.Nm\nprovides a minimal interface suitable for use by shell and perl\nscripts.\n.Pp\n.Nm\nuses non-blocking socket I/O to contact as many hosts as possible in\nparallel, so it is very efficient.\nThe keys from a domain of 1,000\nhosts can be collected in tens of seconds, even when some of those\nhosts are down or do not run\n.Xr sshd 8 .\nFor scanning, one does not need\nlogin access to the machines that are being scanned, nor does the\nscanning process involve any encryption.\n.Pp\nHosts to be scanned may be specified by hostname, address or by CIDR\nnetwork range (e.g. 192.168.16/28).\nIf a network range is specified, then all addresses in that range will\nbe scanned.\n.Pp\nThe options are as follows:\n.Bl -tag -width Ds\n.It Fl 4\nForce\n.Nm\nto use IPv4 addresses only.\n.It Fl 6\nForce\n.Nm\nto use IPv6 addresses only.\n.It Fl c\nRequest certificates from target hosts instead of plain keys.\n.It Fl D\nPrint keys found as SSHFP DNS records.\nThe default is to print keys in a format usable as a\n.Xr ssh 1\n.Pa known_hosts\nfile.\n.It Fl f Ar file\nRead hosts or\n.Dq addrlist namelist\npairs from\n.Ar file ,\none per line.\nIf\n.Sq -\nis supplied instead of a filename,\n.Nm\nwill read from the standard input.\nNames read from a file must start with an address, hostname or CIDR network\nrange to be scanned.\nAddresses and hostnames may optionally be followed by comma-separated name\nor address aliases that will be copied to the output.\nFor example:\n.Bd -literal\n192.168.11.0/24\n10.20.1.1\nhappy.example.org\n10.0.0.1,sad.example.org\n.Ed\n.It Fl H\nHash all hostnames and addresses in the output.\nHashed names may be used normally by\n.Xr ssh 1\nand\n.Xr sshd 8 ,\nbut they do not reveal identifying information should the file's contents\nbe disclosed.\n.It Fl O Ar option\nSpecify a key/value option.\nAt present, only a single option is supported:\n.Bl -tag -width Ds\n.It Cm hashalg Ns = Ns Ar algorithm\nSelects a hash algorithm to use when printing SSHFP records using the\n.Fl D\nflag.\nValid algorithms are\n.Dq sha1\nand\n.Dq sha256 .\nThe default is to print both.\n.El\n.It Fl p Ar port\nConnect to\n.Ar port\non the remote host.\n.It Fl T Ar timeout\nSet the timeout for connection attempts.\nIf\n.Ar timeout\nseconds have elapsed since a connection was initiated to a host or since the\nlast time anything was read from that host, the connection is\nclosed and the host in question considered unavailable.\nThe default is 5 seconds.\n.It Fl t Ar type\nSpecify the type of the key to fetch from the scanned hosts.\nThe possible values are\n.Dq dsa ,\n.Dq ecdsa ,\n.Dq ed25519 ,\n.Dq ecdsa-sk ,\n.Dq ed25519-sk ,\nor\n.Dq rsa .\nMultiple values may be specified by separating them with commas.\nThe default is to fetch\n.Dq rsa ,\n.Dq ecdsa ,\n.Dq ed25519 ,\n.Dq ecdsa-sk ,\nand\n.Dq ed25519-sk\nkeys.\n.It Fl v\nVerbose mode:\nprint debugging messages about progress.\n.El\n.Pp\nIf an ssh_known_hosts file is constructed using\n.Nm\nwithout verifying the keys, users will be vulnerable to\n.Em man in the middle\nattacks.\nOn the other hand, if the security model allows such a risk,\n.Nm\ncan help in the detection of tampered keyfiles or man in the middle\nattacks which have begun after the ssh_known_hosts file was created.\n.Sh FILES\n.Pa /etc/ssh/ssh_known_hosts\n.Sh EXAMPLES\nPrint the RSA host key for machine\n.Ar hostname :\n.Pp\n.Dl $ ssh-keyscan -t rsa hostname\n.Pp\nSearch a network range, printing all supported key types:\n.Pp\n.Dl $ ssh-keyscan 192.168.0.64/25\n.Pp\nFind all hosts from the file\n.Pa ssh_hosts\nwhich have new or different keys from those in the sorted file\n.Pa ssh_known_hosts :\n.Bd -literal -offset indent\n$ ssh-keyscan -t rsa,dsa,ecdsa,ed25519 -f ssh_hosts | \\e\n\tsort -u - ssh_known_hosts | diff ssh_known_hosts -\n.Ed\n.Sh SEE ALSO\n.Xr ssh 1 ,\n.Xr sshd 8\n.Rs\n.%D 2006\n.%R RFC 4255\n.%T Using DNS to Securely Publish Secure Shell (SSH) Key Fingerprints\n.Re\n.Sh AUTHORS\n.An -nosplit\n.An David Mazieres Aq Mt dm@lcs.mit.edu\nwrote the initial version, and\n.An Wayne Davison Aq Mt wayned@users.sourceforge.net\nadded support for protocol version 2.\n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}