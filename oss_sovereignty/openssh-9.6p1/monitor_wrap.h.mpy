{
  "module_name": "monitor_wrap.h",
  "hash_id": "1ace15ca5064206aff1839d5c222ec94416cfee1e12fe7193e0ae3816d784d43",
  "original_prompt": "Ingested from openssh-9.6p1/monitor_wrap.h",
  "human_readable_source": " \n\n \n\n#ifndef _MM_WRAP_H_\n#define _MM_WRAP_H_\n\nextern int use_privsep;\n#define PRIVSEP(x)\t(use_privsep ? mm_##x : x)\n\nenum mm_keytype { MM_NOKEY, MM_HOSTKEY, MM_USERKEY };\n\nstruct ssh;\nstruct monitor;\nstruct Authctxt;\nstruct sshkey;\nstruct sshauthopt;\nstruct sshkey_sig_details;\n\nvoid mm_log_handler(LogLevel, int, const char *, void *);\nint mm_is_monitor(void);\n#ifdef WITH_OPENSSL\nDH *mm_choose_dh(int, int, int);\n#endif\nint mm_sshkey_sign(struct ssh *, struct sshkey *, u_char **, size_t *,\n    const u_char *, size_t, const char *, const char *,\n    const char *, u_int compat);\nvoid mm_inform_authserv(char *, char *);\nstruct passwd *mm_getpwnamallow(struct ssh *, const char *);\nchar *mm_auth2_read_banner(void);\nint mm_auth_password(struct ssh *, char *);\nint mm_key_allowed(enum mm_keytype, const char *, const char *, struct sshkey *,\n    int, struct sshauthopt **);\nint mm_user_key_allowed(struct ssh *ssh, struct passwd *, struct sshkey *, int,\n    struct sshauthopt **);\nint mm_hostbased_key_allowed(struct ssh *, struct passwd *, const char *,\n    const char *, struct sshkey *);\nint mm_sshkey_verify(const struct sshkey *, const u_char *, size_t,\n    const u_char *, size_t, const char *, u_int, struct sshkey_sig_details **);\n\n#ifdef GSSAPI\nOM_uint32 mm_ssh_gssapi_server_ctx(Gssctxt **, gss_OID);\nOM_uint32 mm_ssh_gssapi_accept_ctx(Gssctxt *,\n   gss_buffer_desc *, gss_buffer_desc *, OM_uint32 *);\nint mm_ssh_gssapi_userok(char *user);\nOM_uint32 mm_ssh_gssapi_checkmic(Gssctxt *, gss_buffer_t, gss_buffer_t);\n#endif\n\n#ifdef USE_PAM\nvoid mm_start_pam(struct ssh *ssh);\nu_int mm_do_pam_account(void);\nvoid *mm_sshpam_init_ctx(struct Authctxt *);\nint mm_sshpam_query(void *, char **, char **, u_int *, char ***, u_int **);\nint mm_sshpam_respond(void *, u_int, char **);\nvoid mm_sshpam_free_ctx(void *);\n#endif\n\n#ifdef SSH_AUDIT_EVENTS\n#include \"audit.h\"\nvoid mm_audit_event(struct ssh *, ssh_audit_event_t);\nvoid mm_audit_run_command(const char *);\n#endif\n\nstruct Session;\nvoid mm_terminate(void);\nint mm_pty_allocate(int *, int *, char *, size_t);\nvoid mm_session_pty_cleanup2(struct Session *);\n\n \nstruct newkeys *mm_newkeys_from_blob(u_char *, int);\nint mm_newkeys_to_blob(int, u_char **, u_int *);\n\nvoid mm_send_keystate(struct ssh *, struct monitor*);\n\n \nint mm_bsdauth_query(void *, char **, char **, u_int *, char ***, u_int **);\nint mm_bsdauth_respond(void *, u_int, char **);\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}