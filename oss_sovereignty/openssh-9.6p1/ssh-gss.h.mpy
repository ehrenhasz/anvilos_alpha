{
  "module_name": "ssh-gss.h",
  "hash_id": "f250e319b0a245faeed2fd6c9fe94bcf60a543e7b38e3d44e6cc4a0dea415e2b",
  "original_prompt": "Ingested from openssh-9.6p1/ssh-gss.h",
  "human_readable_source": " \n \n\n#ifndef _SSH_GSS_H\n#define _SSH_GSS_H\n\n#ifdef GSSAPI\n\n#ifdef HAVE_GSSAPI_H\n#include <gssapi.h>\n#elif defined(HAVE_GSSAPI_GSSAPI_H)\n#include <gssapi/gssapi.h>\n#endif\n\n#ifdef KRB5\n# ifndef HEIMDAL\n#  ifdef HAVE_GSSAPI_GENERIC_H\n#   include <gssapi_generic.h>\n#  elif defined(HAVE_GSSAPI_GSSAPI_GENERIC_H)\n#   include <gssapi/gssapi_generic.h>\n#  endif\n\n \n\n#  if !HAVE_DECL_GSS_C_NT_HOSTBASED_SERVICE\n#   define GSS_C_NT_HOSTBASED_SERVICE gss_nt_service_name\n#  endif  \n\n# endif  \n#endif  \n\n \n#define SSH2_MSG_USERAUTH_GSSAPI_RESPONSE\t\t60\n#define SSH2_MSG_USERAUTH_GSSAPI_TOKEN\t\t\t61\n#define SSH2_MSG_USERAUTH_GSSAPI_EXCHANGE_COMPLETE\t63\n#define SSH2_MSG_USERAUTH_GSSAPI_ERROR\t\t\t64\n#define SSH2_MSG_USERAUTH_GSSAPI_ERRTOK\t\t\t65\n#define SSH2_MSG_USERAUTH_GSSAPI_MIC\t\t\t66\n\n#define SSH_GSS_OIDTYPE 0x06\n\ntypedef struct {\n\tchar *filename;\n\tchar *envvar;\n\tchar *envval;\n\tvoid *data;\n} ssh_gssapi_ccache;\n\ntypedef struct {\n\tgss_buffer_desc displayname;\n\tgss_buffer_desc exportedname;\n\tgss_cred_id_t creds;\n\tstruct ssh_gssapi_mech_struct *mech;\n\tssh_gssapi_ccache store;\n} ssh_gssapi_client;\n\ntypedef struct ssh_gssapi_mech_struct {\n\tchar *enc_name;\n\tchar *name;\n\tgss_OID_desc oid;\n\tint (*dochild) (ssh_gssapi_client *);\n\tint (*userok) (ssh_gssapi_client *, char *);\n\tint (*localname) (ssh_gssapi_client *, char **);\n\tvoid (*storecreds) (ssh_gssapi_client *);\n} ssh_gssapi_mech;\n\ntypedef struct {\n\tOM_uint32\tmajor;  \n\tOM_uint32\tminor;  \n\tgss_ctx_id_t\tcontext;  \n\tgss_name_t\tname;  \n\tgss_OID\t\toid;  \n\tgss_cred_id_t\tcreds;  \n\tgss_name_t\tclient;  \n\tgss_cred_id_t\tclient_creds;  \n} Gssctxt;\n\nextern ssh_gssapi_mech *supported_mechs[];\n\nint  ssh_gssapi_check_oid(Gssctxt *, void *, size_t);\nvoid ssh_gssapi_set_oid_data(Gssctxt *, void *, size_t);\nvoid ssh_gssapi_set_oid(Gssctxt *, gss_OID);\nvoid ssh_gssapi_supported_oids(gss_OID_set *);\nssh_gssapi_mech *ssh_gssapi_get_ctype(Gssctxt *);\nvoid ssh_gssapi_prepare_supported_oids(void);\nOM_uint32 ssh_gssapi_test_oid_supported(OM_uint32 *, gss_OID, int *);\n\nstruct sshbuf;\nint ssh_gssapi_get_buffer_desc(struct sshbuf *, gss_buffer_desc *);\n\nOM_uint32 ssh_gssapi_import_name(Gssctxt *, const char *);\nOM_uint32 ssh_gssapi_init_ctx(Gssctxt *, int,\n    gss_buffer_desc *, gss_buffer_desc *, OM_uint32 *);\nOM_uint32 ssh_gssapi_accept_ctx(Gssctxt *,\n    gss_buffer_desc *, gss_buffer_desc *, OM_uint32 *);\nOM_uint32 ssh_gssapi_getclient(Gssctxt *, ssh_gssapi_client *);\nvoid ssh_gssapi_error(Gssctxt *);\nchar *ssh_gssapi_last_error(Gssctxt *, OM_uint32 *, OM_uint32 *);\nvoid ssh_gssapi_build_ctx(Gssctxt **);\nvoid ssh_gssapi_delete_ctx(Gssctxt **);\nOM_uint32 ssh_gssapi_sign(Gssctxt *, gss_buffer_t, gss_buffer_t);\nvoid ssh_gssapi_buildmic(struct sshbuf *, const char *,\n    const char *, const char *, const struct sshbuf *);\nint ssh_gssapi_check_mechanism(Gssctxt **, gss_OID, const char *);\n\n \nOM_uint32 ssh_gssapi_server_ctx(Gssctxt **, gss_OID);\nint ssh_gssapi_userok(char *name);\nOM_uint32 ssh_gssapi_checkmic(Gssctxt *, gss_buffer_t, gss_buffer_t);\nvoid ssh_gssapi_do_child(char ***, u_int *);\nvoid ssh_gssapi_cleanup_creds(void);\nvoid ssh_gssapi_storecreds(void);\nconst char *ssh_gssapi_displayname(void);\n\n#endif  \n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}