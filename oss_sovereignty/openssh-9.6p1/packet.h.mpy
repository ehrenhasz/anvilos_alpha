{
  "module_name": "packet.h",
  "hash_id": "d0ea4cbcdfbcea76f5855c319111969fbbd7f4e2c4b108cbd28f80e9facb8948",
  "original_prompt": "Ingested from openssh-9.6p1/packet.h",
  "human_readable_source": " \n\n \n\n#ifndef PACKET_H\n#define PACKET_H\n\n#include <termios.h>\n\n#ifdef WITH_OPENSSL\n# include <openssl/bn.h>\n# ifdef OPENSSL_HAS_ECC\n#  include <openssl/ec.h>\n# else  \n#  define EC_KEY\tvoid\n#  define EC_GROUP\tvoid\n#  define EC_POINT\tvoid\n# endif  \n#else  \n# define BIGNUM\t\tvoid\n# define EC_KEY\t\tvoid\n# define EC_GROUP\tvoid\n# define EC_POINT\tvoid\n#endif  \n\n#include <signal.h>\n#include \"openbsd-compat/sys-queue.h\"\n\nstruct kex;\nstruct sshkey;\nstruct sshbuf;\nstruct session_state;\t \n\n#include \"dispatch.h\"\t \n\nstruct key_entry {\n\tTAILQ_ENTRY(key_entry) next;\n\tstruct sshkey *key;\n};\n\nstruct ssh {\n\t \n\tstruct session_state *state;\n\n\t \n\tstruct kex *kex;\n\n\t \n\tchar *remote_ipaddr;\n\tint remote_port;\n\tchar *local_ipaddr;\n\tint local_port;\n\tchar *rdomain_in;\n\n\t \n\tchar *log_preamble;\n\n\t \n\tdispatch_fn *dispatch[DISPATCH_MAX];\n\t \n\tint dispatch_skip_packets;\n\n\t \n\tint compat;\n\n\t \n\tTAILQ_HEAD(, key_entry) private_keys;\n\tTAILQ_HEAD(, key_entry) public_keys;\n\n\t \n\tvoid *authctxt;\n\n\t \n\tstruct ssh_channels *chanctxt;\n\n\t \n\tvoid *app_data;\n};\n\ntypedef int (ssh_packet_hook_fn)(struct ssh *, struct sshbuf *,\n    u_char *, void *);\n\nstruct ssh *ssh_alloc_session_state(void);\nstruct ssh *ssh_packet_set_connection(struct ssh *, int, int);\nvoid     ssh_packet_set_timeout(struct ssh *, int, int);\nint\t ssh_packet_stop_discard(struct ssh *);\nint\t ssh_packet_connection_af(struct ssh *);\nvoid     ssh_packet_set_nonblocking(struct ssh *);\nint      ssh_packet_get_connection_in(struct ssh *);\nint      ssh_packet_get_connection_out(struct ssh *);\nvoid     ssh_packet_close(struct ssh *);\nvoid\t ssh_packet_set_input_hook(struct ssh *, ssh_packet_hook_fn *, void *);\nvoid\t ssh_packet_clear_keys(struct ssh *);\nvoid\t ssh_clear_newkeys(struct ssh *, int);\n\nint\t ssh_packet_is_rekeying(struct ssh *);\nint\t ssh_packet_check_rekey(struct ssh *);\nvoid     ssh_packet_set_protocol_flags(struct ssh *, u_int);\nu_int\t ssh_packet_get_protocol_flags(struct ssh *);\nvoid\t ssh_packet_set_tos(struct ssh *, int);\nvoid     ssh_packet_set_interactive(struct ssh *, int, int, int);\nint      ssh_packet_is_interactive(struct ssh *);\nvoid     ssh_packet_set_server(struct ssh *);\nvoid     ssh_packet_set_authenticated(struct ssh *);\nvoid     ssh_packet_set_mux(struct ssh *);\nint\t ssh_packet_get_mux(struct ssh *);\nint\t ssh_packet_set_log_preamble(struct ssh *, const char *, ...)\n    __attribute__((format(printf, 2, 3)));\n\nint\t ssh_packet_log_type(u_char);\n\nint\t ssh_packet_send2_wrapped(struct ssh *);\nint\t ssh_packet_send2(struct ssh *);\n\nint      ssh_packet_read(struct ssh *);\nint      ssh_packet_read_poll(struct ssh *);\nint ssh_packet_read_poll2(struct ssh *, u_char *, u_int32_t *seqnr_p);\nint\t ssh_packet_process_incoming(struct ssh *, const char *buf, u_int len);\nint\t ssh_packet_process_read(struct ssh *, int);\nint      ssh_packet_read_seqnr(struct ssh *, u_char *, u_int32_t *seqnr_p);\nint      ssh_packet_read_poll_seqnr(struct ssh *, u_char *, u_int32_t *seqnr_p);\n\nconst void *ssh_packet_get_string_ptr(struct ssh *, u_int *length_ptr);\nvoid     ssh_packet_disconnect(struct ssh *, const char *fmt, ...)\n\t__attribute__((format(printf, 2, 3)))\n\t__attribute__((noreturn));\nvoid     ssh_packet_send_debug(struct ssh *, const char *fmt, ...) __attribute__((format(printf, 2, 3)));\n\nint\t ssh_set_newkeys(struct ssh *, int mode);\nvoid\t ssh_packet_get_bytes(struct ssh *, u_int64_t *, u_int64_t *);\n\nint\t ssh_packet_write_poll(struct ssh *);\nint\t ssh_packet_write_wait(struct ssh *);\nint      ssh_packet_have_data_to_write(struct ssh *);\nint      ssh_packet_not_very_much_data_to_write(struct ssh *);\nint\t ssh_packet_interactive_data_to_write(struct ssh *);\n\nint\t ssh_packet_connection_is_on_socket(struct ssh *);\nint\t ssh_packet_remaining(struct ssh *);\n\nvoid\t ssh_tty_make_modes(struct ssh *, int, struct termios *);\nvoid\t ssh_tty_parse_modes(struct ssh *, int);\n\nvoid\t ssh_packet_set_alive_timeouts(struct ssh *, int);\nint\t ssh_packet_inc_alive_timeouts(struct ssh *);\nint\t ssh_packet_set_maxsize(struct ssh *, u_int);\nu_int\t ssh_packet_get_maxsize(struct ssh *);\n\nint\t ssh_packet_get_state(struct ssh *, struct sshbuf *);\nint\t ssh_packet_set_state(struct ssh *, struct sshbuf *);\n\nconst char *ssh_remote_ipaddr(struct ssh *);\nint\t ssh_remote_port(struct ssh *);\nconst char *ssh_local_ipaddr(struct ssh *);\nint\t ssh_local_port(struct ssh *);\nconst char *ssh_packet_rdomain_in(struct ssh *);\n\nvoid\t ssh_packet_set_rekey_limits(struct ssh *, u_int64_t, u_int32_t);\ntime_t\t ssh_packet_get_rekey_timeout(struct ssh *);\n\nvoid\t*ssh_packet_get_input(struct ssh *);\nvoid\t*ssh_packet_get_output(struct ssh *);\n\n \nint\tsshpkt_start(struct ssh *ssh, u_char type);\nint\tsshpkt_send(struct ssh *ssh);\nint     sshpkt_disconnect(struct ssh *, const char *fmt, ...)\n\t    __attribute__((format(printf, 2, 3)));\nint\tsshpkt_add_padding(struct ssh *, u_char);\nvoid\tsshpkt_fatal(struct ssh *ssh, int r, const char *fmt, ...)\n\t    __attribute__((format(printf, 3, 4)))\n\t    __attribute__((noreturn));\nint\tsshpkt_msg_ignore(struct ssh *, u_int);\n\nint\tsshpkt_put(struct ssh *ssh, const void *v, size_t len);\nint\tsshpkt_putb(struct ssh *ssh, const struct sshbuf *b);\nint\tsshpkt_put_u8(struct ssh *ssh, u_char val);\nint\tsshpkt_put_u32(struct ssh *ssh, u_int32_t val);\nint\tsshpkt_put_u64(struct ssh *ssh, u_int64_t val);\nint\tsshpkt_put_string(struct ssh *ssh, const void *v, size_t len);\nint\tsshpkt_put_cstring(struct ssh *ssh, const void *v);\nint\tsshpkt_put_stringb(struct ssh *ssh, const struct sshbuf *v);\nint\tsshpkt_put_ec(struct ssh *ssh, const EC_POINT *v, const EC_GROUP *g);\nint\tsshpkt_put_bignum2(struct ssh *ssh, const BIGNUM *v);\n\nint\tsshpkt_get(struct ssh *ssh, void *valp, size_t len);\nint\tsshpkt_get_u8(struct ssh *ssh, u_char *valp);\nint\tsshpkt_get_u32(struct ssh *ssh, u_int32_t *valp);\nint\tsshpkt_get_u64(struct ssh *ssh, u_int64_t *valp);\nint\tsshpkt_get_string(struct ssh *ssh, u_char **valp, size_t *lenp);\nint\tsshpkt_get_string_direct(struct ssh *ssh, const u_char **valp, size_t *lenp);\nint\tsshpkt_peek_string_direct(struct ssh *ssh, const u_char **valp, size_t *lenp);\nint\tsshpkt_get_cstring(struct ssh *ssh, char **valp, size_t *lenp);\nint\tsshpkt_getb_froms(struct ssh *ssh, struct sshbuf **valp);\nint\tsshpkt_get_ec(struct ssh *ssh, EC_POINT *v, const EC_GROUP *g);\nint\tsshpkt_get_bignum2(struct ssh *ssh, BIGNUM **valp);\nint\tsshpkt_get_end(struct ssh *ssh);\nvoid\tsshpkt_fmt_connection_id(struct ssh *ssh, char *s, size_t l);\nconst u_char\t*sshpkt_ptr(struct ssh *, size_t *lenp);\n\n#if !defined(WITH_OPENSSL)\n# undef BIGNUM\n# undef EC_KEY\n# undef EC_GROUP\n# undef EC_POINT\n#elif !defined(OPENSSL_HAS_ECC)\n# undef EC_KEY\n# undef EC_GROUP\n# undef EC_POINT\n#endif\n\n#endif\t\t\t\t \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}