{
  "module_name": "auth.h",
  "hash_id": "be68f6e154209d62192db513492eb173b1bdac3eb07f1d1eecf995b23656655c",
  "original_prompt": "Ingested from openssh-9.6p1/auth.h",
  "human_readable_source": " \n\n \n\n#ifndef AUTH_H\n#define AUTH_H\n\n#include <signal.h>\n#include <stdio.h>\n\n#ifdef HAVE_LOGIN_CAP\n#include <login_cap.h>\n#endif\n#ifdef BSD_AUTH\n#include <bsd_auth.h>\n#endif\n#ifdef KRB5\n#include <krb5.h>\n#endif\n\nstruct passwd;\nstruct ssh;\nstruct sshbuf;\nstruct sshkey;\nstruct sshkey_cert;\nstruct sshauthopt;\n\ntypedef struct Authctxt Authctxt;\ntypedef struct Authmethod Authmethod;\ntypedef struct KbdintDevice KbdintDevice;\n\nstruct Authctxt {\n\tsig_atomic_t\t success;\n\tint\t\t authenticated;\t \n\tint\t\t postponed;\t \n\tint\t\t valid;\t\t \n\tint\t\t attempt;\n\tint\t\t failures;\n\tint\t\t server_caused_failure;\n\tint\t\t force_pwchange;\n\tchar\t\t*user;\t\t \n\tchar\t\t*service;\n\tstruct passwd\t*pw;\t\t \n\tchar\t\t*style;\n\n\t \n\tchar\t\t**auth_methods;\t \n\tu_int\t\t num_auth_methods;\n\n\t \n\tvoid\t\t*methoddata;\n\tvoid\t\t*kbdintctxt;\n#ifdef BSD_AUTH\n\tauth_session_t\t*as;\n#endif\n#ifdef KRB5\n\tkrb5_context\t krb5_ctx;\n\tkrb5_ccache\t krb5_fwd_ccache;\n\tkrb5_principal\t krb5_user;\n\tchar\t\t*krb5_ticket_file;\n\tchar\t\t*krb5_ccname;\n#endif\n\tstruct sshbuf\t*loginmsg;\n\n\t \n\tstruct sshkey\t**prev_keys;\n\tu_int\t\t nprev_keys;\n\n\t \n\tstruct sshkey\t*auth_method_key;\n\tchar\t\t*auth_method_info;\n\n\t \n\tstruct sshbuf\t*session_info;\t \n};\n\n \n\nstruct Authmethod {\n\tchar\t*name;\n\tchar\t*synonym;\n\tint\t(*userauth)(struct ssh *, const char *);\n\tint\t*enabled;\n};\n\n \nstruct KbdintDevice\n{\n\tconst char *name;\n\tvoid*\t(*init_ctx)(Authctxt*);\n\tint\t(*query)(void *ctx, char **name, char **infotxt,\n\t\t    u_int *numprompts, char ***prompts, u_int **echo_on);\n\tint\t(*respond)(void *ctx, u_int numresp, char **responses);\n\tvoid\t(*free_ctx)(void *ctx);\n};\n\nint\nauth_rhosts2(struct passwd *, const char *, const char *, const char *);\n\nint      auth_password(struct ssh *, const char *);\n\nint\t hostbased_key_allowed(struct ssh *, struct passwd *,\n\t    const char *, char *, struct sshkey *);\nint\t user_key_allowed(struct ssh *ssh, struct passwd *, struct sshkey *,\n    int, struct sshauthopt **);\nint\t auth2_key_already_used(Authctxt *, const struct sshkey *);\n\n \nvoid\t auth2_authctxt_reset_info(Authctxt *);\nvoid\t auth2_record_key(Authctxt *, int, const struct sshkey *);\nvoid\t auth2_record_info(Authctxt *authctxt, const char *, ...)\n\t    __attribute__((__format__ (printf, 2, 3)))\n\t    __attribute__((__nonnull__ (2)));\nvoid\t auth2_update_session_info(Authctxt *, const char *, const char *);\n\n#ifdef KRB5\nint\tauth_krb5(Authctxt *authctxt, krb5_data *auth, char **client, krb5_data *);\nint\tauth_krb5_tgt(Authctxt *authctxt, krb5_data *tgt);\nint\tauth_krb5_password(Authctxt *authctxt, const char *password);\nvoid\tkrb5_cleanup_proc(Authctxt *authctxt);\n#endif  \n\n#if defined(USE_SHADOW) && defined(HAS_SHADOW_EXPIRE)\n#include <shadow.h>\nint auth_shadow_acctexpired(struct spwd *);\nint auth_shadow_pwexpired(Authctxt *);\n#endif\n\n#include \"auth-pam.h\"\n#include \"audit.h\"\nvoid remove_kbdint_device(const char *);\n\nvoid\tdo_authentication2(struct ssh *);\n\nvoid\tauth_log(struct ssh *, int, int, const char *, const char *);\nvoid\tauth_maxtries_exceeded(struct ssh *) __attribute__((noreturn));\nvoid\tuserauth_finish(struct ssh *, int, const char *, const char *);\nint\tauth_root_allowed(struct ssh *, const char *);\n\nchar\t*auth2_read_banner(void);\nint\t auth2_methods_valid(const char *, int);\nint\t auth2_update_methods_lists(Authctxt *, const char *, const char *);\nint\t auth2_setup_methods_lists(Authctxt *);\nint\t auth2_method_allowed(Authctxt *, const char *, const char *);\n\nvoid\tprivsep_challenge_enable(void);\n\nint\tauth2_challenge(struct ssh *, char *);\nvoid\tauth2_challenge_stop(struct ssh *);\nint\tbsdauth_query(void *, char **, char **, u_int *, char ***, u_int **);\nint\tbsdauth_respond(void *, u_int, char **);\n\nint\tallowed_user(struct ssh *, struct passwd *);\nstruct passwd * getpwnamallow(struct ssh *, const char *user);\n\nchar\t*expand_authorized_keys(const char *, struct passwd *pw);\nchar\t*authorized_principals_file(struct passwd *);\n\nint\t auth_key_is_revoked(struct sshkey *);\n\nconst char\t*auth_get_canonical_hostname(struct ssh *, int);\n\nHostStatus\ncheck_key_in_hostfiles(struct passwd *, struct sshkey *, const char *,\n    const char *, const char *);\n\n \nstruct sshkey\t*get_hostkey_by_index(int);\nstruct sshkey\t*get_hostkey_public_by_index(int, struct ssh *);\nstruct sshkey\t*get_hostkey_public_by_type(int, int, struct ssh *);\nstruct sshkey\t*get_hostkey_private_by_type(int, int, struct ssh *);\nint\t get_hostkey_index(struct sshkey *, int, struct ssh *);\nint\t sshd_hostkey_sign(struct ssh *, struct sshkey *, struct sshkey *,\n    u_char **, size_t *, const u_char *, size_t, const char *);\n\n \nconst struct sshauthopt *auth_options(struct ssh *);\nint\t auth_activate_options(struct ssh *, struct sshauthopt *);\nvoid\t auth_restrict_session(struct ssh *);\nvoid\t auth_log_authopts(const char *, const struct sshauthopt *, int);\n\n \nvoid\t auth_debug_add(const char *fmt,...)\n    __attribute__((format(printf, 1, 2)));\nvoid\t auth_debug_send(struct ssh *);\nvoid\t auth_debug_reset(void);\n\nstruct passwd *fakepw(void);\n\n \nint\t auth_authorise_keyopts(struct passwd *, struct sshauthopt *, int,\n    const char *, const char *, const char *);\nint\t auth_check_principals_line(char *, const struct sshkey_cert *,\n    const char *, struct sshauthopt **);\nint\t auth_process_principals(FILE *, const char *,\n    const struct sshkey_cert *, struct sshauthopt **);\nint\t auth_check_authkey_line(struct passwd *, struct sshkey *,\n    char *, const char *, const char *, const char *, struct sshauthopt **);\nint\t auth_check_authkeys_file(struct passwd *, FILE *, char *,\n    struct sshkey *, const char *, const char *, struct sshauthopt **);\nFILE\t*auth_openkeyfile(const char *, struct passwd *, int);\nFILE\t*auth_openprincipals(const char *, struct passwd *, int);\n\nint\t sys_auth_passwd(struct ssh *, const char *);\n\n#if defined(KRB5) && !defined(HEIMDAL)\nkrb5_error_code ssh_krb5_cc_gen(krb5_context, krb5_ccache *);\n#endif\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}