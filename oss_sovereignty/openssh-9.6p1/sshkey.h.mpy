{
  "module_name": "sshkey.h",
  "hash_id": "22e3f49fe646c5e95c0fe185ab3d0f2865688ddb61a012365622fd7e5b0b8cec",
  "original_prompt": "Ingested from openssh-9.6p1/sshkey.h",
  "human_readable_source": " \n\n \n#ifndef SSHKEY_H\n#define SSHKEY_H\n\n#include <sys/types.h>\n\n#ifdef WITH_OPENSSL\n#include <openssl/rsa.h>\n#include <openssl/dsa.h>\n# ifdef OPENSSL_HAS_ECC\n#  include <openssl/ec.h>\n#  include <openssl/ecdsa.h>\n# else  \n#  define EC_KEY\tvoid\n#  define EC_GROUP\tvoid\n#  define EC_POINT\tvoid\n# endif  \n#define SSH_OPENSSL_VERSION OpenSSL_version(OPENSSL_VERSION)\n#else  \n# define BIGNUM\t\tvoid\n# define RSA\t\tvoid\n# define DSA\t\tvoid\n# define EC_KEY\t\tvoid\n# define EC_GROUP\tvoid\n# define EC_POINT\tvoid\n#define SSH_OPENSSL_VERSION \"without OpenSSL\"\n#endif  \n\n#define SSH_RSA_MINIMUM_MODULUS_SIZE\t1024\n#define SSH_KEY_MAX_SIGN_DATA_SIZE\t(1 << 20)\n\nstruct sshbuf;\n\n \nenum sshkey_types {\n\tKEY_RSA,\n\tKEY_DSA,\n\tKEY_ECDSA,\n\tKEY_ED25519,\n\tKEY_RSA_CERT,\n\tKEY_DSA_CERT,\n\tKEY_ECDSA_CERT,\n\tKEY_ED25519_CERT,\n\tKEY_XMSS,\n\tKEY_XMSS_CERT,\n\tKEY_ECDSA_SK,\n\tKEY_ECDSA_SK_CERT,\n\tKEY_ED25519_SK,\n\tKEY_ED25519_SK_CERT,\n\tKEY_UNSPEC\n};\n\n \n#define SSH_FP_HASH_DEFAULT\tSSH_DIGEST_SHA256\n\n \nenum sshkey_fp_rep {\n\tSSH_FP_DEFAULT = 0,\n\tSSH_FP_HEX,\n\tSSH_FP_BASE64,\n\tSSH_FP_BUBBLEBABBLE,\n\tSSH_FP_RANDOMART\n};\n\n \nenum sshkey_serialize_rep {\n\tSSHKEY_SERIALIZE_DEFAULT = 0,\n\tSSHKEY_SERIALIZE_STATE = 1,\t \n\tSSHKEY_SERIALIZE_FULL = 2,\t \n\tSSHKEY_SERIALIZE_SHIELD = 3,\t \n\tSSHKEY_SERIALIZE_INFO = 254,\t \n};\n\n \nenum sshkey_private_format {\n\tSSHKEY_PRIVATE_OPENSSH = 0,\n\tSSHKEY_PRIVATE_PEM = 1,\n\tSSHKEY_PRIVATE_PKCS8 = 2,\n};\n\n \n#define SSHKEY_FLAG_EXT\t\t0x0001\n\n#define SSHKEY_CERT_MAX_PRINCIPALS\t256\n \nstruct sshkey_cert {\n\tstruct sshbuf\t*certblob;  \n\tu_int\t\t type;  \n\tu_int64_t\t serial;\n\tchar\t\t*key_id;\n\tu_int\t\t nprincipals;\n\tchar\t\t**principals;\n\tu_int64_t\t valid_after, valid_before;\n\tstruct sshbuf\t*critical;\n\tstruct sshbuf\t*extensions;\n\tstruct sshkey\t*signature_key;\n\tchar\t\t*signature_type;\n};\n\n \nstruct sshkey {\n\tint\t type;\n\tint\t flags;\n\t \n\tRSA\t*rsa;\n\t \n\tDSA\t*dsa;\n\t \n\tint\t ecdsa_nid;\t \n\tEC_KEY\t*ecdsa;\n\t \n\tu_char\t*ed25519_sk;\n\tu_char\t*ed25519_pk;\n\t \n\tchar\t*xmss_name;\n\tchar\t*xmss_filename;\t \n\tvoid\t*xmss_state;\t \n\tu_char\t*xmss_sk;\n\tu_char\t*xmss_pk;\n\t \n\tchar\t*sk_application;\n\tuint8_t\tsk_flags;\n\tstruct sshbuf *sk_key_handle;\n\tstruct sshbuf *sk_reserved;\n\t \n\tstruct sshkey_cert *cert;\n\t \n\tu_char\t*shielded_private;\n\tsize_t\tshielded_len;\n\tu_char\t*shield_prekey;\n\tsize_t\tshield_prekey_len;\n};\n\n#define\tED25519_SK_SZ\tcrypto_sign_ed25519_SECRETKEYBYTES\n#define\tED25519_PK_SZ\tcrypto_sign_ed25519_PUBLICKEYBYTES\n\n \nstruct sshkey_sig_details {\n\tuint32_t sk_counter;\t \n\tuint8_t sk_flags;\t \n};\n\nstruct sshkey_impl_funcs {\n\tu_int (*size)(const struct sshkey *);\t \n\tint (*alloc)(struct sshkey *);\t\t \n\tvoid (*cleanup)(struct sshkey *);\t \n\tint (*equal)(const struct sshkey *, const struct sshkey *);\n\tint (*serialize_public)(const struct sshkey *, struct sshbuf *,\n\t    enum sshkey_serialize_rep);\n\tint (*deserialize_public)(const char *, struct sshbuf *,\n\t    struct sshkey *);\n\tint (*serialize_private)(const struct sshkey *, struct sshbuf *,\n\t    enum sshkey_serialize_rep);\n\tint (*deserialize_private)(const char *, struct sshbuf *,\n\t    struct sshkey *);\n\tint (*generate)(struct sshkey *, int);\t \n\tint (*copy_public)(const struct sshkey *, struct sshkey *);\n\tint (*sign)(struct sshkey *, u_char **, size_t *,\n\t    const u_char *, size_t, const char *,\n\t    const char *, const char *, u_int);  \n\tint (*verify)(const struct sshkey *, const u_char *, size_t,\n\t    const u_char *, size_t, const char *, u_int,\n\t    struct sshkey_sig_details **);\n};\n\nstruct sshkey_impl {\n\tconst char *name;\n\tconst char *shortname;\n\tconst char *sigalg;\n\tint type;\n\tint nid;\n\tint cert;\n\tint sigonly;\n\tint keybits;\n\tconst struct sshkey_impl_funcs *funcs;\n};\n\nstruct sshkey\t*sshkey_new(int);\nvoid\t\t sshkey_free(struct sshkey *);\nint\t\t sshkey_equal_public(const struct sshkey *,\n    const struct sshkey *);\nint\t\t sshkey_equal(const struct sshkey *, const struct sshkey *);\nchar\t\t*sshkey_fingerprint(const struct sshkey *,\n    int, enum sshkey_fp_rep);\nint\t\t sshkey_fingerprint_raw(const struct sshkey *k,\n    int, u_char **retp, size_t *lenp);\nconst char\t*sshkey_type(const struct sshkey *);\nconst char\t*sshkey_cert_type(const struct sshkey *);\nint\t\t sshkey_format_text(const struct sshkey *, struct sshbuf *);\nint\t\t sshkey_write(const struct sshkey *, FILE *);\nint\t\t sshkey_read(struct sshkey *, char **);\nu_int\t\t sshkey_size(const struct sshkey *);\n\nint\t\t sshkey_generate(int type, u_int bits, struct sshkey **keyp);\nint\t\t sshkey_from_private(const struct sshkey *, struct sshkey **);\n\nint\t\t sshkey_is_shielded(struct sshkey *);\nint\t\t sshkey_shield_private(struct sshkey *);\nint\t\t sshkey_unshield_private(struct sshkey *);\n\nint\t sshkey_type_from_name(const char *);\nint\t sshkey_is_cert(const struct sshkey *);\nint\t sshkey_is_sk(const struct sshkey *);\nint\t sshkey_type_is_cert(int);\nint\t sshkey_type_plain(int);\n\n \nint\t sshkey_match_keyname_to_sigalgs(const char *, const char *);\n\nint\t sshkey_to_certified(struct sshkey *);\nint\t sshkey_drop_cert(struct sshkey *);\nint\t sshkey_cert_copy(const struct sshkey *, struct sshkey *);\nint\t sshkey_cert_check_authority(const struct sshkey *, int, int, int,\n    uint64_t, const char *, const char **);\nint\t sshkey_cert_check_authority_now(const struct sshkey *, int, int, int,\n    const char *, const char **);\nint\t sshkey_cert_check_host(const struct sshkey *, const char *,\n    int , const char *, const char **);\nsize_t\t sshkey_format_cert_validity(const struct sshkey_cert *,\n    char *, size_t) __attribute__((__bounded__(__string__, 2, 3)));\nint\t sshkey_check_cert_sigtype(const struct sshkey *, const char *);\n\nint\t sshkey_certify(struct sshkey *, struct sshkey *,\n    const char *, const char *, const char *);\n \ntypedef int sshkey_certify_signer(struct sshkey *, u_char **, size_t *,\n    const u_char *, size_t, const char *, const char *, const char *,\n    u_int, void *);\nint\t sshkey_certify_custom(struct sshkey *, struct sshkey *, const char *,\n    const char *, const char *, sshkey_certify_signer *, void *);\n\nint\t\t sshkey_ecdsa_nid_from_name(const char *);\nint\t\t sshkey_curve_name_to_nid(const char *);\nconst char *\t sshkey_curve_nid_to_name(int);\nu_int\t\t sshkey_curve_nid_to_bits(int);\nint\t\t sshkey_ecdsa_bits_to_nid(int);\nint\t\t sshkey_ecdsa_key_to_nid(EC_KEY *);\nint\t\t sshkey_ec_nid_to_hash_alg(int nid);\nint\t\t sshkey_ec_validate_public(const EC_GROUP *, const EC_POINT *);\nint\t\t sshkey_ec_validate_private(const EC_KEY *);\nconst char\t*sshkey_ssh_name(const struct sshkey *);\nconst char\t*sshkey_ssh_name_plain(const struct sshkey *);\nint\t\t sshkey_names_valid2(const char *, int, int);\nchar\t\t*sshkey_alg_list(int, int, int, char);\n\nint\t sshkey_from_blob(const u_char *, size_t, struct sshkey **);\nint\t sshkey_fromb(struct sshbuf *, struct sshkey **);\nint\t sshkey_froms(struct sshbuf *, struct sshkey **);\nint\t sshkey_to_blob(const struct sshkey *, u_char **, size_t *);\nint\t sshkey_to_base64(const struct sshkey *, char **);\nint\t sshkey_putb(const struct sshkey *, struct sshbuf *);\nint\t sshkey_puts(const struct sshkey *, struct sshbuf *);\nint\t sshkey_puts_opts(const struct sshkey *, struct sshbuf *,\n    enum sshkey_serialize_rep);\nint\t sshkey_plain_to_blob(const struct sshkey *, u_char **, size_t *);\nint\t sshkey_putb_plain(const struct sshkey *, struct sshbuf *);\n\nint\t sshkey_sign(struct sshkey *, u_char **, size_t *,\n    const u_char *, size_t, const char *, const char *, const char *, u_int);\nint\t sshkey_verify(const struct sshkey *, const u_char *, size_t,\n    const u_char *, size_t, const char *, u_int, struct sshkey_sig_details **);\nint\t sshkey_check_sigtype(const u_char *, size_t, const char *);\nconst char *sshkey_sigalg_by_name(const char *);\nint\t sshkey_get_sigtype(const u_char *, size_t, char **);\n\n \nvoid\tsshkey_dump_ec_point(const EC_GROUP *, const EC_POINT *);\nvoid\tsshkey_dump_ec_key(const EC_KEY *);\n\n \nint\tsshkey_private_serialize(struct sshkey *key, struct sshbuf *buf);\nint\tsshkey_private_serialize_opt(struct sshkey *key, struct sshbuf *buf,\n    enum sshkey_serialize_rep);\nint\tsshkey_private_deserialize(struct sshbuf *buf,  struct sshkey **keyp);\n\n \nint\tsshkey_private_to_fileblob(struct sshkey *key, struct sshbuf *blob,\n    const char *passphrase, const char *comment,\n    int format, const char *openssh_format_cipher, int openssh_format_rounds);\nint\tsshkey_parse_private_fileblob(struct sshbuf *buffer,\n    const char *passphrase, struct sshkey **keyp, char **commentp);\nint\tsshkey_parse_private_fileblob_type(struct sshbuf *blob, int type,\n    const char *passphrase, struct sshkey **keyp, char **commentp);\nint\tsshkey_parse_pubkey_from_private_fileblob_type(struct sshbuf *blob,\n    int type, struct sshkey **pubkeyp);\n\nint sshkey_check_rsa_length(const struct sshkey *, int);\n \nint ssh_rsa_complete_crt_parameters(struct sshkey *, const BIGNUM *);\n\n \nint\t sshkey_set_filename(struct sshkey *, const char *);\nint\t sshkey_enable_maxsign(struct sshkey *, u_int32_t);\nu_int32_t sshkey_signatures_left(const struct sshkey *);\nint\t sshkey_forward_state(const struct sshkey *, u_int32_t, int);\nint\t sshkey_private_serialize_maxsign(struct sshkey *key,\n    struct sshbuf *buf, u_int32_t maxsign, int);\n\nvoid\t sshkey_sig_details_free(struct sshkey_sig_details *);\n\n#ifdef SSHKEY_INTERNAL\nint\tsshkey_sk_fields_equal(const struct sshkey *a, const struct sshkey *b);\nvoid\tsshkey_sk_cleanup(struct sshkey *k);\nint\tsshkey_serialize_sk(const struct sshkey *key, struct sshbuf *b);\nint\tsshkey_copy_public_sk(const struct sshkey *from, struct sshkey *to);\nint\tsshkey_deserialize_sk(struct sshbuf *b, struct sshkey *key);\nint\tsshkey_serialize_private_sk(const struct sshkey *key,\n    struct sshbuf *buf);\nint\tsshkey_private_deserialize_sk(struct sshbuf *buf, struct sshkey *k);\n#ifdef WITH_OPENSSL\nint\tcheck_rsa_length(const RSA *rsa);  \n#endif\n#endif\n\n#if !defined(WITH_OPENSSL)\n# undef RSA\n# undef DSA\n# undef EC_KEY\n# undef EC_GROUP\n# undef EC_POINT\n#elif !defined(OPENSSL_HAS_ECC)\n# undef EC_KEY\n# undef EC_GROUP\n# undef EC_POINT\n#endif\n\n#endif  \n",
  "logic_map": {},
  "failure_modes": [],
  "crash_correlation_map": {}
}