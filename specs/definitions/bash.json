{
  "name": "bash",
  "version": "5.2.21",
  "source_url": "https://ftp.gnu.org/gnu/bash/bash-5.2.21.tar.gz",
  "archive_name": "bash-5.2.21.tar.gz",
  "build_subdir": "bash-src",
  "env": {
      "CFLAGS": "-I{staging}/include -static -std=gnu17 -Wno-error=incompatible-pointer-types -Wno-error=deprecated-non-prototype -Wno-error=strict-prototypes",
      "CC_FOR_BUILD": "x86_64-unknown-linux-musl-gcc -std=gnu17"
  },
  "patches": [
      {
          "file": "lib/sh/strtoimax.c",
          "content": "/* Replaced by Anvil Forge to prevent duplicate symbol with musl libc */\n"
      },
      {
          "file": "lib/termcap/tparam.c",
          "prepend": "#include <unistd.h>\n"
      }
  ],
  "configure": "./configure --prefix=/ --enable-static-link --without-bash-malloc --with-installed-readline={staging} --host=x86_64-unknown-linux-musl",
  "build": "make -j$(nproc)",
  "install": "make install DESTDIR={rootfs} && ln -sf bash {rootfs}/bin/sh"
}